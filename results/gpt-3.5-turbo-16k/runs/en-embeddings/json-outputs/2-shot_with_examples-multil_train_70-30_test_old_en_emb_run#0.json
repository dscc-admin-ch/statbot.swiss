[
  {
    "i": 0,
    "question": "Which offences had over 10,000 incidents in Switzerland in 2022. Provide the criminal codes and the number of incidents.",
    "query": "SELECT T.offence_criminal_code,\n  SUM(T.number_criminal_offences_registered) AS offences_per_year\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2022\n  AND T.number_criminal_offences_registered > 10000\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.year, T.offence_criminal_code\nORDER BY offences_per_year DESC;\n",
    "db_id": "criminal_offences_registered_by_police",
    "generated_query": "SELECT T.offence_criminal_code, T.number_criminal_offences_registered\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2022\n  AND T.number_criminal_offences_registered > 10000\n  AND T.offence_criminal_code != 'Offence - total';",
    "meta_data": [
      {
        "question": "In which year were there the most crimes in Switzerland? Also please provide the number of committed crimes.",
        "query": "SELECT T.year AS year_with_most_crimes, T.number_criminal_offences_registered\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.offence_criminal_code = 'Offence - total'\nGROUP BY T.year, T.number_criminal_offences_registered\nORDER BY T.number_criminal_offences_registered DESC LIMIT 1;\n",
        "score": 0.416123628616333
      },
      {
        "question": "What is the category of the most frequently committed crimes in Switzerland and how many such crimes were commited?",
        "query": "SELECT T.offence_category, SUM(number_criminal_offences_registered) AS number_criminal_offences\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category, S.name\nORDER BY number_criminal_offences DESC LIMIT 1;\n",
        "score": 0.5096356868743896
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.criminal_offences_registered_by_police (\n\tuid SERIAL NOT NULL, \n\toffence_criminal_code TEXT, \n\tyear INTEGER, \n\toffence_category TEXT, \n\tnumber_criminal_offences_registered NUMERIC, \n\tnumber_criminal_offences_unsolved NUMERIC, \n\tnumber_criminal_offences_solved NUMERIC, \n\tnumber_criminal_offences_completed NUMERIC, \n\tnumber_criminal_offences_completed_unsolved NUMERIC, \n\tnumber_criminal_offences_completed_solved NUMERIC, \n\tnumber_criminal_offences_attempted NUMERIC, \n\tnumber_criminal_offences_attempted_unsolved NUMERIC, \n\tnumber_criminal_offences_attempted_solved NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT criminal_offences_registered_by_police_pkey PRIMARY KEY (uid), \n\tCONSTRAINT criminal_offences_registered_by_police_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in criminal_offences_registered_by_police and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\noffence_criminal_code : False statements about commercial business (art. 152), Common assault (art. 123), Trafficking in human beings (art. 182), Robbery (art. 140), Pickpocketing (art. 139)\nnumber_criminal_offences_registered : 95, 191, 159, 3530, 240\nnumber_criminal_offences_unsolved : 149, 374208, 12, 30, 40\nnumber_criminal_offences_solved : 78, 95, 46, 3312, 480\nnumber_criminal_offences_completed : 10928, 78, 95, 159, 1869\nnumber_criminal_offences_completed_unsolved : 149, 51442, 48671, 46, 12\nnumber_criminal_offences_completed_solved : 92, 1615, 78, 46, 36\nnumber_criminal_offences_attempted : 162, 61, 95, 2289, 418\nnumber_criminal_offences_attempted_unsolved : 21, 60, 152, 24, 136\nnumber_criminal_offences_attempted_solved : 21, 162, 1395, 159, 178\n*/\n\n/*\nColumn name, Column discription, Example values\noffence_criminal_code, offence as defined by Swiss criminal code, Vehicle burglary (art. 139),Falsification of money (art. 241)\nnumber_criminal_offences_registered, number of criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_unsolved, number of unsolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_solved, number of resolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_completed, number of completed criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_completed_unsolved, Number of completed and unsolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_completed_solved, Number of completed and resolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_attempted, number of attempted criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_attempted_unsolved, number of attempted und unsolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_attempted_solved, number of attempted and resolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\noffence_category, broad Category of criminal offence, Property,Liberty\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nCompare the years 2019 and 2020 regarding offence categories that had over a 100 incidents in Kanton of Zurich. Provide the difference and order by how much they increased.\n### SQL query\nSELECT T.offence_category,\n   SUM(CASE WHEN T.year = 2019\n       THEN T.number_criminal_offences_registered ELSE 0 END) AS number_offences_2019,\n   SUM(CASE WHEN T.year = 2020\n       THEN T.number_criminal_offences_registered ELSE 0 END) AS number_offences_2020,\n   SUM(CASE WHEN T.year = 2020\n       THEN T.number_criminal_offences_registered ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2019\n       THEN T.number_criminal_offences_registered ELSE 0 END) AS increase\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND S.name LIKE '%Zurich%'\n  AND T.year IN (2019, 2020)\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category\nHAVING SUM(CASE WHEN T.year = 2019\n       THEN T.number_criminal_offences_registered ELSE 0 END) > 100\nORDER BY increase DESC;\n\n\n### Question\nHow were the crime prevention rates in Switzerland for 2022 per crime category. Also provide the number of attempted and committed crimes? Order by prevention rate.\n### SQL query\nSELECT T.offence_category, SUM(T.number_criminal_offences_attempted) AS number_of_attempted_crimes,\n  SUM(T.number_criminal_offences_registered) AS number_of_committed_crimes,\n  ROUND(100 * SUM(T.number_criminal_offences_attempted) / SUM(T.number_criminal_offences_registered), 2) AS prevention_rate\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2022\n  AND T.number_criminal_offences_registered != 0\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category\nORDER BY prevention_rate DESC;\n\n\n### Question\nWhich offences had over 10,000 incidents in Switzerland in 2022. Provide the criminal codes and the number of incidents.\n### SQL query\n",
    "process_time": 7.236148461932316,
    "num_tokens": 1950,
    "hardness": "unknown",
    "scores": [
      0.416123628616333,
      0.5096356868743896
    ],
    "lang": "en"
  },
  {
    "i": 1,
    "question": "What is the most committed crime in Switzerland?",
    "query": "SELECT T.offence_criminal_code AS most_common_criminal_offence\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.offence_criminal_code != 'Offence - total'\n  AND T.number_criminal_offences_registered IS NOT NULL\nGROUP BY T.offence_criminal_code\nORDER BY SUM(T.number_criminal_offences_registered) DESC LIMIT 1;\n",
    "db_id": "criminal_offences_registered_by_police",
    "generated_query": "SELECT T.offence_criminal_code\nFROM criminal_offences_registered_by_police AS T\nWHERE T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_criminal_code\nORDER BY SUM(T.number_criminal_offences_registered) DESC LIMIT 1;",
    "meta_data": [
      {
        "question": "What is the category of the most frequently committed crimes in Switzerland and how many such crimes were commited?",
        "query": "SELECT T.offence_category, SUM(number_criminal_offences_registered) AS number_criminal_offences\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category, S.name\nORDER BY number_criminal_offences DESC LIMIT 1;\n",
        "score": 0.19945724308490753
      },
      {
        "question": "What was the most committed crime in 2020 in the canton of Bern?",
        "query": "SELECT T.offence_criminal_code\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Bern%'\n  AND S.canton = 'TRUE'\n  AND T.year = 2020\n  AND T.offence_criminal_code != 'Offence - total'\n  AND T.number_criminal_offences_registered IS NOT NULL\nGROUP BY T.offence_criminal_code, T.number_criminal_offences_registered\nORDER BY T.number_criminal_offences_registered DESC LIMIT 1;\n",
        "score": 0.36493566632270813
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.criminal_offences_registered_by_police (\n\tuid SERIAL NOT NULL, \n\toffence_criminal_code TEXT, \n\tyear INTEGER, \n\toffence_category TEXT, \n\tnumber_criminal_offences_registered NUMERIC, \n\tnumber_criminal_offences_unsolved NUMERIC, \n\tnumber_criminal_offences_solved NUMERIC, \n\tnumber_criminal_offences_completed NUMERIC, \n\tnumber_criminal_offences_completed_unsolved NUMERIC, \n\tnumber_criminal_offences_completed_solved NUMERIC, \n\tnumber_criminal_offences_attempted NUMERIC, \n\tnumber_criminal_offences_attempted_unsolved NUMERIC, \n\tnumber_criminal_offences_attempted_solved NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT criminal_offences_registered_by_police_pkey PRIMARY KEY (uid), \n\tCONSTRAINT criminal_offences_registered_by_police_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in criminal_offences_registered_by_police and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\noffence_criminal_code : False statements about commercial business (art. 152), Common assault (art. 123), Trafficking in human beings (art. 182), Robbery (art. 140), Pickpocketing (art. 139)\nnumber_criminal_offences_registered : 95, 191, 159, 3530, 240\nnumber_criminal_offences_unsolved : 149, 374208, 12, 30, 40\nnumber_criminal_offences_solved : 78, 95, 46, 3312, 480\nnumber_criminal_offences_completed : 10928, 78, 95, 159, 1869\nnumber_criminal_offences_completed_unsolved : 149, 51442, 48671, 46, 12\nnumber_criminal_offences_completed_solved : 92, 1615, 78, 46, 36\nnumber_criminal_offences_attempted : 162, 61, 95, 2289, 418\nnumber_criminal_offences_attempted_unsolved : 21, 60, 152, 24, 136\nnumber_criminal_offences_attempted_solved : 21, 162, 1395, 159, 178\n*/\n\n/*\nColumn name, Column discription, Example values\noffence_criminal_code, offence as defined by Swiss criminal code, Vehicle burglary (art. 139),Falsification of money (art. 241)\nnumber_criminal_offences_registered, number of criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_unsolved, number of unsolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_solved, number of resolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_completed, number of completed criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_completed_unsolved, Number of completed and unsolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_completed_solved, Number of completed and resolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_attempted, number of attempted criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_attempted_unsolved, number of attempted und unsolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_attempted_solved, number of attempted and resolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\noffence_category, broad Category of criminal offence, Property,Liberty\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nCompare the years 2019 and 2020 regarding offence categories that had over a 100 incidents in Kanton of Zurich. Provide the difference and order by how much they increased.\n### SQL query\nSELECT T.offence_category,\n   SUM(CASE WHEN T.year = 2019\n       THEN T.number_criminal_offences_registered ELSE 0 END) AS number_offences_2019,\n   SUM(CASE WHEN T.year = 2020\n       THEN T.number_criminal_offences_registered ELSE 0 END) AS number_offences_2020,\n   SUM(CASE WHEN T.year = 2020\n       THEN T.number_criminal_offences_registered ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2019\n       THEN T.number_criminal_offences_registered ELSE 0 END) AS increase\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND S.name LIKE '%Zurich%'\n  AND T.year IN (2019, 2020)\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category\nHAVING SUM(CASE WHEN T.year = 2019\n       THEN T.number_criminal_offences_registered ELSE 0 END) > 100\nORDER BY increase DESC;\n\n\n### Question\nWhat was the most committed crime in 2020 in the canton of Bern?\n### SQL query\nSELECT T.offence_criminal_code\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Bern%'\n  AND S.canton = 'TRUE'\n  AND T.year = 2020\n  AND T.offence_criminal_code != 'Offence - total'\n  AND T.number_criminal_offences_registered IS NOT NULL\nGROUP BY T.offence_criminal_code, T.number_criminal_offences_registered\nORDER BY T.number_criminal_offences_registered DESC LIMIT 1;\n\n\n### Question\nWhat is the most committed crime in Switzerland?\n### SQL query\n",
    "process_time": 7.712438008049503,
    "num_tokens": 1871,
    "hardness": "unknown",
    "scores": [
      0.19945724308490753,
      0.36493566632270813
    ],
    "lang": "en"
  },
  {
    "i": 2,
    "question": "What was the clearance rate for bribery in 2021 in Switzerland",
    "query": "SELECT 100 * SUM(T.number_criminal_offences_solved) / SUM(T.number_criminal_offences_registered)\nAS clearance_rate_for_bribery\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2021\n  AND T.number_criminal_offences_registered IS NOT NULL\n  AND T.offence_category = 'Bribery';\n",
    "db_id": "criminal_offences_registered_by_police",
    "generated_query": "SELECT (SUM(number_criminal_offences_completed_solved) / SUM(number_criminal_offences_completed)) * 100 AS clearance_rate\nFROM criminal_offences_registered_by_police\nWHERE offence_criminal_code = 'Bribery (art. 322)'\n  AND year = 2021\n  AND spatialunit_uid IN (SELECT spatialunit_uid FROM spatial_unit WHERE name = 'Switzerland' AND country = 'TRUE');",
    "meta_data": [
      {
        "question": "Which three crime categories had the lowest crime detection rate in 2019 in Switzerland and what were these rates?",
        "query": "SELECT T.offence_category,\n100 * SUM(T.number_criminal_offences_solved) / SUM(T.number_criminal_offences_registered)\nAS crime_detection_rate\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2019\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category\nORDER BY crime_detection_rate LIMIT 3;\n",
        "score": 0.978851318359375
      },
      {
        "question": "What was the most committed crime in 2020 in the canton of Bern?",
        "query": "SELECT T.offence_criminal_code\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Bern%'\n  AND S.canton = 'TRUE'\n  AND T.year = 2020\n  AND T.offence_criminal_code != 'Offence - total'\n  AND T.number_criminal_offences_registered IS NOT NULL\nGROUP BY T.offence_criminal_code, T.number_criminal_offences_registered\nORDER BY T.number_criminal_offences_registered DESC LIMIT 1;\n",
        "score": 1.010196328163147
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.criminal_offences_registered_by_police (\n\tuid SERIAL NOT NULL, \n\toffence_criminal_code TEXT, \n\tyear INTEGER, \n\toffence_category TEXT, \n\tnumber_criminal_offences_registered NUMERIC, \n\tnumber_criminal_offences_unsolved NUMERIC, \n\tnumber_criminal_offences_solved NUMERIC, \n\tnumber_criminal_offences_completed NUMERIC, \n\tnumber_criminal_offences_completed_unsolved NUMERIC, \n\tnumber_criminal_offences_completed_solved NUMERIC, \n\tnumber_criminal_offences_attempted NUMERIC, \n\tnumber_criminal_offences_attempted_unsolved NUMERIC, \n\tnumber_criminal_offences_attempted_solved NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT criminal_offences_registered_by_police_pkey PRIMARY KEY (uid), \n\tCONSTRAINT criminal_offences_registered_by_police_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in criminal_offences_registered_by_police and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\noffence_criminal_code : False statements about commercial business (art. 152), Common assault (art. 123), Trafficking in human beings (art. 182), Robbery (art. 140), Pickpocketing (art. 139)\nnumber_criminal_offences_registered : 95, 191, 159, 3530, 240\nnumber_criminal_offences_unsolved : 149, 374208, 12, 30, 40\nnumber_criminal_offences_solved : 78, 95, 46, 3312, 480\nnumber_criminal_offences_completed : 10928, 78, 95, 159, 1869\nnumber_criminal_offences_completed_unsolved : 149, 51442, 48671, 46, 12\nnumber_criminal_offences_completed_solved : 92, 1615, 78, 46, 36\nnumber_criminal_offences_attempted : 162, 61, 95, 2289, 418\nnumber_criminal_offences_attempted_unsolved : 21, 60, 152, 24, 136\nnumber_criminal_offences_attempted_solved : 21, 162, 1395, 159, 178\n*/\n\n/*\nColumn name, Column discription, Example values\noffence_criminal_code, offence as defined by Swiss criminal code, Vehicle burglary (art. 139),Falsification of money (art. 241)\nnumber_criminal_offences_registered, number of criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_unsolved, number of unsolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_solved, number of resolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_completed, number of completed criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_completed_unsolved, Number of completed and unsolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_completed_solved, Number of completed and resolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_attempted, number of attempted criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_attempted_unsolved, number of attempted und unsolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_attempted_solved, number of attempted and resolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\noffence_category, broad Category of criminal offence, Property,Liberty\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nCompare the years 2019 and 2020 regarding offence categories that had over a 100 incidents in Kanton of Zurich. Provide the difference and order by how much they increased.\n### SQL query\nSELECT T.offence_category,\n   SUM(CASE WHEN T.year = 2019\n       THEN T.number_criminal_offences_registered ELSE 0 END) AS number_offences_2019,\n   SUM(CASE WHEN T.year = 2020\n       THEN T.number_criminal_offences_registered ELSE 0 END) AS number_offences_2020,\n   SUM(CASE WHEN T.year = 2020\n       THEN T.number_criminal_offences_registered ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2019\n       THEN T.number_criminal_offences_registered ELSE 0 END) AS increase\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND S.name LIKE '%Zurich%'\n  AND T.year IN (2019, 2020)\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category\nHAVING SUM(CASE WHEN T.year = 2019\n       THEN T.number_criminal_offences_registered ELSE 0 END) > 100\nORDER BY increase DESC;\n\n\n### Question\nHow were the crime prevention rates in Switzerland for 2022 per crime category. Also provide the number of attempted and committed crimes? Order by prevention rate.\n### SQL query\nSELECT T.offence_category, SUM(T.number_criminal_offences_attempted) AS number_of_attempted_crimes,\n  SUM(T.number_criminal_offences_registered) AS number_of_committed_crimes,\n  ROUND(100 * SUM(T.number_criminal_offences_attempted) / SUM(T.number_criminal_offences_registered), 2) AS prevention_rate\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2022\n  AND T.number_criminal_offences_registered != 0\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category\nORDER BY prevention_rate DESC;\n\n\n### Question\nWhat was the clearance rate for bribery in 2021 in Switzerland\n### SQL query\n",
    "process_time": 9.702122540213168,
    "num_tokens": 1938,
    "hardness": "unknown",
    "scores": [
      0.978851318359375,
      1.010196328163147
    ],
    "lang": "en"
  },
  {
    "i": 3,
    "question": "List for each year the number of forests in Kanton Uri?",
    "query": "SELECT T.year, SUM(T.number_of_plantations) AS number_of_plantations_canton_uri\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Uri%'\n  AND T.type_of_owner = 'Type of owners - total'\n  AND T.wood_species = 'Species - total'\n  AND T.forest_zone != 'Switzerland'\n  AND T.number_of_plantations != 0\nGROUP BY T.year\nORDER BY T.year DESC;\n",
    "db_id": "number_of_plantations_in_swiss_forest",
    "generated_query": "SELECT T.year, T.number_of_plantations\nFROM number_of_plantations_in_swiss_forest AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND S.name = 'Uri'\nORDER BY T.year;",
    "meta_data": [
      {
        "question": "To which Forestzones belongs the canton Jura and how many plantations of Jura are located in that forest zone?",
        "query": "SELECT T.forest_zone as forest_zone_for_jura, SUM(T.number_of_plantations) AS number_of_plantations_canton_jura\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Jura%'\n  AND T.type_of_owner = 'Type of owners - total'\n  AND T.wood_species = 'Species - total'\n  AND T.forest_zone != 'Switzerland'\n  AND T.number_of_plantations != 0\nGROUP BY T.forest_zone\nHAVING SUM(T.number_of_plantations) != 0\nORDER BY number_of_plantations_canton_jura DESC;\n",
        "score": 0.8287323713302612
      },
      {
        "question": "Which cantons had in 2022 only public forests?",
        "query": "SELECT S.name_de as canton\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.type_of_owner = 'Private forest'\n  AND T.year = 2022\nGROUP BY S.name_de\nHAVING SUM(T.number_of_plantations) = 0;\n",
        "score": 0.8699590563774109
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.number_of_plantations_in_swiss_forest (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tforest_zone TEXT, \n\ttype_of_owner TEXT, \n\twood_species TEXT, \n\tnumber_of_plantations NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT number_of_plantations_in_swiss_forest_pkey PRIMARY KEY (uid), \n\tCONSTRAINT number_of_plantations_in_swiss_forest_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in number_of_plantations_in_swiss_forest and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nnumber_of_plantations : 586994, 202385, 377625, 1636447, 39980\nspatialunit_uid : 1_A.ADM1, 24_A.ADM1, 23_A.ADM1, 8_A.ADM1, 22_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\nforest_zone, forest zone, Switzerland,Jura,Central Plain\ntype_of_owner, owner type, Type of owners - total,Public forest,Private forest\nwood_species, wood species group, Species - total,Hardwood (deciduous),Softwood (conifers)\nnumber_of_plantations, number of plantations, 14987125 ,11537284 ,3449841\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nProvide the change over the years of the total number of forests registered in Switzerland. The change should be given in percentage of the number of the previous year.\n### SQL query\nWITH PlantationsByYear AS (\n  SELECT T.year,\n    SUM(T.number_of_plantations) AS number_of_plantations_switzerland\n  FROM number_of_plantations_in_swiss_forest AS T\n  JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n  WHERE S.country = 'TRUE'\n    AND T.type_of_owner = 'Type of owners - total'\n    AND T.wood_species = 'Species - total'\n    AND T.forest_zone != 'Switzerland'\n    AND T.number_of_plantations != 0\n  GROUP BY T.year\n)\nSELECT\n  Curr.year,\n  Curr.number_of_plantations_switzerland,\n  ROUND(100 * (Curr.number_of_plantations_switzerland - Prev.number_of_plantations_switzerland) / (Prev.number_of_plantations_switzerland), 2) AS change_from_previous_year\nFROM PlantationsByYear AS Curr\nLEFT JOIN PlantationsByYear AS Prev ON Curr.year = Prev.year + 1\nORDER BY Curr.year DESC;\n\n\n### Question\nHow much did the number of Swiss forest change from 1975 to 2022? Show the change in total and by forest type as conifers or deciduous.\n### SQL query\nSELECT\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_deciduous_number_of_forests_1975_to_2022,\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_conifers_number_of_forests_1975_to_2022,\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%total%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%total%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_total_number_of_forests_1975_to_2022\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.year IN (1975, 2022)\n  AND S.name = 'Switzerland'\n  AND T.forest_zone = 'Switzerland'\n  AND T.type_of_owner = 'Type of owners - total';\n\n\n### Question\nList for each year the number of forests in Kanton Uri?\n### SQL query\n",
    "process_time": 4.354171687038615,
    "num_tokens": 1583,
    "hardness": "unknown",
    "scores": [
      0.8287323713302612,
      0.8699590563774109
    ],
    "lang": "en"
  },
  {
    "i": 4,
    "question": "What were proportions, in percent, of deciduous and coniferous forests in Switzerland in 2020?",
    "query": "SELECT\n  ROUND(100 * SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%'\n       THEN number_of_plantations ELSE 0 END) /\n  SUM(CASE WHEN LOWER(wood_species) LIKE '%total%'\n       THEN number_of_plantations ELSE 0 END),\n  2) AS percentage_deciduous_forests,\n    ROUND(100 * SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%'\n       THEN number_of_plantations ELSE 0 END) /\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%total%'\n       THEN number_of_plantations ELSE 0 END),\n  2) AS percentage_coniferous_forests\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.year = 2020\n  AND S.name = 'Switzerland'\n  AND T.type_of_owner = 'Type of owners - total';\n",
    "db_id": "number_of_plantations_in_swiss_forest",
    "generated_query": "SELECT\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%' AND year = 2020\n       THEN number_of_plantations ELSE 0 END) / \n   SUM(CASE WHEN year = 2020 THEN number_of_plantations ELSE 0 END) * 100) AS proportion_deciduous_forests_2020,\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%' AND year = 2020\n       THEN number_of_plantations ELSE 0 END) / \n   SUM(CASE WHEN year = 2020 THEN number_of_plantations ELSE 0 END) * 100) AS proportion_coniferous_forests_2020\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.year = 2020\n  AND S.name = 'Switzerland'\n  AND T.forest_zone = 'Switzerland'\n  AND T.type_of_owner = 'Type of owners - total';",
    "meta_data": [
      {
        "question": "What was the proportion of private to public forests in Switzerland in 2022?",
        "query": "SELECT\n  ROUND(100 * SUM(CASE WHEN LOWER(type_of_owner) LIKE '%private%'\n        THEN number_of_plantations ELSE 0 END) /\n    SUM(CASE WHEN LOWER(type_of_owner) LIKE '%total%'\n        THEN number_of_plantations ELSE 0 END), 2) AS percentage_private_forests,\n  ROUND(100 * SUM(CASE WHEN LOWER(type_of_owner) LIKE '%public%'\n       THEN number_of_plantations ELSE 0 END) /\n    SUM(CASE WHEN LOWER(type_of_owner) LIKE '%total%'\n       THEN number_of_plantations ELSE 0 END), 2) AS percentage_public_forests\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.year = 2022\n  AND S.name = 'Switzerland'\n  AND T.wood_species = 'Species - total';\n",
        "score": 0.25949716567993164
      },
      {
        "question": "Provide the change over the years of the total number of forests registered in Switzerland. The change should be given in percentage of the number of the previous year.",
        "query": "WITH PlantationsByYear AS (\n  SELECT T.year,\n    SUM(T.number_of_plantations) AS number_of_plantations_switzerland\n  FROM number_of_plantations_in_swiss_forest AS T\n  JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n  WHERE S.country = 'TRUE'\n    AND T.type_of_owner = 'Type of owners - total'\n    AND T.wood_species = 'Species - total'\n    AND T.forest_zone != 'Switzerland'\n    AND T.number_of_plantations != 0\n  GROUP BY T.year\n)\nSELECT\n  Curr.year,\n  Curr.number_of_plantations_switzerland,\n  ROUND(100 * (Curr.number_of_plantations_switzerland - Prev.number_of_plantations_switzerland) / (Prev.number_of_plantations_switzerland), 2) AS change_from_previous_year\nFROM PlantationsByYear AS Curr\nLEFT JOIN PlantationsByYear AS Prev ON Curr.year = Prev.year + 1\nORDER BY Curr.year DESC;\n",
        "score": 0.5430328845977783
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.number_of_plantations_in_swiss_forest (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tforest_zone TEXT, \n\ttype_of_owner TEXT, \n\twood_species TEXT, \n\tnumber_of_plantations NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT number_of_plantations_in_swiss_forest_pkey PRIMARY KEY (uid), \n\tCONSTRAINT number_of_plantations_in_swiss_forest_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in number_of_plantations_in_swiss_forest and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nnumber_of_plantations : 586994, 202385, 377625, 1636447, 39980\nspatialunit_uid : 1_A.ADM1, 24_A.ADM1, 23_A.ADM1, 8_A.ADM1, 22_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\nforest_zone, forest zone, Switzerland,Jura,Central Plain\ntype_of_owner, owner type, Type of owners - total,Public forest,Private forest\nwood_species, wood species group, Species - total,Hardwood (deciduous),Softwood (conifers)\nnumber_of_plantations, number of plantations, 14987125 ,11537284 ,3449841\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nProvide the change over the years of the total number of forests registered in Switzerland. The change should be given in percentage of the number of the previous year.\n### SQL query\nWITH PlantationsByYear AS (\n  SELECT T.year,\n    SUM(T.number_of_plantations) AS number_of_plantations_switzerland\n  FROM number_of_plantations_in_swiss_forest AS T\n  JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n  WHERE S.country = 'TRUE'\n    AND T.type_of_owner = 'Type of owners - total'\n    AND T.wood_species = 'Species - total'\n    AND T.forest_zone != 'Switzerland'\n    AND T.number_of_plantations != 0\n  GROUP BY T.year\n)\nSELECT\n  Curr.year,\n  Curr.number_of_plantations_switzerland,\n  ROUND(100 * (Curr.number_of_plantations_switzerland - Prev.number_of_plantations_switzerland) / (Prev.number_of_plantations_switzerland), 2) AS change_from_previous_year\nFROM PlantationsByYear AS Curr\nLEFT JOIN PlantationsByYear AS Prev ON Curr.year = Prev.year + 1\nORDER BY Curr.year DESC;\n\n\n### Question\nHow much did the number of Swiss forest change from 1975 to 2022? Show the change in total and by forest type as conifers or deciduous.\n### SQL query\nSELECT\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_deciduous_number_of_forests_1975_to_2022,\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_conifers_number_of_forests_1975_to_2022,\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%total%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%total%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_total_number_of_forests_1975_to_2022\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.year IN (1975, 2022)\n  AND S.name = 'Switzerland'\n  AND T.forest_zone = 'Switzerland'\n  AND T.type_of_owner = 'Type of owners - total';\n\n\n### Question\nWhat were proportions, in percent, of deciduous and coniferous forests in Switzerland in 2020?\n### SQL query\n",
    "process_time": 23.47132183215581,
    "num_tokens": 1592,
    "hardness": "unknown",
    "scores": [
      0.25949716567993164,
      0.5430328845977783
    ],
    "lang": "en"
  },
  {
    "i": 5,
    "question": "By 2022: Which three forest zones had the most plantations in Switzerland? Provide the forest zones together with the number of plantations.",
    "query": "SELECT T.forest_zone, SUM(T.number_of_plantations) as number_of_plantations\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.type_of_owner = 'Type of owners - total'\n  AND T.year = 2022\n  AND T.number_of_plantations != 0 AND number_of_plantations IS NOT NULL\n  AND T.forest_zone != 'Switzerland'\nGROUP BY T.forest_zone\nORDER BY number_of_plantations DESC LIMIT 3;\n",
    "db_id": "number_of_plantations_in_swiss_forest",
    "generated_query": "SELECT T.forest_zone, T.number_of_plantations\nFROM number_of_plantations_in_swiss_forest AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.year = 2022\n  AND S.name = 'Switzerland'\n  AND T.forest_zone != 'Switzerland'\n  AND T.type_of_owner = 'Type of owners - total'\n  AND T.wood_species = 'Species - total'\nORDER BY T.number_of_plantations DESC\nLIMIT 3;",
    "meta_data": [
      {
        "question": "How much did the number of Swiss forest change from 1975 to 2022? Show the change in total and by forest type as conifers or deciduous.",
        "query": "SELECT\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_deciduous_number_of_forests_1975_to_2022,\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_conifers_number_of_forests_1975_to_2022,\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%total%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%total%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_total_number_of_forests_1975_to_2022\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.year IN (1975, 2022)\n  AND S.name = 'Switzerland'\n  AND T.forest_zone = 'Switzerland'\n  AND T.type_of_owner = 'Type of owners - total';\n",
        "score": 0.4225274622440338
      },
      {
        "question": "Provide the change over the years of the total number of forests registered in Switzerland. The change should be given in percentage of the number of the previous year.",
        "query": "WITH PlantationsByYear AS (\n  SELECT T.year,\n    SUM(T.number_of_plantations) AS number_of_plantations_switzerland\n  FROM number_of_plantations_in_swiss_forest AS T\n  JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n  WHERE S.country = 'TRUE'\n    AND T.type_of_owner = 'Type of owners - total'\n    AND T.wood_species = 'Species - total'\n    AND T.forest_zone != 'Switzerland'\n    AND T.number_of_plantations != 0\n  GROUP BY T.year\n)\nSELECT\n  Curr.year,\n  Curr.number_of_plantations_switzerland,\n  ROUND(100 * (Curr.number_of_plantations_switzerland - Prev.number_of_plantations_switzerland) / (Prev.number_of_plantations_switzerland), 2) AS change_from_previous_year\nFROM PlantationsByYear AS Curr\nLEFT JOIN PlantationsByYear AS Prev ON Curr.year = Prev.year + 1\nORDER BY Curr.year DESC;\n",
        "score": 0.5178351998329163
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.number_of_plantations_in_swiss_forest (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tforest_zone TEXT, \n\ttype_of_owner TEXT, \n\twood_species TEXT, \n\tnumber_of_plantations NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT number_of_plantations_in_swiss_forest_pkey PRIMARY KEY (uid), \n\tCONSTRAINT number_of_plantations_in_swiss_forest_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in number_of_plantations_in_swiss_forest and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nnumber_of_plantations : 586994, 202385, 377625, 1636447, 39980\nspatialunit_uid : 1_A.ADM1, 24_A.ADM1, 23_A.ADM1, 8_A.ADM1, 22_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\nforest_zone, forest zone, Switzerland,Jura,Central Plain\ntype_of_owner, owner type, Type of owners - total,Public forest,Private forest\nwood_species, wood species group, Species - total,Hardwood (deciduous),Softwood (conifers)\nnumber_of_plantations, number of plantations, 14987125 ,11537284 ,3449841\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nProvide the change over the years of the total number of forests registered in Switzerland. The change should be given in percentage of the number of the previous year.\n### SQL query\nWITH PlantationsByYear AS (\n  SELECT T.year,\n    SUM(T.number_of_plantations) AS number_of_plantations_switzerland\n  FROM number_of_plantations_in_swiss_forest AS T\n  JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n  WHERE S.country = 'TRUE'\n    AND T.type_of_owner = 'Type of owners - total'\n    AND T.wood_species = 'Species - total'\n    AND T.forest_zone != 'Switzerland'\n    AND T.number_of_plantations != 0\n  GROUP BY T.year\n)\nSELECT\n  Curr.year,\n  Curr.number_of_plantations_switzerland,\n  ROUND(100 * (Curr.number_of_plantations_switzerland - Prev.number_of_plantations_switzerland) / (Prev.number_of_plantations_switzerland), 2) AS change_from_previous_year\nFROM PlantationsByYear AS Curr\nLEFT JOIN PlantationsByYear AS Prev ON Curr.year = Prev.year + 1\nORDER BY Curr.year DESC;\n\n\n### Question\nHow much did the number of Swiss forest change from 1975 to 2022? Show the change in total and by forest type as conifers or deciduous.\n### SQL query\nSELECT\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_deciduous_number_of_forests_1975_to_2022,\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_conifers_number_of_forests_1975_to_2022,\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%total%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%total%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_total_number_of_forests_1975_to_2022\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.year IN (1975, 2022)\n  AND S.name = 'Switzerland'\n  AND T.forest_zone = 'Switzerland'\n  AND T.type_of_owner = 'Type of owners - total';\n\n\n### Question\nBy 2022: Which three forest zones had the most plantations in Switzerland? Provide the forest zones together with the number of plantations.\n### SQL query\n",
    "process_time": 8.336612971965224,
    "num_tokens": 1599,
    "hardness": "unknown",
    "scores": [
      0.4225274622440338,
      0.5178351998329163
    ],
    "lang": "en"
  },
  {
    "i": 6,
    "question": "How many FTE were allocated to tourism were there in Switzerland 2019?",
    "query": "SELECT T.total_full_time_employment_of_tourism\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND S.name = 'Switzerland'\n    AND T.year = 2019;\n",
    "db_id": "tourism_economy_by_canton",
    "generated_query": "SELECT SUM(total_full_time_employment_of_tourism) as total_fte_tourism_2019\nFROM tourism_economy_by_canton\nWHERE year = 2019;",
    "meta_data": [
      {
        "question": "What was the percent of gross value added for tourism in the cantons of Zurich, Bern and Geneva in 2017?",
        "query": "SELECT S.name as canton, T.percent_share_gross_value_added_of_tourism\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2017\n    AND (\n        S.name LIKE '%Zurich%'\n        OR S.name LIKE '%Geneva%'\n        OR S.name LIKE '%Bern%'\n    );\n",
        "score": 0.6410764455795288
      },
      {
        "question": "How much did each canton earn from tourism in 2019?",
        "query": "SELECT S.name as canton,\nT.mio_chf_gross_value_added_of_tourism as mio_chf_gross_value_added_of_tourism_2019\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2019\nORDER BY mio_chf_gross_value_added_of_tourism_2019 DESC;\n",
        "score": 0.6854605674743652
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.tourism_economy_by_canton (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tmio_chf_gross_value_added_of_tourism NUMERIC, \n\tpercent_share_gross_value_added_of_tourism NUMERIC, \n\ttotal_full_time_employment_of_tourism NUMERIC, \n\tpercent_share_full_time_employment_of_tourism NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT tourism_economy_by_canton_pkey PRIMARY KEY (uid), \n\tCONSTRAINT tourism_economy_by_canton_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in tourism_economy_by_canton and 5 examples in each column for high cardinality columns :\nuid : 92, 78, 95, 46, 12\nmio_chf_gross_value_added_of_tourism : 95.219999999999999, 81.650000000000006, 1138.609999999999900, 3953.380000000000109, 19167.549999999999272\npercent_share_gross_value_added_of_tourism : 1.93999999999999995, 0.90000000000000002, 2.18000000000000016, 1.90999999999999992, 3.83000000000000007\ntotal_full_time_employment_of_tourism : 15995.32999999999993, 2541.42000000000007, 16853.06000000000131, 16285.47999999999956, 1778.58999999999992\npercent_share_full_time_employment_of_tourism : 6.7699999999999996, 3.6699999999999999, 6.2500000000000000, 13.8100000000000005, 5.1100000000000003\nspatialunit_uid : 1_A.ADM1, 24_A.ADM1, 23_A.ADM1, 8_A.ADM1, 22_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\nmio_chf_gross_value_added_of_tourism, Amount in million CHF of Gross Value that was added by tourism, None\npercent_share_gross_value_added_of_tourism, Percentage share of Gross Value that was added by tourism, None\ntotal_full_time_employment_of_tourism, Full time employment in Tourism, None\npercent_share_full_time_employment_of_tourism, Percentage share of full time employment in tourism, None\n*/\n\n\n\n### Question\nWhat was the percent of gross value added for tourism in the cantons of Zurich, Bern and Geneva in 2017?\n### SQL query\nSELECT S.name as canton, T.percent_share_gross_value_added_of_tourism\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2017\n    AND (\n        S.name LIKE '%Zurich%'\n        OR S.name LIKE '%Geneva%'\n        OR S.name LIKE '%Bern%'\n    );\n\n\n### Question\nHow much did each canton earn from tourism in 2019?\n### SQL query\nSELECT S.name as canton,\nT.mio_chf_gross_value_added_of_tourism as mio_chf_gross_value_added_of_tourism_2019\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2019\nORDER BY mio_chf_gross_value_added_of_tourism_2019 DESC;\n\n\n### Question\nHow many FTE were allocated to tourism were there in Switzerland 2019?\n### SQL query\n",
    "process_time": 5.328595662955195,
    "num_tokens": 1430,
    "hardness": "medium",
    "scores": [
      0.6410764455795288,
      0.6854605674743652
    ],
    "lang": "en"
  },
  {
    "i": 7,
    "question": "Which canton has the most employees in the tourism sector in 2019?",
    "query": "SELECT S.name AS canton\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2019\nORDER BY T.total_full_time_employment_of_tourism DESC LIMIT 1;\n",
    "db_id": "tourism_economy_by_canton",
    "generated_query": "SELECT S.name as canton,\nT.total_full_time_employment_of_tourism as total_full_time_employment_of_tourism_2019\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2019\nORDER BY total_full_time_employment_of_tourism_2019 DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "What canton lost the highest share of revenue from tourism between 2016 and 2019, and what percentage did it lose?",
        "query": "SELECT\n    S.name AS canton,\n    SUM(CASE WHEN T.year = 2019 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) -\n    SUM(CASE WHEN T.year = 2016 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) AS diff_percentage_gross_value_added_of_tourism_2019_2016\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year IN (2016, 2019)\nGROUP BY S.name\nORDER BY diff_percentage_gross_value_added_of_tourism_2019_2016 ASC\nLIMIT 1;\n",
        "score": 0.35749000310897827
      },
      {
        "question": "How much did each canton earn from tourism in 2019?",
        "query": "SELECT S.name as canton,\nT.mio_chf_gross_value_added_of_tourism as mio_chf_gross_value_added_of_tourism_2019\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2019\nORDER BY mio_chf_gross_value_added_of_tourism_2019 DESC;\n",
        "score": 0.42122605443000793
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.tourism_economy_by_canton (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tmio_chf_gross_value_added_of_tourism NUMERIC, \n\tpercent_share_gross_value_added_of_tourism NUMERIC, \n\ttotal_full_time_employment_of_tourism NUMERIC, \n\tpercent_share_full_time_employment_of_tourism NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT tourism_economy_by_canton_pkey PRIMARY KEY (uid), \n\tCONSTRAINT tourism_economy_by_canton_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in tourism_economy_by_canton and 5 examples in each column for high cardinality columns :\nuid : 92, 78, 95, 46, 12\nmio_chf_gross_value_added_of_tourism : 95.219999999999999, 81.650000000000006, 1138.609999999999900, 3953.380000000000109, 19167.549999999999272\npercent_share_gross_value_added_of_tourism : 1.93999999999999995, 0.90000000000000002, 2.18000000000000016, 1.90999999999999992, 3.83000000000000007\ntotal_full_time_employment_of_tourism : 15995.32999999999993, 2541.42000000000007, 16853.06000000000131, 16285.47999999999956, 1778.58999999999992\npercent_share_full_time_employment_of_tourism : 6.7699999999999996, 3.6699999999999999, 6.2500000000000000, 13.8100000000000005, 5.1100000000000003\nspatialunit_uid : 1_A.ADM1, 24_A.ADM1, 23_A.ADM1, 8_A.ADM1, 22_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\nmio_chf_gross_value_added_of_tourism, Amount in million CHF of Gross Value that was added by tourism, None\npercent_share_gross_value_added_of_tourism, Percentage share of Gross Value that was added by tourism, None\ntotal_full_time_employment_of_tourism, Full time employment in Tourism, None\npercent_share_full_time_employment_of_tourism, Percentage share of full time employment in tourism, None\n*/\n\n\n\n### Question\nWhat canton lost the highest share of revenue from tourism between 2016 and 2019, and what percentage did it lose?\n### SQL query\nSELECT\n    S.name AS canton,\n    SUM(CASE WHEN T.year = 2019 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) -\n    SUM(CASE WHEN T.year = 2016 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) AS diff_percentage_gross_value_added_of_tourism_2019_2016\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year IN (2016, 2019)\nGROUP BY S.name\nORDER BY diff_percentage_gross_value_added_of_tourism_2019_2016 ASC\nLIMIT 1;\n\n\n### Question\nHow much did each canton earn from tourism in 2019?\n### SQL query\nSELECT S.name as canton,\nT.mio_chf_gross_value_added_of_tourism as mio_chf_gross_value_added_of_tourism_2019\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2019\nORDER BY mio_chf_gross_value_added_of_tourism_2019 DESC;\n\n\n### Question\nWhich canton has the most employees in the tourism sector in 2019?\n### SQL query\n",
    "process_time": 9.520253592869267,
    "num_tokens": 1499,
    "hardness": "unknown",
    "scores": [
      0.35749000310897827,
      0.42122605443000793
    ],
    "lang": "en"
  },
  {
    "i": 8,
    "question": "What canton got the most money from tourism in 2016?",
    "query": "SELECT S.name AS canton\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2016\nORDER BY T.mio_chf_gross_value_added_of_tourism DESC LIMIT 1;\n",
    "db_id": "tourism_economy_by_canton",
    "generated_query": "SELECT S.name as canton,\nT.mio_chf_gross_value_added_of_tourism as mio_chf_gross_value_added_of_tourism_2016\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2016\nORDER BY mio_chf_gross_value_added_of_tourism_2016 DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "What canton lost the highest share of revenue from tourism between 2016 and 2019, and what percentage did it lose?",
        "query": "SELECT\n    S.name AS canton,\n    SUM(CASE WHEN T.year = 2019 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) -\n    SUM(CASE WHEN T.year = 2016 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) AS diff_percentage_gross_value_added_of_tourism_2019_2016\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year IN (2016, 2019)\nGROUP BY S.name\nORDER BY diff_percentage_gross_value_added_of_tourism_2019_2016 ASC\nLIMIT 1;\n",
        "score": 0.25119173526763916
      },
      {
        "question": "How much did each canton earn from tourism in 2019?",
        "query": "SELECT S.name as canton,\nT.mio_chf_gross_value_added_of_tourism as mio_chf_gross_value_added_of_tourism_2019\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2019\nORDER BY mio_chf_gross_value_added_of_tourism_2019 DESC;\n",
        "score": 0.35115519165992737
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.tourism_economy_by_canton (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tmio_chf_gross_value_added_of_tourism NUMERIC, \n\tpercent_share_gross_value_added_of_tourism NUMERIC, \n\ttotal_full_time_employment_of_tourism NUMERIC, \n\tpercent_share_full_time_employment_of_tourism NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT tourism_economy_by_canton_pkey PRIMARY KEY (uid), \n\tCONSTRAINT tourism_economy_by_canton_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in tourism_economy_by_canton and 5 examples in each column for high cardinality columns :\nuid : 92, 78, 95, 46, 12\nmio_chf_gross_value_added_of_tourism : 95.219999999999999, 81.650000000000006, 1138.609999999999900, 3953.380000000000109, 19167.549999999999272\npercent_share_gross_value_added_of_tourism : 1.93999999999999995, 0.90000000000000002, 2.18000000000000016, 1.90999999999999992, 3.83000000000000007\ntotal_full_time_employment_of_tourism : 15995.32999999999993, 2541.42000000000007, 16853.06000000000131, 16285.47999999999956, 1778.58999999999992\npercent_share_full_time_employment_of_tourism : 6.7699999999999996, 3.6699999999999999, 6.2500000000000000, 13.8100000000000005, 5.1100000000000003\nspatialunit_uid : 1_A.ADM1, 24_A.ADM1, 23_A.ADM1, 8_A.ADM1, 22_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\nmio_chf_gross_value_added_of_tourism, Amount in million CHF of Gross Value that was added by tourism, None\npercent_share_gross_value_added_of_tourism, Percentage share of Gross Value that was added by tourism, None\ntotal_full_time_employment_of_tourism, Full time employment in Tourism, None\npercent_share_full_time_employment_of_tourism, Percentage share of full time employment in tourism, None\n*/\n\n\n\n### Question\nWhat canton lost the highest share of revenue from tourism between 2016 and 2019, and what percentage did it lose?\n### SQL query\nSELECT\n    S.name AS canton,\n    SUM(CASE WHEN T.year = 2019 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) -\n    SUM(CASE WHEN T.year = 2016 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) AS diff_percentage_gross_value_added_of_tourism_2019_2016\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year IN (2016, 2019)\nGROUP BY S.name\nORDER BY diff_percentage_gross_value_added_of_tourism_2019_2016 ASC\nLIMIT 1;\n\n\n### Question\nHow much did each canton earn from tourism in 2019?\n### SQL query\nSELECT S.name as canton,\nT.mio_chf_gross_value_added_of_tourism as mio_chf_gross_value_added_of_tourism_2019\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2019\nORDER BY mio_chf_gross_value_added_of_tourism_2019 DESC;\n\n\n### Question\nWhat canton got the most money from tourism in 2016?\n### SQL query\n",
    "process_time": 8.469041160074994,
    "num_tokens": 1497,
    "hardness": "unknown",
    "scores": [
      0.25119173526763916,
      0.35115519165992737
    ],
    "lang": "en"
  },
  {
    "i": 9,
    "question": "What kind of animal farms existed in Kanton Uri in 2012? Give the number of each farm type.",
    "query": "SELECT beef_cattle_and_cows_farm, horse_and_other_equine_farm,\n  sheep_farm, goat_farm, pig_farms, poultry_farm, farms_with_other_animals\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Uri%'\n    AND S.canton = 'TRUE'\n    AND T.year = 2012\n    AND T.farmholding_system = 'Farmholding system - total';\n",
    "db_id": "employees_farmholdings_agricultural_area_livestock_per_canton",
    "generated_query": "SELECT\n   T.beef_cattle_and_cows_farm as number_of_beef_cattle_and_cows_farm,\n   T.horse_and_other_equine_farm as number_of_horse_and_other_equine_farm,\n   T.sheep_farm as number_of_sheep_farm,\n   T.goat_farm as number_of_goat_farm,\n   T.pig_farms as number_of_pig_farms,\n   T.poultry_farm as number_of_poultry_farm,\n   T.farms_with_other_animals as number_of_farms_with_other_animals\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Kanton Uri'\n    AND T.year = 2012;",
    "meta_data": [
      {
        "question": "How did organic versus conventional farming develop in Kanton Uri between 2010 and 2020? Consider the farm area and the number of farms and give the differences.",
        "query": "SELECT\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) AS increase_organic_farm_area_in_ha,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Organic farming'\n       THEN T.farmholdings ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Organic farming'\n       THEN T.farmholdings ELSE 0 END) AS increase_number_of_organic_farms,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Conventional farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Conventional farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) AS increase_conventional_farm_area_in_ha,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Conventional farming'\n       THEN T.farmholdings ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Conventional farming'\n       THEN T.farmholdings ELSE 0 END) AS increase_number_of_conventional_farms\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND S.name LIKE '%Uri%'\n  AND T.year IN (2010, 2020)\n  AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n",
        "score": 0.694978654384613
      },
      {
        "question": "Which 5 cantons had in 2022 the biggest precentage of their farm area used by organic farming? Order by the percentage of area used for organic farming.",
        "query": "SELECT S.name,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) /\n   NULLIF(SUM(CASE WHEN T.farmholding_system = 'Farmholding system - total'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END), 0), 2) AS percentage_of_organically_used_farmarea\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.canton = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Farmholding system - total')\nGROUP BY S.name\nORDER BY percentage_of_organically_used_farmarea DESC LIMIT 5;\n",
        "score": 0.9231363534927368
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.employees_farmholdings_agricultural_area_livestock_per_canton (\n\tuid SERIAL NOT NULL, \n\tfarmholding_system TEXT, \n\tyear INTEGER, \n\tfarmholdings NUMERIC, \n\temployees_total NUMERIC, \n\tfull_time_employees_75_percent_or_more NUMERIC, \n\tpart_time_employees_50_75_percent NUMERIC, \n\tpart_time_employees_2_less_than_50_percent NUMERIC, \n\temployees_men NUMERIC, \n\temployees_women NUMERIC, \n\temployees_women_manager_label NUMERIC, \n\temployees_swiss NUMERIC, \n\temployees_foreign_nationals NUMERIC, \n\tfamily_employees NUMERIC, \n\tbeef_cattle_and_cows_farm NUMERIC, \n\thorse_and_other_equine_farm NUMERIC, \n\tsheep_farm NUMERIC, \n\tgoat_farm NUMERIC, \n\tpig_farms NUMERIC, \n\tpoultry_farm NUMERIC, \n\tfarms_with_other_animals NUMERIC, \n\tutilised_agricultural_area_in_hectares NUMERIC, \n\tarable_land_in_hectares NUMERIC, \n\tgrassland_in_hectares NUMERIC, \n\tpermanent_crops_in_hectares NUMERIC, \n\tother_utilised_agricultural_area_in_hectares NUMERIC, \n\tlivestock_beef_cattle_and_cows NUMERIC, \n\tlivestock_horses_and_other_equines NUMERIC, \n\tlivestock_sheep NUMERIC, \n\tlivestock_goats NUMERIC, \n\tlivestock_pigs NUMERIC, \n\tlivestock_poultry NUMERIC, \n\tlivestock_other_animals NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT employees_farmholdings_agricultural_area_livestock_per_can_pkey PRIMARY KEY (uid), \n\tCONSTRAINT employees_farmholdings_agricultural_area_l_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in employees_farmholdings_agricultural_area_livestock_per_canton and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nyear : 2014, 2006, 2002, 2005, 2017\nfarmholdings : 63343, 65635, 54057, 352, 5897\nemployees_total : 11513, 199675, 22467, 18662, 10440\nfull_time_employees_75_percent_or_more : 68632, 74466, 458, 6619, 6430\npart_time_employees_50_75_percent : 228, 1666, 2503, 3958, 240\npart_time_employees_2_less_than_50_percent : 58492, 54660, 75911, 4244, 65900\nemployees_men : 672, 5279, 129161, 87326, 12871\nemployees_women : 7204, 44347, 3986, 710, 429\nemployees_women_manager_label : 3289, 324, 2361, 234, 36\nemployees_swiss : 156187, 109492, 966, 140683, 16069\nemployees_foreign_nationals : 12944, 3664, 12172, 14364, 14714\nfamily_employees : 792, 15483, 16850, 819, 7727\nbeef_cattle_and_cows_farm : 2269, 2195, 278, 240, 234\nhorse_and_other_equine_farm : 886, 1323, 822, 1521, 12255\nsheep_farm : 92, 12040, 505, 78, 416\ngoat_farm : 5279, 324, 1271, 1224, 458\npig_farms : 720, 12885, 6802, 461, 30\npoultry_farm : 737, 822, 16363, 2384, 14434\nfarms_with_other_animals : 416, 5072, 7210, 46, 338\nutilised_agricultural_area_in_hectares : 73768.929999999993015, 72373.139999999999418, 1082876.239999999990687, 855678.878299999982119, 1064573.979999999981374\narable_land_in_hectares : 1381.839999999999918145, 9142.000000000000000000, 1444.200000000000045475, 1075.640000000000100044, 1327.490000000000009095\ngrassland_in_hectares : 102642.039999999993597, 616792.741099999984726, 644087.760000000009313, 640454.430000000051223, 38321.419999999998254\npermanent_crops_in_hectares : 1418.980000000000018190, 56.149999999999998579, 1125.400000000000090949, 1577.868300000000090222, 22093.339599999999336433\nother_utilised_agricultural_area_in_hectares : 12441.640400000000227010, 308.819999999999993179, 9842.200000000000727596, 1630.089999999999918145, 946.009999999999990905\nlivestock_beef_cattle_and_cows : 82139, 1588005, 156773, 9101, 97531\nlivestock_horses_and_other_equines : 5881, 9683, 6227, 811, 927\nlivestock_sheep : 90557, 14364, 17601, 352493, 350320\nlivestock_goats : 82313, 74269, 57915, 21204, 2109\nlivestock_pigs : 40986, 505, 37121, 1590952, 40318\nlivestock_poultry : 18920, 10078981, 6907546, 33697, 36379\nlivestock_other_animals : 121621, 43682, 8150, 13615, 141127\n*/\n\n/*\nColumn name, Column discription, Example values\nfarmholding_system, None, Farmholding system - total,Organic farming,Conventional farming\nfarmholdings, None, 48344,48864,49363\nemployees_total, None, 149578,150231,149521\nfull_time_employees_75_percent_or_more, None, 66349,66453,66333\npart_time_employees_50_75_percent, None, 30083,30038,29920\npart_time_employees_2_less_than_50_percent, None, 53146,53740,53268\nemployees_men, None, 94706,95486,95252\nemployees_women, None, 54872,54745,54269\nemployees_women_manager_label, None, 3472,3362,3233\nemployees_swiss, None, 131072,131955,131581\nemployees_foreign_nationals, None, 18506,18276,17940\nfamily_employees, None, 112047,113317,113847\nbeef_cattle_and_cows_farm, None, 32581,33091,33662\nhorse_and_other_equine_farm, None, 11123,11196,11227\nsheep_farm, None, 7969,7977,8016\ngoat_farm, None, 6559,6592,6355\npig_farms, None, 5467,5561,5600\npoultry_farm, None, 14876,14434,13485\nfarms_with_other_animals, None, 6138,6101,6000\nutilised_agricultural_area_in_hectares, None, 1042013.785,1042053.004,1044033.706\narable_land_in_hectares, None, 276114.0758,276496.4816,274448.9291\ngrassland_in_hectares, None, 726091.9808,725854.0912,730039.4586\npermanent_crops_in_hectares, None, 24040.2951,24285.0786,24061.4945\nother_utilised_agricultural_area_in_hectares, None, 15767.4333,15417.3522,15483.8239\nlivestock_beef_cattle_and_cows, None, 1525270,1513701,1515123\nlivestock_horses_and_other_equines, None, 80950,80096,80072\nlivestock_sheep, None, 355893,349112,343528\nlivestock_goats, None, 82313,82045,79562\nlivestock_pigs, None, 1372772,1366359,1348306\nlivestock_poultry, None, 13219724,12676402,12541044\nlivestock_other_animals, None, 126789,137616,131876\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWhat were the 5 cantons farming the most pigs in 2012?\n### SQL query\nSELECT S.name as canton_name, livestock_pigs as total_pigs\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2012\n    AND T.farmholding_system = 'Farmholding system - total'\nORDER BY livestock_pigs DESC\nLIMIT 5;\n\n\n### Question\nWhat was the precentage of family employees in organic and conventional farming in 2022?\n### SQL query\nSELECT\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.family_employees ELSE 0 END) /\n   SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.employees_total ELSE 0 END), 2) AS percentage_family_employees_organic_farming,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Conventional farming'\n       THEN T.family_employees ELSE 0 END) /\n   SUM(CASE WHEN T.farmholding_system = 'Conventional farming'\n       THEN T.employees_total ELSE 0 END), 2) AS percentage_family_employees_conventional_farming\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n\n\n### Question\nWhat kind of animal farms existed in Kanton Uri in 2012? Give the number of each farm type.\n### SQL query\n",
    "process_time": 21.245511542074382,
    "num_tokens": 3086,
    "hardness": "hard",
    "scores": [
      0.694978654384613,
      0.9231363534927368
    ],
    "lang": "en"
  },
  {
    "i": 10,
    "question": "How many farms were there in all of Switzerland between 2012 and 2018?",
    "query": "SELECT year, farmholdings\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n    AND S.country = 'TRUE'\n    AND year BETWEEN 2012 AND 2018\n    AND T.farmholding_system = 'Farmholding system - total';\n",
    "db_id": "employees_farmholdings_agricultural_area_livestock_per_canton",
    "generated_query": "SELECT SUM(farmholdings) as total_farms\nFROM employees_farmholdings_agricultural_area_livestock_per_canton\nWHERE year BETWEEN 2012 AND 2018\n    AND farmholding_system = 'Farmholding system - total';",
    "meta_data": [
      {
        "question": "What was the average number of cows per farm in the canton of Vaud since 2017?",
        "query": "SELECT year, livestock_beef_cattle_and_cows / farmholdings AS average_cows_per_farmholding_vaud\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Canton Vaud'\n    AND S.canton = 'TRUE'\n    AND year >= 2017\n    AND T.farmholding_system = 'Farmholding system - total';\n",
        "score": 0.45318877696990967
      },
      {
        "question": "How was the split between Swiss population and foreign nationals on Swiss farms in 2022?",
        "query": "SELECT ROUND(100 * employees_swiss / employees_total, 2) AS percentage_of_swiss_employees,\n  ROUND(100 * employees_foreign_nationals / employees_total, 2) AS percentage_foreign_nationals_employees\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total';\n",
        "score": 0.4957975149154663
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.employees_farmholdings_agricultural_area_livestock_per_canton (\n\tuid SERIAL NOT NULL, \n\tfarmholding_system TEXT, \n\tyear INTEGER, \n\tfarmholdings NUMERIC, \n\temployees_total NUMERIC, \n\tfull_time_employees_75_percent_or_more NUMERIC, \n\tpart_time_employees_50_75_percent NUMERIC, \n\tpart_time_employees_2_less_than_50_percent NUMERIC, \n\temployees_men NUMERIC, \n\temployees_women NUMERIC, \n\temployees_women_manager_label NUMERIC, \n\temployees_swiss NUMERIC, \n\temployees_foreign_nationals NUMERIC, \n\tfamily_employees NUMERIC, \n\tbeef_cattle_and_cows_farm NUMERIC, \n\thorse_and_other_equine_farm NUMERIC, \n\tsheep_farm NUMERIC, \n\tgoat_farm NUMERIC, \n\tpig_farms NUMERIC, \n\tpoultry_farm NUMERIC, \n\tfarms_with_other_animals NUMERIC, \n\tutilised_agricultural_area_in_hectares NUMERIC, \n\tarable_land_in_hectares NUMERIC, \n\tgrassland_in_hectares NUMERIC, \n\tpermanent_crops_in_hectares NUMERIC, \n\tother_utilised_agricultural_area_in_hectares NUMERIC, \n\tlivestock_beef_cattle_and_cows NUMERIC, \n\tlivestock_horses_and_other_equines NUMERIC, \n\tlivestock_sheep NUMERIC, \n\tlivestock_goats NUMERIC, \n\tlivestock_pigs NUMERIC, \n\tlivestock_poultry NUMERIC, \n\tlivestock_other_animals NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT employees_farmholdings_agricultural_area_livestock_per_can_pkey PRIMARY KEY (uid), \n\tCONSTRAINT employees_farmholdings_agricultural_area_l_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in employees_farmholdings_agricultural_area_livestock_per_canton and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nyear : 2014, 2006, 2002, 2005, 2017\nfarmholdings : 63343, 65635, 54057, 352, 5897\nemployees_total : 11513, 199675, 22467, 18662, 10440\nfull_time_employees_75_percent_or_more : 68632, 74466, 458, 6619, 6430\npart_time_employees_50_75_percent : 228, 1666, 2503, 3958, 240\npart_time_employees_2_less_than_50_percent : 58492, 54660, 75911, 4244, 65900\nemployees_men : 672, 5279, 129161, 87326, 12871\nemployees_women : 7204, 44347, 3986, 710, 429\nemployees_women_manager_label : 3289, 324, 2361, 234, 36\nemployees_swiss : 156187, 109492, 966, 140683, 16069\nemployees_foreign_nationals : 12944, 3664, 12172, 14364, 14714\nfamily_employees : 792, 15483, 16850, 819, 7727\nbeef_cattle_and_cows_farm : 2269, 2195, 278, 240, 234\nhorse_and_other_equine_farm : 886, 1323, 822, 1521, 12255\nsheep_farm : 92, 12040, 505, 78, 416\ngoat_farm : 5279, 324, 1271, 1224, 458\npig_farms : 720, 12885, 6802, 461, 30\npoultry_farm : 737, 822, 16363, 2384, 14434\nfarms_with_other_animals : 416, 5072, 7210, 46, 338\nutilised_agricultural_area_in_hectares : 73768.929999999993015, 72373.139999999999418, 1082876.239999999990687, 855678.878299999982119, 1064573.979999999981374\narable_land_in_hectares : 1381.839999999999918145, 9142.000000000000000000, 1444.200000000000045475, 1075.640000000000100044, 1327.490000000000009095\ngrassland_in_hectares : 102642.039999999993597, 616792.741099999984726, 644087.760000000009313, 640454.430000000051223, 38321.419999999998254\npermanent_crops_in_hectares : 1418.980000000000018190, 56.149999999999998579, 1125.400000000000090949, 1577.868300000000090222, 22093.339599999999336433\nother_utilised_agricultural_area_in_hectares : 12441.640400000000227010, 308.819999999999993179, 9842.200000000000727596, 1630.089999999999918145, 946.009999999999990905\nlivestock_beef_cattle_and_cows : 82139, 1588005, 156773, 9101, 97531\nlivestock_horses_and_other_equines : 5881, 9683, 6227, 811, 927\nlivestock_sheep : 90557, 14364, 17601, 352493, 350320\nlivestock_goats : 82313, 74269, 57915, 21204, 2109\nlivestock_pigs : 40986, 505, 37121, 1590952, 40318\nlivestock_poultry : 18920, 10078981, 6907546, 33697, 36379\nlivestock_other_animals : 121621, 43682, 8150, 13615, 141127\n*/\n\n/*\nColumn name, Column discription, Example values\nfarmholding_system, None, Farmholding system - total,Organic farming,Conventional farming\nfarmholdings, None, 48344,48864,49363\nemployees_total, None, 149578,150231,149521\nfull_time_employees_75_percent_or_more, None, 66349,66453,66333\npart_time_employees_50_75_percent, None, 30083,30038,29920\npart_time_employees_2_less_than_50_percent, None, 53146,53740,53268\nemployees_men, None, 94706,95486,95252\nemployees_women, None, 54872,54745,54269\nemployees_women_manager_label, None, 3472,3362,3233\nemployees_swiss, None, 131072,131955,131581\nemployees_foreign_nationals, None, 18506,18276,17940\nfamily_employees, None, 112047,113317,113847\nbeef_cattle_and_cows_farm, None, 32581,33091,33662\nhorse_and_other_equine_farm, None, 11123,11196,11227\nsheep_farm, None, 7969,7977,8016\ngoat_farm, None, 6559,6592,6355\npig_farms, None, 5467,5561,5600\npoultry_farm, None, 14876,14434,13485\nfarms_with_other_animals, None, 6138,6101,6000\nutilised_agricultural_area_in_hectares, None, 1042013.785,1042053.004,1044033.706\narable_land_in_hectares, None, 276114.0758,276496.4816,274448.9291\ngrassland_in_hectares, None, 726091.9808,725854.0912,730039.4586\npermanent_crops_in_hectares, None, 24040.2951,24285.0786,24061.4945\nother_utilised_agricultural_area_in_hectares, None, 15767.4333,15417.3522,15483.8239\nlivestock_beef_cattle_and_cows, None, 1525270,1513701,1515123\nlivestock_horses_and_other_equines, None, 80950,80096,80072\nlivestock_sheep, None, 355893,349112,343528\nlivestock_goats, None, 82313,82045,79562\nlivestock_pigs, None, 1372772,1366359,1348306\nlivestock_poultry, None, 13219724,12676402,12541044\nlivestock_other_animals, None, 126789,137616,131876\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nHow was the split between Swiss population and foreign nationals on Swiss farms in 2022?\n### SQL query\nSELECT ROUND(100 * employees_swiss / employees_total, 2) AS percentage_of_swiss_employees,\n  ROUND(100 * employees_foreign_nationals / employees_total, 2) AS percentage_foreign_nationals_employees\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total';\n\n\n### Question\nWhat were the 5 cantons farming the most pigs in 2012?\n### SQL query\nSELECT S.name as canton_name, livestock_pigs as total_pigs\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2012\n    AND T.farmholding_system = 'Farmholding system - total'\nORDER BY livestock_pigs DESC\nLIMIT 5;\n\n\n### Question\nHow many farms were there in all of Switzerland between 2012 and 2018?\n### SQL query\n",
    "process_time": 6.677348067983985,
    "num_tokens": 2980,
    "hardness": "extra",
    "scores": [
      0.45318877696990967,
      0.4957975149154663
    ],
    "lang": "en"
  },
  {
    "i": 11,
    "question": "How was the farmland used in organic farming in 2017? Provide land usage in percentage of the farming area.",
    "query": "SELECT ROUND(100 * T.arable_land_in_hectares / T.utilised_agricultural_area_in_hectares, 2) AS percentage_arable_land,\n  ROUND(100 * T.grassland_in_hectares / T.utilised_agricultural_area_in_hectares, 2) AS percentage_grassland,\n  ROUND(100 * T.permanent_crops_in_hectares / T.utilised_agricultural_area_in_hectares, 2) AS percentage_permanent_crops,\n  ROUND(100 * T.other_utilised_agricultural_area_in_hectares / T.utilised_agricultural_area_in_hectares, 2) AS precentage_other_usage\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2015\n    AND T.farmholding_system = 'Organic farming';\n",
    "db_id": "employees_farmholdings_agricultural_area_livestock_per_canton",
    "generated_query": "SELECT\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.arable_land_in_hectares ELSE 0 END) /\n   NULLIF(SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END), 0), 2) AS percentage_arable_land,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.grassland_in_hectares ELSE 0 END) /\n   NULLIF(SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END), 0), 2) AS percentage_grassland,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.permanent_crops_in_hectares ELSE 0 END) /\n   NULLIF(SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END), 0), 2) AS percentage_permanent_crops,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.other_utilised_agricultural_area_in_hectares ELSE 0 END) /\n   NULLIF(SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END), 0), 2) AS percentage_other_utilised_area\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nWHERE T.year = 2017\n    AND T.farmholding_system = 'Organic farming';",
    "meta_data": [
      {
        "question": "Which 5 cantons had in 2022 the biggest precentage of their farm area used by organic farming? Order by the percentage of area used for organic farming.",
        "query": "SELECT S.name,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) /\n   NULLIF(SUM(CASE WHEN T.farmholding_system = 'Farmholding system - total'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END), 0), 2) AS percentage_of_organically_used_farmarea\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.canton = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Farmholding system - total')\nGROUP BY S.name\nORDER BY percentage_of_organically_used_farmarea DESC LIMIT 5;\n",
        "score": 0.5728744268417358
      },
      {
        "question": "What canton has the highest percentage of organic farms most recently?",
        "query": "SELECT\n    year,\n    S.name AS canton_name,\n    (\n        SUM(\n            CASE WHEN farmholding_system = 'Organic farming'\n            THEN farmholdings\n            ELSE 0 END\n        ) * 100.0 / SUM(\n            CASE WHEN farmholding_system = 'Farmholding system - total'\n            THEN farmholdings\n            ELSE 0 END\n        )\n    ) AS percentage_organic_farms\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE year = (\n    SELECT MAX(year)\n    FROM employees_farmholdings_agricultural_area_livestock_per_canton\n)\nGROUP BY year, S.name\nORDER BY percentage_organic_farms DESC\nLIMIT 1;\n",
        "score": 0.7058230042457581
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.employees_farmholdings_agricultural_area_livestock_per_canton (\n\tuid SERIAL NOT NULL, \n\tfarmholding_system TEXT, \n\tyear INTEGER, \n\tfarmholdings NUMERIC, \n\temployees_total NUMERIC, \n\tfull_time_employees_75_percent_or_more NUMERIC, \n\tpart_time_employees_50_75_percent NUMERIC, \n\tpart_time_employees_2_less_than_50_percent NUMERIC, \n\temployees_men NUMERIC, \n\temployees_women NUMERIC, \n\temployees_women_manager_label NUMERIC, \n\temployees_swiss NUMERIC, \n\temployees_foreign_nationals NUMERIC, \n\tfamily_employees NUMERIC, \n\tbeef_cattle_and_cows_farm NUMERIC, \n\thorse_and_other_equine_farm NUMERIC, \n\tsheep_farm NUMERIC, \n\tgoat_farm NUMERIC, \n\tpig_farms NUMERIC, \n\tpoultry_farm NUMERIC, \n\tfarms_with_other_animals NUMERIC, \n\tutilised_agricultural_area_in_hectares NUMERIC, \n\tarable_land_in_hectares NUMERIC, \n\tgrassland_in_hectares NUMERIC, \n\tpermanent_crops_in_hectares NUMERIC, \n\tother_utilised_agricultural_area_in_hectares NUMERIC, \n\tlivestock_beef_cattle_and_cows NUMERIC, \n\tlivestock_horses_and_other_equines NUMERIC, \n\tlivestock_sheep NUMERIC, \n\tlivestock_goats NUMERIC, \n\tlivestock_pigs NUMERIC, \n\tlivestock_poultry NUMERIC, \n\tlivestock_other_animals NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT employees_farmholdings_agricultural_area_livestock_per_can_pkey PRIMARY KEY (uid), \n\tCONSTRAINT employees_farmholdings_agricultural_area_l_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in employees_farmholdings_agricultural_area_livestock_per_canton and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nyear : 2014, 2006, 2002, 2005, 2017\nfarmholdings : 63343, 65635, 54057, 352, 5897\nemployees_total : 11513, 199675, 22467, 18662, 10440\nfull_time_employees_75_percent_or_more : 68632, 74466, 458, 6619, 6430\npart_time_employees_50_75_percent : 228, 1666, 2503, 3958, 240\npart_time_employees_2_less_than_50_percent : 58492, 54660, 75911, 4244, 65900\nemployees_men : 672, 5279, 129161, 87326, 12871\nemployees_women : 7204, 44347, 3986, 710, 429\nemployees_women_manager_label : 3289, 324, 2361, 234, 36\nemployees_swiss : 156187, 109492, 966, 140683, 16069\nemployees_foreign_nationals : 12944, 3664, 12172, 14364, 14714\nfamily_employees : 792, 15483, 16850, 819, 7727\nbeef_cattle_and_cows_farm : 2269, 2195, 278, 240, 234\nhorse_and_other_equine_farm : 886, 1323, 822, 1521, 12255\nsheep_farm : 92, 12040, 505, 78, 416\ngoat_farm : 5279, 324, 1271, 1224, 458\npig_farms : 720, 12885, 6802, 461, 30\npoultry_farm : 737, 822, 16363, 2384, 14434\nfarms_with_other_animals : 416, 5072, 7210, 46, 338\nutilised_agricultural_area_in_hectares : 73768.929999999993015, 72373.139999999999418, 1082876.239999999990687, 855678.878299999982119, 1064573.979999999981374\narable_land_in_hectares : 1381.839999999999918145, 9142.000000000000000000, 1444.200000000000045475, 1075.640000000000100044, 1327.490000000000009095\ngrassland_in_hectares : 102642.039999999993597, 616792.741099999984726, 644087.760000000009313, 640454.430000000051223, 38321.419999999998254\npermanent_crops_in_hectares : 1418.980000000000018190, 56.149999999999998579, 1125.400000000000090949, 1577.868300000000090222, 22093.339599999999336433\nother_utilised_agricultural_area_in_hectares : 12441.640400000000227010, 308.819999999999993179, 9842.200000000000727596, 1630.089999999999918145, 946.009999999999990905\nlivestock_beef_cattle_and_cows : 82139, 1588005, 156773, 9101, 97531\nlivestock_horses_and_other_equines : 5881, 9683, 6227, 811, 927\nlivestock_sheep : 90557, 14364, 17601, 352493, 350320\nlivestock_goats : 82313, 74269, 57915, 21204, 2109\nlivestock_pigs : 40986, 505, 37121, 1590952, 40318\nlivestock_poultry : 18920, 10078981, 6907546, 33697, 36379\nlivestock_other_animals : 121621, 43682, 8150, 13615, 141127\n*/\n\n/*\nColumn name, Column discription, Example values\nfarmholding_system, None, Farmholding system - total,Organic farming,Conventional farming\nfarmholdings, None, 48344,48864,49363\nemployees_total, None, 149578,150231,149521\nfull_time_employees_75_percent_or_more, None, 66349,66453,66333\npart_time_employees_50_75_percent, None, 30083,30038,29920\npart_time_employees_2_less_than_50_percent, None, 53146,53740,53268\nemployees_men, None, 94706,95486,95252\nemployees_women, None, 54872,54745,54269\nemployees_women_manager_label, None, 3472,3362,3233\nemployees_swiss, None, 131072,131955,131581\nemployees_foreign_nationals, None, 18506,18276,17940\nfamily_employees, None, 112047,113317,113847\nbeef_cattle_and_cows_farm, None, 32581,33091,33662\nhorse_and_other_equine_farm, None, 11123,11196,11227\nsheep_farm, None, 7969,7977,8016\ngoat_farm, None, 6559,6592,6355\npig_farms, None, 5467,5561,5600\npoultry_farm, None, 14876,14434,13485\nfarms_with_other_animals, None, 6138,6101,6000\nutilised_agricultural_area_in_hectares, None, 1042013.785,1042053.004,1044033.706\narable_land_in_hectares, None, 276114.0758,276496.4816,274448.9291\ngrassland_in_hectares, None, 726091.9808,725854.0912,730039.4586\npermanent_crops_in_hectares, None, 24040.2951,24285.0786,24061.4945\nother_utilised_agricultural_area_in_hectares, None, 15767.4333,15417.3522,15483.8239\nlivestock_beef_cattle_and_cows, None, 1525270,1513701,1515123\nlivestock_horses_and_other_equines, None, 80950,80096,80072\nlivestock_sheep, None, 355893,349112,343528\nlivestock_goats, None, 82313,82045,79562\nlivestock_pigs, None, 1372772,1366359,1348306\nlivestock_poultry, None, 13219724,12676402,12541044\nlivestock_other_animals, None, 126789,137616,131876\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWhat was the precentage of family employees in organic and conventional farming in 2022?\n### SQL query\nSELECT\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.family_employees ELSE 0 END) /\n   SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.employees_total ELSE 0 END), 2) AS percentage_family_employees_organic_farming,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Conventional farming'\n       THEN T.family_employees ELSE 0 END) /\n   SUM(CASE WHEN T.farmholding_system = 'Conventional farming'\n       THEN T.employees_total ELSE 0 END), 2) AS percentage_family_employees_conventional_farming\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n\n\n### Question\nWhich 5 cantons had in 2022 the biggest precentage of their farm area used by organic farming? Order by the percentage of area used for organic farming.\n### SQL query\nSELECT S.name,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) /\n   NULLIF(SUM(CASE WHEN T.farmholding_system = 'Farmholding system - total'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END), 0), 2) AS percentage_of_organically_used_farmarea\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.canton = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Farmholding system - total')\nGROUP BY S.name\nORDER BY percentage_of_organically_used_farmarea DESC LIMIT 5;\n\n\n### Question\nHow was the farmland used in organic farming in 2017? Provide land usage in percentage of the farming area.\n### SQL query\n",
    "process_time": 42.29081000294536,
    "num_tokens": 3204,
    "hardness": "unknown",
    "scores": [
      0.5728744268417358,
      0.7058230042457581
    ],
    "lang": "en"
  },
  {
    "i": 12,
    "question": "How was the split between men and women in farm employment in canton Uri in 2015?",
    "query": "SELECT ROUND(100 * employees_women / employees_total, 2) AS percentage_of_female_employees,\n  ROUND(100 * employees_men / employees_total, 2) AS percentage_of_male_employees\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2015\n    AND T.farmholding_system = 'Farmholding system - total';\n",
    "db_id": "employees_farmholdings_agricultural_area_livestock_per_canton",
    "generated_query": "SELECT\n   SUM(T.employees_men) AS total_men,\n   SUM(T.employees_women) AS total_women\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Uri'\n    AND T.year = 2015;",
    "meta_data": [
      {
        "question": "Which five cantons had in 2022 the highest percentage of women farmers in mangement position? Also provide the precentage of women who had a manager position.",
        "query": "SELECT S.name as canton,\n  ROUND(100 * SUM(T.employees_women_manager_label) / SUM(T.employees_women), 2) AS percentage_women_managers\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total'\nGROUP BY S.name\nORDER BY percentage_women_managers DESC\nLIMIT 5;\n",
        "score": 0.6575784087181091
      },
      {
        "question": "What was the precentage of family employees in organic and conventional farming in 2022?",
        "query": "SELECT\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.family_employees ELSE 0 END) /\n   SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.employees_total ELSE 0 END), 2) AS percentage_family_employees_organic_farming,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Conventional farming'\n       THEN T.family_employees ELSE 0 END) /\n   SUM(CASE WHEN T.farmholding_system = 'Conventional farming'\n       THEN T.employees_total ELSE 0 END), 2) AS percentage_family_employees_conventional_farming\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n",
        "score": 0.7426201105117798
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.employees_farmholdings_agricultural_area_livestock_per_canton (\n\tuid SERIAL NOT NULL, \n\tfarmholding_system TEXT, \n\tyear INTEGER, \n\tfarmholdings NUMERIC, \n\temployees_total NUMERIC, \n\tfull_time_employees_75_percent_or_more NUMERIC, \n\tpart_time_employees_50_75_percent NUMERIC, \n\tpart_time_employees_2_less_than_50_percent NUMERIC, \n\temployees_men NUMERIC, \n\temployees_women NUMERIC, \n\temployees_women_manager_label NUMERIC, \n\temployees_swiss NUMERIC, \n\temployees_foreign_nationals NUMERIC, \n\tfamily_employees NUMERIC, \n\tbeef_cattle_and_cows_farm NUMERIC, \n\thorse_and_other_equine_farm NUMERIC, \n\tsheep_farm NUMERIC, \n\tgoat_farm NUMERIC, \n\tpig_farms NUMERIC, \n\tpoultry_farm NUMERIC, \n\tfarms_with_other_animals NUMERIC, \n\tutilised_agricultural_area_in_hectares NUMERIC, \n\tarable_land_in_hectares NUMERIC, \n\tgrassland_in_hectares NUMERIC, \n\tpermanent_crops_in_hectares NUMERIC, \n\tother_utilised_agricultural_area_in_hectares NUMERIC, \n\tlivestock_beef_cattle_and_cows NUMERIC, \n\tlivestock_horses_and_other_equines NUMERIC, \n\tlivestock_sheep NUMERIC, \n\tlivestock_goats NUMERIC, \n\tlivestock_pigs NUMERIC, \n\tlivestock_poultry NUMERIC, \n\tlivestock_other_animals NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT employees_farmholdings_agricultural_area_livestock_per_can_pkey PRIMARY KEY (uid), \n\tCONSTRAINT employees_farmholdings_agricultural_area_l_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in employees_farmholdings_agricultural_area_livestock_per_canton and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nyear : 2014, 2006, 2002, 2005, 2017\nfarmholdings : 63343, 65635, 54057, 352, 5897\nemployees_total : 11513, 199675, 22467, 18662, 10440\nfull_time_employees_75_percent_or_more : 68632, 74466, 458, 6619, 6430\npart_time_employees_50_75_percent : 228, 1666, 2503, 3958, 240\npart_time_employees_2_less_than_50_percent : 58492, 54660, 75911, 4244, 65900\nemployees_men : 672, 5279, 129161, 87326, 12871\nemployees_women : 7204, 44347, 3986, 710, 429\nemployees_women_manager_label : 3289, 324, 2361, 234, 36\nemployees_swiss : 156187, 109492, 966, 140683, 16069\nemployees_foreign_nationals : 12944, 3664, 12172, 14364, 14714\nfamily_employees : 792, 15483, 16850, 819, 7727\nbeef_cattle_and_cows_farm : 2269, 2195, 278, 240, 234\nhorse_and_other_equine_farm : 886, 1323, 822, 1521, 12255\nsheep_farm : 92, 12040, 505, 78, 416\ngoat_farm : 5279, 324, 1271, 1224, 458\npig_farms : 720, 12885, 6802, 461, 30\npoultry_farm : 737, 822, 16363, 2384, 14434\nfarms_with_other_animals : 416, 5072, 7210, 46, 338\nutilised_agricultural_area_in_hectares : 73768.929999999993015, 72373.139999999999418, 1082876.239999999990687, 855678.878299999982119, 1064573.979999999981374\narable_land_in_hectares : 1381.839999999999918145, 9142.000000000000000000, 1444.200000000000045475, 1075.640000000000100044, 1327.490000000000009095\ngrassland_in_hectares : 102642.039999999993597, 616792.741099999984726, 644087.760000000009313, 640454.430000000051223, 38321.419999999998254\npermanent_crops_in_hectares : 1418.980000000000018190, 56.149999999999998579, 1125.400000000000090949, 1577.868300000000090222, 22093.339599999999336433\nother_utilised_agricultural_area_in_hectares : 12441.640400000000227010, 308.819999999999993179, 9842.200000000000727596, 1630.089999999999918145, 946.009999999999990905\nlivestock_beef_cattle_and_cows : 82139, 1588005, 156773, 9101, 97531\nlivestock_horses_and_other_equines : 5881, 9683, 6227, 811, 927\nlivestock_sheep : 90557, 14364, 17601, 352493, 350320\nlivestock_goats : 82313, 74269, 57915, 21204, 2109\nlivestock_pigs : 40986, 505, 37121, 1590952, 40318\nlivestock_poultry : 18920, 10078981, 6907546, 33697, 36379\nlivestock_other_animals : 121621, 43682, 8150, 13615, 141127\n*/\n\n/*\nColumn name, Column discription, Example values\nfarmholding_system, None, Farmholding system - total,Organic farming,Conventional farming\nfarmholdings, None, 48344,48864,49363\nemployees_total, None, 149578,150231,149521\nfull_time_employees_75_percent_or_more, None, 66349,66453,66333\npart_time_employees_50_75_percent, None, 30083,30038,29920\npart_time_employees_2_less_than_50_percent, None, 53146,53740,53268\nemployees_men, None, 94706,95486,95252\nemployees_women, None, 54872,54745,54269\nemployees_women_manager_label, None, 3472,3362,3233\nemployees_swiss, None, 131072,131955,131581\nemployees_foreign_nationals, None, 18506,18276,17940\nfamily_employees, None, 112047,113317,113847\nbeef_cattle_and_cows_farm, None, 32581,33091,33662\nhorse_and_other_equine_farm, None, 11123,11196,11227\nsheep_farm, None, 7969,7977,8016\ngoat_farm, None, 6559,6592,6355\npig_farms, None, 5467,5561,5600\npoultry_farm, None, 14876,14434,13485\nfarms_with_other_animals, None, 6138,6101,6000\nutilised_agricultural_area_in_hectares, None, 1042013.785,1042053.004,1044033.706\narable_land_in_hectares, None, 276114.0758,276496.4816,274448.9291\ngrassland_in_hectares, None, 726091.9808,725854.0912,730039.4586\npermanent_crops_in_hectares, None, 24040.2951,24285.0786,24061.4945\nother_utilised_agricultural_area_in_hectares, None, 15767.4333,15417.3522,15483.8239\nlivestock_beef_cattle_and_cows, None, 1525270,1513701,1515123\nlivestock_horses_and_other_equines, None, 80950,80096,80072\nlivestock_sheep, None, 355893,349112,343528\nlivestock_goats, None, 82313,82045,79562\nlivestock_pigs, None, 1372772,1366359,1348306\nlivestock_poultry, None, 13219724,12676402,12541044\nlivestock_other_animals, None, 126789,137616,131876\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWhich five cantons had in 2022 the highest percentage of women farmers in mangement position? Also provide the precentage of women who had a manager position.\n### SQL query\nSELECT S.name as canton,\n  ROUND(100 * SUM(T.employees_women_manager_label) / SUM(T.employees_women), 2) AS percentage_women_managers\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total'\nGROUP BY S.name\nORDER BY percentage_women_managers DESC\nLIMIT 5;\n\n\n### Question\nWhat was the precentage of family employees in organic and conventional farming in 2022?\n### SQL query\nSELECT\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.family_employees ELSE 0 END) /\n   SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.employees_total ELSE 0 END), 2) AS percentage_family_employees_organic_farming,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Conventional farming'\n       THEN T.family_employees ELSE 0 END) /\n   SUM(CASE WHEN T.farmholding_system = 'Conventional farming'\n       THEN T.employees_total ELSE 0 END), 2) AS percentage_family_employees_conventional_farming\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n\n\n### Question\nHow was the split between men and women in farm employment in canton Uri in 2015?\n### SQL query\n",
    "process_time": 9.980221286183223,
    "num_tokens": 3130,
    "hardness": "unknown",
    "scores": [
      0.6575784087181091,
      0.7426201105117798
    ],
    "lang": "en"
  },
  {
    "i": 13,
    "question": "What was the total agricultural surface area in the canton of Geneva in 2000?",
    "query": "SELECT utilised_agricultural_area_in_hectares as utilised_agricultural_area_in_hectares_canton_geneva\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Canton Geneva'\n    AND S.canton = 'TRUE'\n    AND year = 2000\n    AND T.farmholding_system = 'Farmholding system - total';\n",
    "db_id": "employees_farmholdings_agricultural_area_livestock_per_canton",
    "generated_query": "SELECT SUM(utilised_agricultural_area_in_hectares) as total_agricultural_surface_area\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Geneva'\n    AND T.year = 2000;",
    "meta_data": [
      {
        "question": "What canton has the highest percentage of organic farms most recently?",
        "query": "SELECT\n    year,\n    S.name AS canton_name,\n    (\n        SUM(\n            CASE WHEN farmholding_system = 'Organic farming'\n            THEN farmholdings\n            ELSE 0 END\n        ) * 100.0 / SUM(\n            CASE WHEN farmholding_system = 'Farmholding system - total'\n            THEN farmholdings\n            ELSE 0 END\n        )\n    ) AS percentage_organic_farms\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE year = (\n    SELECT MAX(year)\n    FROM employees_farmholdings_agricultural_area_livestock_per_canton\n)\nGROUP BY year, S.name\nORDER BY percentage_organic_farms DESC\nLIMIT 1;\n",
        "score": 0.6515279412269592
      },
      {
        "question": "What was the average number of cows per farm in the canton of Vaud since 2017?",
        "query": "SELECT year, livestock_beef_cattle_and_cows / farmholdings AS average_cows_per_farmholding_vaud\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Canton Vaud'\n    AND S.canton = 'TRUE'\n    AND year >= 2017\n    AND T.farmholding_system = 'Farmholding system - total';\n",
        "score": 0.7057119011878967
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.employees_farmholdings_agricultural_area_livestock_per_canton (\n\tuid SERIAL NOT NULL, \n\tfarmholding_system TEXT, \n\tyear INTEGER, \n\tfarmholdings NUMERIC, \n\temployees_total NUMERIC, \n\tfull_time_employees_75_percent_or_more NUMERIC, \n\tpart_time_employees_50_75_percent NUMERIC, \n\tpart_time_employees_2_less_than_50_percent NUMERIC, \n\temployees_men NUMERIC, \n\temployees_women NUMERIC, \n\temployees_women_manager_label NUMERIC, \n\temployees_swiss NUMERIC, \n\temployees_foreign_nationals NUMERIC, \n\tfamily_employees NUMERIC, \n\tbeef_cattle_and_cows_farm NUMERIC, \n\thorse_and_other_equine_farm NUMERIC, \n\tsheep_farm NUMERIC, \n\tgoat_farm NUMERIC, \n\tpig_farms NUMERIC, \n\tpoultry_farm NUMERIC, \n\tfarms_with_other_animals NUMERIC, \n\tutilised_agricultural_area_in_hectares NUMERIC, \n\tarable_land_in_hectares NUMERIC, \n\tgrassland_in_hectares NUMERIC, \n\tpermanent_crops_in_hectares NUMERIC, \n\tother_utilised_agricultural_area_in_hectares NUMERIC, \n\tlivestock_beef_cattle_and_cows NUMERIC, \n\tlivestock_horses_and_other_equines NUMERIC, \n\tlivestock_sheep NUMERIC, \n\tlivestock_goats NUMERIC, \n\tlivestock_pigs NUMERIC, \n\tlivestock_poultry NUMERIC, \n\tlivestock_other_animals NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT employees_farmholdings_agricultural_area_livestock_per_can_pkey PRIMARY KEY (uid), \n\tCONSTRAINT employees_farmholdings_agricultural_area_l_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in employees_farmholdings_agricultural_area_livestock_per_canton and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nyear : 2014, 2006, 2002, 2005, 2017\nfarmholdings : 63343, 65635, 54057, 352, 5897\nemployees_total : 11513, 199675, 22467, 18662, 10440\nfull_time_employees_75_percent_or_more : 68632, 74466, 458, 6619, 6430\npart_time_employees_50_75_percent : 228, 1666, 2503, 3958, 240\npart_time_employees_2_less_than_50_percent : 58492, 54660, 75911, 4244, 65900\nemployees_men : 672, 5279, 129161, 87326, 12871\nemployees_women : 7204, 44347, 3986, 710, 429\nemployees_women_manager_label : 3289, 324, 2361, 234, 36\nemployees_swiss : 156187, 109492, 966, 140683, 16069\nemployees_foreign_nationals : 12944, 3664, 12172, 14364, 14714\nfamily_employees : 792, 15483, 16850, 819, 7727\nbeef_cattle_and_cows_farm : 2269, 2195, 278, 240, 234\nhorse_and_other_equine_farm : 886, 1323, 822, 1521, 12255\nsheep_farm : 92, 12040, 505, 78, 416\ngoat_farm : 5279, 324, 1271, 1224, 458\npig_farms : 720, 12885, 6802, 461, 30\npoultry_farm : 737, 822, 16363, 2384, 14434\nfarms_with_other_animals : 416, 5072, 7210, 46, 338\nutilised_agricultural_area_in_hectares : 73768.929999999993015, 72373.139999999999418, 1082876.239999999990687, 855678.878299999982119, 1064573.979999999981374\narable_land_in_hectares : 1381.839999999999918145, 9142.000000000000000000, 1444.200000000000045475, 1075.640000000000100044, 1327.490000000000009095\ngrassland_in_hectares : 102642.039999999993597, 616792.741099999984726, 644087.760000000009313, 640454.430000000051223, 38321.419999999998254\npermanent_crops_in_hectares : 1418.980000000000018190, 56.149999999999998579, 1125.400000000000090949, 1577.868300000000090222, 22093.339599999999336433\nother_utilised_agricultural_area_in_hectares : 12441.640400000000227010, 308.819999999999993179, 9842.200000000000727596, 1630.089999999999918145, 946.009999999999990905\nlivestock_beef_cattle_and_cows : 82139, 1588005, 156773, 9101, 97531\nlivestock_horses_and_other_equines : 5881, 9683, 6227, 811, 927\nlivestock_sheep : 90557, 14364, 17601, 352493, 350320\nlivestock_goats : 82313, 74269, 57915, 21204, 2109\nlivestock_pigs : 40986, 505, 37121, 1590952, 40318\nlivestock_poultry : 18920, 10078981, 6907546, 33697, 36379\nlivestock_other_animals : 121621, 43682, 8150, 13615, 141127\n*/\n\n/*\nColumn name, Column discription, Example values\nfarmholding_system, None, Farmholding system - total,Organic farming,Conventional farming\nfarmholdings, None, 48344,48864,49363\nemployees_total, None, 149578,150231,149521\nfull_time_employees_75_percent_or_more, None, 66349,66453,66333\npart_time_employees_50_75_percent, None, 30083,30038,29920\npart_time_employees_2_less_than_50_percent, None, 53146,53740,53268\nemployees_men, None, 94706,95486,95252\nemployees_women, None, 54872,54745,54269\nemployees_women_manager_label, None, 3472,3362,3233\nemployees_swiss, None, 131072,131955,131581\nemployees_foreign_nationals, None, 18506,18276,17940\nfamily_employees, None, 112047,113317,113847\nbeef_cattle_and_cows_farm, None, 32581,33091,33662\nhorse_and_other_equine_farm, None, 11123,11196,11227\nsheep_farm, None, 7969,7977,8016\ngoat_farm, None, 6559,6592,6355\npig_farms, None, 5467,5561,5600\npoultry_farm, None, 14876,14434,13485\nfarms_with_other_animals, None, 6138,6101,6000\nutilised_agricultural_area_in_hectares, None, 1042013.785,1042053.004,1044033.706\narable_land_in_hectares, None, 276114.0758,276496.4816,274448.9291\ngrassland_in_hectares, None, 726091.9808,725854.0912,730039.4586\npermanent_crops_in_hectares, None, 24040.2951,24285.0786,24061.4945\nother_utilised_agricultural_area_in_hectares, None, 15767.4333,15417.3522,15483.8239\nlivestock_beef_cattle_and_cows, None, 1525270,1513701,1515123\nlivestock_horses_and_other_equines, None, 80950,80096,80072\nlivestock_sheep, None, 355893,349112,343528\nlivestock_goats, None, 82313,82045,79562\nlivestock_pigs, None, 1372772,1366359,1348306\nlivestock_poultry, None, 13219724,12676402,12541044\nlivestock_other_animals, None, 126789,137616,131876\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWhat were the 5 cantons farming the most pigs in 2012?\n### SQL query\nSELECT S.name as canton_name, livestock_pigs as total_pigs\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2012\n    AND T.farmholding_system = 'Farmholding system - total'\nORDER BY livestock_pigs DESC\nLIMIT 5;\n\n\n### Question\nWhich 5 cantons had in 2022 the biggest precentage of their farm area used by organic farming? Order by the percentage of area used for organic farming.\n### SQL query\nSELECT S.name,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) /\n   NULLIF(SUM(CASE WHEN T.farmholding_system = 'Farmholding system - total'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END), 0), 2) AS percentage_of_organically_used_farmarea\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.canton = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Farmholding system - total')\nGROUP BY S.name\nORDER BY percentage_of_organically_used_farmarea DESC LIMIT 5;\n\n\n### Question\nWhat was the total agricultural surface area in the canton of Geneva in 2000?\n### SQL query\n",
    "process_time": 9.102507167961448,
    "num_tokens": 3074,
    "hardness": "unknown",
    "scores": [
      0.6515279412269592,
      0.7057119011878967
    ],
    "lang": "en"
  },
  {
    "i": 14,
    "question": "What was the population change due to natural factors among the residents of Canton Vaud between 2015 and 2020?",
    "query": "SELECT year, births - deaths\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Vaud%'\n    AND T.year >= 2015\n    AND T.year >= 2020\n    AND T.citizenship_category = 'Citizenship (category) - total';\n",
    "db_id": "demographic_balance_by_canton",
    "generated_query": "SELECT\n    SUM(deaths - births) as population_change_due_to_natural_factors\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Vaud'\n    AND T.year >= 2015\n    AND T.year <= 2020\n    AND T.citizenship_category = 'Citizenship (category) - total';",
    "meta_data": [
      {
        "question": "Which cantons experienced a population decline in 2017, and by how much?",
        "query": "SELECT S.name, population_change\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.population_change < 0\n    AND T.year = 2017\n    AND T.citizenship_category = 'Citizenship (category) - total';\n",
        "score": 0.5734316110610962
      },
      {
        "question": "Which five cantons experienced the most significant population growth relative to their size between 2000 and 2022?",
        "query": "SELECT\n    S.name, (\n        (\n            SUM(CASE WHEN T.year = 2022 THEN total_population ELSE 0 END) -\n            SUM(CASE WHEN T.year = 2000 THEN total_population ELSE 0 END)\n        ) / SUM(CASE WHEN T.year = 2000 THEN total_population ELSE 0 END)\n    ) as relative_population_growth\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year >= 2000\n    AND T.year <= 2022\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY S.name\nORDER BY relative_population_growth DESC\nLIMIT 5;\n",
        "score": 0.6075897216796875
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.demographic_balance_by_canton (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tcitizenship_category TEXT, \n\ttotal_population NUMERIC, \n\tbirths NUMERIC, \n\tdeaths NUMERIC, \n\timmigration NUMERIC, \n\tin_migration_from_another_canton NUMERIC, \n\temigration NUMERIC, \n\tout_migration_to_another_canton NUMERIC, \n\tnet_migration NUMERIC, \n\tacquisition_of_swiss_citizenship NUMERIC, \n\tstatistical_adjustment NUMERIC, \n\tpopulation_change NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT demographic_balance_by_canton_pkey PRIMARY KEY (uid), \n\tCONSTRAINT demographic_balance_by_canton_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in demographic_balance_by_canton and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nyear : 2014, 1992, 2006, 2002, 2005\ntotal_population : 1241312, 7123537, 938859, 1476966, 1249893\nbirths : 83762, 58205, 11231, 4129, 12284\ndeaths : 672, 56064, 61124, 10726, 10170\nimmigration : 4040, 6281, 96880, 31465, 18394\nin_migration_from_another_canton : 16335, 5617, 14585, 16875, 14751\nemigration : 6725, 29487, 6281, 5969, 58851\nout_migration_to_another_canton : 20161, 14751, 3669, 5990, 13299\nnet_migration : 71127, -511, 1666, -823, 21097\nacquisition_of_swiss_citizenship : -2758, -43440, 2104, 20363, 28700\nstatistical_adjustment : 777, 697, 234, -1156, 4649\npopulation_change : 7720, 7268, 5995, 40907, 29413\n*/\n\n/*\nColumn name, Column discription, Example values\ntotal_population, Total population recorded this year, 6335243,5421746,913497\nbirths, Number of live births recorded, 73747,61611,12136\ndeaths, Number of deaths recorded, 59763,56032,3731\nimmigration, Number of people becoming Swiss residents, 121420,28483,92937\nemigration, Number of Swiss residents leaving, 97743,27796,69947\nin_migration_from_another_canton, Number of people moving in from another canton, 134359,119608,14751\nout_migration_to_another_canton, Number of people moving to a different canton, 134359,119608,14751\nnet_migration, Difference between the number of arrivals and departures, 23677,687,22990\nacquisition_of_swiss_citizenship, Number of people acquiring swiss nationality, 0,14299,-14299\nstatistical_adjustment, Changes to the population size that cannot be clearly attributed to demographic movements, 0,574,-34\npopulation_change, Difference in the number of people compared to the previous year, 37661,20565,17096\ncitizenship_category, Citizenship category, Citizenship (category) - total,Foreign country,Switzerland\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWhich five cantons experienced the most significant population growth relative to their size between 2000 and 2022?\n### SQL query\nSELECT\n    S.name, (\n        (\n            SUM(CASE WHEN T.year = 2022 THEN total_population ELSE 0 END) -\n            SUM(CASE WHEN T.year = 2000 THEN total_population ELSE 0 END)\n        ) / SUM(CASE WHEN T.year = 2000 THEN total_population ELSE 0 END)\n    ) as relative_population_growth\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year >= 2000\n    AND T.year <= 2022\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY S.name\nORDER BY relative_population_growth DESC\nLIMIT 5;\n\n\n### Question\nShow me the cantons with the highest birth rates every year between 1995 and 2010.\n### SQL query\nSELECT year, S.name as most_populout_canton, MAX(births / total_population) as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year >= 1995\n    AND T.year <= 2010\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, S.name, T.births\nORDER BY year ASC;\n\n\n### Question\nWhat was the population change due to natural factors among the residents of Canton Vaud between 2015 and 2020?\n### SQL query\n",
    "process_time": 7.340378970140591,
    "num_tokens": 1751,
    "hardness": "hard",
    "scores": [
      0.5734316110610962,
      0.6075897216796875
    ],
    "lang": "en"
  },
  {
    "i": 15,
    "question": "Which canton has the highest number of residents who have moved from other cantons in 2016?",
    "query": "SELECT S.name, T.in_migration_from_another_canton\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2016\n    AND T.citizenship_category = 'Citizenship (category) - total'\nORDER BY T.in_migration_from_another_canton DESC\nLIMIT 1;\n",
    "db_id": "demographic_balance_by_canton",
    "generated_query": "SELECT\n    S.name as canton,\n    T.in_migration_from_another_canton as residents_from_other_cantons\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2016\n    AND T.citizenship_category = 'Citizenship (category) - total'\nORDER BY T.in_migration_from_another_canton DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Which five cantons experienced the most significant population growth relative to their size between 2000 and 2022?",
        "query": "SELECT\n    S.name, (\n        (\n            SUM(CASE WHEN T.year = 2022 THEN total_population ELSE 0 END) -\n            SUM(CASE WHEN T.year = 2000 THEN total_population ELSE 0 END)\n        ) / SUM(CASE WHEN T.year = 2000 THEN total_population ELSE 0 END)\n    ) as relative_population_growth\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year >= 2000\n    AND T.year <= 2022\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY S.name\nORDER BY relative_population_growth DESC\nLIMIT 5;\n",
        "score": 0.44678640365600586
      },
      {
        "question": "Which cantons experienced a population decline in 2017, and by how much?",
        "query": "SELECT S.name, population_change\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.population_change < 0\n    AND T.year = 2017\n    AND T.citizenship_category = 'Citizenship (category) - total';\n",
        "score": 0.44948673248291016
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.demographic_balance_by_canton (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tcitizenship_category TEXT, \n\ttotal_population NUMERIC, \n\tbirths NUMERIC, \n\tdeaths NUMERIC, \n\timmigration NUMERIC, \n\tin_migration_from_another_canton NUMERIC, \n\temigration NUMERIC, \n\tout_migration_to_another_canton NUMERIC, \n\tnet_migration NUMERIC, \n\tacquisition_of_swiss_citizenship NUMERIC, \n\tstatistical_adjustment NUMERIC, \n\tpopulation_change NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT demographic_balance_by_canton_pkey PRIMARY KEY (uid), \n\tCONSTRAINT demographic_balance_by_canton_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in demographic_balance_by_canton and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nyear : 2014, 1992, 2006, 2002, 2005\ntotal_population : 1241312, 7123537, 938859, 1476966, 1249893\nbirths : 83762, 58205, 11231, 4129, 12284\ndeaths : 672, 56064, 61124, 10726, 10170\nimmigration : 4040, 6281, 96880, 31465, 18394\nin_migration_from_another_canton : 16335, 5617, 14585, 16875, 14751\nemigration : 6725, 29487, 6281, 5969, 58851\nout_migration_to_another_canton : 20161, 14751, 3669, 5990, 13299\nnet_migration : 71127, -511, 1666, -823, 21097\nacquisition_of_swiss_citizenship : -2758, -43440, 2104, 20363, 28700\nstatistical_adjustment : 777, 697, 234, -1156, 4649\npopulation_change : 7720, 7268, 5995, 40907, 29413\n*/\n\n/*\nColumn name, Column discription, Example values\ntotal_population, Total population recorded this year, 6335243,5421746,913497\nbirths, Number of live births recorded, 73747,61611,12136\ndeaths, Number of deaths recorded, 59763,56032,3731\nimmigration, Number of people becoming Swiss residents, 121420,28483,92937\nemigration, Number of Swiss residents leaving, 97743,27796,69947\nin_migration_from_another_canton, Number of people moving in from another canton, 134359,119608,14751\nout_migration_to_another_canton, Number of people moving to a different canton, 134359,119608,14751\nnet_migration, Difference between the number of arrivals and departures, 23677,687,22990\nacquisition_of_swiss_citizenship, Number of people acquiring swiss nationality, 0,14299,-14299\nstatistical_adjustment, Changes to the population size that cannot be clearly attributed to demographic movements, 0,574,-34\npopulation_change, Difference in the number of people compared to the previous year, 37661,20565,17096\ncitizenship_category, Citizenship category, Citizenship (category) - total,Foreign country,Switzerland\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nShow me the cantons with the highest birth rates every year between 1995 and 2010.\n### SQL query\nSELECT year, S.name as most_populout_canton, MAX(births / total_population) as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year >= 1995\n    AND T.year <= 2010\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, S.name, T.births\nORDER BY year ASC;\n\n\n### Question\nWhich five cantons experienced the most significant population growth relative to their size between 2000 and 2022?\n### SQL query\nSELECT\n    S.name, (\n        (\n            SUM(CASE WHEN T.year = 2022 THEN total_population ELSE 0 END) -\n            SUM(CASE WHEN T.year = 2000 THEN total_population ELSE 0 END)\n        ) / SUM(CASE WHEN T.year = 2000 THEN total_population ELSE 0 END)\n    ) as relative_population_growth\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year >= 2000\n    AND T.year <= 2022\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY S.name\nORDER BY relative_population_growth DESC\nLIMIT 5;\n\n\n### Question\nWhich canton has the highest number of residents who have moved from other cantons in 2016?\n### SQL query\n",
    "process_time": 7.14721790002659,
    "num_tokens": 1747,
    "hardness": "extra",
    "scores": [
      0.44678640365600586,
      0.44948673248291016
    ],
    "lang": "en"
  },
  {
    "i": 16,
    "question": "How many residents were in Switzerland in 2018?",
    "query": "SELECT total_population as total_population_of_switzerland_in_2018\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n    AND S.country = 'TRUE'\n    AND T.year = 2018\n    AND T.citizenship_category = 'Citizenship (category) - total';\n",
    "db_id": "demographic_balance_by_canton",
    "generated_query": "SELECT SUM(total_population) as total_residents\nFROM demographic_balance_by_canton\nWHERE year = 2018;",
    "meta_data": [
      {
        "question": "In which year did Switzerland experience its highest birth rate?",
        "query": "SELECT T.year, T.births / T.total_population as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND S.name = 'Switzerland'\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, T.births, T.total_population\nORDER BY birthrate DESC\nLIMIT 1;\n",
        "score": 0.600642204284668
      },
      {
        "question": "Which five cantons had the highest number of Swiss citizenship acquisitions in 2017 relative to their population?",
        "query": "SELECT S.name, acquisition_of_swiss_citizenship / total_population as relative_acquisition\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2017\n    AND T.citizenship_category = 'Switzerland'\nORDER BY relative_acquisition DESC\nLIMIT 5;\n",
        "score": 0.6364426612854004
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.demographic_balance_by_canton (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tcitizenship_category TEXT, \n\ttotal_population NUMERIC, \n\tbirths NUMERIC, \n\tdeaths NUMERIC, \n\timmigration NUMERIC, \n\tin_migration_from_another_canton NUMERIC, \n\temigration NUMERIC, \n\tout_migration_to_another_canton NUMERIC, \n\tnet_migration NUMERIC, \n\tacquisition_of_swiss_citizenship NUMERIC, \n\tstatistical_adjustment NUMERIC, \n\tpopulation_change NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT demographic_balance_by_canton_pkey PRIMARY KEY (uid), \n\tCONSTRAINT demographic_balance_by_canton_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in demographic_balance_by_canton and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nyear : 2014, 1992, 2006, 2002, 2005\ntotal_population : 1241312, 7123537, 938859, 1476966, 1249893\nbirths : 83762, 58205, 11231, 4129, 12284\ndeaths : 672, 56064, 61124, 10726, 10170\nimmigration : 4040, 6281, 96880, 31465, 18394\nin_migration_from_another_canton : 16335, 5617, 14585, 16875, 14751\nemigration : 6725, 29487, 6281, 5969, 58851\nout_migration_to_another_canton : 20161, 14751, 3669, 5990, 13299\nnet_migration : 71127, -511, 1666, -823, 21097\nacquisition_of_swiss_citizenship : -2758, -43440, 2104, 20363, 28700\nstatistical_adjustment : 777, 697, 234, -1156, 4649\npopulation_change : 7720, 7268, 5995, 40907, 29413\n*/\n\n/*\nColumn name, Column discription, Example values\ntotal_population, Total population recorded this year, 6335243,5421746,913497\nbirths, Number of live births recorded, 73747,61611,12136\ndeaths, Number of deaths recorded, 59763,56032,3731\nimmigration, Number of people becoming Swiss residents, 121420,28483,92937\nemigration, Number of Swiss residents leaving, 97743,27796,69947\nin_migration_from_another_canton, Number of people moving in from another canton, 134359,119608,14751\nout_migration_to_another_canton, Number of people moving to a different canton, 134359,119608,14751\nnet_migration, Difference between the number of arrivals and departures, 23677,687,22990\nacquisition_of_swiss_citizenship, Number of people acquiring swiss nationality, 0,14299,-14299\nstatistical_adjustment, Changes to the population size that cannot be clearly attributed to demographic movements, 0,574,-34\npopulation_change, Difference in the number of people compared to the previous year, 37661,20565,17096\ncitizenship_category, Citizenship category, Citizenship (category) - total,Foreign country,Switzerland\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nShow me the cantons with the highest birth rates every year between 1995 and 2010.\n### SQL query\nSELECT year, S.name as most_populout_canton, MAX(births / total_population) as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year >= 1995\n    AND T.year <= 2010\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, S.name, T.births\nORDER BY year ASC;\n\n\n### Question\nWhich five cantons experienced the most significant population growth relative to their size between 2000 and 2022?\n### SQL query\nSELECT\n    S.name, (\n        (\n            SUM(CASE WHEN T.year = 2022 THEN total_population ELSE 0 END) -\n            SUM(CASE WHEN T.year = 2000 THEN total_population ELSE 0 END)\n        ) / SUM(CASE WHEN T.year = 2000 THEN total_population ELSE 0 END)\n    ) as relative_population_growth\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year >= 2000\n    AND T.year <= 2022\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY S.name\nORDER BY relative_population_growth DESC\nLIMIT 5;\n\n\n### Question\nHow many residents were in Switzerland in 2018?\n### SQL query\n",
    "process_time": 2.8537303060293198,
    "num_tokens": 1737,
    "hardness": "unknown",
    "scores": [
      0.600642204284668,
      0.6364426612854004
    ],
    "lang": "en"
  },
  {
    "i": 17,
    "question": "What was the net migration of Switzerland from 2012 to 2022?",
    "query": "SELECT year, net_migration as net_migration_of_switzerland\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n    AND S.country = 'TRUE'\n    AND T.year >= 2012\n    AND T.year <= 2022\n    AND T.citizenship_category = 'Citizenship (category) - total';\n",
    "db_id": "demographic_balance_by_canton",
    "generated_query": "SELECT\n    SUM(net_migration) as net_migration\nFROM demographic_balance_by_canton\nWHERE year >= 2012\n    AND year <= 2022;",
    "meta_data": [
      {
        "question": "Which five cantons had the highest number of Swiss citizenship acquisitions in 2017 relative to their population?",
        "query": "SELECT S.name, acquisition_of_swiss_citizenship / total_population as relative_acquisition\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2017\n    AND T.citizenship_category = 'Switzerland'\nORDER BY relative_acquisition DESC\nLIMIT 5;\n",
        "score": 0.6489924192428589
      },
      {
        "question": "In which year did Switzerland experience its highest birth rate?",
        "query": "SELECT T.year, T.births / T.total_population as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND S.name = 'Switzerland'\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, T.births, T.total_population\nORDER BY birthrate DESC\nLIMIT 1;\n",
        "score": 0.6695606708526611
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.demographic_balance_by_canton (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tcitizenship_category TEXT, \n\ttotal_population NUMERIC, \n\tbirths NUMERIC, \n\tdeaths NUMERIC, \n\timmigration NUMERIC, \n\tin_migration_from_another_canton NUMERIC, \n\temigration NUMERIC, \n\tout_migration_to_another_canton NUMERIC, \n\tnet_migration NUMERIC, \n\tacquisition_of_swiss_citizenship NUMERIC, \n\tstatistical_adjustment NUMERIC, \n\tpopulation_change NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT demographic_balance_by_canton_pkey PRIMARY KEY (uid), \n\tCONSTRAINT demographic_balance_by_canton_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in demographic_balance_by_canton and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nyear : 2014, 1992, 2006, 2002, 2005\ntotal_population : 1241312, 7123537, 938859, 1476966, 1249893\nbirths : 83762, 58205, 11231, 4129, 12284\ndeaths : 672, 56064, 61124, 10726, 10170\nimmigration : 4040, 6281, 96880, 31465, 18394\nin_migration_from_another_canton : 16335, 5617, 14585, 16875, 14751\nemigration : 6725, 29487, 6281, 5969, 58851\nout_migration_to_another_canton : 20161, 14751, 3669, 5990, 13299\nnet_migration : 71127, -511, 1666, -823, 21097\nacquisition_of_swiss_citizenship : -2758, -43440, 2104, 20363, 28700\nstatistical_adjustment : 777, 697, 234, -1156, 4649\npopulation_change : 7720, 7268, 5995, 40907, 29413\n*/\n\n/*\nColumn name, Column discription, Example values\ntotal_population, Total population recorded this year, 6335243,5421746,913497\nbirths, Number of live births recorded, 73747,61611,12136\ndeaths, Number of deaths recorded, 59763,56032,3731\nimmigration, Number of people becoming Swiss residents, 121420,28483,92937\nemigration, Number of Swiss residents leaving, 97743,27796,69947\nin_migration_from_another_canton, Number of people moving in from another canton, 134359,119608,14751\nout_migration_to_another_canton, Number of people moving to a different canton, 134359,119608,14751\nnet_migration, Difference between the number of arrivals and departures, 23677,687,22990\nacquisition_of_swiss_citizenship, Number of people acquiring swiss nationality, 0,14299,-14299\nstatistical_adjustment, Changes to the population size that cannot be clearly attributed to demographic movements, 0,574,-34\npopulation_change, Difference in the number of people compared to the previous year, 37661,20565,17096\ncitizenship_category, Citizenship category, Citizenship (category) - total,Foreign country,Switzerland\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nShow me the cantons with the highest birth rates every year between 1995 and 2010.\n### SQL query\nSELECT year, S.name as most_populout_canton, MAX(births / total_population) as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year >= 1995\n    AND T.year <= 2010\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, S.name, T.births\nORDER BY year ASC;\n\n\n### Question\nWhich five cantons experienced the most significant population growth relative to their size between 2000 and 2022?\n### SQL query\nSELECT\n    S.name, (\n        (\n            SUM(CASE WHEN T.year = 2022 THEN total_population ELSE 0 END) -\n            SUM(CASE WHEN T.year = 2000 THEN total_population ELSE 0 END)\n        ) / SUM(CASE WHEN T.year = 2000 THEN total_population ELSE 0 END)\n    ) as relative_population_growth\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year >= 2000\n    AND T.year <= 2022\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY S.name\nORDER BY relative_population_growth DESC\nLIMIT 5;\n\n\n### Question\nWhat was the net migration of Switzerland from 2012 to 2022?\n### SQL query\n",
    "process_time": 5.304561821045354,
    "num_tokens": 1742,
    "hardness": "unknown",
    "scores": [
      0.6489924192428589,
      0.6695606708526611
    ],
    "lang": "en"
  },
  {
    "i": 18,
    "question": "What greenhouse gas footprint had Switzerland in 2000 through consumption?",
    "query": "SELECT T.emissions_in_million_tons_co2_equivalent\nFROM greenhouse_gas_emissions_through_consumption as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2000;\n",
    "db_id": "greenhouse_gas_emissions_through_consumption",
    "generated_query": "SELECT emissions_in_million_tons_co2_equivalent\nFROM greenhouse_gas_emissions_through_consumption\nWHERE year = 2000;",
    "meta_data": [
      {
        "question": "What years did the greenhouse gas footprint of Switzerland decrease compared to the previous year and by how much? Order by magnitude of decrease",
        "query": "WITH EmissionsChange AS (\n    SELECT\n        T1.year AS current_year,\n        T1.emissions_in_million_tons_co2_equivalent AS emissions_current_year,\n        (T1.year - 1) AS previous_year,\n        T2.emissions_in_million_tons_co2_equivalent AS emissions_previous_year,\n        T1.emissions_in_million_tons_co2_equivalent - T2.emissions_in_million_tons_co2_equivalent\n          AS decrease_from_previous_year\n    FROM greenhouse_gas_emissions_through_consumption AS T1\n    JOIN greenhouse_gas_emissions_through_consumption AS T2 ON T1.year = T2.year + 1\n    WHERE T1.year > 2000\n)\nSELECT current_year, decrease_from_previous_year\nFROM EmissionsChange WHERE decrease_from_previous_year < 0\nORDER BY decrease_from_previous_year ASC;\n",
        "score": 0.35349056124687195
      },
      {
        "question": "How much was the greenhouse gas footprint reduced as percentage of the total footprint in the observation period?",
        "query": "WITH FirstYearEmissions AS (\n    SELECT\n        year AS first_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_first_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year ASC\n    LIMIT 1\n),\nLastYearEmissions AS (\n    SELECT\n        year AS last_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_last_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year DESC\n    LIMIT 1\n)\nSELECT\n    first_observation_year,\n    last_observation_year,\n    ((emissions_last_year - emissions_first_year) * 100 / emissions_first_year) AS emission_precentage_change_in_observered_period\nFROM FirstYearEmissions AS CROSS JOIN LastYearEmissions;\n",
        "score": 0.5475857853889465
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.greenhouse_gas_emissions_through_consumption (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\temissions_in_million_tons_co2_equivalent NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT greenhouse_gas_emissions_through_consumption_pkey PRIMARY KEY (uid), \n\tCONSTRAINT greenhouse_gas_emissions_through_consumpti_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in greenhouse_gas_emissions_through_consumption and 5 examples in each column for high cardinality columns :\nuid : 21, 5, 4, 12, 16\nyear : 2014, 2006, 2002, 2005, 2017\nemissions_in_million_tons_co2_equivalent : 121.61843200840400, 110.10918438939900, 116.21843319733000, 113.05347920007300, 117.90056180040800\n*/\n\n/*\nColumn name, Column discription, Example values\nemissions_in_million_tons_co2_equivalent, Greenhouse gas emissions in million metric tons of CO2 equivalent, 117.900561800408\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWhat years did the greenhouse gas footprint of Switzerland decrease compared to the previous year and by how much? Order by magnitude of decrease\n### SQL query\nWITH EmissionsChange AS (\n    SELECT\n        T1.year AS current_year,\n        T1.emissions_in_million_tons_co2_equivalent AS emissions_current_year,\n        (T1.year - 1) AS previous_year,\n        T2.emissions_in_million_tons_co2_equivalent AS emissions_previous_year,\n        T1.emissions_in_million_tons_co2_equivalent - T2.emissions_in_million_tons_co2_equivalent\n          AS decrease_from_previous_year\n    FROM greenhouse_gas_emissions_through_consumption AS T1\n    JOIN greenhouse_gas_emissions_through_consumption AS T2 ON T1.year = T2.year + 1\n    WHERE T1.year > 2000\n)\nSELECT current_year, decrease_from_previous_year\nFROM EmissionsChange WHERE decrease_from_previous_year < 0\nORDER BY decrease_from_previous_year ASC;\n\n\n### Question\nHow much was the greenhouse gas footprint reduced as percentage of the total footprint in the observation period?\n### SQL query\nWITH FirstYearEmissions AS (\n    SELECT\n        year AS first_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_first_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year ASC\n    LIMIT 1\n),\nLastYearEmissions AS (\n    SELECT\n        year AS last_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_last_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year DESC\n    LIMIT 1\n)\nSELECT\n    first_observation_year,\n    last_observation_year,\n    ((emissions_last_year - emissions_first_year) * 100 / emissions_first_year) AS emission_precentage_change_in_observered_period\nFROM FirstYearEmissions AS CROSS JOIN LastYearEmissions;\n\n\n### Question\nWhat greenhouse gas footprint had Switzerland in 2000 through consumption?\n### SQL query\n",
    "process_time": 3.5429393460508436,
    "num_tokens": 1284,
    "hardness": "medium",
    "scores": [
      0.35349056124687195,
      0.5475857853889465
    ],
    "lang": "en"
  },
  {
    "i": 19,
    "question": "In which years did the greenhouse footprint increase and by how much? Order by years and start from the present",
    "query": "WITH EmissionsChange AS (\n    SELECT\n        T1.year AS current_year,\n        T1.emissions_in_million_tons_co2_equivalent AS emissions_current_year,\n        (T1.year - 1) AS previous_year,\n        T2.emissions_in_million_tons_co2_equivalent AS emissions_previous_year,\n        T1.emissions_in_million_tons_co2_equivalent - T2.emissions_in_million_tons_co2_equivalent\n          AS increase_from_previous_year\n    FROM greenhouse_gas_emissions_through_consumption AS T1\n    JOIN greenhouse_gas_emissions_through_consumption AS T2 ON T1.year = T2.year + 1\n    WHERE T1.year > 2000\n)\nSELECT current_year, increase_from_previous_year\nFROM EmissionsChange WHERE increase_from_previous_year > 0\nORDER BY current_year DESC;\n",
    "db_id": "greenhouse_gas_emissions_through_consumption",
    "generated_query": "SELECT\n    year,\n    emissions_in_million_tons_co2_equivalent - LAG(emissions_in_million_tons_co2_equivalent) OVER (ORDER BY year DESC) AS emission_change\nFROM greenhouse_gas_emissions_through_consumption\nWHERE year IS NOT NULL\nORDER BY year DESC;",
    "meta_data": [
      {
        "question": "How did the greenhouse gas footprint develop overall? Did it go up or down and by how much? Compare the first and last year in the data and show both years and the change of the footprint.",
        "query": "WITH FirstYearEmissions AS (\n    SELECT\n        year AS first_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_first_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year ASC\n    LIMIT 1\n),\nLastYearEmissions AS (\n    SELECT\n        year AS last_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_last_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year DESC\n    LIMIT 1\n)\nSELECT\n    first_observation_year,\n    last_observation_year,\n    emissions_last_year - emissions_first_year AS emission_change_in_observered_period\nFROM FirstYearEmissions AS CROSS JOIN LastYearEmissions;\n",
        "score": 0.3732030987739563
      },
      {
        "question": "How much was the greenhouse gas footprint reduced as percentage of the total footprint in the observation period?",
        "query": "WITH FirstYearEmissions AS (\n    SELECT\n        year AS first_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_first_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year ASC\n    LIMIT 1\n),\nLastYearEmissions AS (\n    SELECT\n        year AS last_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_last_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year DESC\n    LIMIT 1\n)\nSELECT\n    first_observation_year,\n    last_observation_year,\n    ((emissions_last_year - emissions_first_year) * 100 / emissions_first_year) AS emission_precentage_change_in_observered_period\nFROM FirstYearEmissions AS CROSS JOIN LastYearEmissions;\n",
        "score": 0.4282057583332062
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.greenhouse_gas_emissions_through_consumption (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\temissions_in_million_tons_co2_equivalent NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT greenhouse_gas_emissions_through_consumption_pkey PRIMARY KEY (uid), \n\tCONSTRAINT greenhouse_gas_emissions_through_consumpti_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in greenhouse_gas_emissions_through_consumption and 5 examples in each column for high cardinality columns :\nuid : 21, 5, 4, 12, 16\nyear : 2014, 2006, 2002, 2005, 2017\nemissions_in_million_tons_co2_equivalent : 121.61843200840400, 110.10918438939900, 116.21843319733000, 113.05347920007300, 117.90056180040800\n*/\n\n/*\nColumn name, Column discription, Example values\nemissions_in_million_tons_co2_equivalent, Greenhouse gas emissions in million metric tons of CO2 equivalent, 117.900561800408\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nHow much was the greenhouse gas footprint reduced as percentage of the total footprint in the observation period?\n### SQL query\nWITH FirstYearEmissions AS (\n    SELECT\n        year AS first_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_first_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year ASC\n    LIMIT 1\n),\nLastYearEmissions AS (\n    SELECT\n        year AS last_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_last_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year DESC\n    LIMIT 1\n)\nSELECT\n    first_observation_year,\n    last_observation_year,\n    ((emissions_last_year - emissions_first_year) * 100 / emissions_first_year) AS emission_precentage_change_in_observered_period\nFROM FirstYearEmissions AS CROSS JOIN LastYearEmissions;\n\n\n### Question\nHow did the greenhouse gas footprint develop overall? Did it go up or down and by how much? Compare the first and last year in the data and show both years and the change of the footprint.\n### SQL query\nWITH FirstYearEmissions AS (\n    SELECT\n        year AS first_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_first_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year ASC\n    LIMIT 1\n),\nLastYearEmissions AS (\n    SELECT\n        year AS last_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_last_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year DESC\n    LIMIT 1\n)\nSELECT\n    first_observation_year,\n    last_observation_year,\n    emissions_last_year - emissions_first_year AS emission_change_in_observered_period\nFROM FirstYearEmissions AS CROSS JOIN LastYearEmissions;\n\n\n### Question\nIn which years did the greenhouse footprint increase and by how much? Order by years and start from the present\n### SQL query\n",
    "process_time": 6.090198243968189,
    "num_tokens": 1275,
    "hardness": "unknown",
    "scores": [
      0.3732030987739563,
      0.4282057583332062
    ],
    "lang": "en"
  },
  {
    "i": 20,
    "question": "What types of fuel are there?",
    "query": "SELECT DISTINCT fuel_type FROM stock_vehicles;\n",
    "db_id": "stock_vehicles",
    "generated_query": "SELECT DISTINCT fuel_type\nFROM stock_vehicles\nWHERE fuel_type != 'total';",
    "meta_data": [
      {
        "question": "What fuel type is most frequently used for motorcycles?",
        "query": "SELECT\n    fuel_type,\n    SUM(amount) AS total_amount\nFROM stock_vehicles WHERE vehicle_type ILIKE '%motorcycle%'\n    AND fuel_type != 'total'\nGROUP BY fuel_type\nORDER BY total_amount DESC\nLIMIT 1;\n",
        "score": 0.5831073522567749
      },
      {
        "question": "How did the proportion of fuel types evolve since 2010?",
        "query": "SELECT\n    sv.year,\n    sv.fuel_type,\n    SUM(sv.amount) AS total_cars,\n    (SUM(sv.amount) * 100.0 / NULLIF(SUM(SUM(sv.amount)) OVER (PARTITION BY sv.year), 0)) AS proportion\nFROM stock_vehicles AS sv\nWHERE\n    sv.year >= 2010 and sv.fuel_type != 'total'\nGROUP BY\n    sv.year, sv.fuel_type\nORDER BY\n    sv.year, sv.fuel_type;\n",
        "score": 0.8681270480155945
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.stock_vehicles (\n\tuid BIGINT NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tvehicle_type VARCHAR(50), \n\tyear INTEGER, \n\tamount INTEGER, \n\tfuel_type VARCHAR(50), \n\tCONSTRAINT stock_vehicles_pk PRIMARY KEY (uid), \n\tCONSTRAINT stock_vehicles_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in stock_vehicles and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nspatialunit_uid : 5754_A.ADM3, 5181_A.ADM3, 1009_A.ADM3, 5484_A.ADM3, 1107_A.ADM3\nyear : 2014, 2013, 2017, 2021, 2011\namount : 71, 447, 60, 1271, 579\nfuel_type : Diesel-electric: Normal-hybrid, Benzine-electric: Normal-hybrid, Diesel, Benzine-electric: Plug-in-hybrid, Benzine\n*/\n\n/*\nColumn name, Column discription, Example values\nvehicle_type, Vehicle type, passenger_cars,trailers,motorcycles\namount, Amount of vehicles, 0,2,240\nfuel_type, Fuel type, Hydrogen,Electric,Diesel-electric: Normal-hybrid\n*/\n\n\n\n### Question\nHow did the proportion of fuel types evolve since 2010?\n### SQL query\nSELECT\n    sv.year,\n    sv.fuel_type,\n    SUM(sv.amount) AS total_cars,\n    (SUM(sv.amount) * 100.0 / NULLIF(SUM(SUM(sv.amount)) OVER (PARTITION BY sv.year), 0)) AS proportion\nFROM stock_vehicles AS sv\nWHERE\n    sv.year >= 2010 and sv.fuel_type != 'total'\nGROUP BY\n    sv.year, sv.fuel_type\nORDER BY\n    sv.year, sv.fuel_type;\n\n\n### Question\nWhat fuel type is most frequently used for motorcycles?\n### SQL query\nSELECT\n    fuel_type,\n    SUM(amount) AS total_amount\nFROM stock_vehicles WHERE vehicle_type ILIKE '%motorcycle%'\n    AND fuel_type != 'total'\nGROUP BY fuel_type\nORDER BY total_amount DESC\nLIMIT 1;\n\n\n### Question\nWhat types of fuel are there?\n### SQL query\n",
    "process_time": 2.7164992580655962,
    "num_tokens": 1115,
    "hardness": "easy",
    "scores": [
      0.5831073522567749,
      0.8681270480155945
    ],
    "lang": "en"
  },
  {
    "i": 21,
    "question": "What was the proportion of electric vehicles in Geneva in 2010?",
    "query": "SELECT\n    SUM(CASE WHEN sv.fuel_type ILIKE '%electric%' THEN sv.amount ELSE 0 END) AS electric_vehicles,\n    SUM(sv.amount) AS total_vehicles,\n    (\n        SUM(CASE WHEN sv.fuel_type ILIKE '%electric%' THEN sv.amount ELSE 0 END) * 100.0 / NULLIF(SUM(sv.amount), 0)\n    ) AS proportion_electric_vehicles\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name ILIKE '%geneva%'\n    AND sv.year = 2010;\n",
    "db_id": "stock_vehicles",
    "generated_query": "SELECT\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.name ILIKE 'Geneva'\n    AND su.municipal = 'True' AND fuel_type ILIKE '%electric%'\n    AND year = 2010;",
    "meta_data": [
      {
        "question": "What is the proportion of electric vehicles of each type in the most recent year, in descending order?",
        "query": "SELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n",
        "score": 0.511628270149231
      },
      {
        "question": "How many electric-only cars are registered in 2013?",
        "query": "SELECT SUM(amount) AS total_electric_cars\nFROM stock_vehicles WHERE fuel_type = 'Electric'\n    AND year = 2013;\n",
        "score": 0.5225951671600342
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.stock_vehicles (\n\tuid BIGINT NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tvehicle_type VARCHAR(50), \n\tyear INTEGER, \n\tamount INTEGER, \n\tfuel_type VARCHAR(50), \n\tCONSTRAINT stock_vehicles_pk PRIMARY KEY (uid), \n\tCONSTRAINT stock_vehicles_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in stock_vehicles and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nspatialunit_uid : 5754_A.ADM3, 5181_A.ADM3, 1009_A.ADM3, 5484_A.ADM3, 1107_A.ADM3\nyear : 2014, 2013, 2017, 2021, 2011\namount : 71, 447, 60, 1271, 579\nfuel_type : Diesel-electric: Normal-hybrid, Benzine-electric: Normal-hybrid, Diesel, Benzine-electric: Plug-in-hybrid, Benzine\n*/\n\n/*\nColumn name, Column discription, Example values\nvehicle_type, Vehicle type, passenger_cars,trailers,motorcycles\namount, Amount of vehicles, 0,2,240\nfuel_type, Fuel type, Hydrogen,Electric,Diesel-electric: Normal-hybrid\n*/\n\n\n\n### Question\nWhat is the percent change in the number of hybrid cars change in the city of Basel between 2013 and 2014?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2014 THEN amount ELSE 0 END) -\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END) AS hybrid_change,\n    (SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2014 THEN amount ELSE 0 END) -\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END)) * 100.0 / NULLIF(SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END), 0) AS hybrid_percent_change\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.name ILIKE 'Basel'\n    AND su.municipal = 'True' AND fuel_type ILIKE '%hybrid%'\n    AND (year = 2013 OR year = 2014)\nGROUP BY\n    vehicle_type;\n\n\n### Question\nWhat is the proportion of electric vehicles of each type in the most recent year, in descending order?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n\n\n### Question\nWhat was the proportion of electric vehicles in Geneva in 2010?\n### SQL query\n",
    "process_time": 14.998020465951413,
    "num_tokens": 1340,
    "hardness": "unknown",
    "scores": [
      0.511628270149231,
      0.5225951671600342
    ],
    "lang": "en"
  },
  {
    "i": 22,
    "question": "What was the city with the most cars in 2015?",
    "query": "SELECT\n    su.name AS city,\n    SUM(sv.amount) AS total_cars\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE sv.year = 2015\n    AND su.municipal = 'True'\n    AND sv.fuel_type = 'total'\nGROUP BY\n    su.name\nORDER BY total_cars DESC\nLIMIT 1;\n",
    "db_id": "stock_vehicles",
    "generated_query": "SELECT\n    su.name AS city,\n    SUM(sv.amount) AS total_cars\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    sv.vehicle_type ILIKE '%cars%'\n    AND sv.year = 2015\nGROUP BY\n    su.name\nORDER BY\n    total_cars DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "What cities do not have any electric cars registered?",
        "query": "SELECT su.name AS city\nFROM spatial_unit AS su\nWHERE NOT EXISTS (\n    SELECT 1\n    FROM stock_vehicles AS sv\n    WHERE su.spatialunit_uid = sv.spatialunit_uid\n        AND sv.fuel_type = 'Electric'\n);\n",
        "score": 0.8139934539794922
      },
      {
        "question": "What canton has the most agricultural vehicles across all years?",
        "query": "SELECT\n    su.name AS city,\n    SUM(sv.amount) AS total_agricultural_vehicles\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    sv.vehicle_type ILIKE '%agricultural%'\n    AND su.canton = 'True'\nGROUP BY\n    su.name\nORDER BY\n    total_agricultural_vehicles DESC\nLIMIT 1;\n",
        "score": 0.8206954598426819
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.stock_vehicles (\n\tuid BIGINT NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tvehicle_type VARCHAR(50), \n\tyear INTEGER, \n\tamount INTEGER, \n\tfuel_type VARCHAR(50), \n\tCONSTRAINT stock_vehicles_pk PRIMARY KEY (uid), \n\tCONSTRAINT stock_vehicles_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in stock_vehicles and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nspatialunit_uid : 5754_A.ADM3, 5181_A.ADM3, 1009_A.ADM3, 5484_A.ADM3, 1107_A.ADM3\nyear : 2014, 2013, 2017, 2021, 2011\namount : 71, 447, 60, 1271, 579\nfuel_type : Diesel-electric: Normal-hybrid, Benzine-electric: Normal-hybrid, Diesel, Benzine-electric: Plug-in-hybrid, Benzine\n*/\n\n/*\nColumn name, Column discription, Example values\nvehicle_type, Vehicle type, passenger_cars,trailers,motorcycles\namount, Amount of vehicles, 0,2,240\nfuel_type, Fuel type, Hydrogen,Electric,Diesel-electric: Normal-hybrid\n*/\n\n\n\n### Question\nWhat are the 5 cantons with the most agricultural vehicles per passenger transportation vehicle in 2010?\n### SQL query\nSELECT\n    su.name AS canton,\n    SUM(CASE WHEN sv.vehicle_type ILIKE '%agricultural%' THEN sv.amount ELSE 0 END) AS total_agricultural_vehicles,\n    SUM(CASE WHEN sv.vehicle_type ILIKE '%passenger transportation%' THEN sv.amount ELSE 0 END) AS total_passenger_vehicles,\n    (SUM(CASE WHEN sv.vehicle_type ILIKE '%agricultural%' THEN sv.amount ELSE 0 END) * 1.0 / NULLIF(SUM(CASE WHEN sv.vehicle_type ILIKE '%passenger transportation%' THEN sv.amount ELSE 0 END), 0)) AS ratio_agricultural_to_passenger\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE sv.year = 2010\n    AND su.canton = 'True'\nGROUP BY su.name\nORDER BY ratio_agricultural_to_passenger DESC\nLIMIT 5;\n\n\n### Question\nWhat canton has the most agricultural vehicles across all years?\n### SQL query\nSELECT\n    su.name AS city,\n    SUM(sv.amount) AS total_agricultural_vehicles\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    sv.vehicle_type ILIKE '%agricultural%'\n    AND su.canton = 'True'\nGROUP BY\n    su.name\nORDER BY\n    total_agricultural_vehicles DESC\nLIMIT 1;\n\n\n### Question\nWhat was the city with the most cars in 2015?\n### SQL query\n",
    "process_time": 9.808336726855487,
    "num_tokens": 1265,
    "hardness": "unknown",
    "scores": [
      0.8139934539794922,
      0.8206954598426819
    ],
    "lang": "en"
  },
  {
    "i": 23,
    "question": "What are fuel types starting with d?",
    "query": "SELECT DISTINCT fuel_type\nFROM stock_vehicles WHERE fuel_type ILIKE 'd%';\n",
    "db_id": "stock_vehicles",
    "generated_query": "SELECT\n    DISTINCT fuel_type\nFROM stock_vehicles\nWHERE fuel_type ILIKE 'd%';",
    "meta_data": [
      {
        "question": "What fuel type is most frequently used for motorcycles?",
        "query": "SELECT\n    fuel_type,\n    SUM(amount) AS total_amount\nFROM stock_vehicles WHERE vehicle_type ILIKE '%motorcycle%'\n    AND fuel_type != 'total'\nGROUP BY fuel_type\nORDER BY total_amount DESC\nLIMIT 1;\n",
        "score": 0.676973819732666
      },
      {
        "question": "How did the proportion of fuel types evolve since 2010?",
        "query": "SELECT\n    sv.year,\n    sv.fuel_type,\n    SUM(sv.amount) AS total_cars,\n    (SUM(sv.amount) * 100.0 / NULLIF(SUM(SUM(sv.amount)) OVER (PARTITION BY sv.year), 0)) AS proportion\nFROM stock_vehicles AS sv\nWHERE\n    sv.year >= 2010 and sv.fuel_type != 'total'\nGROUP BY\n    sv.year, sv.fuel_type\nORDER BY\n    sv.year, sv.fuel_type;\n",
        "score": 1.0104217529296875
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.stock_vehicles (\n\tuid BIGINT NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tvehicle_type VARCHAR(50), \n\tyear INTEGER, \n\tamount INTEGER, \n\tfuel_type VARCHAR(50), \n\tCONSTRAINT stock_vehicles_pk PRIMARY KEY (uid), \n\tCONSTRAINT stock_vehicles_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in stock_vehicles and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nspatialunit_uid : 5754_A.ADM3, 5181_A.ADM3, 1009_A.ADM3, 5484_A.ADM3, 1107_A.ADM3\nyear : 2014, 2013, 2017, 2021, 2011\namount : 71, 447, 60, 1271, 579\nfuel_type : Diesel-electric: Normal-hybrid, Benzine-electric: Normal-hybrid, Diesel, Benzine-electric: Plug-in-hybrid, Benzine\n*/\n\n/*\nColumn name, Column discription, Example values\nvehicle_type, Vehicle type, passenger_cars,trailers,motorcycles\namount, Amount of vehicles, 0,2,240\nfuel_type, Fuel type, Hydrogen,Electric,Diesel-electric: Normal-hybrid\n*/\n\n\n\n### Question\nHow did the proportion of fuel types evolve since 2010?\n### SQL query\nSELECT\n    sv.year,\n    sv.fuel_type,\n    SUM(sv.amount) AS total_cars,\n    (SUM(sv.amount) * 100.0 / NULLIF(SUM(SUM(sv.amount)) OVER (PARTITION BY sv.year), 0)) AS proportion\nFROM stock_vehicles AS sv\nWHERE\n    sv.year >= 2010 and sv.fuel_type != 'total'\nGROUP BY\n    sv.year, sv.fuel_type\nORDER BY\n    sv.year, sv.fuel_type;\n\n\n### Question\nWhat fuel type is most frequently used for motorcycles?\n### SQL query\nSELECT\n    fuel_type,\n    SUM(amount) AS total_amount\nFROM stock_vehicles WHERE vehicle_type ILIKE '%motorcycle%'\n    AND fuel_type != 'total'\nGROUP BY fuel_type\nORDER BY total_amount DESC\nLIMIT 1;\n\n\n### Question\nWhat are fuel types starting with d?\n### SQL query\n",
    "process_time": 4.197352974908426,
    "num_tokens": 1116,
    "hardness": "unknown",
    "scores": [
      0.676973819732666,
      1.0104217529296875
    ],
    "lang": "en"
  },
  {
    "i": 24,
    "question": "What are the top 10 cities with the highest proportion of diesel cars?",
    "query": "SELECT\n    su.name AS city,\n    (SUM(CASE WHEN sv.fuel_type ILIKE '%diesel%' THEN sv.amount ELSE 0 END) * 100.0 / SUM(CASE WHEN sv.fuel_type = 'total' THEN sv.amount ELSE 0 END) ) AS proportion_diesel\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.name IS NOT NULL\nGROUP BY\n    su.name\nORDER BY\n    proportion_diesel DESC\nLIMIT 10;\n",
    "db_id": "stock_vehicles",
    "generated_query": "SELECT\n    su.name AS city,\n    SUM(CASE WHEN sv.fuel_type ILIKE '%diesel%' THEN sv.amount ELSE 0 END) AS total_diesel_cars,\n    SUM(sv.amount) AS total_cars,\n    (SUM(CASE WHEN sv.fuel_type ILIKE '%diesel%' THEN sv.amount ELSE 0 END) * 1.0 / NULLIF(SUM(sv.amount), 0)) AS proportion_diesel_cars\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.city = 'True'\nGROUP BY su.name\nORDER BY proportion_diesel_cars DESC\nLIMIT 10;",
    "meta_data": [
      {
        "question": "What are the 5 cantons with the most agricultural vehicles per passenger transportation vehicle in 2010?",
        "query": "SELECT\n    su.name AS canton,\n    SUM(CASE WHEN sv.vehicle_type ILIKE '%agricultural%' THEN sv.amount ELSE 0 END) AS total_agricultural_vehicles,\n    SUM(CASE WHEN sv.vehicle_type ILIKE '%passenger transportation%' THEN sv.amount ELSE 0 END) AS total_passenger_vehicles,\n    (SUM(CASE WHEN sv.vehicle_type ILIKE '%agricultural%' THEN sv.amount ELSE 0 END) * 1.0 / NULLIF(SUM(CASE WHEN sv.vehicle_type ILIKE '%passenger transportation%' THEN sv.amount ELSE 0 END), 0)) AS ratio_agricultural_to_passenger\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE sv.year = 2010\n    AND su.canton = 'True'\nGROUP BY su.name\nORDER BY ratio_agricultural_to_passenger DESC\nLIMIT 5;\n",
        "score": 0.5856741070747375
      },
      {
        "question": "What cities do not have any electric cars registered?",
        "query": "SELECT su.name AS city\nFROM spatial_unit AS su\nWHERE NOT EXISTS (\n    SELECT 1\n    FROM stock_vehicles AS sv\n    WHERE su.spatialunit_uid = sv.spatialunit_uid\n        AND sv.fuel_type = 'Electric'\n);\n",
        "score": 0.5960790514945984
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.stock_vehicles (\n\tuid BIGINT NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tvehicle_type VARCHAR(50), \n\tyear INTEGER, \n\tamount INTEGER, \n\tfuel_type VARCHAR(50), \n\tCONSTRAINT stock_vehicles_pk PRIMARY KEY (uid), \n\tCONSTRAINT stock_vehicles_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in stock_vehicles and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nspatialunit_uid : 5754_A.ADM3, 5181_A.ADM3, 1009_A.ADM3, 5484_A.ADM3, 1107_A.ADM3\nyear : 2014, 2013, 2017, 2021, 2011\namount : 71, 447, 60, 1271, 579\nfuel_type : Diesel-electric: Normal-hybrid, Benzine-electric: Normal-hybrid, Diesel, Benzine-electric: Plug-in-hybrid, Benzine\n*/\n\n/*\nColumn name, Column discription, Example values\nvehicle_type, Vehicle type, passenger_cars,trailers,motorcycles\namount, Amount of vehicles, 0,2,240\nfuel_type, Fuel type, Hydrogen,Electric,Diesel-electric: Normal-hybrid\n*/\n\n\n\n### Question\nWhat are the 5 cantons with the most agricultural vehicles per passenger transportation vehicle in 2010?\n### SQL query\nSELECT\n    su.name AS canton,\n    SUM(CASE WHEN sv.vehicle_type ILIKE '%agricultural%' THEN sv.amount ELSE 0 END) AS total_agricultural_vehicles,\n    SUM(CASE WHEN sv.vehicle_type ILIKE '%passenger transportation%' THEN sv.amount ELSE 0 END) AS total_passenger_vehicles,\n    (SUM(CASE WHEN sv.vehicle_type ILIKE '%agricultural%' THEN sv.amount ELSE 0 END) * 1.0 / NULLIF(SUM(CASE WHEN sv.vehicle_type ILIKE '%passenger transportation%' THEN sv.amount ELSE 0 END), 0)) AS ratio_agricultural_to_passenger\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE sv.year = 2010\n    AND su.canton = 'True'\nGROUP BY su.name\nORDER BY ratio_agricultural_to_passenger DESC\nLIMIT 5;\n\n\n### Question\nWhat canton has the most agricultural vehicles across all years?\n### SQL query\nSELECT\n    su.name AS city,\n    SUM(sv.amount) AS total_agricultural_vehicles\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    sv.vehicle_type ILIKE '%agricultural%'\n    AND su.canton = 'True'\nGROUP BY\n    su.name\nORDER BY\n    total_agricultural_vehicles DESC\nLIMIT 1;\n\n\n### Question\nWhat are the top 10 cities with the highest proportion of diesel cars?\n### SQL query\n",
    "process_time": 11.793664464028552,
    "num_tokens": 1267,
    "hardness": "unknown",
    "scores": [
      0.5856741070747375,
      0.5960790514945984
    ],
    "lang": "en"
  },
  {
    "i": 25,
    "question": "What year saw the biggest year-on-year increase in electric cars in the city of Basel?",
    "query": "SELECT\n    year,\n    year_on_year_increase\nFROM (\n    SELECT\n        sv.year,\n        (sv.amount - lag(sv.amount) OVER (ORDER BY sv.year)) AS year_on_year_increase\n    FROM spatial_unit AS su\n        INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\n    WHERE\n        su.name = 'Basel' and su.municipal = 'True'\n        AND sv.fuel_type ILIKE '%electric%'\n) AS subquery\nWHERE\n    year_on_year_increase IS NOT NULL\nORDER BY\n    year_on_year_increase DESC\nLIMIT 1;\n",
    "db_id": "stock_vehicles",
    "generated_query": "SELECT\n    year,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' AND su.name ILIKE 'Basel' THEN amount ELSE 0 END) -\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' AND su.name ILIKE 'Basel' AND year = year - 1 THEN amount ELSE 0 END) AS electric_increase\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.name ILIKE 'Basel'\n    AND fuel_type ILIKE '%electric%'\nGROUP BY\n    year\nORDER BY\n    electric_increase DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "What is the percent change in the number of hybrid cars change in the city of Basel between 2013 and 2014?",
        "query": "SELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2014 THEN amount ELSE 0 END) -\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END) AS hybrid_change,\n    (SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2014 THEN amount ELSE 0 END) -\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END)) * 100.0 / NULLIF(SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END), 0) AS hybrid_percent_change\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.name ILIKE 'Basel'\n    AND su.municipal = 'True' AND fuel_type ILIKE '%hybrid%'\n    AND (year = 2013 OR year = 2014)\nGROUP BY\n    vehicle_type;\n",
        "score": 0.4847657382488251
      },
      {
        "question": "What is the proportion of electric vehicles of each type in the most recent year, in descending order?",
        "query": "SELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n",
        "score": 0.6977643966674805
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.stock_vehicles (\n\tuid BIGINT NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tvehicle_type VARCHAR(50), \n\tyear INTEGER, \n\tamount INTEGER, \n\tfuel_type VARCHAR(50), \n\tCONSTRAINT stock_vehicles_pk PRIMARY KEY (uid), \n\tCONSTRAINT stock_vehicles_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in stock_vehicles and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nspatialunit_uid : 5754_A.ADM3, 5181_A.ADM3, 1009_A.ADM3, 5484_A.ADM3, 1107_A.ADM3\nyear : 2014, 2013, 2017, 2021, 2011\namount : 71, 447, 60, 1271, 579\nfuel_type : Diesel-electric: Normal-hybrid, Benzine-electric: Normal-hybrid, Diesel, Benzine-electric: Plug-in-hybrid, Benzine\n*/\n\n/*\nColumn name, Column discription, Example values\nvehicle_type, Vehicle type, passenger_cars,trailers,motorcycles\namount, Amount of vehicles, 0,2,240\nfuel_type, Fuel type, Hydrogen,Electric,Diesel-electric: Normal-hybrid\n*/\n\n\n\n### Question\nWhat is the percent change in the number of hybrid cars change in the city of Basel between 2013 and 2014?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2014 THEN amount ELSE 0 END) -\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END) AS hybrid_change,\n    (SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2014 THEN amount ELSE 0 END) -\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END)) * 100.0 / NULLIF(SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END), 0) AS hybrid_percent_change\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.name ILIKE 'Basel'\n    AND su.municipal = 'True' AND fuel_type ILIKE '%hybrid%'\n    AND (year = 2013 OR year = 2014)\nGROUP BY\n    vehicle_type;\n\n\n### Question\nWhat canton has the most agricultural vehicles across all years?\n### SQL query\nSELECT\n    su.name AS city,\n    SUM(sv.amount) AS total_agricultural_vehicles\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    sv.vehicle_type ILIKE '%agricultural%'\n    AND su.canton = 'True'\nGROUP BY\n    su.name\nORDER BY\n    total_agricultural_vehicles DESC\nLIMIT 1;\n\n\n### Question\nWhat year saw the biggest year-on-year increase in electric cars in the city of Basel?\n### SQL query\n",
    "process_time": 9.313241803087294,
    "num_tokens": 1312,
    "hardness": "unknown",
    "scores": [
      0.4847657382488251,
      0.6977643966674805
    ],
    "lang": "en"
  },
  {
    "i": 26,
    "question": "How many favorite babynames are registered in year 2011?",
    "query": "SELECT DISTINCT COUNT(bnff.first_name)\nFROM baby_names_favorite_firstname as bnff\nWHERE bnff.year = 2011;\n",
    "db_id": "baby_names_favorite_firstname",
    "generated_query": "SELECT COUNT(*)\nFROM baby_names_favorite_firstname\nWHERE year = 2011;",
    "meta_data": [
      {
        "question": "How many baby names were registered?",
        "query": "SELECT DISTINCT COUNT(bnff.first_name)\nFROM baby_names_favorite_firstname as bnff;\n",
        "score": 0.40021374821662903
      },
      {
        "question": "Which year has the most registered baby names for all cantons?",
        "query": "SELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n",
        "score": 0.6274170279502869
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.baby_names_favorite_firstname (\n\tuid SERIAL NOT NULL, \n\tgender TEXT, \n\tyear INTEGER, \n\tfirst_name TEXT, \n\tamount NUMERIC, \n\trank NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT baby_names_favorite_firstname_pkey PRIMARY KEY (uid), \n\tCONSTRAINT baby_names_favorite_firstname_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in baby_names_favorite_firstname and 5 examples in each column for high cardinality columns :\nuid : 2162597, 2162567, 2162656, 2162704, 2162595\nyear : 2014, 2006, 2002, 2005, 2017\nrank : 152, 133, 124, 173, 0\n*/\n\n/*\nColumn name, Column discription, Example values\ngender, gender, girl,boy\nfirst_name, First name, Anna,Martin\nrank, rank, 12\namount, amount, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nHow many baby names were registered?\n### SQL query\nSELECT DISTINCT COUNT(bnff.first_name)\nFROM baby_names_favorite_firstname as bnff;\n\n\n### Question\nWhich year has the most registered baby names for all cantons?\n### SQL query\nSELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n\n\n### Question\nHow many favorite babynames are registered in year 2011?\n### SQL query\n",
    "process_time": 2.8297209858428687,
    "num_tokens": 960,
    "hardness": "easy",
    "scores": [
      0.40021374821662903,
      0.6274170279502869
    ],
    "lang": "en"
  },
  {
    "i": 27,
    "question": "Show me all amount of baby names in all municipalities.",
    "query": "SELECT bnff.first_name, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.municipal = 'TRUE';\n",
    "db_id": "baby_names_favorite_firstname",
    "generated_query": "SELECT sum(amount) as total_amount, su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.municipal = 'TRUE'\nGROUP BY su.name;",
    "meta_data": [
      {
        "question": "How many baby names were registered?",
        "query": "SELECT DISTINCT COUNT(bnff.first_name)\nFROM baby_names_favorite_firstname as bnff;\n",
        "score": 0.6591914892196655
      },
      {
        "question": "Which year has the most registered baby names for all cantons?",
        "query": "SELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n",
        "score": 0.6762000322341919
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.baby_names_favorite_firstname (\n\tuid SERIAL NOT NULL, \n\tgender TEXT, \n\tyear INTEGER, \n\tfirst_name TEXT, \n\tamount NUMERIC, \n\trank NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT baby_names_favorite_firstname_pkey PRIMARY KEY (uid), \n\tCONSTRAINT baby_names_favorite_firstname_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in baby_names_favorite_firstname and 5 examples in each column for high cardinality columns :\nuid : 2162597, 2162567, 2162656, 2162704, 2162595\nyear : 2014, 2006, 2002, 2005, 2017\nrank : 152, 133, 124, 173, 0\n*/\n\n/*\nColumn name, Column discription, Example values\ngender, gender, girl,boy\nfirst_name, First name, Anna,Martin\nrank, rank, 12\namount, amount, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nShow me all top-1 ranked boy names for in each canton in year 2014.\n### SQL query\nSELECT bnff.first_name, su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2014 and bnff.rank = 1;;\n\n\n### Question\nWhich canton has least borned boys registed in 2011?\n### SQL query\nSELECT sum(bnff.amount), su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2011\nGROUP BY su.name\nORDER BY sum(bnff.amount) LIMIT 1;\n\n\n### Question\nShow me all amount of baby names in all municipalities.\n### SQL query\n",
    "process_time": 4.6827098310459405,
    "num_tokens": 1036,
    "hardness": "medium",
    "scores": [
      0.6591914892196655,
      0.6762000322341919
    ],
    "lang": "en"
  },
  {
    "i": 28,
    "question": "Which canton has the most borned boys called 'Oscar' in 2016?",
    "query": "SELECT su.name, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 AND gender = 'boy' AND bnff.first_name = 'Oscar' AND su.canton = 'TRUE'\nORDER BY bnff.amount DESC LIMIT 1;\n",
    "db_id": "baby_names_favorite_firstname",
    "generated_query": "SELECT sum(bnff.amount), su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2016 and bnff.first_name = 'Oscar'\nGROUP BY su.name\nORDER BY sum(bnff.amount) DESC LIMIT 1;",
    "meta_data": [
      {
        "question": "Which canton has least borned boys registed in 2011?",
        "query": "SELECT sum(bnff.amount), su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2011\nGROUP BY su.name\nORDER BY sum(bnff.amount) LIMIT 1;\n",
        "score": 0.42281436920166016
      },
      {
        "question": "Which canton has most borned girls registed in 2011?",
        "query": "SELECT sum(bnff.amount), su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'girl' and bnff.year = 2011\nGROUP BY su.name\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n",
        "score": 0.5534662008285522
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.baby_names_favorite_firstname (\n\tuid SERIAL NOT NULL, \n\tgender TEXT, \n\tyear INTEGER, \n\tfirst_name TEXT, \n\tamount NUMERIC, \n\trank NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT baby_names_favorite_firstname_pkey PRIMARY KEY (uid), \n\tCONSTRAINT baby_names_favorite_firstname_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in baby_names_favorite_firstname and 5 examples in each column for high cardinality columns :\nuid : 2162597, 2162567, 2162656, 2162704, 2162595\nyear : 2014, 2006, 2002, 2005, 2017\nrank : 152, 133, 124, 173, 0\n*/\n\n/*\nColumn name, Column discription, Example values\ngender, gender, girl,boy\nfirst_name, First name, Anna,Martin\nrank, rank, 12\namount, amount, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWhich canton has least borned boys registed in 2011?\n### SQL query\nSELECT sum(bnff.amount), su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2011\nGROUP BY su.name\nORDER BY sum(bnff.amount) LIMIT 1;\n\n\n### Question\nWhich canton has most borned girls registed in 2011?\n### SQL query\nSELECT sum(bnff.amount), su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'girl' and bnff.year = 2011\nGROUP BY su.name\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n\n\n### Question\nWhich canton has the most borned boys called 'Oscar' in 2016?\n### SQL query\n",
    "process_time": 11.119687502039596,
    "num_tokens": 1050,
    "hardness": "extra",
    "scores": [
      0.42281436920166016,
      0.5534662008285522
    ],
    "lang": "en"
  },
  {
    "i": 29,
    "question": "Show me all top-1 ranked girl names for in each canton in year 2016. Return me the amount and year as well.",
    "query": "SELECT bnff.first_name, su.name, bnff.amount, bnff.year\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'girl' and bnff.year = 2016 and bnff.rank = 1;\n",
    "db_id": "baby_names_favorite_firstname",
    "generated_query": "SELECT bnff.first_name, su.name, bnff.amount, bnff.year\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'girl' and bnff.year = 2016 and bnff.rank = 1;",
    "meta_data": [
      {
        "question": "Show me all top-1 ranked boy names for in each canton in year 2014.",
        "query": "SELECT bnff.first_name, su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2014 and bnff.rank = 1;;\n",
        "score": 0.3972899913787842
      },
      {
        "question": "Show me the top one ranking boy names for each year after 2012 in canton Zug. Fetch me the result in an ascending order of the year.",
        "query": "SELECT bnff.first_name, bnff.year\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Zug%' and bnff.gender = 'boy' and bnff.year > 2012 and bnff.rank = 1\nORDER BY bnff.year;\n",
        "score": 0.49773237109184265
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.baby_names_favorite_firstname (\n\tuid SERIAL NOT NULL, \n\tgender TEXT, \n\tyear INTEGER, \n\tfirst_name TEXT, \n\tamount NUMERIC, \n\trank NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT baby_names_favorite_firstname_pkey PRIMARY KEY (uid), \n\tCONSTRAINT baby_names_favorite_firstname_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in baby_names_favorite_firstname and 5 examples in each column for high cardinality columns :\nuid : 2162597, 2162567, 2162656, 2162704, 2162595\nyear : 2014, 2006, 2002, 2005, 2017\nrank : 152, 133, 124, 173, 0\n*/\n\n/*\nColumn name, Column discription, Example values\ngender, gender, girl,boy\nfirst_name, First name, Anna,Martin\nrank, rank, 12\namount, amount, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nShow me the top one ranking boy names for each year after 2012 in canton Zug. Fetch me the result in an ascending order of the year.\n### SQL query\nSELECT bnff.first_name, bnff.year\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Zug%' and bnff.gender = 'boy' and bnff.year > 2012 and bnff.rank = 1\nORDER BY bnff.year;\n\n\n### Question\nShow me all top-1 ranked boy names for in each canton in year 2014.\n### SQL query\nSELECT bnff.first_name, su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2014 and bnff.rank = 1;;\n\n\n### Question\nShow me all top-1 ranked girl names for in each canton in year 2016. Return me the amount and year as well.\n### SQL query\n",
    "process_time": 8.732031224062666,
    "num_tokens": 1076,
    "hardness": "extra",
    "scores": [
      0.3972899913787842,
      0.49773237109184265
    ],
    "lang": "en"
  },
  {
    "i": 30,
    "question": "How many girls new borned with name initial L from canton Zurich in 2016?",
    "query": "SELECT sum(amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 AND gender = 'girl' AND su.canton = ''True''\nAND su.name ilike '%zurich%' AND bnff.first_name ilike 'l%';\n",
    "db_id": "baby_names_favorite_firstname",
    "generated_query": "SELECT sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name = 'Zurich' and bnff.gender = 'girl' and bnff.first_name LIKE 'L%' and bnff.year = 2016;",
    "meta_data": [
      {
        "question": "Which year has the most registered baby names for all cantons?",
        "query": "SELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n",
        "score": 0.5456752777099609
      },
      {
        "question": "Which year has the least registered baby names for all cantons?",
        "query": "SELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) LIMIT 1;\n",
        "score": 0.5670934915542603
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.baby_names_favorite_firstname (\n\tuid SERIAL NOT NULL, \n\tgender TEXT, \n\tyear INTEGER, \n\tfirst_name TEXT, \n\tamount NUMERIC, \n\trank NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT baby_names_favorite_firstname_pkey PRIMARY KEY (uid), \n\tCONSTRAINT baby_names_favorite_firstname_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in baby_names_favorite_firstname and 5 examples in each column for high cardinality columns :\nuid : 2162597, 2162567, 2162656, 2162704, 2162595\nyear : 2014, 2006, 2002, 2005, 2017\nrank : 152, 133, 124, 173, 0\n*/\n\n/*\nColumn name, Column discription, Example values\ngender, gender, girl,boy\nfirst_name, First name, Anna,Martin\nrank, rank, 12\namount, amount, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWhich canton has most borned girls registed in 2011?\n### SQL query\nSELECT sum(bnff.amount), su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'girl' and bnff.year = 2011\nGROUP BY su.name\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n\n\n### Question\nWhich canton has least borned boys registed in 2011?\n### SQL query\nSELECT sum(bnff.amount), su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2011\nGROUP BY su.name\nORDER BY sum(bnff.amount) LIMIT 1;\n\n\n### Question\nHow many girls new borned with name initial L from canton Zurich in 2016?\n### SQL query\n",
    "process_time": 5.461191416950896,
    "num_tokens": 1050,
    "hardness": "unknown",
    "scores": [
      0.5456752777099609,
      0.5670934915542603
    ],
    "lang": "en"
  },
  {
    "i": 31,
    "question": "Show me the top one ranking girl names from year 2010 in Switzerland.",
    "query": "SELECT bnff.first_name, bnff.year\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.country = 'TRUE' and su.name ilike '%Switzerland%' and bnff.gender = 'girl'\nand bnff.year >= 2010 and bnff.rank = 1\nORDER BY bnff.year;\n",
    "db_id": "baby_names_favorite_firstname",
    "generated_query": "SELECT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.country = 'TRUE' and bnff.gender = 'girl' and bnff.year = 2010 and bnff.rank = 1;",
    "meta_data": [
      {
        "question": "Show me the most popular names of girls in Switzerland in 2016.",
        "query": "SELECT first_name, gender, amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 and gender = 'girl' AND su.country = ''True'' AND su.name = 'Switzerland'\nORDER BY bnff.amount DESC LIMIT 1;\n",
        "score": 0.30193373560905457
      },
      {
        "question": "Show me all registered gender-universal names in Switzerland.",
        "query": "SELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Switzerland%' and su.country = 'TRUE' and gender = 'girl'\nintersect\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Switzerland%' and su.country = 'TRUE' and gender = 'boy';\n",
        "score": 0.6041679382324219
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.baby_names_favorite_firstname (\n\tuid SERIAL NOT NULL, \n\tgender TEXT, \n\tyear INTEGER, \n\tfirst_name TEXT, \n\tamount NUMERIC, \n\trank NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT baby_names_favorite_firstname_pkey PRIMARY KEY (uid), \n\tCONSTRAINT baby_names_favorite_firstname_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in baby_names_favorite_firstname and 5 examples in each column for high cardinality columns :\nuid : 2162597, 2162567, 2162656, 2162704, 2162595\nyear : 2014, 2006, 2002, 2005, 2017\nrank : 152, 133, 124, 173, 0\n*/\n\n/*\nColumn name, Column discription, Example values\ngender, gender, girl,boy\nfirst_name, First name, Anna,Martin\nrank, rank, 12\namount, amount, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nShow me the top one ranking boy names for each year after 2012 in canton Zug. Fetch me the result in an ascending order of the year.\n### SQL query\nSELECT bnff.first_name, bnff.year\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Zug%' and bnff.gender = 'boy' and bnff.year > 2012 and bnff.rank = 1\nORDER BY bnff.year;\n\n\n### Question\nShow me all top-1 ranked boy names for in each canton in year 2014.\n### SQL query\nSELECT bnff.first_name, su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2014 and bnff.rank = 1;;\n\n\n### Question\nShow me the top one ranking girl names from year 2010 in Switzerland.\n### SQL query\n",
    "process_time": 6.976552008884028,
    "num_tokens": 1063,
    "hardness": "unknown",
    "scores": [
      0.30193373560905457,
      0.6041679382324219
    ],
    "lang": "en"
  },
  {
    "i": 32,
    "question": "How many divorces were there in canton zurich in 2020?",
    "query": "SELECT S.name, T.year, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Zurich%'\nAND T.year = 2020\nAND S.canton = 'True'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nGROUP BY S.name, T.year;\n",
    "db_id": "divorces_duration_of_marriage_age_classes",
    "generated_query": "SELECT S.name, T.year, SUM(T.amount) AS total_divorces\nFROM divorces_duration_of_marriage_age_classes AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Zurich%'\nAND T.year = 2020\nAND S.canton = 'True'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nGROUP BY S.name, T.year;",
    "meta_data": [
      {
        "question": "How many women divorced at age between 20 and 29 in canton zurich in 2020?",
        "query": "SELECT S.name, T.year, T.age_class_wife, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Zurich%'\nAND T.year = 2020\nAND S.canton = 'True'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = '20-29 years'\nGROUP BY S.name, T.year, T.age_class_wife;\n",
        "score": 0.18753227591514587
      },
      {
        "question": "How many divorces happened in Basel in 2015 and after how many years of marriage?",
        "query": "SELECT S.name, S.spatialunit_ontology, T.year, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM divorces_duration_of_marriage_age_classes AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2015\nAND T.duration_of_marriage != 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.name ilike '%basel%'\nGROUP BY T.year, T.duration_of_marriage, S.spatialunit_ontology, S.name;\n",
        "score": 0.39490199089050293
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_age_classes (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tage_class_husband VARCHAR(50), \n\tage_class_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_spatial_unit_spatialu FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_age_classes and 5 examples in each column for high cardinality columns :\nuid : 857302, 857244, 857392, 857224, 857364\nspatialunit_uid : 1_A.ADM1, 24_A.ADM1, 23_A.ADM1, 8_A.ADM1, 22_A.ADM1\nyear : 2014, 1980, 1992, 2006, 2002\namount : 21, 48, 4, 12, 30\n*/\n\n/*\nColumn name, Column discription, Example values\nage_class_husband, age class of the husband, Age class of husband - total,Less than 20 years,80-89 years\nage_class_wife, age class of the wife, Age class of wife - total,Less than 20 years,80-89 years\nduration_of_marriage, duration class of marriage, Duration of marriage - total,5-9 years,20 years or more\namount, Count of divorces, 120\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nIn Canton Uri how many marriages where divorced in 2003 after more than 10 years?\n### SQL query\nSELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2003\nAND (T.duration_of_marriage = '10-14 years'\n         OR T.duration_of_marriage = '15-19 years'\n         OR T.duration_of_marriage = '20 years or more')\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton AND S.name ilike '% Uri%'\nGROUP BY S.name, T.duration_of_marriage\nORDER BY T.duration_of_marriage DESC;\n\n### Question\nHow many women divorced at age between 20 and 29 in canton zurich in 2020?\n### SQL query\nSELECT S.name, T.year, T.age_class_wife, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Zurich%'\nAND T.year = 2020\nAND S.canton = 'True'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = '20-29 years'\nGROUP BY S.name, T.year, T.age_class_wife;\n\n\n### Question\nHow many divorces were there in canton zurich in 2020?\n### SQL query\n",
    "process_time": 9.655504074180499,
    "num_tokens": 1324,
    "hardness": "unknown",
    "scores": [
      0.18753227591514587,
      0.39490199089050293
    ],
    "lang": "en"
  },
  {
    "i": 33,
    "question": "Did any people divorce at an age of 70 or above in Switzerland in 2000?",
    "query": "SELECT S.name, T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND (T.age_class_husband = '90 years or older' OR T.age_class_husband = '70-79 years')\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.country\nGROUP BY S.name, T.age_class_husband;\n",
    "db_id": "divorces_duration_of_marriage_age_classes",
    "generated_query": "SELECT COUNT(*) AS total_divorces\nFROM divorces_duration_of_marriage_age_classes AS T\nWHERE T.year = 2000\nAND (T.age_class_husband = '70-79 years'\n         OR T.age_class_husband = '80-89 years'\n         OR T.age_class_husband = '90 years or more'\n         OR T.age_class_wife = '70-79 years'\n         OR T.age_class_wife = '80-89 years'\n         OR T.age_class_wife = '90 years or more');",
    "meta_data": [
      {
        "question": "Did any person divorce at an age of 90 or above in Switzerland since 2000?",
        "query": "SELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '90 years or older'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '90 years or older'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;\n",
        "score": 0.02877897210419178
      },
      {
        "question": "Did any men divorce at an age of 90 or above in Switzerland in 2000?",
        "query": "SELECT S.name, T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = '90 years or older'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.country\nGROUP BY S.name, T.age_class_husband\nORDER BY total_divorces ASC\nLIMIT 1;\n",
        "score": 0.05696381628513336
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_age_classes (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tage_class_husband VARCHAR(50), \n\tage_class_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_spatial_unit_spatialu FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_age_classes and 5 examples in each column for high cardinality columns :\nuid : 857302, 857244, 857392, 857224, 857364\nspatialunit_uid : 1_A.ADM1, 24_A.ADM1, 23_A.ADM1, 8_A.ADM1, 22_A.ADM1\nyear : 2014, 1980, 1992, 2006, 2002\namount : 21, 48, 4, 12, 30\n*/\n\n/*\nColumn name, Column discription, Example values\nage_class_husband, age class of the husband, Age class of husband - total,Less than 20 years,80-89 years\nage_class_wife, age class of the wife, Age class of wife - total,Less than 20 years,80-89 years\nduration_of_marriage, duration class of marriage, Duration of marriage - total,5-9 years,20 years or more\namount, Count of divorces, 120\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nIn Canton Uri how many marriages where divorced in 2003 after more than 10 years?\n### SQL query\nSELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2003\nAND (T.duration_of_marriage = '10-14 years'\n         OR T.duration_of_marriage = '15-19 years'\n         OR T.duration_of_marriage = '20 years or more')\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton AND S.name ilike '% Uri%'\nGROUP BY S.name, T.duration_of_marriage\nORDER BY T.duration_of_marriage DESC;\n\n### Question\nWhat was the prominent age for women that divorced in Switzerland in 2000?\n### SQL query\nSELECT T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife != 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_wife\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nDid any people divorce at an age of 70 or above in Switzerland in 2000?\n### SQL query\n",
    "process_time": 8.434799534035847,
    "num_tokens": 1311,
    "hardness": "unknown",
    "scores": [
      0.02877897210419178,
      0.05696381628513336
    ],
    "lang": "en"
  },
  {
    "i": 34,
    "question": "Which year between 1990 and 2000 had the least divorces in Stadt Basel?",
    "query": "SELECT S.name, T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 1990\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.country\nGROUP BY S.name, T.year\nORDER BY T.year;\n",
    "db_id": "divorces_duration_of_marriage_age_classes",
    "generated_query": "SELECT S.name, T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year BETWEEN 1990 AND 2000\nAND T.duration_of_marriage != 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.name = 'Stadt Basel'\nGROUP BY S.name, T.year\nORDER BY total_divorces;",
    "meta_data": [
      {
        "question": "How many divorces happened in Basel in 2015 and after how many years of marriage?",
        "query": "SELECT S.name, S.spatialunit_ontology, T.year, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM divorces_duration_of_marriage_age_classes AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2015\nAND T.duration_of_marriage != 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.name ilike '%basel%'\nGROUP BY T.year, T.duration_of_marriage, S.spatialunit_ontology, S.name;\n",
        "score": 0.4171419143676758
      },
      {
        "question": "How many couples were divorced in Switzerland in the year 2000?",
        "query": "SELECT T.year, S.name, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = s.spatialunit_uid\nWHERE S.country\nAND T.year = '2000'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nGROUP BY S.name, T.year;\n",
        "score": 0.4881887137889862
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_age_classes (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tage_class_husband VARCHAR(50), \n\tage_class_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_spatial_unit_spatialu FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_age_classes and 5 examples in each column for high cardinality columns :\nuid : 857302, 857244, 857392, 857224, 857364\nspatialunit_uid : 1_A.ADM1, 24_A.ADM1, 23_A.ADM1, 8_A.ADM1, 22_A.ADM1\nyear : 2014, 1980, 1992, 2006, 2002\namount : 21, 48, 4, 12, 30\n*/\n\n/*\nColumn name, Column discription, Example values\nage_class_husband, age class of the husband, Age class of husband - total,Less than 20 years,80-89 years\nage_class_wife, age class of the wife, Age class of wife - total,Less than 20 years,80-89 years\nduration_of_marriage, duration class of marriage, Duration of marriage - total,5-9 years,20 years or more\namount, Count of divorces, 120\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nIn Canton Uri how many marriages where divorced in 2003 after more than 10 years?\n### SQL query\nSELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2003\nAND (T.duration_of_marriage = '10-14 years'\n         OR T.duration_of_marriage = '15-19 years'\n         OR T.duration_of_marriage = '20 years or more')\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton AND S.name ilike '% Uri%'\nGROUP BY S.name, T.duration_of_marriage\nORDER BY T.duration_of_marriage DESC;\n\n### Question\nWhich Canton had the least divorces in 2002?\n### SQL query\nSELECT T.year, T.duration_of_marriage, T.amount AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 1990\nAND T.duration_of_marriage != 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year, T.duration_of_marriage, T.amount\nORDER BY T.year, T.duration_of_marriage;\n\n\n### Question\nWhich year between 1990 and 2000 had the least divorces in Stadt Basel?\n### SQL query\n",
    "process_time": 13.103026869008318,
    "num_tokens": 1313,
    "hardness": "unknown",
    "scores": [
      0.4171419143676758,
      0.4881887137889862
    ],
    "lang": "en"
  },
  {
    "i": 35,
    "question": "How many men divorced at an age between 60 and 69 in canton zurich in 2020?",
    "query": "SELECT S.name, T.year, T.age_class_husband, sum(T.amount) AS total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Zurich%'\nAND T.year = 2020\nAND S.canton = 'True'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = '60-69 years'\nAND T.age_class_wife = 'Age class of wife - total'\nGROUP BY S.name, T.year, T.age_class_husband;\n",
    "db_id": "divorces_duration_of_marriage_age_classes",
    "generated_query": "SELECT S.name, T.year, T.age_class_husband, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Zurich%'\nAND T.year = 2020\nAND S.canton = 'True'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = '60-69 years'\nGROUP BY S.name, T.year, T.age_class_husband;",
    "meta_data": [
      {
        "question": "How many women divorced at age between 20 and 29 in canton zurich in 2020?",
        "query": "SELECT S.name, T.year, T.age_class_wife, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Zurich%'\nAND T.year = 2020\nAND S.canton = 'True'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = '20-29 years'\nGROUP BY S.name, T.year, T.age_class_wife;\n",
        "score": 0.10323494672775269
      },
      {
        "question": "What was the prominent age for men that divorced in Switzerland in 2000?",
        "query": "SELECT T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband != 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_husband\nORDER BY total_divorces DESC\nLIMIT 1;\n",
        "score": 0.36149996519088745
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_age_classes (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tage_class_husband VARCHAR(50), \n\tage_class_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_spatial_unit_spatialu FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_age_classes and 5 examples in each column for high cardinality columns :\nuid : 857302, 857244, 857392, 857224, 857364\nspatialunit_uid : 1_A.ADM1, 24_A.ADM1, 23_A.ADM1, 8_A.ADM1, 22_A.ADM1\nyear : 2014, 1980, 1992, 2006, 2002\namount : 21, 48, 4, 12, 30\n*/\n\n/*\nColumn name, Column discription, Example values\nage_class_husband, age class of the husband, Age class of husband - total,Less than 20 years,80-89 years\nage_class_wife, age class of the wife, Age class of wife - total,Less than 20 years,80-89 years\nduration_of_marriage, duration class of marriage, Duration of marriage - total,5-9 years,20 years or more\namount, Count of divorces, 120\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nIn Canton Uri how many marriages where divorced in 2003 after more than 10 years?\n### SQL query\nSELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2003\nAND (T.duration_of_marriage = '10-14 years'\n         OR T.duration_of_marriage = '15-19 years'\n         OR T.duration_of_marriage = '20 years or more')\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton AND S.name ilike '% Uri%'\nGROUP BY S.name, T.duration_of_marriage\nORDER BY T.duration_of_marriage DESC;\n\n### Question\nHow many women divorced at age between 20 and 29 in canton zurich in 2020?\n### SQL query\nSELECT S.name, T.year, T.age_class_wife, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Zurich%'\nAND T.year = 2020\nAND S.canton = 'True'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = '20-29 years'\nGROUP BY S.name, T.year, T.age_class_wife;\n\n\n### Question\nHow many men divorced at an age between 60 and 69 in canton zurich in 2020?\n### SQL query\n",
    "process_time": 10.13746749679558,
    "num_tokens": 1331,
    "hardness": "unknown",
    "scores": [
      0.10323494672775269,
      0.36149996519088745
    ],
    "lang": "en"
  },
  {
    "i": 36,
    "question": "From 2000 to 2022 which year saw the most divorces in Switzerland?",
    "query": "SELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.year <= 2022\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year\nORDER BY total_divorces DESC\nLIMIT 1;\n",
    "db_id": "divorces_duration_of_marriage_age_classes",
    "generated_query": "SELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000 AND T.year <= 2022\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.country\nGROUP BY T.year\nORDER BY total_divorces DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "How many couples were divorced in Switzerland in the year 2000?",
        "query": "SELECT T.year, S.name, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = s.spatialunit_uid\nWHERE S.country\nAND T.year = '2000'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nGROUP BY S.name, T.year;\n",
        "score": 0.21077965199947357
      },
      {
        "question": "How did the amount of divorces in Switzerland develop since 1990?",
        "query": "SELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 1990\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year\nORDER BY T.year;\n",
        "score": 0.3243944048881531
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_age_classes (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tage_class_husband VARCHAR(50), \n\tage_class_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_spatial_unit_spatialu FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_age_classes and 5 examples in each column for high cardinality columns :\nuid : 857302, 857244, 857392, 857224, 857364\nspatialunit_uid : 1_A.ADM1, 24_A.ADM1, 23_A.ADM1, 8_A.ADM1, 22_A.ADM1\nyear : 2014, 1980, 1992, 2006, 2002\namount : 21, 48, 4, 12, 30\n*/\n\n/*\nColumn name, Column discription, Example values\nage_class_husband, age class of the husband, Age class of husband - total,Less than 20 years,80-89 years\nage_class_wife, age class of the wife, Age class of wife - total,Less than 20 years,80-89 years\nduration_of_marriage, duration class of marriage, Duration of marriage - total,5-9 years,20 years or more\namount, Count of divorces, 120\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nIn Canton Uri how many marriages where divorced in 2003 after more than 10 years?\n### SQL query\nSELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2003\nAND (T.duration_of_marriage = '10-14 years'\n         OR T.duration_of_marriage = '15-19 years'\n         OR T.duration_of_marriage = '20 years or more')\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton AND S.name ilike '% Uri%'\nGROUP BY S.name, T.duration_of_marriage\nORDER BY T.duration_of_marriage DESC;\n\n### Question\nWhich Canton had the least divorces in 2002?\n### SQL query\nSELECT T.year, T.duration_of_marriage, T.amount AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 1990\nAND T.duration_of_marriage != 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year, T.duration_of_marriage, T.amount\nORDER BY T.year, T.duration_of_marriage;\n\n\n### Question\nFrom 2000 to 2022 which year saw the most divorces in Switzerland?\n### SQL query\n",
    "process_time": 12.711836077040061,
    "num_tokens": 1312,
    "hardness": "unknown",
    "scores": [
      0.21077965199947357,
      0.3243944048881531
    ],
    "lang": "en"
  },
  {
    "i": 37,
    "question": "How many marriages in Switzerland got divorced after less then 5 years in 2000?",
    "query": "SELECT sum(amount) AS total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = s.spatialunit_uid\nWHERE S.country\nAND T.year = '2000'\nAND T.duration_of_marriage = '0-4 years'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total';\n",
    "db_id": "divorces_duration_of_marriage_age_classes",
    "generated_query": "SELECT T.year, S.name, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = s.spatialunit_uid\nWHERE S.country\nAND T.year = '2000'\nAND T.duration_of_marriage = 'Less than 5 years'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nGROUP BY S.name, T.year;",
    "meta_data": [
      {
        "question": "How many couples were divorced in Switzerland in the year 2000?",
        "query": "SELECT T.year, S.name, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = s.spatialunit_uid\nWHERE S.country\nAND T.year = '2000'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nGROUP BY S.name, T.year;\n",
        "score": 0.11098308861255646
      },
      {
        "question": "In Canton Uri how many marriages where divorced in 2003 after more than 10 years?",
        "query": "SELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2003\nAND (T.duration_of_marriage = '10-14 years'\n         OR T.duration_of_marriage = '15-19 years'\n         OR T.duration_of_marriage = '20 years or more')\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton AND S.name ilike '% Uri%'\nGROUP BY S.name, T.duration_of_marriage\nORDER BY T.duration_of_marriage DESC;",
        "score": 0.32680216431617737
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_age_classes (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tage_class_husband VARCHAR(50), \n\tage_class_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_spatial_unit_spatialu FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_age_classes and 5 examples in each column for high cardinality columns :\nuid : 857302, 857244, 857392, 857224, 857364\nspatialunit_uid : 1_A.ADM1, 24_A.ADM1, 23_A.ADM1, 8_A.ADM1, 22_A.ADM1\nyear : 2014, 1980, 1992, 2006, 2002\namount : 21, 48, 4, 12, 30\n*/\n\n/*\nColumn name, Column discription, Example values\nage_class_husband, age class of the husband, Age class of husband - total,Less than 20 years,80-89 years\nage_class_wife, age class of the wife, Age class of wife - total,Less than 20 years,80-89 years\nduration_of_marriage, duration class of marriage, Duration of marriage - total,5-9 years,20 years or more\namount, Count of divorces, 120\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nIn Canton Uri how many marriages where divorced in 2003 after more than 10 years?\n### SQL query\nSELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2003\nAND (T.duration_of_marriage = '10-14 years'\n         OR T.duration_of_marriage = '15-19 years'\n         OR T.duration_of_marriage = '20 years or more')\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton AND S.name ilike '% Uri%'\nGROUP BY S.name, T.duration_of_marriage\nORDER BY T.duration_of_marriage DESC;\n\n### Question\nHow many couples were divorced in Switzerland in the year 2000?\n### SQL query\nSELECT T.year, S.name, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = s.spatialunit_uid\nWHERE S.country\nAND T.year = '2000'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nGROUP BY S.name, T.year;\n\n\n### Question\nHow many marriages in Switzerland got divorced after less then 5 years in 2000?\n### SQL query\n",
    "process_time": 12.402939441148192,
    "num_tokens": 1294,
    "hardness": "unknown",
    "scores": [
      0.11098308861255646,
      0.32680216431617737
    ],
    "lang": "en"
  },
  {
    "i": 38,
    "question": "What is the total number of divorces for Swiss couples where the duration of the marriage was 20 years or more in 1994?",
    "query": "SELECT SUM(amount)\nFROM divorces_duration_of_marriage_citizenship_categories WHERE year = 1994\n  AND duration_of_marriage = '20 years or more'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland';\n",
    "db_id": "divorces_duration_of_marriage_citizenship_categories",
    "generated_query": "SELECT SUM(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories\nWHERE year = 1994\n  AND duration_of_marriage = '20 years or more'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland';",
    "meta_data": [
      {
        "question": "How many divorces occurred in Switzerland in 1995 between Swiss couples who were married for less than 5 years?",
        "query": "SELECT SUM(amount)\nFROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2001\n  AND su.spatialunit_uid = '0_CH'\n  AND duration_of_marriage = '0-4 years'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland';\n",
        "score": 0.14424993097782135
      },
      {
        "question": "What is the average number of divorces per year between 1990 and 2000 in Switzerland among Swiss couples?",
        "query": "SELECT AVG(total) as average_divorces_per_year\nFROM (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '0_CH'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n) as subquery;\n",
        "score": 0.17077818512916565
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_citizenship_categories (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_spatial_un FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_citizenship_categories and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nspatialunit_uid : 5587_A.ADM3, 3442_A.ADM3, 59_A.ADM3, 2703_A.ADM3, 4084_A.ADM3\nyear : 2014, 1980, 2006, 1992, 2002\namount : 1, 14, 6, 5, None\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\nduration_of_marriage, duration class of marriage, Duration of marriage - total,10-14 years,20 years or more\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWhat is the average number of divorces per year between 1990 and 2000 in Switzerland among Swiss couples?\n### SQL query\nSELECT AVG(total) as average_divorces_per_year\nFROM (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '0_CH'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n) as subquery;\n\n\n### Question\nHow did the total number of divorces between Swiss couples compare between the cantons of Zurich and Geneva in the year 1995?\n### SQL query\nSELECT su.spatialunit_uid, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND (su.spatialunit_uid = '1_A.ADM1' OR su.spatialunit_uid = '25_A.ADM1')\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid;\n\n\n### Question\nWhat is the total number of divorces for Swiss couples where the duration of the marriage was 20 years or more in 1994?\n### SQL query\n",
    "process_time": 8.08625777089037,
    "num_tokens": 1322,
    "hardness": "medium",
    "scores": [
      0.14424993097782135,
      0.17077818512916565
    ],
    "lang": "en"
  },
  {
    "i": 39,
    "question": "What are the top 5 cantons with the highest number of divorces in 1994 for Swiss couples?",
    "query": "SELECT su.name, SUM(div.amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su on div.spatialunit_uid = su.spatialunit_uid\nWHERE div.year = 1994\n  AND div.duration_of_marriage = 'Duration of marriage - total'\n  AND div.citizenship_category_husband = 'Switzerland'\n  AND div.citizenship_category_wife = 'Switzerland'\n  AND su.name LIKE '%Canton%'\nGROUP BY su.name\nORDER BY total DESC\nLIMIT 5;\n",
    "db_id": "divorces_duration_of_marriage_citizenship_categories",
    "generated_query": "SELECT su.name, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1994\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\n  AND su.spatialunit_uid LIKE '%_A.ADM1'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 5;",
    "meta_data": [
      {
        "question": "How did the total number of divorces between Swiss couples compare between the cantons of Zurich and Geneva in the year 1995?",
        "query": "SELECT su.spatialunit_uid, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND (su.spatialunit_uid = '1_A.ADM1' OR su.spatialunit_uid = '25_A.ADM1')\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid;\n",
        "score": 0.31073832511901855
      },
      {
        "question": "How many divorces occurred in Switzerland in 1995 between Swiss couples who were married for less than 5 years?",
        "query": "SELECT SUM(amount)\nFROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2001\n  AND su.spatialunit_uid = '0_CH'\n  AND duration_of_marriage = '0-4 years'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland';\n",
        "score": 0.32401883602142334
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_citizenship_categories (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_spatial_un FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_citizenship_categories and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nspatialunit_uid : 5587_A.ADM3, 3442_A.ADM3, 59_A.ADM3, 2703_A.ADM3, 4084_A.ADM3\nyear : 2014, 1980, 2006, 1992, 2002\namount : 1, 14, 6, 5, None\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\nduration_of_marriage, duration class of marriage, Duration of marriage - total,10-14 years,20 years or more\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nIn 2010, which municipality had the highest number of divorces between couples who were married for 5-9 years and at least one partner was not Swiss?\n### SQL query\nSELECT su.name, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2010\n  AND duration_of_marriage = '5-9 years'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nIn which year between 1996 and 2017 did the canton of Graub\u00fcnden experience the biggest difference in the percentage of total divorces between Swiss couples and couples where at least one partner was not Swiss?\n### SQL query\nWITH swiss AS (\n  SELECT year,\n         SUM(amount) AS swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n),\nnot_swiss AS (\n  SELECT year,\n         SUM(amount) AS not_swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n)\nSELECT swiss.year,\n       COALESCE(swiss.swiss_divorces, 0) AS swiss_divorces,\n       COALESCE(not_swiss.not_swiss_divorces, 0) AS not_swiss_divorces,\n       ABS(100.0 * COALESCE(swiss.swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0))\n          - 100.0 * COALESCE(not_swiss.not_swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0)))\n           AS percentage_difference\nFROM swiss JOIN not_swiss ON swiss.year = not_swiss.year\nORDER BY percentage_difference DESC\nLIMIT 1;\n\n\n### Question\nWhat are the top 5 cantons with the highest number of divorces in 1994 for Swiss couples?\n### SQL query\n",
    "process_time": 13.689527333946899,
    "num_tokens": 1601,
    "hardness": "unknown",
    "scores": [
      0.31073832511901855,
      0.32401883602142334
    ],
    "lang": "en"
  },
  {
    "i": 40,
    "question": "In which year between 1990 and 2000 did the Canton of Zurich have the highest number of divorces between Swiss couples?",
    "query": "SELECT year, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year BETWEEN 2000 AND 2010\n  AND su.spatialunit_uid = '1_A.ADM1'\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY year\nORDER BY total DESC\nLIMIT 1;\n",
    "db_id": "divorces_duration_of_marriage_citizenship_categories",
    "generated_query": "WITH zurich AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '1_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n)\nSELECT year\nFROM zurich\nWHERE total = (SELECT MAX(total) FROM zurich);",
    "meta_data": [
      {
        "question": "In which year between 1990 and 2000 did the canton of zurich have more divorces between Swiss couples than the canton of geneva?",
        "query": "WITH zurich AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '1_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n),\ngeneva AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '25_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n)\nSELECT z.year\nFROM zurich AS z\nJOIN geneva AS g ON z.year = g.year\nWHERE z.total > g.total;\n",
        "score": 0.06845148652791977
      },
      {
        "question": "In 1995, which municipality had the highest number of divorces between Swiss couples who were married for 10-14 years?",
        "query": "SELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE duration_of_marriage = '10-14 years'\n  AND year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n",
        "score": 0.23858025670051575
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_citizenship_categories (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_spatial_un FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_citizenship_categories and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nspatialunit_uid : 5587_A.ADM3, 3442_A.ADM3, 59_A.ADM3, 2703_A.ADM3, 4084_A.ADM3\nyear : 2014, 1980, 2006, 1992, 2002\namount : 1, 14, 6, 5, None\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\nduration_of_marriage, duration class of marriage, Duration of marriage - total,10-14 years,20 years or more\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nIn which year between 1996 and 2017 did the canton of Graub\u00fcnden experience the biggest difference in the percentage of total divorces between Swiss couples and couples where at least one partner was not Swiss?\n### SQL query\nWITH swiss AS (\n  SELECT year,\n         SUM(amount) AS swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n),\nnot_swiss AS (\n  SELECT year,\n         SUM(amount) AS not_swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n)\nSELECT swiss.year,\n       COALESCE(swiss.swiss_divorces, 0) AS swiss_divorces,\n       COALESCE(not_swiss.not_swiss_divorces, 0) AS not_swiss_divorces,\n       ABS(100.0 * COALESCE(swiss.swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0))\n          - 100.0 * COALESCE(not_swiss.not_swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0)))\n           AS percentage_difference\nFROM swiss JOIN not_swiss ON swiss.year = not_swiss.year\nORDER BY percentage_difference DESC\nLIMIT 1;\n\n\n### Question\nIn which year between 1990 and 2000 did the canton of zurich have more divorces between Swiss couples than the canton of geneva?\n### SQL query\nWITH zurich AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '1_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n),\ngeneva AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '25_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n)\nSELECT z.year\nFROM zurich AS z\nJOIN geneva AS g ON z.year = g.year\nWHERE z.total > g.total;\n\n\n### Question\nIn which year between 1990 and 2000 did the Canton of Zurich have the highest number of divorces between Swiss couples?\n### SQL query\n",
    "process_time": 15.13703523692675,
    "num_tokens": 1745,
    "hardness": "unknown",
    "scores": [
      0.06845148652791977,
      0.23858025670051575
    ],
    "lang": "en"
  },
  {
    "i": 41,
    "question": "In 1995, which municipality had the lowest number of divorces between Swiss couples who were married for 10-14 years?",
    "query": "SELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE duration_of_marriage = '10-14 years'\n  AND year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces ASC\nLIMIT 1;\n",
    "db_id": "divorces_duration_of_marriage_citizenship_categories",
    "generated_query": "SELECT su.name, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND duration_of_marriage = '10-14 years'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\nGROUP BY su.name\nORDER BY total_divorces ASC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "In 1995, which municipality had the highest number of divorces between Swiss couples who were married for 10-14 years?",
        "query": "SELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE duration_of_marriage = '10-14 years'\n  AND year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n",
        "score": 0.05728127807378769
      },
      {
        "question": "In 2010, which municipality had the highest number of divorces between couples who were married for 5-9 years and at least one partner was not Swiss?",
        "query": "SELECT su.name, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2010\n  AND duration_of_marriage = '5-9 years'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n",
        "score": 0.16538523137569427
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_citizenship_categories (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_spatial_un FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_citizenship_categories and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nspatialunit_uid : 5587_A.ADM3, 3442_A.ADM3, 59_A.ADM3, 2703_A.ADM3, 4084_A.ADM3\nyear : 2014, 1980, 2006, 1992, 2002\namount : 1, 14, 6, 5, None\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\nduration_of_marriage, duration class of marriage, Duration of marriage - total,10-14 years,20 years or more\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nIn 2010, which municipality had the highest number of divorces between couples who were married for 5-9 years and at least one partner was not Swiss?\n### SQL query\nSELECT su.name, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2010\n  AND duration_of_marriage = '5-9 years'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nIn which year between 1996 and 2017 did the canton of Graub\u00fcnden experience the biggest difference in the percentage of total divorces between Swiss couples and couples where at least one partner was not Swiss?\n### SQL query\nWITH swiss AS (\n  SELECT year,\n         SUM(amount) AS swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n),\nnot_swiss AS (\n  SELECT year,\n         SUM(amount) AS not_swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n)\nSELECT swiss.year,\n       COALESCE(swiss.swiss_divorces, 0) AS swiss_divorces,\n       COALESCE(not_swiss.not_swiss_divorces, 0) AS not_swiss_divorces,\n       ABS(100.0 * COALESCE(swiss.swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0))\n          - 100.0 * COALESCE(not_swiss.not_swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0)))\n           AS percentage_difference\nFROM swiss JOIN not_swiss ON swiss.year = not_swiss.year\nORDER BY percentage_difference DESC\nLIMIT 1;\n\n\n### Question\nIn 1995, which municipality had the lowest number of divorces between Swiss couples who were married for 10-14 years?\n### SQL query\n",
    "process_time": 13.761313747847453,
    "num_tokens": 1605,
    "hardness": "unknown",
    "scores": [
      0.05728127807378769,
      0.16538523137569427
    ],
    "lang": "en"
  },
  {
    "i": 42,
    "question": "How has the number of divorces for Swiss couples changed from 1990 to 2000?",
    "query": "SELECT year, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories WHERE year BETWEEN 1990 AND 2000\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY year\nORDER BY year;\n",
    "db_id": "divorces_duration_of_marriage_citizenship_categories",
    "generated_query": "SELECT year, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories\nWHERE year BETWEEN 1990 AND 2000\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY year;",
    "meta_data": [
      {
        "question": "What is the average number of divorces per year between 1990 and 2000 in Switzerland among Swiss couples?",
        "query": "SELECT AVG(total) as average_divorces_per_year\nFROM (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '0_CH'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n) as subquery;\n",
        "score": 0.18098831176757812
      },
      {
        "question": "How did the total number of divorces between Swiss couples compare between the cantons of Zurich and Geneva in the year 1995?",
        "query": "SELECT su.spatialunit_uid, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND (su.spatialunit_uid = '1_A.ADM1' OR su.spatialunit_uid = '25_A.ADM1')\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid;\n",
        "score": 0.2530100643634796
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_citizenship_categories (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_spatial_un FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_citizenship_categories and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nspatialunit_uid : 5587_A.ADM3, 3442_A.ADM3, 59_A.ADM3, 2703_A.ADM3, 4084_A.ADM3\nyear : 2014, 1980, 2006, 1992, 2002\namount : 1, 14, 6, 5, None\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\nduration_of_marriage, duration class of marriage, Duration of marriage - total,10-14 years,20 years or more\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWhat is the average number of divorces per year between 1990 and 2000 in Switzerland among Swiss couples?\n### SQL query\nSELECT AVG(total) as average_divorces_per_year\nFROM (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '0_CH'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n) as subquery;\n\n\n### Question\nHow did the total number of divorces between Swiss couples compare between the cantons of Zurich and Geneva in the year 1995?\n### SQL query\nSELECT su.spatialunit_uid, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND (su.spatialunit_uid = '1_A.ADM1' OR su.spatialunit_uid = '25_A.ADM1')\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid;\n\n\n### Question\nHow has the number of divorces for Swiss couples changed from 1990 to 2000?\n### SQL query\n",
    "process_time": 5.695074341027066,
    "num_tokens": 1314,
    "hardness": "unknown",
    "scores": [
      0.18098831176757812,
      0.2530100643634796
    ],
    "lang": "en"
  },
  {
    "i": 43,
    "question": "Which municipality had the highest number of divorces in 1995 between Swiss couples?",
    "query": "SELECT su.name, d.year, SUM(d.amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE d.year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND d.duration_of_marriage = 'Duration of marriage - total'\n  AND d.citizenship_category_husband = 'Switzerland'\n  AND d.citizenship_category_wife = 'Switzerland'\nGROUP BY su.name, d.year\nORDER BY total_divorces DESC\nLIMIT 1;\n",
    "db_id": "divorces_duration_of_marriage_citizenship_categories",
    "generated_query": "SELECT su.name, SUM(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "In 1995, which municipality had the highest number of divorces between Swiss couples who were married for 10-14 years?",
        "query": "SELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE duration_of_marriage = '10-14 years'\n  AND year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n",
        "score": 0.09265708178281784
      },
      {
        "question": "In 2010, which municipality had the highest number of divorces between couples who were married for 5-9 years and at least one partner was not Swiss?",
        "query": "SELECT su.name, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2010\n  AND duration_of_marriage = '5-9 years'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n",
        "score": 0.18507322669029236
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_citizenship_categories (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_spatial_un FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_citizenship_categories and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nspatialunit_uid : 5587_A.ADM3, 3442_A.ADM3, 59_A.ADM3, 2703_A.ADM3, 4084_A.ADM3\nyear : 2014, 1980, 2006, 1992, 2002\namount : 1, 14, 6, 5, None\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\nduration_of_marriage, duration class of marriage, Duration of marriage - total,10-14 years,20 years or more\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nIn 2010, which municipality had the highest number of divorces between couples who were married for 5-9 years and at least one partner was not Swiss?\n### SQL query\nSELECT su.name, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2010\n  AND duration_of_marriage = '5-9 years'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nHow did the total number of divorces between Swiss couples compare between the cantons of Zurich and Geneva in the year 1995?\n### SQL query\nSELECT su.spatialunit_uid, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND (su.spatialunit_uid = '1_A.ADM1' OR su.spatialunit_uid = '25_A.ADM1')\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid;\n\n\n### Question\nWhich municipality had the highest number of divorces in 1995 between Swiss couples?\n### SQL query\n",
    "process_time": 9.036743676988408,
    "num_tokens": 1309,
    "hardness": "unknown",
    "scores": [
      0.09265708178281784,
      0.18507322669029236
    ],
    "lang": "en"
  },
  {
    "i": 44,
    "question": "Give me the average number of marriages at the canton level in 2001, where both the husband and wife are citizens of Swiss?",
    "query": "SELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T1.year = 2001  AND T1.citizenship_category_husband = 'Switzerland' AND  T1.citizenship_category_wife = 'Switzerland';\n",
    "db_id": "marriage_citizenship",
    "generated_query": "SELECT AVG(amount) FROM marriage_citizenship\nWHERE year = 2001\nAND citizenship_category_husband = 'Switzerland'\nAND citizenship_category_wife = 'Switzerland'\nAND spatialunit_uid IN (SELECT spatialunit_uid FROM spatial_unit WHERE canton = true);",
    "meta_data": [
      {
        "question": "Show me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?",
        "query": "SELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n",
        "score": 0.2706904411315918
      },
      {
        "question": "In 2000, among the municipalities, which had the highest and lowest numbers of marriages where the husbands were Swiss citizens?",
        "query": "(SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT Max(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1)\nUNION ALL\n(\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT MIN(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1);\n",
        "score": 0.3367142677307129
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.marriage_citizenship (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT marriage_citizenship_pk PRIMARY KEY (uid), \n\tCONSTRAINT marriage_citizenship_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in marriage_citizenship and 5 examples in each column for high cardinality columns :\nuid : 334012, 333992, 333984, 334085, 333966\nspatialunit_uid : 6154_A.ADM3, 763_A.ADM3, 114_A.ADM3, 6110_A.ADM3, 1065_A.ADM3\nyear : 2014, 1980, 2006, 1992, 2002\namount : 24, 5, 4, 12, 30\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nShow me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?\n### SQL query\nSELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n\n\n### Question\nIn the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?\n### SQL query\nSELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n\n\n### Question\nGive me the average number of marriages at the canton level in 2001, where both the husband and wife are citizens of Swiss?\n### SQL query\n",
    "process_time": 4.529620328918099,
    "num_tokens": 1362,
    "hardness": "medium",
    "scores": [
      0.2706904411315918,
      0.3367142677307129
    ],
    "lang": "en"
  },
  {
    "i": 45,
    "question": "Give me the minimum , maximum and average number of marriages at the municipal level in 2011, where both the husband and wife are citizens of foreign countries?",
    "query": "SELECT  MIN(T1.amount),Max(T1.amount),AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2011  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Foreign country';\n",
    "db_id": "marriage_citizenship",
    "generated_query": "SELECT MIN(amount) AS minimum, MAX(amount) AS maximum, AVG(amount) AS average\nFROM marriage_citizenship AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Foreign country' AND T1.citizenship_category_wife = 'Foreign country';",
    "meta_data": [
      {
        "question": "In the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?",
        "query": "SELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n",
        "score": 0.2561713457107544
      },
      {
        "question": "What is the highest number of marriages that occurred at the district level in 2012, where both the wife and husband were citizens of foreign countries?",
        "query": "SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount,T1.citizenship_category_husband,T1.citizenship_category_wife  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.district = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country'  AND T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n",
        "score": 0.3994187116622925
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.marriage_citizenship (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT marriage_citizenship_pk PRIMARY KEY (uid), \n\tCONSTRAINT marriage_citizenship_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in marriage_citizenship and 5 examples in each column for high cardinality columns :\nuid : 334012, 333992, 333984, 334085, 333966\nspatialunit_uid : 6154_A.ADM3, 763_A.ADM3, 114_A.ADM3, 6110_A.ADM3, 1065_A.ADM3\nyear : 2014, 1980, 2006, 1992, 2002\namount : 24, 5, 4, 12, 30\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nIn the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?\n### SQL query\nSELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n\n\n### Question\nShow me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?\n### SQL query\nSELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n\n\n### Question\nGive me the minimum , maximum and average number of marriages at the municipal level in 2011, where both the husband and wife are citizens of foreign countries?\n### SQL query\n",
    "process_time": 7.825739728985354,
    "num_tokens": 1366,
    "hardness": "hard",
    "scores": [
      0.2561713457107544,
      0.3994187116622925
    ],
    "lang": "en"
  },
  {
    "i": 46,
    "question": "In 2006, what were the top 10 cantons with the highest number of marriages where the grooms were Swiss nationals?",
    "query": "SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount   FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Switzerland' AND  T1.citizenship_category_wife = 'Citizenship of wife - total'\nORDER BY T1.amount DESC\nLIMIT 10;\n",
    "db_id": "marriage_citizenship",
    "generated_query": "SELECT T2.name, T1.amount\nFROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True'\nAND T1.year = 2006\nAND T1.citizenship_category_husband = 'Switzerland'\nORDER BY T1.amount DESC\nLIMIT 10;",
    "meta_data": [
      {
        "question": "Which five cantons have the highest number of marriages between Swiss men and foreign women on 2011?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n",
        "score": 0.1874462366104126
      },
      {
        "question": "In 2000, among the municipalities, which had the highest and lowest numbers of marriages where the husbands were Swiss citizens?",
        "query": "(SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT Max(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1)\nUNION ALL\n(\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT MIN(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1);\n",
        "score": 0.30428099632263184
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.marriage_citizenship (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT marriage_citizenship_pk PRIMARY KEY (uid), \n\tCONSTRAINT marriage_citizenship_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in marriage_citizenship and 5 examples in each column for high cardinality columns :\nuid : 334012, 333992, 333984, 334085, 333966\nspatialunit_uid : 6154_A.ADM3, 763_A.ADM3, 114_A.ADM3, 6110_A.ADM3, 1065_A.ADM3\nyear : 2014, 1980, 2006, 1992, 2002\namount : 24, 5, 4, 12, 30\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nShow me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?\n### SQL query\nSELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n\n\n### Question\nIn 2000, among the municipalities, which had the highest and lowest numbers of marriages where the husbands were Swiss citizens?\n### SQL query\n(SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT Max(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1)\nUNION ALL\n(\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT MIN(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1);\n\n\n### Question\nIn 2006, what were the top 10 cantons with the highest number of marriages where the grooms were Swiss nationals?\n### SQL query\n",
    "process_time": 10.536323432810605,
    "num_tokens": 1679,
    "hardness": "extra",
    "scores": [
      0.1874462366104126,
      0.30428099632263184
    ],
    "lang": "en"
  },
  {
    "i": 47,
    "question": "Which canton has the highest number of marriages between Swiss women and Swiss men on 2018?",
    "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' and T1.year = 2018 and T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Switzerland'\nORDER BY  T1.amount DESC\nLIMIT 1;\n",
    "db_id": "marriage_citizenship",
    "generated_query": "SELECT T2.name, T1.amount\nFROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True'\nAND T1.year = 2018\nAND T1.citizenship_category_husband = 'Switzerland'\nAND T1.citizenship_category_wife = 'Switzerland'\nORDER BY T1.amount DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Which five cantons have the highest number of marriages between Swiss men and foreign women on 2011?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n",
        "score": 0.16602201759815216
      },
      {
        "question": "In 2000, among the municipalities, which had the highest and lowest numbers of marriages where the husbands were Swiss citizens?",
        "query": "(SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT Max(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1)\nUNION ALL\n(\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT MIN(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1);\n",
        "score": 0.3923247754573822
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.marriage_citizenship (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT marriage_citizenship_pk PRIMARY KEY (uid), \n\tCONSTRAINT marriage_citizenship_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in marriage_citizenship and 5 examples in each column for high cardinality columns :\nuid : 334012, 333992, 333984, 334085, 333966\nspatialunit_uid : 6154_A.ADM3, 763_A.ADM3, 114_A.ADM3, 6110_A.ADM3, 1065_A.ADM3\nyear : 2014, 1980, 2006, 1992, 2002\namount : 24, 5, 4, 12, 30\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nShow me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?\n### SQL query\nSELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n\n\n### Question\nIn 2000, among the municipalities, which had the highest and lowest numbers of marriages where the husbands were Swiss citizens?\n### SQL query\n(SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT Max(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1)\nUNION ALL\n(\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT MIN(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1);\n\n\n### Question\nWhich canton has the highest number of marriages between Swiss women and Swiss men on 2018?\n### SQL query\n",
    "process_time": 6.4966811400372535,
    "num_tokens": 1672,
    "hardness": "extra",
    "scores": [
      0.16602201759815216,
      0.3923247754573822
    ],
    "lang": "en"
  },
  {
    "i": 48,
    "question": "What are the top five municipalities with the highest number of marriages between Swiss men and foreign women in the year 2018?",
    "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.municipal = 'True' AND T1.year = 2018 AND T1.citizenship_category_husband = 'Foreign country' and T1.citizenship_category_wife = 'Switzerland'\nORDER BY T1.amount DESC\nLIMIT 5;\n",
    "db_id": "marriage_citizenship",
    "generated_query": "SELECT T2.name, T1.amount\nFROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2018 AND T1.citizenship_category_husband = 'Switzerland' AND T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;",
    "meta_data": [
      {
        "question": "Which five cantons have the highest number of marriages between Swiss men and foreign women on 2011?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n",
        "score": 0.18693934381008148
      },
      {
        "question": "Show me the top-10 municipalities with the lowest numbers of marriages that the wives were Swiss citizens on 2016?",
        "query": "SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount   FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_wife = 'Switzerland' AND  T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.amount ASC\nLIMIT 10;\n",
        "score": 0.2660662829875946
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.marriage_citizenship (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT marriage_citizenship_pk PRIMARY KEY (uid), \n\tCONSTRAINT marriage_citizenship_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in marriage_citizenship and 5 examples in each column for high cardinality columns :\nuid : 334012, 333992, 333984, 334085, 333966\nspatialunit_uid : 6154_A.ADM3, 763_A.ADM3, 114_A.ADM3, 6110_A.ADM3, 1065_A.ADM3\nyear : 2014, 1980, 2006, 1992, 2002\namount : 24, 5, 4, 12, 30\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nShow me the top-10 municipalities with the lowest numbers of marriages that the wives were Swiss citizens on 2016?\n### SQL query\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount   FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_wife = 'Switzerland' AND  T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.amount ASC\nLIMIT 10;\n\n\n### Question\nShow me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?\n### SQL query\nSELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n\n\n### Question\nWhat are the top five municipalities with the highest number of marriages between Swiss men and foreign women in the year 2018?\n### SQL query\n",
    "process_time": 10.6945138159208,
    "num_tokens": 1378,
    "hardness": "extra",
    "scores": [
      0.18693934381008148,
      0.2660662829875946
    ],
    "lang": "en"
  },
  {
    "i": 49,
    "question": "In 2012, how many marriages took place in the District of Affoltern, categorized by the citizenships of the wives and husbands involved?",
    "query": "SELECT T2.name,T1.citizenship_category_husband ,T1.citizenship_category_wife , T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.district = 'True' AND T1.year = 2010  AND T2.name ilike '%Affoltern%' AND T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total';\n",
    "db_id": "marriage_citizenship",
    "generated_query": "SELECT T1.citizenship_category_husband, T1.citizenship_category_wife, SUM(T1.amount) as total_marriages\nFROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.district = 'True' AND T2.name = 'District of Affoltern' AND T1.year = 2012\nGROUP BY T1.citizenship_category_husband, T1.citizenship_category_wife;",
    "meta_data": [
      {
        "question": "What is the highest number of marriages that occurred at the district level in 2012, where both the wife and husband were citizens of foreign countries?",
        "query": "SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount,T1.citizenship_category_husband,T1.citizenship_category_wife  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.district = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country'  AND T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n",
        "score": 0.4859703779220581
      },
      {
        "question": "In the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?",
        "query": "SELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n",
        "score": 0.48881927132606506
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.marriage_citizenship (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT marriage_citizenship_pk PRIMARY KEY (uid), \n\tCONSTRAINT marriage_citizenship_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in marriage_citizenship and 5 examples in each column for high cardinality columns :\nuid : 334012, 333992, 333984, 334085, 333966\nspatialunit_uid : 6154_A.ADM3, 763_A.ADM3, 114_A.ADM3, 6110_A.ADM3, 1065_A.ADM3\nyear : 2014, 1980, 2006, 1992, 2002\namount : 24, 5, 4, 12, 30\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nShow me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?\n### SQL query\nSELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n\n\n### Question\nIn the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?\n### SQL query\nSELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n\n\n### Question\nIn 2012, how many marriages took place in the District of Affoltern, categorized by the citizenships of the wives and husbands involved?\n### SQL query\n",
    "process_time": 7.930250552948564,
    "num_tokens": 1364,
    "hardness": "unknown",
    "scores": [
      0.4859703779220581,
      0.48881927132606506
    ],
    "lang": "en"
  },
  {
    "i": 50,
    "question": "How many marriages occurred in Reiden in 1999 with a wife who held Swiss citizenship?",
    "query": "SELECT  T1.citizenship_category_wife, T2.name,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike  '%Reiden%' and T1.year = 1999 and T1.citizenship_category_wife = 'Switzerland' and T1.citizenship_category_husband = 'Citizenship of husband - total';\n",
    "db_id": "marriage_citizenship",
    "generated_query": "SELECT SUM(amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name = 'Reiden' AND T1.year = 1999 AND T1.citizenship_category_wife = 'Switzerland';",
    "meta_data": [
      {
        "question": "How many marriages occurred in switzerland in the year 2010?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' and T1.year = 2010 and T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total';\n",
        "score": 0.3232071101665497
      },
      {
        "question": "In 2000, among the municipalities, which had the highest and lowest numbers of marriages where the husbands were Swiss citizens?",
        "query": "(SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT Max(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1)\nUNION ALL\n(\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT MIN(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1);\n",
        "score": 0.36188700795173645
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.marriage_citizenship (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT marriage_citizenship_pk PRIMARY KEY (uid), \n\tCONSTRAINT marriage_citizenship_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in marriage_citizenship and 5 examples in each column for high cardinality columns :\nuid : 334012, 333992, 333984, 334085, 333966\nspatialunit_uid : 6154_A.ADM3, 763_A.ADM3, 114_A.ADM3, 6110_A.ADM3, 1065_A.ADM3\nyear : 2014, 1980, 2006, 1992, 2002\namount : 24, 5, 4, 12, 30\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nShow me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?\n### SQL query\nSELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n\n\n### Question\nIn the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?\n### SQL query\nSELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n\n\n### Question\nHow many marriages occurred in Reiden in 1999 with a wife who held Swiss citizenship?\n### SQL query\n",
    "process_time": 7.1338903561700135,
    "num_tokens": 1353,
    "hardness": "unknown",
    "scores": [
      0.3232071101665497,
      0.36188700795173645
    ],
    "lang": "en"
  },
  {
    "i": 51,
    "question": "In which year did the Canton of Bern have the highest number of marriages between Swiss citizens and foreigners?",
    "query": "SELECT UN.year, UN.citizenship_category_husband, UN.citizenship_category_wife, UN.amount FROM\n(SELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T2.name  ilike '%Bern%'  AND T1.citizenship_category_wife = 'Switzerland' AND T1.citizenship_category_husband = 'Foreign country'\nUNION ALL\nSELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T2.name  ilike '%Bern%'  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Switzerland') AS UN\nORDER BY UN.amount DESC\nLIMIT 1;\n",
    "db_id": "marriage_citizenship",
    "generated_query": "SELECT T1.year, T1.amount\nFROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name = 'Bern'\n  AND T1.citizenship_category_husband = 'Switzerland'\n  AND T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Which five cantons have the highest number of marriages between Swiss men and foreign women on 2011?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n",
        "score": 0.3326781094074249
      },
      {
        "question": "which year has the most number of marriage between swiss femal and man from other nationalty in canton Argua?",
        "query": "SELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T2.name ilike '%Aargau%'  AND T1.citizenship_category_wife = 'Switzerland' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;",
        "score": 0.34615039825439453
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.marriage_citizenship (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT marriage_citizenship_pk PRIMARY KEY (uid), \n\tCONSTRAINT marriage_citizenship_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in marriage_citizenship and 5 examples in each column for high cardinality columns :\nuid : 334012, 333992, 333984, 334085, 333966\nspatialunit_uid : 6154_A.ADM3, 763_A.ADM3, 114_A.ADM3, 6110_A.ADM3, 1065_A.ADM3\nyear : 2014, 1980, 2006, 1992, 2002\namount : 24, 5, 4, 12, 30\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nShow me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?\n### SQL query\nSELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n\n\n### Question\nIn 2000, among the municipalities, which had the highest and lowest numbers of marriages where the husbands were Swiss citizens?\n### SQL query\n(SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT Max(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1)\nUNION ALL\n(\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT MIN(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1);\n\n\n### Question\nIn which year did the Canton of Bern have the highest number of marriages between Swiss citizens and foreigners?\n### SQL query\n",
    "process_time": 9.994233970995992,
    "num_tokens": 1672,
    "hardness": "unknown",
    "scores": [
      0.3326781094074249,
      0.34615039825439453
    ],
    "lang": "en"
  },
  {
    "i": 52,
    "question": "What was the total population count in each canton , considering both non-permanent and permanent residents on the year of 2018?",
    "query": "SELECT T1.year, T2.name, T1.population_type, T1.place_of_birth, T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True'  AND T1.year = 2018 AND T1.place_of_birth = 'Place of birth - total' AND T1.citizenship = 'Citizenship - total'\nORDER BY  T1.amount DESC;\n",
    "db_id": "resident_population_birthplace_citizenship_type",
    "generated_query": "SELECT T2.name, SUM(T1.amount) as total_population FROM resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T1.year = 2018 AND T1.population_type IN ('Non permanent resident population', 'Permanent resident population')\nGROUP BY T2.name;",
    "meta_data": [
      {
        "question": "In 2020, what was the number of individuals categorized as non-permanent residents in the Canton of Zug?",
        "query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Zug%' AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Place of birth - total' AND T1.citizenship = 'Citizenship - total';\n",
        "score": 0.45820164680480957
      },
      {
        "question": "Can you provide the breakdown of the population by different citizenships, different place of the birth and different residentship in the Canton of Obwaldent in 2011?",
        "query": "SELECT T1.citizenship, T1.population_type, T1.place_of_birth,  T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Obwalden%' AND T1.year = 2011  AND T1.place_of_birth != 'Place of birth - total' AND T1.citizenship != 'Citizenship - total'\nORDER BY citizenship;",
        "score": 0.5248333215713501
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.resident_population_birthplace_citizenship_type (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tpopulation_type VARCHAR(50), \n\tplace_of_birth VARCHAR(50), \n\tcitizenship VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT resident_population_birthplace_citizenship_type_pk PRIMARY KEY (uid), \n\tCONSTRAINT resident_population_birthplace_citizenship_type_spatial_unit_sp FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in resident_population_birthplace_citizenship_type and 5 examples in each column for high cardinality columns :\nuid : 31873189, 31873171, 31873187, 31873207, 31873089\nspatialunit_uid : 4446_A.ADM3, 1510_A.ADM3, 401_A.ADM3, 4013_A.ADM3, 6240_A.ADM3\nyear : 2014, 2013, 2017, 2021, 2010\ncitizenship : Liechtenstein, Ukraine, No indication, Cambodia, Senegal\namount : 1, 44, 463, 17, 22\n*/\n\n/*\nColumn name, Column discription, Example values\npopulation_type, population type, Non permanent resident population,Permanent resident population\nplace_of_birth, Place of birth: Switzerland or abroad, Abroad,Switzerland,Place of birth - total\ncitizenship, citizenship, Sweden,S\u00e3o Tom\u00e9 and Pr\u00edncipe,Uganda\namount, number of persons, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nCan you provide the breakdown of the population by different citizenships, different place of the birth and different residentship in the Canton of Obwaldent in 2011?\n### SQL query\nSELECT T1.citizenship, T1.population_type, T1.place_of_birth,  T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Obwalden%' AND T1.year = 2011  AND T1.place_of_birth != 'Place of birth - total' AND T1.citizenship != 'Citizenship - total'\nORDER BY citizenship;\n\n### Question\nHow many of the people were born abroad in municipality level  had the permanent residenship on 2010?\n### SQL query\nSELECT T1.year, T2.spatialunit_ontology, T2.name, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2010 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nWhat was the total population count in each canton , considering both non-permanent and permanent residents on the year of 2018?\n### SQL query\n",
    "process_time": 6.281956935999915,
    "num_tokens": 1292,
    "hardness": "hard",
    "scores": [
      0.45820164680480957,
      0.5248333215713501
    ],
    "lang": "en"
  },
  {
    "i": 53,
    "question": "How many people who were born in Switzerland did not possess permanent residency status by 2015? List by citizenship",
    "query": "SELECT T1.year, T1.population_type,T1.place_of_birth, T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True'  AND T1.year = 2015 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship != 'Citizenship - total';\n",
    "db_id": "resident_population_birthplace_citizenship_type",
    "generated_query": "SELECT T1.citizenship, SUM(T1.amount) as total_amount FROM resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2015 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Switzerland'\nGROUP BY T1.citizenship;",
    "meta_data": [
      {
        "question": "How many people who were born in Switzerland  did not possess permanent residency status by 2010?",
        "query": "SELECT T1.year, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True'  AND T1.year = 2015 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total';\n",
        "score": 0.18450146913528442
      },
      {
        "question": "In 2021, how many people were living in Switzerland who were not born there and did not have permanent residency?",
        "query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2021 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n",
        "score": 0.21198278665542603
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.resident_population_birthplace_citizenship_type (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tpopulation_type VARCHAR(50), \n\tplace_of_birth VARCHAR(50), \n\tcitizenship VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT resident_population_birthplace_citizenship_type_pk PRIMARY KEY (uid), \n\tCONSTRAINT resident_population_birthplace_citizenship_type_spatial_unit_sp FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in resident_population_birthplace_citizenship_type and 5 examples in each column for high cardinality columns :\nuid : 31873189, 31873171, 31873187, 31873207, 31873089\nspatialunit_uid : 4446_A.ADM3, 1510_A.ADM3, 401_A.ADM3, 4013_A.ADM3, 6240_A.ADM3\nyear : 2014, 2013, 2017, 2021, 2010\ncitizenship : Liechtenstein, Ukraine, No indication, Cambodia, Senegal\namount : 1, 44, 463, 17, 22\n*/\n\n/*\nColumn name, Column discription, Example values\npopulation_type, population type, Non permanent resident population,Permanent resident population\nplace_of_birth, Place of birth: Switzerland or abroad, Abroad,Switzerland,Place of birth - total\ncitizenship, citizenship, Sweden,S\u00e3o Tom\u00e9 and Pr\u00edncipe,Uganda\namount, number of persons, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nHow many people who were born in Switzerland  did not possess permanent residency status by 2010?\n### SQL query\nSELECT T1.year, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True'  AND T1.year = 2015 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nCan you provide a breakdown of the number of people who hold Swiss permanent residency and were born in Switzerland in 2020, categorized by their respective citizenships?\n### SQL query\nSELECT T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship != 'Citizenship - total';\n\n\n### Question\nHow many people who were born in Switzerland did not possess permanent residency status by 2015? List by citizenship\n### SQL query\n",
    "process_time": 12.162966328905895,
    "num_tokens": 1259,
    "hardness": "extra",
    "scores": [
      0.18450146913528442,
      0.21198278665542603
    ],
    "lang": "en"
  },
  {
    "i": 54,
    "question": "How many individuals with Swiss permanent residency were born within the country's borders on 2006?",
    "query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2019 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total';\n",
    "db_id": "resident_population_birthplace_citizenship_type",
    "generated_query": "SELECT T1.year, T1.population_type, T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2006 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total';",
    "meta_data": [
      {
        "question": "How many people who were born in Switzerland  did not possess permanent residency status by 2010?",
        "query": "SELECT T1.year, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True'  AND T1.year = 2015 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total';\n",
        "score": 0.17703452706336975
      },
      {
        "question": "In 2021, how many people were living in Switzerland who were not born there and did not have permanent residency?",
        "query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2021 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n",
        "score": 0.2168349176645279
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.resident_population_birthplace_citizenship_type (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tpopulation_type VARCHAR(50), \n\tplace_of_birth VARCHAR(50), \n\tcitizenship VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT resident_population_birthplace_citizenship_type_pk PRIMARY KEY (uid), \n\tCONSTRAINT resident_population_birthplace_citizenship_type_spatial_unit_sp FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in resident_population_birthplace_citizenship_type and 5 examples in each column for high cardinality columns :\nuid : 31873189, 31873171, 31873187, 31873207, 31873089\nspatialunit_uid : 4446_A.ADM3, 1510_A.ADM3, 401_A.ADM3, 4013_A.ADM3, 6240_A.ADM3\nyear : 2014, 2013, 2017, 2021, 2010\ncitizenship : Liechtenstein, Ukraine, No indication, Cambodia, Senegal\namount : 1, 44, 463, 17, 22\n*/\n\n/*\nColumn name, Column discription, Example values\npopulation_type, population type, Non permanent resident population,Permanent resident population\nplace_of_birth, Place of birth: Switzerland or abroad, Abroad,Switzerland,Place of birth - total\ncitizenship, citizenship, Sweden,S\u00e3o Tom\u00e9 and Pr\u00edncipe,Uganda\namount, number of persons, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nHow many people who were born in Switzerland  did not possess permanent residency status by 2010?\n### SQL query\nSELECT T1.year, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True'  AND T1.year = 2015 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nCan you provide a breakdown of the number of people who hold Swiss permanent residency and were born in Switzerland in 2020, categorized by their respective citizenships?\n### SQL query\nSELECT T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship != 'Citizenship - total';\n\n\n### Question\nHow many individuals with Swiss permanent residency were born within the country's borders on 2006?\n### SQL query\n",
    "process_time": 8.079593824921176,
    "num_tokens": 1255,
    "hardness": "extra",
    "scores": [
      0.17703452706336975,
      0.2168349176645279
    ],
    "lang": "en"
  },
  {
    "i": 55,
    "question": "How many individuals in each canton of Switzerland were born abroad and hold Swiss citizenship?",
    "query": "SELECT T2.name, T1.place_of_birth, T1.citizenship, Sum(T1.amount) from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True'   AND T1.place_of_birth = 'Abroad' AND T1.citizenship ilike '%Switzerland%'\nGROUP BY T2.name, T1.place_of_birth, T1.citizenship;\n",
    "db_id": "resident_population_birthplace_citizenship_type",
    "generated_query": "SELECT T2.name, T1.amount FROM resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Switzerland'\nORDER BY T2.name;",
    "meta_data": [
      {
        "question": "How many individuals born abroad in canton zurich hold citizenship from Brazil?",
        "query": "SELECT T2.name, T1.place_of_birth, T1.citizenship, Sum(T1.amount) from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Z_rich%'  AND T1.place_of_birth = 'Abroad' AND T1.citizenship ilike '%Brazil%'\nGROUP BY T2.name, T1.place_of_birth, T1.citizenship;\n",
        "score": 0.32560887932777405
      },
      {
        "question": "How many people who were born in Switzerland  did not possess permanent residency status by 2010?",
        "query": "SELECT T1.year, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True'  AND T1.year = 2015 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total';\n",
        "score": 0.3799741268157959
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.resident_population_birthplace_citizenship_type (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tpopulation_type VARCHAR(50), \n\tplace_of_birth VARCHAR(50), \n\tcitizenship VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT resident_population_birthplace_citizenship_type_pk PRIMARY KEY (uid), \n\tCONSTRAINT resident_population_birthplace_citizenship_type_spatial_unit_sp FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in resident_population_birthplace_citizenship_type and 5 examples in each column for high cardinality columns :\nuid : 31873189, 31873171, 31873187, 31873207, 31873089\nspatialunit_uid : 4446_A.ADM3, 1510_A.ADM3, 401_A.ADM3, 4013_A.ADM3, 6240_A.ADM3\nyear : 2014, 2013, 2017, 2021, 2010\ncitizenship : Liechtenstein, Ukraine, No indication, Cambodia, Senegal\namount : 1, 44, 463, 17, 22\n*/\n\n/*\nColumn name, Column discription, Example values\npopulation_type, population type, Non permanent resident population,Permanent resident population\nplace_of_birth, Place of birth: Switzerland or abroad, Abroad,Switzerland,Place of birth - total\ncitizenship, citizenship, Sweden,S\u00e3o Tom\u00e9 and Pr\u00edncipe,Uganda\namount, number of persons, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nCan you provide the breakdown of the population by different citizenships, different place of the birth and different residentship in the Canton of Obwaldent in 2011?\n### SQL query\nSELECT T1.citizenship, T1.population_type, T1.place_of_birth,  T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Obwalden%' AND T1.year = 2011  AND T1.place_of_birth != 'Place of birth - total' AND T1.citizenship != 'Citizenship - total'\nORDER BY citizenship;\n\n### Question\nHow many of the people were born abroad in municipality level  had the permanent residenship on 2010?\n### SQL query\nSELECT T1.year, T2.spatialunit_ontology, T2.name, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2010 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nHow many individuals in each canton of Switzerland were born abroad and hold Swiss citizenship?\n### SQL query\n",
    "process_time": 9.747136836173013,
    "num_tokens": 1282,
    "hardness": "unknown",
    "scores": [
      0.32560887932777405,
      0.3799741268157959
    ],
    "lang": "en"
  },
  {
    "i": 56,
    "question": "How many of Swiss residenc were born within the country and had Iranian Citizenship on 2018?",
    "query": "SELECT T1.year, T1.population_type, T1.place_of_birth, T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True'  AND T1.year = 2018 AND T1.place_of_birth = 'Switzerland' AND T1.citizenship ilike '%iran%';\n",
    "db_id": "resident_population_birthplace_citizenship_type",
    "generated_query": "SELECT T1.year, T2.spatialunit_ontology, T2.name, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True'  AND T1.year = 2018 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Iran';",
    "meta_data": [
      {
        "question": "In 2021, how many people were living in Switzerland who were not born there and did not have permanent residency?",
        "query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2021 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n",
        "score": 0.3804613947868347
      },
      {
        "question": "How many people who were born in Switzerland  did not possess permanent residency status by 2010?",
        "query": "SELECT T1.year, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True'  AND T1.year = 2015 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total';\n",
        "score": 0.39088356494903564
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.resident_population_birthplace_citizenship_type (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tpopulation_type VARCHAR(50), \n\tplace_of_birth VARCHAR(50), \n\tcitizenship VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT resident_population_birthplace_citizenship_type_pk PRIMARY KEY (uid), \n\tCONSTRAINT resident_population_birthplace_citizenship_type_spatial_unit_sp FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in resident_population_birthplace_citizenship_type and 5 examples in each column for high cardinality columns :\nuid : 31873189, 31873171, 31873187, 31873207, 31873089\nspatialunit_uid : 4446_A.ADM3, 1510_A.ADM3, 401_A.ADM3, 4013_A.ADM3, 6240_A.ADM3\nyear : 2014, 2013, 2017, 2021, 2010\ncitizenship : Liechtenstein, Ukraine, No indication, Cambodia, Senegal\namount : 1, 44, 463, 17, 22\n*/\n\n/*\nColumn name, Column discription, Example values\npopulation_type, population type, Non permanent resident population,Permanent resident population\nplace_of_birth, Place of birth: Switzerland or abroad, Abroad,Switzerland,Place of birth - total\ncitizenship, citizenship, Sweden,S\u00e3o Tom\u00e9 and Pr\u00edncipe,Uganda\namount, number of persons, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nCan you provide the breakdown of the population by different citizenships, different place of the birth and different residentship in the Canton of Obwaldent in 2011?\n### SQL query\nSELECT T1.citizenship, T1.population_type, T1.place_of_birth,  T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Obwalden%' AND T1.year = 2011  AND T1.place_of_birth != 'Place of birth - total' AND T1.citizenship != 'Citizenship - total'\nORDER BY citizenship;\n\n### Question\nHow many of the people were born abroad in municipality level  had the permanent residenship on 2010?\n### SQL query\nSELECT T1.year, T2.spatialunit_ontology, T2.name, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2010 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nHow many of Swiss residenc were born within the country and had Iranian Citizenship on 2018?\n### SQL query\n",
    "process_time": 7.7441853689961135,
    "num_tokens": 1285,
    "hardness": "unknown",
    "scores": [
      0.3804613947868347,
      0.39088356494903564
    ],
    "lang": "en"
  },
  {
    "i": 57,
    "question": "How many vehicles do we have in canton zurich in 2020?",
    "query": "SELECT S.name, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Zurich%'  and T.year = 2020 and S.canton = 'True'\nGROUP BY S.name;\n",
    "db_id": "resident_population_birthplace_citizenship_type",
    "generated_query": "SELECT S.name, S.spatialunit_ontology, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Z_rich%' and S.canton = 'True' and T.year = 2020\nGROUP BY S.name, S.spatialunit_ontology;",
    "meta_data": [
      {
        "question": "How many vehicles do we have in zurich in 2020?",
        "query": "SELECT S.name, S.spatialunit_ontology, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Z_rich%'  and T.year = 2020 and (S.canton = 'True' or S.municipal = 'True' or S.district = 'True')\nGROUP BY S.name, S.spatialunit_ontology;\n",
        "score": 0.09414180368185043
      },
      {
        "question": "How many vehicles do we have in the city of zurich in 2021?",
        "query": "SELECT S.name, S.spatialunit_ontology, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Z_rich%'  and T.year = 2021 and S.municipal = 'True' and T.fuel_type != 'total'\nGROUP BY S.name, S.spatialunit_ontology;\n",
        "score": 0.10858938097953796
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.resident_population_birthplace_citizenship_type (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tpopulation_type VARCHAR(50), \n\tplace_of_birth VARCHAR(50), \n\tcitizenship VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT resident_population_birthplace_citizenship_type_pk PRIMARY KEY (uid), \n\tCONSTRAINT resident_population_birthplace_citizenship_type_spatial_unit_sp FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in resident_population_birthplace_citizenship_type and 5 examples in each column for high cardinality columns :\nuid : 31873189, 31873171, 31873187, 31873207, 31873089\nspatialunit_uid : 4446_A.ADM3, 1510_A.ADM3, 401_A.ADM3, 4013_A.ADM3, 6240_A.ADM3\nyear : 2014, 2013, 2017, 2021, 2010\ncitizenship : Liechtenstein, Ukraine, No indication, Cambodia, Senegal\namount : 1, 44, 463, 17, 22\n*/\n\n/*\nColumn name, Column discription, Example values\npopulation_type, population type, Non permanent resident population,Permanent resident population\nplace_of_birth, Place of birth: Switzerland or abroad, Abroad,Switzerland,Place of birth - total\ncitizenship, citizenship, Sweden,S\u00e3o Tom\u00e9 and Pr\u00edncipe,Uganda\namount, number of persons, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\ngive me the total number of passenger cars that are using diesel in each canton?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE  S.canton = 'True' and T.fuel_type ilike '%diesel%' and T.vehicle_type = 'passenger_cars'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type;\n\n\n### Question\nHow many vehicles do we have in zurich in 2020?\n### SQL query\nSELECT S.name, S.spatialunit_ontology, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Z_rich%'  and T.year = 2020 and (S.canton = 'True' or S.municipal = 'True' or S.district = 'True')\nGROUP BY S.name, S.spatialunit_ontology;\n\n\n### Question\nHow many vehicles do we have in canton zurich in 2020?\n### SQL query\n",
    "process_time": 5.904645845992491,
    "num_tokens": 1202,
    "hardness": "unknown",
    "scores": [
      0.09414180368185043,
      0.10858938097953796
    ],
    "lang": "en"
  },
  {
    "i": 58,
    "question": "What proportion of the Swiss budget will be spent on health in 2010 and 2020?",
    "query": "SELECT year, SUM(percentage_of_total_expenses) as precentage_of_total_expenses_for_health\nFROM government_expenditure_by_function_cofog WHERE function_cofog_broad = 'Health'\n    AND institutional_sector = 'Government'\n    AND year <= 2020\n    AND year >= 2010\nGROUP BY year\nORDER BY year ASC;\n",
    "db_id": "government_expenditure_by_function_cofog",
    "generated_query": "SELECT year, SUM(expenses_in_million_chf) as total_health_expenses_in_mio_chf\nFROM government_expenditure_by_function_cofog\nWHERE function_cofog_broad = 'Health' AND (year = 2010 OR year = 2020)\nGROUP BY year;",
    "meta_data": [
      {
        "question": "What is the distribution of cantonal education spending in year 2010?",
        "query": "SELECT function_cofog_narrow, expenses_in_million_chf as cantonal_expenses_in_mio_chf_in_2010_on_education\nFROM government_expenditure_by_function_cofog as T\nWHERE function_cofog_broad = 'Education'\n    AND year = 2020\n    AND institutional_sector = 'Canton'\nORDER BY expenses_in_million_chf DESC;\n",
        "score": 0.7983390092849731
      },
      {
        "question": "What percentage of the government budget was spent on education in year 2021?",
        "query": "SELECT SUM(T.percentage_of_total_expenses) as percentage_for_total_expenses_for_education\nFROM government_expenditure_by_function_cofog as T\nWHERE institutional_sector = 'Government'\n    AND T.year = 2021\n    AND T.function_cofog_broad = 'Education'\nGROUP BY T.function_cofog_broad;\n",
        "score": 0.8167831897735596
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.government_expenditure_by_function_cofog (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tfunction_cofog_narrow TEXT, \n\tfunction_cofog_broad TEXT, \n\tinstitutional_sector TEXT, \n\texpenses_in_million_chf NUMERIC, \n\tpercentage_of_total_expenses NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT government_expenditure_by_function_cofog_pkey PRIMARY KEY (uid), \n\tCONSTRAINT government_expenditure_by_function_cofog_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in government_expenditure_by_function_cofog and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nyear : 2014, 2006, 2002, 2005, 2017\nexpenses_in_million_chf : 8656, 6725, 1131, 3432, 6930\npercentage_of_total_expenses : 3.50000000000000000, 1.10000000000000009, 3.00000000000000000, 2.79999999999999982, 2.10000000000000009\n*/\n\n/*\nColumn name, Column discription, Example values\nfunction_cofog_narrow, Narrow function of govenrment by COFOG (Classification of the functions of government) of the United Nations, Foreign economic aid,General services,Executive and legislative organs, financial and fiscal affairs, external affairs\nfunction_cofog_broad, Broad function of govenrment by COFOG (Classification of the functions of government) of the United Nations, General public services,Defence,Public order and safety\ninstitutional_sector, Institutional Sector, Government,   Confederation,Canton,Commune,Social security funds\nexpenses_in_million_chf, Expenses in million CHF, 2167,2341,2599\npercentage_of_total_expenses, percentage of total expenses, 1.1,1.2,2.6\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWhat is the distribution of cantonal education spending in year 2010?\n### SQL query\nSELECT function_cofog_narrow, expenses_in_million_chf as cantonal_expenses_in_mio_chf_in_2010_on_education\nFROM government_expenditure_by_function_cofog as T\nWHERE function_cofog_broad = 'Education'\n    AND year = 2020\n    AND institutional_sector = 'Canton'\nORDER BY expenses_in_million_chf DESC;\n\n\n### Question\nWhich division had the highest government spending in 2020?\n### SQL query\nSELECT T.function_cofog_broad as sector_with_highest_expenses_2020\nFROM government_expenditure_by_function_cofog as T\nWHERE T.institutional_sector = 'Government' AND year = 2020\nGROUP BY T.function_cofog_broad, T.year\nORDER BY SUM(T.expenses_in_million_chf) DESC LIMIT 1;\n\n\n### Question\nWhat proportion of the Swiss budget will be spent on health in 2010 and 2020?\n### SQL query\n",
    "process_time": 6.82144137006253,
    "num_tokens": 1284,
    "hardness": "unknown",
    "scores": [
      0.7983390092849731,
      0.8167831897735596
    ],
    "lang": "en"
  },
  {
    "i": 59,
    "question": "What were the 3 largest sectors for spending of the confederation in year 2021 and how much were they?",
    "query": "SELECT SUM(T.expenses_in_million_chf) as expenses_in_mio_chf,\n  T.function_cofog_narrow as section_with_the_highest_expenses_2020\nFROM government_expenditure_by_function_cofog as T\nWHERE institutional_sector = 'Confederation' AND year = 2020\nGROUP BY T.function_cofog_narrow, T.year, T.institutional_sector\nORDER BY SUM(expenses_in_million_chf) DESC LIMIT 3;\n",
    "db_id": "government_expenditure_by_function_cofog",
    "generated_query": "SELECT function_cofog_broad as sector, SUM(expenses_in_million_chf) as total_expenses_in_mio_chf\nFROM government_expenditure_by_function_cofog as T\nWHERE institutional_sector = 'Confederation' AND year = 2021\nGROUP BY function_cofog_broad, year\nORDER BY total_expenses_in_mio_chf DESC\nLIMIT 3;",
    "meta_data": [
      {
        "question": "Which division had the highest government spending in 2020?",
        "query": "SELECT T.function_cofog_broad as sector_with_highest_expenses_2020\nFROM government_expenditure_by_function_cofog as T\nWHERE T.institutional_sector = 'Government' AND year = 2020\nGROUP BY T.function_cofog_broad, T.year\nORDER BY SUM(T.expenses_in_million_chf) DESC LIMIT 1;\n",
        "score": 0.5426786541938782
      },
      {
        "question": "What percentage of the government budget was spent on education in year 2021?",
        "query": "SELECT SUM(T.percentage_of_total_expenses) as percentage_for_total_expenses_for_education\nFROM government_expenditure_by_function_cofog as T\nWHERE institutional_sector = 'Government'\n    AND T.year = 2021\n    AND T.function_cofog_broad = 'Education'\nGROUP BY T.function_cofog_broad;\n",
        "score": 0.8817809820175171
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.government_expenditure_by_function_cofog (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tfunction_cofog_narrow TEXT, \n\tfunction_cofog_broad TEXT, \n\tinstitutional_sector TEXT, \n\texpenses_in_million_chf NUMERIC, \n\tpercentage_of_total_expenses NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT government_expenditure_by_function_cofog_pkey PRIMARY KEY (uid), \n\tCONSTRAINT government_expenditure_by_function_cofog_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in government_expenditure_by_function_cofog and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nyear : 2014, 2006, 2002, 2005, 2017\nexpenses_in_million_chf : 8656, 6725, 1131, 3432, 6930\npercentage_of_total_expenses : 3.50000000000000000, 1.10000000000000009, 3.00000000000000000, 2.79999999999999982, 2.10000000000000009\n*/\n\n/*\nColumn name, Column discription, Example values\nfunction_cofog_narrow, Narrow function of govenrment by COFOG (Classification of the functions of government) of the United Nations, Foreign economic aid,General services,Executive and legislative organs, financial and fiscal affairs, external affairs\nfunction_cofog_broad, Broad function of govenrment by COFOG (Classification of the functions of government) of the United Nations, General public services,Defence,Public order and safety\ninstitutional_sector, Institutional Sector, Government,   Confederation,Canton,Commune,Social security funds\nexpenses_in_million_chf, Expenses in million CHF, 2167,2341,2599\npercentage_of_total_expenses, percentage of total expenses, 1.1,1.2,2.6\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWhich division had the highest government spending in 2020?\n### SQL query\nSELECT T.function_cofog_broad as sector_with_highest_expenses_2020\nFROM government_expenditure_by_function_cofog as T\nWHERE T.institutional_sector = 'Government' AND year = 2020\nGROUP BY T.function_cofog_broad, T.year\nORDER BY SUM(T.expenses_in_million_chf) DESC LIMIT 1;\n\n\n### Question\nWhat is the distribution of cantonal education spending in year 2010?\n### SQL query\nSELECT function_cofog_narrow, expenses_in_million_chf as cantonal_expenses_in_mio_chf_in_2010_on_education\nFROM government_expenditure_by_function_cofog as T\nWHERE function_cofog_broad = 'Education'\n    AND year = 2020\n    AND institutional_sector = 'Canton'\nORDER BY expenses_in_million_chf DESC;\n\n\n### Question\nWhat were the 3 largest sectors for spending of the confederation in year 2021 and how much were they?\n### SQL query\n",
    "process_time": 8.289432996883988,
    "num_tokens": 1288,
    "hardness": "unknown",
    "scores": [
      0.5426786541938782,
      0.8817809820175171
    ],
    "lang": "en"
  },
  {
    "i": 60,
    "question": "What proportion of the Swiss budget is invested in public safety each year?",
    "query": "SELECT year, SUM(T.percentage_of_total_expenses) as percentage_of_total_expenses_for_safety\nFROM government_expenditure_by_function_cofog AS T\nWHERE LOWER(function_cofog_broad) LIKE '%public%safety%'\n    AND institutional_sector = 'Government'\nGROUP BY year\nORDER BY year ASC;\n",
    "db_id": "government_expenditure_by_function_cofog",
    "generated_query": "SELECT year, percentage_of_total_expenses as proportion_invested_in_public_safety\nFROM government_expenditure_by_function_cofog as T\nWHERE function_cofog_broad = 'Public order and safety'\n    AND institutional_sector = 'Government'\nORDER BY year;",
    "meta_data": [
      {
        "question": "What is the distribution of cantonal education spending in year 2010?",
        "query": "SELECT function_cofog_narrow, expenses_in_million_chf as cantonal_expenses_in_mio_chf_in_2010_on_education\nFROM government_expenditure_by_function_cofog as T\nWHERE function_cofog_broad = 'Education'\n    AND year = 2020\n    AND institutional_sector = 'Canton'\nORDER BY expenses_in_million_chf DESC;\n",
        "score": 0.7800089120864868
      },
      {
        "question": "What percentage of the government budget was spent on education in year 2021?",
        "query": "SELECT SUM(T.percentage_of_total_expenses) as percentage_for_total_expenses_for_education\nFROM government_expenditure_by_function_cofog as T\nWHERE institutional_sector = 'Government'\n    AND T.year = 2021\n    AND T.function_cofog_broad = 'Education'\nGROUP BY T.function_cofog_broad;\n",
        "score": 0.8421021103858948
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.government_expenditure_by_function_cofog (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tfunction_cofog_narrow TEXT, \n\tfunction_cofog_broad TEXT, \n\tinstitutional_sector TEXT, \n\texpenses_in_million_chf NUMERIC, \n\tpercentage_of_total_expenses NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT government_expenditure_by_function_cofog_pkey PRIMARY KEY (uid), \n\tCONSTRAINT government_expenditure_by_function_cofog_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in government_expenditure_by_function_cofog and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nyear : 2014, 2006, 2002, 2005, 2017\nexpenses_in_million_chf : 8656, 6725, 1131, 3432, 6930\npercentage_of_total_expenses : 3.50000000000000000, 1.10000000000000009, 3.00000000000000000, 2.79999999999999982, 2.10000000000000009\n*/\n\n/*\nColumn name, Column discription, Example values\nfunction_cofog_narrow, Narrow function of govenrment by COFOG (Classification of the functions of government) of the United Nations, Foreign economic aid,General services,Executive and legislative organs, financial and fiscal affairs, external affairs\nfunction_cofog_broad, Broad function of govenrment by COFOG (Classification of the functions of government) of the United Nations, General public services,Defence,Public order and safety\ninstitutional_sector, Institutional Sector, Government,   Confederation,Canton,Commune,Social security funds\nexpenses_in_million_chf, Expenses in million CHF, 2167,2341,2599\npercentage_of_total_expenses, percentage of total expenses, 1.1,1.2,2.6\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWhat is the distribution of cantonal education spending in year 2010?\n### SQL query\nSELECT function_cofog_narrow, expenses_in_million_chf as cantonal_expenses_in_mio_chf_in_2010_on_education\nFROM government_expenditure_by_function_cofog as T\nWHERE function_cofog_broad = 'Education'\n    AND year = 2020\n    AND institutional_sector = 'Canton'\nORDER BY expenses_in_million_chf DESC;\n\n\n### Question\nWhich division had the highest government spending in 2020?\n### SQL query\nSELECT T.function_cofog_broad as sector_with_highest_expenses_2020\nFROM government_expenditure_by_function_cofog as T\nWHERE T.institutional_sector = 'Government' AND year = 2020\nGROUP BY T.function_cofog_broad, T.year\nORDER BY SUM(T.expenses_in_million_chf) DESC LIMIT 1;\n\n\n### Question\nWhat proportion of the Swiss budget is invested in public safety each year?\n### SQL query\n",
    "process_time": 4.327763993991539,
    "num_tokens": 1278,
    "hardness": "unknown",
    "scores": [
      0.7800089120864868,
      0.8421021103858948
    ],
    "lang": "en"
  },
  {
    "i": 61,
    "question": "Welches drei medizinischen Ger\u00e4te hatten den meisten Zuwachs zwischen 2013 und 2021 in der Schweiz und wieviele Neuanschaffungen gab es jeweils?",
    "query": "SELECT T.genutzte_infrastruktur,\n    SUM(CASE WHEN T.jahr = 2021 THEN T.anzahl_gerate ELSE - T.anzahl_gerate END) AS zuwachs_an_geraeten\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country\n    AND T.jahr IN (2013, 2021)\nGROUP BY T.genutzte_infrastruktur\nORDER BY zuwachs_an_geraeten DESC\nLIMIT 3;\n",
    "db_id": "medizinisch_technische_infrastruktur",
    "generated_query": "WITH Geraete2013 AS (\nSELECT SUM(T1.anzahl_gerate) as anzahl_gerate_2013,\n  T1.genutzte_infrastruktur\nFROM medizinisch_technische_infrastruktur as T1\nJOIN spatial_unit as S1 on T1.spatialunit_uid = S1.spatialunit_uid\nWHERE S1.country = 'TRUE'\n  AND T1.jahr = 2013\nGROUP BY T1.genutzte_infrastruktur\n),\nGeraete2021 AS (\n    SELECT SUM(T2.anzahl_gerate) as anzahl_gerate_2021,\n      T2.genutzte_infrastruktur\n    FROM medizinisch_technische_infrastruktur as T2\n    JOIN spatial_unit as S2 on T2.spatialunit_uid = S2.spatialunit_uid\n    WHERE S2.country = 'TRUE'\n      AND T2.jahr = 2021\n    GROUP BY T2.genutzte_infrastruktur\n)\nSELECT\n    G2021.genutzte_infrastruktur,\n    G2021.anzahl_gerate_2021 - G2013.anzahl_gerate_2013 AS zuwachs_geraete\nFROM Geraete2013 AS G2013\nJOIN Geraete2021 AS G2021 ON G2013.genutzte_infrastruktur = G2021.genutzte_infrastruktur\nORDER BY zuwachs_geraete DESC\nLIMIT 3;",
    "meta_data": [
      {
        "question": "Welche medizinischen Ger\u00e4te z\u00e4hlen in der Schweiz zur medizinischen Infrastruktur und wieviele gab es davon jeweils 2020? Sortiere nach Ger\u00e4teanzahl.",
        "query": "SELECT SUM(T.anzahl_gerate) as gerate_anzahl_2020, T.genutzte_infrastruktur\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.jahr = 2020\nGROUP BY T.genutzte_infrastruktur\nORDER BY gerate_anzahl_2020 DESC;\n",
        "score": 0.4865540862083435
      },
      {
        "question": "Welchem drei Kantone hatte den gr\u00f6ssten Zuwachs und Untersuchungen mit medizinischen Ger\u00e4ten zwischen 2013 and 2021 und wieviel hoch war der Zuwachs verteilt auf ambulante und station\u00e4re Untersuchungen und Ger\u00e4te?",
        "query": "WITH Untersuchungen2013 AS (\nSELECT SUM(T1.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2013,\n  SUM(T1.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2013,\n  SUM(T1.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2013,\n  SUM(T1.anzahl_gerate) as anzahl_gerate_2013,\n  S1.name_de as kanton\n    FROM medizinisch_technische_infrastruktur as T1\n    JOIN spatial_unit as S1 on T1.spatialunit_uid = S1.spatialunit_uid\n    WHERE S1.canton = 'TRUE'\n      AND T1.jahr = 2013\n    GROUP BY S1.name_de\n),\nUntersuchungen2021 AS (\n    SELECT SUM(T2.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2021,\n      SUM(T2.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2021,\n      SUM(T2.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2021,\n      SUM(T2.anzahl_gerate) as anzahl_gerate_2021,\n      S2.name_de as kanton2021\n    FROM medizinisch_technische_infrastruktur as T2\n    JOIN spatial_unit as S2 on T2.spatialunit_uid = S2.spatialunit_uid\n    WHERE S2.canton = 'TRUE'\n      AND T2.jahr = 2021\n    GROUP BY S2.name_de\n)\nSELECT\n    U2013.kanton,\n    U2021.anzahl_untersuchungen_gesamt_2021 - U2013.anzahl_untersuchungen_gesamt_2013 AS zuwachs_untersuchungen_gesamt,\n    U2021.anzahl_ambulante_untersuchungen_2021 - U2013.anzahl_ambulante_untersuchungen_2013 AS zuwachs_ambulante_untersuchungen,\n    U2021.anzahl_stationare_untersuchungen_2021 - U2013.anzahl_stationare_untersuchungen_2013 AS zuwachs_statinon\u00e4re_untersuchungen,\n    U2021.anzahl_gerate_2021 - U2013.anzahl_gerate_2013 AS zuwachs_geraete\nFROM Untersuchungen2013 AS U2013\nJOIN Untersuchungen2021 AS U2021 ON U2013.kanton = U2021.kanton2021\nORDER BY zuwachs_untersuchungen_gesamt DESC\nLIMIT 3;\n",
        "score": 0.6062195301055908
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.medizinisch_technische_infrastruktur (\n\tuid SERIAL NOT NULL, \n\tgenutzte_infrastruktur TEXT, \n\tjahr INTEGER, \n\tanzahl_gerate NUMERIC, \n\tanzahl_untersuchungen_total NUMERIC, \n\tanzahl_ambulante_untersuchungen NUMERIC, \n\tanzahl_stationare_untersuchungen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT medizinisch_technische_infrastruktur_pkey PRIMARY KEY (uid), \n\tCONSTRAINT medizinisch_technische_infrastruktur_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in medizinisch_technische_infrastruktur and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nanzahl_gerate : 21, 228, 219, 136, 5\nanzahl_untersuchungen_total : 21943, 59151, 8484, 15915, 23013\nanzahl_ambulante_untersuchungen : 149, 4313, 2264, 5191, 338\nanzahl_stationare_untersuchungen : 62619, 2624, 4477, 4154, 35581\nspatialunit_uid : 19_A.ADM1, 1_A.ADM1, 10_A.ADM1, 24_A.ADM1, 13_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\ngenutzte_infrastruktur, genutzte Infrastruktur, Gamma Camera (inklusive Szintigraphie und SPECT-Scanner),Linearbeschleuniger (Radiotherapie),MRI\nanzahl_gerate, Anzahl der Ger\u00e4te, None\nanzahl_untersuchungen_total, Anzahl aller Untersuchungen, None\nanzahl_ambulante_untersuchungen, Anzahl der ambulanten Untersuchungen, None\nanzahl_stationare_untersuchungen, Anzahl der station\u00e4ren Untersuchungen, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWelchem drei Kantone hatte den gr\u00f6ssten Zuwachs und Untersuchungen mit medizinischen Ger\u00e4ten zwischen 2013 and 2021 und wieviel hoch war der Zuwachs verteilt auf ambulante und station\u00e4re Untersuchungen und Ger\u00e4te?\n### SQL query\nWITH Untersuchungen2013 AS (\nSELECT SUM(T1.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2013,\n  SUM(T1.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2013,\n  SUM(T1.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2013,\n  SUM(T1.anzahl_gerate) as anzahl_gerate_2013,\n  S1.name_de as kanton\n    FROM medizinisch_technische_infrastruktur as T1\n    JOIN spatial_unit as S1 on T1.spatialunit_uid = S1.spatialunit_uid\n    WHERE S1.canton = 'TRUE'\n      AND T1.jahr = 2013\n    GROUP BY S1.name_de\n),\nUntersuchungen2021 AS (\n    SELECT SUM(T2.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2021,\n      SUM(T2.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2021,\n      SUM(T2.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2021,\n      SUM(T2.anzahl_gerate) as anzahl_gerate_2021,\n      S2.name_de as kanton2021\n    FROM medizinisch_technische_infrastruktur as T2\n    JOIN spatial_unit as S2 on T2.spatialunit_uid = S2.spatialunit_uid\n    WHERE S2.canton = 'TRUE'\n      AND T2.jahr = 2021\n    GROUP BY S2.name_de\n)\nSELECT\n    U2013.kanton,\n    U2021.anzahl_untersuchungen_gesamt_2021 - U2013.anzahl_untersuchungen_gesamt_2013 AS zuwachs_untersuchungen_gesamt,\n    U2021.anzahl_ambulante_untersuchungen_2021 - U2013.anzahl_ambulante_untersuchungen_2013 AS zuwachs_ambulante_untersuchungen,\n    U2021.anzahl_stationare_untersuchungen_2021 - U2013.anzahl_stationare_untersuchungen_2013 AS zuwachs_statinon\u00e4re_untersuchungen,\n    U2021.anzahl_gerate_2021 - U2013.anzahl_gerate_2013 AS zuwachs_geraete\nFROM Untersuchungen2013 AS U2013\nJOIN Untersuchungen2021 AS U2021 ON U2013.kanton = U2021.kanton2021\nORDER BY zuwachs_untersuchungen_gesamt DESC\nLIMIT 3;\n\n\n### Question\nWelche medizinischen Ger\u00e4te z\u00e4hlen in der Schweiz zur medizinischen Infrastruktur und wieviele gab es davon jeweils 2020? Sortiere nach Ger\u00e4teanzahl.\n### SQL query\nSELECT SUM(T.anzahl_gerate) as gerate_anzahl_2020, T.genutzte_infrastruktur\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.jahr = 2020\nGROUP BY T.genutzte_infrastruktur\nORDER BY gerate_anzahl_2020 DESC;\n\n\n### Question\nWelches drei medizinischen Ger\u00e4te hatten den meisten Zuwachs zwischen 2013 und 2021 in der Schweiz und wieviele Neuanschaffungen gab es jeweils?\n### SQL query\n",
    "process_time": 32.03594941785559,
    "num_tokens": 1977,
    "hardness": "unknown",
    "scores": [
      0.4865540862083435,
      0.6062195301055908
    ],
    "lang": "de"
  },
  {
    "i": 62,
    "question": "Welches war das medizinische Ger\u00e4t 2021 in der Schweiz mit den meisten Untersuchungen und wieviele Untersuchungen gab es damit?",
    "query": "SELECT T.genutzte_infrastruktur as meistgenutztes_geraet_2021,\n  SUM(anzahl_untersuchungen_total) as anzahl_untersuchungen\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND jahr = '2021'\nGROUP BY T.genutzte_infrastruktur\nORDER BY anzahl_untersuchungen DESC LIMIT 1;\n",
    "db_id": "medizinisch_technische_infrastruktur",
    "generated_query": "SELECT genutzte_infrastruktur as medizinisches_geraet,\n  MAX(anzahl_untersuchungen_total) as anzahl_untersuchungen\nFROM medizinisch_technische_infrastruktur\nWHERE jahr = 2021\nGROUP BY genutzte_infrastruktur\nORDER BY anzahl_untersuchungen DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Welchem drei Kantone hatte den gr\u00f6ssten Zuwachs und Untersuchungen mit medizinischen Ger\u00e4ten zwischen 2013 and 2021 und wieviel hoch war der Zuwachs verteilt auf ambulante und station\u00e4re Untersuchungen und Ger\u00e4te?",
        "query": "WITH Untersuchungen2013 AS (\nSELECT SUM(T1.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2013,\n  SUM(T1.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2013,\n  SUM(T1.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2013,\n  SUM(T1.anzahl_gerate) as anzahl_gerate_2013,\n  S1.name_de as kanton\n    FROM medizinisch_technische_infrastruktur as T1\n    JOIN spatial_unit as S1 on T1.spatialunit_uid = S1.spatialunit_uid\n    WHERE S1.canton = 'TRUE'\n      AND T1.jahr = 2013\n    GROUP BY S1.name_de\n),\nUntersuchungen2021 AS (\n    SELECT SUM(T2.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2021,\n      SUM(T2.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2021,\n      SUM(T2.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2021,\n      SUM(T2.anzahl_gerate) as anzahl_gerate_2021,\n      S2.name_de as kanton2021\n    FROM medizinisch_technische_infrastruktur as T2\n    JOIN spatial_unit as S2 on T2.spatialunit_uid = S2.spatialunit_uid\n    WHERE S2.canton = 'TRUE'\n      AND T2.jahr = 2021\n    GROUP BY S2.name_de\n)\nSELECT\n    U2013.kanton,\n    U2021.anzahl_untersuchungen_gesamt_2021 - U2013.anzahl_untersuchungen_gesamt_2013 AS zuwachs_untersuchungen_gesamt,\n    U2021.anzahl_ambulante_untersuchungen_2021 - U2013.anzahl_ambulante_untersuchungen_2013 AS zuwachs_ambulante_untersuchungen,\n    U2021.anzahl_stationare_untersuchungen_2021 - U2013.anzahl_stationare_untersuchungen_2013 AS zuwachs_statinon\u00e4re_untersuchungen,\n    U2021.anzahl_gerate_2021 - U2013.anzahl_gerate_2013 AS zuwachs_geraete\nFROM Untersuchungen2013 AS U2013\nJOIN Untersuchungen2021 AS U2021 ON U2013.kanton = U2021.kanton2021\nORDER BY zuwachs_untersuchungen_gesamt DESC\nLIMIT 3;\n",
        "score": 0.651204526424408
      },
      {
        "question": "Welche medizinischen Ger\u00e4te z\u00e4hlen in der Schweiz zur medizinischen Infrastruktur und wieviele gab es davon jeweils 2020? Sortiere nach Ger\u00e4teanzahl.",
        "query": "SELECT SUM(T.anzahl_gerate) as gerate_anzahl_2020, T.genutzte_infrastruktur\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.jahr = 2020\nGROUP BY T.genutzte_infrastruktur\nORDER BY gerate_anzahl_2020 DESC;\n",
        "score": 0.7698683142662048
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.medizinisch_technische_infrastruktur (\n\tuid SERIAL NOT NULL, \n\tgenutzte_infrastruktur TEXT, \n\tjahr INTEGER, \n\tanzahl_gerate NUMERIC, \n\tanzahl_untersuchungen_total NUMERIC, \n\tanzahl_ambulante_untersuchungen NUMERIC, \n\tanzahl_stationare_untersuchungen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT medizinisch_technische_infrastruktur_pkey PRIMARY KEY (uid), \n\tCONSTRAINT medizinisch_technische_infrastruktur_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in medizinisch_technische_infrastruktur and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nanzahl_gerate : 21, 228, 219, 136, 5\nanzahl_untersuchungen_total : 21943, 59151, 8484, 15915, 23013\nanzahl_ambulante_untersuchungen : 149, 4313, 2264, 5191, 338\nanzahl_stationare_untersuchungen : 62619, 2624, 4477, 4154, 35581\nspatialunit_uid : 19_A.ADM1, 1_A.ADM1, 10_A.ADM1, 24_A.ADM1, 13_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\ngenutzte_infrastruktur, genutzte Infrastruktur, Gamma Camera (inklusive Szintigraphie und SPECT-Scanner),Linearbeschleuniger (Radiotherapie),MRI\nanzahl_gerate, Anzahl der Ger\u00e4te, None\nanzahl_untersuchungen_total, Anzahl aller Untersuchungen, None\nanzahl_ambulante_untersuchungen, Anzahl der ambulanten Untersuchungen, None\nanzahl_stationare_untersuchungen, Anzahl der station\u00e4ren Untersuchungen, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWelchem drei Kantone hatte den gr\u00f6ssten Zuwachs und Untersuchungen mit medizinischen Ger\u00e4ten zwischen 2013 and 2021 und wieviel hoch war der Zuwachs verteilt auf ambulante und station\u00e4re Untersuchungen und Ger\u00e4te?\n### SQL query\nWITH Untersuchungen2013 AS (\nSELECT SUM(T1.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2013,\n  SUM(T1.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2013,\n  SUM(T1.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2013,\n  SUM(T1.anzahl_gerate) as anzahl_gerate_2013,\n  S1.name_de as kanton\n    FROM medizinisch_technische_infrastruktur as T1\n    JOIN spatial_unit as S1 on T1.spatialunit_uid = S1.spatialunit_uid\n    WHERE S1.canton = 'TRUE'\n      AND T1.jahr = 2013\n    GROUP BY S1.name_de\n),\nUntersuchungen2021 AS (\n    SELECT SUM(T2.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2021,\n      SUM(T2.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2021,\n      SUM(T2.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2021,\n      SUM(T2.anzahl_gerate) as anzahl_gerate_2021,\n      S2.name_de as kanton2021\n    FROM medizinisch_technische_infrastruktur as T2\n    JOIN spatial_unit as S2 on T2.spatialunit_uid = S2.spatialunit_uid\n    WHERE S2.canton = 'TRUE'\n      AND T2.jahr = 2021\n    GROUP BY S2.name_de\n)\nSELECT\n    U2013.kanton,\n    U2021.anzahl_untersuchungen_gesamt_2021 - U2013.anzahl_untersuchungen_gesamt_2013 AS zuwachs_untersuchungen_gesamt,\n    U2021.anzahl_ambulante_untersuchungen_2021 - U2013.anzahl_ambulante_untersuchungen_2013 AS zuwachs_ambulante_untersuchungen,\n    U2021.anzahl_stationare_untersuchungen_2021 - U2013.anzahl_stationare_untersuchungen_2013 AS zuwachs_statinon\u00e4re_untersuchungen,\n    U2021.anzahl_gerate_2021 - U2013.anzahl_gerate_2013 AS zuwachs_geraete\nFROM Untersuchungen2013 AS U2013\nJOIN Untersuchungen2021 AS U2021 ON U2013.kanton = U2021.kanton2021\nORDER BY zuwachs_untersuchungen_gesamt DESC\nLIMIT 3;\n\n\n### Question\nWelche f\u00fcnf Kantone machte 2021 den besten Nutzen von seiner CT Scanner mit den meisten Untersuchungen pro CT Scanner und wieviele Untersuchungen gab es pro Ger\u00e4t und auf wieviele Ger\u00e4te verteilten sie sich?\n### SQL query\nSELECT S.name_de as kanton_mit_meisten_untersuchungen_pro_geraet,\n  ROUND(SUM(T.anzahl_untersuchungen_total) / SUM(T.anzahl_gerate), 0) as untersuchungen_pro_geraet,\n  SUM(T.anzahl_gerate) as anzahl_geraete\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.jahr = 2021\n  AND T.genutzte_infrastruktur LIKE 'CT%'\n  AND T.anzahl_gerate != 0\nGROUP BY S.name_de\nORDER BY untersuchungen_pro_geraet DESC LIMIT 5;\n\n\n### Question\nWelches war das medizinische Ger\u00e4t 2021 in der Schweiz mit den meisten Untersuchungen und wieviele Untersuchungen gab es damit?\n### SQL query\n",
    "process_time": 6.556228193920106,
    "num_tokens": 2051,
    "hardness": "unknown",
    "scores": [
      0.651204526424408,
      0.7698683142662048
    ],
    "lang": "de"
  },
  {
    "i": 63,
    "question": "Welche f\u00fcnf Kantone hatte 2021 die gr\u00f6sste medizinische Infrastruktur mit den meisten Ger\u00e4ten und wieviele Ger\u00e4te waren es?",
    "query": "SELECT S.name_de as kanton_mit_groesster_medizinischer_infrastruktur, SUM(T.anzahl_gerate) as anzahl_geraete\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY anzahl_geraete DESC LIMIT 5;\n",
    "db_id": "medizinisch_technische_infrastruktur",
    "generated_query": "SELECT SUM(T.anzahl_gerate) as gerate_anzahl, S.name_de as kanton\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY gerate_anzahl DESC\nLIMIT 5;",
    "meta_data": [
      {
        "question": "Welche medizinischen Ger\u00e4te z\u00e4hlen in der Schweiz zur medizinischen Infrastruktur und wieviele gab es davon jeweils 2020? Sortiere nach Ger\u00e4teanzahl.",
        "query": "SELECT SUM(T.anzahl_gerate) as gerate_anzahl_2020, T.genutzte_infrastruktur\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.jahr = 2020\nGROUP BY T.genutzte_infrastruktur\nORDER BY gerate_anzahl_2020 DESC;\n",
        "score": 0.5350779294967651
      },
      {
        "question": "Welchem drei Kantone hatte den gr\u00f6ssten Zuwachs und Untersuchungen mit medizinischen Ger\u00e4ten zwischen 2013 and 2021 und wieviel hoch war der Zuwachs verteilt auf ambulante und station\u00e4re Untersuchungen und Ger\u00e4te?",
        "query": "WITH Untersuchungen2013 AS (\nSELECT SUM(T1.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2013,\n  SUM(T1.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2013,\n  SUM(T1.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2013,\n  SUM(T1.anzahl_gerate) as anzahl_gerate_2013,\n  S1.name_de as kanton\n    FROM medizinisch_technische_infrastruktur as T1\n    JOIN spatial_unit as S1 on T1.spatialunit_uid = S1.spatialunit_uid\n    WHERE S1.canton = 'TRUE'\n      AND T1.jahr = 2013\n    GROUP BY S1.name_de\n),\nUntersuchungen2021 AS (\n    SELECT SUM(T2.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2021,\n      SUM(T2.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2021,\n      SUM(T2.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2021,\n      SUM(T2.anzahl_gerate) as anzahl_gerate_2021,\n      S2.name_de as kanton2021\n    FROM medizinisch_technische_infrastruktur as T2\n    JOIN spatial_unit as S2 on T2.spatialunit_uid = S2.spatialunit_uid\n    WHERE S2.canton = 'TRUE'\n      AND T2.jahr = 2021\n    GROUP BY S2.name_de\n)\nSELECT\n    U2013.kanton,\n    U2021.anzahl_untersuchungen_gesamt_2021 - U2013.anzahl_untersuchungen_gesamt_2013 AS zuwachs_untersuchungen_gesamt,\n    U2021.anzahl_ambulante_untersuchungen_2021 - U2013.anzahl_ambulante_untersuchungen_2013 AS zuwachs_ambulante_untersuchungen,\n    U2021.anzahl_stationare_untersuchungen_2021 - U2013.anzahl_stationare_untersuchungen_2013 AS zuwachs_statinon\u00e4re_untersuchungen,\n    U2021.anzahl_gerate_2021 - U2013.anzahl_gerate_2013 AS zuwachs_geraete\nFROM Untersuchungen2013 AS U2013\nJOIN Untersuchungen2021 AS U2021 ON U2013.kanton = U2021.kanton2021\nORDER BY zuwachs_untersuchungen_gesamt DESC\nLIMIT 3;\n",
        "score": 0.572678804397583
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.medizinisch_technische_infrastruktur (\n\tuid SERIAL NOT NULL, \n\tgenutzte_infrastruktur TEXT, \n\tjahr INTEGER, \n\tanzahl_gerate NUMERIC, \n\tanzahl_untersuchungen_total NUMERIC, \n\tanzahl_ambulante_untersuchungen NUMERIC, \n\tanzahl_stationare_untersuchungen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT medizinisch_technische_infrastruktur_pkey PRIMARY KEY (uid), \n\tCONSTRAINT medizinisch_technische_infrastruktur_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in medizinisch_technische_infrastruktur and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nanzahl_gerate : 21, 228, 219, 136, 5\nanzahl_untersuchungen_total : 21943, 59151, 8484, 15915, 23013\nanzahl_ambulante_untersuchungen : 149, 4313, 2264, 5191, 338\nanzahl_stationare_untersuchungen : 62619, 2624, 4477, 4154, 35581\nspatialunit_uid : 19_A.ADM1, 1_A.ADM1, 10_A.ADM1, 24_A.ADM1, 13_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\ngenutzte_infrastruktur, genutzte Infrastruktur, Gamma Camera (inklusive Szintigraphie und SPECT-Scanner),Linearbeschleuniger (Radiotherapie),MRI\nanzahl_gerate, Anzahl der Ger\u00e4te, None\nanzahl_untersuchungen_total, Anzahl aller Untersuchungen, None\nanzahl_ambulante_untersuchungen, Anzahl der ambulanten Untersuchungen, None\nanzahl_stationare_untersuchungen, Anzahl der station\u00e4ren Untersuchungen, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWelchem drei Kantone hatte den gr\u00f6ssten Zuwachs und Untersuchungen mit medizinischen Ger\u00e4ten zwischen 2013 and 2021 und wieviel hoch war der Zuwachs verteilt auf ambulante und station\u00e4re Untersuchungen und Ger\u00e4te?\n### SQL query\nWITH Untersuchungen2013 AS (\nSELECT SUM(T1.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2013,\n  SUM(T1.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2013,\n  SUM(T1.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2013,\n  SUM(T1.anzahl_gerate) as anzahl_gerate_2013,\n  S1.name_de as kanton\n    FROM medizinisch_technische_infrastruktur as T1\n    JOIN spatial_unit as S1 on T1.spatialunit_uid = S1.spatialunit_uid\n    WHERE S1.canton = 'TRUE'\n      AND T1.jahr = 2013\n    GROUP BY S1.name_de\n),\nUntersuchungen2021 AS (\n    SELECT SUM(T2.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2021,\n      SUM(T2.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2021,\n      SUM(T2.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2021,\n      SUM(T2.anzahl_gerate) as anzahl_gerate_2021,\n      S2.name_de as kanton2021\n    FROM medizinisch_technische_infrastruktur as T2\n    JOIN spatial_unit as S2 on T2.spatialunit_uid = S2.spatialunit_uid\n    WHERE S2.canton = 'TRUE'\n      AND T2.jahr = 2021\n    GROUP BY S2.name_de\n)\nSELECT\n    U2013.kanton,\n    U2021.anzahl_untersuchungen_gesamt_2021 - U2013.anzahl_untersuchungen_gesamt_2013 AS zuwachs_untersuchungen_gesamt,\n    U2021.anzahl_ambulante_untersuchungen_2021 - U2013.anzahl_ambulante_untersuchungen_2013 AS zuwachs_ambulante_untersuchungen,\n    U2021.anzahl_stationare_untersuchungen_2021 - U2013.anzahl_stationare_untersuchungen_2013 AS zuwachs_statinon\u00e4re_untersuchungen,\n    U2021.anzahl_gerate_2021 - U2013.anzahl_gerate_2013 AS zuwachs_geraete\nFROM Untersuchungen2013 AS U2013\nJOIN Untersuchungen2021 AS U2021 ON U2013.kanton = U2021.kanton2021\nORDER BY zuwachs_untersuchungen_gesamt DESC\nLIMIT 3;\n\n\n### Question\nWelche medizinischen Ger\u00e4te z\u00e4hlen in der Schweiz zur medizinischen Infrastruktur und wieviele gab es davon jeweils 2020? Sortiere nach Ger\u00e4teanzahl.\n### SQL query\nSELECT SUM(T.anzahl_gerate) as gerate_anzahl_2020, T.genutzte_infrastruktur\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.jahr = 2020\nGROUP BY T.genutzte_infrastruktur\nORDER BY gerate_anzahl_2020 DESC;\n\n\n### Question\nWelche f\u00fcnf Kantone hatte 2021 die gr\u00f6sste medizinische Infrastruktur mit den meisten Ger\u00e4ten und wieviele Ger\u00e4te waren es?\n### SQL query\n",
    "process_time": 7.778141747927293,
    "num_tokens": 1972,
    "hardness": "unknown",
    "scores": [
      0.5350779294967651,
      0.572678804397583
    ],
    "lang": "de"
  },
  {
    "i": 64,
    "question": "Welcher Vorlage in welchem Jahr hatte die meisten Nein Stimmen und bei welcher Wahlbeteiligung und wievielen Ja Stimmen in Prozent?",
    "query": "SELECT T.vorlage, T.jahr, T.anzahl_nein_stimmen AS hoechste_anzahl_nein_stimmen, T.beteiligung_in_prozent, T.ja_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\nORDER BY hoechste_anzahl_nein_stimmen DESC LIMIT 1;\n",
    "db_id": "volksabstimmung_nach_kanton_seit_1861",
    "generated_query": "SELECT T.vorlage, T.jahr, T.anzahl_nein_stimmen, T.beteiligung_in_prozent, T.ja_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.anzahl_nein_stimmen = (SELECT MAX(anzahl_nein_stimmen) FROM volksabstimmung_nach_kanton_seit_1861)\n  AND T.ja_in_prozent IS NOT NULL;",
    "meta_data": [
      {
        "question": "Welche Vorlage in welchem Jahr und welchem Kanton bekam jemals die h\u00f6chste Annahme in Prozent und wie hoch war diese Annahme bei welcher Wahlbeteiligung?",
        "query": "SELECT T.vorlage, T.jahr, S.name_de AS kanton, T.ja_in_prozent as hoechste_annahme, T.beteiligung_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.ja_in_prozent IS NOT NULL\nORDER BY hoechste_annahme DESC LIMIT 1;\n",
        "score": 0.4624883532524109
      },
      {
        "question": "Welche Volksabstimmung und in welchem Jahr hatte die wenigsten g\u00fcltigen Stimmenzettel? Wieviele waren es? Und wie hoch war die Wahlbeteiligung?",
        "query": "SELECT T.vorlage AS vorlage_mit_wenigsten_gueltigen_stimmenzetteln, T.jahr,\n  MIN(T.anzahl_gueltige_stimmzettel) AS anzahl_gueltige_stimmzettel, T.beteiligung_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE' AND S.name_de = 'Schweiz'\nGROUP BY T.vorlage, T.jahr, T.beteiligung_in_prozent\nORDER BY anzahl_gueltige_stimmzettel ASC LIMIT 1;\n",
        "score": 0.7632470726966858
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.volksabstimmung_nach_kanton_seit_1861 (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tvorlage TEXT, \n\tanzahl_stimmberechtigte NUMERIC, \n\tanzahl_abgegebene_stimmen NUMERIC, \n\tbeteiligung_in_prozent NUMERIC, \n\tanzahl_gueltige_stimmzettel NUMERIC, \n\tanzahl_ja_stimmen NUMERIC, \n\tanzahl_nein_stimmen NUMERIC, \n\tja_in_prozent NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT volksabstimmung_nach_kanton_seit_1861_pkey PRIMARY KEY (uid), \n\tCONSTRAINT volksabstimmung_nach_kanton_seit_1861_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in volksabstimmung_nach_kanton_seit_1861 and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 2006, 2002, 2005, 2017\nvorlage : Bundesbeschluss \u00fcber den B\u00fcrgerrechtserwerb von Ausl\u00e4nderinnen und Ausl\u00e4ndern der dritten Generation, Bundesgesetz \u00fcber Radio und Fernsehen, Volksinitiative \u00abF\u00fcr gesunde sowie umweltfreundlich und fair hergestellte Lebensmittel (Fair-Food-Initiative)\u00bb, Bundesbeschluss \u00fcber eine befristete Zusatzfinanzierung der Invalidenversicherung durch Anhebung der Mehrwertsteuers\u00e4tze, \u00c4nderung des Bundesgesetzes \u00fcber die Verrechnungssteuer (St\u00e4rkung des Fremdkapitalmarkts)\nanzahl_stimmberechtigte : 4744197, 4836712, 4764659, 5528244, 4957778\nanzahl_abgegebene_stimmen : 2298492, 2314490, 2531209, 2028856, 2584840\nbeteiligung_in_prozent : 46.5099999999999980, 53.5499999999999972, 59.7000000000000028, 52.6300000000000026, 59.3400000000000034\nanzahl_gueltige_stimmzettel : 2298548, 2303703, 2579766, 2253395, 2407385\nanzahl_ja_stimmen : 343008, 628301, 2480870, 755561, 1319276\nanzahl_nein_stimmen : 1713501, 1762811, 611331, 1395812, 1462659\nja_in_prozent : 55.97999999999999687, 72.93999999999999773, 38.28999999999999915, 54.60999999999999943, 48.29999999999999716\n*/\n\n/*\nColumn name, Column discription, Example values\nvorlage, Titel der Abstimmungsvorlage, Bundesgesetz \u00fcber die Errichtung der schweizerischen Bundesbank,Bundesbeschluss betreffend Revision von Art. 103 der Bundesverfassung und Aufnahme eines Artikels 114bis in die Bundesverfassung,Volksinitiative \u00abf\u00fcr die vermehrte Mitbestimmung der Bundesversammlung und des Schweizervolkes im Nationalstrassenbau\u00bb\nanzahl_stimmberechtigte, Anzahl Stimmberechtigte, None\nanzahl_abgegebene_stimmen, Anzahl abgegebene Stimmenen, None\nbeteiligung_in_prozent, Wahlbeteiligung in Prozent, None\nanzahl_gueltige_stimmzettel, Anzahl g\u00fcltige Stimmenzettel, None\nanzahl_ja_stimmen, Anzahl ja Stimmen, None\nanzahl_nein_stimmen, Anzahl nein Stimmen, None\nja_in_prozent, ja Stimmen in Prozent der Gesamtstimmen, None\n*/\n\n\n\n### Question\nWelche Volksabstimmung und in welchem Jahr hatte die wenigsten g\u00fcltigen Stimmenzettel? Wieviele waren es? Und wie hoch war die Wahlbeteiligung?\n### SQL query\nSELECT T.vorlage AS vorlage_mit_wenigsten_gueltigen_stimmenzetteln, T.jahr,\n  MIN(T.anzahl_gueltige_stimmzettel) AS anzahl_gueltige_stimmzettel, T.beteiligung_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE' AND S.name_de = 'Schweiz'\nGROUP BY T.vorlage, T.jahr, T.beteiligung_in_prozent\nORDER BY anzahl_gueltige_stimmzettel ASC LIMIT 1;\n\n\n### Question\nWelche Vorlage in welchem Jahr und welchem Kanton bekam jemals die h\u00f6chste Annahme in Prozent und wie hoch war diese Annahme bei welcher Wahlbeteiligung?\n### SQL query\nSELECT T.vorlage, T.jahr, S.name_de AS kanton, T.ja_in_prozent as hoechste_annahme, T.beteiligung_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.ja_in_prozent IS NOT NULL\nORDER BY hoechste_annahme DESC LIMIT 1;\n\n\n### Question\nWelcher Vorlage in welchem Jahr hatte die meisten Nein Stimmen und bei welcher Wahlbeteiligung und wievielen Ja Stimmen in Prozent?\n### SQL query\n",
    "process_time": 9.053952357033268,
    "num_tokens": 1933,
    "hardness": "unknown",
    "scores": [
      0.4624883532524109,
      0.7632470726966858
    ],
    "lang": "de"
  },
  {
    "i": 65,
    "question": "Welches waren die drei Volksabstimmung mit der h\u00f6chsten Beteiligung, wann fanden sie statt und wie hoch war die Beteiligung in Prozent?",
    "query": "SELECT T.jahr, MAX(T.beteiligung_in_prozent) AS hoechste_beteiligung_in_prozent, T.vorlage\nFROM volksabstimmung_nach_kanton_seit_1861 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.beteiligung_in_prozent IS NOT NULL\nGROUP BY T.jahr, T.vorlage\nORDER BY hoechste_beteiligung_in_prozent DESC\nLIMIT 3;\n",
    "db_id": "volksabstimmung_nach_kanton_seit_1861",
    "generated_query": "SELECT T.vorlage AS volksabstimmung, T.jahr, T.beteiligung_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE' AND S.name_de = 'Schweiz'\nORDER BY T.beteiligung_in_prozent DESC LIMIT 3;",
    "meta_data": [
      {
        "question": "Welches Jahr hatte die meisten Volksabstimmungen und wieviele Volksabstimmungen gab es da?",
        "query": "SELECT T.jahr as jahr_mit_den_meisten_volksabstimmungen, COUNT(*) as anzahl_volksabstimmungen\nFROM volksabstimmung_nach_kanton_seit_1861 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nGROUP BY T.jahr\nORDER BY anzahl_volksabstimmungen DESC LIMIT 1;\n",
        "score": 0.9526447057723999
      },
      {
        "question": "Welche Vorlagen hatten mit dem Klima zu tun, wann fanden sie statt, wie waren Beteiligung und Ergebnis?",
        "query": "SELECT T.vorlage, T.jahr, T.beteiligung_in_prozent, T.ja_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND LOWER(T.vorlage) LIKE '%klima%';\n",
        "score": 0.9608111381530762
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.volksabstimmung_nach_kanton_seit_1861 (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tvorlage TEXT, \n\tanzahl_stimmberechtigte NUMERIC, \n\tanzahl_abgegebene_stimmen NUMERIC, \n\tbeteiligung_in_prozent NUMERIC, \n\tanzahl_gueltige_stimmzettel NUMERIC, \n\tanzahl_ja_stimmen NUMERIC, \n\tanzahl_nein_stimmen NUMERIC, \n\tja_in_prozent NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT volksabstimmung_nach_kanton_seit_1861_pkey PRIMARY KEY (uid), \n\tCONSTRAINT volksabstimmung_nach_kanton_seit_1861_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in volksabstimmung_nach_kanton_seit_1861 and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 2006, 2002, 2005, 2017\nvorlage : Bundesbeschluss \u00fcber den B\u00fcrgerrechtserwerb von Ausl\u00e4nderinnen und Ausl\u00e4ndern der dritten Generation, Bundesgesetz \u00fcber Radio und Fernsehen, Volksinitiative \u00abF\u00fcr gesunde sowie umweltfreundlich und fair hergestellte Lebensmittel (Fair-Food-Initiative)\u00bb, Bundesbeschluss \u00fcber eine befristete Zusatzfinanzierung der Invalidenversicherung durch Anhebung der Mehrwertsteuers\u00e4tze, \u00c4nderung des Bundesgesetzes \u00fcber die Verrechnungssteuer (St\u00e4rkung des Fremdkapitalmarkts)\nanzahl_stimmberechtigte : 4744197, 4836712, 4764659, 5528244, 4957778\nanzahl_abgegebene_stimmen : 2298492, 2314490, 2531209, 2028856, 2584840\nbeteiligung_in_prozent : 46.5099999999999980, 53.5499999999999972, 59.7000000000000028, 52.6300000000000026, 59.3400000000000034\nanzahl_gueltige_stimmzettel : 2298548, 2303703, 2579766, 2253395, 2407385\nanzahl_ja_stimmen : 343008, 628301, 2480870, 755561, 1319276\nanzahl_nein_stimmen : 1713501, 1762811, 611331, 1395812, 1462659\nja_in_prozent : 55.97999999999999687, 72.93999999999999773, 38.28999999999999915, 54.60999999999999943, 48.29999999999999716\n*/\n\n/*\nColumn name, Column discription, Example values\nvorlage, Titel der Abstimmungsvorlage, Bundesgesetz \u00fcber die Errichtung der schweizerischen Bundesbank,Bundesbeschluss betreffend Revision von Art. 103 der Bundesverfassung und Aufnahme eines Artikels 114bis in die Bundesverfassung,Volksinitiative \u00abf\u00fcr die vermehrte Mitbestimmung der Bundesversammlung und des Schweizervolkes im Nationalstrassenbau\u00bb\nanzahl_stimmberechtigte, Anzahl Stimmberechtigte, None\nanzahl_abgegebene_stimmen, Anzahl abgegebene Stimmenen, None\nbeteiligung_in_prozent, Wahlbeteiligung in Prozent, None\nanzahl_gueltige_stimmzettel, Anzahl g\u00fcltige Stimmenzettel, None\nanzahl_ja_stimmen, Anzahl ja Stimmen, None\nanzahl_nein_stimmen, Anzahl nein Stimmen, None\nja_in_prozent, ja Stimmen in Prozent der Gesamtstimmen, None\n*/\n\n\n\n### Question\nWelches Jahr hatte die meisten Volksabstimmungen und wieviele Volksabstimmungen gab es da?\n### SQL query\nSELECT T.jahr as jahr_mit_den_meisten_volksabstimmungen, COUNT(*) as anzahl_volksabstimmungen\nFROM volksabstimmung_nach_kanton_seit_1861 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nGROUP BY T.jahr\nORDER BY anzahl_volksabstimmungen DESC LIMIT 1;\n\n\n### Question\nWelche Volksabstimmung und in welchem Jahr hatte die wenigsten g\u00fcltigen Stimmenzettel? Wieviele waren es? Und wie hoch war die Wahlbeteiligung?\n### SQL query\nSELECT T.vorlage AS vorlage_mit_wenigsten_gueltigen_stimmenzetteln, T.jahr,\n  MIN(T.anzahl_gueltige_stimmzettel) AS anzahl_gueltige_stimmzettel, T.beteiligung_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE' AND S.name_de = 'Schweiz'\nGROUP BY T.vorlage, T.jahr, T.beteiligung_in_prozent\nORDER BY anzahl_gueltige_stimmzettel ASC LIMIT 1;\n\n\n### Question\nWelches waren die drei Volksabstimmung mit der h\u00f6chsten Beteiligung, wann fanden sie statt und wie hoch war die Beteiligung in Prozent?\n### SQL query\n",
    "process_time": 7.204819620819762,
    "num_tokens": 1915,
    "hardness": "unknown",
    "scores": [
      0.9526447057723999,
      0.9608111381530762
    ],
    "lang": "de"
  },
  {
    "i": 66,
    "question": "Welches ist aktuellest Vorlage die schweizweit angenommen wurde, aber bei der in der Mehrheit der Kanton dagegen gestimmt wurde? Zeige auch wieviel Prozent Ja Stimmen sie Schweiz weit bekam.",
    "query": "SELECT T.vorlage,\n  MAX(CASE WHEN T.ja_in_prozent > 50 AND S.country = 'TRUE' THEN T.ja_in_prozent ELSE NULL END) AS angenommen_gesamt,\n  COUNT(CASE WHEN T.ja_in_prozent > 50 AND S.canton = 'TRUE' THEN 1 ELSE NULL END) AS angenommen_in,\n  COUNT(CASE WHEN T.ja_in_prozent <= 50 AND S.canton = 'TRUE' THEN 1 ELSE NULL END) AS abgelehnt_in\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.vorlage, T.jahr\nHAVING MAX(CASE WHEN T.ja_in_prozent > 50 AND S.country = 'TRUE' THEN T.ja_in_prozent ELSE NULL END) IS NOT NULL\n   AND COUNT(CASE WHEN T.ja_in_prozent <= 50 AND S.canton = 'TRUE' THEN 1 ELSE NULL END) > COUNT(CASE WHEN T.ja_in_prozent > 50 AND S.canton = 'TRUE' THEN 1 ELSE NULL END)\nORDER BY T.jahr DESC LIMIT 1;\n",
    "db_id": "volksabstimmung_nach_kanton_seit_1861",
    "generated_query": "SELECT T.vorlage AS aktuellste_angenommene_vorlage, T.jahr, T.ja_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE' AND T.ja_in_prozent > 50\nGROUP BY T.vorlage, T.jahr, T.ja_in_prozent\nHAVING COUNT(CASE WHEN T.ja_in_prozent <= 50 THEN 1 END) > COUNT(CASE WHEN T.ja_in_prozent > 50 THEN 1 END)\nORDER BY T.jahr DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Wieviel Prozent der Vorlagen wurden angenommen und wieviel Prozent wurden zur\u00fcckgewiesen?",
        "query": "SELECT\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent > 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_angenommene_vorlagen,\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent <= 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_zurueckgewiesene_vorlagen\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE';\n",
        "score": 0.8819408416748047
      },
      {
        "question": "Welche Vorlage in welchem Jahr und welchem Kanton bekam jemals die h\u00f6chste Annahme in Prozent und wie hoch war diese Annahme bei welcher Wahlbeteiligung?",
        "query": "SELECT T.vorlage, T.jahr, S.name_de AS kanton, T.ja_in_prozent as hoechste_annahme, T.beteiligung_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.ja_in_prozent IS NOT NULL\nORDER BY hoechste_annahme DESC LIMIT 1;\n",
        "score": 1.130817174911499
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.volksabstimmung_nach_kanton_seit_1861 (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tvorlage TEXT, \n\tanzahl_stimmberechtigte NUMERIC, \n\tanzahl_abgegebene_stimmen NUMERIC, \n\tbeteiligung_in_prozent NUMERIC, \n\tanzahl_gueltige_stimmzettel NUMERIC, \n\tanzahl_ja_stimmen NUMERIC, \n\tanzahl_nein_stimmen NUMERIC, \n\tja_in_prozent NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT volksabstimmung_nach_kanton_seit_1861_pkey PRIMARY KEY (uid), \n\tCONSTRAINT volksabstimmung_nach_kanton_seit_1861_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in volksabstimmung_nach_kanton_seit_1861 and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 2006, 2002, 2005, 2017\nvorlage : Bundesbeschluss \u00fcber den B\u00fcrgerrechtserwerb von Ausl\u00e4nderinnen und Ausl\u00e4ndern der dritten Generation, Bundesgesetz \u00fcber Radio und Fernsehen, Volksinitiative \u00abF\u00fcr gesunde sowie umweltfreundlich und fair hergestellte Lebensmittel (Fair-Food-Initiative)\u00bb, Bundesbeschluss \u00fcber eine befristete Zusatzfinanzierung der Invalidenversicherung durch Anhebung der Mehrwertsteuers\u00e4tze, \u00c4nderung des Bundesgesetzes \u00fcber die Verrechnungssteuer (St\u00e4rkung des Fremdkapitalmarkts)\nanzahl_stimmberechtigte : 4744197, 4836712, 4764659, 5528244, 4957778\nanzahl_abgegebene_stimmen : 2298492, 2314490, 2531209, 2028856, 2584840\nbeteiligung_in_prozent : 46.5099999999999980, 53.5499999999999972, 59.7000000000000028, 52.6300000000000026, 59.3400000000000034\nanzahl_gueltige_stimmzettel : 2298548, 2303703, 2579766, 2253395, 2407385\nanzahl_ja_stimmen : 343008, 628301, 2480870, 755561, 1319276\nanzahl_nein_stimmen : 1713501, 1762811, 611331, 1395812, 1462659\nja_in_prozent : 55.97999999999999687, 72.93999999999999773, 38.28999999999999915, 54.60999999999999943, 48.29999999999999716\n*/\n\n/*\nColumn name, Column discription, Example values\nvorlage, Titel der Abstimmungsvorlage, Bundesgesetz \u00fcber die Errichtung der schweizerischen Bundesbank,Bundesbeschluss betreffend Revision von Art. 103 der Bundesverfassung und Aufnahme eines Artikels 114bis in die Bundesverfassung,Volksinitiative \u00abf\u00fcr die vermehrte Mitbestimmung der Bundesversammlung und des Schweizervolkes im Nationalstrassenbau\u00bb\nanzahl_stimmberechtigte, Anzahl Stimmberechtigte, None\nanzahl_abgegebene_stimmen, Anzahl abgegebene Stimmenen, None\nbeteiligung_in_prozent, Wahlbeteiligung in Prozent, None\nanzahl_gueltige_stimmzettel, Anzahl g\u00fcltige Stimmenzettel, None\nanzahl_ja_stimmen, Anzahl ja Stimmen, None\nanzahl_nein_stimmen, Anzahl nein Stimmen, None\nja_in_prozent, ja Stimmen in Prozent der Gesamtstimmen, None\n*/\n\n\n\n### Question\nWelche Kantone haben 2023 gegen das Bundesgesetz \u00fcber Klimaschutz gestimmt und wieviel Prozent Ja Stimmen gab es dort jeweils?\n### SQL query\nSELECT S.name_de as kanton_gegen_klimaschutzgesetz, T.ja_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nAND LOWER(T.vorlage) LIKE '%bundesgesetz%klimaschutz%' AND T.jahr = 2023\nAND T.ja_in_prozent <= 50\nGROUP BY S.name_de, T.vorlage, T.jahr, T.ja_in_prozent;\n\n\n### Question\nWelche Volksabstimmung und in welchem Jahr hatte die wenigsten g\u00fcltigen Stimmenzettel? Wieviele waren es? Und wie hoch war die Wahlbeteiligung?\n### SQL query\nSELECT T.vorlage AS vorlage_mit_wenigsten_gueltigen_stimmenzetteln, T.jahr,\n  MIN(T.anzahl_gueltige_stimmzettel) AS anzahl_gueltige_stimmzettel, T.beteiligung_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE' AND S.name_de = 'Schweiz'\nGROUP BY T.vorlage, T.jahr, T.beteiligung_in_prozent\nORDER BY anzahl_gueltige_stimmzettel ASC LIMIT 1;\n\n\n### Question\nWelches ist aktuellest Vorlage die schweizweit angenommen wurde, aber bei der in der Mehrheit der Kanton dagegen gestimmt wurde? Zeige auch wieviel Prozent Ja Stimmen sie Schweiz weit bekam.\n### SQL query\n",
    "process_time": 10.675858282949775,
    "num_tokens": 1967,
    "hardness": "unknown",
    "scores": [
      0.8819408416748047,
      1.130817174911499
    ],
    "lang": "de"
  },
  {
    "i": 67,
    "question": "Zeigen Sie mir den Gesamtstromverbrauch der Gemeinden in Basel-Landschaft im Jahr 2000 gegen\u00fcber 2020.",
    "query": "SELECT T.jahr , SUM(T.endverbrauch_elektrizitaet_mwh) as gesamt_endverbrauch_elektrizitaet_mwh_2020\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2000, 2020)\nGROUP BY T.jahr\nORDER BY gesamt_endverbrauch_elektrizitaet_mwh_2020 DESC;\n",
    "db_id": "basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr",
    "generated_query": "SELECT T.jahr, SUM(T.endverbrauch_elektrizitaet_mwh) as gesamt_endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND (T.jahr = 2000 OR T.jahr = 2020)\nGROUP BY T.jahr\nORDER BY T.jahr DESC;",
    "meta_data": [
      {
        "question": "Wie hoch war der durchschnittliche j\u00e4hrliche Stromverbrauch der Gemeinden im Kanton Basel-Landschaft in den Jahren 2000 bis 2020?",
        "query": "SELECT T.jahr , AVG(T.endverbrauch_elektrizitaet_mwh) as mittlerer_endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr >= 2000\n    AND T.jahr <= 2020\nGROUP BY T.jahr\nORDER BY T.jahr DESC;\n",
        "score": 0.35751402378082275
      },
      {
        "question": "Welche drei Gemeinden in Basel-Landschaft hatten im Jahr 2012 den geringsten Stromverbrauch?",
        "query": "SELECT S.name AS gemeinde, T.endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2012\nORDER BY endverbrauch_elektrizitaet_mwh ASC\nLIMIT 3;\n",
        "score": 0.4182516634464264
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tendverbrauch_elektrizitaet_mwh NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und__pkey1 PRIMARY KEY (uid), \n\tCONSTRAINT basel_land_endverbrauch_von_ektrizitat_na_spatialunit_uid_fkey1 FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nendverbrauch_elektrizitaet_mwh : 1364.00000000000000, 2664.00000000000000, 6421.00000000000000, 6186.00000000000000, 4860.00000000000000\nspatialunit_uid : 2792_A.ADM3, 2828_A.ADM3, 2831_A.ADM3, 2826_A.ADM3, 2885_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nendverbrauch_elektrizitaet_mwh, Endverbrauch Elektrizitaet Mwh, 536937258529674\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWie hoch war der durchschnittliche j\u00e4hrliche Stromverbrauch der Gemeinden im Kanton Basel-Landschaft in den Jahren 2000 bis 2020?\n### SQL query\nSELECT T.jahr , AVG(T.endverbrauch_elektrizitaet_mwh) as mittlerer_endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr >= 2000\n    AND T.jahr <= 2020\nGROUP BY T.jahr\nORDER BY T.jahr DESC;\n\n\n### Question\nWelche drei Gemeinden in Basel-Landschaft hatten im Jahr 2012 den geringsten Stromverbrauch?\n### SQL query\nSELECT S.name AS gemeinde, T.endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2012\nORDER BY endverbrauch_elektrizitaet_mwh ASC\nLIMIT 3;\n\n\n### Question\nZeigen Sie mir den Gesamtstromverbrauch der Gemeinden in Basel-Landschaft im Jahr 2000 gegen\u00fcber 2020.\n### SQL query\n",
    "process_time": 9.158699846128002,
    "num_tokens": 1291,
    "hardness": "unknown",
    "scores": [
      0.35751402378082275,
      0.4182516634464264
    ],
    "lang": "de"
  },
  {
    "i": 68,
    "question": "Welche der Gemeinden Bottmingen und Birsfelden in Basel-Landschaft hatte 2018 den h\u00f6chsten Stromverbrauch?",
    "query": "SELECT S.name AS gemeinde, T.endverbrauch_elektrizitaet_mwh as endverbrauch_elektrizitaet_mwh_2018\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2018\n    AND S.name IN ('Blauen', 'Blauen (BL)', 'Birsfelden', 'Birsfelden (BL)')\nORDER BY T.endverbrauch_elektrizitaet_mwh DESC;\n",
    "db_id": "basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr",
    "generated_query": "SELECT S.name AS gemeinde, T.endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2018\n    AND (S.name = 'Bottmingen' OR S.name = 'Birsfelden')\nORDER BY endverbrauch_elektrizitaet_mwh DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Welche drei Gemeinden in Basel-Landschaft hatten im Jahr 2012 den geringsten Stromverbrauch?",
        "query": "SELECT S.name AS gemeinde, T.endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2012\nORDER BY endverbrauch_elektrizitaet_mwh ASC\nLIMIT 3;\n",
        "score": 0.20328521728515625
      },
      {
        "question": "Welche Gemeinde in Basel-Landschaft hatte 1995 den h\u00f6chsten Stromverbrauch?",
        "query": "SELECT S.name AS gemeinde, T.endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 1995\nORDER BY endverbrauch_elektrizitaet_mwh DESC\nLIMIT 1;\n",
        "score": 0.26501086354255676
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tendverbrauch_elektrizitaet_mwh NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und__pkey1 PRIMARY KEY (uid), \n\tCONSTRAINT basel_land_endverbrauch_von_ektrizitat_na_spatialunit_uid_fkey1 FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nendverbrauch_elektrizitaet_mwh : 1364.00000000000000, 2664.00000000000000, 6421.00000000000000, 6186.00000000000000, 4860.00000000000000\nspatialunit_uid : 2792_A.ADM3, 2828_A.ADM3, 2831_A.ADM3, 2826_A.ADM3, 2885_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nendverbrauch_elektrizitaet_mwh, Endverbrauch Elektrizitaet Mwh, 536937258529674\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWelche drei Gemeinden in Basel-Landschaft hatten im Jahr 2012 den geringsten Stromverbrauch?\n### SQL query\nSELECT S.name AS gemeinde, T.endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2012\nORDER BY endverbrauch_elektrizitaet_mwh ASC\nLIMIT 3;\n\n\n### Question\nWelche Gemeinde in Basel-Landschaft hatte 1995 den h\u00f6chsten Stromverbrauch?\n### SQL query\nSELECT S.name AS gemeinde, T.endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 1995\nORDER BY endverbrauch_elektrizitaet_mwh DESC\nLIMIT 1;\n\n\n### Question\nWelche der Gemeinden Bottmingen und Birsfelden in Basel-Landschaft hatte 2018 den h\u00f6chsten Stromverbrauch?\n### SQL query\n",
    "process_time": 13.448790300171822,
    "num_tokens": 1259,
    "hardness": "unknown",
    "scores": [
      0.20328521728515625,
      0.26501086354255676
    ],
    "lang": "de"
  },
  {
    "i": 69,
    "question": "Wie viele Reformierte gab es im Kanton Basel-Landschaft in 2022?",
    "query": "SELECT SUM(T.anzahl_evangelisch_reformiert)\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2022;\n",
    "db_id": "basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde",
    "generated_query": "SELECT SUM(anzahl_evangelisch_reformiert) as number_reformed_evangelics\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde\nWHERE jahr = 2022;",
    "meta_data": [
      {
        "question": "Welche 5 Gemeinden hatten 2008 den h\u00f6chsten Anteil an Reformierten im Kanton Basel-Landschaft?",
        "query": "SELECT S.name, CAST(SUM(T.anzahl_evangelisch_reformiert) AS FLOAT) / SUM(T.gesamt_anzahl_personen) as proportion_protestants_2008\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2008\nGROUP BY S.name\nORDER BY proportion_protestants_2008 DESC\nLIMIT 5;\n",
        "score": 0.3614574372768402
      },
      {
        "question": "Wie hat sich die Anzahl der Reformierten in Allschwil, im Kanton Basel-Landschaft, zwischen 2010 und 2015 entwickelt?",
        "query": "SELECT T.jahr, SUM(T.anzahl_evangelisch_reformiert) as number_reformed_evangelics\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Allschwil', 'Allschwil (BL)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2015\nGROUP BY T.jahr;\n",
        "score": 0.4452488422393799
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tnationalitat TEXT, \n\tanzahl_evangelisch_reformiert NUMERIC, \n\tanzahl_romisch_katholisch NUMERIC, \n\tanzahl_christkatholisch NUMERIC, \n\tanzahl_unbekannt_konfession NUMERIC, \n\tgesamt_anzahl_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_land_bevolkerung_nach_nationalitat_konfession_gemein_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_land_bevolkerung_nach_nationalitat_k_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nanzahl_evangelisch_reformiert : 228, 1206, 416, 814, 352\nanzahl_romisch_katholisch : 416, 5303, 2620, 727, 36\nanzahl_christkatholisch : 24, 5, 46, 77, 4\nanzahl_unbekannt_konfession : 299, 352, 46, 669, 36\ngesamt_anzahl_personen : 1170, 886, 505, 1666, 737\nspatialunit_uid : 2792_A.ADM3, 2828_A.ADM3, 2831_A.ADM3, 2826_A.ADM3, 2885_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nnationalitat, Nationalit\u00e4t, Schweiz,Ausland\ngesamt_anzahl_personen, Gesamtanzahl Personen, None\n\u200banzahl_evangelisch_reformiert, Anzahl Evangelisch-Reformierten, None\n\u200banzahl_romisch_katholisch, Anzahl der R\u00f6misch-Katholischen, None\nanzahl_christkatholisch, Anzahl der Christkatholischen, None\nanzahl_unbekannt_konfession, Anzahl der Personen mit unbekannter Konfession, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWelche 5 Gemeinden hatten 2008 den h\u00f6chsten Anteil an Reformierten im Kanton Basel-Landschaft?\n### SQL query\nSELECT S.name, CAST(SUM(T.anzahl_evangelisch_reformiert) AS FLOAT) / SUM(T.gesamt_anzahl_personen) as proportion_protestants_2008\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2008\nGROUP BY S.name\nORDER BY proportion_protestants_2008 DESC\nLIMIT 5;\n\n\n### Question\nWie hat sich die Anzahl der Reformierten in Allschwil, im Kanton Basel-Landschaft, zwischen 2010 und 2015 entwickelt?\n### SQL query\nSELECT T.jahr, SUM(T.anzahl_evangelisch_reformiert) as number_reformed_evangelics\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Allschwil', 'Allschwil (BL)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2015\nGROUP BY T.jahr;\n\n\n### Question\nWie viele Reformierte gab es im Kanton Basel-Landschaft in 2022?\n### SQL query\n",
    "process_time": 4.622462844941765,
    "num_tokens": 1474,
    "hardness": "medium",
    "scores": [
      0.3614574372768402,
      0.4452488422393799
    ],
    "lang": "de"
  },
  {
    "i": 70,
    "question": "Zwischen den Gemeinden Arlesheim und Birsfelden im Kanton Basel-Landschaft, welche hatte 2003 einen h\u00f6heren Anteil an Protestanten?",
    "query": "SELECT S.name AS gemeinde, CAST(SUM(T.anzahl_evangelisch_reformiert) AS FLOAT) / SUM(T.gesamt_anzahl_personen) as proportion_protestants_2003\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Ettingen', 'Ettingen (BL)', 'Birsfelden', 'Birsfelden (BL)')\n    AND T.jahr = 2003\nGROUP BY S.name\nORDER BY proportion_protestants_2003 DESC;\n",
    "db_id": "basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde",
    "generated_query": "SELECT \n    CASE WHEN T1.protestant_proportion > T2.protestant_proportion THEN 'Arlesheim' ELSE 'Birsfelden' END AS municipality_with_higher_protestant_proportion_2003\nFROM (\n    SELECT \n        T.spatialunit_uid,\n        (T.anzahl_evangelisch_reformiert / T.gesamt_anzahl_personen) AS protestant_proportion\n    FROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.name = 'Arlesheim'\n        AND T.jahr = 2003\n) AS T1\nJOIN (\n    SELECT \n        T.spatialunit_uid,\n        (T.anzahl_evangelisch_reformiert / T.gesamt_anzahl_personen) AS protestant_proportion\n    FROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.name = 'Birsfelden'\n        AND T.jahr = 2003\n) AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid;",
    "meta_data": [
      {
        "question": "Wie hoch war der Anteil der Gemeinden im Kanton Basel-Landschaft, in denen es 2018 mehr Katholiken als Protestanten unter der Schweizer Bev\u00f6lkerung gab?",
        "query": "SELECT SUM(\n    CASE WHEN (T1.anzahl_romisch_katholisch + T1.anzahl_christkatholisch) > T1.anzahl_evangelisch_reformiert THEN 1 ELSE 0 END\n) / CAST(COUNT(T1.anzahl_evangelisch_reformiert) AS FLOAT) AS proprtion_municipalities_more_catholics_than_reformed_2018\nFROM (\n    SELECT\n        S.name as municipality,\n        AVG(T.anzahl_christkatholisch) as anzahl_christkatholisch,\n        AVG(T.anzahl_romisch_katholisch) as anzahl_romisch_katholisch,\n        AVG(T.anzahl_evangelisch_reformiert) as anzahl_evangelisch_reformiert\n    FROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2018\n        AND T.nationalitat = 'Schweiz'\n    GROUP BY S.name\n) AS T1;\n",
        "score": 0.38774412870407104
      },
      {
        "question": "Welcher Anteil der Bev\u00f6lkerung von Basel-Landschaft geh\u00f6rte 2021 einer bekannten Religion an?",
        "query": "SELECT 1 - (\n    SUM(CAST(T.anzahl_unbekannt_konfession AS FLOAT)) / SUM(T.gesamt_anzahl_personen)\n) AS proportion_known_religion_basel_land_2021\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nGROUP BY T.jahr;\n",
        "score": 0.4720832109451294
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tnationalitat TEXT, \n\tanzahl_evangelisch_reformiert NUMERIC, \n\tanzahl_romisch_katholisch NUMERIC, \n\tanzahl_christkatholisch NUMERIC, \n\tanzahl_unbekannt_konfession NUMERIC, \n\tgesamt_anzahl_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_land_bevolkerung_nach_nationalitat_konfession_gemein_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_land_bevolkerung_nach_nationalitat_k_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nanzahl_evangelisch_reformiert : 228, 1206, 416, 814, 352\nanzahl_romisch_katholisch : 416, 5303, 2620, 727, 36\nanzahl_christkatholisch : 24, 5, 46, 77, 4\nanzahl_unbekannt_konfession : 299, 352, 46, 669, 36\ngesamt_anzahl_personen : 1170, 886, 505, 1666, 737\nspatialunit_uid : 2792_A.ADM3, 2828_A.ADM3, 2831_A.ADM3, 2826_A.ADM3, 2885_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nnationalitat, Nationalit\u00e4t, Schweiz,Ausland\ngesamt_anzahl_personen, Gesamtanzahl Personen, None\n\u200banzahl_evangelisch_reformiert, Anzahl Evangelisch-Reformierten, None\n\u200banzahl_romisch_katholisch, Anzahl der R\u00f6misch-Katholischen, None\nanzahl_christkatholisch, Anzahl der Christkatholischen, None\nanzahl_unbekannt_konfession, Anzahl der Personen mit unbekannter Konfession, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWelcher Anteil der Bev\u00f6lkerung von Basel-Landschaft geh\u00f6rte 2021 einer bekannten Religion an?\n### SQL query\nSELECT 1 - (\n    SUM(CAST(T.anzahl_unbekannt_konfession AS FLOAT)) / SUM(T.gesamt_anzahl_personen)\n) AS proportion_known_religion_basel_land_2021\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nGROUP BY T.jahr;\n\n\n### Question\nWie hoch war der Anteil der Gemeinden im Kanton Basel-Landschaft, in denen es 2018 mehr Katholiken als Protestanten unter der Schweizer Bev\u00f6lkerung gab?\n### SQL query\nSELECT SUM(\n    CASE WHEN (T1.anzahl_romisch_katholisch + T1.anzahl_christkatholisch) > T1.anzahl_evangelisch_reformiert THEN 1 ELSE 0 END\n) / CAST(COUNT(T1.anzahl_evangelisch_reformiert) AS FLOAT) AS proprtion_municipalities_more_catholics_than_reformed_2018\nFROM (\n    SELECT\n        S.name as municipality,\n        AVG(T.anzahl_christkatholisch) as anzahl_christkatholisch,\n        AVG(T.anzahl_romisch_katholisch) as anzahl_romisch_katholisch,\n        AVG(T.anzahl_evangelisch_reformiert) as anzahl_evangelisch_reformiert\n    FROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2018\n        AND T.nationalitat = 'Schweiz'\n    GROUP BY S.name\n) AS T1;\n\n\n### Question\nZwischen den Gemeinden Arlesheim und Birsfelden im Kanton Basel-Landschaft, welche hatte 2003 einen h\u00f6heren Anteil an Protestanten?\n### SQL query\n",
    "process_time": 27.07979819807224,
    "num_tokens": 1626,
    "hardness": "unknown",
    "scores": [
      0.38774412870407104,
      0.4720832109451294
    ],
    "lang": "de"
  },
  {
    "i": 71,
    "question": "Wie hoch war der Anteil der r\u00f6misch-katholischen Personen an der ausl\u00e4ndischen Bev\u00f6lkerung des Kantons Basel-Landschaft im Jahr 2021?",
    "query": "SELECT SUM(CAST(T.anzahl_romisch_katholisch AS FLOAT)) / SUM(T.gesamt_anzahl_personen) AS proportion_foreign_romisch_katholisch_basel_land_2021\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\n    AND T.nationalitat = 'Ausland';\n",
    "db_id": "basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde",
    "generated_query": "SELECT (\n    SUM(T.anzahl_romisch_katholisch) / SUM(T.gesamt_anzahl_personen)\n) AS proportion_roman_catholics_foreign_population_2021\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.nationalitat = 'Ausland'\n    AND T.jahr = 2021\nGROUP BY T.jahr;",
    "meta_data": [
      {
        "question": "Wie hoch war der Anteil der Gemeinden im Kanton Basel-Landschaft, in denen es 2018 mehr Katholiken als Protestanten unter der Schweizer Bev\u00f6lkerung gab?",
        "query": "SELECT SUM(\n    CASE WHEN (T1.anzahl_romisch_katholisch + T1.anzahl_christkatholisch) > T1.anzahl_evangelisch_reformiert THEN 1 ELSE 0 END\n) / CAST(COUNT(T1.anzahl_evangelisch_reformiert) AS FLOAT) AS proprtion_municipalities_more_catholics_than_reformed_2018\nFROM (\n    SELECT\n        S.name as municipality,\n        AVG(T.anzahl_christkatholisch) as anzahl_christkatholisch,\n        AVG(T.anzahl_romisch_katholisch) as anzahl_romisch_katholisch,\n        AVG(T.anzahl_evangelisch_reformiert) as anzahl_evangelisch_reformiert\n    FROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2018\n        AND T.nationalitat = 'Schweiz'\n    GROUP BY S.name\n) AS T1;\n",
        "score": 0.47244295477867126
      },
      {
        "question": "Welcher Anteil der Bev\u00f6lkerung von Basel-Landschaft geh\u00f6rte 2021 einer bekannten Religion an?",
        "query": "SELECT 1 - (\n    SUM(CAST(T.anzahl_unbekannt_konfession AS FLOAT)) / SUM(T.gesamt_anzahl_personen)\n) AS proportion_known_religion_basel_land_2021\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nGROUP BY T.jahr;\n",
        "score": 0.4828452467918396
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tnationalitat TEXT, \n\tanzahl_evangelisch_reformiert NUMERIC, \n\tanzahl_romisch_katholisch NUMERIC, \n\tanzahl_christkatholisch NUMERIC, \n\tanzahl_unbekannt_konfession NUMERIC, \n\tgesamt_anzahl_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_land_bevolkerung_nach_nationalitat_konfession_gemein_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_land_bevolkerung_nach_nationalitat_k_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nanzahl_evangelisch_reformiert : 228, 1206, 416, 814, 352\nanzahl_romisch_katholisch : 416, 5303, 2620, 727, 36\nanzahl_christkatholisch : 24, 5, 46, 77, 4\nanzahl_unbekannt_konfession : 299, 352, 46, 669, 36\ngesamt_anzahl_personen : 1170, 886, 505, 1666, 737\nspatialunit_uid : 2792_A.ADM3, 2828_A.ADM3, 2831_A.ADM3, 2826_A.ADM3, 2885_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nnationalitat, Nationalit\u00e4t, Schweiz,Ausland\ngesamt_anzahl_personen, Gesamtanzahl Personen, None\n\u200banzahl_evangelisch_reformiert, Anzahl Evangelisch-Reformierten, None\n\u200banzahl_romisch_katholisch, Anzahl der R\u00f6misch-Katholischen, None\nanzahl_christkatholisch, Anzahl der Christkatholischen, None\nanzahl_unbekannt_konfession, Anzahl der Personen mit unbekannter Konfession, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWelche 5 Gemeinden hatten 2008 den h\u00f6chsten Anteil an Reformierten im Kanton Basel-Landschaft?\n### SQL query\nSELECT S.name, CAST(SUM(T.anzahl_evangelisch_reformiert) AS FLOAT) / SUM(T.gesamt_anzahl_personen) as proportion_protestants_2008\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2008\nGROUP BY S.name\nORDER BY proportion_protestants_2008 DESC\nLIMIT 5;\n\n\n### Question\nWelcher Anteil der Bev\u00f6lkerung von Basel-Landschaft geh\u00f6rte 2021 einer bekannten Religion an?\n### SQL query\nSELECT 1 - (\n    SUM(CAST(T.anzahl_unbekannt_konfession AS FLOAT)) / SUM(T.gesamt_anzahl_personen)\n) AS proportion_known_religion_basel_land_2021\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nGROUP BY T.jahr;\n\n\n### Question\nWie hoch war der Anteil der r\u00f6misch-katholischen Personen an der ausl\u00e4ndischen Bev\u00f6lkerung des Kantons Basel-Landschaft im Jahr 2021?\n### SQL query\n",
    "process_time": 14.316927650943398,
    "num_tokens": 1485,
    "hardness": "unknown",
    "scores": [
      0.47244295477867126,
      0.4828452467918396
    ],
    "lang": "de"
  },
  {
    "i": 72,
    "question": "Welches waren im Jahr 2022 die 3 Gemeinden mit dem h\u00f6chsten Ausl\u00e4nderanteil im Kanton Basel-Landschaft?",
    "query": "SELECT S.name AS gemeinde, SUM(CASE WHEN T.nationalitat = 'Ausland' THEN T.gesamt_anzahl_personen ELSE 0 END) / CAST(SUM(T.gesamt_anzahl_personen) AS FLOAT) AS proportion_foreign_residents\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2022\nGROUP BY S.name\nORDER BY proportion_foreign_residents DESC\nLIMIT 3;\n",
    "db_id": "basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde",
    "generated_query": "SELECT S.name, CAST(SUM(T.gesamt_anzahl_personen - T.anzahl_evangelisch_reformiert - T.anzahl_romisch_katholisch) AS FLOAT) / SUM(T.gesamt_anzahl_personen) as proportion_foreigners_2022\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2022\nGROUP BY S.name\nORDER BY proportion_foreigners_2022 DESC\nLIMIT 3;",
    "meta_data": [
      {
        "question": "Welche 5 Gemeinden hatten 2008 den h\u00f6chsten Anteil an Reformierten im Kanton Basel-Landschaft?",
        "query": "SELECT S.name, CAST(SUM(T.anzahl_evangelisch_reformiert) AS FLOAT) / SUM(T.gesamt_anzahl_personen) as proportion_protestants_2008\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2008\nGROUP BY S.name\nORDER BY proportion_protestants_2008 DESC\nLIMIT 5;\n",
        "score": 0.40058183670043945
      },
      {
        "question": "Wie hat sich die Anzahl der Reformierten in Allschwil, im Kanton Basel-Landschaft, zwischen 2010 und 2015 entwickelt?",
        "query": "SELECT T.jahr, SUM(T.anzahl_evangelisch_reformiert) as number_reformed_evangelics\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Allschwil', 'Allschwil (BL)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2015\nGROUP BY T.jahr;\n",
        "score": 0.6339861154556274
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tnationalitat TEXT, \n\tanzahl_evangelisch_reformiert NUMERIC, \n\tanzahl_romisch_katholisch NUMERIC, \n\tanzahl_christkatholisch NUMERIC, \n\tanzahl_unbekannt_konfession NUMERIC, \n\tgesamt_anzahl_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_land_bevolkerung_nach_nationalitat_konfession_gemein_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_land_bevolkerung_nach_nationalitat_k_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nanzahl_evangelisch_reformiert : 228, 1206, 416, 814, 352\nanzahl_romisch_katholisch : 416, 5303, 2620, 727, 36\nanzahl_christkatholisch : 24, 5, 46, 77, 4\nanzahl_unbekannt_konfession : 299, 352, 46, 669, 36\ngesamt_anzahl_personen : 1170, 886, 505, 1666, 737\nspatialunit_uid : 2792_A.ADM3, 2828_A.ADM3, 2831_A.ADM3, 2826_A.ADM3, 2885_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nnationalitat, Nationalit\u00e4t, Schweiz,Ausland\ngesamt_anzahl_personen, Gesamtanzahl Personen, None\n\u200banzahl_evangelisch_reformiert, Anzahl Evangelisch-Reformierten, None\n\u200banzahl_romisch_katholisch, Anzahl der R\u00f6misch-Katholischen, None\nanzahl_christkatholisch, Anzahl der Christkatholischen, None\nanzahl_unbekannt_konfession, Anzahl der Personen mit unbekannter Konfession, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWelche 5 Gemeinden hatten 2008 den h\u00f6chsten Anteil an Reformierten im Kanton Basel-Landschaft?\n### SQL query\nSELECT S.name, CAST(SUM(T.anzahl_evangelisch_reformiert) AS FLOAT) / SUM(T.gesamt_anzahl_personen) as proportion_protestants_2008\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2008\nGROUP BY S.name\nORDER BY proportion_protestants_2008 DESC\nLIMIT 5;\n\n\n### Question\nWie hat sich die Anzahl der Reformierten in Allschwil, im Kanton Basel-Landschaft, zwischen 2010 und 2015 entwickelt?\n### SQL query\nSELECT T.jahr, SUM(T.anzahl_evangelisch_reformiert) as number_reformed_evangelics\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Allschwil', 'Allschwil (BL)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2015\nGROUP BY T.jahr;\n\n\n### Question\nWelches waren im Jahr 2022 die 3 Gemeinden mit dem h\u00f6chsten Ausl\u00e4nderanteil im Kanton Basel-Landschaft?\n### SQL query\n",
    "process_time": 9.239295509178191,
    "num_tokens": 1487,
    "hardness": "unknown",
    "scores": [
      0.40058183670043945,
      0.6339861154556274
    ],
    "lang": "de"
  },
  {
    "i": 73,
    "question": "In welchem Jahr wurde die meiste Wohnfl\u00e4che im Kanton Basel-Landschaft gekauft?",
    "query": "SELECT T.jahr\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nGROUP BY T.jahr\nORDER BY SUM(T.flache_in_m2) DESC\nLIMIT 1;\n",
    "db_id": "basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr",
    "generated_query": "SELECT T.jahr AS kaufjahr, SUM(T.flache_in_m2) AS gesamtflache\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nGROUP BY T.jahr\nORDER BY gesamtflache DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Wie viele Wohnbaul\u00e4nder wurden 2018 in Basel-Landschaft gekauft?",
        "query": "SELECT SUM(T.falle) AS anzahl_wohnbaulander_basel_landschaft_2018\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018;\n",
        "score": 0.41611313819885254
      },
      {
        "question": "Welche Gemeinde in Basel-Landschaft hatte 2022 das teuerste Bauland?",
        "query": "SELECT S.name AS gemeinde\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2022\nORDER BY T.quadratmeterpreis_chf DESC\nLIMIT 1;\n",
        "score": 0.6361940503120422
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tfalle NUMERIC, \n\tflache_in_m2 NUMERIC, \n\tquadratmeterpreis_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_land_quadratmeterpreis_wohnbauland_n_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 1980, 1992, 1990, 1979, 1989\nfalle : 21, 24, 5, 36, 4\nflache_in_m2 : 7800, 4000, 5400, 9800, 12400\nquadratmeterpreis_chf : 672, 586, 418, 278, 352\nspatialunit_uid : 2815_A.ADM3, 2813_A.ADM3, 2801_A.ADM3, 2811_A.ADM3, 2812_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nfalle, F\u00e4lle, 17329\nflache_in_m2, Fl\u00e4che in m2, 12300104004700\nquadratmeterpreis_chf, Quadratmeterpreis in CHF, 213266221\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWie viele Wohnbaul\u00e4nder wurden 2018 in Basel-Landschaft gekauft?\n### SQL query\nSELECT SUM(T.falle) AS anzahl_wohnbaulander_basel_landschaft_2018\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018;\n\n\n### Question\nWelche Gemeinde in Basel-Landschaft hatte 2022 das teuerste Bauland?\n### SQL query\nSELECT S.name AS gemeinde\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2022\nORDER BY T.quadratmeterpreis_chf DESC\nLIMIT 1;\n\n\n### Question\nIn welchem Jahr wurde die meiste Wohnfl\u00e4che im Kanton Basel-Landschaft gekauft?\n### SQL query\n",
    "process_time": 8.294370343908668,
    "num_tokens": 1256,
    "hardness": "hard",
    "scores": [
      0.41611313819885254,
      0.6361940503120422
    ],
    "lang": "de"
  },
  {
    "i": 74,
    "question": "Zeigen Sie mir den Preis f\u00fcr Wohnbauland in Basel-Landschaft, dessen Name mit A beginnt, im Jahr 2012.",
    "query": "SELECT S.name, T.quadratmeterpreis_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2008\n    AND S.name LIKE 'A%'\nLIMIT 10;\n",
    "db_id": "basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr",
    "generated_query": "SELECT T.quadratmeterpreis_chf AS preis\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE 'A%'\n    AND T.jahr = 2012;",
    "meta_data": [
      {
        "question": "Zeigen Sie mir den Preis f\u00fcr Wohnbauland in Muttenz, Birsfelden und Schonenbuch, in Basel-Landschaft im Jahr 1983.",
        "query": "SELECT S.name, T.quadratmeterpreis_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 1983\n    AND S.name IN ('Muttenz', 'Muttens (BL)', 'Bottmingen', 'Bottmingen (BL)', 'Binningen', 'Binningen (BL)');\n",
        "score": 0.20556223392486572
      },
      {
        "question": "In welcher Gemeinde des Kantons Basel-Landschaft ist der Preis f\u00fcr Wohnbauland zwischen 2010 und 2020 am st\u00e4rksten gestiegen, und um wie viel ist er gestiegen?",
        "query": "SELECT\n    S.name AS gemeinde,\n    (\n        SUM(CASE WHEN T.jahr = 2020 THEN T.quadratmeterpreis_chf ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2010 THEN T.quadratmeterpreis_chf ELSE 0 END)\n    ) AS preisanderung_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2010, 2020)\nGROUP BY S.name\nORDER BY preisanderung_chf DESC\nLIMIT 1;\n",
        "score": 0.4163059592247009
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tfalle NUMERIC, \n\tflache_in_m2 NUMERIC, \n\tquadratmeterpreis_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_land_quadratmeterpreis_wohnbauland_n_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 1980, 1992, 1990, 1979, 1989\nfalle : 21, 24, 5, 36, 4\nflache_in_m2 : 7800, 4000, 5400, 9800, 12400\nquadratmeterpreis_chf : 672, 586, 418, 278, 352\nspatialunit_uid : 2815_A.ADM3, 2813_A.ADM3, 2801_A.ADM3, 2811_A.ADM3, 2812_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nfalle, F\u00e4lle, 17329\nflache_in_m2, Fl\u00e4che in m2, 12300104004700\nquadratmeterpreis_chf, Quadratmeterpreis in CHF, 213266221\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWie viele Wohnbaul\u00e4nder wurden 2018 in Basel-Landschaft gekauft?\n### SQL query\nSELECT SUM(T.falle) AS anzahl_wohnbaulander_basel_landschaft_2018\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018;\n\n\n### Question\nWelche Gemeinde in Basel-Landschaft hatte 2022 das teuerste Bauland?\n### SQL query\nSELECT S.name AS gemeinde\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2022\nORDER BY T.quadratmeterpreis_chf DESC\nLIMIT 1;\n\n\n### Question\nZeigen Sie mir den Preis f\u00fcr Wohnbauland in Basel-Landschaft, dessen Name mit A beginnt, im Jahr 2012.\n### SQL query\n",
    "process_time": 8.685394536005333,
    "num_tokens": 1265,
    "hardness": "extra",
    "scores": [
      0.20556223392486572,
      0.4163059592247009
    ],
    "lang": "de"
  },
  {
    "i": 75,
    "question": "Wie viel kostete ein Quadratmeter Wohnbauland in den f\u00fcnf teuersten Gemeinden von Basel-Landschaft im Jahr 2005?",
    "query": "SELECT S.name AS gemeinde, T.quadratmeterpreis_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2005\nORDER BY T.quadratmeterpreis_chf DESC\nLIMIT 5;\n",
    "db_id": "basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr",
    "generated_query": "SELECT S.name AS gemeinde, T.quadratmeterpreis_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2005\nORDER BY T.quadratmeterpreis_chf DESC\nLIMIT 5;",
    "meta_data": [
      {
        "question": "Welche Gemeinde in Basel-Landschaft hatte 2022 das teuerste Bauland?",
        "query": "SELECT S.name AS gemeinde\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2022\nORDER BY T.quadratmeterpreis_chf DESC\nLIMIT 1;\n",
        "score": 0.6987091302871704
      },
      {
        "question": "Wie viele Wohnbaul\u00e4nder wurden 2018 in Basel-Landschaft gekauft?",
        "query": "SELECT SUM(T.falle) AS anzahl_wohnbaulander_basel_landschaft_2018\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018;\n",
        "score": 0.7228835225105286
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tfalle NUMERIC, \n\tflache_in_m2 NUMERIC, \n\tquadratmeterpreis_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_land_quadratmeterpreis_wohnbauland_n_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 1980, 1992, 1990, 1979, 1989\nfalle : 21, 24, 5, 36, 4\nflache_in_m2 : 7800, 4000, 5400, 9800, 12400\nquadratmeterpreis_chf : 672, 586, 418, 278, 352\nspatialunit_uid : 2815_A.ADM3, 2813_A.ADM3, 2801_A.ADM3, 2811_A.ADM3, 2812_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nfalle, F\u00e4lle, 17329\nflache_in_m2, Fl\u00e4che in m2, 12300104004700\nquadratmeterpreis_chf, Quadratmeterpreis in CHF, 213266221\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWelche Gemeinde in Basel-Landschaft hatte 2022 das teuerste Bauland?\n### SQL query\nSELECT S.name AS gemeinde\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2022\nORDER BY T.quadratmeterpreis_chf DESC\nLIMIT 1;\n\n\n### Question\nWie viele Wohnbaul\u00e4nder wurden 2018 in Basel-Landschaft gekauft?\n### SQL query\nSELECT SUM(T.falle) AS anzahl_wohnbaulander_basel_landschaft_2018\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018;\n\n\n### Question\nWie viel kostete ein Quadratmeter Wohnbauland in den f\u00fcnf teuersten Gemeinden von Basel-Landschaft im Jahr 2005?\n### SQL query\n",
    "process_time": 9.405480138026178,
    "num_tokens": 1266,
    "hardness": "unknown",
    "scores": [
      0.6987091302871704,
      0.7228835225105286
    ],
    "lang": "de"
  },
  {
    "i": 76,
    "question": "Wie viel Wohnbauland wurde zwischen 2010 und 2012 in Pratteln, BL, gekauft?",
    "query": "SELECT SUM(T.flache_in_m2) as gesamt_flache_in_m2\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Pratteln', 'Pratteln (BL)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2012;\n",
    "db_id": "basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr",
    "generated_query": "SELECT SUM(T.flache_in_m2) AS flache_in_m2_pratteln_2010_2012\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Pratteln'\n    AND S.canton = 'TRUE'\n    AND T.jahr BETWEEN 2010 AND 2012;",
    "meta_data": [
      {
        "question": "Wie hoch war der Preis f\u00fcr Wohnbauland in Aesch im Jahr 1979 und 2020?",
        "query": "SELECT T.jahr, T.quadratmeterpreis_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Aesch', 'Aesch (BL)')\n    AND T.jahr IN (1980, 2020)\nLIMIT 10;",
        "score": 0.6380667686462402
      },
      {
        "question": "Welche Gemeinden in Basel-Landschaft hatten zwischen 2015 und 2019 einen R\u00fcckgang der Wohnbaulandpreise? Zeigen Sie auch die Preis\u00e4nderungen an.",
        "query": "SELECT T1.name AS gemeinde, T1.preisanderung_chf\nFROM (\n    SELECT\n        S.name,\n        (\n            SUM(CASE WHEN T.jahr = 2019 THEN T.quadratmeterpreis_chf ELSE 0 END) -\n            SUM(CASE WHEN T.jahr = 2015 THEN T.quadratmeterpreis_chf ELSE 0 END)\n        ) AS preisanderung_chf\n    FROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr <= 2015\n        AND T.jahr <= 2019\n    GROUP BY S.name\n) as T1\nWHERE T1.preisanderung_chf < 0\nORDER BY T1.preisanderung_chf ASC ;\n",
        "score": 0.8097681403160095
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tfalle NUMERIC, \n\tflache_in_m2 NUMERIC, \n\tquadratmeterpreis_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_land_quadratmeterpreis_wohnbauland_n_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 1980, 1992, 1990, 1979, 1989\nfalle : 21, 24, 5, 36, 4\nflache_in_m2 : 7800, 4000, 5400, 9800, 12400\nquadratmeterpreis_chf : 672, 586, 418, 278, 352\nspatialunit_uid : 2815_A.ADM3, 2813_A.ADM3, 2801_A.ADM3, 2811_A.ADM3, 2812_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nfalle, F\u00e4lle, 17329\nflache_in_m2, Fl\u00e4che in m2, 12300104004700\nquadratmeterpreis_chf, Quadratmeterpreis in CHF, 213266221\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWelche Gemeinde in Basel-Landschaft hatte 2022 das teuerste Bauland?\n### SQL query\nSELECT S.name AS gemeinde\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2022\nORDER BY T.quadratmeterpreis_chf DESC\nLIMIT 1;\n\n\n### Question\nWie viele Wohnbaul\u00e4nder wurden 2018 in Basel-Landschaft gekauft?\n### SQL query\nSELECT SUM(T.falle) AS anzahl_wohnbaulander_basel_landschaft_2018\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018;\n\n\n### Question\nWie viel Wohnbauland wurde zwischen 2010 und 2012 in Pratteln, BL, gekauft?\n### SQL query\n",
    "process_time": 10.20157848089002,
    "num_tokens": 1259,
    "hardness": "unknown",
    "scores": [
      0.6380667686462402,
      0.8097681403160095
    ],
    "lang": "de"
  },
  {
    "i": 77,
    "question": "Wie viele landwirtschaftliche Fahrzeuge gab es im Kanton Aargau im Jahr 2010?",
    "query": "SELECT anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name = 'Canton Aargau'\n    AND T.jahr = 2010;\n",
    "db_id": "aargau_privatverkehr_bestand_nach_fahrzeugarten",
    "generated_query": "SELECT SUM(anzahl_landwirtschaftliche_motorfahrzeuge)\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2010\n    AND S.canton = 'TRUE'\n    AND S.name = 'Aargau';",
    "meta_data": [
      {
        "question": "Wie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?",
        "query": "SELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n",
        "score": 0.24156877398490906
      },
      {
        "question": "Wie viele private Fahrzeuge gab es 2010 in Ueken im Kanton Aargau von jedem Typ?",
        "query": "SELECT\n    T.anzahl_anhaenger,\n    T.anzahl_arbeitsmotorfahrzeuge,\n    T.anzahl_klein_motorrader,\n    T.anzahl_kollektivfahrzeuge,\n    T.anzahl_landwirtschaftliche_motorfahrzeuge,\n    T.anzahl_motorfahrrader,\n    T.anzahl_motorrader,\n    T.anzahl_nutzfahrzeuge,\n    T.anzahl_personenwagen,\n    T.anzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2010\n    AND S.municipal = 'TRUE'\n    AND S.name IN ('Ueken', 'Ueken (AG)');\n",
        "score": 0.6796664595603943
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_privatverkehr_bestand_nach_fahrzeugarten (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanzahl_personenwagen NUMERIC, \n\tanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars NUMERIC, \n\tanzahl_nutzfahrzeuge NUMERIC, \n\tanzahl_arbeitsmotorfahrzeuge NUMERIC, \n\tanzahl_motorrader NUMERIC, \n\tanzahl_klein_motorrader NUMERIC, \n\tanzahl_motorfahrrader NUMERIC, \n\tanzahl_landwirtschaftliche_motorfahrzeuge NUMERIC, \n\tanzahl_anhaenger NUMERIC, \n\tanzahl_kollektivfahrzeuge NUMERIC, \n\tanzahl_personenwagen_pro_1000_einwohner NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeugarten_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeug_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_privatverkehr_bestand_nach_fahrzeugarten and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 1980, 2006, 1992, 2002\nanzahl_personenwagen : 157, 159, 10603, 352, 418\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars : 78, 5, 4, 99, 0\nanzahl_nutzfahrzeuge : 157, 1562, 416, 191, 278\nanzahl_arbeitsmotorfahrzeuge : 157, 159, 152, 5, 12\nanzahl_motorrader : 92, 78, 1104, 111, 12\nanzahl_klein_motorrader : 21, 71, 60, 24, 5\nanzahl_motorfahrrader : 191, 352, 46, 36, 30\nanzahl_landwirtschaftliche_motorfahrzeuge : 21, 92, 106, 61, 60\nanzahl_anhaenger : 886, 228, 78, 46, 111\nanzahl_kollektivfahrzeuge : 21, 60, 61, 24, 5\nanzahl_personenwagen_pro_1000_einwohner : 417.89999999999998, 503.00000000000000, 626.50000000000000, 503.19999999999999, 557.10000000000002\n*/\n\n/*\nColumn name, Column discription, Example values\nanzahl_personenwagen_pro_1000_einwohner, Motorisierungsgrad: Anzahl Personenwagen pro 1000 Einwonhner/-innen., 485.5,488.6,485.1\nanzahl_personenwagen, Anzahl Personenwagen, 10556,10618,10582\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars, Anzahl \u00dcbrige Personen Transportfahrzeuge (Kleinbusse, cars), 73,70,76\nanzahl_nutzfahrzeuge, Anzahl Nutzfahrzeuge, 1640,1617,1642\nanzahl_arbeitsmotorfahrzeuge, Anzahl Arbeitsmotorfahrzeuge, 142,152,159\nanzahl_motorrader, Anzahl Motorr\u00e4der, 1234,1225,1157\nanzahl_klein_motorrader, Anzahl kleine Motorr\u00e4der, 25,34,30\nanzahl_motorfahrrader, Anzahl Motorfahrr\u00e4der, 517,498,469\nanzahl_landwirtschaftliche_motorfahrzeuge, Anzahl Landwirtschaftliche Motorfahrzeuge, 46,49,45\nanzahl_anhaenger, Anzahl Anh\u00e4nger, 831,820,845\nanzahl_kollektivfahrzeuge, Anzahl Kollektivfahrzeuge, 53,56,55\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?\n### SQL query\nSELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n\n\n### Question\nWie viele private Fahrzeuge gab es 2010 in Ueken im Kanton Aargau von jedem Typ?\n### SQL query\nSELECT\n    T.anzahl_anhaenger,\n    T.anzahl_arbeitsmotorfahrzeuge,\n    T.anzahl_klein_motorrader,\n    T.anzahl_kollektivfahrzeuge,\n    T.anzahl_landwirtschaftliche_motorfahrzeuge,\n    T.anzahl_motorfahrrader,\n    T.anzahl_motorrader,\n    T.anzahl_nutzfahrzeuge,\n    T.anzahl_personenwagen,\n    T.anzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2010\n    AND S.municipal = 'TRUE'\n    AND S.name IN ('Ueken', 'Ueken (AG)');\n\n\n### Question\nWie viele landwirtschaftliche Fahrzeuge gab es im Kanton Aargau im Jahr 2010?\n### SQL query\n",
    "process_time": 9.491603911854327,
    "num_tokens": 1961,
    "hardness": "medium",
    "scores": [
      0.24156877398490906,
      0.6796664595603943
    ],
    "lang": "de"
  },
  {
    "i": 78,
    "question": "Wie hat sich der Bestand an Motorr\u00e4dern und Personenwagen im Kanton Aargau im Zeitraum zwischen 1930 und 1960 entwickelt?",
    "query": "SELECT T.jahr, anzahl_motorrader, anzahl_klein_motorrader, anzahl_motorfahrrader, anzahl_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name = 'Canton Aargau'\n    AND T.jahr >= 1930\n    AND T.jahr <= 1960;\n",
    "db_id": "aargau_privatverkehr_bestand_nach_fahrzeugarten",
    "generated_query": "SELECT\n    T.jahr,\n    SUM(T.anzahl_motorrader) AS anzahl_motorrader,\n    SUM(T.anzahl_personenwagen) AS anzahl_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr BETWEEN 1930 AND 1960\nGROUP BY T.jahr\nORDER BY T.jahr;",
    "meta_data": [
      {
        "question": "Wie viele Kleinmotorr\u00e4der gab es im Kanton Aargau zwischen 2000 und 2016?",
        "query": "SELECT T.jahr, T.anzahl_klein_motorrader\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr <= 2016\n    AND T.jahr >= 2000;\n",
        "score": 0.4289875030517578
      },
      {
        "question": "Gab es 1930 oder 1940 im Kanton Aargau mehr Personenwagen?",
        "query": "SELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr IN (1930, 1940)\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_personenwagen) DESC\nLIMIT 1;\n",
        "score": 0.5412313342094421
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_privatverkehr_bestand_nach_fahrzeugarten (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanzahl_personenwagen NUMERIC, \n\tanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars NUMERIC, \n\tanzahl_nutzfahrzeuge NUMERIC, \n\tanzahl_arbeitsmotorfahrzeuge NUMERIC, \n\tanzahl_motorrader NUMERIC, \n\tanzahl_klein_motorrader NUMERIC, \n\tanzahl_motorfahrrader NUMERIC, \n\tanzahl_landwirtschaftliche_motorfahrzeuge NUMERIC, \n\tanzahl_anhaenger NUMERIC, \n\tanzahl_kollektivfahrzeuge NUMERIC, \n\tanzahl_personenwagen_pro_1000_einwohner NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeugarten_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeug_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_privatverkehr_bestand_nach_fahrzeugarten and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 1980, 2006, 1992, 2002\nanzahl_personenwagen : 157, 159, 10603, 352, 418\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars : 78, 5, 4, 99, 0\nanzahl_nutzfahrzeuge : 157, 1562, 416, 191, 278\nanzahl_arbeitsmotorfahrzeuge : 157, 159, 152, 5, 12\nanzahl_motorrader : 92, 78, 1104, 111, 12\nanzahl_klein_motorrader : 21, 71, 60, 24, 5\nanzahl_motorfahrrader : 191, 352, 46, 36, 30\nanzahl_landwirtschaftliche_motorfahrzeuge : 21, 92, 106, 61, 60\nanzahl_anhaenger : 886, 228, 78, 46, 111\nanzahl_kollektivfahrzeuge : 21, 60, 61, 24, 5\nanzahl_personenwagen_pro_1000_einwohner : 417.89999999999998, 503.00000000000000, 626.50000000000000, 503.19999999999999, 557.10000000000002\n*/\n\n/*\nColumn name, Column discription, Example values\nanzahl_personenwagen_pro_1000_einwohner, Motorisierungsgrad: Anzahl Personenwagen pro 1000 Einwonhner/-innen., 485.5,488.6,485.1\nanzahl_personenwagen, Anzahl Personenwagen, 10556,10618,10582\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars, Anzahl \u00dcbrige Personen Transportfahrzeuge (Kleinbusse, cars), 73,70,76\nanzahl_nutzfahrzeuge, Anzahl Nutzfahrzeuge, 1640,1617,1642\nanzahl_arbeitsmotorfahrzeuge, Anzahl Arbeitsmotorfahrzeuge, 142,152,159\nanzahl_motorrader, Anzahl Motorr\u00e4der, 1234,1225,1157\nanzahl_klein_motorrader, Anzahl kleine Motorr\u00e4der, 25,34,30\nanzahl_motorfahrrader, Anzahl Motorfahrr\u00e4der, 517,498,469\nanzahl_landwirtschaftliche_motorfahrzeuge, Anzahl Landwirtschaftliche Motorfahrzeuge, 46,49,45\nanzahl_anhaenger, Anzahl Anh\u00e4nger, 831,820,845\nanzahl_kollektivfahrzeuge, Anzahl Kollektivfahrzeuge, 53,56,55\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWelches waren 2015 die Top-3-Gemeinden im Aargau mit dem h\u00f6chsten Anteil an Motorr\u00e4dern gegen\u00fcber Autos? Zeigen Sie auch die Proportionen.\n### SQL query\nSELECT\n    S.name as gemeinde,\n    CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen AS ratio_motorrader_to_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nORDER BY ratio_motorrader_to_personenwagen DESC\nLIMIT 3;\n\n\n### Question\nWelches waren die 5 Aargauer Gemeinden mit den wenigsten Motorr\u00e4dern pro Personenwagen im Jahr 2015?\n### SQL query\nSELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2015\n    AND S.municipal = 'TRUE'\nORDER BY CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen ASC\nLIMIT 5;\n\n\n### Question\nWie hat sich der Bestand an Motorr\u00e4dern und Personenwagen im Kanton Aargau im Zeitraum zwischen 1930 und 1960 entwickelt?\n### SQL query\n",
    "process_time": 11.77231063391082,
    "num_tokens": 1942,
    "hardness": "extra",
    "scores": [
      0.4289875030517578,
      0.5412313342094421
    ],
    "lang": "de"
  },
  {
    "i": 79,
    "question": "Welche Gemeinde im Kanton Aargau hatte im Jahr 2020 am meisten Autos pro Einwohner?",
    "query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.anzahl_personenwagen_pro_1000_einwohner DESC\nLIMIT 1;\n",
    "db_id": "aargau_privatverkehr_bestand_nach_fahrzeugarten",
    "generated_query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2020\n    AND S.canton = 'TRUE'\nORDER BY T.anzahl_personenwagen_pro_1000_einwohner DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Wie hoch ist der Anteil der Gemeinden im Kanton Aargau, in denen die Zahl der Autos pro Einwohner zwischen 2015 und 2022 zugenommen hat?",
        "query": "SELECT CAST(SUM(CASE WHEN T1.diff > 0 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(T1.diff) AS ratio_gemeinden_mit_zunahme_autos_pro_einwohner\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) as diff\n    FROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2015, 2022)\n    GROUP BY S.name\n) as T1;\n",
        "score": 0.2702813148498535
      },
      {
        "question": "Wie hat sich die Zahl der Autos pro Einwohner im Aargau im Zeitraum 2010 bis 2022 entwickelt?",
        "query": "SELECT T.jahr, T.anzahl_personenwagen_pro_1000_einwohner\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name = 'Canton Aargau'\n    AND T.jahr >= 2010\n    AND T.jahr <= 2022;\n",
        "score": 0.3191389739513397
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_privatverkehr_bestand_nach_fahrzeugarten (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanzahl_personenwagen NUMERIC, \n\tanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars NUMERIC, \n\tanzahl_nutzfahrzeuge NUMERIC, \n\tanzahl_arbeitsmotorfahrzeuge NUMERIC, \n\tanzahl_motorrader NUMERIC, \n\tanzahl_klein_motorrader NUMERIC, \n\tanzahl_motorfahrrader NUMERIC, \n\tanzahl_landwirtschaftliche_motorfahrzeuge NUMERIC, \n\tanzahl_anhaenger NUMERIC, \n\tanzahl_kollektivfahrzeuge NUMERIC, \n\tanzahl_personenwagen_pro_1000_einwohner NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeugarten_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeug_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_privatverkehr_bestand_nach_fahrzeugarten and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 1980, 2006, 1992, 2002\nanzahl_personenwagen : 157, 159, 10603, 352, 418\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars : 78, 5, 4, 99, 0\nanzahl_nutzfahrzeuge : 157, 1562, 416, 191, 278\nanzahl_arbeitsmotorfahrzeuge : 157, 159, 152, 5, 12\nanzahl_motorrader : 92, 78, 1104, 111, 12\nanzahl_klein_motorrader : 21, 71, 60, 24, 5\nanzahl_motorfahrrader : 191, 352, 46, 36, 30\nanzahl_landwirtschaftliche_motorfahrzeuge : 21, 92, 106, 61, 60\nanzahl_anhaenger : 886, 228, 78, 46, 111\nanzahl_kollektivfahrzeuge : 21, 60, 61, 24, 5\nanzahl_personenwagen_pro_1000_einwohner : 417.89999999999998, 503.00000000000000, 626.50000000000000, 503.19999999999999, 557.10000000000002\n*/\n\n/*\nColumn name, Column discription, Example values\nanzahl_personenwagen_pro_1000_einwohner, Motorisierungsgrad: Anzahl Personenwagen pro 1000 Einwonhner/-innen., 485.5,488.6,485.1\nanzahl_personenwagen, Anzahl Personenwagen, 10556,10618,10582\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars, Anzahl \u00dcbrige Personen Transportfahrzeuge (Kleinbusse, cars), 73,70,76\nanzahl_nutzfahrzeuge, Anzahl Nutzfahrzeuge, 1640,1617,1642\nanzahl_arbeitsmotorfahrzeuge, Anzahl Arbeitsmotorfahrzeuge, 142,152,159\nanzahl_motorrader, Anzahl Motorr\u00e4der, 1234,1225,1157\nanzahl_klein_motorrader, Anzahl kleine Motorr\u00e4der, 25,34,30\nanzahl_motorfahrrader, Anzahl Motorfahrr\u00e4der, 517,498,469\nanzahl_landwirtschaftliche_motorfahrzeuge, Anzahl Landwirtschaftliche Motorfahrzeuge, 46,49,45\nanzahl_anhaenger, Anzahl Anh\u00e4nger, 831,820,845\nanzahl_kollektivfahrzeuge, Anzahl Kollektivfahrzeuge, 53,56,55\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWelches waren 2015 die Top-3-Gemeinden im Aargau mit dem h\u00f6chsten Anteil an Motorr\u00e4dern gegen\u00fcber Autos? Zeigen Sie auch die Proportionen.\n### SQL query\nSELECT\n    S.name as gemeinde,\n    CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen AS ratio_motorrader_to_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nORDER BY ratio_motorrader_to_personenwagen DESC\nLIMIT 3;\n\n\n### Question\nWelches waren die 5 Aargauer Gemeinden mit den wenigsten Motorr\u00e4dern pro Personenwagen im Jahr 2015?\n### SQL query\nSELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2015\n    AND S.municipal = 'TRUE'\nORDER BY CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen ASC\nLIMIT 5;\n\n\n### Question\nWelche Gemeinde im Kanton Aargau hatte im Jahr 2020 am meisten Autos pro Einwohner?\n### SQL query\n",
    "process_time": 6.175977446837351,
    "num_tokens": 1931,
    "hardness": "unknown",
    "scores": [
      0.2702813148498535,
      0.3191389739513397
    ],
    "lang": "de"
  },
  {
    "i": 80,
    "question": "Wie hoch war die Zahl der Nutzfahrzeuge 1960 und 1980 im Kanton Aargau?",
    "query": "SELECT T.jahr, anzahl_nutzfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name = 'Canton Aargau'\n    AND T.jahr IN (1960, 1980);\n",
    "db_id": "aargau_privatverkehr_bestand_nach_fahrzeugarten",
    "generated_query": "SELECT T.jahr, T.anzahl_nutzfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name IN ('Aargau', 'Aargau (AG)')\n    AND T.jahr IN (1960, 1980);",
    "meta_data": [
      {
        "question": "Gab es 1930 oder 1940 im Kanton Aargau mehr Personenwagen?",
        "query": "SELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr IN (1930, 1940)\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_personenwagen) DESC\nLIMIT 1;\n",
        "score": 0.46755051612854004
      },
      {
        "question": "Wie hoch war die Zahl der Wohnwagen von 1998 bis 2001 in Aarburg, AG?",
        "query": "SELECT T.jahr, T.anzahl_anhaenger\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Aarburg', 'Aargbug (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2001;\n",
        "score": 0.5504325032234192
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_privatverkehr_bestand_nach_fahrzeugarten (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanzahl_personenwagen NUMERIC, \n\tanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars NUMERIC, \n\tanzahl_nutzfahrzeuge NUMERIC, \n\tanzahl_arbeitsmotorfahrzeuge NUMERIC, \n\tanzahl_motorrader NUMERIC, \n\tanzahl_klein_motorrader NUMERIC, \n\tanzahl_motorfahrrader NUMERIC, \n\tanzahl_landwirtschaftliche_motorfahrzeuge NUMERIC, \n\tanzahl_anhaenger NUMERIC, \n\tanzahl_kollektivfahrzeuge NUMERIC, \n\tanzahl_personenwagen_pro_1000_einwohner NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeugarten_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeug_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_privatverkehr_bestand_nach_fahrzeugarten and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 1980, 2006, 1992, 2002\nanzahl_personenwagen : 157, 159, 10603, 352, 418\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars : 78, 5, 4, 99, 0\nanzahl_nutzfahrzeuge : 157, 1562, 416, 191, 278\nanzahl_arbeitsmotorfahrzeuge : 157, 159, 152, 5, 12\nanzahl_motorrader : 92, 78, 1104, 111, 12\nanzahl_klein_motorrader : 21, 71, 60, 24, 5\nanzahl_motorfahrrader : 191, 352, 46, 36, 30\nanzahl_landwirtschaftliche_motorfahrzeuge : 21, 92, 106, 61, 60\nanzahl_anhaenger : 886, 228, 78, 46, 111\nanzahl_kollektivfahrzeuge : 21, 60, 61, 24, 5\nanzahl_personenwagen_pro_1000_einwohner : 417.89999999999998, 503.00000000000000, 626.50000000000000, 503.19999999999999, 557.10000000000002\n*/\n\n/*\nColumn name, Column discription, Example values\nanzahl_personenwagen_pro_1000_einwohner, Motorisierungsgrad: Anzahl Personenwagen pro 1000 Einwonhner/-innen., 485.5,488.6,485.1\nanzahl_personenwagen, Anzahl Personenwagen, 10556,10618,10582\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars, Anzahl \u00dcbrige Personen Transportfahrzeuge (Kleinbusse, cars), 73,70,76\nanzahl_nutzfahrzeuge, Anzahl Nutzfahrzeuge, 1640,1617,1642\nanzahl_arbeitsmotorfahrzeuge, Anzahl Arbeitsmotorfahrzeuge, 142,152,159\nanzahl_motorrader, Anzahl Motorr\u00e4der, 1234,1225,1157\nanzahl_klein_motorrader, Anzahl kleine Motorr\u00e4der, 25,34,30\nanzahl_motorfahrrader, Anzahl Motorfahrr\u00e4der, 517,498,469\nanzahl_landwirtschaftliche_motorfahrzeuge, Anzahl Landwirtschaftliche Motorfahrzeuge, 46,49,45\nanzahl_anhaenger, Anzahl Anh\u00e4nger, 831,820,845\nanzahl_kollektivfahrzeuge, Anzahl Kollektivfahrzeuge, 53,56,55\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWie hoch war die Zahl der Wohnwagen von 1998 bis 2001 in Aarburg, AG?\n### SQL query\nSELECT T.jahr, T.anzahl_anhaenger\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Aarburg', 'Aargbug (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2001;\n\n\n### Question\nWo im Aargau hatten Zeihen und Zufikon im Jahr 2001 mehr Personenwagen pro Einwohner?\n### SQL query\nSELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2001\n    AND S.name IN ('Zeihen', 'Zeihen (AG)' , 'Zufikon', 'Zufikon (AG)')\nORDER BY T.anzahl_personenwagen_pro_1000_einwohner DESC\nLIMIT 1;\n\n\n### Question\nWie hoch war die Zahl der Nutzfahrzeuge 1960 und 1980 im Kanton Aargau?\n### SQL query\n",
    "process_time": 7.329489107010886,
    "num_tokens": 1887,
    "hardness": "unknown",
    "scores": [
      0.46755051612854004,
      0.5504325032234192
    ],
    "lang": "de"
  },
  {
    "i": 81,
    "question": "Wie hoch war die Zahl der Nutzfahrzeuge in Abtwil, AG im Jahr 2000 ?",
    "query": "SELECT T.anzahl_nutzfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Abtwil', 'Abtwil (AG)')\n    AND T.jahr = 2000;\n",
    "db_id": "aargau_privatverkehr_bestand_nach_fahrzeugarten",
    "generated_query": "SELECT T.anzahl_nutzfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Abtwil'\n    AND T.jahr = 2000;",
    "meta_data": [
      {
        "question": "Wie hoch war die Zahl der Wohnwagen von 1998 bis 2001 in Aarburg, AG?",
        "query": "SELECT T.jahr, T.anzahl_anhaenger\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Aarburg', 'Aargbug (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2001;\n",
        "score": 0.5172494649887085
      },
      {
        "question": "Wie viele Anh\u00e4nger gab es im Jahr 2000 in Suhr, Aargau?",
        "query": "SELECT T.anzahl_anhaenger\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Suhr', 'Suhr (AG)')\n    AND T.jahr = 2000;\n",
        "score": 0.6999847888946533
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_privatverkehr_bestand_nach_fahrzeugarten (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanzahl_personenwagen NUMERIC, \n\tanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars NUMERIC, \n\tanzahl_nutzfahrzeuge NUMERIC, \n\tanzahl_arbeitsmotorfahrzeuge NUMERIC, \n\tanzahl_motorrader NUMERIC, \n\tanzahl_klein_motorrader NUMERIC, \n\tanzahl_motorfahrrader NUMERIC, \n\tanzahl_landwirtschaftliche_motorfahrzeuge NUMERIC, \n\tanzahl_anhaenger NUMERIC, \n\tanzahl_kollektivfahrzeuge NUMERIC, \n\tanzahl_personenwagen_pro_1000_einwohner NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeugarten_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeug_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_privatverkehr_bestand_nach_fahrzeugarten and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 1980, 2006, 1992, 2002\nanzahl_personenwagen : 157, 159, 10603, 352, 418\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars : 78, 5, 4, 99, 0\nanzahl_nutzfahrzeuge : 157, 1562, 416, 191, 278\nanzahl_arbeitsmotorfahrzeuge : 157, 159, 152, 5, 12\nanzahl_motorrader : 92, 78, 1104, 111, 12\nanzahl_klein_motorrader : 21, 71, 60, 24, 5\nanzahl_motorfahrrader : 191, 352, 46, 36, 30\nanzahl_landwirtschaftliche_motorfahrzeuge : 21, 92, 106, 61, 60\nanzahl_anhaenger : 886, 228, 78, 46, 111\nanzahl_kollektivfahrzeuge : 21, 60, 61, 24, 5\nanzahl_personenwagen_pro_1000_einwohner : 417.89999999999998, 503.00000000000000, 626.50000000000000, 503.19999999999999, 557.10000000000002\n*/\n\n/*\nColumn name, Column discription, Example values\nanzahl_personenwagen_pro_1000_einwohner, Motorisierungsgrad: Anzahl Personenwagen pro 1000 Einwonhner/-innen., 485.5,488.6,485.1\nanzahl_personenwagen, Anzahl Personenwagen, 10556,10618,10582\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars, Anzahl \u00dcbrige Personen Transportfahrzeuge (Kleinbusse, cars), 73,70,76\nanzahl_nutzfahrzeuge, Anzahl Nutzfahrzeuge, 1640,1617,1642\nanzahl_arbeitsmotorfahrzeuge, Anzahl Arbeitsmotorfahrzeuge, 142,152,159\nanzahl_motorrader, Anzahl Motorr\u00e4der, 1234,1225,1157\nanzahl_klein_motorrader, Anzahl kleine Motorr\u00e4der, 25,34,30\nanzahl_motorfahrrader, Anzahl Motorfahrr\u00e4der, 517,498,469\nanzahl_landwirtschaftliche_motorfahrzeuge, Anzahl Landwirtschaftliche Motorfahrzeuge, 46,49,45\nanzahl_anhaenger, Anzahl Anh\u00e4nger, 831,820,845\nanzahl_kollektivfahrzeuge, Anzahl Kollektivfahrzeuge, 53,56,55\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWie hoch war die Zahl der Wohnwagen von 1998 bis 2001 in Aarburg, AG?\n### SQL query\nSELECT T.jahr, T.anzahl_anhaenger\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Aarburg', 'Aargbug (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2001;\n\n\n### Question\nWelches waren 2015 die Top-3-Gemeinden im Aargau mit dem h\u00f6chsten Anteil an Motorr\u00e4dern gegen\u00fcber Autos? Zeigen Sie auch die Proportionen.\n### SQL query\nSELECT\n    S.name as gemeinde,\n    CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen AS ratio_motorrader_to_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nORDER BY ratio_motorrader_to_personenwagen DESC\nLIMIT 3;\n\n\n### Question\nWie hoch war die Zahl der Nutzfahrzeuge in Abtwil, AG im Jahr 2000 ?\n### SQL query\n",
    "process_time": 10.837831896962598,
    "num_tokens": 1912,
    "hardness": "unknown",
    "scores": [
      0.5172494649887085,
      0.6999847888946533
    ],
    "lang": "de"
  },
  {
    "i": 82,
    "question": "Wie viele Kollektivfahrzeuge gab es 2022 in Wettingen, AG?",
    "query": "SELECT T.anzahl_kollektivfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Wettingen', 'Wettingen (AG)')\n    AND T.jahr = 2022;\n",
    "db_id": "aargau_privatverkehr_bestand_nach_fahrzeugarten",
    "generated_query": "SELECT T.anzahl_kollektivfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Wettingen', 'Wettingen (AG)')\n    AND T.jahr = 2022;",
    "meta_data": [
      {
        "question": "Wie viele Anh\u00e4nger gab es im Jahr 2000 in Suhr, Aargau?",
        "query": "SELECT T.anzahl_anhaenger\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Suhr', 'Suhr (AG)')\n    AND T.jahr = 2000;\n",
        "score": 0.773077666759491
      },
      {
        "question": "Wie viele private Fahrzeuge gab es 2010 in Ueken im Kanton Aargau von jedem Typ?",
        "query": "SELECT\n    T.anzahl_anhaenger,\n    T.anzahl_arbeitsmotorfahrzeuge,\n    T.anzahl_klein_motorrader,\n    T.anzahl_kollektivfahrzeuge,\n    T.anzahl_landwirtschaftliche_motorfahrzeuge,\n    T.anzahl_motorfahrrader,\n    T.anzahl_motorrader,\n    T.anzahl_nutzfahrzeuge,\n    T.anzahl_personenwagen,\n    T.anzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2010\n    AND S.municipal = 'TRUE'\n    AND S.name IN ('Ueken', 'Ueken (AG)');\n",
        "score": 0.8241796493530273
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_privatverkehr_bestand_nach_fahrzeugarten (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanzahl_personenwagen NUMERIC, \n\tanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars NUMERIC, \n\tanzahl_nutzfahrzeuge NUMERIC, \n\tanzahl_arbeitsmotorfahrzeuge NUMERIC, \n\tanzahl_motorrader NUMERIC, \n\tanzahl_klein_motorrader NUMERIC, \n\tanzahl_motorfahrrader NUMERIC, \n\tanzahl_landwirtschaftliche_motorfahrzeuge NUMERIC, \n\tanzahl_anhaenger NUMERIC, \n\tanzahl_kollektivfahrzeuge NUMERIC, \n\tanzahl_personenwagen_pro_1000_einwohner NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeugarten_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeug_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_privatverkehr_bestand_nach_fahrzeugarten and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 1980, 2006, 1992, 2002\nanzahl_personenwagen : 157, 159, 10603, 352, 418\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars : 78, 5, 4, 99, 0\nanzahl_nutzfahrzeuge : 157, 1562, 416, 191, 278\nanzahl_arbeitsmotorfahrzeuge : 157, 159, 152, 5, 12\nanzahl_motorrader : 92, 78, 1104, 111, 12\nanzahl_klein_motorrader : 21, 71, 60, 24, 5\nanzahl_motorfahrrader : 191, 352, 46, 36, 30\nanzahl_landwirtschaftliche_motorfahrzeuge : 21, 92, 106, 61, 60\nanzahl_anhaenger : 886, 228, 78, 46, 111\nanzahl_kollektivfahrzeuge : 21, 60, 61, 24, 5\nanzahl_personenwagen_pro_1000_einwohner : 417.89999999999998, 503.00000000000000, 626.50000000000000, 503.19999999999999, 557.10000000000002\n*/\n\n/*\nColumn name, Column discription, Example values\nanzahl_personenwagen_pro_1000_einwohner, Motorisierungsgrad: Anzahl Personenwagen pro 1000 Einwonhner/-innen., 485.5,488.6,485.1\nanzahl_personenwagen, Anzahl Personenwagen, 10556,10618,10582\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars, Anzahl \u00dcbrige Personen Transportfahrzeuge (Kleinbusse, cars), 73,70,76\nanzahl_nutzfahrzeuge, Anzahl Nutzfahrzeuge, 1640,1617,1642\nanzahl_arbeitsmotorfahrzeuge, Anzahl Arbeitsmotorfahrzeuge, 142,152,159\nanzahl_motorrader, Anzahl Motorr\u00e4der, 1234,1225,1157\nanzahl_klein_motorrader, Anzahl kleine Motorr\u00e4der, 25,34,30\nanzahl_motorfahrrader, Anzahl Motorfahrr\u00e4der, 517,498,469\nanzahl_landwirtschaftliche_motorfahrzeuge, Anzahl Landwirtschaftliche Motorfahrzeuge, 46,49,45\nanzahl_anhaenger, Anzahl Anh\u00e4nger, 831,820,845\nanzahl_kollektivfahrzeuge, Anzahl Kollektivfahrzeuge, 53,56,55\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWie viele Anh\u00e4nger gab es im Jahr 2000 in Suhr, Aargau?\n### SQL query\nSELECT T.anzahl_anhaenger\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Suhr', 'Suhr (AG)')\n    AND T.jahr = 2000;\n\n\n### Question\nWie hoch war die Zahl der Wohnwagen von 1998 bis 2001 in Aarburg, AG?\n### SQL query\nSELECT T.jahr, T.anzahl_anhaenger\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Aarburg', 'Aargbug (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2001;\n\n\n### Question\nWie viele Kollektivfahrzeuge gab es 2022 in Wettingen, AG?\n### SQL query\n",
    "process_time": 9.296248756116256,
    "num_tokens": 1838,
    "hardness": "unknown",
    "scores": [
      0.773077666759491,
      0.8241796493530273
    ],
    "lang": "de"
  },
  {
    "i": 83,
    "question": "Wie viel Fl\u00e4che wurde im Jahr 2017 im Aargau f\u00fcr den Rotweinanbau genutzt?",
    "query": "SELECT T.flache_rebland_rote_europaische_reben_ha, T.flache_rebland_kreuzung_rote_weisse_ha\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;\n",
    "db_id": "aargau_obst_rebbau_rebland_wein_ernte",
    "generated_query": "SELECT T.flache_rebland_rote_europaische_reben_ha\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;",
    "meta_data": [
      {
        "question": "Wie viel Rot- und Weisswein wurde im Jahr 2019 im Aargau geerntet?",
        "query": "SELECT T.weinernte_rot_europaische_hl, T.weinernte_rot_kreuzung_rot_hl, T.weinernte_europaische_weiss_hl\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2019;\n",
        "score": 0.5957103967666626
      },
      {
        "question": "Wie viel Prozent des Wertes des im Aargau produzierten Weines entfiel 2017 auf Rotwein?",
        "query": "SELECT 100.0 * T.erntewert_rot_1000_chf / (T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf) AS prozent_rotwein_wert_2017\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;\n",
        "score": 0.7229341864585876
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_obst_rebbau_rebland_wein_ernte (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tflache_rebland_rote_europaische_reben_ha NUMERIC, \n\tflache_rebland_kreuzung_rote_weisse_ha NUMERIC, \n\tflache_rebland_weisse_reben_ha NUMERIC, \n\tflache_total_ha NUMERIC, \n\tweinernte_total_hl NUMERIC, \n\tweinernte_rot_europaische_hl NUMERIC, \n\tweinernte_rot_kreuzung_rot_hl NUMERIC, \n\tweinernte_europaische_weiss_hl NUMERIC, \n\terntewert_rot_1000_chf NUMERIC, \n\terntewert_weiss_1000_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_obst_rebbau_rebland_wein_ernte_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_obst_rebbau_rebland_wein_ernte_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_obst_rebbau_rebland_wein_ernte and 5 examples in each column for high cardinality columns :\nuid : 21, 24, 5, 46, 48\njahr : 2014, 1980, 2006, 1992, 2002\nflache_rebland_rote_europaische_reben_ha : 228, 191, 164, 260, 173\nflache_rebland_kreuzung_rote_weisse_ha : 21, 5, 12, 4, 16\nflache_rebland_weisse_reben_ha : 149, 106, 133, 110, 85\nflache_total_ha : 324, 307, 267, 262, 352\nweinernte_total_hl : 19300, 15165, 23490, 20521, 18540\nweinernte_rot_europaische_hl : 16139, 12000, 8650, 16266, 12270\nweinernte_rot_kreuzung_rot_hl : 212, 136, 1100, 400, 500\nweinernte_europaische_weiss_hl : 1352, 8544, 8640, 4640, 6020\nerntewert_rot_1000_chf : 7001, 6255, 10028, 7449, 1979\nerntewert_weiss_1000_chf : 4383, 3352, 4431, 2978, 2413\n*/\n\n/*\nColumn name, Column discription, Example values\nweinernte_total_hl, Weinernte in hl: Total, 167892306117054\nweinernte_rot_europaische_hl, Weinernte in hl: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 103651386111290\nweinernte_rot_kreuzung_rot_hl, Weinernte in hl: rotes Gew\u00e4chs: Direkttr\u00e4gerkreuzungen, 679795435\nweinernte_europaische_weiss_hl, Weinernte in hl: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 574484055329\nflache_rebland_rote_europaische_reben_ha, Fl\u00e4che Rebland in ha: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 244250253\nflache_rebland_kreuzung_rote_weisse_ha, Fl\u00e4che Rebland in ha: rotes Gew\u00e4chs: Direkttr\u00e4gerkreuzungen; ab 2016: Rote und weisse Sorten zusammen, 161413\nflache_total, Fl\u00e4che Rebland in ha: Total, 119126124\nerntewert_rot_1000_chf, Erntewert in 1000 Franken: rotes Gew\u00e4chs, 574487517001\nerntewert_weiss_1000_chf, Erntewert in 1000 Franken: weisse Gew\u00e4chs, 299643832779\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWie hoch war die Differenz in CHF zwischen dem Wert des im Aargau produzierten Rotweins in den Jahren 1999 und 2000?\n### SQL query\nSELECT (\n    SUM(CASE WHEN T.jahr = 2000 THEN T.erntewert_rot_1000_chf ELSE 0 END) -\n    SUM(CASE WHEN T.jahr = 1999 THEN T.erntewert_rot_1000_chf ELSE 0 END)\n) * 1000.0 AS wertanderung_1999_2000_chf\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1999, 2000);\n\n### Question\nWie viel Rot- und Weisswein wurde im Jahr 2019 im Aargau geerntet?\n### SQL query\nSELECT T.weinernte_rot_europaische_hl, T.weinernte_rot_kreuzung_rot_hl, T.weinernte_europaische_weiss_hl\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2019;\n\n\n### Question\nWie viel Fl\u00e4che wurde im Jahr 2017 im Aargau f\u00fcr den Rotweinanbau genutzt?\n### SQL query\n",
    "process_time": 6.455016769003123,
    "num_tokens": 1914,
    "hardness": "hard",
    "scores": [
      0.5957103967666626,
      0.7229341864585876
    ],
    "lang": "de"
  },
  {
    "i": 84,
    "question": "In welchem Jahr wurde im Aargau am meisten Wein geerntet?",
    "query": "SELECT T.jahr\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\nGROUP BY T.jahr\nORDER BY SUM(T.weinernte_total_hl) DESC\nLIMIT 1;\n",
    "db_id": "aargau_obst_rebbau_rebland_wein_ernte",
    "generated_query": "SELECT T.jahr, MAX(T.weinernte_total_hl) AS max_weinernte\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\nGROUP BY T.jahr\nORDER BY max_weinernte DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Wie viel Prozent des im Aargau geernteten Rotweins stammte im Jahr 2000 aus Kreuzungen?",
        "query": "SELECT (100 * CAST(T.weinernte_rot_kreuzung_rot_hl AS FLOAT) / T.weinernte_total_hl) AS prozent_rotwein_kreuzung_2000\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n",
        "score": 0.7620455026626587
      },
      {
        "question": "Wie viel Wein wurde im Aargau 1980 und 2010 geerntet?",
        "query": "SELECT T.jahr, T.weinernte_total_hl\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1980, 2010);\n",
        "score": 0.8135396242141724
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_obst_rebbau_rebland_wein_ernte (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tflache_rebland_rote_europaische_reben_ha NUMERIC, \n\tflache_rebland_kreuzung_rote_weisse_ha NUMERIC, \n\tflache_rebland_weisse_reben_ha NUMERIC, \n\tflache_total_ha NUMERIC, \n\tweinernte_total_hl NUMERIC, \n\tweinernte_rot_europaische_hl NUMERIC, \n\tweinernte_rot_kreuzung_rot_hl NUMERIC, \n\tweinernte_europaische_weiss_hl NUMERIC, \n\terntewert_rot_1000_chf NUMERIC, \n\terntewert_weiss_1000_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_obst_rebbau_rebland_wein_ernte_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_obst_rebbau_rebland_wein_ernte_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_obst_rebbau_rebland_wein_ernte and 5 examples in each column for high cardinality columns :\nuid : 21, 24, 5, 46, 48\njahr : 2014, 1980, 2006, 1992, 2002\nflache_rebland_rote_europaische_reben_ha : 228, 191, 164, 260, 173\nflache_rebland_kreuzung_rote_weisse_ha : 21, 5, 12, 4, 16\nflache_rebland_weisse_reben_ha : 149, 106, 133, 110, 85\nflache_total_ha : 324, 307, 267, 262, 352\nweinernte_total_hl : 19300, 15165, 23490, 20521, 18540\nweinernte_rot_europaische_hl : 16139, 12000, 8650, 16266, 12270\nweinernte_rot_kreuzung_rot_hl : 212, 136, 1100, 400, 500\nweinernte_europaische_weiss_hl : 1352, 8544, 8640, 4640, 6020\nerntewert_rot_1000_chf : 7001, 6255, 10028, 7449, 1979\nerntewert_weiss_1000_chf : 4383, 3352, 4431, 2978, 2413\n*/\n\n/*\nColumn name, Column discription, Example values\nweinernte_total_hl, Weinernte in hl: Total, 167892306117054\nweinernte_rot_europaische_hl, Weinernte in hl: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 103651386111290\nweinernte_rot_kreuzung_rot_hl, Weinernte in hl: rotes Gew\u00e4chs: Direkttr\u00e4gerkreuzungen, 679795435\nweinernte_europaische_weiss_hl, Weinernte in hl: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 574484055329\nflache_rebland_rote_europaische_reben_ha, Fl\u00e4che Rebland in ha: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 244250253\nflache_rebland_kreuzung_rote_weisse_ha, Fl\u00e4che Rebland in ha: rotes Gew\u00e4chs: Direkttr\u00e4gerkreuzungen; ab 2016: Rote und weisse Sorten zusammen, 161413\nflache_total, Fl\u00e4che Rebland in ha: Total, 119126124\nerntewert_rot_1000_chf, Erntewert in 1000 Franken: rotes Gew\u00e4chs, 574487517001\nerntewert_weiss_1000_chf, Erntewert in 1000 Franken: weisse Gew\u00e4chs, 299643832779\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWie hoch war die Differenz in CHF zwischen dem Wert des im Aargau produzierten Rotweins in den Jahren 1999 und 2000?\n### SQL query\nSELECT (\n    SUM(CASE WHEN T.jahr = 2000 THEN T.erntewert_rot_1000_chf ELSE 0 END) -\n    SUM(CASE WHEN T.jahr = 1999 THEN T.erntewert_rot_1000_chf ELSE 0 END)\n) * 1000.0 AS wertanderung_1999_2000_chf\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1999, 2000);\n\n### Question\nWie hoch war der Wert des im Aargau produzierten Weissweins in den Jahren 2003 bis 2008?\n### SQL query\nSELECT T.jahr, T.erntewert_weiss_1000_chf\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2003\n    AND T.jahr <= 2008;\n\n\n### Question\nIn welchem Jahr wurde im Aargau am meisten Wein geerntet?\n### SQL query\n",
    "process_time": 7.669853297993541,
    "num_tokens": 1899,
    "hardness": "extra",
    "scores": [
      0.7620455026626587,
      0.8135396242141724
    ],
    "lang": "de"
  },
  {
    "i": 85,
    "question": "Um wie viel Franken hat sich der Gesamtwert der Weinernte im Aargau zwischen 1980 und 2016 ver\u00e4ndert?",
    "query": "SELECT (\n    SUM(CASE WHEN T.jahr = 2016 THEN T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf ELSE 0 END) -\n    SUM(CASE WHEN T.jahr = 1980 THEN T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf ELSE 0 END)\n) * 1000.0 AS wertanderung_1980_2016_chf\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1980, 2016);\n",
    "db_id": "aargau_obst_rebbau_rebland_wein_ernte",
    "generated_query": "SELECT (\n    SUM(CASE WHEN T.jahr = 2016 THEN T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf ELSE 0 END) -\n    SUM(CASE WHEN T.jahr = 1980 THEN T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf ELSE 0 END)\n) * 1000.0 AS wertanderung_1980_2016_chf\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1980, 2016);",
    "meta_data": [
      {
        "question": "Wie hat sich die Weinbaufl\u00e4che im Aargau zwischen 1980 und 2000 relativ ver\u00e4ndert (in prozent)?",
        "query": "SELECT 100 * (T1.flache_ha_2000 - T1.flache_ha_1980) / T1.flache_ha_1980 AS weinrebflache_1980_2000_change_prozent\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 1980 THEN T.flache_total_ha ELSE 0 END) AS flache_ha_1980,\n        SUM(CASE WHEN T.jahr = 2000 THEN T.flache_total_ha ELSE 0 END) AS flache_ha_2000\n    FROM aargau_obst_rebbau_rebland_wein_ernte AS T\n    JOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.canton = 'TRUE'\n        AND S.name LIKE '%Aargau%'\n        AND T.jahr IN (1980, 2000)\n) AS T1;\n",
        "score": 0.4492011070251465
      },
      {
        "question": "Wie viel Wein wurde im Aargau 1980 und 2010 geerntet?",
        "query": "SELECT T.jahr, T.weinernte_total_hl\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1980, 2010);\n",
        "score": 0.5082032680511475
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_obst_rebbau_rebland_wein_ernte (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tflache_rebland_rote_europaische_reben_ha NUMERIC, \n\tflache_rebland_kreuzung_rote_weisse_ha NUMERIC, \n\tflache_rebland_weisse_reben_ha NUMERIC, \n\tflache_total_ha NUMERIC, \n\tweinernte_total_hl NUMERIC, \n\tweinernte_rot_europaische_hl NUMERIC, \n\tweinernte_rot_kreuzung_rot_hl NUMERIC, \n\tweinernte_europaische_weiss_hl NUMERIC, \n\terntewert_rot_1000_chf NUMERIC, \n\terntewert_weiss_1000_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_obst_rebbau_rebland_wein_ernte_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_obst_rebbau_rebland_wein_ernte_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_obst_rebbau_rebland_wein_ernte and 5 examples in each column for high cardinality columns :\nuid : 21, 24, 5, 46, 48\njahr : 2014, 1980, 2006, 1992, 2002\nflache_rebland_rote_europaische_reben_ha : 228, 191, 164, 260, 173\nflache_rebland_kreuzung_rote_weisse_ha : 21, 5, 12, 4, 16\nflache_rebland_weisse_reben_ha : 149, 106, 133, 110, 85\nflache_total_ha : 324, 307, 267, 262, 352\nweinernte_total_hl : 19300, 15165, 23490, 20521, 18540\nweinernte_rot_europaische_hl : 16139, 12000, 8650, 16266, 12270\nweinernte_rot_kreuzung_rot_hl : 212, 136, 1100, 400, 500\nweinernte_europaische_weiss_hl : 1352, 8544, 8640, 4640, 6020\nerntewert_rot_1000_chf : 7001, 6255, 10028, 7449, 1979\nerntewert_weiss_1000_chf : 4383, 3352, 4431, 2978, 2413\n*/\n\n/*\nColumn name, Column discription, Example values\nweinernte_total_hl, Weinernte in hl: Total, 167892306117054\nweinernte_rot_europaische_hl, Weinernte in hl: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 103651386111290\nweinernte_rot_kreuzung_rot_hl, Weinernte in hl: rotes Gew\u00e4chs: Direkttr\u00e4gerkreuzungen, 679795435\nweinernte_europaische_weiss_hl, Weinernte in hl: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 574484055329\nflache_rebland_rote_europaische_reben_ha, Fl\u00e4che Rebland in ha: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 244250253\nflache_rebland_kreuzung_rote_weisse_ha, Fl\u00e4che Rebland in ha: rotes Gew\u00e4chs: Direkttr\u00e4gerkreuzungen; ab 2016: Rote und weisse Sorten zusammen, 161413\nflache_total, Fl\u00e4che Rebland in ha: Total, 119126124\nerntewert_rot_1000_chf, Erntewert in 1000 Franken: rotes Gew\u00e4chs, 574487517001\nerntewert_weiss_1000_chf, Erntewert in 1000 Franken: weisse Gew\u00e4chs, 299643832779\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWie viele Liter Wein wurden im Aargau zwischen 2000 und 2010 insgesamt produziert?\n### SQL query\nSELECT 100 * SUM(T.weinernte_total_hl) AS weinernte_2000_2010_total_liter\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2000\n    AND T.jahr <= 2010;\n\n\n### Question\nWie hoch war die Differenz in CHF zwischen dem Wert des im Aargau produzierten Rotweins in den Jahren 1999 und 2000?\n### SQL query\nSELECT (\n    SUM(CASE WHEN T.jahr = 2000 THEN T.erntewert_rot_1000_chf ELSE 0 END) -\n    SUM(CASE WHEN T.jahr = 1999 THEN T.erntewert_rot_1000_chf ELSE 0 END)\n) * 1000.0 AS wertanderung_1999_2000_chf\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1999, 2000);\n\n### Question\nUm wie viel Franken hat sich der Gesamtwert der Weinernte im Aargau zwischen 1980 und 2016 ver\u00e4ndert?\n### SQL query\n",
    "process_time": 13.18447741609998,
    "num_tokens": 1918,
    "hardness": "unknown",
    "scores": [
      0.4492011070251465,
      0.5082032680511475
    ],
    "lang": "de"
  },
  {
    "i": 86,
    "question": "Wie viele Quadratkilometer Rebfl\u00e4che gab es im Aargau im Jahr 2018?",
    "query": "SELECT CAST(T.flache_total_ha AS FLOAT) / 100 AS flache_total_km2\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2018;\n",
    "db_id": "aargau_obst_rebbau_rebland_wein_ernte",
    "generated_query": "SELECT flache_total_ha / 100 AS flache_total_km\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2018;",
    "meta_data": [
      {
        "question": "Wie viel Prozent des im Aargau geernteten Rotweins stammte im Jahr 2000 aus Kreuzungen?",
        "query": "SELECT (100 * CAST(T.weinernte_rot_kreuzung_rot_hl AS FLOAT) / T.weinernte_total_hl) AS prozent_rotwein_kreuzung_2000\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n",
        "score": 0.9058692455291748
      },
      {
        "question": "Wie viel Prozent des Wertes des im Aargau produzierten Weines entfiel 2017 auf Rotwein?",
        "query": "SELECT 100.0 * T.erntewert_rot_1000_chf / (T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf) AS prozent_rotwein_wert_2017\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;\n",
        "score": 0.9602519869804382
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_obst_rebbau_rebland_wein_ernte (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tflache_rebland_rote_europaische_reben_ha NUMERIC, \n\tflache_rebland_kreuzung_rote_weisse_ha NUMERIC, \n\tflache_rebland_weisse_reben_ha NUMERIC, \n\tflache_total_ha NUMERIC, \n\tweinernte_total_hl NUMERIC, \n\tweinernte_rot_europaische_hl NUMERIC, \n\tweinernte_rot_kreuzung_rot_hl NUMERIC, \n\tweinernte_europaische_weiss_hl NUMERIC, \n\terntewert_rot_1000_chf NUMERIC, \n\terntewert_weiss_1000_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_obst_rebbau_rebland_wein_ernte_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_obst_rebbau_rebland_wein_ernte_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_obst_rebbau_rebland_wein_ernte and 5 examples in each column for high cardinality columns :\nuid : 21, 24, 5, 46, 48\njahr : 2014, 1980, 2006, 1992, 2002\nflache_rebland_rote_europaische_reben_ha : 228, 191, 164, 260, 173\nflache_rebland_kreuzung_rote_weisse_ha : 21, 5, 12, 4, 16\nflache_rebland_weisse_reben_ha : 149, 106, 133, 110, 85\nflache_total_ha : 324, 307, 267, 262, 352\nweinernte_total_hl : 19300, 15165, 23490, 20521, 18540\nweinernte_rot_europaische_hl : 16139, 12000, 8650, 16266, 12270\nweinernte_rot_kreuzung_rot_hl : 212, 136, 1100, 400, 500\nweinernte_europaische_weiss_hl : 1352, 8544, 8640, 4640, 6020\nerntewert_rot_1000_chf : 7001, 6255, 10028, 7449, 1979\nerntewert_weiss_1000_chf : 4383, 3352, 4431, 2978, 2413\n*/\n\n/*\nColumn name, Column discription, Example values\nweinernte_total_hl, Weinernte in hl: Total, 167892306117054\nweinernte_rot_europaische_hl, Weinernte in hl: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 103651386111290\nweinernte_rot_kreuzung_rot_hl, Weinernte in hl: rotes Gew\u00e4chs: Direkttr\u00e4gerkreuzungen, 679795435\nweinernte_europaische_weiss_hl, Weinernte in hl: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 574484055329\nflache_rebland_rote_europaische_reben_ha, Fl\u00e4che Rebland in ha: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 244250253\nflache_rebland_kreuzung_rote_weisse_ha, Fl\u00e4che Rebland in ha: rotes Gew\u00e4chs: Direkttr\u00e4gerkreuzungen; ab 2016: Rote und weisse Sorten zusammen, 161413\nflache_total, Fl\u00e4che Rebland in ha: Total, 119126124\nerntewert_rot_1000_chf, Erntewert in 1000 Franken: rotes Gew\u00e4chs, 574487517001\nerntewert_weiss_1000_chf, Erntewert in 1000 Franken: weisse Gew\u00e4chs, 299643832779\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWie hoch war die Differenz in CHF zwischen dem Wert des im Aargau produzierten Rotweins in den Jahren 1999 und 2000?\n### SQL query\nSELECT (\n    SUM(CASE WHEN T.jahr = 2000 THEN T.erntewert_rot_1000_chf ELSE 0 END) -\n    SUM(CASE WHEN T.jahr = 1999 THEN T.erntewert_rot_1000_chf ELSE 0 END)\n) * 1000.0 AS wertanderung_1999_2000_chf\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1999, 2000);\n\n### Question\nWie viel Prozent des Wertes des im Aargau produzierten Weines entfiel 2017 auf Rotwein?\n### SQL query\nSELECT 100.0 * T.erntewert_rot_1000_chf / (T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf) AS prozent_rotwein_wert_2017\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;\n\n\n### Question\nWie viele Quadratkilometer Rebfl\u00e4che gab es im Aargau im Jahr 2018?\n### SQL query\n",
    "process_time": 6.064608091022819,
    "num_tokens": 1931,
    "hardness": "unknown",
    "scores": [
      0.9058692455291748,
      0.9602519869804382
    ],
    "lang": "de"
  },
  {
    "i": 87,
    "question": "Wie viele Brandf\u00e4lle gab es im Jahr 2011 im Aargau?",
    "query": "SELECT T.total_anzahl_schadenfalle\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2011;\n",
    "db_id": "aargau_brandversicherung_brandschaden_anzahl_schadensummen",
    "generated_query": "SELECT T.total_anzahl_schadenfalle\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2011;",
    "meta_data": [
      {
        "question": "Wie viele Brandstiftungen wurden von 1980 bis 2020 im Kanton Aargau insgesamt gemeldet?",
        "query": "SELECT SUM(T.vorsatzliche_brandstift_anzahl_schadenfalle)\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2020;",
        "score": 0.5021741986274719
      },
      {
        "question": "Wie viel Franken kosteten Brandeins\u00e4tze aus unbekannter Ursache im Aargau im Jahr 2020?",
        "query": "SELECT T.unbekannt_schaden_1000_chf * 1000 AS unbekannt_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2020;\n",
        "score": 0.6268883943557739
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_brandversicherung_brandschaden_anzahl_schadensummen (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\ttotal_anzahl_schadenfalle NUMERIC, \n\ttotal_schaden_1000_chf NUMERIC, \n\tfeuerzeug_rauchzeug_licht_anzahl_schadenfalle NUMERIC, \n\tfeuerzeug_rauchzeug_licht_schaden_1000_chf NUMERIC, \n\telektrizitaet_anzahl_schadenfalle NUMERIC, \n\telektrizitaet_schaden_1000_chf NUMERIC, \n\tvorsatzliche_brandstift_anzahl_schadenfalle NUMERIC, \n\tvorsatzliche_brandstift_schaden_1000_chf NUMERIC, \n\tfeuerungsanlagen_anzahl_schadenfalle NUMERIC, \n\tfeuerungsanlagen_schaden_1000_chf NUMERIC, \n\texplosion_anzahl_schadenfalle NUMERIC, \n\texplosion_schaden_1000_chf NUMERIC, \n\tuebrige_anzahl_schadenfalle NUMERIC, \n\tuebrige_schaden_1000_chf NUMERIC, \n\tunbekannt_anzahl_schadenfalle NUMERIC, \n\tunbekannt_schaden_1000_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_brandversicherung_brandschaden_anzahl_schadensummen_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_brandversicherung_brandschaden_anza_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_brandversicherung_brandschaden_anzahl_schadensummen and 5 examples in each column for high cardinality columns :\nuid : 21, 24, 5, 46, 48\njahr : 2014, 1980, 2006, 1992, 2002\ntotal_anzahl_schadenfalle : 681, 1104, 1232, 1151, 1775\ntotal_schaden_1000_chf : 19549, 24074, 16992, 11789, 22824\nfeuerzeug_rauchzeug_licht_anzahl_schadenfalle : 162, 159, 111, 133, 12\nfeuerzeug_rauchzeug_licht_schaden_1000_chf : 307, 4258, 4685, 1534, 2095\nelektrizitaet_anzahl_schadenfalle : 228, 254, 279, 278, 303\nelektrizitaet_schaden_1000_chf : 4263, 4637, 9548, 1104, 2858\nvorsatzliche_brandstift_anzahl_schadenfalle : 21, 60, 24, 48, 17\nvorsatzliche_brandstift_schaden_1000_chf : 4113, 1134, 2470, 214, 1229\nfeuerungsanlagen_anzahl_schadenfalle : 78, 95, 48, 85, 66\nfeuerungsanlagen_schaden_1000_chf : 728, 1560, 792, 1271, 909\nexplosion_anzahl_schadenfalle : 21, 75, 71, 78, 46\nexplosion_schaden_1000_chf : 624, 719, 681, 1992, 579\nuebrige_anzahl_schadenfalle : 299, 1040, 159, 262, 342\nuebrige_schaden_1000_chf : 5410, 3699, 1734, 2310, 3191\nunbekannt_anzahl_schadenfalle : 21, 61, 46, 48, 66\nunbekannt_schaden_1000_chf : 11513, 11071, 1876, 8678, 3678\n*/\n\n/*\nColumn name, Column discription, Example values\ntotal_anzahl_schadenfalle, Total Anzahl Schadenfalle, 796681857\ntotal_schaden_1000_chf, Totale Schadensumme in 1000 CHF, 182472448024074\nfeuerzeug_rauchzeug_licht_anzahl_schadenfalle, None, 122123132\nfeuerzeug_rauchzeug_licht_schaden_1000_chf, None, 209525525078\nelektrizitaet_anzahl_schadenfalle, None, 234246228\nvorsatzliche_brandstift_schaden_1000_chf, None, 508360635374\nvorsatzliche_brandstift_anzahl_schadenfalle, None, 142225\nbrandstift_schaden_1000_chf, None, 2149632470\nfeuerungsanl_anzahl_schadenfalle, Feuerungsanlagen: Anzahl Schadenf\u00e4lle, 676547\nfeuerungsanl_schaden_1000_chf, Feuerungsanlagen: Totale Schadensumme in 1000 CHF, 15601231792\nexplosion_anzahl_schadenfalle, None, 262125\nexplosion_schaden_1000_chf, None, 7821180211\nuebrige_anzahl_schadenfalle, None, 269176342\nuebrige_schaden_1000_chf, None, 16449331734\nunbekannt_anzahl_schadenfalle, None, 512857\nunbekannt_schaden_1000_chf, None, 675118838678\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWie viele Brandstiftungen wurden von 1980 bis 2020 im Kanton Aargau insgesamt gemeldet?\n### SQL query\nSELECT SUM(T.vorsatzliche_brandstift_anzahl_schadenfalle)\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2020;\n\n### Question\nWie viele Explosionen und Brandstiftungen wurden im Jahr 2000 im Aargau registriert?\n### SQL query\nSELECT T.explosion_anzahl_schadenfalle, T.vorsatzliche_brandstift_anzahl_schadenfalle\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n\n\n### Question\nWie viele Brandf\u00e4lle gab es im Jahr 2011 im Aargau?\n### SQL query\n",
    "process_time": 9.62352313194424,
    "num_tokens": 2195,
    "hardness": "hard",
    "scores": [
      0.5021741986274719,
      0.6268883943557739
    ],
    "lang": "de"
  },
  {
    "i": 88,
    "question": "In welchem Jahr wurden im Aargau die meisten Brandstiftungen gemeldet?",
    "query": "SELECT T.jahr\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\nORDER BY T.vorsatzliche_brandstift_anzahl_schadenfalle DESC\nLIMIT 1;\n",
    "db_id": "aargau_brandversicherung_brandschaden_anzahl_schadensummen",
    "generated_query": "SELECT T.jahr\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\nORDER BY T.vorsatzliche_brandstift_anzahl_schadenfalle DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Wie viele Brandstiftungen wurden von 1980 bis 2020 im Kanton Aargau insgesamt gemeldet?",
        "query": "SELECT SUM(T.vorsatzliche_brandstift_anzahl_schadenfalle)\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2020;",
        "score": 0.4312750995159149
      },
      {
        "question": "Wie viele Explosionen und Brandstiftungen wurden im Jahr 2000 im Aargau registriert?",
        "query": "SELECT T.explosion_anzahl_schadenfalle, T.vorsatzliche_brandstift_anzahl_schadenfalle\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n",
        "score": 0.6214660406112671
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_brandversicherung_brandschaden_anzahl_schadensummen (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\ttotal_anzahl_schadenfalle NUMERIC, \n\ttotal_schaden_1000_chf NUMERIC, \n\tfeuerzeug_rauchzeug_licht_anzahl_schadenfalle NUMERIC, \n\tfeuerzeug_rauchzeug_licht_schaden_1000_chf NUMERIC, \n\telektrizitaet_anzahl_schadenfalle NUMERIC, \n\telektrizitaet_schaden_1000_chf NUMERIC, \n\tvorsatzliche_brandstift_anzahl_schadenfalle NUMERIC, \n\tvorsatzliche_brandstift_schaden_1000_chf NUMERIC, \n\tfeuerungsanlagen_anzahl_schadenfalle NUMERIC, \n\tfeuerungsanlagen_schaden_1000_chf NUMERIC, \n\texplosion_anzahl_schadenfalle NUMERIC, \n\texplosion_schaden_1000_chf NUMERIC, \n\tuebrige_anzahl_schadenfalle NUMERIC, \n\tuebrige_schaden_1000_chf NUMERIC, \n\tunbekannt_anzahl_schadenfalle NUMERIC, \n\tunbekannt_schaden_1000_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_brandversicherung_brandschaden_anzahl_schadensummen_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_brandversicherung_brandschaden_anza_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_brandversicherung_brandschaden_anzahl_schadensummen and 5 examples in each column for high cardinality columns :\nuid : 21, 24, 5, 46, 48\njahr : 2014, 1980, 2006, 1992, 2002\ntotal_anzahl_schadenfalle : 681, 1104, 1232, 1151, 1775\ntotal_schaden_1000_chf : 19549, 24074, 16992, 11789, 22824\nfeuerzeug_rauchzeug_licht_anzahl_schadenfalle : 162, 159, 111, 133, 12\nfeuerzeug_rauchzeug_licht_schaden_1000_chf : 307, 4258, 4685, 1534, 2095\nelektrizitaet_anzahl_schadenfalle : 228, 254, 279, 278, 303\nelektrizitaet_schaden_1000_chf : 4263, 4637, 9548, 1104, 2858\nvorsatzliche_brandstift_anzahl_schadenfalle : 21, 60, 24, 48, 17\nvorsatzliche_brandstift_schaden_1000_chf : 4113, 1134, 2470, 214, 1229\nfeuerungsanlagen_anzahl_schadenfalle : 78, 95, 48, 85, 66\nfeuerungsanlagen_schaden_1000_chf : 728, 1560, 792, 1271, 909\nexplosion_anzahl_schadenfalle : 21, 75, 71, 78, 46\nexplosion_schaden_1000_chf : 624, 719, 681, 1992, 579\nuebrige_anzahl_schadenfalle : 299, 1040, 159, 262, 342\nuebrige_schaden_1000_chf : 5410, 3699, 1734, 2310, 3191\nunbekannt_anzahl_schadenfalle : 21, 61, 46, 48, 66\nunbekannt_schaden_1000_chf : 11513, 11071, 1876, 8678, 3678\n*/\n\n/*\nColumn name, Column discription, Example values\ntotal_anzahl_schadenfalle, Total Anzahl Schadenfalle, 796681857\ntotal_schaden_1000_chf, Totale Schadensumme in 1000 CHF, 182472448024074\nfeuerzeug_rauchzeug_licht_anzahl_schadenfalle, None, 122123132\nfeuerzeug_rauchzeug_licht_schaden_1000_chf, None, 209525525078\nelektrizitaet_anzahl_schadenfalle, None, 234246228\nvorsatzliche_brandstift_schaden_1000_chf, None, 508360635374\nvorsatzliche_brandstift_anzahl_schadenfalle, None, 142225\nbrandstift_schaden_1000_chf, None, 2149632470\nfeuerungsanl_anzahl_schadenfalle, Feuerungsanlagen: Anzahl Schadenf\u00e4lle, 676547\nfeuerungsanl_schaden_1000_chf, Feuerungsanlagen: Totale Schadensumme in 1000 CHF, 15601231792\nexplosion_anzahl_schadenfalle, None, 262125\nexplosion_schaden_1000_chf, None, 7821180211\nuebrige_anzahl_schadenfalle, None, 269176342\nuebrige_schaden_1000_chf, None, 16449331734\nunbekannt_anzahl_schadenfalle, None, 512857\nunbekannt_schaden_1000_chf, None, 675118838678\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWie viele Brandstiftungen wurden von 1980 bis 2020 im Kanton Aargau insgesamt gemeldet?\n### SQL query\nSELECT SUM(T.vorsatzliche_brandstift_anzahl_schadenfalle)\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2020;\n\n### Question\nWie viele Explosionen und Brandstiftungen wurden im Jahr 2000 im Aargau registriert?\n### SQL query\nSELECT T.explosion_anzahl_schadenfalle, T.vorsatzliche_brandstift_anzahl_schadenfalle\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n\n\n### Question\nIn welchem Jahr wurden im Aargau die meisten Brandstiftungen gemeldet?\n### SQL query\n",
    "process_time": 6.480780276935548,
    "num_tokens": 2196,
    "hardness": "extra",
    "scores": [
      0.4312750995159149,
      0.6214660406112671
    ],
    "lang": "de"
  },
  {
    "i": 89,
    "question": "Welches waren die 3 h\u00e4ufigsten Ursachen f\u00fcr Brandf\u00e4lle im Aargau im Jahr 1985?",
    "query": "WITH T1 AS (\n    SELECT * FROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.canton = 'TRUE'\n        AND S.name LIKE '%Aargau%'\n        AND T.jahr = 1985\n)\nSELECT T2.source_name\nFROM (\n    SELECT T1.feuerzeug_rauchzeug_licht_anzahl_schadenfalle as source, 'feuerzeug_rauchzeug_licht_anzahl_schadenfalle' as source_name\n    FROM T1 AS UNION ALL\n    SELECT T1.elektrizitaet_anzahl_schadenfalle as source, 'elektrizitaet_anzahl_schadenfalle' as source_name\n    FROM T1 AS UNION ALL\n    SELECT T1.vorsatzliche_brandstift_anzahl_schadenfalle as source, 'vorsatzliche_brandstift_anzahl_schadenfalle' as source_name\n    FROM T1 AS UNION ALL\n    SELECT T1.feuerungsanlagen_anzahl_schadenfalle as source, 'feuerungsanlagen_anzahl_schadenfalle' as source_name\n    FROM T1 AS UNION ALL\n    SELECT T1.explosion_anzahl_schadenfalle as source, 'explosion_anzahl_schadenfalle' as source_name\n    FROM T1 AS UNION ALL\n    SELECT T1.uebrige_anzahl_schadenfalle as source, 'uebrige_anzahl_schadenfalle' as source_name\n    FROM T1 AS UNION ALL\n    SELECT T1.unbekannt_anzahl_schadenfalle as source, 'unbekannt_anzahl_schadenfalle' as source_name\n    FROM T1\n) AS T2\nORDER BY T2.source DESC\nLIMIT 3;\n",
    "db_id": "aargau_brandversicherung_brandschaden_anzahl_schadensummen",
    "generated_query": "SELECT T.feuerzeug_rauchzeug_licht_anzahl_schadenfalle, T.elektrizitaet_anzahl_schadenfalle, T.vorsatzliche_brandstift_anzahl_schadenfalle\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 1985\nORDER BY T.feuerzeug_rauchzeug_licht_anzahl_schadenfalle DESC, T.elektrizitaet_anzahl_schadenfalle DESC, T.vorsatzliche_brandstift_anzahl_schadenfalle DESC\nLIMIT 3;",
    "meta_data": [
      {
        "question": "Wie viel kosteten Brandf\u00e4lle durch Explosionen die Versicherer im Kanton Aargau in den Jahren 1980, 1990, 2000 und 2010 in CHF?",
        "query": "SELECT T.jahr, T.explosion_schaden_1000_chf * 1000 AS explosion_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1980, 1990, 2000, 2010)\nORDER BY T.jahr DESC;\n",
        "score": 0.44335055351257324
      },
      {
        "question": "Wie viele Brandstiftungen wurden von 1980 bis 2020 im Kanton Aargau insgesamt gemeldet?",
        "query": "SELECT SUM(T.vorsatzliche_brandstift_anzahl_schadenfalle)\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2020;",
        "score": 0.534665584564209
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_brandversicherung_brandschaden_anzahl_schadensummen (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\ttotal_anzahl_schadenfalle NUMERIC, \n\ttotal_schaden_1000_chf NUMERIC, \n\tfeuerzeug_rauchzeug_licht_anzahl_schadenfalle NUMERIC, \n\tfeuerzeug_rauchzeug_licht_schaden_1000_chf NUMERIC, \n\telektrizitaet_anzahl_schadenfalle NUMERIC, \n\telektrizitaet_schaden_1000_chf NUMERIC, \n\tvorsatzliche_brandstift_anzahl_schadenfalle NUMERIC, \n\tvorsatzliche_brandstift_schaden_1000_chf NUMERIC, \n\tfeuerungsanlagen_anzahl_schadenfalle NUMERIC, \n\tfeuerungsanlagen_schaden_1000_chf NUMERIC, \n\texplosion_anzahl_schadenfalle NUMERIC, \n\texplosion_schaden_1000_chf NUMERIC, \n\tuebrige_anzahl_schadenfalle NUMERIC, \n\tuebrige_schaden_1000_chf NUMERIC, \n\tunbekannt_anzahl_schadenfalle NUMERIC, \n\tunbekannt_schaden_1000_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_brandversicherung_brandschaden_anzahl_schadensummen_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_brandversicherung_brandschaden_anza_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_brandversicherung_brandschaden_anzahl_schadensummen and 5 examples in each column for high cardinality columns :\nuid : 21, 24, 5, 46, 48\njahr : 2014, 1980, 2006, 1992, 2002\ntotal_anzahl_schadenfalle : 681, 1104, 1232, 1151, 1775\ntotal_schaden_1000_chf : 19549, 24074, 16992, 11789, 22824\nfeuerzeug_rauchzeug_licht_anzahl_schadenfalle : 162, 159, 111, 133, 12\nfeuerzeug_rauchzeug_licht_schaden_1000_chf : 307, 4258, 4685, 1534, 2095\nelektrizitaet_anzahl_schadenfalle : 228, 254, 279, 278, 303\nelektrizitaet_schaden_1000_chf : 4263, 4637, 9548, 1104, 2858\nvorsatzliche_brandstift_anzahl_schadenfalle : 21, 60, 24, 48, 17\nvorsatzliche_brandstift_schaden_1000_chf : 4113, 1134, 2470, 214, 1229\nfeuerungsanlagen_anzahl_schadenfalle : 78, 95, 48, 85, 66\nfeuerungsanlagen_schaden_1000_chf : 728, 1560, 792, 1271, 909\nexplosion_anzahl_schadenfalle : 21, 75, 71, 78, 46\nexplosion_schaden_1000_chf : 624, 719, 681, 1992, 579\nuebrige_anzahl_schadenfalle : 299, 1040, 159, 262, 342\nuebrige_schaden_1000_chf : 5410, 3699, 1734, 2310, 3191\nunbekannt_anzahl_schadenfalle : 21, 61, 46, 48, 66\nunbekannt_schaden_1000_chf : 11513, 11071, 1876, 8678, 3678\n*/\n\n/*\nColumn name, Column discription, Example values\ntotal_anzahl_schadenfalle, Total Anzahl Schadenfalle, 796681857\ntotal_schaden_1000_chf, Totale Schadensumme in 1000 CHF, 182472448024074\nfeuerzeug_rauchzeug_licht_anzahl_schadenfalle, None, 122123132\nfeuerzeug_rauchzeug_licht_schaden_1000_chf, None, 209525525078\nelektrizitaet_anzahl_schadenfalle, None, 234246228\nvorsatzliche_brandstift_schaden_1000_chf, None, 508360635374\nvorsatzliche_brandstift_anzahl_schadenfalle, None, 142225\nbrandstift_schaden_1000_chf, None, 2149632470\nfeuerungsanl_anzahl_schadenfalle, Feuerungsanlagen: Anzahl Schadenf\u00e4lle, 676547\nfeuerungsanl_schaden_1000_chf, Feuerungsanlagen: Totale Schadensumme in 1000 CHF, 15601231792\nexplosion_anzahl_schadenfalle, None, 262125\nexplosion_schaden_1000_chf, None, 7821180211\nuebrige_anzahl_schadenfalle, None, 269176342\nuebrige_schaden_1000_chf, None, 16449331734\nunbekannt_anzahl_schadenfalle, None, 512857\nunbekannt_schaden_1000_chf, None, 675118838678\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWie viele Brandstiftungen wurden von 1980 bis 2020 im Kanton Aargau insgesamt gemeldet?\n### SQL query\nSELECT SUM(T.vorsatzliche_brandstift_anzahl_schadenfalle)\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2020;\n\n### Question\nWie viele Explosionen und Brandstiftungen wurden im Jahr 2000 im Aargau registriert?\n### SQL query\nSELECT T.explosion_anzahl_schadenfalle, T.vorsatzliche_brandstift_anzahl_schadenfalle\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n\n\n### Question\nWelches waren die 3 h\u00e4ufigsten Ursachen f\u00fcr Brandf\u00e4lle im Aargau im Jahr 1985?\n### SQL query\n",
    "process_time": 12.192032010061666,
    "num_tokens": 2203,
    "hardness": "unknown",
    "scores": [
      0.44335055351257324,
      0.534665584564209
    ],
    "lang": "de"
  },
  {
    "i": 90,
    "question": "Wie hoch waren die j\u00e4hrlichen Kosten in CHF f\u00fcr die durch Elektrizit\u00e4t und Explosionen verursachten Brandsch\u00e4den im Kanton Aargau in den Jahren 2001 bis 2007?",
    "query": "SELECT T.jahr, T.elektrizitaet_schaden_1000_chf * 1000 AS elektrizitaet_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2001\n    AND T.jahr <= 2007\nORDER BY T.jahr DESC;\n",
    "db_id": "aargau_brandversicherung_brandschaden_anzahl_schadensummen",
    "generated_query": "SELECT T.jahr, (T.elektrizitaet_schaden_1000_chf + T.explosion_schaden_1000_chf) * 1000 AS gesamt_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2001\n    AND T.jahr <= 2007\nORDER BY T.jahr DESC;",
    "meta_data": [
      {
        "question": "Wie hoch waren die j\u00e4hrlichen Kosten in CHF f\u00fcr die durch Elektrizit\u00e4t und Explosionen verursachten Brandsch\u00e4den im Kanton Aargau in den Jahren 2001 bis 2007?",
        "query": "SELECT T.jahr, T.elektrizitaet_schaden_1000_chf * 1000 AS elektrizitaet_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2001\n    AND T.jahr <= 2007\nORDER BY T.jahr DESC;\n",
        "score": 3.4174751787144353e-13
      },
      {
        "question": "Wie viel kosteten Brandf\u00e4lle durch Explosionen die Versicherer im Kanton Aargau in den Jahren 1980, 1990, 2000 und 2010 in CHF?",
        "query": "SELECT T.jahr, T.explosion_schaden_1000_chf * 1000 AS explosion_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1980, 1990, 2000, 2010)\nORDER BY T.jahr DESC;\n",
        "score": 0.2716967463493347
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_brandversicherung_brandschaden_anzahl_schadensummen (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\ttotal_anzahl_schadenfalle NUMERIC, \n\ttotal_schaden_1000_chf NUMERIC, \n\tfeuerzeug_rauchzeug_licht_anzahl_schadenfalle NUMERIC, \n\tfeuerzeug_rauchzeug_licht_schaden_1000_chf NUMERIC, \n\telektrizitaet_anzahl_schadenfalle NUMERIC, \n\telektrizitaet_schaden_1000_chf NUMERIC, \n\tvorsatzliche_brandstift_anzahl_schadenfalle NUMERIC, \n\tvorsatzliche_brandstift_schaden_1000_chf NUMERIC, \n\tfeuerungsanlagen_anzahl_schadenfalle NUMERIC, \n\tfeuerungsanlagen_schaden_1000_chf NUMERIC, \n\texplosion_anzahl_schadenfalle NUMERIC, \n\texplosion_schaden_1000_chf NUMERIC, \n\tuebrige_anzahl_schadenfalle NUMERIC, \n\tuebrige_schaden_1000_chf NUMERIC, \n\tunbekannt_anzahl_schadenfalle NUMERIC, \n\tunbekannt_schaden_1000_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_brandversicherung_brandschaden_anzahl_schadensummen_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_brandversicherung_brandschaden_anza_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_brandversicherung_brandschaden_anzahl_schadensummen and 5 examples in each column for high cardinality columns :\nuid : 21, 24, 5, 46, 48\njahr : 2014, 1980, 2006, 1992, 2002\ntotal_anzahl_schadenfalle : 681, 1104, 1232, 1151, 1775\ntotal_schaden_1000_chf : 19549, 24074, 16992, 11789, 22824\nfeuerzeug_rauchzeug_licht_anzahl_schadenfalle : 162, 159, 111, 133, 12\nfeuerzeug_rauchzeug_licht_schaden_1000_chf : 307, 4258, 4685, 1534, 2095\nelektrizitaet_anzahl_schadenfalle : 228, 254, 279, 278, 303\nelektrizitaet_schaden_1000_chf : 4263, 4637, 9548, 1104, 2858\nvorsatzliche_brandstift_anzahl_schadenfalle : 21, 60, 24, 48, 17\nvorsatzliche_brandstift_schaden_1000_chf : 4113, 1134, 2470, 214, 1229\nfeuerungsanlagen_anzahl_schadenfalle : 78, 95, 48, 85, 66\nfeuerungsanlagen_schaden_1000_chf : 728, 1560, 792, 1271, 909\nexplosion_anzahl_schadenfalle : 21, 75, 71, 78, 46\nexplosion_schaden_1000_chf : 624, 719, 681, 1992, 579\nuebrige_anzahl_schadenfalle : 299, 1040, 159, 262, 342\nuebrige_schaden_1000_chf : 5410, 3699, 1734, 2310, 3191\nunbekannt_anzahl_schadenfalle : 21, 61, 46, 48, 66\nunbekannt_schaden_1000_chf : 11513, 11071, 1876, 8678, 3678\n*/\n\n/*\nColumn name, Column discription, Example values\ntotal_anzahl_schadenfalle, Total Anzahl Schadenfalle, 796681857\ntotal_schaden_1000_chf, Totale Schadensumme in 1000 CHF, 182472448024074\nfeuerzeug_rauchzeug_licht_anzahl_schadenfalle, None, 122123132\nfeuerzeug_rauchzeug_licht_schaden_1000_chf, None, 209525525078\nelektrizitaet_anzahl_schadenfalle, None, 234246228\nvorsatzliche_brandstift_schaden_1000_chf, None, 508360635374\nvorsatzliche_brandstift_anzahl_schadenfalle, None, 142225\nbrandstift_schaden_1000_chf, None, 2149632470\nfeuerungsanl_anzahl_schadenfalle, Feuerungsanlagen: Anzahl Schadenf\u00e4lle, 676547\nfeuerungsanl_schaden_1000_chf, Feuerungsanlagen: Totale Schadensumme in 1000 CHF, 15601231792\nexplosion_anzahl_schadenfalle, None, 262125\nexplosion_schaden_1000_chf, None, 7821180211\nuebrige_anzahl_schadenfalle, None, 269176342\nuebrige_schaden_1000_chf, None, 16449331734\nunbekannt_anzahl_schadenfalle, None, 512857\nunbekannt_schaden_1000_chf, None, 675118838678\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWie hoch waren die j\u00e4hrlichen Kosten in CHF f\u00fcr die durch Elektrizit\u00e4t und Explosionen verursachten Brandsch\u00e4den im Kanton Aargau in den Jahren 2001 bis 2007?\n### SQL query\nSELECT T.jahr, T.elektrizitaet_schaden_1000_chf * 1000 AS elektrizitaet_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2001\n    AND T.jahr <= 2007\nORDER BY T.jahr DESC;\n\n\n### Question\nWie viel kosteten Brandf\u00e4lle durch Explosionen die Versicherer im Kanton Aargau in den Jahren 1980, 1990, 2000 und 2010 in CHF?\n### SQL query\nSELECT T.jahr, T.explosion_schaden_1000_chf * 1000 AS explosion_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1980, 1990, 2000, 2010)\nORDER BY T.jahr DESC;\n\n\n### Question\nWie hoch waren die j\u00e4hrlichen Kosten in CHF f\u00fcr die durch Elektrizit\u00e4t und Explosionen verursachten Brandsch\u00e4den im Kanton Aargau in den Jahren 2001 bis 2007?\n### SQL query\n",
    "process_time": 16.246128517901525,
    "num_tokens": 2305,
    "hardness": "unknown",
    "scores": [
      3.4174751787144353e-13,
      0.2716967463493347
    ],
    "lang": "de"
  },
  {
    "i": 91,
    "question": "Wie setzt sich die erneuerbare Energieproduktion im Kanton Thurgau seit 2018 j\u00e4hrlich zusammen?",
    "query": "SELECT\n    T.jahr,\n    SUM(biogasanlagen_abwasser_gwh),\n    SUM(biogasanlagen_industrie_gwh),\n    SUM(biogasanlagen_landwirtschaft_gwh),\n    SUM(biomasse_holz_gwh),\n    SUM(kehricht_gwh),\n    SUM(photovoltaik_gwh),\n    SUM(wasserkraft_gwh),\n    SUM(wind_gwh),\n    SUM(total_gwh)\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr >= 2018\nGROUP BY T.jahr;\n",
    "db_id": "thurgau_erneuerbare_elektrizitatsproduktion_gemeinde",
    "generated_query": "SELECT T.jahr, \n       SUM(T.wasserkraft_gwh) AS wasserkraft, \n       SUM(T.biomasse_holz_gwh) AS biomasse_holz, \n       SUM(T.biogasanlagen_landwirtschaft_gwh) AS biogas_landwirtschaft, \n       SUM(T.kehricht_gwh) AS kehricht, \n       SUM(T.biogasanlagen_industrie_gwh) AS biogas_industrie, \n       SUM(T.biogasanlagen_abwasser_gwh) AS biogas_abwasser, \n       SUM(T.photovoltaik_gwh) AS photovoltaik, \n       SUM(T.wind_gwh) AS wind, \n       SUM(T.total_gwh) AS total\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr >= 2018\nGROUP BY T.jahr\nORDER BY T.jahr;",
    "meta_data": [
      {
        "question": "Wie hoch ist der Anteil der Gemeinden im Kanton Thurgau, die zwischen 2015 und 2021 einen R\u00fcckgang der Produktion von erneuerbaren Energien zu verzeichnen haben?",
        "query": "SELECT 100 * SUM(CASE WHEN T.total_gwh_2015 > T.total_gwh_2021 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_abnahme\nFROM (\n    SELECT\n        S.name,\n        SUM(CASE WHEN T.jahr = 2015 THEN T.total_gwh ELSE 0 END) AS total_gwh_2015,\n        SUM(CASE WHEN T.jahr = 2021 THEN T.total_gwh ELSE 0 END) AS total_gwh_2021\n    FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2015, 2021)\n    GROUP BY S.name\n) AS T;\n",
        "score": 0.2799568176269531
      },
      {
        "question": "Wie viele MWh an erneuerbarer Energie hat Amriswil im Kanton Thurgau von 2016 bis 2020 insgesamt produziert?",
        "query": "SELECT SUM(T.total_gwh) * 1000 AS total_mwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Amriswil', 'Amriswil (TG)')\n    AND T.jahr >= 2016\n    AND T.jahr <= 2020;\n",
        "score": 0.38521674275398254
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.thurgau_erneuerbare_elektrizitatsproduktion_gemeinde (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\teinwohner NUMERIC, \n\twasserkraft_gwh NUMERIC, \n\tbiomasse_holz_gwh NUMERIC, \n\tbiogasanlagen_landwirtschaft_gwh NUMERIC, \n\tkehricht_gwh NUMERIC, \n\tbiogasanlagen_industrie_gwh NUMERIC, \n\tbiogasanlagen_abwasser_gwh NUMERIC, \n\tphotovoltaik_gwh NUMERIC, \n\twind_gwh NUMERIC, \n\ttotal_gwh NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktion_gemeinde_pkey PRIMARY KEY (uid), \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktio_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in thurgau_erneuerbare_elektrizitatsproduktion_gemeinde and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\neinwohner : 2624, 1544, 416, 11559, 418\nwasserkraft_gwh : 0.325000000000000011, 0E-18, 13.651999999999999247, 13.522999999999999687, 0.029000000000000001\nbiogasanlagen_landwirtschaft_gwh : 0E-18, 2.125000000000000000, 0.163000000000000006, 4.825999999999999623, 0.293999999999999984\nbiogasanlagen_abwasser_gwh : 0.1310000000000000053, 0.1189999999999999947, 1.3289999999999999591, 0.2359999999999999876, 0.7630000000000000115\nphotovoltaik_gwh : 4.394000000000000128, 1.080999999999999961, 0.679000000000000048, 5.431000000000000050, 2.501999999999999780\ntotal_gwh : 1.080999999999999961, 0.679000000000000048, 2.892999999999999794, 5.431000000000000050, 9.948999999999999844\nspatialunit_uid : 4446_A.ADM3, 4436_A.ADM3, 4726_A.ADM3, 4716_A.ADM3, 4831_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\neinwohner, Einwohner, 2683,2318,1350\nwasserkraft_gwh, Wasserkraft, GWh, 0,1.234,6.698\nbiomasse_holz_gwh, Biomasse, Holz, GWh, 0,2.266,0.404\nbiogasanlagen_landwirtschaft_gwh, Biogasanlagen, Landwirtschaft, GWh, 0,4.826,0.308\nkehricht_gwh, Kehricht, GWh, 0,49.982734,57.317\nbiogasanlagen_industrie_gwh, Biogasanlagen, Industrie, GWh, 0,0.651573,1.819\nbiogasanlagen_abwasser_gwh, Biogasanlagen, Abwasser, GWh, 0,0.272,1.219\nphotovoltaik_gwh, Solarenergie, GWh, 3.814,1.879,4.268\nwind_gwh, Wind, GWh, 0,0.005,0.006\ntotal_gwh, Total, GWh, 3.814,1.879,9.094\n*/\n\n\n\n### Question\nWie hoch ist der Anteil der Gemeinden im Kanton Thurgau, die zwischen 2015 und 2021 einen R\u00fcckgang der Produktion von erneuerbaren Energien zu verzeichnen haben?\n### SQL query\nSELECT 100 * SUM(CASE WHEN T.total_gwh_2015 > T.total_gwh_2021 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_abnahme\nFROM (\n    SELECT\n        S.name,\n        SUM(CASE WHEN T.jahr = 2015 THEN T.total_gwh ELSE 0 END) AS total_gwh_2015,\n        SUM(CASE WHEN T.jahr = 2021 THEN T.total_gwh ELSE 0 END) AS total_gwh_2021\n    FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2015, 2021)\n    GROUP BY S.name\n) AS T;\n\n\n### Question\nWie viel erneuerbare Energie wird in den 5 gr\u00f6ssten Thurgauer Gemeinden im Jahr 2021 produziert?\n### SQL query\nSELECT S.name AS gemeinde, T.total_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nORDER BY T.einwohner DESC\nLIMIT 5;\n\n\n### Question\nWie setzt sich die erneuerbare Energieproduktion im Kanton Thurgau seit 2018 j\u00e4hrlich zusammen?\n### SQL query\n",
    "process_time": 22.963367130840197,
    "num_tokens": 1901,
    "hardness": "extra",
    "scores": [
      0.2799568176269531,
      0.38521674275398254
    ],
    "lang": "de"
  },
  {
    "i": 92,
    "question": "Wie viel Prozent der erneuerbaren Energie in Frauenfeld TG wurde im Jahr 2021 durch Solarenergie erzeugt?",
    "query": "SELECT\n    100 * photovoltaik_gwh/total_gwh AS photovoltaik_prozent_frauenfeld_2021\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\n    AND S.name IN ('Frauenfeld', 'Frauenfeld (TG)');\n",
    "db_id": "thurgau_erneuerbare_elektrizitatsproduktion_gemeinde",
    "generated_query": "SELECT (T.photovoltaik_gwh / T.total_gwh) * 100 AS percentage\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Frauenfeld', 'Frauenfeld (TG)')\n    AND T.jahr = 2021;",
    "meta_data": [
      {
        "question": "Wie viel erneuerbare Energie wird in den 5 gr\u00f6ssten Thurgauer Gemeinden im Jahr 2021 produziert?",
        "query": "SELECT S.name AS gemeinde, T.total_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nORDER BY T.einwohner DESC\nLIMIT 5;\n",
        "score": 0.5013336539268494
      },
      {
        "question": "Wie viele MWh an erneuerbarer Energie hat Amriswil im Kanton Thurgau von 2016 bis 2020 insgesamt produziert?",
        "query": "SELECT SUM(T.total_gwh) * 1000 AS total_mwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Amriswil', 'Amriswil (TG)')\n    AND T.jahr >= 2016\n    AND T.jahr <= 2020;\n",
        "score": 0.6529144048690796
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.thurgau_erneuerbare_elektrizitatsproduktion_gemeinde (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\teinwohner NUMERIC, \n\twasserkraft_gwh NUMERIC, \n\tbiomasse_holz_gwh NUMERIC, \n\tbiogasanlagen_landwirtschaft_gwh NUMERIC, \n\tkehricht_gwh NUMERIC, \n\tbiogasanlagen_industrie_gwh NUMERIC, \n\tbiogasanlagen_abwasser_gwh NUMERIC, \n\tphotovoltaik_gwh NUMERIC, \n\twind_gwh NUMERIC, \n\ttotal_gwh NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktion_gemeinde_pkey PRIMARY KEY (uid), \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktio_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in thurgau_erneuerbare_elektrizitatsproduktion_gemeinde and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\neinwohner : 2624, 1544, 416, 11559, 418\nwasserkraft_gwh : 0.325000000000000011, 0E-18, 13.651999999999999247, 13.522999999999999687, 0.029000000000000001\nbiogasanlagen_landwirtschaft_gwh : 0E-18, 2.125000000000000000, 0.163000000000000006, 4.825999999999999623, 0.293999999999999984\nbiogasanlagen_abwasser_gwh : 0.1310000000000000053, 0.1189999999999999947, 1.3289999999999999591, 0.2359999999999999876, 0.7630000000000000115\nphotovoltaik_gwh : 4.394000000000000128, 1.080999999999999961, 0.679000000000000048, 5.431000000000000050, 2.501999999999999780\ntotal_gwh : 1.080999999999999961, 0.679000000000000048, 2.892999999999999794, 5.431000000000000050, 9.948999999999999844\nspatialunit_uid : 4446_A.ADM3, 4436_A.ADM3, 4726_A.ADM3, 4716_A.ADM3, 4831_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\neinwohner, Einwohner, 2683,2318,1350\nwasserkraft_gwh, Wasserkraft, GWh, 0,1.234,6.698\nbiomasse_holz_gwh, Biomasse, Holz, GWh, 0,2.266,0.404\nbiogasanlagen_landwirtschaft_gwh, Biogasanlagen, Landwirtschaft, GWh, 0,4.826,0.308\nkehricht_gwh, Kehricht, GWh, 0,49.982734,57.317\nbiogasanlagen_industrie_gwh, Biogasanlagen, Industrie, GWh, 0,0.651573,1.819\nbiogasanlagen_abwasser_gwh, Biogasanlagen, Abwasser, GWh, 0,0.272,1.219\nphotovoltaik_gwh, Solarenergie, GWh, 3.814,1.879,4.268\nwind_gwh, Wind, GWh, 0,0.005,0.006\ntotal_gwh, Total, GWh, 3.814,1.879,9.094\n*/\n\n\n\n### Question\nWie viel erneuerbare Energie wird in den 5 gr\u00f6ssten Thurgauer Gemeinden im Jahr 2021 produziert?\n### SQL query\nSELECT S.name AS gemeinde, T.total_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nORDER BY T.einwohner DESC\nLIMIT 5;\n\n\n### Question\nWie hoch war die Produktion von Solarstrom in Roggwil und Langrickenbach TG in den Jahren 2019 und 2020?\n### SQL query\nSELECT S.name AS gemeinde, T.jahr, T.photovoltaik_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Roggwil', 'Roggwil (TG)', 'Langrickenbach', 'Langrickenbach (TG)')\n    AND T.jahr IN (2019, 2020)\nORDER BY S.name, T.jahr;\n\n### Question\nWie viel Prozent der erneuerbaren Energie in Frauenfeld TG wurde im Jahr 2021 durch Solarenergie erzeugt?\n### SQL query\n",
    "process_time": 6.168552967021242,
    "num_tokens": 1809,
    "hardness": "unknown",
    "scores": [
      0.5013336539268494,
      0.6529144048690796
    ],
    "lang": "de"
  },
  {
    "i": 93,
    "question": "Wie viele Gemeinden im Kanton Thurgau produzierten im Jahr 2019 Energie aus Wind?",
    "query": "SELECT\n    COUNT(*) AS anzahl_gemeinden_wind_2019\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\n    AND T.wind_gwh > 0;\n",
    "db_id": "thurgau_erneuerbare_elektrizitatsproduktion_gemeinde",
    "generated_query": "SELECT COUNT(*) AS anzahl_gemeinden\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr = 2019\n    AND T.wind_gwh > 0;",
    "meta_data": [
      {
        "question": "Welche Gemeinde im Kanton Thurgau produziert im Jahr 2020 im Verh\u00e4ltnis zur Einwohnerzahl am meisten erneuerbare Energie?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.total_gwh / T.einwohner DESC\nLIMIT 1;\n",
        "score": 0.41813406348228455
      },
      {
        "question": "Wie viele MWh an erneuerbarer Energie hat Amriswil im Kanton Thurgau von 2016 bis 2020 insgesamt produziert?",
        "query": "SELECT SUM(T.total_gwh) * 1000 AS total_mwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Amriswil', 'Amriswil (TG)')\n    AND T.jahr >= 2016\n    AND T.jahr <= 2020;\n",
        "score": 0.4651912450790405
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.thurgau_erneuerbare_elektrizitatsproduktion_gemeinde (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\teinwohner NUMERIC, \n\twasserkraft_gwh NUMERIC, \n\tbiomasse_holz_gwh NUMERIC, \n\tbiogasanlagen_landwirtschaft_gwh NUMERIC, \n\tkehricht_gwh NUMERIC, \n\tbiogasanlagen_industrie_gwh NUMERIC, \n\tbiogasanlagen_abwasser_gwh NUMERIC, \n\tphotovoltaik_gwh NUMERIC, \n\twind_gwh NUMERIC, \n\ttotal_gwh NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktion_gemeinde_pkey PRIMARY KEY (uid), \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktio_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in thurgau_erneuerbare_elektrizitatsproduktion_gemeinde and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\neinwohner : 2624, 1544, 416, 11559, 418\nwasserkraft_gwh : 0.325000000000000011, 0E-18, 13.651999999999999247, 13.522999999999999687, 0.029000000000000001\nbiogasanlagen_landwirtschaft_gwh : 0E-18, 2.125000000000000000, 0.163000000000000006, 4.825999999999999623, 0.293999999999999984\nbiogasanlagen_abwasser_gwh : 0.1310000000000000053, 0.1189999999999999947, 1.3289999999999999591, 0.2359999999999999876, 0.7630000000000000115\nphotovoltaik_gwh : 4.394000000000000128, 1.080999999999999961, 0.679000000000000048, 5.431000000000000050, 2.501999999999999780\ntotal_gwh : 1.080999999999999961, 0.679000000000000048, 2.892999999999999794, 5.431000000000000050, 9.948999999999999844\nspatialunit_uid : 4446_A.ADM3, 4436_A.ADM3, 4726_A.ADM3, 4716_A.ADM3, 4831_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\neinwohner, Einwohner, 2683,2318,1350\nwasserkraft_gwh, Wasserkraft, GWh, 0,1.234,6.698\nbiomasse_holz_gwh, Biomasse, Holz, GWh, 0,2.266,0.404\nbiogasanlagen_landwirtschaft_gwh, Biogasanlagen, Landwirtschaft, GWh, 0,4.826,0.308\nkehricht_gwh, Kehricht, GWh, 0,49.982734,57.317\nbiogasanlagen_industrie_gwh, Biogasanlagen, Industrie, GWh, 0,0.651573,1.819\nbiogasanlagen_abwasser_gwh, Biogasanlagen, Abwasser, GWh, 0,0.272,1.219\nphotovoltaik_gwh, Solarenergie, GWh, 3.814,1.879,4.268\nwind_gwh, Wind, GWh, 0,0.005,0.006\ntotal_gwh, Total, GWh, 3.814,1.879,9.094\n*/\n\n\n\n### Question\nWie viel erneuerbare Energie wird in den 5 gr\u00f6ssten Thurgauer Gemeinden im Jahr 2021 produziert?\n### SQL query\nSELECT S.name AS gemeinde, T.total_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nORDER BY T.einwohner DESC\nLIMIT 5;\n\n\n### Question\nWie hoch war die Produktion von Solarstrom in Roggwil und Langrickenbach TG in den Jahren 2019 und 2020?\n### SQL query\nSELECT S.name AS gemeinde, T.jahr, T.photovoltaik_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Roggwil', 'Roggwil (TG)', 'Langrickenbach', 'Langrickenbach (TG)')\n    AND T.jahr IN (2019, 2020)\nORDER BY S.name, T.jahr;\n\n### Question\nWie viele Gemeinden im Kanton Thurgau produzierten im Jahr 2019 Energie aus Wind?\n### SQL query\n",
    "process_time": 6.243329857010394,
    "num_tokens": 1803,
    "hardness": "unknown",
    "scores": [
      0.41813406348228455,
      0.4651912450790405
    ],
    "lang": "de"
  },
  {
    "i": 94,
    "question": "Welche 3 Thurgauer Gemeinden weisen zwischen 2018 und 2021 den gr\u00f6ssten Zuwachs an erneuerbarer Energieproduktion auf? Geben Sie auch den prozentualen Anstieg an.",
    "query": "SELECT\n    S.name AS gemeinde,\n    (\n        100.0 * SUM( CASE WHEN T.jahr = 2021 THEN T.total_gwh ELSE 0 END) /\n        SUM( CASE WHEN T.jahr = 2018 THEN T.total_gwh ELSE 0 END\n    )) AS prozent_anstieg\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2018, 2021)\nGROUP BY S.name\nORDER BY prozent_anstieg DESC\nLIMIT 3;\n",
    "db_id": "thurgau_erneuerbare_elektrizitatsproduktion_gemeinde",
    "generated_query": "SELECT\n    S.name AS gemeinde,\n    T.jahr AS start_jahr,\n    T.total_gwh AS start_produktion,\n    T2.jahr AS end_jahr,\n    T2.total_gwh AS end_produktion,\n    100.0 * (T2.total_gwh - T.total_gwh) / T.total_gwh AS prozentualer_anstieg\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T2 ON T.spatialunit_uid = T2.spatialunit_uid\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2018\n    AND T2.jahr = 2021\nORDER BY prozentualer_anstieg DESC\nLIMIT 3;",
    "meta_data": [
      {
        "question": "Welche 3 Thurgauer Gemeinden hatten im Jahr 2019 den h\u00f6chsten Anteil an Wasserkraft an der gesamten erneuerbaren Energieproduktion und wie hoch war dieser?",
        "query": "SELECT\n    S.name AS gemeinde,\n    100.0 * T.wasserkraft_gwh / T.total_gwh AS prozent_wasserkraft\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY prozent_wasserkraft DESC\nLIMIT 3;\n",
        "score": 0.38188934326171875
      },
      {
        "question": "Wie viel erneuerbare Energie wird in den 5 gr\u00f6ssten Thurgauer Gemeinden im Jahr 2021 produziert?",
        "query": "SELECT S.name AS gemeinde, T.total_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nORDER BY T.einwohner DESC\nLIMIT 5;\n",
        "score": 0.45298174023628235
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.thurgau_erneuerbare_elektrizitatsproduktion_gemeinde (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\teinwohner NUMERIC, \n\twasserkraft_gwh NUMERIC, \n\tbiomasse_holz_gwh NUMERIC, \n\tbiogasanlagen_landwirtschaft_gwh NUMERIC, \n\tkehricht_gwh NUMERIC, \n\tbiogasanlagen_industrie_gwh NUMERIC, \n\tbiogasanlagen_abwasser_gwh NUMERIC, \n\tphotovoltaik_gwh NUMERIC, \n\twind_gwh NUMERIC, \n\ttotal_gwh NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktion_gemeinde_pkey PRIMARY KEY (uid), \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktio_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in thurgau_erneuerbare_elektrizitatsproduktion_gemeinde and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\neinwohner : 2624, 1544, 416, 11559, 418\nwasserkraft_gwh : 0.325000000000000011, 0E-18, 13.651999999999999247, 13.522999999999999687, 0.029000000000000001\nbiogasanlagen_landwirtschaft_gwh : 0E-18, 2.125000000000000000, 0.163000000000000006, 4.825999999999999623, 0.293999999999999984\nbiogasanlagen_abwasser_gwh : 0.1310000000000000053, 0.1189999999999999947, 1.3289999999999999591, 0.2359999999999999876, 0.7630000000000000115\nphotovoltaik_gwh : 4.394000000000000128, 1.080999999999999961, 0.679000000000000048, 5.431000000000000050, 2.501999999999999780\ntotal_gwh : 1.080999999999999961, 0.679000000000000048, 2.892999999999999794, 5.431000000000000050, 9.948999999999999844\nspatialunit_uid : 4446_A.ADM3, 4436_A.ADM3, 4726_A.ADM3, 4716_A.ADM3, 4831_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\neinwohner, Einwohner, 2683,2318,1350\nwasserkraft_gwh, Wasserkraft, GWh, 0,1.234,6.698\nbiomasse_holz_gwh, Biomasse, Holz, GWh, 0,2.266,0.404\nbiogasanlagen_landwirtschaft_gwh, Biogasanlagen, Landwirtschaft, GWh, 0,4.826,0.308\nkehricht_gwh, Kehricht, GWh, 0,49.982734,57.317\nbiogasanlagen_industrie_gwh, Biogasanlagen, Industrie, GWh, 0,0.651573,1.819\nbiogasanlagen_abwasser_gwh, Biogasanlagen, Abwasser, GWh, 0,0.272,1.219\nphotovoltaik_gwh, Solarenergie, GWh, 3.814,1.879,4.268\nwind_gwh, Wind, GWh, 0,0.005,0.006\ntotal_gwh, Total, GWh, 3.814,1.879,9.094\n*/\n\n\n\n### Question\nWie viel erneuerbare Energie wird in den 5 gr\u00f6ssten Thurgauer Gemeinden im Jahr 2021 produziert?\n### SQL query\nSELECT S.name AS gemeinde, T.total_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nORDER BY T.einwohner DESC\nLIMIT 5;\n\n\n### Question\nWelche 3 Thurgauer Gemeinden hatten im Jahr 2019 den h\u00f6chsten Anteil an Wasserkraft an der gesamten erneuerbaren Energieproduktion und wie hoch war dieser?\n### SQL query\nSELECT\n    S.name AS gemeinde,\n    100.0 * T.wasserkraft_gwh / T.total_gwh AS prozent_wasserkraft\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY prozent_wasserkraft DESC\nLIMIT 3;\n\n\n### Question\nWelche 3 Thurgauer Gemeinden weisen zwischen 2018 und 2021 den gr\u00f6ssten Zuwachs an erneuerbarer Energieproduktion auf? Geben Sie auch den prozentualen Anstieg an.\n### SQL query\n",
    "process_time": 21.55510501516983,
    "num_tokens": 1843,
    "hardness": "unknown",
    "scores": [
      0.38188934326171875,
      0.45298174023628235
    ],
    "lang": "de"
  },
  {
    "i": 95,
    "question": "Wie viel erneuerbare Energie hat der Kanton Thurgau im Zeitraum 2017-2021 insgesamt produziert?",
    "query": "SELECT SUM(T.total_gwh) AS total_gwh_2017_2021\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nWHERE T.jahr >= 2017\n    AND T.jahr <= 2021;\n",
    "db_id": "thurgau_erneuerbare_elektrizitatsproduktion_gemeinde",
    "generated_query": "SELECT SUM(T.total_gwh) AS total_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr >= 2017\n    AND T.jahr <= 2021;",
    "meta_data": [
      {
        "question": "Wie viele MWh an erneuerbarer Energie hat Amriswil im Kanton Thurgau von 2016 bis 2020 insgesamt produziert?",
        "query": "SELECT SUM(T.total_gwh) * 1000 AS total_mwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Amriswil', 'Amriswil (TG)')\n    AND T.jahr >= 2016\n    AND T.jahr <= 2020;\n",
        "score": 0.2611115574836731
      },
      {
        "question": "Welche Gemeinde im Kanton Thurgau produziert im Jahr 2020 im Verh\u00e4ltnis zur Einwohnerzahl am meisten erneuerbare Energie?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.total_gwh / T.einwohner DESC\nLIMIT 1;\n",
        "score": 0.27179422974586487
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.thurgau_erneuerbare_elektrizitatsproduktion_gemeinde (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\teinwohner NUMERIC, \n\twasserkraft_gwh NUMERIC, \n\tbiomasse_holz_gwh NUMERIC, \n\tbiogasanlagen_landwirtschaft_gwh NUMERIC, \n\tkehricht_gwh NUMERIC, \n\tbiogasanlagen_industrie_gwh NUMERIC, \n\tbiogasanlagen_abwasser_gwh NUMERIC, \n\tphotovoltaik_gwh NUMERIC, \n\twind_gwh NUMERIC, \n\ttotal_gwh NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktion_gemeinde_pkey PRIMARY KEY (uid), \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktio_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in thurgau_erneuerbare_elektrizitatsproduktion_gemeinde and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\neinwohner : 2624, 1544, 416, 11559, 418\nwasserkraft_gwh : 0.325000000000000011, 0E-18, 13.651999999999999247, 13.522999999999999687, 0.029000000000000001\nbiogasanlagen_landwirtschaft_gwh : 0E-18, 2.125000000000000000, 0.163000000000000006, 4.825999999999999623, 0.293999999999999984\nbiogasanlagen_abwasser_gwh : 0.1310000000000000053, 0.1189999999999999947, 1.3289999999999999591, 0.2359999999999999876, 0.7630000000000000115\nphotovoltaik_gwh : 4.394000000000000128, 1.080999999999999961, 0.679000000000000048, 5.431000000000000050, 2.501999999999999780\ntotal_gwh : 1.080999999999999961, 0.679000000000000048, 2.892999999999999794, 5.431000000000000050, 9.948999999999999844\nspatialunit_uid : 4446_A.ADM3, 4436_A.ADM3, 4726_A.ADM3, 4716_A.ADM3, 4831_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\neinwohner, Einwohner, 2683,2318,1350\nwasserkraft_gwh, Wasserkraft, GWh, 0,1.234,6.698\nbiomasse_holz_gwh, Biomasse, Holz, GWh, 0,2.266,0.404\nbiogasanlagen_landwirtschaft_gwh, Biogasanlagen, Landwirtschaft, GWh, 0,4.826,0.308\nkehricht_gwh, Kehricht, GWh, 0,49.982734,57.317\nbiogasanlagen_industrie_gwh, Biogasanlagen, Industrie, GWh, 0,0.651573,1.819\nbiogasanlagen_abwasser_gwh, Biogasanlagen, Abwasser, GWh, 0,0.272,1.219\nphotovoltaik_gwh, Solarenergie, GWh, 3.814,1.879,4.268\nwind_gwh, Wind, GWh, 0,0.005,0.006\ntotal_gwh, Total, GWh, 3.814,1.879,9.094\n*/\n\n\n\n### Question\nWie viel erneuerbare Energie wird in den 5 gr\u00f6ssten Thurgauer Gemeinden im Jahr 2021 produziert?\n### SQL query\nSELECT S.name AS gemeinde, T.total_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nORDER BY T.einwohner DESC\nLIMIT 5;\n\n\n### Question\nWie viele MWh an erneuerbarer Energie hat Amriswil im Kanton Thurgau von 2016 bis 2020 insgesamt produziert?\n### SQL query\nSELECT SUM(T.total_gwh) * 1000 AS total_mwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Amriswil', 'Amriswil (TG)')\n    AND T.jahr >= 2016\n    AND T.jahr <= 2020;\n\n\n### Question\nWie viel erneuerbare Energie hat der Kanton Thurgau im Zeitraum 2017-2021 insgesamt produziert?\n### SQL query\n",
    "process_time": 9.223630965920165,
    "num_tokens": 1809,
    "hardness": "unknown",
    "scores": [
      0.2611115574836731,
      0.27179422974586487
    ],
    "lang": "de"
  },
  {
    "i": 96,
    "question": "Zeigen Sie mir die Produktion von Energie aus Sonne und Wind in Berg, TG im Jahr 2018.",
    "query": "SELECT T.photovoltaik_gwh, T.wind_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Berg', 'Berg (TG)')\n    AND T.jahr = 2018;\n",
    "db_id": "thurgau_erneuerbare_elektrizitatsproduktion_gemeinde",
    "generated_query": "SELECT T.photovoltaik_gwh, T.wind_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Berg'\n    AND T.jahr = 2018;",
    "meta_data": [
      {
        "question": "Zeigen Sie mir 2 Aargauer Gemeinden, die im Jahr 2019 der wichtigste Produzent von Energie aus Holzbiomasse waren.",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n",
        "score": 0.514456033706665
      },
      {
        "question": "Wie hoch war die Produktion von Solarstrom in Roggwil und Langrickenbach TG in den Jahren 2019 und 2020?",
        "query": "SELECT S.name AS gemeinde, T.jahr, T.photovoltaik_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Roggwil', 'Roggwil (TG)', 'Langrickenbach', 'Langrickenbach (TG)')\n    AND T.jahr IN (2019, 2020)\nORDER BY S.name, T.jahr;",
        "score": 0.6592934131622314
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.thurgau_erneuerbare_elektrizitatsproduktion_gemeinde (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\teinwohner NUMERIC, \n\twasserkraft_gwh NUMERIC, \n\tbiomasse_holz_gwh NUMERIC, \n\tbiogasanlagen_landwirtschaft_gwh NUMERIC, \n\tkehricht_gwh NUMERIC, \n\tbiogasanlagen_industrie_gwh NUMERIC, \n\tbiogasanlagen_abwasser_gwh NUMERIC, \n\tphotovoltaik_gwh NUMERIC, \n\twind_gwh NUMERIC, \n\ttotal_gwh NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktion_gemeinde_pkey PRIMARY KEY (uid), \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktio_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in thurgau_erneuerbare_elektrizitatsproduktion_gemeinde and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\neinwohner : 2624, 1544, 416, 11559, 418\nwasserkraft_gwh : 0.325000000000000011, 0E-18, 13.651999999999999247, 13.522999999999999687, 0.029000000000000001\nbiogasanlagen_landwirtschaft_gwh : 0E-18, 2.125000000000000000, 0.163000000000000006, 4.825999999999999623, 0.293999999999999984\nbiogasanlagen_abwasser_gwh : 0.1310000000000000053, 0.1189999999999999947, 1.3289999999999999591, 0.2359999999999999876, 0.7630000000000000115\nphotovoltaik_gwh : 4.394000000000000128, 1.080999999999999961, 0.679000000000000048, 5.431000000000000050, 2.501999999999999780\ntotal_gwh : 1.080999999999999961, 0.679000000000000048, 2.892999999999999794, 5.431000000000000050, 9.948999999999999844\nspatialunit_uid : 4446_A.ADM3, 4436_A.ADM3, 4726_A.ADM3, 4716_A.ADM3, 4831_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\neinwohner, Einwohner, 2683,2318,1350\nwasserkraft_gwh, Wasserkraft, GWh, 0,1.234,6.698\nbiomasse_holz_gwh, Biomasse, Holz, GWh, 0,2.266,0.404\nbiogasanlagen_landwirtschaft_gwh, Biogasanlagen, Landwirtschaft, GWh, 0,4.826,0.308\nkehricht_gwh, Kehricht, GWh, 0,49.982734,57.317\nbiogasanlagen_industrie_gwh, Biogasanlagen, Industrie, GWh, 0,0.651573,1.819\nbiogasanlagen_abwasser_gwh, Biogasanlagen, Abwasser, GWh, 0,0.272,1.219\nphotovoltaik_gwh, Solarenergie, GWh, 3.814,1.879,4.268\nwind_gwh, Wind, GWh, 0,0.005,0.006\ntotal_gwh, Total, GWh, 3.814,1.879,9.094\n*/\n\n\n\n### Question\nWie hoch war die Produktion von Solarstrom in Roggwil und Langrickenbach TG in den Jahren 2019 und 2020?\n### SQL query\nSELECT S.name AS gemeinde, T.jahr, T.photovoltaik_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Roggwil', 'Roggwil (TG)', 'Langrickenbach', 'Langrickenbach (TG)')\n    AND T.jahr IN (2019, 2020)\nORDER BY S.name, T.jahr;\n\n### Question\nWie viel erneuerbare Energie wird in den 5 gr\u00f6ssten Thurgauer Gemeinden im Jahr 2021 produziert?\n### SQL query\nSELECT S.name AS gemeinde, T.total_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nORDER BY T.einwohner DESC\nLIMIT 5;\n\n\n### Question\nZeigen Sie mir die Produktion von Energie aus Sonne und Wind in Berg, TG im Jahr 2018.\n### SQL query\n",
    "process_time": 5.3530040921177715,
    "num_tokens": 1805,
    "hardness": "unknown",
    "scores": [
      0.514456033706665,
      0.6592934131622314
    ],
    "lang": "de"
  },
  {
    "i": 97,
    "question": "In welchem Jahr erreichte die Zahl der Besch\u00e4ftigten im prim\u00e4ren Sektor im Thurgau ihren H\u00f6hepunkt?",
    "query": "SELECT T.jahr\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.sektor = 'Prim\u00e4r'\nGROUP BY T.jahr\nORDER BY SUM(T.beschaftigte_personen) DESC LIMIT 1;\n",
    "db_id": "thurgau_beschaftigte_nach_sektoren_und_gemeinden",
    "generated_query": "SELECT T.jahr, T.beschaftigte_personen AS beschaftigte_personen_sektor_1\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name = 'Thurgau'\n    AND T.sektor = 'Prim\u00e4r'\nORDER BY T.beschaftigte_personen DESC LIMIT 1;",
    "meta_data": [
      {
        "question": "Wie hoch ist der Anteil (in %) der Thurgauer Gemeinden, in denen 2016 die Zahl der Besch\u00e4ftigten im prim\u00e4ren Sektor h\u00f6her war als im sekund\u00e4ren Sektor?",
        "query": "SELECT (\n    100.0 * COUNT(CASE WHEN T.beschaftigte_personen_sektor_1 > T.beschaftigte_personen_sektor_2 THEN 1 END) /\n    COUNT(*)\n) AS prozent_gemeinden_hohere_sektor_1\nFROM (\n    SELECT\n        S.name AS gemeinde,\n        SUM(CASE WHEN T.sektor = 'Prim\u00e4r' THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1,\n        SUM(CASE WHEN T.sektor = 'Sekund\u00e4r' THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_2\n    FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2016\n    GROUP BY S.name\n) AS T;\n",
        "score": 0.6015082001686096
      },
      {
        "question": "Wie hoch war die Zahl der Besch\u00e4ftigten pro Wirtschaftszweig im Kanton Thurgau in den Jahren 2017 bis 2020?",
        "query": "SELECT T.jahr, T.sektor, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr >= 2017\n    AND T.jahr <= 2020\nGROUP BY T.sektor, T.jahr;\n",
        "score": 0.7255007028579712
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.thurgau_beschaftigte_nach_sektoren_und_gemeinden (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tsektor TEXT, \n\tbeschaftigte_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT thurgau_beschaftigte_nach_sektoren_und_gemeinden_pkey PRIMARY KEY (uid), \n\tCONSTRAINT thurgau_beschaftigte_nach_sektoren_und_gem_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in thurgau_beschaftigte_nach_sektoren_und_gemeinden and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nbeschaftigte_personen : 157, 149, 95, 814, 352\nspatialunit_uid : 4446_A.ADM3, 4436_A.ADM3, 4726_A.ADM3, 4716_A.ADM3, 4476_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nsektor, Wirtschaftssektor, Terti\u00e4r,Prim\u00e4r,Sekund\u00e4r\nbeschaftigte_personen, Besch\u00e4ftigte Personen, 4871,363,1077\n*/\n\n\n\n### Question\nWie viele Personen waren im Jahr 2015 in der Stadt Frauenfeld im Kanton Thurgau im sekund\u00e4ren Sektor besch\u00e4ftigt?\n### SQL query\nSELECT T.beschaftigte_personen\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Frauenfeld', 'Frauenfeld (TG)')\n    AND T.jahr = 2015\n    AND T.sektor = 'Sekund\u00e4r';\n\n\n### Question\nWie viele Besch\u00e4ftigte hatte die Stadt Frauenfeld TG im terti\u00e4ren Sektor bisher maximal und wann?\n### SQL query\nSELECT T.jahr, T.beschaftigte_personen AS beschaftigte_personen_sektor_3\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Frauenfeld', 'Frauenfeld (TG)')\n    AND T.sektor = 'Terti\u00e4r'\nORDER BY T.beschaftigte_personen DESC LIMIT 1;\n\n### Question\nIn welchem Jahr erreichte die Zahl der Besch\u00e4ftigten im prim\u00e4ren Sektor im Thurgau ihren H\u00f6hepunkt?\n### SQL query\n",
    "process_time": 7.697698563104495,
    "num_tokens": 1193,
    "hardness": "extra",
    "scores": [
      0.6015082001686096,
      0.7255007028579712
    ],
    "lang": "de"
  },
  {
    "i": 98,
    "question": "Wie hoch ist die relative Ver\u00e4nderung der Besch\u00e4ftigten in den einzelnen Wirtschaftssektoren im Thurgau in Prozent zwischen 2011 und 2021?",
    "query": "SELECT\n    AGG.sektor,\n    (\n        100.0 *\n        (AGG.beschaftigte_personen_2021 - AGG.beschaftigte_personen_2011) /\n        AGG.beschaftigte_personen_2011\n    ) AS relative_veranderung_beschaftigte_personen\nFROM (\n    SELECT\n        T.sektor,\n        SUM(CASE WHEN T.jahr = 2021 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_2021,\n        SUM(CASE WHEN T.jahr = 2011 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_2011\n    FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2011, 2021)\n    GROUP BY T.sektor\n) AS AGG;\n",
    "db_id": "thurgau_beschaftigte_nach_sektoren_und_gemeinden",
    "generated_query": "SELECT T.sektor, ((SUM(T.beschaftigte_personen) - T2011.total_besch\u00e4ftigte) / T2011.total_besch\u00e4ftigte) * 100 AS relative_ver\u00e4nderung\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nJOIN (\n    SELECT SUM(beschaftigte_personen) AS total_besch\u00e4ftigte\n    FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden\n    WHERE jahr = 2011\n) AS T2011 ON 1=1\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nGROUP BY T.sektor;",
    "meta_data": [
      {
        "question": "Wie hoch war die Zahl der Besch\u00e4ftigten pro Wirtschaftszweig im Kanton Thurgau in den Jahren 2017 bis 2020?",
        "query": "SELECT T.jahr, T.sektor, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr >= 2017\n    AND T.jahr <= 2020\nGROUP BY T.sektor, T.jahr;\n",
        "score": 0.5077242255210876
      },
      {
        "question": "In welcher Thurgauer Gemeinde ist die Zahl der Besch\u00e4ftigten zwischen 2015 und 2020 am st\u00e4rksten gewachsen?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2015, 2020)\nGROUP BY S.name\nORDER BY (\n    100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.beschaftigte_personen ELSE 0 END) /\n    SUM(CASE WHEN T.jahr = 2015 THEN T.beschaftigte_personen ELSE 0 END)\n) DESC LIMIT 1;\n",
        "score": 0.641869068145752
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.thurgau_beschaftigte_nach_sektoren_und_gemeinden (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tsektor TEXT, \n\tbeschaftigte_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT thurgau_beschaftigte_nach_sektoren_und_gemeinden_pkey PRIMARY KEY (uid), \n\tCONSTRAINT thurgau_beschaftigte_nach_sektoren_und_gem_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in thurgau_beschaftigte_nach_sektoren_und_gemeinden and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nbeschaftigte_personen : 157, 149, 95, 814, 352\nspatialunit_uid : 4446_A.ADM3, 4436_A.ADM3, 4726_A.ADM3, 4716_A.ADM3, 4476_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nsektor, Wirtschaftssektor, Terti\u00e4r,Prim\u00e4r,Sekund\u00e4r\nbeschaftigte_personen, Besch\u00e4ftigte Personen, 4871,363,1077\n*/\n\n\n\n### Question\nWie viele Besch\u00e4ftigte des terti\u00e4ren Sektors waren 2011 und 2021 im Kanton Thurgau t\u00e4tig?\n### SQL query\nSELECT T.jahr, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2011, 2021)\n    AND T.sektor = 'Terti\u00e4r'\nGROUP BY T.jahr;\n\n\n### Question\nWie hoch war die Zahl der Besch\u00e4ftigten pro Wirtschaftszweig im Kanton Thurgau in den Jahren 2017 bis 2020?\n### SQL query\nSELECT T.jahr, T.sektor, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr >= 2017\n    AND T.jahr <= 2020\nGROUP BY T.sektor, T.jahr;\n\n\n### Question\nWie hoch ist die relative Ver\u00e4nderung der Besch\u00e4ftigten in den einzelnen Wirtschaftssektoren im Thurgau in Prozent zwischen 2011 und 2021?\n### SQL query\n",
    "process_time": 11.088402459863573,
    "num_tokens": 1204,
    "hardness": "unknown",
    "scores": [
      0.5077242255210876,
      0.641869068145752
    ],
    "lang": "de"
  },
  {
    "i": 99,
    "question": "Wie viele Personen waren 2015 im prim\u00e4ren Sektor in Uttwil TG besch\u00e4ftigt?",
    "query": "SELECT T.beschaftigte_personen\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Uttwil', 'Uttwil (TG)')\n    AND T.jahr = 2015\n    AND T.sektor = 'Prim\u00e4r';\n",
    "db_id": "thurgau_beschaftigte_nach_sektoren_und_gemeinden",
    "generated_query": "SELECT T.beschaftigte_personen\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Uttwil', 'Uttwil (TG)')\n    AND T.jahr = 2015\n    AND T.sektor = 'Prim\u00e4r';",
    "meta_data": [
      {
        "question": "Wie viele Personen waren im Jahr 2015 in der Stadt Frauenfeld im Kanton Thurgau im sekund\u00e4ren Sektor besch\u00e4ftigt?",
        "query": "SELECT T.beschaftigte_personen\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Frauenfeld', 'Frauenfeld (TG)')\n    AND T.jahr = 2015\n    AND T.sektor = 'Sekund\u00e4r';\n",
        "score": 0.609021782875061
      },
      {
        "question": "Wie viele Besch\u00e4ftigte des terti\u00e4ren Sektors waren 2011 und 2021 im Kanton Thurgau t\u00e4tig?",
        "query": "SELECT T.jahr, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2011, 2021)\n    AND T.sektor = 'Terti\u00e4r'\nGROUP BY T.jahr;\n",
        "score": 0.8695996999740601
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.thurgau_beschaftigte_nach_sektoren_und_gemeinden (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tsektor TEXT, \n\tbeschaftigte_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT thurgau_beschaftigte_nach_sektoren_und_gemeinden_pkey PRIMARY KEY (uid), \n\tCONSTRAINT thurgau_beschaftigte_nach_sektoren_und_gem_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in thurgau_beschaftigte_nach_sektoren_und_gemeinden and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nbeschaftigte_personen : 157, 149, 95, 814, 352\nspatialunit_uid : 4446_A.ADM3, 4436_A.ADM3, 4726_A.ADM3, 4716_A.ADM3, 4476_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nsektor, Wirtschaftssektor, Terti\u00e4r,Prim\u00e4r,Sekund\u00e4r\nbeschaftigte_personen, Besch\u00e4ftigte Personen, 4871,363,1077\n*/\n\n\n\n### Question\nWie viele Personen waren im Jahr 2015 in der Stadt Frauenfeld im Kanton Thurgau im sekund\u00e4ren Sektor besch\u00e4ftigt?\n### SQL query\nSELECT T.beschaftigte_personen\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Frauenfeld', 'Frauenfeld (TG)')\n    AND T.jahr = 2015\n    AND T.sektor = 'Sekund\u00e4r';\n\n\n### Question\nWie viele Besch\u00e4ftigte des terti\u00e4ren Sektors waren 2011 und 2021 im Kanton Thurgau t\u00e4tig?\n### SQL query\nSELECT T.jahr, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2011, 2021)\n    AND T.sektor = 'Terti\u00e4r'\nGROUP BY T.jahr;\n\n\n### Question\nWie viele Personen waren 2015 im prim\u00e4ren Sektor in Uttwil TG besch\u00e4ftigt?\n### SQL query\n",
    "process_time": 7.774508619913831,
    "num_tokens": 1184,
    "hardness": "unknown",
    "scores": [
      0.609021782875061,
      0.8695996999740601
    ],
    "lang": "de"
  },
  {
    "i": 100,
    "question": "Wie viele Besch\u00e4ftigte aus dem ersten Sektor gab es in Arbon und Egnach, Thurgau, in den Jahren 2012 und 2019?",
    "query": "SELECT S.name AS gemeinde, T.jahr, SUM(T.beschaftigte_personen) AS beschaftigte_personen_sektor_1\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Arbon', 'Arbon (TG)', 'Egnach', 'Egnach (TG)')\n    AND T.jahr IN (2012, 2019)\n    AND T.sektor = 'Prim\u00e4r'\nGROUP BY T.jahr, S.name\nORDER BY S.name, T.jahr;\n",
    "db_id": "thurgau_beschaftigte_nach_sektoren_und_gemeinden",
    "generated_query": "SELECT T.jahr, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Arbon', 'Egnach')\n    AND T.jahr IN (2012, 2019)\n    AND T.sektor = 'Prim\u00e4r'\nGROUP BY T.jahr;",
    "meta_data": [
      {
        "question": "Wie viele Besch\u00e4ftigte des terti\u00e4ren Sektors waren 2011 und 2021 im Kanton Thurgau t\u00e4tig?",
        "query": "SELECT T.jahr, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2011, 2021)\n    AND T.sektor = 'Terti\u00e4r'\nGROUP BY T.jahr;\n",
        "score": 0.543373703956604
      },
      {
        "question": "Welche Thurgauer Gemeinde hatte im Jahr 2020 die wenigsten Besch\u00e4ftigten?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.beschaftigte_personen) ASC LIMIT 1;\n",
        "score": 0.7199662327766418
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.thurgau_beschaftigte_nach_sektoren_und_gemeinden (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tsektor TEXT, \n\tbeschaftigte_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT thurgau_beschaftigte_nach_sektoren_und_gemeinden_pkey PRIMARY KEY (uid), \n\tCONSTRAINT thurgau_beschaftigte_nach_sektoren_und_gem_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in thurgau_beschaftigte_nach_sektoren_und_gemeinden and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nbeschaftigte_personen : 157, 149, 95, 814, 352\nspatialunit_uid : 4446_A.ADM3, 4436_A.ADM3, 4726_A.ADM3, 4716_A.ADM3, 4476_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nsektor, Wirtschaftssektor, Terti\u00e4r,Prim\u00e4r,Sekund\u00e4r\nbeschaftigte_personen, Besch\u00e4ftigte Personen, 4871,363,1077\n*/\n\n\n\n### Question\nWie viele Besch\u00e4ftigte des terti\u00e4ren Sektors waren 2011 und 2021 im Kanton Thurgau t\u00e4tig?\n### SQL query\nSELECT T.jahr, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2011, 2021)\n    AND T.sektor = 'Terti\u00e4r'\nGROUP BY T.jahr;\n\n\n### Question\nWie viele Personen waren im Jahr 2015 in der Stadt Frauenfeld im Kanton Thurgau im sekund\u00e4ren Sektor besch\u00e4ftigt?\n### SQL query\nSELECT T.beschaftigte_personen\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Frauenfeld', 'Frauenfeld (TG)')\n    AND T.jahr = 2015\n    AND T.sektor = 'Sekund\u00e4r';\n\n\n### Question\nWie viele Besch\u00e4ftigte aus dem ersten Sektor gab es in Arbon und Egnach, Thurgau, in den Jahren 2012 und 2019?\n### SQL query\n",
    "process_time": 10.785310612991452,
    "num_tokens": 1199,
    "hardness": "unknown",
    "scores": [
      0.543373703956604,
      0.7199662327766418
    ],
    "lang": "de"
  },
  {
    "i": 101,
    "question": "Wie hoch war die monatliche Stickoxidkonzentration (in Teilen pro Milliarde) in der Stadt Z\u00fcrich im Jahr 2019?",
    "query": "SELECT T.monat, T.nox_ppb\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2019\nORDER BY T.monat ASC;\n",
    "db_id": "stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983",
    "generated_query": "SELECT T.monat, T.nox_ppb AS nox_ppb_milliarde\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2019\n    AND T.nox_ppb IS NOT NULL\nORDER BY T.monat ASC;",
    "meta_data": [
      {
        "question": "Wie hoch war die j\u00e4hrliche Durchschnittskonzentration von Stickstoffmonoxid und Stickstoffdioxid in der Stadt Z\u00fcrich in den Jahren 1993, 2003, 2013 und 2023?",
        "query": "SELECT T.jahr, SUM(T.no_ug_m3) / COUNT(T.no_ug_m3) AS jahr_avg_no_ug_m3, SUM(T.no2_ug_m3) / COUNT(T.no2_ug_m3) AS avg_no2_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr IN (1993, 2003, 2013, 2023)\n    AND T.no_ug_m3 IS NOT NULL\nGROUP BY T.jahr;\n",
        "score": 0.36612558364868164
      },
      {
        "question": "Nennen Sie mir die Konzentration von Stickoxiden in der Luft von Z\u00fcrich, in Teilen pro Million (ppm), f\u00fcr den Monat Januar in den Jahren 2017 bis 2021.",
        "query": "SELECT T.jahr, T.nox_ppb / 1000 AS nox_ppm_januar\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.monat = 1\n    AND T.jahr >= 2017\n    AND T.jahr <= 2021\nORDER BY T.jahr ASC;\n",
        "score": 0.39068806171417236
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 (\n\tuid SERIAL NOT NULL, \n\tco_mg_m3 NUMERIC, \n\tno2_ug_m3 NUMERIC, \n\tno_ug_m3 NUMERIC, \n\tnox_ppb NUMERIC, \n\tso2_ug_m3 NUMERIC, \n\to3_ug_m3 NUMERIC, \n\tpm10_ug_m3 NUMERIC, \n\tpn_1_cm3 NUMERIC, \n\tpm2_5_ug_m3 NUMERIC, \n\tjahr INTEGER, \n\tmonat NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983_pkey PRIMARY KEY (uid), \n\tCONSTRAINT stadt_zurich_monatlich_luftqualitatsmessun_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nco_mg_m3 : 0.66300000000000003, 2.21296296296296280, 1.49193548387096775, 0.89551724137931032, 1.31733333333333325\nno2_ug_m3 : 37.829032258064515, 59.168666666666667, 93.349999999999994, 48.944333333333333, 70.531666666666666\nno_ug_m3 : 21.7035483870967738, 103.6845161290322608, 61.0365517241379294, 15.3393548387096779, 79.2969999999999970\nnox_ppb : 128.5667741935483832, 86.2016666666666680, 97.6429032258064495, 37.0526666666666671, 154.3617241379310201\nso2_ug_m3 : 106.47208333333333030, 28.39466666666666583, 25.29035714285714320, 4.06967741935483840, 30.18064516129032171\no3_ug_m3 : 11.4648148148148152, 29.6768965517241377, 23.2810344827586206, 20.9789999999999992, 63.5226666666666659\njahr : 1992, 1996, 1990, 1989, 1994\nmonat : 1, 5, 6, 7, 11\n*/\n\n/*\nColumn name, Column discription, Example values\nco_mg_m3, Kohlenmonoxid (CO) in mg/m3, 3.69741935483871,2.3325,2.45451612903226\nno2_ug_m3, Stickstoffdioxid (NO2) in \u00b5g/m3, 38.5848387096774,47.8067857142857,48.0387096774194\nno_ug_m3, Stickstoffmonoxid (NO) in \u00b5g/m3, 162.903870967742,157.969285714286,171.871290322581\nnox_ppb, Stickstoffoxide (NOx) in ppb, 150.781612903226,151.648214285714,162.916774193548\nso2_ug_m3, Schwefeldioxid (SO2) in \u00b5g/m3, 83.6127586206897,100.517142857143,69.5396666666667\no3_ug_m3, Ozon (O3) in \u00b5g/m3, 11.4648148148148,6.99464285714286\npm10_ug_m3, Schwebestaub PM10 (Durchmesser 10\u00b5m oder weniger) in \u00b5g/m3, 33.9512,30.7521428571429\npn_1_cm3, Partikelanzahl pro cm3, 23403.0509090909,12632.1964516129\npm2_5_ug_m3, Schwebestaub PM2.5 (Durchmesser 2,5\u00b5m oder weniger) in \u00b5g/m3, 26.6368181818182,16.9007407407407\nmonat, Monat, 1,2,3\n*/\n\n\n\n### Question\nWie hoch war die j\u00e4hrliche Durchschnittskonzentration von Stickstoffmonoxid und Stickstoffdioxid in der Stadt Z\u00fcrich in den Jahren 1993, 2003, 2013 und 2023?\n### SQL query\nSELECT T.jahr, SUM(T.no_ug_m3) / COUNT(T.no_ug_m3) AS jahr_avg_no_ug_m3, SUM(T.no2_ug_m3) / COUNT(T.no2_ug_m3) AS avg_no2_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr IN (1993, 2003, 2013, 2023)\n    AND T.no_ug_m3 IS NOT NULL\nGROUP BY T.jahr;\n\n\n### Question\nNennen Sie mir die Konzentration von Stickoxiden in der Luft von Z\u00fcrich, in Teilen pro Million (ppm), f\u00fcr den Monat Januar in den Jahren 2017 bis 2021.\n### SQL query\nSELECT T.jahr, T.nox_ppb / 1000 AS nox_ppm_januar\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.monat = 1\n    AND T.jahr >= 2017\n    AND T.jahr <= 2021\nORDER BY T.jahr ASC;\n\n\n### Question\nWie hoch war die monatliche Stickoxidkonzentration (in Teilen pro Milliarde) in der Stadt Z\u00fcrich im Jahr 2019?\n### SQL query\n",
    "process_time": 11.570826321840286,
    "num_tokens": 2072,
    "hardness": "hard",
    "scores": [
      0.36612558364868164,
      0.39068806171417236
    ],
    "lang": "de"
  },
  {
    "i": 102,
    "question": "Wie hoch war die durchschnittliche Kohlenmonoxid-Konzentration in der Z\u00fcrcher Luft im Januar und im Juli, bezogen auf den Zeitraum 1990-2000?",
    "query": "SELECT\n    T.monat,\n    SUM(T.co_mg_m3) / COUNT(T.co_mg_m3) AS avg_co_mg_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr >= 1990\n    AND T.jahr <= 2000\n    AND T.co_mg_m3 IS NOT NULL\n    AND T.monat IN (1, 7)\nGROUP BY T.monat;\n",
    "db_id": "stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983",
    "generated_query": "SELECT T.monat, AVG(T.co_mg_m3) AS avg_co_mg_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr BETWEEN 1990 AND 2000\n    AND (T.monat = 1 OR T.monat = 7)\n    AND T.co_mg_m3 IS NOT NULL\nGROUP BY T.monat;",
    "meta_data": [
      {
        "question": "Wie hoch war die Schwefeldioxidkonzentration in der Luft in Z\u00fcrich im Jahr 2019? Geben Sie die Konzentration in Milligramm pro Kubikmeter an.",
        "query": "SELECT T.monat, T.so2_ug_m3 / 1000 AS so2_mg_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2019\nORDER BY T.monat ASC;\n",
        "score": 0.8639346361160278
      },
      {
        "question": "Wie hoch war die CO- und SO2-Konzentration (beide in Mikrogramm/m3) in Z\u00fcrich zwischen Oktober 1999 und Juli 2000?",
        "query": "SELECT T.jahr, T.monat, T.co_mg_m3 * 1000 AS co_ug_m3, T.so2_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND\n    (\n        (T.jahr = 1999 AND T.monat >= 10)\n        OR (T.jahr = 2000 AND T.monat <= 7)\n    )\n    AND T.co_mg_m3 IS NOT NULL\nORDER BY T.jahr ASC, T.monat ASC;\n",
        "score": 0.9196493625640869
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 (\n\tuid SERIAL NOT NULL, \n\tco_mg_m3 NUMERIC, \n\tno2_ug_m3 NUMERIC, \n\tno_ug_m3 NUMERIC, \n\tnox_ppb NUMERIC, \n\tso2_ug_m3 NUMERIC, \n\to3_ug_m3 NUMERIC, \n\tpm10_ug_m3 NUMERIC, \n\tpn_1_cm3 NUMERIC, \n\tpm2_5_ug_m3 NUMERIC, \n\tjahr INTEGER, \n\tmonat NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983_pkey PRIMARY KEY (uid), \n\tCONSTRAINT stadt_zurich_monatlich_luftqualitatsmessun_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nco_mg_m3 : 0.66300000000000003, 2.21296296296296280, 1.49193548387096775, 0.89551724137931032, 1.31733333333333325\nno2_ug_m3 : 37.829032258064515, 59.168666666666667, 93.349999999999994, 48.944333333333333, 70.531666666666666\nno_ug_m3 : 21.7035483870967738, 103.6845161290322608, 61.0365517241379294, 15.3393548387096779, 79.2969999999999970\nnox_ppb : 128.5667741935483832, 86.2016666666666680, 97.6429032258064495, 37.0526666666666671, 154.3617241379310201\nso2_ug_m3 : 106.47208333333333030, 28.39466666666666583, 25.29035714285714320, 4.06967741935483840, 30.18064516129032171\no3_ug_m3 : 11.4648148148148152, 29.6768965517241377, 23.2810344827586206, 20.9789999999999992, 63.5226666666666659\njahr : 1992, 1996, 1990, 1989, 1994\nmonat : 1, 5, 6, 7, 11\n*/\n\n/*\nColumn name, Column discription, Example values\nco_mg_m3, Kohlenmonoxid (CO) in mg/m3, 3.69741935483871,2.3325,2.45451612903226\nno2_ug_m3, Stickstoffdioxid (NO2) in \u00b5g/m3, 38.5848387096774,47.8067857142857,48.0387096774194\nno_ug_m3, Stickstoffmonoxid (NO) in \u00b5g/m3, 162.903870967742,157.969285714286,171.871290322581\nnox_ppb, Stickstoffoxide (NOx) in ppb, 150.781612903226,151.648214285714,162.916774193548\nso2_ug_m3, Schwefeldioxid (SO2) in \u00b5g/m3, 83.6127586206897,100.517142857143,69.5396666666667\no3_ug_m3, Ozon (O3) in \u00b5g/m3, 11.4648148148148,6.99464285714286\npm10_ug_m3, Schwebestaub PM10 (Durchmesser 10\u00b5m oder weniger) in \u00b5g/m3, 33.9512,30.7521428571429\npn_1_cm3, Partikelanzahl pro cm3, 23403.0509090909,12632.1964516129\npm2_5_ug_m3, Schwebestaub PM2.5 (Durchmesser 2,5\u00b5m oder weniger) in \u00b5g/m3, 26.6368181818182,16.9007407407407\nmonat, Monat, 1,2,3\n*/\n\n\n\n### Question\nWie hoch war die j\u00e4hrliche Durchschnittskonzentration von Stickstoffmonoxid und Stickstoffdioxid in der Stadt Z\u00fcrich in den Jahren 1993, 2003, 2013 und 2023?\n### SQL query\nSELECT T.jahr, SUM(T.no_ug_m3) / COUNT(T.no_ug_m3) AS jahr_avg_no_ug_m3, SUM(T.no2_ug_m3) / COUNT(T.no2_ug_m3) AS avg_no2_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr IN (1993, 2003, 2013, 2023)\n    AND T.no_ug_m3 IS NOT NULL\nGROUP BY T.jahr;\n\n\n### Question\nWie hoch war die CO- und SO2-Konzentration (beide in Mikrogramm/m3) in Z\u00fcrich zwischen Oktober 1999 und Juli 2000?\n### SQL query\nSELECT T.jahr, T.monat, T.co_mg_m3 * 1000 AS co_ug_m3, T.so2_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND\n    (\n        (T.jahr = 1999 AND T.monat >= 10)\n        OR (T.jahr = 2000 AND T.monat <= 7)\n    )\n    AND T.co_mg_m3 IS NOT NULL\nORDER BY T.jahr ASC, T.monat ASC;\n\n\n### Question\nWie hoch war die durchschnittliche Kohlenmonoxid-Konzentration in der Z\u00fcrcher Luft im Januar und im Juli, bezogen auf den Zeitraum 1990-2000?\n### SQL query\n",
    "process_time": 9.583864449057728,
    "num_tokens": 2114,
    "hardness": "unknown",
    "scores": [
      0.8639346361160278,
      0.9196493625640869
    ],
    "lang": "de"
  },
  {
    "i": 103,
    "question": "Wie viel Ozon war im Jahr 2005 jeden Monat in der Luft der Stadt Z\u00fcrich?",
    "query": "SELECT T.monat, T.o3_ug_m3 AS o3_ug_m3_2005\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2005;\n",
    "db_id": "stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983",
    "generated_query": "SELECT T.monat, T.o3_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2005;",
    "meta_data": [
      {
        "question": "In welchem Monat gibt es in der Stadt Z\u00fcrich generell am wenigsten Partikel in der Luft?",
        "query": "SELECT T.monat, SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) AS monat_avg_pn_1_cm3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pn_1_cm3 IS NOT NULL\nGROUP BY T.monat\nORDER BY SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) ASC\nLIMIT 1;\n",
        "score": 0.46677446365356445
      },
      {
        "question": "Zeigen Sie mir die Partikelzahl f\u00fcr jeden Monat in Z\u00fcrich, im Durchschnitt aller verf\u00fcgbaren Jahre.",
        "query": "SELECT T.monat, SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) AS avg_pn_1_cm3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pn_1_cm3 IS NOT NULL\nGROUP BY T.monat;\n",
        "score": 0.59542316198349
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 (\n\tuid SERIAL NOT NULL, \n\tco_mg_m3 NUMERIC, \n\tno2_ug_m3 NUMERIC, \n\tno_ug_m3 NUMERIC, \n\tnox_ppb NUMERIC, \n\tso2_ug_m3 NUMERIC, \n\to3_ug_m3 NUMERIC, \n\tpm10_ug_m3 NUMERIC, \n\tpn_1_cm3 NUMERIC, \n\tpm2_5_ug_m3 NUMERIC, \n\tjahr INTEGER, \n\tmonat NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983_pkey PRIMARY KEY (uid), \n\tCONSTRAINT stadt_zurich_monatlich_luftqualitatsmessun_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nco_mg_m3 : 0.66300000000000003, 2.21296296296296280, 1.49193548387096775, 0.89551724137931032, 1.31733333333333325\nno2_ug_m3 : 37.829032258064515, 59.168666666666667, 93.349999999999994, 48.944333333333333, 70.531666666666666\nno_ug_m3 : 21.7035483870967738, 103.6845161290322608, 61.0365517241379294, 15.3393548387096779, 79.2969999999999970\nnox_ppb : 128.5667741935483832, 86.2016666666666680, 97.6429032258064495, 37.0526666666666671, 154.3617241379310201\nso2_ug_m3 : 106.47208333333333030, 28.39466666666666583, 25.29035714285714320, 4.06967741935483840, 30.18064516129032171\no3_ug_m3 : 11.4648148148148152, 29.6768965517241377, 23.2810344827586206, 20.9789999999999992, 63.5226666666666659\njahr : 1992, 1996, 1990, 1989, 1994\nmonat : 1, 5, 6, 7, 11\n*/\n\n/*\nColumn name, Column discription, Example values\nco_mg_m3, Kohlenmonoxid (CO) in mg/m3, 3.69741935483871,2.3325,2.45451612903226\nno2_ug_m3, Stickstoffdioxid (NO2) in \u00b5g/m3, 38.5848387096774,47.8067857142857,48.0387096774194\nno_ug_m3, Stickstoffmonoxid (NO) in \u00b5g/m3, 162.903870967742,157.969285714286,171.871290322581\nnox_ppb, Stickstoffoxide (NOx) in ppb, 150.781612903226,151.648214285714,162.916774193548\nso2_ug_m3, Schwefeldioxid (SO2) in \u00b5g/m3, 83.6127586206897,100.517142857143,69.5396666666667\no3_ug_m3, Ozon (O3) in \u00b5g/m3, 11.4648148148148,6.99464285714286\npm10_ug_m3, Schwebestaub PM10 (Durchmesser 10\u00b5m oder weniger) in \u00b5g/m3, 33.9512,30.7521428571429\npn_1_cm3, Partikelanzahl pro cm3, 23403.0509090909,12632.1964516129\npm2_5_ug_m3, Schwebestaub PM2.5 (Durchmesser 2,5\u00b5m oder weniger) in \u00b5g/m3, 26.6368181818182,16.9007407407407\nmonat, Monat, 1,2,3\n*/\n\n\n\n### Question\nIn welchem Monat gibt es in der Stadt Z\u00fcrich generell am wenigsten Partikel in der Luft?\n### SQL query\nSELECT T.monat, SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) AS monat_avg_pn_1_cm3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pn_1_cm3 IS NOT NULL\nGROUP BY T.monat\nORDER BY SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) ASC\nLIMIT 1;\n\n\n### Question\nZeigen Sie mir die Partikelzahl f\u00fcr jeden Monat in Z\u00fcrich, im Durchschnitt aller verf\u00fcgbaren Jahre.\n### SQL query\nSELECT T.monat, SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) AS avg_pn_1_cm3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pn_1_cm3 IS NOT NULL\nGROUP BY T.monat;\n\n\n### Question\nWie viel Ozon war im Jahr 2005 jeden Monat in der Luft der Stadt Z\u00fcrich?\n### SQL query\n",
    "process_time": 7.698883973993361,
    "num_tokens": 1991,
    "hardness": "unknown",
    "scores": [
      0.46677446365356445,
      0.59542316198349
    ],
    "lang": "de"
  },
  {
    "i": 104,
    "question": "Wann erreichte die Kohlenmonoxidkonzentration in der Luft in der Stadt Z\u00fcrich ihr Maximum? Geben Sie auch die Konzentration in mg/m3 an.",
    "query": "SELECT T.jahr, T.monat, T.co_mg_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.co_mg_m3 IS NOT NULL\nORDER BY T.co_mg_m3 DESC\nLIMIT 1;\n",
    "db_id": "stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983",
    "generated_query": "SELECT T.jahr, T.monat, T.co_mg_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.co_mg_m3 IS NOT NULL\nORDER BY T.co_mg_m3 DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Wie hoch war die Schwefeldioxidkonzentration in der Luft in Z\u00fcrich im Jahr 2019? Geben Sie die Konzentration in Milligramm pro Kubikmeter an.",
        "query": "SELECT T.monat, T.so2_ug_m3 / 1000 AS so2_mg_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2019\nORDER BY T.monat ASC;\n",
        "score": 0.4734449088573456
      },
      {
        "question": "Wie hoch war die CO- und SO2-Konzentration (beide in Mikrogramm/m3) in Z\u00fcrich zwischen Oktober 1999 und Juli 2000?",
        "query": "SELECT T.jahr, T.monat, T.co_mg_m3 * 1000 AS co_ug_m3, T.so2_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND\n    (\n        (T.jahr = 1999 AND T.monat >= 10)\n        OR (T.jahr = 2000 AND T.monat <= 7)\n    )\n    AND T.co_mg_m3 IS NOT NULL\nORDER BY T.jahr ASC, T.monat ASC;\n",
        "score": 0.7720017433166504
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 (\n\tuid SERIAL NOT NULL, \n\tco_mg_m3 NUMERIC, \n\tno2_ug_m3 NUMERIC, \n\tno_ug_m3 NUMERIC, \n\tnox_ppb NUMERIC, \n\tso2_ug_m3 NUMERIC, \n\to3_ug_m3 NUMERIC, \n\tpm10_ug_m3 NUMERIC, \n\tpn_1_cm3 NUMERIC, \n\tpm2_5_ug_m3 NUMERIC, \n\tjahr INTEGER, \n\tmonat NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983_pkey PRIMARY KEY (uid), \n\tCONSTRAINT stadt_zurich_monatlich_luftqualitatsmessun_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nco_mg_m3 : 0.66300000000000003, 2.21296296296296280, 1.49193548387096775, 0.89551724137931032, 1.31733333333333325\nno2_ug_m3 : 37.829032258064515, 59.168666666666667, 93.349999999999994, 48.944333333333333, 70.531666666666666\nno_ug_m3 : 21.7035483870967738, 103.6845161290322608, 61.0365517241379294, 15.3393548387096779, 79.2969999999999970\nnox_ppb : 128.5667741935483832, 86.2016666666666680, 97.6429032258064495, 37.0526666666666671, 154.3617241379310201\nso2_ug_m3 : 106.47208333333333030, 28.39466666666666583, 25.29035714285714320, 4.06967741935483840, 30.18064516129032171\no3_ug_m3 : 11.4648148148148152, 29.6768965517241377, 23.2810344827586206, 20.9789999999999992, 63.5226666666666659\njahr : 1992, 1996, 1990, 1989, 1994\nmonat : 1, 5, 6, 7, 11\n*/\n\n/*\nColumn name, Column discription, Example values\nco_mg_m3, Kohlenmonoxid (CO) in mg/m3, 3.69741935483871,2.3325,2.45451612903226\nno2_ug_m3, Stickstoffdioxid (NO2) in \u00b5g/m3, 38.5848387096774,47.8067857142857,48.0387096774194\nno_ug_m3, Stickstoffmonoxid (NO) in \u00b5g/m3, 162.903870967742,157.969285714286,171.871290322581\nnox_ppb, Stickstoffoxide (NOx) in ppb, 150.781612903226,151.648214285714,162.916774193548\nso2_ug_m3, Schwefeldioxid (SO2) in \u00b5g/m3, 83.6127586206897,100.517142857143,69.5396666666667\no3_ug_m3, Ozon (O3) in \u00b5g/m3, 11.4648148148148,6.99464285714286\npm10_ug_m3, Schwebestaub PM10 (Durchmesser 10\u00b5m oder weniger) in \u00b5g/m3, 33.9512,30.7521428571429\npn_1_cm3, Partikelanzahl pro cm3, 23403.0509090909,12632.1964516129\npm2_5_ug_m3, Schwebestaub PM2.5 (Durchmesser 2,5\u00b5m oder weniger) in \u00b5g/m3, 26.6368181818182,16.9007407407407\nmonat, Monat, 1,2,3\n*/\n\n\n\n### Question\nWie hoch war die CO- und SO2-Konzentration (beide in Mikrogramm/m3) in Z\u00fcrich zwischen Oktober 1999 und Juli 2000?\n### SQL query\nSELECT T.jahr, T.monat, T.co_mg_m3 * 1000 AS co_ug_m3, T.so2_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND\n    (\n        (T.jahr = 1999 AND T.monat >= 10)\n        OR (T.jahr = 2000 AND T.monat <= 7)\n    )\n    AND T.co_mg_m3 IS NOT NULL\nORDER BY T.jahr ASC, T.monat ASC;\n\n\n### Question\nIn welchem Monat gibt es in der Stadt Z\u00fcrich generell am wenigsten Partikel in der Luft?\n### SQL query\nSELECT T.monat, SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) AS monat_avg_pn_1_cm3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pn_1_cm3 IS NOT NULL\nGROUP BY T.monat\nORDER BY SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) ASC\nLIMIT 1;\n\n\n### Question\nWann erreichte die Kohlenmonoxidkonzentration in der Luft in der Stadt Z\u00fcrich ihr Maximum? Geben Sie auch die Konzentration in mg/m3 an.\n### SQL query\n",
    "process_time": 7.58921481994912,
    "num_tokens": 2066,
    "hardness": "unknown",
    "scores": [
      0.4734449088573456,
      0.7720017433166504
    ],
    "lang": "de"
  },
  {
    "i": 105,
    "question": "Zeigen Sie mir den Medianpreis f\u00fcr Wohnbauland im Kanton Z\u00fcrich f\u00fcr jedes Jahr zwischen 2010 und 2020.",
    "query": "SELECT T.jahr, T.median_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 2010\n    AND T.jahr <= 2020;\n",
    "db_id": "zurich_effektive_preise_wohnbauland",
    "generated_query": "SELECT T.jahr, T.median_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 2010\n    AND T.jahr <= 2020;",
    "meta_data": [
      {
        "question": "Zeigen Sie mir alle verf\u00fcgbaren statistischen Indikatoren f\u00fcr den Preis von Wohnbauland im Kanton Z\u00fcrich f\u00fcr jedes Jahr zwischen 2017 und 2021.",
        "query": "SELECT\n    T.jahr,\n    T.quantil_25_preis_chf_pro_m2,\n    T.median_preis_chf_pro_m2,\n    T.quantil_75_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 2017\n    AND T.jahr <= 2021;\n",
        "score": 0.32794541120529175
      },
      {
        "question": "Wie hoch war das dritte Quartil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2015?",
        "query": "SELECT T.quantil_75_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr = 2015;\n",
        "score": 0.49641621112823486
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.zurich_effektive_preise_wohnbauland (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tfaelle NUMERIC, \n\tdurschnitt_preis_chf_pro_m2 NUMERIC, \n\tquantil_25_preis_chf_pro_m2 NUMERIC, \n\tmedian_preis_chf_pro_m2 NUMERIC, \n\tquantil_75_preis_chf_pro_m2 NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT zurich_effektive_preise_wohnbauland_pkey PRIMARY KEY (uid), \n\tCONSTRAINT zurich_effektive_preise_wohnbauland_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in zurich_effektive_preise_wohnbauland and 5 examples in each column for high cardinality columns :\nuid : 21, 24, 5, 46, 48\njahr : 2014, 1980, 1992, 2006, 2002\nfaelle : 432, 416, 720, 512, 389\ndurschnitt_preis_chf_pro_m2 : 719, 624, 1870, 593, 819\nquantil_25_preis_chf_pro_m2 : 447, 106, 557, 450, 225\nmedian_preis_chf_pro_m2 : 1104, 570, 621, 567, 234\nquantil_75_preis_chf_pro_m2 : 191, 775, 819, 1451, 216\n*/\n\n/*\nColumn name, Column discription, Example values\nfaelle, Anzahl Transaktionen von unbebautem Wohnbauland, 167715272076\ndurschnitt_preis_chf_pro_m2, Durchschnittspreis in CHF pro Quadratmeter, 169175171\nquantil_25_preis_chf_pro_m2, Unteres Quartil der Preise in CHF pro Quadratmeter, 94100104\nmedian_preis_chf_pro_m2, Median Preis in CHF pro Quadratmeter, 131150137\nquantil_75_preis_chf_pro_m2, Oberes Quartil der Preise in CHF pro Quadratmeter, 180198191\n*/\n\n\n\n### Question\nZeigen Sie mir alle verf\u00fcgbaren statistischen Indikatoren f\u00fcr den Preis von Wohnbauland im Kanton Z\u00fcrich f\u00fcr jedes Jahr zwischen 2017 und 2021.\n### SQL query\nSELECT\n    T.jahr,\n    T.quantil_25_preis_chf_pro_m2,\n    T.median_preis_chf_pro_m2,\n    T.quantil_75_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 2017\n    AND T.jahr <= 2021;\n\n\n### Question\nWie hoch war das 50. Perzentil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich in den Jahren 2012 und 2014?\n### SQL query\nSELECT T.jahr, T.median_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (2012, 2014);\n\n\n### Question\nZeigen Sie mir den Medianpreis f\u00fcr Wohnbauland im Kanton Z\u00fcrich f\u00fcr jedes Jahr zwischen 2010 und 2020.\n### SQL query\n",
    "process_time": 6.055799939902499,
    "num_tokens": 1442,
    "hardness": "hard",
    "scores": [
      0.32794541120529175,
      0.49641621112823486
    ],
    "lang": "de"
  },
  {
    "i": 106,
    "question": "Wann hat der Medianpreis f\u00fcr Wohnbauland im Kanton Z\u00fcrich seinen H\u00f6hepunkt erreicht?",
    "query": "SELECT T.jahr\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\nORDER BY T.median_preis_chf_pro_m2 DESC\nLIMIT 1;\n",
    "db_id": "zurich_effektive_preise_wohnbauland",
    "generated_query": "SELECT T.jahr, T.median_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\nORDER BY T.median_preis_chf_pro_m2 DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Wie viele Verk\u00e4ufe von Wohnbauland gab es im Kanton Z\u00fcrich im Zeitraum 1990-2010 insgesamt?",
        "query": "SELECT SUM(T.faelle) AS faelle_1990_2010\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE\n    S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 1990\n    AND T.jahr <= 2010;\n",
        "score": 0.5054512023925781
      },
      {
        "question": "Wie hoch war das dritte Quartil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2015?",
        "query": "SELECT T.quantil_75_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr = 2015;\n",
        "score": 0.5575032830238342
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.zurich_effektive_preise_wohnbauland (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tfaelle NUMERIC, \n\tdurschnitt_preis_chf_pro_m2 NUMERIC, \n\tquantil_25_preis_chf_pro_m2 NUMERIC, \n\tmedian_preis_chf_pro_m2 NUMERIC, \n\tquantil_75_preis_chf_pro_m2 NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT zurich_effektive_preise_wohnbauland_pkey PRIMARY KEY (uid), \n\tCONSTRAINT zurich_effektive_preise_wohnbauland_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in zurich_effektive_preise_wohnbauland and 5 examples in each column for high cardinality columns :\nuid : 21, 24, 5, 46, 48\njahr : 2014, 1980, 1992, 2006, 2002\nfaelle : 432, 416, 720, 512, 389\ndurschnitt_preis_chf_pro_m2 : 719, 624, 1870, 593, 819\nquantil_25_preis_chf_pro_m2 : 447, 106, 557, 450, 225\nmedian_preis_chf_pro_m2 : 1104, 570, 621, 567, 234\nquantil_75_preis_chf_pro_m2 : 191, 775, 819, 1451, 216\n*/\n\n/*\nColumn name, Column discription, Example values\nfaelle, Anzahl Transaktionen von unbebautem Wohnbauland, 167715272076\ndurschnitt_preis_chf_pro_m2, Durchschnittspreis in CHF pro Quadratmeter, 169175171\nquantil_25_preis_chf_pro_m2, Unteres Quartil der Preise in CHF pro Quadratmeter, 94100104\nmedian_preis_chf_pro_m2, Median Preis in CHF pro Quadratmeter, 131150137\nquantil_75_preis_chf_pro_m2, Oberes Quartil der Preise in CHF pro Quadratmeter, 180198191\n*/\n\n\n\n### Question\nWie hoch war das dritte Quartil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2015?\n### SQL query\nSELECT T.quantil_75_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr = 2015;\n\n\n### Question\nWie hoch war das 50. Perzentil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich in den Jahren 2012 und 2014?\n### SQL query\nSELECT T.jahr, T.median_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (2012, 2014);\n\n\n### Question\nWann hat der Medianpreis f\u00fcr Wohnbauland im Kanton Z\u00fcrich seinen H\u00f6hepunkt erreicht?\n### SQL query\n",
    "process_time": 6.336354549974203,
    "num_tokens": 1379,
    "hardness": "extra",
    "scores": [
      0.5054512023925781,
      0.5575032830238342
    ],
    "lang": "de"
  },
  {
    "i": 107,
    "question": "Wie viele Verk\u00e4ufe von Wohnbauland gab es im Kanton Z\u00fcrich in den Jahren 2015 und 2021?",
    "query": "SELECT T.jahr, T.faelle\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (2015, 2021);\n",
    "db_id": "zurich_effektive_preise_wohnbauland",
    "generated_query": "SELECT SUM(T.faelle) AS faelle_2015_2021\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE\n    S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (2015, 2021);",
    "meta_data": [
      {
        "question": "Wie viele Verk\u00e4ufe von Wohnbauland gab es im Kanton Z\u00fcrich im Zeitraum 1990-2010 insgesamt?",
        "query": "SELECT SUM(T.faelle) AS faelle_1990_2010\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE\n    S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 1990\n    AND T.jahr <= 2010;\n",
        "score": 0.12871655821800232
      },
      {
        "question": "Wie hoch war das dritte Quartil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2015?",
        "query": "SELECT T.quantil_75_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr = 2015;\n",
        "score": 0.30205023288726807
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.zurich_effektive_preise_wohnbauland (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tfaelle NUMERIC, \n\tdurschnitt_preis_chf_pro_m2 NUMERIC, \n\tquantil_25_preis_chf_pro_m2 NUMERIC, \n\tmedian_preis_chf_pro_m2 NUMERIC, \n\tquantil_75_preis_chf_pro_m2 NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT zurich_effektive_preise_wohnbauland_pkey PRIMARY KEY (uid), \n\tCONSTRAINT zurich_effektive_preise_wohnbauland_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in zurich_effektive_preise_wohnbauland and 5 examples in each column for high cardinality columns :\nuid : 21, 24, 5, 46, 48\njahr : 2014, 1980, 1992, 2006, 2002\nfaelle : 432, 416, 720, 512, 389\ndurschnitt_preis_chf_pro_m2 : 719, 624, 1870, 593, 819\nquantil_25_preis_chf_pro_m2 : 447, 106, 557, 450, 225\nmedian_preis_chf_pro_m2 : 1104, 570, 621, 567, 234\nquantil_75_preis_chf_pro_m2 : 191, 775, 819, 1451, 216\n*/\n\n/*\nColumn name, Column discription, Example values\nfaelle, Anzahl Transaktionen von unbebautem Wohnbauland, 167715272076\ndurschnitt_preis_chf_pro_m2, Durchschnittspreis in CHF pro Quadratmeter, 169175171\nquantil_25_preis_chf_pro_m2, Unteres Quartil der Preise in CHF pro Quadratmeter, 94100104\nmedian_preis_chf_pro_m2, Median Preis in CHF pro Quadratmeter, 131150137\nquantil_75_preis_chf_pro_m2, Oberes Quartil der Preise in CHF pro Quadratmeter, 180198191\n*/\n\n\n\n### Question\nWie viele Verk\u00e4ufe von Wohnbauland gab es im Kanton Z\u00fcrich im Zeitraum 1990-2010 insgesamt?\n### SQL query\nSELECT SUM(T.faelle) AS faelle_1990_2010\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE\n    S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 1990\n    AND T.jahr <= 2010;\n\n\n### Question\nWie hoch war das dritte Quartil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2015?\n### SQL query\nSELECT T.quantil_75_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr = 2015;\n\n\n### Question\nWie viele Verk\u00e4ufe von Wohnbauland gab es im Kanton Z\u00fcrich in den Jahren 2015 und 2021?\n### SQL query\n",
    "process_time": 5.998433828819543,
    "num_tokens": 1392,
    "hardness": "unknown",
    "scores": [
      0.12871655821800232,
      0.30205023288726807
    ],
    "lang": "de"
  },
  {
    "i": 108,
    "question": "In welchem Jahr ist der durchschnittliche Preis f\u00fcr Wohnbauland im Kanton Z\u00fcrich am st\u00e4rksten gestiegen (in CHF) im Vergleich zum Vorjahr?",
    "query": "SELECT T.jahr\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\nORDER BY T.durschnitt_preis_chf_pro_m2 - LAG(T.durschnitt_preis_chf_pro_m2) OVER (ORDER BY T.jahr) DESC\nLIMIT 1;\n",
    "db_id": "zurich_effektive_preise_wohnbauland",
    "generated_query": "SELECT T.jahr, T.durschnitt_preis_chf_pro_m2 - L.durschnitt_preis_chf_pro_m2 AS price_increase\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN zurich_effektive_preise_wohnbauland AS L ON T.jahr = L.jahr + 1\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\nORDER BY price_increase DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Wie hoch war das dritte Quartil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2015?",
        "query": "SELECT T.quantil_75_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr = 2015;\n",
        "score": 0.45077818632125854
      },
      {
        "question": "Wie viele Verk\u00e4ufe von Wohnbauland gab es im Kanton Z\u00fcrich im Zeitraum 1990-2010 insgesamt?",
        "query": "SELECT SUM(T.faelle) AS faelle_1990_2010\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE\n    S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 1990\n    AND T.jahr <= 2010;\n",
        "score": 0.5402346849441528
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.zurich_effektive_preise_wohnbauland (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tfaelle NUMERIC, \n\tdurschnitt_preis_chf_pro_m2 NUMERIC, \n\tquantil_25_preis_chf_pro_m2 NUMERIC, \n\tmedian_preis_chf_pro_m2 NUMERIC, \n\tquantil_75_preis_chf_pro_m2 NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT zurich_effektive_preise_wohnbauland_pkey PRIMARY KEY (uid), \n\tCONSTRAINT zurich_effektive_preise_wohnbauland_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in zurich_effektive_preise_wohnbauland and 5 examples in each column for high cardinality columns :\nuid : 21, 24, 5, 46, 48\njahr : 2014, 1980, 1992, 2006, 2002\nfaelle : 432, 416, 720, 512, 389\ndurschnitt_preis_chf_pro_m2 : 719, 624, 1870, 593, 819\nquantil_25_preis_chf_pro_m2 : 447, 106, 557, 450, 225\nmedian_preis_chf_pro_m2 : 1104, 570, 621, 567, 234\nquantil_75_preis_chf_pro_m2 : 191, 775, 819, 1451, 216\n*/\n\n/*\nColumn name, Column discription, Example values\nfaelle, Anzahl Transaktionen von unbebautem Wohnbauland, 167715272076\ndurschnitt_preis_chf_pro_m2, Durchschnittspreis in CHF pro Quadratmeter, 169175171\nquantil_25_preis_chf_pro_m2, Unteres Quartil der Preise in CHF pro Quadratmeter, 94100104\nmedian_preis_chf_pro_m2, Median Preis in CHF pro Quadratmeter, 131150137\nquantil_75_preis_chf_pro_m2, Oberes Quartil der Preise in CHF pro Quadratmeter, 180198191\n*/\n\n\n\n### Question\nWie hoch war das dritte Quartil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2015?\n### SQL query\nSELECT T.quantil_75_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr = 2015;\n\n\n### Question\nWie hoch war das 50. Perzentil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich in den Jahren 2012 und 2014?\n### SQL query\nSELECT T.jahr, T.median_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (2012, 2014);\n\n\n### Question\nIn welchem Jahr ist der durchschnittliche Preis f\u00fcr Wohnbauland im Kanton Z\u00fcrich am st\u00e4rksten gestiegen (in CHF) im Vergleich zum Vorjahr?\n### SQL query\n",
    "process_time": 11.881786056095734,
    "num_tokens": 1397,
    "hardness": "unknown",
    "scores": [
      0.45077818632125854,
      0.5402346849441528
    ],
    "lang": "de"
  },
  {
    "i": 109,
    "question": "Wie hoch war das durchschnittliche Reineinkommen in Matth\u00e4us, BS, 2015?",
    "query": "SELECT T.reineinkommen_mittelwert\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2015\n    AND S.name = 'Matth\u00e4us';\n",
    "db_id": "basel_stadt_steuerstatistik_kennzahlen_wohnvierteln",
    "generated_query": "SELECT T.reineinkommen_mittelwert\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Matth\u00e4us'\n    AND S.residence_area = 'TRUE'\n    AND T.jahr = 2015;",
    "meta_data": [
      {
        "question": "Wie hoch war das mittlere Reinverm\u00f6gen in den 5 Wohngebieten von Basel-Stadt mit dem niedrigsten mittleren Reineinkommen im Jahr 2015?",
        "query": "SELECT S.name, T.reinvermogen_mittelwert AS reinvermogen_mittelwert_2015\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nJOIN (\n    SELECT T.spatialunit_uid\n    FROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE T.jahr = 2015\n    ORDER BY T.reineinkommen_mittelwert ASC\n    LIMIT 5\n) AS T2 ON T.spatialunit_uid = T2.spatialunit_uid\nWHERE T.jahr = 2015;\n",
        "score": 1.0312330722808838
      },
      {
        "question": "Zeigen Sie mir den Gini-Koeffizienten des Reinverm\u00f6gens f\u00fcr Bettingen, Iselin und Bruderholz (BS) im Jahr 2012.",
        "query": "SELECT S.name, T.reinvermogen_gini_koeffizient\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2012\n    AND S.name IN ('Bettingen', 'Iselin', 'Bruderholz');\n",
        "score": 1.1079474687576294
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_stadt_steuerstatistik_kennzahlen_wohnvierteln (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanzahl_veranlagungen NUMERIC, \n\treineinkommen_mittelwert NUMERIC, \n\treineinkommen_median NUMERIC, \n\treineinkommen_gini_koeffizient NUMERIC, \n\tsteuerbares_einkommen_mittelwert NUMERIC, \n\tsteuerbares_einkommen_median NUMERIC, \n\tertrag_einkommenssteuer_mittelwert NUMERIC, \n\tertrag_einkommenssteuer_median NUMERIC, \n\treinvermogen_mittelwert NUMERIC, \n\treinvermogen_median NUMERIC, \n\treinvermogen_gini_koeffizient NUMERIC, \n\tsteuerbares_vermogen_mittelwert NUMERIC, \n\tsteuerbares_vermogen_median NUMERIC, \n\tertrag_vermogenssteuer_mittelwert NUMERIC, \n\tertrag_vermogenssteuer_median NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_stadt_steuerstatistik_kennzahlen_wohnvierteln_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_stadt_steuerstatistik_kennzahlen_woh_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_stadt_steuerstatistik_kennzahlen_wohnvierteln and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 1992, 2006, 2002, 2005\nanzahl_veranlagungen : 8656, 4861, 4225, 4053, 9089\nreineinkommen_mittelwert : 45517, 50101, 46512, 42095, 98148\nreineinkommen_median : 44334, 53388, 50291, 50238, 39953\nreineinkommen_gini_koeffizient : 0.43400000000000000, 0.36799999999999999, 0.56000000000000005, 0.63300000000000001, 0.53100000000000003\nsteuerbares_einkommen_mittelwert : 45497, 45196, 78417, 75210, 48429\nsteuerbares_einkommen_median : 31004, 33707, 11558, 37224, 23304\nertrag_einkommenssteuer_mittelwert : 9101, 5881, 14541, 6853, 15263\nertrag_einkommenssteuer_median : 4272, 5617, 7268, 6937, 8411\nreinvermogen_mittelwert : 672, 104439, 150527, 327851, 56278\nreinvermogen_median : 44334, 6077, 38658, 4887, 75000\nreinvermogen_gini_koeffizient : 0.91200000000000003, 0.94599999999999995, 0.93300000000000005, 0.89200000000000002, 0.96899999999999997\nsteuerbares_vermogen_mittelwert : 352264, 768648, 86307, 576705, 360956\nertrag_vermogenssteuer_mittelwert : 672, 6077, 149, 2667, 157\nspatialunit_uid : 1214_A.ADM4, 1212_A.ADM4, 1201_A.ADM4, 1213_A.ADM4, 1204_A.ADM4\n*/\n\n/*\nColumn name, Column discription, Example values\nanzahl_veranlagungen, None, 5433,8141,3226\nreineinkommen_mittelwert, None, 47514,63915,53985\nreineinkommen_median, None, 44300,50600,47200\nreineinkommen_gini_koeffizient, None, 0.334,0.424,0.382\nsteuerbares_einkommen_mittelwert, None, 42282,56532,48135\nsteuerbares_einkommen_median, None, 39900,45200,42000\nertrag_einkommenssteuer_mittelwert, None, 6285,9946,7823\nertrag_einkommenssteuer_median, None, 5082,6475,5610\nreinvermogen_mittelwert, None, 32774,149771,89835\nreinvermogen_median, None, 0,17000,18000\nreinvermogen_gini_koeffizient, None, 0.91,0.89,0.919\nsteuerbares_vermogen_mittelwert, None, 30636,137175,84603\nsteuerbares_vermogen_median, None, 0,2128,4321\nertrag_vermogenssteuer_mittelwert, None, 175,961,591\nertrag_vermogenssteuer_median, None, 0,15,1\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nZeigen Sie mir den Gini-Koeffizienten des Reinverm\u00f6gens f\u00fcr Bettingen, Iselin und Bruderholz (BS) im Jahr 2012.\n### SQL query\nSELECT S.name, T.reinvermogen_gini_koeffizient\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2012\n    AND S.name IN ('Bettingen', 'Iselin', 'Bruderholz');\n\n\n### Question\nIn welchem Jahr war das durchschnittliche steuerbare Einkommen in Basel-Stadt am h\u00f6chsten?\n### SQL query\nSELECT T.jahr\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\nGROUP BY T.jahr\nORDER BY (SUM(T.anzahl_veranlagungen * T.steuerbares_einkommen_mittelwert)) / SUM(T.anzahl_veranlagungen) DESC\nLIMIT 1;\n\n\n### Question\nWie hoch war das durchschnittliche Reineinkommen in Matth\u00e4us, BS, 2015?\n### SQL query\n",
    "process_time": 5.403263606131077,
    "num_tokens": 2089,
    "hardness": "medium",
    "scores": [
      1.0312330722808838,
      1.1079474687576294
    ],
    "lang": "de"
  },
  {
    "i": 110,
    "question": "In welchem Wohnquartier in Basel-Stadt war die Einkommensungleichheit im Jahr 2020 am gr\u00f6ssten?",
    "query": "SELECT S.name\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.reineinkommen_gini_koeffizient DESC\nLIMIT 1;\n",
    "db_id": "basel_stadt_steuerstatistik_kennzahlen_wohnvierteln",
    "generated_query": "SELECT S.name, T.reineinkommen_gini_koeffizient\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.reineinkommen_gini_koeffizient DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "In welchem Jahr war das durchschnittliche steuerbare Einkommen in Basel-Stadt am h\u00f6chsten?",
        "query": "SELECT T.jahr\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\nGROUP BY T.jahr\nORDER BY (SUM(T.anzahl_veranlagungen * T.steuerbares_einkommen_mittelwert)) / SUM(T.anzahl_veranlagungen) DESC\nLIMIT 1;\n",
        "score": 0.4654163420200348
      },
      {
        "question": "Zeigen Sie mir alle Einkommenssteuerertragsindikatoren \u00fcber Breite, im Kanton Basel-Stadt, \u00fcber den Zeitraum 2015-2020.",
        "query": "SELECT T.jahr, T.ertrag_einkommenssteuer_mittelwert, T.ertrag_einkommenssteuer_median\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Breite'\n    AND T.jahr BETWEEN 2015 AND 2020;\n",
        "score": 0.5072891116142273
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_stadt_steuerstatistik_kennzahlen_wohnvierteln (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanzahl_veranlagungen NUMERIC, \n\treineinkommen_mittelwert NUMERIC, \n\treineinkommen_median NUMERIC, \n\treineinkommen_gini_koeffizient NUMERIC, \n\tsteuerbares_einkommen_mittelwert NUMERIC, \n\tsteuerbares_einkommen_median NUMERIC, \n\tertrag_einkommenssteuer_mittelwert NUMERIC, \n\tertrag_einkommenssteuer_median NUMERIC, \n\treinvermogen_mittelwert NUMERIC, \n\treinvermogen_median NUMERIC, \n\treinvermogen_gini_koeffizient NUMERIC, \n\tsteuerbares_vermogen_mittelwert NUMERIC, \n\tsteuerbares_vermogen_median NUMERIC, \n\tertrag_vermogenssteuer_mittelwert NUMERIC, \n\tertrag_vermogenssteuer_median NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_stadt_steuerstatistik_kennzahlen_wohnvierteln_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_stadt_steuerstatistik_kennzahlen_woh_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_stadt_steuerstatistik_kennzahlen_wohnvierteln and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 1992, 2006, 2002, 2005\nanzahl_veranlagungen : 8656, 4861, 4225, 4053, 9089\nreineinkommen_mittelwert : 45517, 50101, 46512, 42095, 98148\nreineinkommen_median : 44334, 53388, 50291, 50238, 39953\nreineinkommen_gini_koeffizient : 0.43400000000000000, 0.36799999999999999, 0.56000000000000005, 0.63300000000000001, 0.53100000000000003\nsteuerbares_einkommen_mittelwert : 45497, 45196, 78417, 75210, 48429\nsteuerbares_einkommen_median : 31004, 33707, 11558, 37224, 23304\nertrag_einkommenssteuer_mittelwert : 9101, 5881, 14541, 6853, 15263\nertrag_einkommenssteuer_median : 4272, 5617, 7268, 6937, 8411\nreinvermogen_mittelwert : 672, 104439, 150527, 327851, 56278\nreinvermogen_median : 44334, 6077, 38658, 4887, 75000\nreinvermogen_gini_koeffizient : 0.91200000000000003, 0.94599999999999995, 0.93300000000000005, 0.89200000000000002, 0.96899999999999997\nsteuerbares_vermogen_mittelwert : 352264, 768648, 86307, 576705, 360956\nertrag_vermogenssteuer_mittelwert : 672, 6077, 149, 2667, 157\nspatialunit_uid : 1214_A.ADM4, 1212_A.ADM4, 1201_A.ADM4, 1213_A.ADM4, 1204_A.ADM4\n*/\n\n/*\nColumn name, Column discription, Example values\nanzahl_veranlagungen, None, 5433,8141,3226\nreineinkommen_mittelwert, None, 47514,63915,53985\nreineinkommen_median, None, 44300,50600,47200\nreineinkommen_gini_koeffizient, None, 0.334,0.424,0.382\nsteuerbares_einkommen_mittelwert, None, 42282,56532,48135\nsteuerbares_einkommen_median, None, 39900,45200,42000\nertrag_einkommenssteuer_mittelwert, None, 6285,9946,7823\nertrag_einkommenssteuer_median, None, 5082,6475,5610\nreinvermogen_mittelwert, None, 32774,149771,89835\nreinvermogen_median, None, 0,17000,18000\nreinvermogen_gini_koeffizient, None, 0.91,0.89,0.919\nsteuerbares_vermogen_mittelwert, None, 30636,137175,84603\nsteuerbares_vermogen_median, None, 0,2128,4321\nertrag_vermogenssteuer_mittelwert, None, 175,961,591\nertrag_vermogenssteuer_median, None, 0,15,1\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWelches waren die 3 Wohnvierteln in Basel-Stadt mit dem h\u00f6chsten durchschnittlichen steuerbaren Verm\u00f6gen im Jahr 2010? Geben Sie auch das Verm\u00f6gen an.\n### SQL query\nSELECT S.name, T.steuerbares_vermogen_mittelwert\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2010\nORDER BY T.steuerbares_vermogen_mittelwert DESC\nLIMIT 3;\n\n\n### Question\nWelcher Anteil der Wohnvierteln in Basel-Stadt hatte 2015 ein mittleres Einkommen von \u00fcber 80'000 CHF?\n### SQL query\nSELECT 100.0 * COUNT(CASE WHEN T.reineinkommen_mittelwert > 75000 THEN 1 END) / COUNT(*) AS anteil_wohnvierteln_ueber_100000_reineinkommen_mittelwert_2015\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2015;\n\n\n### Question\nIn welchem Wohnquartier in Basel-Stadt war die Einkommensungleichheit im Jahr 2020 am gr\u00f6ssten?\n### SQL query\n",
    "process_time": 9.744976378977299,
    "num_tokens": 2124,
    "hardness": "extra",
    "scores": [
      0.4654163420200348,
      0.5072891116142273
    ],
    "lang": "de"
  },
  {
    "i": 111,
    "question": "Wie hoch war das durchschnittliche steuerbare Einkommen im Kanton Basel-Stadt im Jahr 2014?",
    "query": "SELECT (SUM(T.anzahl_veranlagungen * T.steuerbares_einkommen_mittelwert)) / SUM(T.anzahl_veranlagungen) AS steuerbares_einkommen_mittelwert_basel_stadt_2014\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2014;\n",
    "db_id": "basel_stadt_steuerstatistik_kennzahlen_wohnvierteln",
    "generated_query": "SELECT AVG(steuerbares_einkommen_mittelwert)\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln\nWHERE jahr = 2014;",
    "meta_data": [
      {
        "question": "In welchem Jahr war das durchschnittliche steuerbare Einkommen in Basel-Stadt am h\u00f6chsten?",
        "query": "SELECT T.jahr\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\nGROUP BY T.jahr\nORDER BY (SUM(T.anzahl_veranlagungen * T.steuerbares_einkommen_mittelwert)) / SUM(T.anzahl_veranlagungen) DESC\nLIMIT 1;\n",
        "score": 0.11238537728786469
      },
      {
        "question": "Welches waren die 3 Wohnvierteln in Basel-Stadt mit dem h\u00f6chsten durchschnittlichen steuerbaren Verm\u00f6gen im Jahr 2010? Geben Sie auch das Verm\u00f6gen an.",
        "query": "SELECT S.name, T.steuerbares_vermogen_mittelwert\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2010\nORDER BY T.steuerbares_vermogen_mittelwert DESC\nLIMIT 3;\n",
        "score": 0.5148546695709229
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_stadt_steuerstatistik_kennzahlen_wohnvierteln (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanzahl_veranlagungen NUMERIC, \n\treineinkommen_mittelwert NUMERIC, \n\treineinkommen_median NUMERIC, \n\treineinkommen_gini_koeffizient NUMERIC, \n\tsteuerbares_einkommen_mittelwert NUMERIC, \n\tsteuerbares_einkommen_median NUMERIC, \n\tertrag_einkommenssteuer_mittelwert NUMERIC, \n\tertrag_einkommenssteuer_median NUMERIC, \n\treinvermogen_mittelwert NUMERIC, \n\treinvermogen_median NUMERIC, \n\treinvermogen_gini_koeffizient NUMERIC, \n\tsteuerbares_vermogen_mittelwert NUMERIC, \n\tsteuerbares_vermogen_median NUMERIC, \n\tertrag_vermogenssteuer_mittelwert NUMERIC, \n\tertrag_vermogenssteuer_median NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_stadt_steuerstatistik_kennzahlen_wohnvierteln_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_stadt_steuerstatistik_kennzahlen_woh_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_stadt_steuerstatistik_kennzahlen_wohnvierteln and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 1992, 2006, 2002, 2005\nanzahl_veranlagungen : 8656, 4861, 4225, 4053, 9089\nreineinkommen_mittelwert : 45517, 50101, 46512, 42095, 98148\nreineinkommen_median : 44334, 53388, 50291, 50238, 39953\nreineinkommen_gini_koeffizient : 0.43400000000000000, 0.36799999999999999, 0.56000000000000005, 0.63300000000000001, 0.53100000000000003\nsteuerbares_einkommen_mittelwert : 45497, 45196, 78417, 75210, 48429\nsteuerbares_einkommen_median : 31004, 33707, 11558, 37224, 23304\nertrag_einkommenssteuer_mittelwert : 9101, 5881, 14541, 6853, 15263\nertrag_einkommenssteuer_median : 4272, 5617, 7268, 6937, 8411\nreinvermogen_mittelwert : 672, 104439, 150527, 327851, 56278\nreinvermogen_median : 44334, 6077, 38658, 4887, 75000\nreinvermogen_gini_koeffizient : 0.91200000000000003, 0.94599999999999995, 0.93300000000000005, 0.89200000000000002, 0.96899999999999997\nsteuerbares_vermogen_mittelwert : 352264, 768648, 86307, 576705, 360956\nertrag_vermogenssteuer_mittelwert : 672, 6077, 149, 2667, 157\nspatialunit_uid : 1214_A.ADM4, 1212_A.ADM4, 1201_A.ADM4, 1213_A.ADM4, 1204_A.ADM4\n*/\n\n/*\nColumn name, Column discription, Example values\nanzahl_veranlagungen, None, 5433,8141,3226\nreineinkommen_mittelwert, None, 47514,63915,53985\nreineinkommen_median, None, 44300,50600,47200\nreineinkommen_gini_koeffizient, None, 0.334,0.424,0.382\nsteuerbares_einkommen_mittelwert, None, 42282,56532,48135\nsteuerbares_einkommen_median, None, 39900,45200,42000\nertrag_einkommenssteuer_mittelwert, None, 6285,9946,7823\nertrag_einkommenssteuer_median, None, 5082,6475,5610\nreinvermogen_mittelwert, None, 32774,149771,89835\nreinvermogen_median, None, 0,17000,18000\nreinvermogen_gini_koeffizient, None, 0.91,0.89,0.919\nsteuerbares_vermogen_mittelwert, None, 30636,137175,84603\nsteuerbares_vermogen_median, None, 0,2128,4321\nertrag_vermogenssteuer_mittelwert, None, 175,961,591\nertrag_vermogenssteuer_median, None, 0,15,1\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nIn welchem Jahr war das durchschnittliche steuerbare Einkommen in Basel-Stadt am h\u00f6chsten?\n### SQL query\nSELECT T.jahr\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\nGROUP BY T.jahr\nORDER BY (SUM(T.anzahl_veranlagungen * T.steuerbares_einkommen_mittelwert)) / SUM(T.anzahl_veranlagungen) DESC\nLIMIT 1;\n\n\n### Question\nWelches waren die 3 Wohnvierteln in Basel-Stadt mit dem h\u00f6chsten durchschnittlichen steuerbaren Verm\u00f6gen im Jahr 2010? Geben Sie auch das Verm\u00f6gen an.\n### SQL query\nSELECT S.name, T.steuerbares_vermogen_mittelwert\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2010\nORDER BY T.steuerbares_vermogen_mittelwert DESC\nLIMIT 3;\n\n\n### Question\nWie hoch war das durchschnittliche steuerbare Einkommen im Kanton Basel-Stadt im Jahr 2014?\n### SQL query\n",
    "process_time": 4.12760338303633,
    "num_tokens": 2110,
    "hardness": "unknown",
    "scores": [
      0.11238537728786469,
      0.5148546695709229
    ],
    "lang": "de"
  },
  {
    "i": 112,
    "question": "Wie stark hat sich das durchschnittliche steuerpflichtige Verm\u00f6gen in Clara (BS) zwischen 1995 und 2015 ver\u00e4ndert? Geben Sie den relativen Unterschied in Prozent an.",
    "query": "SELECT\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2015 THEN T.steuerbares_vermogen_mittelwert ELSE - T.steuerbares_vermogen_mittelwert END) /\n        SUM(T.steuerbares_vermogen_mittelwert)\n     ) AS steuerbares_vermogen_mittelwert_prozent_aenderung_1995_2015\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Clara'\n    AND T.jahr IN (1995, 2015);\n",
    "db_id": "basel_stadt_steuerstatistik_kennzahlen_wohnvierteln",
    "generated_query": "SELECT\n    (\n        100.0 * (T.steuerbares_vermogen_mittelwert_2015 - T.steuerbares_vermogen_mittelwert_1995) /\n        T.steuerbares_vermogen_mittelwert_1995\n    ) AS steuerbares_vermogen_mittelwert_prozent_aenderung_1995_2015\nFROM (\n    SELECT\n        MAX(CASE WHEN T.jahr = 1995 THEN T.steuerbares_vermogen_mittelwert END) AS steuerbares_vermogen_mittelwert_1995,\n        MAX(CASE WHEN T.jahr = 2015 THEN T.steuerbares_vermogen_mittelwert END) AS steuerbares_vermogen_mittelwert_2015\n    FROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.residence_area = 'TRUE'\n        AND S.name = 'Clara'\n        AND T.jahr IN (1995, 2015)\n) AS T;",
    "meta_data": [
      {
        "question": "Welches waren die 3 Wohnvierteln in Basel-Stadt mit dem h\u00f6chsten durchschnittlichen steuerbaren Verm\u00f6gen im Jahr 2010? Geben Sie auch das Verm\u00f6gen an.",
        "query": "SELECT S.name, T.steuerbares_vermogen_mittelwert\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2010\nORDER BY T.steuerbares_vermogen_mittelwert DESC\nLIMIT 3;\n",
        "score": 0.8270300626754761
      },
      {
        "question": "Wie haben sich das mittlere Nettoeinkommen und das mittlere steuerpflichtige Einkommen (in Prozent) zwischen 2000 und 2020 in Clara, BS, ver\u00e4ndert?",
        "query": "SELECT\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.reineinkommen_mittelwert ELSE - T.reineinkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.reineinkommen_mittelwert END)\n    ) AS reineinkommen_mittelwert_prozent_aenderung_2000_2020,\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.steuerbares_einkommen_mittelwert ELSE - T.steuerbares_einkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.steuerbares_einkommen_mittelwert END)\n    ) AS steuerbares_einkommen_mittelwert_prozent_aenderung_2000_2020\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Clara'\n    AND T.jahr IN (2000, 2020);\n",
        "score": 0.965863823890686
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_stadt_steuerstatistik_kennzahlen_wohnvierteln (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanzahl_veranlagungen NUMERIC, \n\treineinkommen_mittelwert NUMERIC, \n\treineinkommen_median NUMERIC, \n\treineinkommen_gini_koeffizient NUMERIC, \n\tsteuerbares_einkommen_mittelwert NUMERIC, \n\tsteuerbares_einkommen_median NUMERIC, \n\tertrag_einkommenssteuer_mittelwert NUMERIC, \n\tertrag_einkommenssteuer_median NUMERIC, \n\treinvermogen_mittelwert NUMERIC, \n\treinvermogen_median NUMERIC, \n\treinvermogen_gini_koeffizient NUMERIC, \n\tsteuerbares_vermogen_mittelwert NUMERIC, \n\tsteuerbares_vermogen_median NUMERIC, \n\tertrag_vermogenssteuer_mittelwert NUMERIC, \n\tertrag_vermogenssteuer_median NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_stadt_steuerstatistik_kennzahlen_wohnvierteln_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_stadt_steuerstatistik_kennzahlen_woh_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_stadt_steuerstatistik_kennzahlen_wohnvierteln and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 1992, 2006, 2002, 2005\nanzahl_veranlagungen : 8656, 4861, 4225, 4053, 9089\nreineinkommen_mittelwert : 45517, 50101, 46512, 42095, 98148\nreineinkommen_median : 44334, 53388, 50291, 50238, 39953\nreineinkommen_gini_koeffizient : 0.43400000000000000, 0.36799999999999999, 0.56000000000000005, 0.63300000000000001, 0.53100000000000003\nsteuerbares_einkommen_mittelwert : 45497, 45196, 78417, 75210, 48429\nsteuerbares_einkommen_median : 31004, 33707, 11558, 37224, 23304\nertrag_einkommenssteuer_mittelwert : 9101, 5881, 14541, 6853, 15263\nertrag_einkommenssteuer_median : 4272, 5617, 7268, 6937, 8411\nreinvermogen_mittelwert : 672, 104439, 150527, 327851, 56278\nreinvermogen_median : 44334, 6077, 38658, 4887, 75000\nreinvermogen_gini_koeffizient : 0.91200000000000003, 0.94599999999999995, 0.93300000000000005, 0.89200000000000002, 0.96899999999999997\nsteuerbares_vermogen_mittelwert : 352264, 768648, 86307, 576705, 360956\nertrag_vermogenssteuer_mittelwert : 672, 6077, 149, 2667, 157\nspatialunit_uid : 1214_A.ADM4, 1212_A.ADM4, 1201_A.ADM4, 1213_A.ADM4, 1204_A.ADM4\n*/\n\n/*\nColumn name, Column discription, Example values\nanzahl_veranlagungen, None, 5433,8141,3226\nreineinkommen_mittelwert, None, 47514,63915,53985\nreineinkommen_median, None, 44300,50600,47200\nreineinkommen_gini_koeffizient, None, 0.334,0.424,0.382\nsteuerbares_einkommen_mittelwert, None, 42282,56532,48135\nsteuerbares_einkommen_median, None, 39900,45200,42000\nertrag_einkommenssteuer_mittelwert, None, 6285,9946,7823\nertrag_einkommenssteuer_median, None, 5082,6475,5610\nreinvermogen_mittelwert, None, 32774,149771,89835\nreinvermogen_median, None, 0,17000,18000\nreinvermogen_gini_koeffizient, None, 0.91,0.89,0.919\nsteuerbares_vermogen_mittelwert, None, 30636,137175,84603\nsteuerbares_vermogen_median, None, 0,2128,4321\nertrag_vermogenssteuer_mittelwert, None, 175,961,591\nertrag_vermogenssteuer_median, None, 0,15,1\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWie haben sich das mittlere Nettoeinkommen und das mittlere steuerpflichtige Einkommen (in Prozent) zwischen 2000 und 2020 in Clara, BS, ver\u00e4ndert?\n### SQL query\nSELECT\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.reineinkommen_mittelwert ELSE - T.reineinkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.reineinkommen_mittelwert END)\n    ) AS reineinkommen_mittelwert_prozent_aenderung_2000_2020,\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.steuerbares_einkommen_mittelwert ELSE - T.steuerbares_einkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.steuerbares_einkommen_mittelwert END)\n    ) AS steuerbares_einkommen_mittelwert_prozent_aenderung_2000_2020\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Clara'\n    AND T.jahr IN (2000, 2020);\n\n\n### Question\nWelches waren die 3 Wohnvierteln in Basel-Stadt mit dem h\u00f6chsten durchschnittlichen steuerbaren Verm\u00f6gen im Jahr 2010? Geben Sie auch das Verm\u00f6gen an.\n### SQL query\nSELECT S.name, T.steuerbares_vermogen_mittelwert\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2010\nORDER BY T.steuerbares_vermogen_mittelwert DESC\nLIMIT 3;\n\n\n### Question\nWie stark hat sich das durchschnittliche steuerpflichtige Verm\u00f6gen in Clara (BS) zwischen 1995 und 2015 ver\u00e4ndert? Geben Sie den relativen Unterschied in Prozent an.\n### SQL query\n",
    "process_time": 24.99467072193511,
    "num_tokens": 2311,
    "hardness": "unknown",
    "scores": [
      0.8270300626754761,
      0.965863823890686
    ],
    "lang": "de"
  },
  {
    "i": 113,
    "question": "Wie hat sich die Wohnfl\u00e4che pro Einwohner in der Altstadt Grossbasel \u00fcber den Zeitraum 2015 - 2019 entwickelt?",
    "query": "SELECT T.jahr, T.wohnflache_pro_person_m2\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Altstadt Grossbasel'\n    AND T.jahr >= 2015\n    AND T.jahr <= 2019\nORDER BY T.jahr ASC;\n",
    "db_id": "basel_stadt_kennzahlen_zu_den_basler_wohnvierteln",
    "generated_query": "SELECT\n    T.jahr,\n    T.wohnflache_pro_person_m2\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Altstadt Grossbasel'\n    AND T.jahr BETWEEN 2015 AND 2019;",
    "meta_data": [
      {
        "question": "Wie hat sich der Anteil an Gr\u00fcnfl\u00e4chen (in Prozent) von 2015 bis 2022 in den einzelnen Wohngebieten von Basel-Stadt ver\u00e4ndert?",
        "query": "SELECT\n    S.name,\n    (   100.0 * SUM(CASE WHEN T.jahr = 2022 THEN T.anteil_grunflachen ELSE - T.anteil_grunflachen END) /\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anteil_grunflachen END)\n    ) AS prozent_aenderung_anteil_grunflachen_2018_2022\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2022)\nGROUP BY S.name\nORDER BY prozent_aenderung_anteil_grunflachen_2018_2022 DESC;\n",
        "score": 0.7827451229095459
      },
      {
        "question": "F\u00fcr welchen Zeitraum liegen besch\u00e4ftigungsbezogene Statistiken \u00fcber die Wohngebiete in Basel-Stadt vor?",
        "query": "SELECT MIN(T.jahr) erste_jahr, MAX(T.jahr) AS letzte_jahr\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE' ;\n",
        "score": 0.9218603372573853
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_stadt_kennzahlen_zu_den_basler_wohnvierteln (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanteil_sozialhilfeempfanger NUMERIC, \n\tanteil_auslander NUMERIC, \n\tanteil_personen_ohne_religionszugehorigkeit NUMERIC, \n\tanteil_personen_in_einpersonenhaushalten NUMERIC, \n\tgymnasialquote_anteil_progymnasium NUMERIC, \n\taltersquotient_uber_64_jahr NUMERIC, \n\tanteil_sesshafte_10_jahr NUMERIC, \n\tjugendquotient_unter_20_jahr NUMERIC, \n\tbaujahr_der_wohngebaude NUMERIC, \n\tanteil_einfamilienhauser NUMERIC, \n\tanteil_grunflachen NUMERIC, \n\tflache_pro_wohnung_m2 NUMERIC, \n\twohnflache_pro_person_m2 NUMERIC, \n\tvermogenssteuer_pro_veranlagung NUMERIC, \n\teinkommenssteuer_pro_veranlagung NUMERIC, \n\terwerbstatigenquote NUMERIC, \n\tarbeitsplatze_pro_einwohner NUMERIC, \n\tarbeitslosenquote NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_stadt_kennzahlen_zu_den_basler_wohnvierteln_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_stadt_kennzahlen_zu_den_basler_wohnv_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_stadt_kennzahlen_zu_den_basler_wohnvierteln and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nanteil_sozialhilfeempfanger : 0.017661993599999998, 0.032510622000000003, 0.017414818799999999, 0.018501120199999999, 0.012605042000000000\nanteil_auslander : 0.34379853560000001, 0.21384853619999999, 0.24181360199999999, 0.32397045660000001, 0.28994428470000000\nanteil_personen_ohne_religionszugehorigkeit : 0.46533135269999998, 0.45210406430000000, 0.39128931900000002, 0.49161055889999999, 0.47492799650000000\nanteil_personen_in_einpersonenhaushalten : 0.27144496190000000, 0.27791297580000002, 0.20082427880000001, 0.26334567489999999, 0.21076601460000000\ngymnasialquote_anteil_progymnasium : 0.611111111100000048, 0.333333333299999979, 0.522499999999999964, 0.636363636400000043, 0.466700000000000004\naltersquotient_uber_64_jahr : 0.36682956630000002, 0.12444444440000001, 0.27430555559999997, 0.11882094470000000, 0.12969728599999999\nanteil_sesshafte_10_jahr : 0.28405856039999999, 0.28232715679999998, 0.29293549800000002, 0.20884446460000000, 0.27518916770000001\njugendquotient_unter_20_jahr : 0.40740030669999999, 0.28638786389999998, 0.16687041559999999, 0.37264273920000002, 0.25159561889999998\nbaujahr_der_wohngebaude : 1899.3071297989029, 1924.7530612000000, 1942.7278996865200, 1933.2810734000000, 1925.1622807000001\nanteil_einfamilienhauser : 0.029453015400000001, 0.152941176469999995, 0.052264808400000001, 0.028551532033000000, 0.077634011099999997\nanteil_grunflachen : 0.323351153300000027, 0.359596766800000023, 0.157000000000000001, 0.323401986199999991, 0.174296153900000000\nflache_pro_wohnung_m2 : 70.604628261938998, 72.425378041000002, 70.457689544000004, 82.188064515999997, 82.280327389999997\nwohnflache_pro_person_m2 : 31.680970411000001, 32.888446000000002, 41.130126881000002, 45.328020756000001, 53.158121706000003\nvermogenssteuer_pro_veranlagung : 6754.76905160000024, 1328.95803180000007, 5011.50000000000000, 2958.97167959999979, 18071.40112299999964\neinkommenssteuer_pro_veranlagung : 6202.4897299000004, 6774.0039745000004, 6265.4244840000001, 9568.5000000000000, 17646.9000000000015\nerwerbstatigenquote : 0.70323460000000004, 0.76909340420000005, 0.75835580000000002, 0.75150266560000001, 0.60854408149999994\narbeitsplatze_pro_einwohner : 0.15853759619999999, 1.74959002919999995, 0.63101094769999999, 1.00373275880000001, 2.26998809999999995\narbeitslosenquote : 0.041845755800000002, 0.036997895599999997, 0.033521583200000003, 0.045934234300000001, 0.050652873899999999\nspatialunit_uid : 1214_A.ADM4, 1212_A.ADM4, 1201_A.ADM4, 1213_A.ADM4, 1204_A.ADM4\n*/\n\n/*\nColumn name, Column discription, Example values\nanteil_sozialhilfeempfanger, None, 0.0384108454,0.0566399639,0.0616651708\nanteil_auslander, None, 0.3403313877,0.3193049757,0.3919011668\nanteil_personen_ohne_religionszugehorigkeit, None, 0.4882319714,0.4715107751,0.4412121852\nanteil_personen_in_einpersonenhaushalten, None, 0.3000205634,0.2883006761,0.2792870645\ngymnasialquote_anteil_progymnasium, None, 0.5740740741,0.2924528302,0.3366336634\naltersquotient_uber_64_jahr, None, 0.3601476015,0.3394025102,0.2155230596\nanteil_sesshafte_10_jahr, None, 0.3055921672,0.3543946745,0.3012512539\njugendquotient_unter_20_jahr, None, 0.2076752768,0.227328973,0.2048743907\nbaujahr_der_wohngebaude, None, 1918.3832335,1939.8939394,1931.8792135\nanteil_einfamilienhauser, None, 0.1984602224,0.1363636364,0.029494382\nanteil_grunflachen, None, 0.2390179539,0.3585967524,0.1742961539\nflache_pro_wohnung_m2, None, 82.343801381,69.810768933,70.418289354\nwohnflache_pro_person_m2, None, 47.311517,39.026379,38.692324\nvermogenssteuer_pro_veranlagung, None, 2378.931266,483.02681775,460.5646986\neinkommenssteuer_pro_veranlagung, None, 10820.800512,7123.8581681,7075.5415415\nerwerbstatigenquote, None, 0.8077279565,0.7324650618,0.7397509203\narbeitsplatze_pro_einwohner, None, 0.9906581653,0.1403727831,0.6350379648\narbeitslosenquote, None, 0.0252819637,0.0466659488,0.0400550591\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWie hat sich der Anteil an Gr\u00fcnfl\u00e4chen (in Prozent) von 2015 bis 2022 in den einzelnen Wohngebieten von Basel-Stadt ver\u00e4ndert?\n### SQL query\nSELECT\n    S.name,\n    (   100.0 * SUM(CASE WHEN T.jahr = 2022 THEN T.anteil_grunflachen ELSE - T.anteil_grunflachen END) /\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anteil_grunflachen END)\n    ) AS prozent_aenderung_anteil_grunflachen_2018_2022\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2022)\nGROUP BY S.name\nORDER BY prozent_aenderung_anteil_grunflachen_2018_2022 DESC;\n\n\n### Question\nF\u00fcr welchen Zeitraum liegen besch\u00e4ftigungsbezogene Statistiken \u00fcber die Wohngebiete in Basel-Stadt vor?\n### SQL query\nSELECT MIN(T.jahr) erste_jahr, MAX(T.jahr) AS letzte_jahr\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE' ;\n\n\n### Question\nWie hat sich die Wohnfl\u00e4che pro Einwohner in der Altstadt Grossbasel \u00fcber den Zeitraum 2015 - 2019 entwickelt?\n### SQL query\n",
    "process_time": 7.591561126988381,
    "num_tokens": 3126,
    "hardness": "hard",
    "scores": [
      0.7827451229095459,
      0.9218603372573853
    ],
    "lang": "de"
  },
  {
    "i": 114,
    "question": "Wie heissen die 3 Wohngebiete in Basel-Stadt mit der kleinsten Wohnfl\u00e4che pro Einwohner im Jahr 2020?",
    "query": "SELECT S.name\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.wohnflache_pro_person_m2 ASC\nLIMIT 3;\n",
    "db_id": "basel_stadt_kennzahlen_zu_den_basler_wohnvierteln",
    "generated_query": "SELECT S.name\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.wohnflache_pro_person_m2 ASC\nLIMIT 3;",
    "meta_data": [
      {
        "question": "Wie hat sich der Anteil an Gr\u00fcnfl\u00e4chen (in Prozent) von 2015 bis 2022 in den einzelnen Wohngebieten von Basel-Stadt ver\u00e4ndert?",
        "query": "SELECT\n    S.name,\n    (   100.0 * SUM(CASE WHEN T.jahr = 2022 THEN T.anteil_grunflachen ELSE - T.anteil_grunflachen END) /\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anteil_grunflachen END)\n    ) AS prozent_aenderung_anteil_grunflachen_2018_2022\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2022)\nGROUP BY S.name\nORDER BY prozent_aenderung_anteil_grunflachen_2018_2022 DESC;\n",
        "score": 0.5869094133377075
      },
      {
        "question": "Welches Wohnviertel in Basel-Stadt hatte im Jahr 2023 die durchschnittlich \u00e4ltesten Geb\u00e4ude und welches war das durchschnittliche Baudatum?",
        "query": "SELECT S.name, T.baujahr_der_wohngebaude\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2023\nORDER BY T.baujahr_der_wohngebaude ASC\nLIMIT 1;\n",
        "score": 0.6520305871963501
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_stadt_kennzahlen_zu_den_basler_wohnvierteln (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanteil_sozialhilfeempfanger NUMERIC, \n\tanteil_auslander NUMERIC, \n\tanteil_personen_ohne_religionszugehorigkeit NUMERIC, \n\tanteil_personen_in_einpersonenhaushalten NUMERIC, \n\tgymnasialquote_anteil_progymnasium NUMERIC, \n\taltersquotient_uber_64_jahr NUMERIC, \n\tanteil_sesshafte_10_jahr NUMERIC, \n\tjugendquotient_unter_20_jahr NUMERIC, \n\tbaujahr_der_wohngebaude NUMERIC, \n\tanteil_einfamilienhauser NUMERIC, \n\tanteil_grunflachen NUMERIC, \n\tflache_pro_wohnung_m2 NUMERIC, \n\twohnflache_pro_person_m2 NUMERIC, \n\tvermogenssteuer_pro_veranlagung NUMERIC, \n\teinkommenssteuer_pro_veranlagung NUMERIC, \n\terwerbstatigenquote NUMERIC, \n\tarbeitsplatze_pro_einwohner NUMERIC, \n\tarbeitslosenquote NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_stadt_kennzahlen_zu_den_basler_wohnvierteln_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_stadt_kennzahlen_zu_den_basler_wohnv_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_stadt_kennzahlen_zu_den_basler_wohnvierteln and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nanteil_sozialhilfeempfanger : 0.017661993599999998, 0.032510622000000003, 0.017414818799999999, 0.018501120199999999, 0.012605042000000000\nanteil_auslander : 0.34379853560000001, 0.21384853619999999, 0.24181360199999999, 0.32397045660000001, 0.28994428470000000\nanteil_personen_ohne_religionszugehorigkeit : 0.46533135269999998, 0.45210406430000000, 0.39128931900000002, 0.49161055889999999, 0.47492799650000000\nanteil_personen_in_einpersonenhaushalten : 0.27144496190000000, 0.27791297580000002, 0.20082427880000001, 0.26334567489999999, 0.21076601460000000\ngymnasialquote_anteil_progymnasium : 0.611111111100000048, 0.333333333299999979, 0.522499999999999964, 0.636363636400000043, 0.466700000000000004\naltersquotient_uber_64_jahr : 0.36682956630000002, 0.12444444440000001, 0.27430555559999997, 0.11882094470000000, 0.12969728599999999\nanteil_sesshafte_10_jahr : 0.28405856039999999, 0.28232715679999998, 0.29293549800000002, 0.20884446460000000, 0.27518916770000001\njugendquotient_unter_20_jahr : 0.40740030669999999, 0.28638786389999998, 0.16687041559999999, 0.37264273920000002, 0.25159561889999998\nbaujahr_der_wohngebaude : 1899.3071297989029, 1924.7530612000000, 1942.7278996865200, 1933.2810734000000, 1925.1622807000001\nanteil_einfamilienhauser : 0.029453015400000001, 0.152941176469999995, 0.052264808400000001, 0.028551532033000000, 0.077634011099999997\nanteil_grunflachen : 0.323351153300000027, 0.359596766800000023, 0.157000000000000001, 0.323401986199999991, 0.174296153900000000\nflache_pro_wohnung_m2 : 70.604628261938998, 72.425378041000002, 70.457689544000004, 82.188064515999997, 82.280327389999997\nwohnflache_pro_person_m2 : 31.680970411000001, 32.888446000000002, 41.130126881000002, 45.328020756000001, 53.158121706000003\nvermogenssteuer_pro_veranlagung : 6754.76905160000024, 1328.95803180000007, 5011.50000000000000, 2958.97167959999979, 18071.40112299999964\neinkommenssteuer_pro_veranlagung : 6202.4897299000004, 6774.0039745000004, 6265.4244840000001, 9568.5000000000000, 17646.9000000000015\nerwerbstatigenquote : 0.70323460000000004, 0.76909340420000005, 0.75835580000000002, 0.75150266560000001, 0.60854408149999994\narbeitsplatze_pro_einwohner : 0.15853759619999999, 1.74959002919999995, 0.63101094769999999, 1.00373275880000001, 2.26998809999999995\narbeitslosenquote : 0.041845755800000002, 0.036997895599999997, 0.033521583200000003, 0.045934234300000001, 0.050652873899999999\nspatialunit_uid : 1214_A.ADM4, 1212_A.ADM4, 1201_A.ADM4, 1213_A.ADM4, 1204_A.ADM4\n*/\n\n/*\nColumn name, Column discription, Example values\nanteil_sozialhilfeempfanger, None, 0.0384108454,0.0566399639,0.0616651708\nanteil_auslander, None, 0.3403313877,0.3193049757,0.3919011668\nanteil_personen_ohne_religionszugehorigkeit, None, 0.4882319714,0.4715107751,0.4412121852\nanteil_personen_in_einpersonenhaushalten, None, 0.3000205634,0.2883006761,0.2792870645\ngymnasialquote_anteil_progymnasium, None, 0.5740740741,0.2924528302,0.3366336634\naltersquotient_uber_64_jahr, None, 0.3601476015,0.3394025102,0.2155230596\nanteil_sesshafte_10_jahr, None, 0.3055921672,0.3543946745,0.3012512539\njugendquotient_unter_20_jahr, None, 0.2076752768,0.227328973,0.2048743907\nbaujahr_der_wohngebaude, None, 1918.3832335,1939.8939394,1931.8792135\nanteil_einfamilienhauser, None, 0.1984602224,0.1363636364,0.029494382\nanteil_grunflachen, None, 0.2390179539,0.3585967524,0.1742961539\nflache_pro_wohnung_m2, None, 82.343801381,69.810768933,70.418289354\nwohnflache_pro_person_m2, None, 47.311517,39.026379,38.692324\nvermogenssteuer_pro_veranlagung, None, 2378.931266,483.02681775,460.5646986\neinkommenssteuer_pro_veranlagung, None, 10820.800512,7123.8581681,7075.5415415\nerwerbstatigenquote, None, 0.8077279565,0.7324650618,0.7397509203\narbeitsplatze_pro_einwohner, None, 0.9906581653,0.1403727831,0.6350379648\narbeitslosenquote, None, 0.0252819637,0.0466659488,0.0400550591\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nF\u00fcr welchen Zeitraum liegen besch\u00e4ftigungsbezogene Statistiken \u00fcber die Wohngebiete in Basel-Stadt vor?\n### SQL query\nSELECT MIN(T.jahr) erste_jahr, MAX(T.jahr) AS letzte_jahr\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE' ;\n\n\n### Question\nWelches Wohnviertel in Basel-Stadt hatte im Jahr 2023 die durchschnittlich \u00e4ltesten Geb\u00e4ude und welches war das durchschnittliche Baudatum?\n### SQL query\nSELECT S.name, T.baujahr_der_wohngebaude\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2023\nORDER BY T.baujahr_der_wohngebaude ASC\nLIMIT 1;\n\n\n### Question\nWie heissen die 3 Wohngebiete in Basel-Stadt mit der kleinsten Wohnfl\u00e4che pro Einwohner im Jahr 2020?\n### SQL query\n",
    "process_time": 6.6260445159859955,
    "num_tokens": 3037,
    "hardness": "extra",
    "scores": [
      0.5869094133377075,
      0.6520305871963501
    ],
    "lang": "de"
  },
  {
    "i": 115,
    "question": "Wie hoch ist die relative Ver\u00e4nderung (in %) des Ausl\u00e4nderanteils zwischen 2018 und 2023 in den einzelnen Wohnvierteln von Basel-Stadt?",
    "query": "SELECT\n    S.name,\n    (   100.0 * SUM(CASE WHEN T.jahr = 2023 THEN T.anteil_auslander ELSE - T.anteil_auslander END) /\n        SUM(CASE WHEN T.jahr = 2018 THEN T.anteil_auslander END)\n    ) AS prozent_aenderung_anteil_auslander_2018_2023\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2018, 2023)\nGROUP BY S.name ;\n",
    "db_id": "basel_stadt_kennzahlen_zu_den_basler_wohnvierteln",
    "generated_query": "SELECT S.name, ((T2.anteil_auslander - T1.anteil_auslander) / T1.anteil_auslander) * 100 AS relative_veranderung\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T1\nJOIN basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nJOIN spatial_unit AS S ON T1.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T1.jahr = 2018\n    AND T2.jahr = 2023;",
    "meta_data": [
      {
        "question": "F\u00fcr welchen Zeitraum liegen besch\u00e4ftigungsbezogene Statistiken \u00fcber die Wohngebiete in Basel-Stadt vor?",
        "query": "SELECT MIN(T.jahr) erste_jahr, MAX(T.jahr) AS letzte_jahr\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE' ;\n",
        "score": 0.8779789805412292
      },
      {
        "question": "Welches Wohnviertel in Basel-Stadt hatte im Jahr 2023 die durchschnittlich \u00e4ltesten Geb\u00e4ude und welches war das durchschnittliche Baudatum?",
        "query": "SELECT S.name, T.baujahr_der_wohngebaude\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2023\nORDER BY T.baujahr_der_wohngebaude ASC\nLIMIT 1;\n",
        "score": 0.8954439163208008
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_stadt_kennzahlen_zu_den_basler_wohnvierteln (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanteil_sozialhilfeempfanger NUMERIC, \n\tanteil_auslander NUMERIC, \n\tanteil_personen_ohne_religionszugehorigkeit NUMERIC, \n\tanteil_personen_in_einpersonenhaushalten NUMERIC, \n\tgymnasialquote_anteil_progymnasium NUMERIC, \n\taltersquotient_uber_64_jahr NUMERIC, \n\tanteil_sesshafte_10_jahr NUMERIC, \n\tjugendquotient_unter_20_jahr NUMERIC, \n\tbaujahr_der_wohngebaude NUMERIC, \n\tanteil_einfamilienhauser NUMERIC, \n\tanteil_grunflachen NUMERIC, \n\tflache_pro_wohnung_m2 NUMERIC, \n\twohnflache_pro_person_m2 NUMERIC, \n\tvermogenssteuer_pro_veranlagung NUMERIC, \n\teinkommenssteuer_pro_veranlagung NUMERIC, \n\terwerbstatigenquote NUMERIC, \n\tarbeitsplatze_pro_einwohner NUMERIC, \n\tarbeitslosenquote NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_stadt_kennzahlen_zu_den_basler_wohnvierteln_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_stadt_kennzahlen_zu_den_basler_wohnv_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_stadt_kennzahlen_zu_den_basler_wohnvierteln and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nanteil_sozialhilfeempfanger : 0.017661993599999998, 0.032510622000000003, 0.017414818799999999, 0.018501120199999999, 0.012605042000000000\nanteil_auslander : 0.34379853560000001, 0.21384853619999999, 0.24181360199999999, 0.32397045660000001, 0.28994428470000000\nanteil_personen_ohne_religionszugehorigkeit : 0.46533135269999998, 0.45210406430000000, 0.39128931900000002, 0.49161055889999999, 0.47492799650000000\nanteil_personen_in_einpersonenhaushalten : 0.27144496190000000, 0.27791297580000002, 0.20082427880000001, 0.26334567489999999, 0.21076601460000000\ngymnasialquote_anteil_progymnasium : 0.611111111100000048, 0.333333333299999979, 0.522499999999999964, 0.636363636400000043, 0.466700000000000004\naltersquotient_uber_64_jahr : 0.36682956630000002, 0.12444444440000001, 0.27430555559999997, 0.11882094470000000, 0.12969728599999999\nanteil_sesshafte_10_jahr : 0.28405856039999999, 0.28232715679999998, 0.29293549800000002, 0.20884446460000000, 0.27518916770000001\njugendquotient_unter_20_jahr : 0.40740030669999999, 0.28638786389999998, 0.16687041559999999, 0.37264273920000002, 0.25159561889999998\nbaujahr_der_wohngebaude : 1899.3071297989029, 1924.7530612000000, 1942.7278996865200, 1933.2810734000000, 1925.1622807000001\nanteil_einfamilienhauser : 0.029453015400000001, 0.152941176469999995, 0.052264808400000001, 0.028551532033000000, 0.077634011099999997\nanteil_grunflachen : 0.323351153300000027, 0.359596766800000023, 0.157000000000000001, 0.323401986199999991, 0.174296153900000000\nflache_pro_wohnung_m2 : 70.604628261938998, 72.425378041000002, 70.457689544000004, 82.188064515999997, 82.280327389999997\nwohnflache_pro_person_m2 : 31.680970411000001, 32.888446000000002, 41.130126881000002, 45.328020756000001, 53.158121706000003\nvermogenssteuer_pro_veranlagung : 6754.76905160000024, 1328.95803180000007, 5011.50000000000000, 2958.97167959999979, 18071.40112299999964\neinkommenssteuer_pro_veranlagung : 6202.4897299000004, 6774.0039745000004, 6265.4244840000001, 9568.5000000000000, 17646.9000000000015\nerwerbstatigenquote : 0.70323460000000004, 0.76909340420000005, 0.75835580000000002, 0.75150266560000001, 0.60854408149999994\narbeitsplatze_pro_einwohner : 0.15853759619999999, 1.74959002919999995, 0.63101094769999999, 1.00373275880000001, 2.26998809999999995\narbeitslosenquote : 0.041845755800000002, 0.036997895599999997, 0.033521583200000003, 0.045934234300000001, 0.050652873899999999\nspatialunit_uid : 1214_A.ADM4, 1212_A.ADM4, 1201_A.ADM4, 1213_A.ADM4, 1204_A.ADM4\n*/\n\n/*\nColumn name, Column discription, Example values\nanteil_sozialhilfeempfanger, None, 0.0384108454,0.0566399639,0.0616651708\nanteil_auslander, None, 0.3403313877,0.3193049757,0.3919011668\nanteil_personen_ohne_religionszugehorigkeit, None, 0.4882319714,0.4715107751,0.4412121852\nanteil_personen_in_einpersonenhaushalten, None, 0.3000205634,0.2883006761,0.2792870645\ngymnasialquote_anteil_progymnasium, None, 0.5740740741,0.2924528302,0.3366336634\naltersquotient_uber_64_jahr, None, 0.3601476015,0.3394025102,0.2155230596\nanteil_sesshafte_10_jahr, None, 0.3055921672,0.3543946745,0.3012512539\njugendquotient_unter_20_jahr, None, 0.2076752768,0.227328973,0.2048743907\nbaujahr_der_wohngebaude, None, 1918.3832335,1939.8939394,1931.8792135\nanteil_einfamilienhauser, None, 0.1984602224,0.1363636364,0.029494382\nanteil_grunflachen, None, 0.2390179539,0.3585967524,0.1742961539\nflache_pro_wohnung_m2, None, 82.343801381,69.810768933,70.418289354\nwohnflache_pro_person_m2, None, 47.311517,39.026379,38.692324\nvermogenssteuer_pro_veranlagung, None, 2378.931266,483.02681775,460.5646986\neinkommenssteuer_pro_veranlagung, None, 10820.800512,7123.8581681,7075.5415415\nerwerbstatigenquote, None, 0.8077279565,0.7324650618,0.7397509203\narbeitsplatze_pro_einwohner, None, 0.9906581653,0.1403727831,0.6350379648\narbeitslosenquote, None, 0.0252819637,0.0466659488,0.0400550591\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nF\u00fcr welchen Zeitraum liegen besch\u00e4ftigungsbezogene Statistiken \u00fcber die Wohngebiete in Basel-Stadt vor?\n### SQL query\nSELECT MIN(T.jahr) erste_jahr, MAX(T.jahr) AS letzte_jahr\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE' ;\n\n\n### Question\nWelches Wohnviertel in Basel-Stadt hatte im Jahr 2023 die durchschnittlich \u00e4ltesten Geb\u00e4ude und welches war das durchschnittliche Baudatum?\n### SQL query\nSELECT S.name, T.baujahr_der_wohngebaude\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2023\nORDER BY T.baujahr_der_wohngebaude ASC\nLIMIT 1;\n\n\n### Question\nWie hoch ist die relative Ver\u00e4nderung (in %) des Ausl\u00e4nderanteils zwischen 2018 und 2023 in den einzelnen Wohnvierteln von Basel-Stadt?\n### SQL query\n",
    "process_time": 15.314689729828387,
    "num_tokens": 3044,
    "hardness": "unknown",
    "scores": [
      0.8779789805412292,
      0.8954439163208008
    ],
    "lang": "de"
  },
  {
    "i": 116,
    "question": "Wie hiessen die 3 bev\u00f6lkerungsreichsten Gemeinden im Kanton Schwyz im Jahr 2015?",
    "query": "SELECT S.name\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) DESC\nLIMIT 3;\n",
    "db_id": "schwyz_standige_wohnbevolkerung_geschlecht_nationalitat",
    "generated_query": "SELECT\n    S.name,\n    SUM(T.anzahl_personen) AS gesamtbevolkerung\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) DESC\nLIMIT 3;",
    "meta_data": [
      {
        "question": "Wie hoch war die j\u00e4hrliche Wachstumsrate der Bev\u00f6lkerung im Kanton Schwyz in den Jahren 2005-2010?",
        "query": "WITH T1 AS (\n    SELECT\n        T.jahr,\n        SUM(T.anzahl_personen) AS tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr >= 2005\n        AND T.jahr <= 2010\n    GROUP BY T.jahr\n    ORDER BY T.jahr ASC\n)\nSELECT\n    T1.jahr,\n    (\n        100.0 *\n        (T1.tot_personen - LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)) /\n        LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)\n    ) AS tot_personen_vorjahr\nFROM T1;\n",
        "score": 0.6370728015899658
      },
      {
        "question": "Zeigen Sie mir die Anzahl ausl\u00e4ndischer und schweizerischer Einwohner f\u00fcr die 5 bev\u00f6lkerungsreichsten Gemeinden in Schwyz im Jahr 2015.",
        "query": "SELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) DESC\nLIMIT 5;\n",
        "score": 0.6415995359420776
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.schwyz_standige_wohnbevolkerung_geschlecht_nationalitat (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tgeschlecht TEXT, \n\tnationalitaet TEXT, \n\tanzahl_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT schwyz_standige_wohnbevolkerung_geschlecht_nationalitat_pkey PRIMARY KEY (uid), \n\tCONSTRAINT schwyz_standige_wohnbevolkerung_geschlecht_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in schwyz_standige_wohnbevolkerung_geschlecht_nationalitat and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nanzahl_personen : 92, 78, 2404, 111, 2328\nspatialunit_uid : 1321_A.ADM3, 1322_A.ADM3, 1301_A.ADM3, 1366_A.ADM3, 1369_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\ngeschlecht, Geschlecht, m\u00e4nnlich,weiblich\nnationalitaet, Nationalit\u00e4t, Schweiz,Ausland\nanzahl_personen, Anzahl Personen, 3873,964,2926\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWie hoch war die schweizerische und ausl\u00e4ndische Bev\u00f6lkerung in den 3 kleinsten Schwyzer Gemeinden im Jahr 2020?\n### SQL query\nSELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS anzahl_schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS anzahl_auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) ASC\nLIMIT 3;\n\n\n### Question\nWie hoch war die j\u00e4hrliche Wachstumsrate der Bev\u00f6lkerung im Kanton Schwyz in den Jahren 2005-2010?\n### SQL query\nWITH T1 AS (\n    SELECT\n        T.jahr,\n        SUM(T.anzahl_personen) AS tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr >= 2005\n        AND T.jahr <= 2010\n    GROUP BY T.jahr\n    ORDER BY T.jahr ASC\n)\nSELECT\n    T1.jahr,\n    (\n        100.0 *\n        (T1.tot_personen - LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)) /\n        LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)\n    ) AS tot_personen_vorjahr\nFROM T1;\n\n\n### Question\nWie hiessen die 3 bev\u00f6lkerungsreichsten Gemeinden im Kanton Schwyz im Jahr 2015?\n### SQL query\n",
    "process_time": 10.765938164899126,
    "num_tokens": 1370,
    "hardness": "extra",
    "scores": [
      0.6370728015899658,
      0.6415995359420776
    ],
    "lang": "de"
  },
  {
    "i": 117,
    "question": "Wie hoch war der Anteil der M\u00e4nner an der schweizerischen und ausl\u00e4ndischen Wohnbev\u00f6lkerung im Kanton Schwyz in den Jahren 2015 bis 2020?",
    "query": "SELECT\n    T.jahr,\n    (\n        SUM(CASE WHEN T.geschlecht = 'm\u00e4nnlich' AND T.nationalitaet = 'Schweiz' THEN T.anzahl_personen END) /\n        SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen END)\n    ) AS anteil_manner_schweizer,\n    (\n        SUM(CASE WHEN T.geschlecht = 'm\u00e4nnlich' AND T.nationalitaet = 'Ausland' THEN T.anzahl_personen END) /\n        SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen END)\n    ) AS anteil_manner_auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr >= 2015\n    AND T.jahr >= 2020\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n",
    "db_id": "schwyz_standige_wohnbevolkerung_geschlecht_nationalitat",
    "generated_query": "SELECT\n    T.jahr,\n    SUM(CASE WHEN T.geschlecht = 'm\u00e4nnlich' AND T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS anzahl_schweizer_m\u00e4nner,\n    SUM(CASE WHEN T.geschlecht = 'm\u00e4nnlich' AND T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS anzahl_ausl\u00e4nder_m\u00e4nner,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS anzahl_schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS anzahl_ausl\u00e4nder\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr >= 2015\n    AND T.jahr <= 2020\nGROUP BY T.jahr\nORDER BY T.jahr ASC;",
    "meta_data": [
      {
        "question": "Zeigen Sie mir die Anzahl der M\u00e4nner und Frauen im Kanton Schwyz in den Jahren 2005, 2010, 2015 und 2020.",
        "query": "SELECT\n    T.jahr,\n    SUM(CASE WHEN T.geschlecht = 'm\u00e4nnlich' THEN T.anzahl_personen END) AS anzahl_manner,\n    SUM(CASE WHEN T.geschlecht = 'weiblich' THEN T.anzahl_personen END) AS anzahl_frauen\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2005, 2010, 2015, 2020)\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n",
        "score": 0.6055418252944946
      },
      {
        "question": "Wie hoch war die j\u00e4hrliche Wachstumsrate der Bev\u00f6lkerung im Kanton Schwyz in den Jahren 2005-2010?",
        "query": "WITH T1 AS (\n    SELECT\n        T.jahr,\n        SUM(T.anzahl_personen) AS tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr >= 2005\n        AND T.jahr <= 2010\n    GROUP BY T.jahr\n    ORDER BY T.jahr ASC\n)\nSELECT\n    T1.jahr,\n    (\n        100.0 *\n        (T1.tot_personen - LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)) /\n        LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)\n    ) AS tot_personen_vorjahr\nFROM T1;\n",
        "score": 0.6613352298736572
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.schwyz_standige_wohnbevolkerung_geschlecht_nationalitat (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tgeschlecht TEXT, \n\tnationalitaet TEXT, \n\tanzahl_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT schwyz_standige_wohnbevolkerung_geschlecht_nationalitat_pkey PRIMARY KEY (uid), \n\tCONSTRAINT schwyz_standige_wohnbevolkerung_geschlecht_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in schwyz_standige_wohnbevolkerung_geschlecht_nationalitat and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nanzahl_personen : 92, 78, 2404, 111, 2328\nspatialunit_uid : 1321_A.ADM3, 1322_A.ADM3, 1301_A.ADM3, 1366_A.ADM3, 1369_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\ngeschlecht, Geschlecht, m\u00e4nnlich,weiblich\nnationalitaet, Nationalit\u00e4t, Schweiz,Ausland\nanzahl_personen, Anzahl Personen, 3873,964,2926\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWie hoch war die schweizerische und ausl\u00e4ndische Bev\u00f6lkerung in den 3 kleinsten Schwyzer Gemeinden im Jahr 2020?\n### SQL query\nSELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS anzahl_schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS anzahl_auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) ASC\nLIMIT 3;\n\n\n### Question\nWie hoch war die j\u00e4hrliche Wachstumsrate der Bev\u00f6lkerung im Kanton Schwyz in den Jahren 2005-2010?\n### SQL query\nWITH T1 AS (\n    SELECT\n        T.jahr,\n        SUM(T.anzahl_personen) AS tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr >= 2005\n        AND T.jahr <= 2010\n    GROUP BY T.jahr\n    ORDER BY T.jahr ASC\n)\nSELECT\n    T1.jahr,\n    (\n        100.0 *\n        (T1.tot_personen - LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)) /\n        LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)\n    ) AS tot_personen_vorjahr\nFROM T1;\n\n\n### Question\nWie hoch war der Anteil der M\u00e4nner an der schweizerischen und ausl\u00e4ndischen Wohnbev\u00f6lkerung im Kanton Schwyz in den Jahren 2015 bis 2020?\n### SQL query\n",
    "process_time": 16.44398986012675,
    "num_tokens": 1386,
    "hardness": "unknown",
    "scores": [
      0.6055418252944946,
      0.6613352298736572
    ],
    "lang": "de"
  },
  {
    "i": 118,
    "question": "Wie viele Einwohner gab es in Freienbach (SZ) im Zeitraum 2010 - 2020 ?",
    "query": "SELECT T.jahr, SUM(T.anzahl_personen)\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Freienbach', 'Freienbach (SZ)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2020\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n",
    "db_id": "schwyz_standige_wohnbevolkerung_geschlecht_nationalitat",
    "generated_query": "SELECT SUM(anzahl_personen) AS anzahl_einwohner\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Freienbach', 'Freienbach (SZ)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2020;",
    "meta_data": [
      {
        "question": "Zeigen Sie mir f\u00fcr jedes Jahr im Zeitraum 2018 - 2021 die Anzahl der Schweizer Einwohner in Einsiedeln, SZ.",
        "query": "SELECT T.jahr, SUM(T.anzahl_personen) AS anzahl_schweizer_2021_einsiedeln\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr >= 2018\n    AND T.jahr <= 2021\n    AND S.name IN ('Einsiedeln', 'Einsiedeln (SZ)')\n    AND T.nationalitaet = 'Schweiz'\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n",
        "score": 0.45110103487968445
      },
      {
        "question": "Zeigen Sie mir die Anzahl ausl\u00e4ndischer und schweizerischer Einwohner f\u00fcr die 5 bev\u00f6lkerungsreichsten Gemeinden in Schwyz im Jahr 2015.",
        "query": "SELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) DESC\nLIMIT 5;\n",
        "score": 0.6207379102706909
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.schwyz_standige_wohnbevolkerung_geschlecht_nationalitat (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tgeschlecht TEXT, \n\tnationalitaet TEXT, \n\tanzahl_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT schwyz_standige_wohnbevolkerung_geschlecht_nationalitat_pkey PRIMARY KEY (uid), \n\tCONSTRAINT schwyz_standige_wohnbevolkerung_geschlecht_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in schwyz_standige_wohnbevolkerung_geschlecht_nationalitat and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nanzahl_personen : 92, 78, 2404, 111, 2328\nspatialunit_uid : 1321_A.ADM3, 1322_A.ADM3, 1301_A.ADM3, 1366_A.ADM3, 1369_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\ngeschlecht, Geschlecht, m\u00e4nnlich,weiblich\nnationalitaet, Nationalit\u00e4t, Schweiz,Ausland\nanzahl_personen, Anzahl Personen, 3873,964,2926\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nZeigen Sie mir die Anzahl ausl\u00e4ndischer und schweizerischer Einwohner f\u00fcr die 5 bev\u00f6lkerungsreichsten Gemeinden in Schwyz im Jahr 2015.\n### SQL query\nSELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) DESC\nLIMIT 5;\n\n\n### Question\nZeigen Sie mir f\u00fcr jedes Jahr im Zeitraum 2018 - 2021 die Anzahl der Schweizer Einwohner in Einsiedeln, SZ.\n### SQL query\nSELECT T.jahr, SUM(T.anzahl_personen) AS anzahl_schweizer_2021_einsiedeln\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr >= 2018\n    AND T.jahr <= 2021\n    AND S.name IN ('Einsiedeln', 'Einsiedeln (SZ)')\n    AND T.nationalitaet = 'Schweiz'\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n\n\n### Question\nWie viele Einwohner gab es in Freienbach (SZ) im Zeitraum 2010 - 2020 ?\n### SQL query\n",
    "process_time": 6.401630474952981,
    "num_tokens": 1321,
    "hardness": "unknown",
    "scores": [
      0.45110103487968445,
      0.6207379102706909
    ],
    "lang": "de"
  },
  {
    "i": 119,
    "question": "Zeigen Sie mir den Anteil der ausl\u00e4ndischen Bev\u00f6lkerung (als Verh\u00e4ltnis) im Kanton Schwyz in jedem Jahr zwischen 2010 und 2020.",
    "query": "SELECT\n    T.jahr,\n    (\n        SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) /\n        SUM(T.anzahl_personen)\n    ) AS anteil_auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr >= 2010\n    AND T.jahr <= 2020\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n",
    "db_id": "schwyz_standige_wohnbevolkerung_geschlecht_nationalitat",
    "generated_query": "SELECT\n    T.jahr,\n    (SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) / SUM(T.anzahl_personen)) AS anteil_auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr >= 2010\n    AND T.jahr <= 2020\nGROUP BY T.jahr\nORDER BY T.jahr ASC;",
    "meta_data": [
      {
        "question": "Zeigen Sie mir die Anzahl ausl\u00e4ndischer und schweizerischer Einwohner f\u00fcr die 5 bev\u00f6lkerungsreichsten Gemeinden in Schwyz im Jahr 2015.",
        "query": "SELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) DESC\nLIMIT 5;\n",
        "score": 0.5000686645507812
      },
      {
        "question": "Zeigen Sie mir die Anzahl der M\u00e4nner und Frauen im Kanton Schwyz in den Jahren 2005, 2010, 2015 und 2020.",
        "query": "SELECT\n    T.jahr,\n    SUM(CASE WHEN T.geschlecht = 'm\u00e4nnlich' THEN T.anzahl_personen END) AS anzahl_manner,\n    SUM(CASE WHEN T.geschlecht = 'weiblich' THEN T.anzahl_personen END) AS anzahl_frauen\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2005, 2010, 2015, 2020)\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n",
        "score": 0.5057795643806458
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.schwyz_standige_wohnbevolkerung_geschlecht_nationalitat (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tgeschlecht TEXT, \n\tnationalitaet TEXT, \n\tanzahl_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT schwyz_standige_wohnbevolkerung_geschlecht_nationalitat_pkey PRIMARY KEY (uid), \n\tCONSTRAINT schwyz_standige_wohnbevolkerung_geschlecht_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in schwyz_standige_wohnbevolkerung_geschlecht_nationalitat and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nanzahl_personen : 92, 78, 2404, 111, 2328\nspatialunit_uid : 1321_A.ADM3, 1322_A.ADM3, 1301_A.ADM3, 1366_A.ADM3, 1369_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\ngeschlecht, Geschlecht, m\u00e4nnlich,weiblich\nnationalitaet, Nationalit\u00e4t, Schweiz,Ausland\nanzahl_personen, Anzahl Personen, 3873,964,2926\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWie hoch war die schweizerische und ausl\u00e4ndische Bev\u00f6lkerung in den 3 kleinsten Schwyzer Gemeinden im Jahr 2020?\n### SQL query\nSELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS anzahl_schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS anzahl_auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) ASC\nLIMIT 3;\n\n\n### Question\nWie hoch war die j\u00e4hrliche Wachstumsrate der Bev\u00f6lkerung im Kanton Schwyz in den Jahren 2005-2010?\n### SQL query\nWITH T1 AS (\n    SELECT\n        T.jahr,\n        SUM(T.anzahl_personen) AS tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr >= 2005\n        AND T.jahr <= 2010\n    GROUP BY T.jahr\n    ORDER BY T.jahr ASC\n)\nSELECT\n    T1.jahr,\n    (\n        100.0 *\n        (T1.tot_personen - LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)) /\n        LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)\n    ) AS tot_personen_vorjahr\nFROM T1;\n\n\n### Question\nZeigen Sie mir den Anteil der ausl\u00e4ndischen Bev\u00f6lkerung (als Verh\u00e4ltnis) im Kanton Schwyz in jedem Jahr zwischen 2010 und 2020.\n### SQL query\n",
    "process_time": 15.149422047892585,
    "num_tokens": 1387,
    "hardness": "unknown",
    "scores": [
      0.5000686645507812,
      0.5057795643806458
    ],
    "lang": "de"
  },
  {
    "i": 120,
    "question": "Bei der Umwandlung durch Kernkraftwerke, welche Energietr\u00e4ger sind da mit welchen Mengen durchschnittlich im Spiel?",
    "query": "SELECT\n    energietraeger,\n    AVG(energiemenge_in_tera_joule) as durchschnittliche_umwandlung_kernkraft_in_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%umwandlung%'\nAND LOWER(nutzungs_sektor) LIKE '%kernkraftwerk%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY energietraeger\nORDER BY durchschnittliche_umwandlung_kernkraft_in_tj ASC;\n",
    "db_id": "energiebilanz_schweiz_in_tera_joule",
    "generated_query": "SELECT energietraeger, AVG(energiemenge_in_tera_joule) as durchschnittliche_menge\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%kernkraftwerke%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY energietraeger;",
    "meta_data": [
      {
        "question": "Welche Energietr\u00e4ger kamen 2019 bei Energieumwandlung vor und in welchem Umfang? .",
        "query": "SELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as energie_umwandlung_2019_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%umwandlung%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nAND jahr = 2019\nGROUP BY nutzungs_sektor\nORDER BY energie_umwandlung_2019_tj ASC;\n",
        "score": 0.5427220463752747
      },
      {
        "question": "In 2020 welche Endverbrauchs Sektoren haben Kohle als Energietr\u00e4ger benutzt und in welchem Umfang? .",
        "query": "SELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as energieverbrauch_in_kohle_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(nutzungs_sektor) LIKE '%verbrauch%'\nAND LOWER(energietraeger) LIKE '%kohle%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY nutzungs_sektor\nORDER BY energieverbrauch_in_kohle_tj DESC;\n",
        "score": 0.6977584362030029
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.energiebilanz_schweiz_in_tera_joule (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tnutzungs_sektor TEXT, \n\tenergietraeger TEXT, \n\tenergiemenge_in_tera_joule NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT energiebilanz_schweiz_in_tera_joule_pkey PRIMARY KEY (uid), \n\tCONSTRAINT energiebilanz_schweiz_in_tera_joule_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in energiebilanz_schweiz_in_tera_joule and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nnutzungs_sektor : Energieumwandlung - Diverse Erneuerbare, Lagerver\u00e4nderung, Export, Endverbrauch - Industrie, Endverbrauch - Total\nenergietraeger : Gas, Elektrizit\u00e4t, Kohle, Holzenergie, Fernw\u00e4rme\nenergiemenge_in_tera_joule : 1890, 7520, 120750, 32560, 14300\n*/\n\n/*\nColumn name, Column discription, Example values\nenergietraeger, Energietr\u00e4ger, Elektrizit\u00e4t,Wasserkraft,Uebrige erneuerbare Energien,M\u00fcll und Industrieabf\u00e4lle\nnutzungs_sektor, Nutzungs Rubrik, Endverbrauch - Haushalte,Endverbrauch - Industrie,Import\nenergiemenge_in_tera_joule, Numeric value in Terajoule, NA,14820,4820\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWelche Energietr\u00e4ger kamen 2019 bei Energieumwandlung vor und in welchem Umfang? .\n### SQL query\nSELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as energie_umwandlung_2019_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%umwandlung%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nAND jahr = 2019\nGROUP BY nutzungs_sektor\nORDER BY energie_umwandlung_2019_tj ASC;\n\n\n### Question\nGibt es Energietr\u00e4ger der niemals importiert wurden?\n### SQL query\nSELECT energietraeger\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%import%'\nGROUP BY energietraeger\nHAVING SUM(energiemenge_in_tera_joule) IS NULL OR SUM(energiemenge_in_tera_joule) = 0;\n\n\n### Question\nBei der Umwandlung durch Kernkraftwerke, welche Energietr\u00e4ger sind da mit welchen Mengen durchschnittlich im Spiel?\n### SQL query\n",
    "process_time": 10.201670007081702,
    "num_tokens": 1290,
    "hardness": "unknown",
    "scores": [
      0.5427220463752747,
      0.6977584362030029
    ],
    "lang": "de"
  },
  {
    "i": 121,
    "question": "Welches war der am meisten exportierten Energietraeger 2020 in der Schweiz und wieviel wurde exportiert?",
    "query": "SELECT nutzungs_sektor, energietraeger, SUM(energiemenge_in_tera_joule) as tj_export_2020\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(nutzungs_sektor) LIKE '%export%'\nAND energiemenge_in_tera_joule IS NOT NULL\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY tj_export_2020 DESC;\n",
    "db_id": "energiebilanz_schweiz_in_tera_joule",
    "generated_query": "SELECT nutzungs_sektor, energietraeger, SUM(energiemenge_in_tera_joule) as tj_export_2020\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(nutzungs_sektor) LIKE '%export%'\nAND energiemenge_in_tera_joule IS NOT NULL\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY tj_export_2020 DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Welches waren die f\u00fcnf am meisten importierten Energietraeger 2020 in der Schweiz und wieviel wurde importiert?",
        "query": "SELECT nutzungs_sektor, energietraeger, SUM(energiemenge_in_tera_joule) as tj_import_2020\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(nutzungs_sektor) LIKE '%import%'\nAND energiemenge_in_tera_joule IS NOT NULL\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY tj_import_2020 DESC;\n",
        "score": 0.47582879662513733
      },
      {
        "question": "Gibt es Energietr\u00e4ger der niemals exportiert wurden?",
        "query": "SELECT energietraeger\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%export%'\nGROUP BY energietraeger\nHAVING SUM(energiemenge_in_tera_joule) IS NULL OR SUM(energiemenge_in_tera_joule) = 0;\n",
        "score": 0.5929868817329407
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.energiebilanz_schweiz_in_tera_joule (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tnutzungs_sektor TEXT, \n\tenergietraeger TEXT, \n\tenergiemenge_in_tera_joule NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT energiebilanz_schweiz_in_tera_joule_pkey PRIMARY KEY (uid), \n\tCONSTRAINT energiebilanz_schweiz_in_tera_joule_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in energiebilanz_schweiz_in_tera_joule and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nnutzungs_sektor : Energieumwandlung - Diverse Erneuerbare, Lagerver\u00e4nderung, Export, Endverbrauch - Industrie, Endverbrauch - Total\nenergietraeger : Gas, Elektrizit\u00e4t, Kohle, Holzenergie, Fernw\u00e4rme\nenergiemenge_in_tera_joule : 1890, 7520, 120750, 32560, 14300\n*/\n\n/*\nColumn name, Column discription, Example values\nenergietraeger, Energietr\u00e4ger, Elektrizit\u00e4t,Wasserkraft,Uebrige erneuerbare Energien,M\u00fcll und Industrieabf\u00e4lle\nnutzungs_sektor, Nutzungs Rubrik, Endverbrauch - Haushalte,Endverbrauch - Industrie,Import\nenergiemenge_in_tera_joule, Numeric value in Terajoule, NA,14820,4820\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nGibt es Energietr\u00e4ger der niemals exportiert wurden?\n### SQL query\nSELECT energietraeger\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%export%'\nGROUP BY energietraeger\nHAVING SUM(energiemenge_in_tera_joule) IS NULL OR SUM(energiemenge_in_tera_joule) = 0;\n\n\n### Question\nWelches waren die f\u00fcnf am meisten importierten Energietraeger 2020 in der Schweiz und wieviel wurde importiert?\n### SQL query\nSELECT nutzungs_sektor, energietraeger, SUM(energiemenge_in_tera_joule) as tj_import_2020\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(nutzungs_sektor) LIKE '%import%'\nAND energiemenge_in_tera_joule IS NOT NULL\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY tj_import_2020 DESC;\n\n\n### Question\nWelches war der am meisten exportierten Energietraeger 2020 in der Schweiz und wieviel wurde exportiert?\n### SQL query\n",
    "process_time": 11.975587942171842,
    "num_tokens": 1271,
    "hardness": "unknown",
    "scores": [
      0.47582879662513733,
      0.5929868817329407
    ],
    "lang": "de"
  },
  {
    "i": 122,
    "question": "In 2020 auf welche Energietr\u00e4ger hat sich der Verbrauch von Haushalten gest\u00fctzt? Gib die Energietr\u00e4ger und Energiemengen an.",
    "query": "SELECT energietraeger, SUM(energiemenge_in_tera_joule) as energieverbrauch_in_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(nutzungs_sektor) LIKE '%verbrauch%haushalt%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY energieverbrauch_in_tj DESC;\n",
    "db_id": "energiebilanz_schweiz_in_tera_joule",
    "generated_query": "SELECT energietraeger, SUM(energiemenge_in_tera_joule) as energieverbrauch_haushalte_2020_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(nutzungs_sektor) LIKE '%haushalte%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY energietraeger\nORDER BY energieverbrauch_haushalte_2020_tj DESC;",
    "meta_data": [
      {
        "question": "Welche Energietr\u00e4ger kamen 2019 bei Energieumwandlung vor und in welchem Umfang? .",
        "query": "SELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as energie_umwandlung_2019_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%umwandlung%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nAND jahr = 2019\nGROUP BY nutzungs_sektor\nORDER BY energie_umwandlung_2019_tj ASC;\n",
        "score": 0.6270699501037598
      },
      {
        "question": "Welche nutzungssektoren hatten 2020 mit Erneuerbarer Energie zu tun und wenn ja in welchem Umfang?",
        "query": "SELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as anteil_erneuerbare_energien_2020_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(energietraeger) LIKE '%erneuerbar%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY anteil_erneuerbare_energien_2020_tj DESC;\n",
        "score": 0.7805286049842834
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.energiebilanz_schweiz_in_tera_joule (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tnutzungs_sektor TEXT, \n\tenergietraeger TEXT, \n\tenergiemenge_in_tera_joule NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT energiebilanz_schweiz_in_tera_joule_pkey PRIMARY KEY (uid), \n\tCONSTRAINT energiebilanz_schweiz_in_tera_joule_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in energiebilanz_schweiz_in_tera_joule and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nnutzungs_sektor : Energieumwandlung - Diverse Erneuerbare, Lagerver\u00e4nderung, Export, Endverbrauch - Industrie, Endverbrauch - Total\nenergietraeger : Gas, Elektrizit\u00e4t, Kohle, Holzenergie, Fernw\u00e4rme\nenergiemenge_in_tera_joule : 1890, 7520, 120750, 32560, 14300\n*/\n\n/*\nColumn name, Column discription, Example values\nenergietraeger, Energietr\u00e4ger, Elektrizit\u00e4t,Wasserkraft,Uebrige erneuerbare Energien,M\u00fcll und Industrieabf\u00e4lle\nnutzungs_sektor, Nutzungs Rubrik, Endverbrauch - Haushalte,Endverbrauch - Industrie,Import\nenergiemenge_in_tera_joule, Numeric value in Terajoule, NA,14820,4820\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWelche Energietr\u00e4ger kamen 2019 bei Energieumwandlung vor und in welchem Umfang? .\n### SQL query\nSELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as energie_umwandlung_2019_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%umwandlung%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nAND jahr = 2019\nGROUP BY nutzungs_sektor\nORDER BY energie_umwandlung_2019_tj ASC;\n\n\n### Question\nWelche nutzungssektoren hatten 2020 mit Erneuerbarer Energie zu tun und wenn ja in welchem Umfang?\n### SQL query\nSELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as anteil_erneuerbare_energien_2020_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(energietraeger) LIKE '%erneuerbar%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY anteil_erneuerbare_energien_2020_tj DESC;\n\n\n### Question\nIn 2020 auf welche Energietr\u00e4ger hat sich der Verbrauch von Haushalten gest\u00fctzt? Gib die Energietr\u00e4ger und Energiemengen an.\n### SQL query\n",
    "process_time": 9.199943415122107,
    "num_tokens": 1372,
    "hardness": "unknown",
    "scores": [
      0.6270699501037598,
      0.7805286049842834
    ],
    "lang": "de"
  },
  {
    "i": 123,
    "question": "Welche Rentenarten gibt es in der Schweiz und was sind die durchschnittliche Ausgaben daf\u00fcr pro Jahr?",
    "query": "SELECT rententyp,\n  (AVG(rentensumme_in_tausend_franken) * 1000) as durchschnittliche_ausgaben_pro_jahr_chf\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND geschlecht = 'Geschlecht - Total'\nGROUP BY rententyp\nORDER BY durchschnittliche_ausgaben_pro_jahr_chf DESC;\n",
    "db_id": "ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit",
    "generated_query": "SELECT rententyp, AVG(renten_mittelwert_in_franken) as durchschnittliche_ausgaben_pro_jahr\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nGROUP BY rententyp;",
    "meta_data": [
      {
        "question": "F\u00fcr welche Rentenarten ist die durchschnittlich Rente zwischen 2001 und 2022 heruntergegangen und wenn ja um wieviele CHF?",
        "query": "SELECT T1.rententyp,\n  (AVG(T2.renten_mittelwert_in_franken) - AVG(T1.renten_mittelwert_in_franken)) as rentenabzug_2022_genueber_2001_CHF\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.rententyp = T2.rententyp\nWHERE T1.jahr = 2001 AND T2.jahr = 2022\n  AND T1.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total' AND T1.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total' AND T2.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.geschlecht = 'Geschlecht - Total' AND T1.geschlecht = 'Geschlecht - Total'\n  AND T2.renten_mittelwert_in_franken > T1.renten_mittelwert_in_franken\nGROUP BY T1.rententyp;\n",
        "score": 0.582647442817688
      },
      {
        "question": "Was war die h\u00e4ufigste Rentenart 2022 in der Schweiz?",
        "query": "SELECT rententyp as haufigste_rentenart_2022_schweiz\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '2022'\nORDER BY anzahl_renten DESC LIMIT 1;\n",
        "score": 0.637836217880249
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit (\n\tuid SERIAL NOT NULL, \n\trententyp TEXT, \n\twohnsitzstaat_kategorie TEXT, \n\tstaatsangehorigkeit_kategorie TEXT, \n\tgeschlecht TEXT, \n\tjahr INTEGER, \n\tspatialunit_uid VARCHAR, \n\tanzahl_renten NUMERIC, \n\trentensumme_in_tausend_franken NUMERIC, \n\trenten_mittelwert_in_franken NUMERIC, \n\tCONSTRAINT ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit_pkey PRIMARY KEY (uid), \n\tCONSTRAINT ahv_renten_nach_wohnsitz_und_staatsangehoe_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 2006, 2002, 2005, 2017\nanzahl_renten : 1184836, 659616, 408075, 1393079, 1319045\nrentensumme_in_tausend_franken : 2871566, 2136673, 2761964, 153891, 123384\nrenten_mittelwert_in_franken : 991, 1742, 1890, 1919, 1633\n*/\n\n/*\nColumn name, Column discription, Example values\nrententyp, Rentenart, Zusatzrente f\u00fcr Kinder (Mutter),Zusatzrente f\u00fcr Ehepartner,Altersrente\nwohnsitzstaat_kategorie, Wohnsitz Kategorie, Ausland,Schweiz,Wohnsitzstaat - Total\nstaatsangehorigkeit_kategorie, Staatsangeh\u00f6rigkeit Kategorie, Ausland,Schweiz,Staatsangeh\u00f6rigkeit - Total\ngeschlecht, Geschlecht, Frau,Mann,Geschlecht - Total\nanzahl_renten, Anzahl Renten, None\nrentensumme_in_tausend_franken, Rentensumme in Tausend CHF, None\nrenten_mittelwert_in_franken, Renten Mittelwert in CHF, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nF\u00fcr welche Rentenarten ist die durchschnittlich Rente zwischen 2001 und 2022 heruntergegangen und wenn ja um wieviele CHF?\n### SQL query\nSELECT T1.rententyp,\n  (AVG(T2.renten_mittelwert_in_franken) - AVG(T1.renten_mittelwert_in_franken)) as rentenabzug_2022_genueber_2001_CHF\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.rententyp = T2.rententyp\nWHERE T1.jahr = 2001 AND T2.jahr = 2022\n  AND T1.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total' AND T1.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total' AND T2.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.geschlecht = 'Geschlecht - Total' AND T1.geschlecht = 'Geschlecht - Total'\n  AND T2.renten_mittelwert_in_franken > T1.renten_mittelwert_in_franken\nGROUP BY T1.rententyp;\n\n\n### Question\nWas war die h\u00e4ufigste Rentenart 2022 in der Schweiz?\n### SQL query\nSELECT rententyp as haufigste_rentenart_2022_schweiz\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '2022'\nORDER BY anzahl_renten DESC LIMIT 1;\n\n\n### Question\nWelche Rentenarten gibt es in der Schweiz und was sind die durchschnittliche Ausgaben daf\u00fcr pro Jahr?\n### SQL query\n",
    "process_time": 7.146316263824701,
    "num_tokens": 1637,
    "hardness": "unknown",
    "scores": [
      0.582647442817688,
      0.637836217880249
    ],
    "lang": "de"
  },
  {
    "i": 124,
    "question": "Was waren die Gesamtausgaben f\u00fcr Renten 2022 in Franken, wie verteilten sie sich auf die Rentenarten, auf wieviele Renten jeweils und was kam dabei als durchschnittliche Rente heraus? Ordne das Ergebnis nach Anzahl der Renten.",
    "query": "SELECT rententyp,\n  anzahl_renten AS renten_anzahl_2022,\n  1000 * rentensumme_in_tausend_franken AS rentengesamt_ausgaben_in_CHF,\n  renten_mittelwert_in_franken AS durchschnittliche_rente_in_CHF\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE jahr = 2022\n  AND staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND geschlecht = 'Geschlecht - Total'\n  AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\nORDER BY anzahl_renten DESC;\n",
    "db_id": "ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit",
    "generated_query": "SELECT T.rententyp,\n  SUM(T.rentensumme_in_tausend_franken) as gesamtausgaben_2022_CHF,\n  SUM(T.anzahl_renten) as anzahl_renten,\n  AVG(T.renten_mittelwert_in_franken) as durchschnittliche_rente\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE jahr = '2022'\nGROUP BY T.rententyp\nORDER BY anzahl_renten;",
    "meta_data": [
      {
        "question": "F\u00fcr welche Rentenarten ist die durchschnittlich Rente zwischen 2001 und 2022 heruntergegangen und wenn ja um wieviele CHF?",
        "query": "SELECT T1.rententyp,\n  (AVG(T2.renten_mittelwert_in_franken) - AVG(T1.renten_mittelwert_in_franken)) as rentenabzug_2022_genueber_2001_CHF\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.rententyp = T2.rententyp\nWHERE T1.jahr = 2001 AND T2.jahr = 2022\n  AND T1.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total' AND T1.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total' AND T2.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.geschlecht = 'Geschlecht - Total' AND T1.geschlecht = 'Geschlecht - Total'\n  AND T2.renten_mittelwert_in_franken > T1.renten_mittelwert_in_franken\nGROUP BY T1.rententyp;\n",
        "score": 0.6055372357368469
      },
      {
        "question": "Was war die h\u00e4ufigste Rentenart 2022 in der Schweiz?",
        "query": "SELECT rententyp as haufigste_rentenart_2022_schweiz\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '2022'\nORDER BY anzahl_renten DESC LIMIT 1;\n",
        "score": 0.7869114279747009
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit (\n\tuid SERIAL NOT NULL, \n\trententyp TEXT, \n\twohnsitzstaat_kategorie TEXT, \n\tstaatsangehorigkeit_kategorie TEXT, \n\tgeschlecht TEXT, \n\tjahr INTEGER, \n\tspatialunit_uid VARCHAR, \n\tanzahl_renten NUMERIC, \n\trentensumme_in_tausend_franken NUMERIC, \n\trenten_mittelwert_in_franken NUMERIC, \n\tCONSTRAINT ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit_pkey PRIMARY KEY (uid), \n\tCONSTRAINT ahv_renten_nach_wohnsitz_und_staatsangehoe_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 2006, 2002, 2005, 2017\nanzahl_renten : 1184836, 659616, 408075, 1393079, 1319045\nrentensumme_in_tausend_franken : 2871566, 2136673, 2761964, 153891, 123384\nrenten_mittelwert_in_franken : 991, 1742, 1890, 1919, 1633\n*/\n\n/*\nColumn name, Column discription, Example values\nrententyp, Rentenart, Zusatzrente f\u00fcr Kinder (Mutter),Zusatzrente f\u00fcr Ehepartner,Altersrente\nwohnsitzstaat_kategorie, Wohnsitz Kategorie, Ausland,Schweiz,Wohnsitzstaat - Total\nstaatsangehorigkeit_kategorie, Staatsangeh\u00f6rigkeit Kategorie, Ausland,Schweiz,Staatsangeh\u00f6rigkeit - Total\ngeschlecht, Geschlecht, Frau,Mann,Geschlecht - Total\nanzahl_renten, Anzahl Renten, None\nrentensumme_in_tausend_franken, Rentensumme in Tausend CHF, None\nrenten_mittelwert_in_franken, Renten Mittelwert in CHF, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nF\u00fcr welche Rentenarten ist die durchschnittlich Rente zwischen 2001 und 2022 heruntergegangen und wenn ja um wieviele CHF?\n### SQL query\nSELECT T1.rententyp,\n  (AVG(T2.renten_mittelwert_in_franken) - AVG(T1.renten_mittelwert_in_franken)) as rentenabzug_2022_genueber_2001_CHF\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.rententyp = T2.rententyp\nWHERE T1.jahr = 2001 AND T2.jahr = 2022\n  AND T1.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total' AND T1.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total' AND T2.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.geschlecht = 'Geschlecht - Total' AND T1.geschlecht = 'Geschlecht - Total'\n  AND T2.renten_mittelwert_in_franken > T1.renten_mittelwert_in_franken\nGROUP BY T1.rententyp;\n\n\n### Question\nWas war die h\u00e4ufigste Rentenart 2022 in der Schweiz?\n### SQL query\nSELECT rententyp as haufigste_rentenart_2022_schweiz\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '2022'\nORDER BY anzahl_renten DESC LIMIT 1;\n\n\n### Question\nWas waren die Gesamtausgaben f\u00fcr Renten 2022 in Franken, wie verteilten sie sich auf die Rentenarten, auf wieviele Renten jeweils und was kam dabei als durchschnittliche Rente heraus? Ordne das Ergebnis nach Anzahl der Renten.\n### SQL query\n",
    "process_time": 9.458003843901679,
    "num_tokens": 1675,
    "hardness": "unknown",
    "scores": [
      0.6055372357368469,
      0.7869114279747009
    ],
    "lang": "de"
  },
  {
    "i": 125,
    "question": "Wie hoch war der Frauenanteil in prozent bei den Zusatzrenten f\u00fcr Ehepartner?",
    "query": "SELECT\n  ROUND(100 * SUM(CASE WHEN geschlecht = 'Frau'\n       THEN anzahl_renten ELSE 0 END) /\n   SUM(CASE WHEN geschlecht = 'Geschlecht - Total'\n       THEN anzahl_renten ELSE 0 END)\n  , 2) AS prozent_frauenanteil_bei_ehepartner_zusatzrenten\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE rententyp = 'Zusatzrente f\u00fcr Ehepartner'\n  AND staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total' AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total';\n",
    "db_id": "ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit",
    "generated_query": "SELECT (COUNT(*) FILTER (WHERE geschlecht = 'Frau') * 100.0 / COUNT(*)) AS frauenanteil_prozent\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit\nWHERE rententyp = 'Zusatzrente f\u00fcr Ehepartner'\n  AND staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total';",
    "meta_data": [
      {
        "question": "In welchen drei Jahren gab es die h\u00f6chsten Ausgaben f\u00fcr die Zusatzrenten f\u00fcr Waise und wie hoch waren diese in CHF?",
        "query": "SELECT 1000 * SUM(rentensumme_in_tausend_franken) as rentenausgaben_fur_waisenrente_CHF, jahr\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE rententyp LIKE '%Waise%'\n  AND staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND geschlecht = 'Geschlecht - Total'\nGROUP BY jahr\nORDER BY rentenausgaben_fur_waisenrente_CHF DESC\nLIMIT 3;\n",
        "score": 0.9419565200805664
      },
      {
        "question": "Wie entwickelten sich die Differenz der durchschnittliche Altersrente und der Anzahl der Renten f\u00fcr Frauen und M\u00e4nnern \u00fcber die Jahre?",
        "query": "SELECT T1.jahr,\n  (T1.renten_mittelwert_in_franken - T2.renten_mittelwert_in_franken) AS differenz_durchschnittliche_altersrente_frauen_maenner,\n  (T1.anzahl_renten - T2.anzahl_renten) AS differenz_anzahl_altersrenten_frauen_maenner\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.jahr = T2.jahr\nWHERE T1.geschlecht = 'Frau'\n  AND T2.geschlecht = 'Mann'\n  AND T1.rententyp = 'Altersrente' AND T2.rententyp = 'Altersrente'\n  AND T1.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T2.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T1.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total';\n",
        "score": 1.1992437839508057
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit (\n\tuid SERIAL NOT NULL, \n\trententyp TEXT, \n\twohnsitzstaat_kategorie TEXT, \n\tstaatsangehorigkeit_kategorie TEXT, \n\tgeschlecht TEXT, \n\tjahr INTEGER, \n\tspatialunit_uid VARCHAR, \n\tanzahl_renten NUMERIC, \n\trentensumme_in_tausend_franken NUMERIC, \n\trenten_mittelwert_in_franken NUMERIC, \n\tCONSTRAINT ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit_pkey PRIMARY KEY (uid), \n\tCONSTRAINT ahv_renten_nach_wohnsitz_und_staatsangehoe_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 2006, 2002, 2005, 2017\nanzahl_renten : 1184836, 659616, 408075, 1393079, 1319045\nrentensumme_in_tausend_franken : 2871566, 2136673, 2761964, 153891, 123384\nrenten_mittelwert_in_franken : 991, 1742, 1890, 1919, 1633\n*/\n\n/*\nColumn name, Column discription, Example values\nrententyp, Rentenart, Zusatzrente f\u00fcr Kinder (Mutter),Zusatzrente f\u00fcr Ehepartner,Altersrente\nwohnsitzstaat_kategorie, Wohnsitz Kategorie, Ausland,Schweiz,Wohnsitzstaat - Total\nstaatsangehorigkeit_kategorie, Staatsangeh\u00f6rigkeit Kategorie, Ausland,Schweiz,Staatsangeh\u00f6rigkeit - Total\ngeschlecht, Geschlecht, Frau,Mann,Geschlecht - Total\nanzahl_renten, Anzahl Renten, None\nrentensumme_in_tausend_franken, Rentensumme in Tausend CHF, None\nrenten_mittelwert_in_franken, Renten Mittelwert in CHF, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nIn welchen drei Jahren gab es die h\u00f6chsten Ausgaben f\u00fcr die Zusatzrenten f\u00fcr Waise und wie hoch waren diese in CHF?\n### SQL query\nSELECT 1000 * SUM(rentensumme_in_tausend_franken) as rentenausgaben_fur_waisenrente_CHF, jahr\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE rententyp LIKE '%Waise%'\n  AND staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND geschlecht = 'Geschlecht - Total'\nGROUP BY jahr\nORDER BY rentenausgaben_fur_waisenrente_CHF DESC\nLIMIT 3;\n\n\n### Question\nWie entwickelten sich die Differenz der durchschnittliche Altersrente und der Anzahl der Renten f\u00fcr Frauen und M\u00e4nnern \u00fcber die Jahre?\n### SQL query\nSELECT T1.jahr,\n  (T1.renten_mittelwert_in_franken - T2.renten_mittelwert_in_franken) AS differenz_durchschnittliche_altersrente_frauen_maenner,\n  (T1.anzahl_renten - T2.anzahl_renten) AS differenz_anzahl_altersrenten_frauen_maenner\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.jahr = T2.jahr\nWHERE T1.geschlecht = 'Frau'\n  AND T2.geschlecht = 'Mann'\n  AND T1.rententyp = 'Altersrente' AND T2.rententyp = 'Altersrente'\n  AND T1.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T2.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T1.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total';\n\n\n### Question\nWie hoch war der Frauenanteil in prozent bei den Zusatzrenten f\u00fcr Ehepartner?\n### SQL query\n",
    "process_time": 7.920844967942685,
    "num_tokens": 1687,
    "hardness": "unknown",
    "scores": [
      0.9419565200805664,
      1.1992437839508057
    ],
    "lang": "de"
  },
  {
    "i": 126,
    "question": "Welches waren die Themen der Volksabstimmungen in 2022?",
    "query": "SELECT DISTINCT(T.thema)\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.jahr = '2022' AND anzahl_abstimmungsvorlagen != 0;\n",
    "db_id": "abstimmungsvorlagen_seit_1971",
    "generated_query": "SELECT DISTINCT(thema)\nFROM abstimmungsvorlagen_seit_1971\nWHERE jahr = 2022;",
    "meta_data": [
      {
        "question": "In welchem Jahr gab es die gr\u00f6sste Diversit\u00e4t von Themen bei Volksabstimmungen?",
        "query": "SELECT COUNT(DISTINCT(thema)) as anzahl_themen_pro_jahr, jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE anzahl_abstimmungsvorlagen <> 0\nGROUP BY T.jahr\nORDER BY anzahl_themen_pro_jahr DESC LIMIT 1;\n",
        "score": 0.6450740098953247
      },
      {
        "question": "Was war die 5 dominantesten Themen bei den Volksabstimmungen \u00fcber die Jahre in der Schweiz?",
        "query": "SELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 5;\n",
        "score": 0.6601555347442627
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.abstimmungsvorlagen_seit_1971 (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tthema TEXT, \n\tanzahl_abstimmungsvorlagen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_pkey PRIMARY KEY (uid), \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in abstimmungsvorlagen_seit_1971 and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 2013, 2017, 2021, 2011\nthema : Landwirtschaft, Energie, Sozialpolitik, Kultur, Religion, Medien, \u00d6ffentliche Finanzen\n*/\n\n/*\nColumn name, Column discription, Example values\nthema, Thema, Aussenpolitik,\u00d6ffentliche Finanzen,Umwelt und Lebensraum\nanzahl_abstimmungsvorlagen, Anzahl Abstimmungsvorlagen, 3\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nIn welchem Jahr gab es die gr\u00f6sste Diversit\u00e4t von Themen bei Volksabstimmungen?\n### SQL query\nSELECT COUNT(DISTINCT(thema)) as anzahl_themen_pro_jahr, jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE anzahl_abstimmungsvorlagen <> 0\nGROUP BY T.jahr\nORDER BY anzahl_themen_pro_jahr DESC LIMIT 1;\n\n\n### Question\nWelches 3 Themen hatten die wenigsten Volksabstimmungen in der Schweiz?\n### SQL query\nSELECT T.thema, SUM(T.anzahl_abstimmungsvorlagen) as abstimmungsvorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.thema\nORDER BY abstimmungsvorlagen_pro_thema ASC LIMIT 3;\n\n\n### Question\nWelches waren die Themen der Volksabstimmungen in 2022?\n### SQL query\n",
    "process_time": 2.662896072026342,
    "num_tokens": 1128,
    "hardness": "medium",
    "scores": [
      0.6450740098953247,
      0.6601555347442627
    ],
    "lang": "de"
  },
  {
    "i": 127,
    "question": "In welchem Jahren gab es die Volksabstimmungen zum Thema Energie in der Schweiz?",
    "query": "SELECT T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.thema LIKE '%Energie%' AND anzahl_abstimmungsvorlagen != 0\nORDER BY jahr DESC;\n",
    "db_id": "abstimmungsvorlagen_seit_1971",
    "generated_query": "SELECT jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema = 'Energie'\nORDER BY jahr;",
    "meta_data": [
      {
        "question": "In welchen Jahren war Sicherheit ein Thema bei Volksabstimmungen?",
        "query": "SELECT jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sicherheit%'\nORDER BY jahr DESC;\n",
        "score": 0.5572060346603394
      },
      {
        "question": "In welchem Jahren war die Wirtschaft ein Thema in Volksabstimmungen?",
        "query": "SELECT T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.thema LIKE '%Wirtschaft%' AND anzahl_abstimmungsvorlagen != 0\nORDER BY jahr DESC;\n",
        "score": 0.6380725502967834
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.abstimmungsvorlagen_seit_1971 (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tthema TEXT, \n\tanzahl_abstimmungsvorlagen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_pkey PRIMARY KEY (uid), \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in abstimmungsvorlagen_seit_1971 and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 2013, 2017, 2021, 2011\nthema : Landwirtschaft, Energie, Sozialpolitik, Kultur, Religion, Medien, \u00d6ffentliche Finanzen\n*/\n\n/*\nColumn name, Column discription, Example values\nthema, Thema, Aussenpolitik,\u00d6ffentliche Finanzen,Umwelt und Lebensraum\nanzahl_abstimmungsvorlagen, Anzahl Abstimmungsvorlagen, 3\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWelches Thema hatte die meisten Volksabstimmungen in den Jahren 1990 bis 2000?\n### SQL query\nSELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 1;\n\n\n### Question\nIn welchen Jahren war Sicherheit ein Thema bei Volksabstimmungen?\n### SQL query\nSELECT jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sicherheit%'\nORDER BY jahr DESC;\n\n\n### Question\nIn welchem Jahren gab es die Volksabstimmungen zum Thema Energie in der Schweiz?\n### SQL query\n",
    "process_time": 6.374754877062514,
    "num_tokens": 1143,
    "hardness": "extra",
    "scores": [
      0.5572060346603394,
      0.6380725502967834
    ],
    "lang": "de"
  },
  {
    "i": 128,
    "question": "Welches Thema hatte die wenigsten Volksabstimmungen in den Jahren 1990 bis 2000?",
    "query": "SELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE' AND anzahl_abstimmungsvorlagen != 0\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema ASC\nLIMIT 1;\n",
    "db_id": "abstimmungsvorlagen_seit_1971",
    "generated_query": "SELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema ASC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Welches Thema hatte die meisten Volksabstimmungen in den Jahren 1990 bis 2000?",
        "query": "SELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 1;\n",
        "score": 0.09227326512336731
      },
      {
        "question": "In welchen Jahren war Sicherheit ein Thema bei Volksabstimmungen?",
        "query": "SELECT jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sicherheit%'\nORDER BY jahr DESC;\n",
        "score": 0.3664094805717468
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.abstimmungsvorlagen_seit_1971 (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tthema TEXT, \n\tanzahl_abstimmungsvorlagen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_pkey PRIMARY KEY (uid), \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in abstimmungsvorlagen_seit_1971 and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 2013, 2017, 2021, 2011\nthema : Landwirtschaft, Energie, Sozialpolitik, Kultur, Religion, Medien, \u00d6ffentliche Finanzen\n*/\n\n/*\nColumn name, Column discription, Example values\nthema, Thema, Aussenpolitik,\u00d6ffentliche Finanzen,Umwelt und Lebensraum\nanzahl_abstimmungsvorlagen, Anzahl Abstimmungsvorlagen, 3\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWelches Thema hatte die meisten Volksabstimmungen in den Jahren 1990 bis 2000?\n### SQL query\nSELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 1;\n\n\n### Question\nIn welchen Jahren war Sicherheit ein Thema bei Volksabstimmungen?\n### SQL query\nSELECT jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sicherheit%'\nORDER BY jahr DESC;\n\n\n### Question\nWelches Thema hatte die wenigsten Volksabstimmungen in den Jahren 1990 bis 2000?\n### SQL query\n",
    "process_time": 8.855230072047561,
    "num_tokens": 1145,
    "hardness": "unknown",
    "scores": [
      0.09227326512336731,
      0.3664094805717468
    ],
    "lang": "de"
  },
  {
    "i": 129,
    "question": "Wann gab es die letzte Volksabstimmungen zum Thema Forschung?",
    "query": "SELECT MAX(jahr) as jahr_letzte_abstimmung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Forschung%';\n",
    "db_id": "abstimmungsvorlagen_seit_1971",
    "generated_query": "SELECT MAX(jahr) as letzte_abstimmung\nFROM abstimmungsvorlagen_seit_1971\nWHERE thema = 'Forschung';",
    "meta_data": [
      {
        "question": "In welchen Jahren war Sicherheit ein Thema bei Volksabstimmungen?",
        "query": "SELECT jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sicherheit%'\nORDER BY jahr DESC;\n",
        "score": 0.42362552881240845
      },
      {
        "question": "In wievielen Jahren gab es Volksabstimmungen zum Thema Aussenpolitik?",
        "query": "SELECT COUNT(jahr) as anzahl_jahre_aussenpolitik\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Aussenpolitik%';\n",
        "score": 0.5837198495864868
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.abstimmungsvorlagen_seit_1971 (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tthema TEXT, \n\tanzahl_abstimmungsvorlagen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_pkey PRIMARY KEY (uid), \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in abstimmungsvorlagen_seit_1971 and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 2013, 2017, 2021, 2011\nthema : Landwirtschaft, Energie, Sozialpolitik, Kultur, Religion, Medien, \u00d6ffentliche Finanzen\n*/\n\n/*\nColumn name, Column discription, Example values\nthema, Thema, Aussenpolitik,\u00d6ffentliche Finanzen,Umwelt und Lebensraum\nanzahl_abstimmungsvorlagen, Anzahl Abstimmungsvorlagen, 3\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nIn welchen Jahren war Sicherheit ein Thema bei Volksabstimmungen?\n### SQL query\nSELECT jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sicherheit%'\nORDER BY jahr DESC;\n\n\n### Question\nWelches Thema hatte die meisten Volksabstimmungen in den Jahren 1990 bis 2000?\n### SQL query\nSELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 1;\n\n\n### Question\nWann gab es die letzte Volksabstimmungen zum Thema Forschung?\n### SQL query\n",
    "process_time": 4.910772603936493,
    "num_tokens": 1140,
    "hardness": "unknown",
    "scores": [
      0.42362552881240845,
      0.5837198495864868
    ],
    "lang": "de"
  },
  {
    "i": 130,
    "question": "Wieviele Abstimmungsvorlagen gab es im Jahr 2000?",
    "query": "SELECT COUNT(*) as anzahl_abstimmungsvorlagen_im_jahr_2000\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE' AND T.jahr = 2000;\n",
    "db_id": "abstimmungsvorlagen_seit_1971",
    "generated_query": "SELECT COUNT(*) as anzahl_abstimmungsvorlagen\nFROM abstimmungsvorlagen_seit_1971\nWHERE jahr = 2000;",
    "meta_data": [
      {
        "question": "Wieviele Abstimmungsvorlagen gab es seit dem Jahr 1971?",
        "query": "SELECT COUNT(*) as anzahl_abstimmungsvorlagen\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE';\n",
        "score": 0.34833621978759766
      },
      {
        "question": "Wieviele Volksabstimmungen wurden 1995 in der Schweiz durchgef\u00fchrt?",
        "query": "SELECT SUM(T.anzahl_abstimmungsvorlagen) AS gesamt_anzahl_abstimmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '1995' \nGROUP BY T.jahr;\n",
        "score": 0.6943191885948181
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.abstimmungsvorlagen_seit_1971 (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tthema TEXT, \n\tanzahl_abstimmungsvorlagen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_pkey PRIMARY KEY (uid), \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in abstimmungsvorlagen_seit_1971 and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 2013, 2017, 2021, 2011\nthema : Landwirtschaft, Energie, Sozialpolitik, Kultur, Religion, Medien, \u00d6ffentliche Finanzen\n*/\n\n/*\nColumn name, Column discription, Example values\nthema, Thema, Aussenpolitik,\u00d6ffentliche Finanzen,Umwelt und Lebensraum\nanzahl_abstimmungsvorlagen, Anzahl Abstimmungsvorlagen, 3\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWieviele Abstimmungsvorlagen gab es seit dem Jahr 1971?\n### SQL query\nSELECT COUNT(*) as anzahl_abstimmungsvorlagen\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE';\n\n\n### Question\nWelches Thema hatte die meisten Volksabstimmungen in den Jahren 1990 bis 2000?\n### SQL query\nSELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 1;\n\n\n### Question\nWieviele Abstimmungsvorlagen gab es im Jahr 2000?\n### SQL query\n",
    "process_time": 2.888922387966886,
    "num_tokens": 1122,
    "hardness": "unknown",
    "scores": [
      0.34833621978759766,
      0.6943191885948181
    ],
    "lang": "de"
  },
  {
    "i": 131,
    "question": "Wieviele Volksabstimmungen gab es vor dem Jahr 2000 zum Thema Energie?",
    "query": "SELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_energie\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Energie%'\nAND jahr < 2000;\n",
    "db_id": "abstimmungsvorlagen_seit_1971",
    "generated_query": "SELECT COUNT(*) AS anzahl_abstimmungen\nFROM abstimmungsvorlagen_seit_1971\nWHERE thema = 'Energie' AND jahr < 2000;",
    "meta_data": [
      {
        "question": "Welches Thema hatte die meisten Volksabstimmungen in den Jahren 1990 bis 2000?",
        "query": "SELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 1;\n",
        "score": 0.5953822731971741
      },
      {
        "question": "Wieviele Volksabstimmungen wurden 1995 in der Schweiz durchgef\u00fchrt?",
        "query": "SELECT SUM(T.anzahl_abstimmungsvorlagen) AS gesamt_anzahl_abstimmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '1995' \nGROUP BY T.jahr;\n",
        "score": 0.6156960725784302
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.abstimmungsvorlagen_seit_1971 (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tthema TEXT, \n\tanzahl_abstimmungsvorlagen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_pkey PRIMARY KEY (uid), \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in abstimmungsvorlagen_seit_1971 and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 2013, 2017, 2021, 2011\nthema : Landwirtschaft, Energie, Sozialpolitik, Kultur, Religion, Medien, \u00d6ffentliche Finanzen\n*/\n\n/*\nColumn name, Column discription, Example values\nthema, Thema, Aussenpolitik,\u00d6ffentliche Finanzen,Umwelt und Lebensraum\nanzahl_abstimmungsvorlagen, Anzahl Abstimmungsvorlagen, 3\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWelches Thema hatte die meisten Volksabstimmungen in den Jahren 1990 bis 2000?\n### SQL query\nSELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 1;\n\n\n### Question\nWieviele Volksabstimmungen wurden 1995 in der Schweiz durchgef\u00fchrt?\n### SQL query\nSELECT SUM(T.anzahl_abstimmungsvorlagen) AS gesamt_anzahl_abstimmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '1995' \nGROUP BY T.jahr;\n\n\n### Question\nWieviele Volksabstimmungen gab es vor dem Jahr 2000 zum Thema Energie?\n### SQL query\n",
    "process_time": 5.293836646946147,
    "num_tokens": 1156,
    "hardness": "unknown",
    "scores": [
      0.5953822731971741,
      0.6156960725784302
    ],
    "lang": "de"
  },
  {
    "i": 132,
    "question": "Wie hat sich das Verh\u00e0ltnis Stellen zu Vollzeit\u00e0quivalenten bei den Schweizer \u00c4rzten \u00fcber die Jahre ver\u00e4ndert?",
    "query": "SELECT T.jahr,\n  AVG(T.anzahl_beschaeftigte) / AVG(T.anzahl_vollzeitaquivalente) AS stellenanzahl_pro_vollzeit_aequivalent\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND LOWER(T.rechtsform) LIKE '%total%'\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n",
    "db_id": "arztpraxen_ambulante_zentren",
    "generated_query": "SELECT jahr,\n  ROUND(SUM(anzahl_beschaeftigte) / SUM(anzahl_vollzeitaquivalente), 2) AS verhaeltnis_stellen_zu_vollzeitaquivalenten\nFROM arztpraxen_ambulante_zentren\nWHERE LOWER(rechtsform) LIKE '%total%'\n  AND LOWER(geschlecht) LIKE '%total%'\n  AND LOWER(altersgruppe) LIKE '%total%'\n  AND spatialunit_uid IN (SELECT spatialunit_uid FROM spatial_unit WHERE country = 'TRUE')\nGROUP BY jahr\nORDER BY jahr;",
    "meta_data": [
      {
        "question": "Welcher Kanton hatte 2021 die wenigsten weiblichen \u00c4rzte und wieviele waren es?",
        "query": "SELECT S.name_de AS kanton,\n  SUM(T.anzahl_beschaeftigte) AS anzahl_aerztinnen\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND T.geschlecht = 'Frauen'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY anzahl_aerztinnen ASC LIMIT 1;\n",
        "score": 0.8963319063186646
      },
      {
        "question": "Welcher Kanton hatte 2017 den gr\u00f6ssten Anteil weiblicher \u00c4rzte in Prozent?",
        "query": "SELECT S.name_de AS kanton,\n  ROUND(100 * SUM(CASE WHEN T.geschlecht = 'Frauen' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.geschlecht) LIKE '%total%' THEN T.anzahl_beschaeftigte ELSE 0 END), 0), 2)\n        AS prozent_weibliche_arzte\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY prozent_weibliche_arzte DESC LIMIT 3;\n",
        "score": 0.9772838354110718
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.arztpraxen_ambulante_zentren (\n\tuid SERIAL NOT NULL, \n\trechtsform TEXT, \n\tgeschlecht TEXT, \n\taltersgruppe TEXT, \n\tjahr INTEGER, \n\tanzahl_beschaeftigte NUMERIC, \n\tanzahl_vollzeitaquivalente NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT arztpraxen_ambulante_zentren_pkey PRIMARY KEY (uid), \n\tCONSTRAINT arztpraxen_ambulante_zentren_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in arztpraxen_ambulante_zentren and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nanzahl_beschaeftigte : 7025.3999999999996362, 9656.9899999999997817, 1789.6900000000000546, 3135.9000000000000909, 2602.4600000000000364\nanzahl_vollzeitaquivalente : 4636.27999999999974534, 1828.59999999999990905, 4402.02999999999974534, 2247.78000000000020009, 2565.57999999999992724\n*/\n\n/*\nColumn name, Column discription, Example values\nrechtsform, Rechtsform der Praxis, Rechtsform - Total,Einzelunternehmen,Andere Rechtsform\ngeschlecht, Geschlecht, Geschlecht - Total,Mann,Frau\naltersgruppe, Altersklasse, Altersklasse - Total,Unter 45 Jahre,45-54 Jahre\nanzahl_beschaeftigte, Anzahl Besch\u00e4ftigte, None\nanzahl_vollzeitaquivalente, Anzahl Vollzeit\u00e4quivalente, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWelcher Kanton hatte 2017 den gr\u00f6ssten Anteil weiblicher \u00c4rzte in Prozent?\n### SQL query\nSELECT S.name_de AS kanton,\n  ROUND(100 * SUM(CASE WHEN T.geschlecht = 'Frauen' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.geschlecht) LIKE '%total%' THEN T.anzahl_beschaeftigte ELSE 0 END), 0), 2)\n        AS prozent_weibliche_arzte\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY prozent_weibliche_arzte DESC LIMIT 3;\n\n\n### Question\nIn welchen f\u00fcnf Kantonen hatte es 2021 den gr\u00f6ssten Prozentsatz an \u00c4rzten in Einzelpraxen, wie gross war der Prozentsatz jeweils?\n### SQL query\nSELECT S.name_de AS kanton,\n  ROUND(100 * SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%total%' THEN anzahl_beschaeftigte ELSE 0 END), 0), 2) as prozent_aerzte_in_einzelpraxen_2021\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY prozent_aerzte_in_einzelpraxen_2021 DESC LIMIT 5;\n\n\n### Question\nWie hat sich das Verh\u00e0ltnis Stellen zu Vollzeit\u00e0quivalenten bei den Schweizer \u00c4rzten \u00fcber die Jahre ver\u00e4ndert?\n### SQL query\n",
    "process_time": 8.925556988921016,
    "num_tokens": 1555,
    "hardness": "unknown",
    "scores": [
      0.8963319063186646,
      0.9772838354110718
    ],
    "lang": "de"
  },
  {
    "i": 133,
    "question": "Welche Rechtsform hatte einen Zuwachs an \u00c4rzten zwischen 2017 und 2021 und wie gross war der Zuwachs?",
    "query": "SELECT T.rechtsform,\n  (SUM(CASE WHEN jahr = 2021 THEN T.anzahl_beschaeftigte ELSE 0 END) -\n   SUM(CASE WHEN jahr = 2017 THEN T.anzahl_beschaeftigte ELSE 0 END)) as zuwachs_aerzte_2017_bis_2021\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\n  AND LOWER(T.rechtsform) NOT LIKE '%total%'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND T.jahr IN (2017, 2021)\nGROUP BY T.rechtsform;\n",
    "db_id": "arztpraxen_ambulante_zentren",
    "generated_query": "SELECT T.rechtsform,\n  SUM(T.anzahl_beschaeftigte) AS zuwachs_aerzte\nFROM arztpraxen_ambulante_zentren AS T\nWHERE T.jahr = 2021\n  AND T.rechtsform IN (\n    SELECT DISTINCT rechtsform\n    FROM arztpraxen_ambulante_zentren\n    WHERE jahr = 2017\n  )\nGROUP BY T.rechtsform\nHAVING SUM(T.anzahl_beschaeftigte) > 0\nORDER BY zuwachs_aerzte DESC;",
    "meta_data": [
      {
        "question": "Welcher Kanton hatte 2017 den gr\u00f6ssten Anteil weiblicher \u00c4rzte in Prozent?",
        "query": "SELECT S.name_de AS kanton,\n  ROUND(100 * SUM(CASE WHEN T.geschlecht = 'Frauen' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.geschlecht) LIKE '%total%' THEN T.anzahl_beschaeftigte ELSE 0 END), 0), 2)\n        AS prozent_weibliche_arzte\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY prozent_weibliche_arzte DESC LIMIT 3;\n",
        "score": 0.6520677804946899
      },
      {
        "question": "In welchen f\u00fcnf Kantonen hatte es 2021 den gr\u00f6ssten Prozentsatz an \u00c4rzten in Einzelpraxen, wie gross war der Prozentsatz jeweils?",
        "query": "SELECT S.name_de AS kanton,\n  ROUND(100 * SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%total%' THEN anzahl_beschaeftigte ELSE 0 END), 0), 2) as prozent_aerzte_in_einzelpraxen_2021\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY prozent_aerzte_in_einzelpraxen_2021 DESC LIMIT 5;\n",
        "score": 0.6725202202796936
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.arztpraxen_ambulante_zentren (\n\tuid SERIAL NOT NULL, \n\trechtsform TEXT, \n\tgeschlecht TEXT, \n\taltersgruppe TEXT, \n\tjahr INTEGER, \n\tanzahl_beschaeftigte NUMERIC, \n\tanzahl_vollzeitaquivalente NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT arztpraxen_ambulante_zentren_pkey PRIMARY KEY (uid), \n\tCONSTRAINT arztpraxen_ambulante_zentren_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in arztpraxen_ambulante_zentren and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nanzahl_beschaeftigte : 7025.3999999999996362, 9656.9899999999997817, 1789.6900000000000546, 3135.9000000000000909, 2602.4600000000000364\nanzahl_vollzeitaquivalente : 4636.27999999999974534, 1828.59999999999990905, 4402.02999999999974534, 2247.78000000000020009, 2565.57999999999992724\n*/\n\n/*\nColumn name, Column discription, Example values\nrechtsform, Rechtsform der Praxis, Rechtsform - Total,Einzelunternehmen,Andere Rechtsform\ngeschlecht, Geschlecht, Geschlecht - Total,Mann,Frau\naltersgruppe, Altersklasse, Altersklasse - Total,Unter 45 Jahre,45-54 Jahre\nanzahl_beschaeftigte, Anzahl Besch\u00e4ftigte, None\nanzahl_vollzeitaquivalente, Anzahl Vollzeit\u00e4quivalente, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nIn welchen f\u00fcnf Kantonen hatte es 2021 den gr\u00f6ssten Prozentsatz an \u00c4rzten in Einzelpraxen, wie gross war der Prozentsatz jeweils?\n### SQL query\nSELECT S.name_de AS kanton,\n  ROUND(100 * SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%total%' THEN anzahl_beschaeftigte ELSE 0 END), 0), 2) as prozent_aerzte_in_einzelpraxen_2021\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY prozent_aerzte_in_einzelpraxen_2021 DESC LIMIT 5;\n\n\n### Question\nWelcher Kanton hatte 2017 den gr\u00f6ssten Anteil weiblicher \u00c4rzte in Prozent?\n### SQL query\nSELECT S.name_de AS kanton,\n  ROUND(100 * SUM(CASE WHEN T.geschlecht = 'Frauen' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.geschlecht) LIKE '%total%' THEN T.anzahl_beschaeftigte ELSE 0 END), 0), 2)\n        AS prozent_weibliche_arzte\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY prozent_weibliche_arzte DESC LIMIT 3;\n\n\n### Question\nWelche Rechtsform hatte einen Zuwachs an \u00c4rzten zwischen 2017 und 2021 und wie gross war der Zuwachs?\n### SQL query\n",
    "process_time": 8.688510298030451,
    "num_tokens": 1553,
    "hardness": "unknown",
    "scores": [
      0.6520677804946899,
      0.6725202202796936
    ],
    "lang": "de"
  },
  {
    "i": 134,
    "question": "Welche drei Kanton hatten 2021 prozentual die meisten jungen \u00c4rzte und \u00c4rztinnen und wieviel Prozent waren es jeweils?",
    "query": "SELECT S.name_de AS kanton,\n  ROUND(100 * SUM(CASE WHEN LOWER(T.altersgruppe) LIKE '%unter%' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.altersgruppe) LIKE '%total%' THEN T.anzahl_beschaeftigte ELSE 0 END), 0), 2)\n        AS prozent_junge_arzte_und_arztinnen\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY prozent_junge_arzte_und_arztinnen DESC LIMIT 3;\n",
    "db_id": "arztpraxen_ambulante_zentren",
    "generated_query": "SELECT S.name_de AS kanton,\n  ROUND(100 * SUM(CASE WHEN LOWER(T.altersgruppe) LIKE '%unter 45%' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.altersgruppe) LIKE '%total%' THEN T.anzahl_beschaeftigte ELSE 0 END), 0), 2) as prozent_junge_aerzte_2021\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY prozent_junge_aerzte_2021 DESC LIMIT 3;",
    "meta_data": [
      {
        "question": "Welcher Kanton hatte 2021 die wenigsten weiblichen \u00c4rzte und wieviele waren es?",
        "query": "SELECT S.name_de AS kanton,\n  SUM(T.anzahl_beschaeftigte) AS anzahl_aerztinnen\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND T.geschlecht = 'Frauen'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY anzahl_aerztinnen ASC LIMIT 1;\n",
        "score": 0.43510061502456665
      },
      {
        "question": "Welcher Kanton hatte 2017 den gr\u00f6ssten Anteil weiblicher \u00c4rzte in Prozent?",
        "query": "SELECT S.name_de AS kanton,\n  ROUND(100 * SUM(CASE WHEN T.geschlecht = 'Frauen' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.geschlecht) LIKE '%total%' THEN T.anzahl_beschaeftigte ELSE 0 END), 0), 2)\n        AS prozent_weibliche_arzte\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY prozent_weibliche_arzte DESC LIMIT 3;\n",
        "score": 0.5471943020820618
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.arztpraxen_ambulante_zentren (\n\tuid SERIAL NOT NULL, \n\trechtsform TEXT, \n\tgeschlecht TEXT, \n\taltersgruppe TEXT, \n\tjahr INTEGER, \n\tanzahl_beschaeftigte NUMERIC, \n\tanzahl_vollzeitaquivalente NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT arztpraxen_ambulante_zentren_pkey PRIMARY KEY (uid), \n\tCONSTRAINT arztpraxen_ambulante_zentren_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in arztpraxen_ambulante_zentren and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nanzahl_beschaeftigte : 7025.3999999999996362, 9656.9899999999997817, 1789.6900000000000546, 3135.9000000000000909, 2602.4600000000000364\nanzahl_vollzeitaquivalente : 4636.27999999999974534, 1828.59999999999990905, 4402.02999999999974534, 2247.78000000000020009, 2565.57999999999992724\n*/\n\n/*\nColumn name, Column discription, Example values\nrechtsform, Rechtsform der Praxis, Rechtsform - Total,Einzelunternehmen,Andere Rechtsform\ngeschlecht, Geschlecht, Geschlecht - Total,Mann,Frau\naltersgruppe, Altersklasse, Altersklasse - Total,Unter 45 Jahre,45-54 Jahre\nanzahl_beschaeftigte, Anzahl Besch\u00e4ftigte, None\nanzahl_vollzeitaquivalente, Anzahl Vollzeit\u00e4quivalente, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nIn welchen f\u00fcnf Kantonen hatte es 2021 den gr\u00f6ssten Prozentsatz an \u00c4rzten in Einzelpraxen, wie gross war der Prozentsatz jeweils?\n### SQL query\nSELECT S.name_de AS kanton,\n  ROUND(100 * SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%total%' THEN anzahl_beschaeftigte ELSE 0 END), 0), 2) as prozent_aerzte_in_einzelpraxen_2021\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY prozent_aerzte_in_einzelpraxen_2021 DESC LIMIT 5;\n\n\n### Question\nWieviel Prozent der \u00c4rtze \u00fcber 65 bevorzugten 2021 Einzelpraxen gegen\u00fcber anderen Rechtsformen?\n### SQL query\nSELECT\n  ROUND(100 * SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%total%' THEN T.anzahl_beschaeftigte ELSE 0 END), 0), 2) as prozentsatz_aerzte_ueber_65_in_einzelpraxen\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.altersgruppe LIKE '%65%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND T.jahr = 2021;\n\n\n### Question\nWelche drei Kanton hatten 2021 prozentual die meisten jungen \u00c4rzte und \u00c4rztinnen und wieviel Prozent waren es jeweils?\n### SQL query\n",
    "process_time": 19.300401079002768,
    "num_tokens": 1546,
    "hardness": "unknown",
    "scores": [
      0.43510061502456665,
      0.5471943020820618
    ],
    "lang": "de"
  },
  {
    "i": 135,
    "question": "In welchen Kantonen stand die Partei SVP 2019 nicht zur Wahl?",
    "query": "SELECT S.name_de AS kanton_ohne_svp_2019\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.partei = 'SVP'\n  AND T.jahr = 2019\n  AND T.parteistarke_in_prozent IS NULL;\n",
    "db_id": "nationalratswahlen",
    "generated_query": "SELECT S.name_de\nFROM spatial_unit AS S\nWHERE S.canton = 'TRUE'\n  AND S.name_de NOT IN (\n    SELECT S.name_de\n    FROM nationalratswahlen AS T\n    JOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\n    WHERE T.jahr = 2019\n      AND T.partei = 'SVP'\n  );",
    "meta_data": [
      {
        "question": "Welche Parteien standen 2019 im Kanton Glarus zur Wahl und welche prozentuale St\u00e4rke hatten sie?",
        "query": "SELECT T.partei, T.parteistarke_in_prozent\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.parteistarke_in_prozent IS NOT NULL\n  AND T.jahr = 2019\n  AND S.canton = 'TRUE' AND S.name_de LIKE '%Glarus%';\n",
        "score": 0.35111114382743835
      },
      {
        "question": "In wievielen Kantonen waren die Parteien 2019 jeweils aktiv und bei welcher Parteist\u00e4rke schweizweit?",
        "query": "SELECT T.partei,\n  COUNT(CASE WHEN T.parteistarke_in_prozent IS NOT NULL AND S.canton = 'TRUE' THEN 1 ELSE NULL END) AS anzahl_kantone_wo_partei_aktiv_ist,\n  MAX(CASE WHEN S.country = 'TRUE' THEN T.parteistarke_in_prozent ELSE NULL END) AS parteistarke_schweiz\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2019\n  AND S.canton = 'TRUE' OR S.country = 'TRUE'\nGROUP BY T.partei\nORDER BY anzahl_kantone_wo_partei_aktiv_ist DESC;\n",
        "score": 0.42548519372940063
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.nationalratswahlen (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tpartei TEXT, \n\tanzahl_parteistimmen NUMERIC, \n\tanzahl_fiktive_wahlende NUMERIC, \n\tparteistarke_in_prozent NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT nationalratswahlen_pkey PRIMARY KEY (uid), \n\tCONSTRAINT nationalratswahlen_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in nationalratswahlen and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\npartei : Sol., Sep., SD, POCH, \u00dcbrige\nanzahl_fiktive_wahlende : 368951, 44667, 97855, 7709, 13215\nparteistarke_in_prozent : 0.510000000000000009, 2.459999999999999964, 0.419999999999999984, 21.789999999999999147, 1.929999999999999938\n*/\n\n/*\nColumn name, Column discription, Example values\npartei, Partei, FDP,CVP,SP,Sep.,\u00dcbrige\nanzahl_parteistimmen, Anzahl Parteistimmen, None\nanzahl_fiktive_wahlende, Anzahl fiktive W\u00e4hlende, None\nparteistarke_in_prozent, Parteist\u00e4rke in Prozent, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWelche Parteien standen 2019 im Kanton Glarus zur Wahl und welche prozentuale St\u00e4rke hatten sie?\n### SQL query\nSELECT T.partei, T.parteistarke_in_prozent\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.parteistarke_in_prozent IS NOT NULL\n  AND T.jahr = 2019\n  AND S.canton = 'TRUE' AND S.name_de LIKE '%Glarus%';\n\n\n### Question\nZeige das Verh\u00e4ltnis Parteistimmen zu fiktiven W\u00e4hlenden f\u00fcr alle Kantone, Stand 2019. Sortiere nach der Gr\u00f6sse des Faktors.\n### SQL query\nSELECT SUM(T.anzahl_parteistimmen) / SUM(T.anzahl_fiktive_wahlende) AS faktor_nationalratswahlen, S.name_de\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2019\n  AND S.canton = 'TRUE'\nGROUP BY S.name_de\nORDER BY faktor_nationalratswahlen DESC;\n\n\n### Question\nIn welchen Kantonen stand die Partei SVP 2019 nicht zur Wahl?\n### SQL query\n",
    "process_time": 6.666907756123692,
    "num_tokens": 1236,
    "hardness": "unknown",
    "scores": [
      0.35111114382743835,
      0.42548519372940063
    ],
    "lang": "de"
  },
  {
    "i": 136,
    "question": "Welche Partei war 2019 prozentual am st\u00e0rksten in der Schweiz und wie stark war sie?",
    "query": "SELECT T.partei AS staerkste_partei_2019, T.parteistarke_in_prozent\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.parteistarke_in_prozent IS NOT NULL AND T.jahr = 2019\nORDER BY T.parteistarke_in_prozent DESC LIMIT 1;\n",
    "db_id": "nationalratswahlen",
    "generated_query": "SELECT T.partei, T.parteistarke_in_prozent\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.parteistarke_in_prozent IS NOT NULL\n  AND T.jahr = 2019\n  AND S.country = 'TRUE'\nORDER BY T.parteistarke_in_prozent DESC LIMIT 1;",
    "meta_data": [
      {
        "question": "In welchem Kanton war die FDP 2019 prozentual am st\u00e0rksten und wie stark war sie dort?",
        "query": "SELECT S.name_de as kanton, T.parteistarke_in_prozent AS parteistaerke_fdp_2019\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND partei = 'FDP'\nAND T.parteistarke_in_prozent IS NOT NULL AND T.jahr = 2019\nORDER BY parteistaerke_fdp_2019 DESC LIMIT 1;\n",
        "score": 0.4523704946041107
      },
      {
        "question": "Welche Parteien standen 2019 im Kanton Glarus zur Wahl und welche prozentuale St\u00e4rke hatten sie?",
        "query": "SELECT T.partei, T.parteistarke_in_prozent\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.parteistarke_in_prozent IS NOT NULL\n  AND T.jahr = 2019\n  AND S.canton = 'TRUE' AND S.name_de LIKE '%Glarus%';\n",
        "score": 0.5263969898223877
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.nationalratswahlen (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tpartei TEXT, \n\tanzahl_parteistimmen NUMERIC, \n\tanzahl_fiktive_wahlende NUMERIC, \n\tparteistarke_in_prozent NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT nationalratswahlen_pkey PRIMARY KEY (uid), \n\tCONSTRAINT nationalratswahlen_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in nationalratswahlen and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\npartei : Sol., Sep., SD, POCH, \u00dcbrige\nanzahl_fiktive_wahlende : 368951, 44667, 97855, 7709, 13215\nparteistarke_in_prozent : 0.510000000000000009, 2.459999999999999964, 0.419999999999999984, 21.789999999999999147, 1.929999999999999938\n*/\n\n/*\nColumn name, Column discription, Example values\npartei, Partei, FDP,CVP,SP,Sep.,\u00dcbrige\nanzahl_parteistimmen, Anzahl Parteistimmen, None\nanzahl_fiktive_wahlende, Anzahl fiktive W\u00e4hlende, None\nparteistarke_in_prozent, Parteist\u00e4rke in Prozent, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWelche Parteien standen 2019 im Kanton Glarus zur Wahl und welche prozentuale St\u00e4rke hatten sie?\n### SQL query\nSELECT T.partei, T.parteistarke_in_prozent\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.parteistarke_in_prozent IS NOT NULL\n  AND T.jahr = 2019\n  AND S.canton = 'TRUE' AND S.name_de LIKE '%Glarus%';\n\n\n### Question\nIn welchem Kanton war die FDP 2019 prozentual am st\u00e0rksten und wie stark war sie dort?\n### SQL query\nSELECT S.name_de as kanton, T.parteistarke_in_prozent AS parteistaerke_fdp_2019\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND partei = 'FDP'\nAND T.parteistarke_in_prozent IS NOT NULL AND T.jahr = 2019\nORDER BY parteistaerke_fdp_2019 DESC LIMIT 1;\n\n\n### Question\nWelche Partei war 2019 prozentual am st\u00e0rksten in der Schweiz und wie stark war sie?\n### SQL query\n",
    "process_time": 7.036155852954835,
    "num_tokens": 1237,
    "hardness": "unknown",
    "scores": [
      0.4523704946041107,
      0.5263969898223877
    ],
    "lang": "de"
  },
  {
    "i": 137,
    "question": "Wann und in welchen Kantonen stand die Partei LEGA zur Wahl und welche Parteist\u00e4rke hatte sie?",
    "query": "SELECT S.name_de AS kanton, T.jahr, T.parteistarke_in_prozent AS parteienstaerke_Lega\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.partei = 'Lega'\n  AND T.parteistarke_in_prozent IS NOT NULL\nGROUP BY kanton, T.jahr, T.partei, T.parteistarke_in_prozent\nORDER BY jahr ASC;\n",
    "db_id": "nationalratswahlen",
    "generated_query": "SELECT T.jahr, S.name_de, T.parteistarke_in_prozent\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.partei = 'LEGA'\n  AND T.parteistarke_in_prozent IS NOT NULL\n  AND S.canton = 'TRUE';",
    "meta_data": [
      {
        "question": "Welche Parteien standen 2019 im Kanton Glarus zur Wahl und welche prozentuale St\u00e4rke hatten sie?",
        "query": "SELECT T.partei, T.parteistarke_in_prozent\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.parteistarke_in_prozent IS NOT NULL\n  AND T.jahr = 2019\n  AND S.canton = 'TRUE' AND S.name_de LIKE '%Glarus%';\n",
        "score": 0.5815602540969849
      },
      {
        "question": "In wievielen Kantonen waren die Parteien 2019 jeweils aktiv und bei welcher Parteist\u00e4rke schweizweit?",
        "query": "SELECT T.partei,\n  COUNT(CASE WHEN T.parteistarke_in_prozent IS NOT NULL AND S.canton = 'TRUE' THEN 1 ELSE NULL END) AS anzahl_kantone_wo_partei_aktiv_ist,\n  MAX(CASE WHEN S.country = 'TRUE' THEN T.parteistarke_in_prozent ELSE NULL END) AS parteistarke_schweiz\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2019\n  AND S.canton = 'TRUE' OR S.country = 'TRUE'\nGROUP BY T.partei\nORDER BY anzahl_kantone_wo_partei_aktiv_ist DESC;\n",
        "score": 0.6414398550987244
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.nationalratswahlen (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tpartei TEXT, \n\tanzahl_parteistimmen NUMERIC, \n\tanzahl_fiktive_wahlende NUMERIC, \n\tparteistarke_in_prozent NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT nationalratswahlen_pkey PRIMARY KEY (uid), \n\tCONSTRAINT nationalratswahlen_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in nationalratswahlen and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\npartei : Sol., Sep., SD, POCH, \u00dcbrige\nanzahl_fiktive_wahlende : 368951, 44667, 97855, 7709, 13215\nparteistarke_in_prozent : 0.510000000000000009, 2.459999999999999964, 0.419999999999999984, 21.789999999999999147, 1.929999999999999938\n*/\n\n/*\nColumn name, Column discription, Example values\npartei, Partei, FDP,CVP,SP,Sep.,\u00dcbrige\nanzahl_parteistimmen, Anzahl Parteistimmen, None\nanzahl_fiktive_wahlende, Anzahl fiktive W\u00e4hlende, None\nparteistarke_in_prozent, Parteist\u00e4rke in Prozent, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWelche Parteien standen 2019 im Kanton Glarus zur Wahl und welche prozentuale St\u00e4rke hatten sie?\n### SQL query\nSELECT T.partei, T.parteistarke_in_prozent\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.parteistarke_in_prozent IS NOT NULL\n  AND T.jahr = 2019\n  AND S.canton = 'TRUE' AND S.name_de LIKE '%Glarus%';\n\n\n### Question\nIn wievielen Kantonen waren die Parteien 2019 jeweils aktiv und bei welcher Parteist\u00e4rke schweizweit?\n### SQL query\nSELECT T.partei,\n  COUNT(CASE WHEN T.parteistarke_in_prozent IS NOT NULL AND S.canton = 'TRUE' THEN 1 ELSE NULL END) AS anzahl_kantone_wo_partei_aktiv_ist,\n  MAX(CASE WHEN S.country = 'TRUE' THEN T.parteistarke_in_prozent ELSE NULL END) AS parteistarke_schweiz\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2019\n  AND S.canton = 'TRUE' OR S.country = 'TRUE'\nGROUP BY T.partei\nORDER BY anzahl_kantone_wo_partei_aktiv_ist DESC;\n\n\n### Question\nWann und in welchen Kantonen stand die Partei LEGA zur Wahl und welche Parteist\u00e4rke hatte sie?\n### SQL query\n",
    "process_time": 6.077657344052568,
    "num_tokens": 1296,
    "hardness": "unknown",
    "scores": [
      0.5815602540969849,
      0.6414398550987244
    ],
    "lang": "de"
  },
  {
    "i": 138,
    "question": "Welches sind die verschiedenen Stromverbrauchskategorien in der Schweiz?",
    "query": "SELECT DISTINCT verbrauchskategorie, verbrauchskategorie_beschreibung\nFROM median_strompreis_per_kanton ORDER BY verbrauchskategorie;\n",
    "db_id": "median_strompreis_per_kanton",
    "generated_query": "SELECT DISTINCT(verbrauchskategorie)\nFROM median_strompreis_per_kanton;",
    "meta_data": [
      {
        "question": "Wie hoch waren die Preise f\u00fcr das g\u00fcnstigste verf\u00fcgbare Stromprodukt f\u00fcr alle Unternehmenskategorien im Kanton Genf im Jahr 2012?",
        "query": "SELECT T.verbrauchskategorie, MIN(T.mittlerer_preis_rappen_pro_kwh)\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Genf%'\n    AND S.canton = 'TRUE'\n    AND T.jahr = 2012\n    AND T.verbrauchskategorie LIKE '%C_%'\nGROUP BY T.verbrauchskategorie, T.jahr, T.mittlerer_preis_rappen_pro_kwh\nORDER BY T.mittlerer_preis_rappen_pro_kwh ASC;\n",
        "score": 1.0788929462432861
      },
      {
        "question": "In welchen Kantonen liegen die Strompreise f\u00fcr die Kategorie der Grossverbraucher im Jahr 2022 unter 13 Rappen pro Kilowattstunde?",
        "query": "SELECT DISTINCT(S.name)\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr = 2022\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr = (SELECT MAX(verbrauchskategorie_grosse_kwh_pro_jahr) FROM median_strompreis_per_kanton)\n    AND T.mittlerer_preis_rappen_pro_kwh < 13;\n",
        "score": 1.2010316848754883
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.median_strompreis_per_kanton (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tverbrauchskategorie TEXT, \n\tverbrauchskategorie_grosse_kwh_pro_jahr NUMERIC, \n\tverbrauchskategorie_beschreibung TEXT, \n\tenergieprodukt TEXT, \n\tmittlerer_preis_rappen_pro_kwh NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT median_strompreis_per_kanton_pkey PRIMARY KEY (uid), \n\tCONSTRAINT median_strompreis_per_kanton_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in median_strompreis_per_kanton and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nmittlerer_preis_rappen_pro_kwh : 17.9734380000000016, 15.6502029999999994, 17.4508079999999985, 17.3792059999999999, 18.2130469999999995\nspatialunit_uid : 1_A.ADM1, 24_A.ADM1, 23_A.ADM1, 8_A.ADM1, 22_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\nverbrauchskategorie, Verbrauchskategorie, C5,H4,H2\nverbrauchskategorie_beschreibung, Verbrauchskategorie Beschreibung, 4'500 kWh/Jahr: 5-Zimmerwohnung mit Elektroherd und Tumbler (ohne Elektroboiler),7'500 kWh/Jahr: 5-Zimmer-Einfamilienhaus mit Elektroherd' Elektroboiler und Tumbler\nverbrauchskategorie_grosse_kwh_pro_jahr, Verbrauchskategorie Gr\u00f6sse (kwh/jahr), 500000,4500,2500\nenergieprodukt, Energieprodukt, G\u00fcnstigstes Produkt,Standardprodukt\nmittlerer_preis_rappen_pro_kw_hr, Mittlerer Preis in Rappen pro kwh, 17.95067,18.49410,17.25452\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nIn welchen Kantonen liegen die Strompreise f\u00fcr die Kategorie der Grossverbraucher im Jahr 2022 unter 13 Rappen pro Kilowattstunde?\n### SQL query\nSELECT DISTINCT(S.name)\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr = 2022\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr = (SELECT MAX(verbrauchskategorie_grosse_kwh_pro_jahr) FROM median_strompreis_per_kanton)\n    AND T.mittlerer_preis_rappen_pro_kwh < 13;\n\n\n### Question\nWie hoch waren die Preise f\u00fcr das g\u00fcnstigste verf\u00fcgbare Stromprodukt f\u00fcr alle Unternehmenskategorien im Kanton Genf im Jahr 2012?\n### SQL query\nSELECT T.verbrauchskategorie, MIN(T.mittlerer_preis_rappen_pro_kwh)\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Genf%'\n    AND S.canton = 'TRUE'\n    AND T.jahr = 2012\n    AND T.verbrauchskategorie LIKE '%C_%'\nGROUP BY T.verbrauchskategorie, T.jahr, T.mittlerer_preis_rappen_pro_kwh\nORDER BY T.mittlerer_preis_rappen_pro_kwh ASC;\n\n\n### Question\nWelches sind die verschiedenen Stromverbrauchskategorien in der Schweiz?\n### SQL query\n",
    "process_time": 2.0021321228705347,
    "num_tokens": 1454,
    "hardness": "medium",
    "scores": [
      1.0788929462432861,
      1.2010316848754883
    ],
    "lang": "de"
  },
  {
    "i": 139,
    "question": "Wie haben sich die Standardstrompreise f\u00fcr kleine Unternehmen im Kanton Neuenburg zwischen 2017 und 2023 entwickelt?",
    "query": "SELECT T.jahr, T.energieprodukt, T.verbrauchskategorie, T.mittlerer_preis_rappen_pro_kwh\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Neuenburg%'\n    AND S.canton = 'TRUE'\n    AND T.jahr >= 2017\n    AND T.jahr <= 2023\n    AND T.energieprodukt = 'Standardprodukt'\n    AND T.verbrauchskategorie_beschreibung LIKE '%Kleinbetrieb%'\nORDER BY T.jahr;\n",
    "db_id": "median_strompreis_per_kanton",
    "generated_query": "SELECT T.jahr, T.mittlerer_preis_rappen_pro_kwh\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Neuenburg'\n    AND T.verbrauchskategorie = 'C1'\n    AND T.energieprodukt = 'Standardprodukt'\n    AND T.jahr BETWEEN 2017 AND 2023\nORDER BY T.jahr;",
    "meta_data": [
      {
        "question": "In welchen Kantonen liegen die Strompreise f\u00fcr die Kategorie der Grossverbraucher im Jahr 2022 unter 13 Rappen pro Kilowattstunde?",
        "query": "SELECT DISTINCT(S.name)\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr = 2022\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr = (SELECT MAX(verbrauchskategorie_grosse_kwh_pro_jahr) FROM median_strompreis_per_kanton)\n    AND T.mittlerer_preis_rappen_pro_kwh < 13;\n",
        "score": 0.7681364417076111
      },
      {
        "question": "Welches ist der Kanton mit dem h\u00f6chsten Preis f\u00fcr 1000 kWh im Jahr 2021 f\u00fcr das Standardstromprodukt der Kategorie C3?",
        "query": "SELECT S.name_de as kanton, T.jahr, T.verbrauchskategorie, T.energieprodukt\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr = 2021\n    AND T.energieprodukt = 'Standardprodukt'\n    AND T.verbrauchskategorie = 'C3'\nGROUP BY S.name_de, T.jahr, T.verbrauchskategorie, T.energieprodukt, T.mittlerer_preis_rappen_pro_kwh\nORDER BY T.mittlerer_preis_rappen_pro_kwh DESC LIMIT 1;\n",
        "score": 0.8080166578292847
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.median_strompreis_per_kanton (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tverbrauchskategorie TEXT, \n\tverbrauchskategorie_grosse_kwh_pro_jahr NUMERIC, \n\tverbrauchskategorie_beschreibung TEXT, \n\tenergieprodukt TEXT, \n\tmittlerer_preis_rappen_pro_kwh NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT median_strompreis_per_kanton_pkey PRIMARY KEY (uid), \n\tCONSTRAINT median_strompreis_per_kanton_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in median_strompreis_per_kanton and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nmittlerer_preis_rappen_pro_kwh : 17.9734380000000016, 15.6502029999999994, 17.4508079999999985, 17.3792059999999999, 18.2130469999999995\nspatialunit_uid : 1_A.ADM1, 24_A.ADM1, 23_A.ADM1, 8_A.ADM1, 22_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\nverbrauchskategorie, Verbrauchskategorie, C5,H4,H2\nverbrauchskategorie_beschreibung, Verbrauchskategorie Beschreibung, 4'500 kWh/Jahr: 5-Zimmerwohnung mit Elektroherd und Tumbler (ohne Elektroboiler),7'500 kWh/Jahr: 5-Zimmer-Einfamilienhaus mit Elektroherd' Elektroboiler und Tumbler\nverbrauchskategorie_grosse_kwh_pro_jahr, Verbrauchskategorie Gr\u00f6sse (kwh/jahr), 500000,4500,2500\nenergieprodukt, Energieprodukt, G\u00fcnstigstes Produkt,Standardprodukt\nmittlerer_preis_rappen_pro_kw_hr, Mittlerer Preis in Rappen pro kwh, 17.95067,18.49410,17.25452\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nIn welchen Kantonen liegen die Strompreise f\u00fcr die Kategorie der Grossverbraucher im Jahr 2022 unter 13 Rappen pro Kilowattstunde?\n### SQL query\nSELECT DISTINCT(S.name)\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr = 2022\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr = (SELECT MAX(verbrauchskategorie_grosse_kwh_pro_jahr) FROM median_strompreis_per_kanton)\n    AND T.mittlerer_preis_rappen_pro_kwh < 13;\n\n\n### Question\nWelches ist der Kanton mit dem h\u00f6chsten Preis f\u00fcr 1000 kWh im Jahr 2021 f\u00fcr das Standardstromprodukt der Kategorie C3?\n### SQL query\nSELECT S.name_de as kanton, T.jahr, T.verbrauchskategorie, T.energieprodukt\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr = 2021\n    AND T.energieprodukt = 'Standardprodukt'\n    AND T.verbrauchskategorie = 'C3'\nGROUP BY S.name_de, T.jahr, T.verbrauchskategorie, T.energieprodukt, T.mittlerer_preis_rappen_pro_kwh\nORDER BY T.mittlerer_preis_rappen_pro_kwh DESC LIMIT 1;\n\n\n### Question\nWie haben sich die Standardstrompreise f\u00fcr kleine Unternehmen im Kanton Neuenburg zwischen 2017 und 2023 entwickelt?\n### SQL query\n",
    "process_time": 10.776469117961824,
    "num_tokens": 1483,
    "hardness": "extra",
    "scores": [
      0.7681364417076111,
      0.8080166578292847
    ],
    "lang": "de"
  },
  {
    "i": 140,
    "question": "Wie viel zahle ich in CHF f\u00fcr 1000 kWh bei einer 2-Zimmer-Wohnung im Kanton Bern im Jahr 2017?",
    "query": "SELECT T.verbrauchskategorie, T.verbrauchskategorie_beschreibung,\nT.energieprodukt,\nT.mittlerer_preis_rappen_pro_kwh * 1000 / 100 as preis_franken_fur_1000_kwh_bern_2017_2_zimmerwohnung\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Bern%'\n    AND S.canton = 'TRUE'\n    AND T.jahr = 2017\n    AND T.verbrauchskategorie_beschreibung LIKE '%2 - Zimmerwohnung%'\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr >= 1000;\n",
    "db_id": "median_strompreis_per_kanton",
    "generated_query": "SELECT T.mittlerer_preis_rappen_pro_kwh * 1000 / 100 as preis_franken_fur_1000_kwh_bern_2017_2_zimmerwohnung\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Bern%'\n    AND S.canton = 'TRUE'\n    AND T.jahr = 2017\n    AND T.verbrauchskategorie_beschreibung LIKE '%2-Zimmerwohnung%';",
    "meta_data": [
      {
        "question": "Wie viel zahle ich in CHF f\u00fcr 1000 kWh bei einer 2-Zimmer-Wohnung im Kanton Bern im Jahr 2017?",
        "query": "SELECT T.verbrauchskategorie, T.verbrauchskategorie_beschreibung,\nT.energieprodukt,\nT.mittlerer_preis_rappen_pro_kwh * 1000 / 100 as preis_franken_fur_1000_kwh_bern_2017_2_zimmerwohnung\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Bern%'\n    AND S.canton = 'TRUE'\n    AND T.jahr = 2017\n    AND T.verbrauchskategorie_beschreibung LIKE '%2 - Zimmerwohnung%'\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr >= 1000;\n",
        "score": 3.347954780161949e-13
      },
      {
        "question": "Welches ist der Kanton mit dem h\u00f6chsten Preis f\u00fcr 1000 kWh im Jahr 2021 f\u00fcr das Standardstromprodukt der Kategorie C3?",
        "query": "SELECT S.name_de as kanton, T.jahr, T.verbrauchskategorie, T.energieprodukt\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr = 2021\n    AND T.energieprodukt = 'Standardprodukt'\n    AND T.verbrauchskategorie = 'C3'\nGROUP BY S.name_de, T.jahr, T.verbrauchskategorie, T.energieprodukt, T.mittlerer_preis_rappen_pro_kwh\nORDER BY T.mittlerer_preis_rappen_pro_kwh DESC LIMIT 1;\n",
        "score": 0.7078014016151428
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.median_strompreis_per_kanton (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tverbrauchskategorie TEXT, \n\tverbrauchskategorie_grosse_kwh_pro_jahr NUMERIC, \n\tverbrauchskategorie_beschreibung TEXT, \n\tenergieprodukt TEXT, \n\tmittlerer_preis_rappen_pro_kwh NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT median_strompreis_per_kanton_pkey PRIMARY KEY (uid), \n\tCONSTRAINT median_strompreis_per_kanton_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in median_strompreis_per_kanton and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\nmittlerer_preis_rappen_pro_kwh : 17.9734380000000016, 15.6502029999999994, 17.4508079999999985, 17.3792059999999999, 18.2130469999999995\nspatialunit_uid : 1_A.ADM1, 24_A.ADM1, 23_A.ADM1, 8_A.ADM1, 22_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\nverbrauchskategorie, Verbrauchskategorie, C5,H4,H2\nverbrauchskategorie_beschreibung, Verbrauchskategorie Beschreibung, 4'500 kWh/Jahr: 5-Zimmerwohnung mit Elektroherd und Tumbler (ohne Elektroboiler),7'500 kWh/Jahr: 5-Zimmer-Einfamilienhaus mit Elektroherd' Elektroboiler und Tumbler\nverbrauchskategorie_grosse_kwh_pro_jahr, Verbrauchskategorie Gr\u00f6sse (kwh/jahr), 500000,4500,2500\nenergieprodukt, Energieprodukt, G\u00fcnstigstes Produkt,Standardprodukt\nmittlerer_preis_rappen_pro_kw_hr, Mittlerer Preis in Rappen pro kwh, 17.95067,18.49410,17.25452\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\n### Question\nWie viel zahle ich in CHF f\u00fcr 1000 kWh bei einer 2-Zimmer-Wohnung im Kanton Bern im Jahr 2017?\n### SQL query\nSELECT T.verbrauchskategorie, T.verbrauchskategorie_beschreibung,\nT.energieprodukt,\nT.mittlerer_preis_rappen_pro_kwh * 1000 / 100 as preis_franken_fur_1000_kwh_bern_2017_2_zimmerwohnung\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Bern%'\n    AND S.canton = 'TRUE'\n    AND T.jahr = 2017\n    AND T.verbrauchskategorie_beschreibung LIKE '%2 - Zimmerwohnung%'\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr >= 1000;\n\n\n### Question\nWelches ist der Kanton mit dem h\u00f6chsten Preis f\u00fcr 1000 kWh im Jahr 2021 f\u00fcr das Standardstromprodukt der Kategorie C3?\n### SQL query\nSELECT S.name_de as kanton, T.jahr, T.verbrauchskategorie, T.energieprodukt\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr = 2021\n    AND T.energieprodukt = 'Standardprodukt'\n    AND T.verbrauchskategorie = 'C3'\nGROUP BY S.name_de, T.jahr, T.verbrauchskategorie, T.energieprodukt, T.mittlerer_preis_rappen_pro_kwh\nORDER BY T.mittlerer_preis_rappen_pro_kwh DESC LIMIT 1;\n\n\n### Question\nWie viel zahle ich in CHF f\u00fcr 1000 kWh bei einer 2-Zimmer-Wohnung im Kanton Bern im Jahr 2017?\n### SQL query\n",
    "process_time": 13.216997388983145,
    "num_tokens": 1537,
    "hardness": "unknown",
    "scores": [
      3.347954780161949e-13,
      0.7078014016151428
    ],
    "lang": "de"
  },
  {
    "i": 141,
    "question": "Wie hoch ist der Anteil des Schweizer Budgets, der 2010 und 2020 f\u00fcr die Gesundheit ausgegeben wird?",
    "query": "SELECT jahr, SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_gesundheitswesen\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE aufgabenbereich_cofog_grobgliederung = 'Gesundheitswesen'\n    AND institutioneller_sektor = 'Staat'\n    AND jahr <= 2020\n    AND jahr >= 2010\nGROUP BY jahr\nORDER BY jahr ASC;\n",
    "db_id": "staatsausgaben_nach_aufgabenbereichen_cofog",
    "generated_query": "SELECT jahr, SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_gesundheit\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%gesundheit%'\n    AND institutioneller_sektor = 'Staat'\n    AND jahr IN (2010, 2020)\nGROUP BY jahr\nORDER BY jahr ASC;",
    "meta_data": [
      {
        "question": "Wie viel Prozent des Staat Budgets gab im Jahr 2021 fur Bildung aus?",
        "query": "SELECT SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_bildung\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE institutioneller_sektor = 'Staat'\n    AND jahr = 2021\n    AND aufgabenbereich_cofog_grobgliederung = 'Bildungswesen';\n",
        "score": 0.5779492259025574
      },
      {
        "question": "Wie hoch war der Anteil des Gemeinde Budgets, der seit 2011 f\u00fcr Kommunikation bereitgestellt wurde?",
        "query": "SELECT jahr, SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_kommunikation_in_landgemeinden\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%kommunikation%'\n    AND institutioneller_sektor = 'Gemeinden'\n    AND jahr >= 2011\nGROUP BY jahr\nORDER BY jahr ASC;\n",
        "score": 0.6475260257720947
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.staatsausgaben_nach_aufgabenbereichen_cofog (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\taufgabenbereich_cofog_feingliederung TEXT, \n\taufgabenbereich_cofog_grobgliederung TEXT, \n\tinstitutioneller_sektor TEXT, \n\tausgaben_in_mio_chf NUMERIC, \n\tprozent_der_gesamtausgaben NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT staatsausgaben_nach_aufgabenbereichen_cofog_pkey PRIMARY KEY (uid), \n\tCONSTRAINT staatsausgaben_nach_aufgabenbereichen_cofo_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in staatsausgaben_nach_aufgabenbereichen_cofog and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 2006, 2002, 2005, 2017\nausgaben_in_mio_chf : 8656, 6725, 78, 7449, 10181\nprozent_der_gesamtausgaben : 3.50000000000000000, 6.70000000000000018, 6.09999999999999964, 0.29999999999999999, 8.69999999999999929\n*/\n\n/*\nColumn name, Column discription, Example values\naufgabenbereich_cofog_feingliederung, Aufgabenbereich des Staates (COFOG Feingliederung), Alter,Wasserversorgung,Polizei\naufgabenbereich_cofog_grobgliederung, Aufgabenbereich des Staates (COFOG Grobgliederung), Umweltschutz,Bildungswesen,Freizeitgestaltung, Sport, Kultur und Religion\ninstitutioneller_sektor, institutioneller Sektor, Staat,Kantone,Bund,Gemeinden,\u00d6ffentliche Sozialversicherungen\nausgaben_in_mio_chf, Ausgaben in Millionen CHF, None\nprozent_der_gesamtausgaben, Prozent der Gesamtaugaben, None\n*/\n\n\n\n### Question\nWie viel Prozent des Staat Budgets gab im Jahr 2021 fur Bildung aus?\n### SQL query\nSELECT SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_bildung\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE institutioneller_sektor = 'Staat'\n    AND jahr = 2021\n    AND aufgabenbereich_cofog_grobgliederung = 'Bildungswesen';\n\n\n### Question\nWie hoch war der Anteil des Gemeinde Budgets, der seit 2011 f\u00fcr Kommunikation bereitgestellt wurde?\n### SQL query\nSELECT jahr, SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_kommunikation_in_landgemeinden\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%kommunikation%'\n    AND institutioneller_sektor = 'Gemeinden'\n    AND jahr >= 2011\nGROUP BY jahr\nORDER BY jahr ASC;\n\n\n### Question\nWie hoch ist der Anteil des Schweizer Budgets, der 2010 und 2020 f\u00fcr die Gesundheit ausgegeben wird?\n### SQL query\n",
    "process_time": 6.501919359900057,
    "num_tokens": 1396,
    "hardness": "unknown",
    "scores": [
      0.5779492259025574,
      0.6475260257720947
    ],
    "lang": "de"
  },
  {
    "i": 142,
    "question": "Welches waren die 3 gr\u00f6ssten Ausgabenquellen des Bundes im Jahr 2021 und wie hoch waren diese?",
    "query": "SELECT SUM(ausgaben_in_mio_chf) as ausgaben_in_mio_chf,\n  aufgabenbereich_cofog_feingliederung as ausgaben_bereich_mit_den_hoechsten_ausgaben_2020\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE institutioneller_sektor = 'Bund' AND jahr = 2020\nGROUP BY aufgabenbereich_cofog_feingliederung\nORDER BY SUM(ausgaben_in_mio_chf) DESC LIMIT 3;\n",
    "db_id": "staatsausgaben_nach_aufgabenbereichen_cofog",
    "generated_query": "SELECT aufgabenbereich_cofog_feingliederung, ausgaben_in_mio_chf as bundes_ausgaben_in_mio_chf_jahr_2021\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE institutioneller_sektor = 'Bund'\n    AND jahr = 2021\nORDER BY ausgaben_in_mio_chf DESC\nLIMIT 3;",
    "meta_data": [
      {
        "question": "Wie viel Prozent des Staat Budgets gab im Jahr 2021 fur Bildung aus?",
        "query": "SELECT SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_bildung\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE institutioneller_sektor = 'Staat'\n    AND jahr = 2021\n    AND aufgabenbereich_cofog_grobgliederung = 'Bildungswesen';\n",
        "score": 0.7783884406089783
      },
      {
        "question": "Welche Teilung hatte im Jahr 2020 die h\u00f6chsten Staatsausgaben?",
        "query": "SELECT aufgabenbereich_cofog_grobgliederung as ausgaben_bereich_mit_den_hoechsten_ausgaben_2020\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE institutioneller_sektor = 'Staat' AND jahr = 2020\nGROUP BY aufgabenbereich_cofog_grobgliederung\nORDER BY SUM(ausgaben_in_mio_chf) DESC LIMIT 1;\n",
        "score": 0.8883976340293884
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.staatsausgaben_nach_aufgabenbereichen_cofog (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\taufgabenbereich_cofog_feingliederung TEXT, \n\taufgabenbereich_cofog_grobgliederung TEXT, \n\tinstitutioneller_sektor TEXT, \n\tausgaben_in_mio_chf NUMERIC, \n\tprozent_der_gesamtausgaben NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT staatsausgaben_nach_aufgabenbereichen_cofog_pkey PRIMARY KEY (uid), \n\tCONSTRAINT staatsausgaben_nach_aufgabenbereichen_cofo_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in staatsausgaben_nach_aufgabenbereichen_cofog and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 2006, 2002, 2005, 2017\nausgaben_in_mio_chf : 8656, 6725, 78, 7449, 10181\nprozent_der_gesamtausgaben : 3.50000000000000000, 6.70000000000000018, 6.09999999999999964, 0.29999999999999999, 8.69999999999999929\n*/\n\n/*\nColumn name, Column discription, Example values\naufgabenbereich_cofog_feingliederung, Aufgabenbereich des Staates (COFOG Feingliederung), Alter,Wasserversorgung,Polizei\naufgabenbereich_cofog_grobgliederung, Aufgabenbereich des Staates (COFOG Grobgliederung), Umweltschutz,Bildungswesen,Freizeitgestaltung, Sport, Kultur und Religion\ninstitutioneller_sektor, institutioneller Sektor, Staat,Kantone,Bund,Gemeinden,\u00d6ffentliche Sozialversicherungen\nausgaben_in_mio_chf, Ausgaben in Millionen CHF, None\nprozent_der_gesamtausgaben, Prozent der Gesamtaugaben, None\n*/\n\n\n\n### Question\nWie viel Prozent des Staat Budgets gab im Jahr 2021 fur Bildung aus?\n### SQL query\nSELECT SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_bildung\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE institutioneller_sektor = 'Staat'\n    AND jahr = 2021\n    AND aufgabenbereich_cofog_grobgliederung = 'Bildungswesen';\n\n\n### Question\nWie verteilen sich die kantonalen Bildungsausgaben im Jahr 2010?\n### SQL query\nSELECT aufgabenbereich_cofog_feingliederung, ausgaben_in_mio_chf as kantonale_ausgaben_in_mio_chf_jahr_2010\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE aufgabenbereich_cofog_grobgliederung = 'Bildungswesen'\n    AND jahr = 2020\n    AND institutioneller_sektor = 'Kantone'\nORDER BY ausgaben_in_mio_chf DESC;\n\n\n### Question\nWelches waren die 3 gr\u00f6ssten Ausgabenquellen des Bundes im Jahr 2021 und wie hoch waren diese?\n### SQL query\n",
    "process_time": 7.214408969972283,
    "num_tokens": 1388,
    "hardness": "unknown",
    "scores": [
      0.7783884406089783,
      0.8883976340293884
    ],
    "lang": "de"
  },
  {
    "i": 143,
    "question": "Welcher Anteil des Schweizer Budgets wird jedes Jahr in Sicherheit investiert?",
    "query": "SELECT jahr, SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_sicherheit\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%sicherheit%'\n    AND institutioneller_sektor = 'Staat'\nGROUP BY jahr\nORDER BY jahr ASC;\n",
    "db_id": "staatsausgaben_nach_aufgabenbereichen_cofog",
    "generated_query": "SELECT jahr, SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_sicherheit\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%sicherheit%'\n    AND jahr IS NOT NULL\nGROUP BY jahr\nORDER BY jahr ASC;",
    "meta_data": [
      {
        "question": "Wie hoch war der Anteil des Gemeinde Budgets, der seit 2011 f\u00fcr Kommunikation bereitgestellt wurde?",
        "query": "SELECT jahr, SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_kommunikation_in_landgemeinden\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%kommunikation%'\n    AND institutioneller_sektor = 'Gemeinden'\n    AND jahr >= 2011\nGROUP BY jahr\nORDER BY jahr ASC;\n",
        "score": 0.7957860231399536
      },
      {
        "question": "Wie viel Prozent des Staat Budgets gab im Jahr 2021 fur Bildung aus?",
        "query": "SELECT SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_bildung\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE institutioneller_sektor = 'Staat'\n    AND jahr = 2021\n    AND aufgabenbereich_cofog_grobgliederung = 'Bildungswesen';\n",
        "score": 0.8044547438621521
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 6797_A.ADM3, 9173_A.ADM3, 5754_A.ADM3, 5796_A.ADM3, 4065_A.ADM3\nspatialunit_current_id : 5646, 819, 3831, 335, 5176\nname : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_de : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_fr : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nname_it : Oberdiessbach, Balerna, District de Lausanne, Sargans, Rovray\nspatialunit_hist_id : 15330, 14390, 12694, 10317, 14751\ncanton_hist_id : 21, 24, 5, 12, 17\ndistrict_hist_id : 10181, 10297, 10257, 10317, 10268\nvalid_from : 2018-01-01, 2017-01-01, 2001-01-01, 1974-01-01, 1976-01-01\nvalid_until : 2000-12-31, 2013-04-13, 2008-12-31, 1961-12-31, 2002-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.staatsausgaben_nach_aufgabenbereichen_cofog (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\taufgabenbereich_cofog_feingliederung TEXT, \n\taufgabenbereich_cofog_grobgliederung TEXT, \n\tinstitutioneller_sektor TEXT, \n\tausgaben_in_mio_chf NUMERIC, \n\tprozent_der_gesamtausgaben NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT staatsausgaben_nach_aufgabenbereichen_cofog_pkey PRIMARY KEY (uid), \n\tCONSTRAINT staatsausgaben_nach_aufgabenbereichen_cofo_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in staatsausgaben_nach_aufgabenbereichen_cofog and 5 examples in each column for high cardinality columns :\nuid : 92, 149, 78, 157, 95\njahr : 2014, 2006, 2002, 2005, 2017\nausgaben_in_mio_chf : 8656, 6725, 78, 7449, 10181\nprozent_der_gesamtausgaben : 3.50000000000000000, 6.70000000000000018, 6.09999999999999964, 0.29999999999999999, 8.69999999999999929\n*/\n\n/*\nColumn name, Column discription, Example values\naufgabenbereich_cofog_feingliederung, Aufgabenbereich des Staates (COFOG Feingliederung), Alter,Wasserversorgung,Polizei\naufgabenbereich_cofog_grobgliederung, Aufgabenbereich des Staates (COFOG Grobgliederung), Umweltschutz,Bildungswesen,Freizeitgestaltung, Sport, Kultur und Religion\ninstitutioneller_sektor, institutioneller Sektor, Staat,Kantone,Bund,Gemeinden,\u00d6ffentliche Sozialversicherungen\nausgaben_in_mio_chf, Ausgaben in Millionen CHF, None\nprozent_der_gesamtausgaben, Prozent der Gesamtaugaben, None\n*/\n\n\n\n### Question\nWie hoch war der Anteil des Gemeinde Budgets, der seit 2011 f\u00fcr Kommunikation bereitgestellt wurde?\n### SQL query\nSELECT jahr, SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_kommunikation_in_landgemeinden\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%kommunikation%'\n    AND institutioneller_sektor = 'Gemeinden'\n    AND jahr >= 2011\nGROUP BY jahr\nORDER BY jahr ASC;\n\n\n### Question\nWie viel Prozent des Staat Budgets gab im Jahr 2021 fur Bildung aus?\n### SQL query\nSELECT SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_bildung\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE institutioneller_sektor = 'Staat'\n    AND jahr = 2021\n    AND aufgabenbereich_cofog_grobgliederung = 'Bildungswesen';\n\n\n### Question\nWelcher Anteil des Schweizer Budgets wird jedes Jahr in Sicherheit investiert?\n### SQL query\n",
    "process_time": 9.373942006845027,
    "num_tokens": 1386,
    "hardness": "unknown",
    "scores": [
      0.7957860231399536,
      0.8044547438621521
    ],
    "lang": "de"
  }
]