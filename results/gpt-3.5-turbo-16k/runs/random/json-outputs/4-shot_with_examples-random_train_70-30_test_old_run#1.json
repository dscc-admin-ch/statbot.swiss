[
  {
    "i": 0,
    "question": "Which offences had over 10,000 incidents in Switzerland in 2022. Provide the criminal codes and the number of incidents.",
    "query": "SELECT T.offence_criminal_code,\n  SUM(T.number_criminal_offences_registered) AS offences_per_year\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2022\n  AND T.number_criminal_offences_registered > 10000\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.year, T.offence_criminal_code\nORDER BY offences_per_year DESC;\n",
    "db_id": "criminal_offences_registered_by_police",
    "generated_query": "SELECT T.offence_criminal_code, T.number_criminal_offences_registered\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2022\n  AND T.number_criminal_offences_registered > 10000\nORDER BY T.number_criminal_offences_registered DESC;",
    "meta_data": [
      {
        "question": "Which three crime categories had the lowest crime detection rate in 2019 in Switzerland and what were these rates?",
        "query": "SELECT T.offence_category,\n100 * SUM(T.number_criminal_offences_solved) / SUM(T.number_criminal_offences_registered)\nAS crime_detection_rate\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2019\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category\nORDER BY crime_detection_rate LIMIT 3;\n"
      },
      {
        "question": "In which year were there the most crimes in Switzerland? Also please provide the number of committed crimes.",
        "query": "SELECT T.year AS year_with_most_crimes, T.number_criminal_offences_registered\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.offence_criminal_code = 'Offence - total'\nGROUP BY T.year, T.number_criminal_offences_registered\nORDER BY T.number_criminal_offences_registered DESC LIMIT 1;\n"
      },
      {
        "question": "How many crimes were solved in Bern in 2022?",
        "query": "SELECT T.number_criminal_offences_solved as solved_criminal_offences_2022_bern\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Bern%'\n  AND S.canton = 'TRUE'\n  AND T.offence_criminal_code = 'Offence - total'\n  AND T.year = 2022;\n"
      },
      {
        "question": "How many crimes were solved in Bern in 2022?",
        "query": "SELECT T.number_criminal_offences_solved as solved_criminal_offences_2022_bern\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Bern%'\n  AND S.canton = 'TRUE'\n  AND T.offence_criminal_code = 'Offence - total'\n  AND T.year = 2022;\n"
      },
      {
        "question": "How were the crime prevention rates in Switzerland for 2022 per crime category. Also provide the number of attempted and committed crimes? Order by prevention rate.",
        "query": "SELECT T.offence_category, SUM(T.number_criminal_offences_attempted) AS number_of_attempted_crimes,\n  SUM(T.number_criminal_offences_registered) AS number_of_committed_crimes,\n  ROUND(100 * SUM(T.number_criminal_offences_attempted) / SUM(T.number_criminal_offences_registered), 2) AS prevention_rate\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2022\n  AND T.number_criminal_offences_registered != 0\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category\nORDER BY prevention_rate DESC;\n"
      },
      {
        "question": "Which three crime categories had the lowest crime detection rate in 2019 in Switzerland and what were these rates?",
        "query": "SELECT T.offence_category,\n100 * SUM(T.number_criminal_offences_solved) / SUM(T.number_criminal_offences_registered)\nAS crime_detection_rate\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2019\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category\nORDER BY crime_detection_rate LIMIT 3;\n"
      },
      {
        "question": "Compare the years 2019 and 2020 regarding offence categories that had over a 100 incidents in Kanton of Zurich. Provide the difference and order by how much they increased.",
        "query": "SELECT T.offence_category,\n   SUM(CASE WHEN T.year = 2019\n       THEN T.number_criminal_offences_registered ELSE 0 END) AS number_offences_2019,\n   SUM(CASE WHEN T.year = 2020\n       THEN T.number_criminal_offences_registered ELSE 0 END) AS number_offences_2020,\n   SUM(CASE WHEN T.year = 2020\n       THEN T.number_criminal_offences_registered ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2019\n       THEN T.number_criminal_offences_registered ELSE 0 END) AS increase\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND S.name LIKE '%Zurich%'\n  AND T.year IN (2019, 2020)\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category\nHAVING SUM(CASE WHEN T.year = 2019\n       THEN T.number_criminal_offences_registered ELSE 0 END) > 100\nORDER BY increase DESC;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.criminal_offences_registered_by_police (\n\tuid SERIAL NOT NULL, \n\toffence_criminal_code TEXT, \n\tyear INTEGER, \n\toffence_category TEXT, \n\tnumber_criminal_offences_registered NUMERIC, \n\tnumber_criminal_offences_unsolved NUMERIC, \n\tnumber_criminal_offences_solved NUMERIC, \n\tnumber_criminal_offences_completed NUMERIC, \n\tnumber_criminal_offences_completed_unsolved NUMERIC, \n\tnumber_criminal_offences_completed_solved NUMERIC, \n\tnumber_criminal_offences_attempted NUMERIC, \n\tnumber_criminal_offences_attempted_unsolved NUMERIC, \n\tnumber_criminal_offences_attempted_solved NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT criminal_offences_registered_by_police_pkey PRIMARY KEY (uid), \n\tCONSTRAINT criminal_offences_registered_by_police_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in criminal_offences_registered_by_police and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\noffence_criminal_code : Homicide through negligence (art. 117), Obtaining a judicial composition agreement by fraud (art. 170), Snatch theft (art. 139), Misappropriation and removal of property subject to a pledge or lien (art. 145), Sexual acts with children (art. 187)\nnumber_criminal_offences_registered : 127, 2560, 72, 63523, 29\nnumber_criminal_offences_unsolved : 192, 374208, 28, 13923, 17\nnumber_criminal_offences_solved : 1756, 1560, 29, 3312, 14175\nnumber_criminal_offences_completed : 481, 72, 57797, 2641, 29\nnumber_criminal_offences_completed_unsolved : 2494, 127, 29, 28, 17\nnumber_criminal_offences_completed_solved : 1393, 459, 29, 6981, 28\nnumber_criminal_offences_attempted : 4, 91, 8, 72, 23\nnumber_criminal_offences_attempted_unsolved : 4, 20512, 23, 29, 24\nnumber_criminal_offences_attempted_solved : 4, 1393, 18, 59, 171\n*/\n\n/*\nColumn name, Column discription, Example values\noffence_criminal_code, offence as defined by Swiss criminal code, Vehicle burglary (art. 139),Falsification of money (art. 241)\nnumber_criminal_offences_registered, number of criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_unsolved, number of unsolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_solved, number of resolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_completed, number of completed criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_completed_unsolved, Number of completed and unsolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_completed_solved, Number of completed and resolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_attempted, number of attempted criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_attempted_unsolved, number of attempted und unsolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_attempted_solved, number of attempted and resolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\noffence_category, broad Category of criminal offence, Property,Liberty\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWhich three crime categories had the lowest crime detection rate in 2019 in Switzerland and what were these rates?\n### SQL query\nSELECT T.offence_category,\n100 * SUM(T.number_criminal_offences_solved) / SUM(T.number_criminal_offences_registered)\nAS crime_detection_rate\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2019\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category\nORDER BY crime_detection_rate LIMIT 3;\n\n\n### Question\nIn which year were there the most crimes in Switzerland? Also please provide the number of committed crimes.\n### SQL query\nSELECT T.year AS year_with_most_crimes, T.number_criminal_offences_registered\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.offence_criminal_code = 'Offence - total'\nGROUP BY T.year, T.number_criminal_offences_registered\nORDER BY T.number_criminal_offences_registered DESC LIMIT 1;\n\n\n### Question\nHow many crimes were solved in Bern in 2022?\n### SQL query\nSELECT T.number_criminal_offences_solved as solved_criminal_offences_2022_bern\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Bern%'\n  AND S.canton = 'TRUE'\n  AND T.offence_criminal_code = 'Offence - total'\n  AND T.year = 2022;\n\n\n### Question\nHow many crimes were solved in Bern in 2022?\n### SQL query\nSELECT T.number_criminal_offences_solved as solved_criminal_offences_2022_bern\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Bern%'\n  AND S.canton = 'TRUE'\n  AND T.offence_criminal_code = 'Offence - total'\n  AND T.year = 2022;\n\n\n### Question\nHow were the crime prevention rates in Switzerland for 2022 per crime category. Also provide the number of attempted and committed crimes? Order by prevention rate.\n### SQL query\nSELECT T.offence_category, SUM(T.number_criminal_offences_attempted) AS number_of_attempted_crimes,\n  SUM(T.number_criminal_offences_registered) AS number_of_committed_crimes,\n  ROUND(100 * SUM(T.number_criminal_offences_attempted) / SUM(T.number_criminal_offences_registered), 2) AS prevention_rate\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2022\n  AND T.number_criminal_offences_registered != 0\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category\nORDER BY prevention_rate DESC;\n\n\n### Question\nWhich three crime categories had the lowest crime detection rate in 2019 in Switzerland and what were these rates?\n### SQL query\nSELECT T.offence_category,\n100 * SUM(T.number_criminal_offences_solved) / SUM(T.number_criminal_offences_registered)\nAS crime_detection_rate\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2019\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category\nORDER BY crime_detection_rate LIMIT 3;\n\n\n### Question\nCompare the years 2019 and 2020 regarding offence categories that had over a 100 incidents in Kanton of Zurich. Provide the difference and order by how much they increased.\n### SQL query\nSELECT T.offence_category,\n   SUM(CASE WHEN T.year = 2019\n       THEN T.number_criminal_offences_registered ELSE 0 END) AS number_offences_2019,\n   SUM(CASE WHEN T.year = 2020\n       THEN T.number_criminal_offences_registered ELSE 0 END) AS number_offences_2020,\n   SUM(CASE WHEN T.year = 2020\n       THEN T.number_criminal_offences_registered ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2019\n       THEN T.number_criminal_offences_registered ELSE 0 END) AS increase\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND S.name LIKE '%Zurich%'\n  AND T.year IN (2019, 2020)\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category\nHAVING SUM(CASE WHEN T.year = 2019\n       THEN T.number_criminal_offences_registered ELSE 0 END) > 100\nORDER BY increase DESC;\n\n\n### Question\nWhich offences had over 10,000 incidents in Switzerland in 2022. Provide the criminal codes and the number of incidents.\n### SQL query\n",
    "process_time": 10.476078842999414,
    "num_tokens": 2639,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 1,
    "question": "What is the most committed crime in Switzerland?",
    "query": "SELECT T.offence_criminal_code AS most_common_criminal_offence\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.offence_criminal_code != 'Offence - total'\n  AND T.number_criminal_offences_registered IS NOT NULL\nGROUP BY T.offence_criminal_code\nORDER BY SUM(T.number_criminal_offences_registered) DESC LIMIT 1;\n",
    "db_id": "criminal_offences_registered_by_police",
    "generated_query": "SELECT T.offence_criminal_code\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_criminal_code, T.number_criminal_offences_registered\nORDER BY T.number_criminal_offences_registered DESC LIMIT 1;",
    "meta_data": [
      {
        "question": "In which year were there the most crimes in Switzerland? Also please provide the number of committed crimes.",
        "query": "SELECT T.year AS year_with_most_crimes, T.number_criminal_offences_registered\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.offence_criminal_code = 'Offence - total'\nGROUP BY T.year, T.number_criminal_offences_registered\nORDER BY T.number_criminal_offences_registered DESC LIMIT 1;\n"
      },
      {
        "question": "What was the most committed crime in 2020 in the canton of Bern?",
        "query": "SELECT T.offence_criminal_code\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Bern%'\n  AND S.canton = 'TRUE'\n  AND T.year = 2020\n  AND T.offence_criminal_code != 'Offence - total'\n  AND T.number_criminal_offences_registered IS NOT NULL\nGROUP BY T.offence_criminal_code, T.number_criminal_offences_registered\nORDER BY T.number_criminal_offences_registered DESC LIMIT 1;\n"
      },
      {
        "question": "In which year were there the most crimes in Switzerland? Also please provide the number of committed crimes.",
        "query": "SELECT T.year AS year_with_most_crimes, T.number_criminal_offences_registered\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.offence_criminal_code = 'Offence - total'\nGROUP BY T.year, T.number_criminal_offences_registered\nORDER BY T.number_criminal_offences_registered DESC LIMIT 1;\n"
      },
      {
        "question": "How many crimes were solved in Bern in 2022?",
        "query": "SELECT T.number_criminal_offences_solved as solved_criminal_offences_2022_bern\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Bern%'\n  AND S.canton = 'TRUE'\n  AND T.offence_criminal_code = 'Offence - total'\n  AND T.year = 2022;\n"
      },
      {
        "question": "What is the category of the most frequently committed crimes in Switzerland and how many such crimes were commited?",
        "query": "SELECT T.offence_category, SUM(number_criminal_offences_registered) AS number_criminal_offences\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category, S.name\nORDER BY number_criminal_offences DESC LIMIT 1;\n"
      },
      {
        "question": "In which year were there the most crimes in Switzerland? Also please provide the number of committed crimes.",
        "query": "SELECT T.year AS year_with_most_crimes, T.number_criminal_offences_registered\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.offence_criminal_code = 'Offence - total'\nGROUP BY T.year, T.number_criminal_offences_registered\nORDER BY T.number_criminal_offences_registered DESC LIMIT 1;\n"
      },
      {
        "question": "How many crimes were solved in Bern in 2022?",
        "query": "SELECT T.number_criminal_offences_solved as solved_criminal_offences_2022_bern\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Bern%'\n  AND S.canton = 'TRUE'\n  AND T.offence_criminal_code = 'Offence - total'\n  AND T.year = 2022;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.criminal_offences_registered_by_police (\n\tuid SERIAL NOT NULL, \n\toffence_criminal_code TEXT, \n\tyear INTEGER, \n\toffence_category TEXT, \n\tnumber_criminal_offences_registered NUMERIC, \n\tnumber_criminal_offences_unsolved NUMERIC, \n\tnumber_criminal_offences_solved NUMERIC, \n\tnumber_criminal_offences_completed NUMERIC, \n\tnumber_criminal_offences_completed_unsolved NUMERIC, \n\tnumber_criminal_offences_completed_solved NUMERIC, \n\tnumber_criminal_offences_attempted NUMERIC, \n\tnumber_criminal_offences_attempted_unsolved NUMERIC, \n\tnumber_criminal_offences_attempted_solved NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT criminal_offences_registered_by_police_pkey PRIMARY KEY (uid), \n\tCONSTRAINT criminal_offences_registered_by_police_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in criminal_offences_registered_by_police and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\noffence_criminal_code : Homicide through negligence (art. 117), Obtaining a judicial composition agreement by fraud (art. 170), Snatch theft (art. 139), Misappropriation and removal of property subject to a pledge or lien (art. 145), Sexual acts with children (art. 187)\nnumber_criminal_offences_registered : 127, 2560, 72, 63523, 29\nnumber_criminal_offences_unsolved : 192, 374208, 28, 13923, 17\nnumber_criminal_offences_solved : 1756, 1560, 29, 3312, 14175\nnumber_criminal_offences_completed : 481, 72, 57797, 2641, 29\nnumber_criminal_offences_completed_unsolved : 2494, 127, 29, 28, 17\nnumber_criminal_offences_completed_solved : 1393, 459, 29, 6981, 28\nnumber_criminal_offences_attempted : 4, 91, 8, 72, 23\nnumber_criminal_offences_attempted_unsolved : 4, 20512, 23, 29, 24\nnumber_criminal_offences_attempted_solved : 4, 1393, 18, 59, 171\n*/\n\n/*\nColumn name, Column discription, Example values\noffence_criminal_code, offence as defined by Swiss criminal code, Vehicle burglary (art. 139),Falsification of money (art. 241)\nnumber_criminal_offences_registered, number of criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_unsolved, number of unsolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_solved, number of resolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_completed, number of completed criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_completed_unsolved, Number of completed and unsolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_completed_solved, Number of completed and resolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_attempted, number of attempted criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_attempted_unsolved, number of attempted und unsolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_attempted_solved, number of attempted and resolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\noffence_category, broad Category of criminal offence, Property,Liberty\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nIn which year were there the most crimes in Switzerland? Also please provide the number of committed crimes.\n### SQL query\nSELECT T.year AS year_with_most_crimes, T.number_criminal_offences_registered\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.offence_criminal_code = 'Offence - total'\nGROUP BY T.year, T.number_criminal_offences_registered\nORDER BY T.number_criminal_offences_registered DESC LIMIT 1;\n\n\n### Question\nWhat was the most committed crime in 2020 in the canton of Bern?\n### SQL query\nSELECT T.offence_criminal_code\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Bern%'\n  AND S.canton = 'TRUE'\n  AND T.year = 2020\n  AND T.offence_criminal_code != 'Offence - total'\n  AND T.number_criminal_offences_registered IS NOT NULL\nGROUP BY T.offence_criminal_code, T.number_criminal_offences_registered\nORDER BY T.number_criminal_offences_registered DESC LIMIT 1;\n\n\n### Question\nIn which year were there the most crimes in Switzerland? Also please provide the number of committed crimes.\n### SQL query\nSELECT T.year AS year_with_most_crimes, T.number_criminal_offences_registered\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.offence_criminal_code = 'Offence - total'\nGROUP BY T.year, T.number_criminal_offences_registered\nORDER BY T.number_criminal_offences_registered DESC LIMIT 1;\n\n\n### Question\nHow many crimes were solved in Bern in 2022?\n### SQL query\nSELECT T.number_criminal_offences_solved as solved_criminal_offences_2022_bern\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Bern%'\n  AND S.canton = 'TRUE'\n  AND T.offence_criminal_code = 'Offence - total'\n  AND T.year = 2022;\n\n\n### Question\nWhat is the category of the most frequently committed crimes in Switzerland and how many such crimes were commited?\n### SQL query\nSELECT T.offence_category, SUM(number_criminal_offences_registered) AS number_criminal_offences\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category, S.name\nORDER BY number_criminal_offences DESC LIMIT 1;\n\n\n### Question\nIn which year were there the most crimes in Switzerland? Also please provide the number of committed crimes.\n### SQL query\nSELECT T.year AS year_with_most_crimes, T.number_criminal_offences_registered\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.offence_criminal_code = 'Offence - total'\nGROUP BY T.year, T.number_criminal_offences_registered\nORDER BY T.number_criminal_offences_registered DESC LIMIT 1;\n\n\n### Question\nHow many crimes were solved in Bern in 2022?\n### SQL query\nSELECT T.number_criminal_offences_solved as solved_criminal_offences_2022_bern\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Bern%'\n  AND S.canton = 'TRUE'\n  AND T.offence_criminal_code = 'Offence - total'\n  AND T.year = 2022;\n\n\n### Question\nWhat is the most committed crime in Switzerland?\n### SQL query\n",
    "process_time": 6.901637953007594,
    "num_tokens": 2369,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 2,
    "question": "What was the clearance rate for bribery in 2021 in Switzerland",
    "query": "SELECT 100 * SUM(T.number_criminal_offences_solved) / SUM(T.number_criminal_offences_registered)\nAS clearance_rate_for_bribery\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2021\n  AND T.number_criminal_offences_registered IS NOT NULL\n  AND T.offence_category = 'Bribery';\n",
    "db_id": "criminal_offences_registered_by_police",
    "generated_query": "SELECT 100 * number_criminal_offences_solved / number_criminal_offences_registered AS clearance_rate\nFROM criminal_offences_registered_by_police\nWHERE offence_criminal_code = 'Bribery'\n  AND year = 2021\n  AND spatialunit_uid IN (SELECT spatialunit_uid FROM spatial_unit WHERE name = 'Switzerland' AND country = true)",
    "meta_data": [
      {
        "question": "Which three crime categories had the lowest crime detection rate in 2019 in Switzerland and what were these rates?",
        "query": "SELECT T.offence_category,\n100 * SUM(T.number_criminal_offences_solved) / SUM(T.number_criminal_offences_registered)\nAS crime_detection_rate\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2019\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category\nORDER BY crime_detection_rate LIMIT 3;\n"
      },
      {
        "question": "What is the category of the most frequently committed crimes in Switzerland and how many such crimes were commited?",
        "query": "SELECT T.offence_category, SUM(number_criminal_offences_registered) AS number_criminal_offences\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category, S.name\nORDER BY number_criminal_offences DESC LIMIT 1;\n"
      },
      {
        "question": "How many crimes were solved in Bern in 2022?",
        "query": "SELECT T.number_criminal_offences_solved as solved_criminal_offences_2022_bern\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Bern%'\n  AND S.canton = 'TRUE'\n  AND T.offence_criminal_code = 'Offence - total'\n  AND T.year = 2022;\n"
      },
      {
        "question": "Which three crime categories had the lowest crime detection rate in 2019 in Switzerland and what were these rates?",
        "query": "SELECT T.offence_category,\n100 * SUM(T.number_criminal_offences_solved) / SUM(T.number_criminal_offences_registered)\nAS crime_detection_rate\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2019\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category\nORDER BY crime_detection_rate LIMIT 3;\n"
      },
      {
        "question": "How were the crime prevention rates in Switzerland for 2022 per crime category. Also provide the number of attempted and committed crimes? Order by prevention rate.",
        "query": "SELECT T.offence_category, SUM(T.number_criminal_offences_attempted) AS number_of_attempted_crimes,\n  SUM(T.number_criminal_offences_registered) AS number_of_committed_crimes,\n  ROUND(100 * SUM(T.number_criminal_offences_attempted) / SUM(T.number_criminal_offences_registered), 2) AS prevention_rate\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2022\n  AND T.number_criminal_offences_registered != 0\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category\nORDER BY prevention_rate DESC;\n"
      },
      {
        "question": "In which year were there the most crimes in Switzerland? Also please provide the number of committed crimes.",
        "query": "SELECT T.year AS year_with_most_crimes, T.number_criminal_offences_registered\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.offence_criminal_code = 'Offence - total'\nGROUP BY T.year, T.number_criminal_offences_registered\nORDER BY T.number_criminal_offences_registered DESC LIMIT 1;\n"
      },
      {
        "question": "How were the crime prevention rates in Switzerland for 2022 per crime category. Also provide the number of attempted and committed crimes? Order by prevention rate.",
        "query": "SELECT T.offence_category, SUM(T.number_criminal_offences_attempted) AS number_of_attempted_crimes,\n  SUM(T.number_criminal_offences_registered) AS number_of_committed_crimes,\n  ROUND(100 * SUM(T.number_criminal_offences_attempted) / SUM(T.number_criminal_offences_registered), 2) AS prevention_rate\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2022\n  AND T.number_criminal_offences_registered != 0\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category\nORDER BY prevention_rate DESC;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.criminal_offences_registered_by_police (\n\tuid SERIAL NOT NULL, \n\toffence_criminal_code TEXT, \n\tyear INTEGER, \n\toffence_category TEXT, \n\tnumber_criminal_offences_registered NUMERIC, \n\tnumber_criminal_offences_unsolved NUMERIC, \n\tnumber_criminal_offences_solved NUMERIC, \n\tnumber_criminal_offences_completed NUMERIC, \n\tnumber_criminal_offences_completed_unsolved NUMERIC, \n\tnumber_criminal_offences_completed_solved NUMERIC, \n\tnumber_criminal_offences_attempted NUMERIC, \n\tnumber_criminal_offences_attempted_unsolved NUMERIC, \n\tnumber_criminal_offences_attempted_solved NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT criminal_offences_registered_by_police_pkey PRIMARY KEY (uid), \n\tCONSTRAINT criminal_offences_registered_by_police_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in criminal_offences_registered_by_police and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\noffence_criminal_code : Homicide through negligence (art. 117), Obtaining a judicial composition agreement by fraud (art. 170), Snatch theft (art. 139), Misappropriation and removal of property subject to a pledge or lien (art. 145), Sexual acts with children (art. 187)\nnumber_criminal_offences_registered : 127, 2560, 72, 63523, 29\nnumber_criminal_offences_unsolved : 192, 374208, 28, 13923, 17\nnumber_criminal_offences_solved : 1756, 1560, 29, 3312, 14175\nnumber_criminal_offences_completed : 481, 72, 57797, 2641, 29\nnumber_criminal_offences_completed_unsolved : 2494, 127, 29, 28, 17\nnumber_criminal_offences_completed_solved : 1393, 459, 29, 6981, 28\nnumber_criminal_offences_attempted : 4, 91, 8, 72, 23\nnumber_criminal_offences_attempted_unsolved : 4, 20512, 23, 29, 24\nnumber_criminal_offences_attempted_solved : 4, 1393, 18, 59, 171\n*/\n\n/*\nColumn name, Column discription, Example values\noffence_criminal_code, offence as defined by Swiss criminal code, Vehicle burglary (art. 139),Falsification of money (art. 241)\nnumber_criminal_offences_registered, number of criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_unsolved, number of unsolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_solved, number of resolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_completed, number of completed criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_completed_unsolved, Number of completed and unsolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_completed_solved, Number of completed and resolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_attempted, number of attempted criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_attempted_unsolved, number of attempted und unsolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\nnumber_criminal_offences_attempted_solved, number of attempted and resolved criminal offences registered by Swiss police according to Swiss Criminal Code, None\noffence_category, broad Category of criminal offence, Property,Liberty\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWhich three crime categories had the lowest crime detection rate in 2019 in Switzerland and what were these rates?\n### SQL query\nSELECT T.offence_category,\n100 * SUM(T.number_criminal_offences_solved) / SUM(T.number_criminal_offences_registered)\nAS crime_detection_rate\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2019\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category\nORDER BY crime_detection_rate LIMIT 3;\n\n\n### Question\nWhat is the category of the most frequently committed crimes in Switzerland and how many such crimes were commited?\n### SQL query\nSELECT T.offence_category, SUM(number_criminal_offences_registered) AS number_criminal_offences\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category, S.name\nORDER BY number_criminal_offences DESC LIMIT 1;\n\n\n### Question\nHow many crimes were solved in Bern in 2022?\n### SQL query\nSELECT T.number_criminal_offences_solved as solved_criminal_offences_2022_bern\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Bern%'\n  AND S.canton = 'TRUE'\n  AND T.offence_criminal_code = 'Offence - total'\n  AND T.year = 2022;\n\n\n### Question\nWhich three crime categories had the lowest crime detection rate in 2019 in Switzerland and what were these rates?\n### SQL query\nSELECT T.offence_category,\n100 * SUM(T.number_criminal_offences_solved) / SUM(T.number_criminal_offences_registered)\nAS crime_detection_rate\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2019\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category\nORDER BY crime_detection_rate LIMIT 3;\n\n\n### Question\nHow were the crime prevention rates in Switzerland for 2022 per crime category. Also provide the number of attempted and committed crimes? Order by prevention rate.\n### SQL query\nSELECT T.offence_category, SUM(T.number_criminal_offences_attempted) AS number_of_attempted_crimes,\n  SUM(T.number_criminal_offences_registered) AS number_of_committed_crimes,\n  ROUND(100 * SUM(T.number_criminal_offences_attempted) / SUM(T.number_criminal_offences_registered), 2) AS prevention_rate\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2022\n  AND T.number_criminal_offences_registered != 0\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category\nORDER BY prevention_rate DESC;\n\n\n### Question\nIn which year were there the most crimes in Switzerland? Also please provide the number of committed crimes.\n### SQL query\nSELECT T.year AS year_with_most_crimes, T.number_criminal_offences_registered\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.offence_criminal_code = 'Offence - total'\nGROUP BY T.year, T.number_criminal_offences_registered\nORDER BY T.number_criminal_offences_registered DESC LIMIT 1;\n\n\n### Question\nHow were the crime prevention rates in Switzerland for 2022 per crime category. Also provide the number of attempted and committed crimes? Order by prevention rate.\n### SQL query\nSELECT T.offence_category, SUM(T.number_criminal_offences_attempted) AS number_of_attempted_crimes,\n  SUM(T.number_criminal_offences_registered) AS number_of_committed_crimes,\n  ROUND(100 * SUM(T.number_criminal_offences_attempted) / SUM(T.number_criminal_offences_registered), 2) AS prevention_rate\nFROM criminal_offences_registered_by_police AS T\nJOIN spatial_unit AS S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2022\n  AND T.number_criminal_offences_registered != 0\n  AND T.offence_criminal_code != 'Offence - total'\nGROUP BY T.offence_category\nORDER BY prevention_rate DESC;\n\n\n### Question\nWhat was the clearance rate for bribery in 2021 in Switzerland\n### SQL query\n",
    "process_time": 6.150209079962224,
    "num_tokens": 2564,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 3,
    "question": "List for each year the number of forests in Kanton Uri?",
    "query": "SELECT T.year, SUM(T.number_of_plantations) AS number_of_plantations_canton_uri\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Uri%'\n  AND T.type_of_owner = 'Type of owners - total'\n  AND T.wood_species = 'Species - total'\n  AND T.forest_zone != 'Switzerland'\n  AND T.number_of_plantations != 0\nGROUP BY T.year\nORDER BY T.year DESC;\n",
    "db_id": "number_of_plantations_in_swiss_forest",
    "generated_query": "SELECT T.year, T.number_of_plantations\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND S.name = 'Uri'\nORDER BY T.year;",
    "meta_data": [
      {
        "question": "Which cantons had in 2022 only public forests?",
        "query": "SELECT S.name_de as canton\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.type_of_owner = 'Private forest'\n  AND T.year = 2022\nGROUP BY S.name_de\nHAVING SUM(T.number_of_plantations) = 0;\n"
      },
      {
        "question": "How much did the number of Swiss forest change from 1975 to 2022? Show the change in total and by forest type as conifers or deciduous.",
        "query": "SELECT\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_deciduous_number_of_forests_1975_to_2022,\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_conifers_number_of_forests_1975_to_2022,\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%total%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%total%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_total_number_of_forests_1975_to_2022\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.year IN (1975, 2022)\n  AND S.name = 'Switzerland'\n  AND T.forest_zone = 'Switzerland'\n  AND T.type_of_owner = 'Type of owners - total';\n"
      },
      {
        "question": "What was the proportion of private to public forests in Switzerland in 2022?",
        "query": "SELECT\n  ROUND(100 * SUM(CASE WHEN LOWER(type_of_owner) LIKE '%private%'\n        THEN number_of_plantations ELSE 0 END) /\n    SUM(CASE WHEN LOWER(type_of_owner) LIKE '%total%'\n        THEN number_of_plantations ELSE 0 END), 2) AS percentage_private_forests,\n  ROUND(100 * SUM(CASE WHEN LOWER(type_of_owner) LIKE '%public%'\n       THEN number_of_plantations ELSE 0 END) /\n    SUM(CASE WHEN LOWER(type_of_owner) LIKE '%total%'\n       THEN number_of_plantations ELSE 0 END), 2) AS percentage_public_forests\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.year = 2022\n  AND S.name = 'Switzerland'\n  AND T.wood_species = 'Species - total';\n"
      },
      {
        "question": "Provide the change over the years of the total number of forests registered in Switzerland. The change should be given in percentage of the number of the previous year.",
        "query": "WITH PlantationsByYear AS (\n  SELECT T.year,\n    SUM(T.number_of_plantations) AS number_of_plantations_switzerland\n  FROM number_of_plantations_in_swiss_forest AS T\n  JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n  WHERE S.country = 'TRUE'\n    AND T.type_of_owner = 'Type of owners - total'\n    AND T.wood_species = 'Species - total'\n    AND T.forest_zone != 'Switzerland'\n    AND T.number_of_plantations != 0\n  GROUP BY T.year\n)\nSELECT\n  Curr.year,\n  Curr.number_of_plantations_switzerland,\n  ROUND(100 * (Curr.number_of_plantations_switzerland - Prev.number_of_plantations_switzerland) / (Prev.number_of_plantations_switzerland), 2) AS change_from_previous_year\nFROM PlantationsByYear AS Curr\nLEFT JOIN PlantationsByYear AS Prev ON Curr.year = Prev.year + 1\nORDER BY Curr.year DESC;\n"
      },
      {
        "question": "How much did the number of Swiss forest change from 1975 to 2022? Show the change in total and by forest type as conifers or deciduous.",
        "query": "SELECT\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_deciduous_number_of_forests_1975_to_2022,\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_conifers_number_of_forests_1975_to_2022,\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%total%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%total%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_total_number_of_forests_1975_to_2022\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.year IN (1975, 2022)\n  AND S.name = 'Switzerland'\n  AND T.forest_zone = 'Switzerland'\n  AND T.type_of_owner = 'Type of owners - total';\n"
      },
      {
        "question": "Which canton had the most private forests in 2019?",
        "query": "SELECT S.name as canton\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.year = 2019\n  AND T.forest_zone = 'Switzerland'\n  AND T.wood_species = 'Species - total'\n  AND T.type_of_owner = 'Private forest'\nORDER BY number_of_plantations DESC LIMIT 1;\n"
      },
      {
        "question": "Which canton had the most private forests in 2019?",
        "query": "SELECT S.name as canton\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.year = 2019\n  AND T.forest_zone = 'Switzerland'\n  AND T.wood_species = 'Species - total'\n  AND T.type_of_owner = 'Private forest'\nORDER BY number_of_plantations DESC LIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.number_of_plantations_in_swiss_forest (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tforest_zone TEXT, \n\ttype_of_owner TEXT, \n\twood_species TEXT, \n\tnumber_of_plantations NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT number_of_plantations_in_swiss_forest_pkey PRIMARY KEY (uid), \n\tCONSTRAINT number_of_plantations_in_swiss_forest_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in number_of_plantations_in_swiss_forest and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nnumber_of_plantations : 16475, 377625, 44550, 27150, 340895\nspatialunit_uid : 0_CH, 25_A.ADM1, 22_A.ADM1, 2_A.ADM1, 23_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\nforest_zone, forest zone, Switzerland,Jura,Central Plain\ntype_of_owner, owner type, Type of owners - total,Public forest,Private forest\nwood_species, wood species group, Species - total,Hardwood (deciduous),Softwood (conifers)\nnumber_of_plantations, number of plantations, 14987125 ,11537284 ,3449841\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWhich cantons had in 2022 only public forests?\n### SQL query\nSELECT S.name_de as canton\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.type_of_owner = 'Private forest'\n  AND T.year = 2022\nGROUP BY S.name_de\nHAVING SUM(T.number_of_plantations) = 0;\n\n\n### Question\nHow much did the number of Swiss forest change from 1975 to 2022? Show the change in total and by forest type as conifers or deciduous.\n### SQL query\nSELECT\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_deciduous_number_of_forests_1975_to_2022,\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_conifers_number_of_forests_1975_to_2022,\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%total%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%total%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_total_number_of_forests_1975_to_2022\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.year IN (1975, 2022)\n  AND S.name = 'Switzerland'\n  AND T.forest_zone = 'Switzerland'\n  AND T.type_of_owner = 'Type of owners - total';\n\n\n### Question\nWhat was the proportion of private to public forests in Switzerland in 2022?\n### SQL query\nSELECT\n  ROUND(100 * SUM(CASE WHEN LOWER(type_of_owner) LIKE '%private%'\n        THEN number_of_plantations ELSE 0 END) /\n    SUM(CASE WHEN LOWER(type_of_owner) LIKE '%total%'\n        THEN number_of_plantations ELSE 0 END), 2) AS percentage_private_forests,\n  ROUND(100 * SUM(CASE WHEN LOWER(type_of_owner) LIKE '%public%'\n       THEN number_of_plantations ELSE 0 END) /\n    SUM(CASE WHEN LOWER(type_of_owner) LIKE '%total%'\n       THEN number_of_plantations ELSE 0 END), 2) AS percentage_public_forests\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.year = 2022\n  AND S.name = 'Switzerland'\n  AND T.wood_species = 'Species - total';\n\n\n### Question\nProvide the change over the years of the total number of forests registered in Switzerland. The change should be given in percentage of the number of the previous year.\n### SQL query\nWITH PlantationsByYear AS (\n  SELECT T.year,\n    SUM(T.number_of_plantations) AS number_of_plantations_switzerland\n  FROM number_of_plantations_in_swiss_forest AS T\n  JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n  WHERE S.country = 'TRUE'\n    AND T.type_of_owner = 'Type of owners - total'\n    AND T.wood_species = 'Species - total'\n    AND T.forest_zone != 'Switzerland'\n    AND T.number_of_plantations != 0\n  GROUP BY T.year\n)\nSELECT\n  Curr.year,\n  Curr.number_of_plantations_switzerland,\n  ROUND(100 * (Curr.number_of_plantations_switzerland - Prev.number_of_plantations_switzerland) / (Prev.number_of_plantations_switzerland), 2) AS change_from_previous_year\nFROM PlantationsByYear AS Curr\nLEFT JOIN PlantationsByYear AS Prev ON Curr.year = Prev.year + 1\nORDER BY Curr.year DESC;\n\n\n### Question\nHow much did the number of Swiss forest change from 1975 to 2022? Show the change in total and by forest type as conifers or deciduous.\n### SQL query\nSELECT\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_deciduous_number_of_forests_1975_to_2022,\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_conifers_number_of_forests_1975_to_2022,\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%total%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%total%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_total_number_of_forests_1975_to_2022\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.year IN (1975, 2022)\n  AND S.name = 'Switzerland'\n  AND T.forest_zone = 'Switzerland'\n  AND T.type_of_owner = 'Type of owners - total';\n\n\n### Question\nWhich canton had the most private forests in 2019?\n### SQL query\nSELECT S.name as canton\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.year = 2019\n  AND T.forest_zone = 'Switzerland'\n  AND T.wood_species = 'Species - total'\n  AND T.type_of_owner = 'Private forest'\nORDER BY number_of_plantations DESC LIMIT 1;\n\n\n### Question\nWhich canton had the most private forests in 2019?\n### SQL query\nSELECT S.name as canton\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.year = 2019\n  AND T.forest_zone = 'Switzerland'\n  AND T.wood_species = 'Species - total'\n  AND T.type_of_owner = 'Private forest'\nORDER BY number_of_plantations DESC LIMIT 1;\n\n\n### Question\nList for each year the number of forests in Kanton Uri?\n### SQL query\n",
    "process_time": 4.690472301095724,
    "num_tokens": 2568,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 4,
    "question": "What were proportions, in percent, of deciduous and coniferous forests in Switzerland in 2020?",
    "query": "SELECT\n  ROUND(100 * SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%'\n       THEN number_of_plantations ELSE 0 END) /\n  SUM(CASE WHEN LOWER(wood_species) LIKE '%total%'\n       THEN number_of_plantations ELSE 0 END),\n  2) AS percentage_deciduous_forests,\n    ROUND(100 * SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%'\n       THEN number_of_plantations ELSE 0 END) /\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%total%'\n       THEN number_of_plantations ELSE 0 END),\n  2) AS percentage_coniferous_forests\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.year = 2020\n  AND S.name = 'Switzerland'\n  AND T.type_of_owner = 'Type of owners - total';\n",
    "db_id": "number_of_plantations_in_swiss_forest",
    "generated_query": "SELECT\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%' AND year = 2020\n       THEN number_of_plantations ELSE 0 END) / \n   SUM(CASE WHEN year = 2020 THEN number_of_plantations ELSE 0 END)) * 100 AS proportion_deciduous_forests_2020,\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%' AND year = 2020\n       THEN number_of_plantations ELSE 0 END) / \n   SUM(CASE WHEN year = 2020 THEN number_of_plantations ELSE 0 END)) * 100 AS proportion_coniferous_forests_2020\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.year = 2020\n  AND S.name = 'Switzerland'\n  AND T.forest_zone = 'Switzerland'\n  AND T.type_of_owner = 'Type of owners - total';",
    "meta_data": [
      {
        "question": "To which Forestzones belongs the canton Jura and how many plantations of Jura are located in that forest zone?",
        "query": "SELECT T.forest_zone as forest_zone_for_jura, SUM(T.number_of_plantations) AS number_of_plantations_canton_jura\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Jura%'\n  AND T.type_of_owner = 'Type of owners - total'\n  AND T.wood_species = 'Species - total'\n  AND T.forest_zone != 'Switzerland'\n  AND T.number_of_plantations != 0\nGROUP BY T.forest_zone\nHAVING SUM(T.number_of_plantations) != 0\nORDER BY number_of_plantations_canton_jura DESC;\n"
      },
      {
        "question": "Which cantons had in 2022 only public forests?",
        "query": "SELECT S.name_de as canton\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.type_of_owner = 'Private forest'\n  AND T.year = 2022\nGROUP BY S.name_de\nHAVING SUM(T.number_of_plantations) = 0;\n"
      },
      {
        "question": "To which Forestzones belongs the canton Jura and how many plantations of Jura are located in that forest zone?",
        "query": "SELECT T.forest_zone as forest_zone_for_jura, SUM(T.number_of_plantations) AS number_of_plantations_canton_jura\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Jura%'\n  AND T.type_of_owner = 'Type of owners - total'\n  AND T.wood_species = 'Species - total'\n  AND T.forest_zone != 'Switzerland'\n  AND T.number_of_plantations != 0\nGROUP BY T.forest_zone\nHAVING SUM(T.number_of_plantations) != 0\nORDER BY number_of_plantations_canton_jura DESC;\n"
      },
      {
        "question": "To which Forestzones belongs the canton Jura and how many plantations of Jura are located in that forest zone?",
        "query": "SELECT T.forest_zone as forest_zone_for_jura, SUM(T.number_of_plantations) AS number_of_plantations_canton_jura\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Jura%'\n  AND T.type_of_owner = 'Type of owners - total'\n  AND T.wood_species = 'Species - total'\n  AND T.forest_zone != 'Switzerland'\n  AND T.number_of_plantations != 0\nGROUP BY T.forest_zone\nHAVING SUM(T.number_of_plantations) != 0\nORDER BY number_of_plantations_canton_jura DESC;\n"
      },
      {
        "question": "How many plantations in the \"Jura\" forest zone does each canton have by the latest count?",
        "query": "WITH MostRecentYear AS (\n  SELECT MAX(year) as most_recent_year\n  FROM number_of_plantations_in_swiss_forest WHERE type_of_owner = 'Type of owners - total'\n)\nSELECT\n  S.name_de as canton,\n  SUM(T.number_of_plantations) as number_of_plantations_in_jura\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nJOIN MostRecentYear AS ON T.year = MostRecentYear.most_recent_year\nWHERE S.canton = 'TRUE'\n  AND T.type_of_owner = 'Type of owners - total'\n  AND T.forest_zone = 'Jura'\n  AND T.number_of_plantations != 0 AND number_of_plantations IS NOT NULL\nGROUP BY S.name_de, MostRecentYear.most_recent_year\nORDER BY number_of_plantations_in_jura DESC;\n"
      },
      {
        "question": "Provide the change over the years of the total number of forests registered in Switzerland. The change should be given in percentage of the number of the previous year.",
        "query": "WITH PlantationsByYear AS (\n  SELECT T.year,\n    SUM(T.number_of_plantations) AS number_of_plantations_switzerland\n  FROM number_of_plantations_in_swiss_forest AS T\n  JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n  WHERE S.country = 'TRUE'\n    AND T.type_of_owner = 'Type of owners - total'\n    AND T.wood_species = 'Species - total'\n    AND T.forest_zone != 'Switzerland'\n    AND T.number_of_plantations != 0\n  GROUP BY T.year\n)\nSELECT\n  Curr.year,\n  Curr.number_of_plantations_switzerland,\n  ROUND(100 * (Curr.number_of_plantations_switzerland - Prev.number_of_plantations_switzerland) / (Prev.number_of_plantations_switzerland), 2) AS change_from_previous_year\nFROM PlantationsByYear AS Curr\nLEFT JOIN PlantationsByYear AS Prev ON Curr.year = Prev.year + 1\nORDER BY Curr.year DESC;\n"
      },
      {
        "question": "How much did the number of Swiss forest change from 1975 to 2022? Show the change in total and by forest type as conifers or deciduous.",
        "query": "SELECT\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_deciduous_number_of_forests_1975_to_2022,\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_conifers_number_of_forests_1975_to_2022,\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%total%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%total%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_total_number_of_forests_1975_to_2022\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.year IN (1975, 2022)\n  AND S.name = 'Switzerland'\n  AND T.forest_zone = 'Switzerland'\n  AND T.type_of_owner = 'Type of owners - total';\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.number_of_plantations_in_swiss_forest (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tforest_zone TEXT, \n\ttype_of_owner TEXT, \n\twood_species TEXT, \n\tnumber_of_plantations NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT number_of_plantations_in_swiss_forest_pkey PRIMARY KEY (uid), \n\tCONSTRAINT number_of_plantations_in_swiss_forest_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in number_of_plantations_in_swiss_forest and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nnumber_of_plantations : 16475, 377625, 44550, 27150, 340895\nspatialunit_uid : 0_CH, 25_A.ADM1, 22_A.ADM1, 2_A.ADM1, 23_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\nforest_zone, forest zone, Switzerland,Jura,Central Plain\ntype_of_owner, owner type, Type of owners - total,Public forest,Private forest\nwood_species, wood species group, Species - total,Hardwood (deciduous),Softwood (conifers)\nnumber_of_plantations, number of plantations, 14987125 ,11537284 ,3449841\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nTo which Forestzones belongs the canton Jura and how many plantations of Jura are located in that forest zone?\n### SQL query\nSELECT T.forest_zone as forest_zone_for_jura, SUM(T.number_of_plantations) AS number_of_plantations_canton_jura\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Jura%'\n  AND T.type_of_owner = 'Type of owners - total'\n  AND T.wood_species = 'Species - total'\n  AND T.forest_zone != 'Switzerland'\n  AND T.number_of_plantations != 0\nGROUP BY T.forest_zone\nHAVING SUM(T.number_of_plantations) != 0\nORDER BY number_of_plantations_canton_jura DESC;\n\n\n### Question\nWhich cantons had in 2022 only public forests?\n### SQL query\nSELECT S.name_de as canton\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.type_of_owner = 'Private forest'\n  AND T.year = 2022\nGROUP BY S.name_de\nHAVING SUM(T.number_of_plantations) = 0;\n\n\n### Question\nTo which Forestzones belongs the canton Jura and how many plantations of Jura are located in that forest zone?\n### SQL query\nSELECT T.forest_zone as forest_zone_for_jura, SUM(T.number_of_plantations) AS number_of_plantations_canton_jura\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Jura%'\n  AND T.type_of_owner = 'Type of owners - total'\n  AND T.wood_species = 'Species - total'\n  AND T.forest_zone != 'Switzerland'\n  AND T.number_of_plantations != 0\nGROUP BY T.forest_zone\nHAVING SUM(T.number_of_plantations) != 0\nORDER BY number_of_plantations_canton_jura DESC;\n\n\n### Question\nTo which Forestzones belongs the canton Jura and how many plantations of Jura are located in that forest zone?\n### SQL query\nSELECT T.forest_zone as forest_zone_for_jura, SUM(T.number_of_plantations) AS number_of_plantations_canton_jura\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Jura%'\n  AND T.type_of_owner = 'Type of owners - total'\n  AND T.wood_species = 'Species - total'\n  AND T.forest_zone != 'Switzerland'\n  AND T.number_of_plantations != 0\nGROUP BY T.forest_zone\nHAVING SUM(T.number_of_plantations) != 0\nORDER BY number_of_plantations_canton_jura DESC;\n\n\n### Question\nHow many plantations in the \"Jura\" forest zone does each canton have by the latest count?\n### SQL query\nWITH MostRecentYear AS (\n  SELECT MAX(year) as most_recent_year\n  FROM number_of_plantations_in_swiss_forest WHERE type_of_owner = 'Type of owners - total'\n)\nSELECT\n  S.name_de as canton,\n  SUM(T.number_of_plantations) as number_of_plantations_in_jura\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nJOIN MostRecentYear AS ON T.year = MostRecentYear.most_recent_year\nWHERE S.canton = 'TRUE'\n  AND T.type_of_owner = 'Type of owners - total'\n  AND T.forest_zone = 'Jura'\n  AND T.number_of_plantations != 0 AND number_of_plantations IS NOT NULL\nGROUP BY S.name_de, MostRecentYear.most_recent_year\nORDER BY number_of_plantations_in_jura DESC;\n\n\n### Question\nProvide the change over the years of the total number of forests registered in Switzerland. The change should be given in percentage of the number of the previous year.\n### SQL query\nWITH PlantationsByYear AS (\n  SELECT T.year,\n    SUM(T.number_of_plantations) AS number_of_plantations_switzerland\n  FROM number_of_plantations_in_swiss_forest AS T\n  JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n  WHERE S.country = 'TRUE'\n    AND T.type_of_owner = 'Type of owners - total'\n    AND T.wood_species = 'Species - total'\n    AND T.forest_zone != 'Switzerland'\n    AND T.number_of_plantations != 0\n  GROUP BY T.year\n)\nSELECT\n  Curr.year,\n  Curr.number_of_plantations_switzerland,\n  ROUND(100 * (Curr.number_of_plantations_switzerland - Prev.number_of_plantations_switzerland) / (Prev.number_of_plantations_switzerland), 2) AS change_from_previous_year\nFROM PlantationsByYear AS Curr\nLEFT JOIN PlantationsByYear AS Prev ON Curr.year = Prev.year + 1\nORDER BY Curr.year DESC;\n\n\n### Question\nHow much did the number of Swiss forest change from 1975 to 2022? Show the change in total and by forest type as conifers or deciduous.\n### SQL query\nSELECT\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%deciduous%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_deciduous_number_of_forests_1975_to_2022,\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%conifers%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_conifers_number_of_forests_1975_to_2022,\n  (SUM(CASE WHEN LOWER(wood_species) LIKE '%total%' AND year = 2022\n       THEN number_of_plantations ELSE 0 END) -\n   SUM(CASE WHEN LOWER(wood_species) LIKE '%total%' AND year = 1975\n       THEN number_of_plantations ELSE 0 END)) AS difference_total_number_of_forests_1975_to_2022\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.year IN (1975, 2022)\n  AND S.name = 'Switzerland'\n  AND T.forest_zone = 'Switzerland'\n  AND T.type_of_owner = 'Type of owners - total';\n\n\n### Question\nWhat were proportions, in percent, of deciduous and coniferous forests in Switzerland in 2020?\n### SQL query\n",
    "process_time": 22.03518897201866,
    "num_tokens": 2533,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 5,
    "question": "By 2022: Which three forest zones had the most plantations in Switzerland? Provide the forest zones together with the number of plantations.",
    "query": "SELECT T.forest_zone, SUM(T.number_of_plantations) as number_of_plantations\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.type_of_owner = 'Type of owners - total'\n  AND T.year = 2022\n  AND T.number_of_plantations != 0 AND number_of_plantations IS NOT NULL\n  AND T.forest_zone != 'Switzerland'\nGROUP BY T.forest_zone\nORDER BY number_of_plantations DESC LIMIT 3;\n",
    "db_id": "number_of_plantations_in_swiss_forest",
    "generated_query": "SELECT T.forest_zone, SUM(T.number_of_plantations) AS number_of_plantations\nFROM number_of_plantations_in_swiss_forest as T\nWHERE T.year = 2022\n  AND T.forest_zone != 'Switzerland'\n  AND T.number_of_plantations != 0\nGROUP BY T.forest_zone\nORDER BY number_of_plantations DESC\nLIMIT 3;",
    "meta_data": [
      {
        "question": "How many plantations in the \"Jura\" forest zone does each canton have by the latest count?",
        "query": "WITH MostRecentYear AS (\n  SELECT MAX(year) as most_recent_year\n  FROM number_of_plantations_in_swiss_forest WHERE type_of_owner = 'Type of owners - total'\n)\nSELECT\n  S.name_de as canton,\n  SUM(T.number_of_plantations) as number_of_plantations_in_jura\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nJOIN MostRecentYear AS ON T.year = MostRecentYear.most_recent_year\nWHERE S.canton = 'TRUE'\n  AND T.type_of_owner = 'Type of owners - total'\n  AND T.forest_zone = 'Jura'\n  AND T.number_of_plantations != 0 AND number_of_plantations IS NOT NULL\nGROUP BY S.name_de, MostRecentYear.most_recent_year\nORDER BY number_of_plantations_in_jura DESC;\n"
      },
      {
        "question": "To which Forestzones belongs the canton Jura and how many plantations of Jura are located in that forest zone?",
        "query": "SELECT T.forest_zone as forest_zone_for_jura, SUM(T.number_of_plantations) AS number_of_plantations_canton_jura\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Jura%'\n  AND T.type_of_owner = 'Type of owners - total'\n  AND T.wood_species = 'Species - total'\n  AND T.forest_zone != 'Switzerland'\n  AND T.number_of_plantations != 0\nGROUP BY T.forest_zone\nHAVING SUM(T.number_of_plantations) != 0\nORDER BY number_of_plantations_canton_jura DESC;\n"
      },
      {
        "question": "Which cantons had in 2022 only public forests?",
        "query": "SELECT S.name_de as canton\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.type_of_owner = 'Private forest'\n  AND T.year = 2022\nGROUP BY S.name_de\nHAVING SUM(T.number_of_plantations) = 0;\n"
      },
      {
        "question": "Provide the change over the years of the total number of forests registered in Switzerland. The change should be given in percentage of the number of the previous year.",
        "query": "WITH PlantationsByYear AS (\n  SELECT T.year,\n    SUM(T.number_of_plantations) AS number_of_plantations_switzerland\n  FROM number_of_plantations_in_swiss_forest AS T\n  JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n  WHERE S.country = 'TRUE'\n    AND T.type_of_owner = 'Type of owners - total'\n    AND T.wood_species = 'Species - total'\n    AND T.forest_zone != 'Switzerland'\n    AND T.number_of_plantations != 0\n  GROUP BY T.year\n)\nSELECT\n  Curr.year,\n  Curr.number_of_plantations_switzerland,\n  ROUND(100 * (Curr.number_of_plantations_switzerland - Prev.number_of_plantations_switzerland) / (Prev.number_of_plantations_switzerland), 2) AS change_from_previous_year\nFROM PlantationsByYear AS Curr\nLEFT JOIN PlantationsByYear AS Prev ON Curr.year = Prev.year + 1\nORDER BY Curr.year DESC;\n"
      },
      {
        "question": "Which cantons had in 2022 only public forests?",
        "query": "SELECT S.name_de as canton\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.type_of_owner = 'Private forest'\n  AND T.year = 2022\nGROUP BY S.name_de\nHAVING SUM(T.number_of_plantations) = 0;\n"
      },
      {
        "question": "Which cantons had in 2022 only public forests?",
        "query": "SELECT S.name_de as canton\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.type_of_owner = 'Private forest'\n  AND T.year = 2022\nGROUP BY S.name_de\nHAVING SUM(T.number_of_plantations) = 0;\n"
      },
      {
        "question": "Which canton had the most private forests in 2019?",
        "query": "SELECT S.name as canton\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.year = 2019\n  AND T.forest_zone = 'Switzerland'\n  AND T.wood_species = 'Species - total'\n  AND T.type_of_owner = 'Private forest'\nORDER BY number_of_plantations DESC LIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.number_of_plantations_in_swiss_forest (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tforest_zone TEXT, \n\ttype_of_owner TEXT, \n\twood_species TEXT, \n\tnumber_of_plantations NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT number_of_plantations_in_swiss_forest_pkey PRIMARY KEY (uid), \n\tCONSTRAINT number_of_plantations_in_swiss_forest_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in number_of_plantations_in_swiss_forest and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nnumber_of_plantations : 16475, 377625, 44550, 27150, 340895\nspatialunit_uid : 0_CH, 25_A.ADM1, 22_A.ADM1, 2_A.ADM1, 23_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\nforest_zone, forest zone, Switzerland,Jura,Central Plain\ntype_of_owner, owner type, Type of owners - total,Public forest,Private forest\nwood_species, wood species group, Species - total,Hardwood (deciduous),Softwood (conifers)\nnumber_of_plantations, number of plantations, 14987125 ,11537284 ,3449841\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nHow many plantations in the \"Jura\" forest zone does each canton have by the latest count?\n### SQL query\nWITH MostRecentYear AS (\n  SELECT MAX(year) as most_recent_year\n  FROM number_of_plantations_in_swiss_forest WHERE type_of_owner = 'Type of owners - total'\n)\nSELECT\n  S.name_de as canton,\n  SUM(T.number_of_plantations) as number_of_plantations_in_jura\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nJOIN MostRecentYear AS ON T.year = MostRecentYear.most_recent_year\nWHERE S.canton = 'TRUE'\n  AND T.type_of_owner = 'Type of owners - total'\n  AND T.forest_zone = 'Jura'\n  AND T.number_of_plantations != 0 AND number_of_plantations IS NOT NULL\nGROUP BY S.name_de, MostRecentYear.most_recent_year\nORDER BY number_of_plantations_in_jura DESC;\n\n\n### Question\nTo which Forestzones belongs the canton Jura and how many plantations of Jura are located in that forest zone?\n### SQL query\nSELECT T.forest_zone as forest_zone_for_jura, SUM(T.number_of_plantations) AS number_of_plantations_canton_jura\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Jura%'\n  AND T.type_of_owner = 'Type of owners - total'\n  AND T.wood_species = 'Species - total'\n  AND T.forest_zone != 'Switzerland'\n  AND T.number_of_plantations != 0\nGROUP BY T.forest_zone\nHAVING SUM(T.number_of_plantations) != 0\nORDER BY number_of_plantations_canton_jura DESC;\n\n\n### Question\nWhich cantons had in 2022 only public forests?\n### SQL query\nSELECT S.name_de as canton\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.type_of_owner = 'Private forest'\n  AND T.year = 2022\nGROUP BY S.name_de\nHAVING SUM(T.number_of_plantations) = 0;\n\n\n### Question\nProvide the change over the years of the total number of forests registered in Switzerland. The change should be given in percentage of the number of the previous year.\n### SQL query\nWITH PlantationsByYear AS (\n  SELECT T.year,\n    SUM(T.number_of_plantations) AS number_of_plantations_switzerland\n  FROM number_of_plantations_in_swiss_forest AS T\n  JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n  WHERE S.country = 'TRUE'\n    AND T.type_of_owner = 'Type of owners - total'\n    AND T.wood_species = 'Species - total'\n    AND T.forest_zone != 'Switzerland'\n    AND T.number_of_plantations != 0\n  GROUP BY T.year\n)\nSELECT\n  Curr.year,\n  Curr.number_of_plantations_switzerland,\n  ROUND(100 * (Curr.number_of_plantations_switzerland - Prev.number_of_plantations_switzerland) / (Prev.number_of_plantations_switzerland), 2) AS change_from_previous_year\nFROM PlantationsByYear AS Curr\nLEFT JOIN PlantationsByYear AS Prev ON Curr.year = Prev.year + 1\nORDER BY Curr.year DESC;\n\n\n### Question\nWhich cantons had in 2022 only public forests?\n### SQL query\nSELECT S.name_de as canton\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.type_of_owner = 'Private forest'\n  AND T.year = 2022\nGROUP BY S.name_de\nHAVING SUM(T.number_of_plantations) = 0;\n\n\n### Question\nWhich cantons had in 2022 only public forests?\n### SQL query\nSELECT S.name_de as canton\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.type_of_owner = 'Private forest'\n  AND T.year = 2022\nGROUP BY S.name_de\nHAVING SUM(T.number_of_plantations) = 0;\n\n\n### Question\nWhich canton had the most private forests in 2019?\n### SQL query\nSELECT S.name as canton\nFROM number_of_plantations_in_swiss_forest as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.year = 2019\n  AND T.forest_zone = 'Switzerland'\n  AND T.wood_species = 'Species - total'\n  AND T.type_of_owner = 'Private forest'\nORDER BY number_of_plantations DESC LIMIT 1;\n\n\n### Question\nBy 2022: Which three forest zones had the most plantations in Switzerland? Provide the forest zones together with the number of plantations.\n### SQL query\n",
    "process_time": 10.418376887915656,
    "num_tokens": 2099,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 6,
    "question": "How many FTE were allocated to tourism were there in Switzerland 2019?",
    "query": "SELECT T.total_full_time_employment_of_tourism\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND S.name = 'Switzerland'\n    AND T.year = 2019;\n",
    "db_id": "tourism_economy_by_canton",
    "generated_query": "SELECT\n    SUM(total_full_time_employment_of_tourism) AS total_fte_tourism_switzerland_2019\nFROM tourism_economy_by_canton\nWHERE year = 2019;",
    "meta_data": [
      {
        "question": "What canton lost the highest share of revenue from tourism between 2016 and 2019, and what percentage did it lose?",
        "query": "SELECT\n    S.name AS canton,\n    SUM(CASE WHEN T.year = 2019 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) -\n    SUM(CASE WHEN T.year = 2016 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) AS diff_percentage_gross_value_added_of_tourism_2019_2016\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year IN (2016, 2019)\nGROUP BY S.name\nORDER BY diff_percentage_gross_value_added_of_tourism_2019_2016 ASC\nLIMIT 1;\n"
      },
      {
        "question": "What percentage of full time employment was allocated in canton Zurich between 2017 and 2019?",
        "query": "SELECT T.year, T.percent_share_full_time_employment_of_tourism as percent_share_fte_tourism_canton_zurich\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.year >= 2017\n    AND T.year <= 2019;\n"
      },
      {
        "question": "What canton lost the highest share of revenue from tourism between 2016 and 2019, and what percentage did it lose?",
        "query": "SELECT\n    S.name AS canton,\n    SUM(CASE WHEN T.year = 2019 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) -\n    SUM(CASE WHEN T.year = 2016 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) AS diff_percentage_gross_value_added_of_tourism_2019_2016\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year IN (2016, 2019)\nGROUP BY S.name\nORDER BY diff_percentage_gross_value_added_of_tourism_2019_2016 ASC\nLIMIT 1;\n"
      },
      {
        "question": "What canton lost the highest share of revenue from tourism between 2016 and 2019, and what percentage did it lose?",
        "query": "SELECT\n    S.name AS canton,\n    SUM(CASE WHEN T.year = 2019 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) -\n    SUM(CASE WHEN T.year = 2016 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) AS diff_percentage_gross_value_added_of_tourism_2019_2016\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year IN (2016, 2019)\nGROUP BY S.name\nORDER BY diff_percentage_gross_value_added_of_tourism_2019_2016 ASC\nLIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.tourism_economy_by_canton (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tmio_chf_gross_value_added_of_tourism NUMERIC, \n\tpercent_share_gross_value_added_of_tourism NUMERIC, \n\ttotal_full_time_employment_of_tourism NUMERIC, \n\tpercent_share_full_time_employment_of_tourism NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT tourism_economy_by_canton_pkey PRIMARY KEY (uid), \n\tCONSTRAINT tourism_economy_by_canton_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in tourism_economy_by_canton and 5 examples in each column for high cardinality columns :\nuid : 72, 29, 88, 28, 57\nmio_chf_gross_value_added_of_tourism : 195.419999999999987, 100.430000000000007, 95.780000000000001, 1425.700000000000045, 1537.519999999999982\npercent_share_gross_value_added_of_tourism : 1.44999999999999996, 1.20999999999999996, 3.66999999999999993, 2.50999999999999979, 5.01999999999999957\ntotal_full_time_employment_of_tourism : 1630.50999999999999, 797.47000000000003, 12727.17000000000007, 1470.56999999999994, 720.45000000000005\npercent_share_full_time_employment_of_tourism : 13.8000000000000007, 4.9900000000000002, 2.5000000000000000, 2.9600000000000000, 2.3100000000000001\nspatialunit_uid : 0_CH, 25_A.ADM1, 22_A.ADM1, 2_A.ADM1, 23_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\nmio_chf_gross_value_added_of_tourism, Amount in million CHF of Gross Value that was added by tourism, None\npercent_share_gross_value_added_of_tourism, Percentage share of Gross Value that was added by tourism, None\ntotal_full_time_employment_of_tourism, Full time employment in Tourism, None\npercent_share_full_time_employment_of_tourism, Percentage share of full time employment in tourism, None\n*/\n\n\n\n### Question\nWhat canton lost the highest share of revenue from tourism between 2016 and 2019, and what percentage did it lose?\n### SQL query\nSELECT\n    S.name AS canton,\n    SUM(CASE WHEN T.year = 2019 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) -\n    SUM(CASE WHEN T.year = 2016 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) AS diff_percentage_gross_value_added_of_tourism_2019_2016\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year IN (2016, 2019)\nGROUP BY S.name\nORDER BY diff_percentage_gross_value_added_of_tourism_2019_2016 ASC\nLIMIT 1;\n\n\n### Question\nWhat percentage of full time employment was allocated in canton Zurich between 2017 and 2019?\n### SQL query\nSELECT T.year, T.percent_share_full_time_employment_of_tourism as percent_share_fte_tourism_canton_zurich\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.year >= 2017\n    AND T.year <= 2019;\n\n\n### Question\nWhat canton lost the highest share of revenue from tourism between 2016 and 2019, and what percentage did it lose?\n### SQL query\nSELECT\n    S.name AS canton,\n    SUM(CASE WHEN T.year = 2019 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) -\n    SUM(CASE WHEN T.year = 2016 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) AS diff_percentage_gross_value_added_of_tourism_2019_2016\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year IN (2016, 2019)\nGROUP BY S.name\nORDER BY diff_percentage_gross_value_added_of_tourism_2019_2016 ASC\nLIMIT 1;\n\n\n### Question\nWhat canton lost the highest share of revenue from tourism between 2016 and 2019, and what percentage did it lose?\n### SQL query\nSELECT\n    S.name AS canton,\n    SUM(CASE WHEN T.year = 2019 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) -\n    SUM(CASE WHEN T.year = 2016 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) AS diff_percentage_gross_value_added_of_tourism_2019_2016\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year IN (2016, 2019)\nGROUP BY S.name\nORDER BY diff_percentage_gross_value_added_of_tourism_2019_2016 ASC\nLIMIT 1;\n\n\n### Question\nHow many FTE were allocated to tourism were there in Switzerland 2019?\n### SQL query\n",
    "process_time": 3.421106123132631,
    "num_tokens": 1917,
    "hardness": "medium",
    "scores": [
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 7,
    "question": "Which canton has the most employees in the tourism sector in 2019?",
    "query": "SELECT S.name AS canton\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2019\nORDER BY T.total_full_time_employment_of_tourism DESC LIMIT 1;\n",
    "db_id": "tourism_economy_by_canton",
    "generated_query": "SELECT S.name as canton,\nT.total_full_time_employment_of_tourism as total_fte_tourism_2019\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2019\nORDER BY total_fte_tourism_2019 DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "What canton lost the highest share of revenue from tourism between 2016 and 2019, and what percentage did it lose?",
        "query": "SELECT\n    S.name AS canton,\n    SUM(CASE WHEN T.year = 2019 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) -\n    SUM(CASE WHEN T.year = 2016 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) AS diff_percentage_gross_value_added_of_tourism_2019_2016\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year IN (2016, 2019)\nGROUP BY S.name\nORDER BY diff_percentage_gross_value_added_of_tourism_2019_2016 ASC\nLIMIT 1;\n"
      },
      {
        "question": "What percentage of full time employment was allocated in canton Zurich between 2017 and 2019?",
        "query": "SELECT T.year, T.percent_share_full_time_employment_of_tourism as percent_share_fte_tourism_canton_zurich\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.year >= 2017\n    AND T.year <= 2019;\n"
      },
      {
        "question": "How much did each canton earn from tourism in 2019?",
        "query": "SELECT S.name as canton,\nT.mio_chf_gross_value_added_of_tourism as mio_chf_gross_value_added_of_tourism_2019\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2019\nORDER BY mio_chf_gross_value_added_of_tourism_2019 DESC;\n"
      },
      {
        "question": "What percentage of full time employment was allocated in canton Zurich between 2017 and 2019?",
        "query": "SELECT T.year, T.percent_share_full_time_employment_of_tourism as percent_share_fte_tourism_canton_zurich\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.year >= 2017\n    AND T.year <= 2019;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.tourism_economy_by_canton (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tmio_chf_gross_value_added_of_tourism NUMERIC, \n\tpercent_share_gross_value_added_of_tourism NUMERIC, \n\ttotal_full_time_employment_of_tourism NUMERIC, \n\tpercent_share_full_time_employment_of_tourism NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT tourism_economy_by_canton_pkey PRIMARY KEY (uid), \n\tCONSTRAINT tourism_economy_by_canton_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in tourism_economy_by_canton and 5 examples in each column for high cardinality columns :\nuid : 72, 29, 88, 28, 57\nmio_chf_gross_value_added_of_tourism : 195.419999999999987, 100.430000000000007, 95.780000000000001, 1425.700000000000045, 1537.519999999999982\npercent_share_gross_value_added_of_tourism : 1.44999999999999996, 1.20999999999999996, 3.66999999999999993, 2.50999999999999979, 5.01999999999999957\ntotal_full_time_employment_of_tourism : 1630.50999999999999, 797.47000000000003, 12727.17000000000007, 1470.56999999999994, 720.45000000000005\npercent_share_full_time_employment_of_tourism : 13.8000000000000007, 4.9900000000000002, 2.5000000000000000, 2.9600000000000000, 2.3100000000000001\nspatialunit_uid : 0_CH, 25_A.ADM1, 22_A.ADM1, 2_A.ADM1, 23_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\nmio_chf_gross_value_added_of_tourism, Amount in million CHF of Gross Value that was added by tourism, None\npercent_share_gross_value_added_of_tourism, Percentage share of Gross Value that was added by tourism, None\ntotal_full_time_employment_of_tourism, Full time employment in Tourism, None\npercent_share_full_time_employment_of_tourism, Percentage share of full time employment in tourism, None\n*/\n\n\n\n### Question\nWhat canton lost the highest share of revenue from tourism between 2016 and 2019, and what percentage did it lose?\n### SQL query\nSELECT\n    S.name AS canton,\n    SUM(CASE WHEN T.year = 2019 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) -\n    SUM(CASE WHEN T.year = 2016 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) AS diff_percentage_gross_value_added_of_tourism_2019_2016\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year IN (2016, 2019)\nGROUP BY S.name\nORDER BY diff_percentage_gross_value_added_of_tourism_2019_2016 ASC\nLIMIT 1;\n\n\n### Question\nWhat percentage of full time employment was allocated in canton Zurich between 2017 and 2019?\n### SQL query\nSELECT T.year, T.percent_share_full_time_employment_of_tourism as percent_share_fte_tourism_canton_zurich\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.year >= 2017\n    AND T.year <= 2019;\n\n\n### Question\nHow much did each canton earn from tourism in 2019?\n### SQL query\nSELECT S.name as canton,\nT.mio_chf_gross_value_added_of_tourism as mio_chf_gross_value_added_of_tourism_2019\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2019\nORDER BY mio_chf_gross_value_added_of_tourism_2019 DESC;\n\n\n### Question\nWhat percentage of full time employment was allocated in canton Zurich between 2017 and 2019?\n### SQL query\nSELECT T.year, T.percent_share_full_time_employment_of_tourism as percent_share_fte_tourism_canton_zurich\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.year >= 2017\n    AND T.year <= 2019;\n\n\n### Question\nWhich canton has the most employees in the tourism sector in 2019?\n### SQL query\n",
    "process_time": 10.717661888105795,
    "num_tokens": 1766,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 8,
    "question": "What canton got the most money from tourism in 2016?",
    "query": "SELECT S.name AS canton\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2016\nORDER BY T.mio_chf_gross_value_added_of_tourism DESC LIMIT 1;\n",
    "db_id": "tourism_economy_by_canton",
    "generated_query": "SELECT S.name as canton, T.mio_chf_gross_value_added_of_tourism\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2016\nORDER BY T.mio_chf_gross_value_added_of_tourism DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "What percentage of full time employment was allocated in canton Zurich between 2017 and 2019?",
        "query": "SELECT T.year, T.percent_share_full_time_employment_of_tourism as percent_share_fte_tourism_canton_zurich\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.year >= 2017\n    AND T.year <= 2019;\n"
      },
      {
        "question": "What canton lost the highest share of revenue from tourism between 2016 and 2019, and what percentage did it lose?",
        "query": "SELECT\n    S.name AS canton,\n    SUM(CASE WHEN T.year = 2019 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) -\n    SUM(CASE WHEN T.year = 2016 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) AS diff_percentage_gross_value_added_of_tourism_2019_2016\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year IN (2016, 2019)\nGROUP BY S.name\nORDER BY diff_percentage_gross_value_added_of_tourism_2019_2016 ASC\nLIMIT 1;\n"
      },
      {
        "question": "What percentage of full time employment was allocated in canton Zurich between 2017 and 2019?",
        "query": "SELECT T.year, T.percent_share_full_time_employment_of_tourism as percent_share_fte_tourism_canton_zurich\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.year >= 2017\n    AND T.year <= 2019;\n"
      },
      {
        "question": "What was the percent of gross value added for tourism in the cantons of Zurich, Bern and Geneva in 2017?",
        "query": "SELECT S.name as canton, T.percent_share_gross_value_added_of_tourism\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2017\n    AND (\n        S.name LIKE '%Zurich%'\n        OR S.name LIKE '%Geneva%'\n        OR S.name LIKE '%Bern%'\n    );\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.tourism_economy_by_canton (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tmio_chf_gross_value_added_of_tourism NUMERIC, \n\tpercent_share_gross_value_added_of_tourism NUMERIC, \n\ttotal_full_time_employment_of_tourism NUMERIC, \n\tpercent_share_full_time_employment_of_tourism NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT tourism_economy_by_canton_pkey PRIMARY KEY (uid), \n\tCONSTRAINT tourism_economy_by_canton_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in tourism_economy_by_canton and 5 examples in each column for high cardinality columns :\nuid : 72, 29, 88, 28, 57\nmio_chf_gross_value_added_of_tourism : 195.419999999999987, 100.430000000000007, 95.780000000000001, 1425.700000000000045, 1537.519999999999982\npercent_share_gross_value_added_of_tourism : 1.44999999999999996, 1.20999999999999996, 3.66999999999999993, 2.50999999999999979, 5.01999999999999957\ntotal_full_time_employment_of_tourism : 1630.50999999999999, 797.47000000000003, 12727.17000000000007, 1470.56999999999994, 720.45000000000005\npercent_share_full_time_employment_of_tourism : 13.8000000000000007, 4.9900000000000002, 2.5000000000000000, 2.9600000000000000, 2.3100000000000001\nspatialunit_uid : 0_CH, 25_A.ADM1, 22_A.ADM1, 2_A.ADM1, 23_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\nmio_chf_gross_value_added_of_tourism, Amount in million CHF of Gross Value that was added by tourism, None\npercent_share_gross_value_added_of_tourism, Percentage share of Gross Value that was added by tourism, None\ntotal_full_time_employment_of_tourism, Full time employment in Tourism, None\npercent_share_full_time_employment_of_tourism, Percentage share of full time employment in tourism, None\n*/\n\n\n\n### Question\nWhat percentage of full time employment was allocated in canton Zurich between 2017 and 2019?\n### SQL query\nSELECT T.year, T.percent_share_full_time_employment_of_tourism as percent_share_fte_tourism_canton_zurich\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.year >= 2017\n    AND T.year <= 2019;\n\n\n### Question\nWhat canton lost the highest share of revenue from tourism between 2016 and 2019, and what percentage did it lose?\n### SQL query\nSELECT\n    S.name AS canton,\n    SUM(CASE WHEN T.year = 2019 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) -\n    SUM(CASE WHEN T.year = 2016 THEN T.percent_share_gross_value_added_of_tourism ELSE 0 END) AS diff_percentage_gross_value_added_of_tourism_2019_2016\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year IN (2016, 2019)\nGROUP BY S.name\nORDER BY diff_percentage_gross_value_added_of_tourism_2019_2016 ASC\nLIMIT 1;\n\n\n### Question\nWhat percentage of full time employment was allocated in canton Zurich between 2017 and 2019?\n### SQL query\nSELECT T.year, T.percent_share_full_time_employment_of_tourism as percent_share_fte_tourism_canton_zurich\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.year >= 2017\n    AND T.year <= 2019;\n\n\n### Question\nWhat was the percent of gross value added for tourism in the cantons of Zurich, Bern and Geneva in 2017?\n### SQL query\nSELECT S.name as canton, T.percent_share_gross_value_added_of_tourism\nFROM tourism_economy_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2017\n    AND (\n        S.name LIKE '%Zurich%'\n        OR S.name LIKE '%Geneva%'\n        OR S.name LIKE '%Bern%'\n    );\n\n\n### Question\nWhat canton got the most money from tourism in 2016?\n### SQL query\n",
    "process_time": 5.295246529858559,
    "num_tokens": 1771,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 9,
    "question": "What kind of animal farms existed in Kanton Uri in 2012? Give the number of each farm type.",
    "query": "SELECT beef_cattle_and_cows_farm, horse_and_other_equine_farm,\n  sheep_farm, goat_farm, pig_farms, poultry_farm, farms_with_other_animals\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Uri%'\n    AND S.canton = 'TRUE'\n    AND T.year = 2012\n    AND T.farmholding_system = 'Farmholding system - total';\n",
    "db_id": "employees_farmholdings_agricultural_area_livestock_per_canton",
    "generated_query": "SELECT livestock_beef_cattle_and_cows as number_of_beef_cattle_and_cows_farms,\n  livestock_horses_and_other_equines as number_of_horse_and_other_equine_farms,\n  livestock_sheep as number_of_sheep_farms,\n  livestock_goats as number_of_goat_farms,\n  livestock_pigs as number_of_pig_farms,\n  livestock_poultry as number_of_poultry_farms,\n  livestock_other_animals as number_of_farms_with_other_animals\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Uri'\n    AND year = 2012\n    AND T.farmholding_system = 'Farmholding system - total';",
    "meta_data": [
      {
        "question": "How was the split between Swiss population and foreign nationals on Swiss farms in 2022?",
        "query": "SELECT ROUND(100 * employees_swiss / employees_total, 2) AS percentage_of_swiss_employees,\n  ROUND(100 * employees_foreign_nationals / employees_total, 2) AS percentage_foreign_nationals_employees\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total';\n"
      },
      {
        "question": "Which 5 cantons had in 2022 the biggest precentage of their farm area used by organic farming? Order by the percentage of area used for organic farming.",
        "query": "SELECT S.name,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) /\n   NULLIF(SUM(CASE WHEN T.farmholding_system = 'Farmholding system - total'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END), 0), 2) AS percentage_of_organically_used_farmarea\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.canton = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Farmholding system - total')\nGROUP BY S.name\nORDER BY percentage_of_organically_used_farmarea DESC LIMIT 5;\n"
      },
      {
        "question": "What were the 5 cantons farming the most pigs in 2012?",
        "query": "SELECT S.name as canton_name, livestock_pigs as total_pigs\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2012\n    AND T.farmholding_system = 'Farmholding system - total'\nORDER BY livestock_pigs DESC\nLIMIT 5;\n"
      },
      {
        "question": "What was the precentage of family employees in organic and conventional farming in 2022?",
        "query": "SELECT\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.family_employees ELSE 0 END) /\n   SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.employees_total ELSE 0 END), 2) AS percentage_family_employees_organic_farming,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Conventional farming'\n       THEN T.family_employees ELSE 0 END) /\n   SUM(CASE WHEN T.farmholding_system = 'Conventional farming'\n       THEN T.employees_total ELSE 0 END), 2) AS percentage_family_employees_conventional_farming\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n"
      },
      {
        "question": "What were the 5 cantons farming the most pigs in 2012?",
        "query": "SELECT S.name as canton_name, livestock_pigs as total_pigs\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2012\n    AND T.farmholding_system = 'Farmholding system - total'\nORDER BY livestock_pigs DESC\nLIMIT 5;\n"
      },
      {
        "question": "Does the average organic farm have less employees than the average non-organic farm in 2022?",
        "query": "SELECT farmholding_system, employees_total / farmholdings AS average_employees_per_farm\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.name = 'Switzerland'\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n"
      },
      {
        "question": "Which five cantons had in 2022 the highest percentage of women farmers in mangement position? Also provide the precentage of women who had a manager position.",
        "query": "SELECT S.name as canton,\n  ROUND(100 * SUM(T.employees_women_manager_label) / SUM(T.employees_women), 2) AS percentage_women_managers\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total'\nGROUP BY S.name\nORDER BY percentage_women_managers DESC\nLIMIT 5;\n"
      },
      {
        "question": "How was the split between Swiss population and foreign nationals on Swiss farms in 2022?",
        "query": "SELECT ROUND(100 * employees_swiss / employees_total, 2) AS percentage_of_swiss_employees,\n  ROUND(100 * employees_foreign_nationals / employees_total, 2) AS percentage_foreign_nationals_employees\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total';\n"
      },
      {
        "question": "Which 5 cantons had in 2022 the biggest precentage of their farm area used by organic farming? Order by the percentage of area used for organic farming.",
        "query": "SELECT S.name,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) /\n   NULLIF(SUM(CASE WHEN T.farmholding_system = 'Farmholding system - total'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END), 0), 2) AS percentage_of_organically_used_farmarea\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.canton = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Farmholding system - total')\nGROUP BY S.name\nORDER BY percentage_of_organically_used_farmarea DESC LIMIT 5;\n"
      },
      {
        "question": "How was the split between Swiss population and foreign nationals on Swiss farms in 2022?",
        "query": "SELECT ROUND(100 * employees_swiss / employees_total, 2) AS percentage_of_swiss_employees,\n  ROUND(100 * employees_foreign_nationals / employees_total, 2) AS percentage_foreign_nationals_employees\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total';\n"
      },
      {
        "question": "What are the percentages of part time work in Organic Farming?",
        "query": "SELECT ROUND(100 * full_time_employees_75_percent_or_more / employees_total, 2) AS precentage_75_percent_and_above,\n  ROUND(100 * part_time_employees_50_75_percent / employees_total, 2) AS percentage_of_between_50_and_75_percent,\n  ROUND(100 * part_time_employees_50_75_percent / employees_total, 2) AS percentage_below_50_precent\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2015\n    AND T.farmholding_system = 'Organic farming';\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.employees_farmholdings_agricultural_area_livestock_per_canton (\n\tuid SERIAL NOT NULL, \n\tfarmholding_system TEXT, \n\tyear INTEGER, \n\tfarmholdings NUMERIC, \n\temployees_total NUMERIC, \n\tfull_time_employees_75_percent_or_more NUMERIC, \n\tpart_time_employees_50_75_percent NUMERIC, \n\tpart_time_employees_2_less_than_50_percent NUMERIC, \n\temployees_men NUMERIC, \n\temployees_women NUMERIC, \n\temployees_women_manager_label NUMERIC, \n\temployees_swiss NUMERIC, \n\temployees_foreign_nationals NUMERIC, \n\tfamily_employees NUMERIC, \n\tbeef_cattle_and_cows_farm NUMERIC, \n\thorse_and_other_equine_farm NUMERIC, \n\tsheep_farm NUMERIC, \n\tgoat_farm NUMERIC, \n\tpig_farms NUMERIC, \n\tpoultry_farm NUMERIC, \n\tfarms_with_other_animals NUMERIC, \n\tutilised_agricultural_area_in_hectares NUMERIC, \n\tarable_land_in_hectares NUMERIC, \n\tgrassland_in_hectares NUMERIC, \n\tpermanent_crops_in_hectares NUMERIC, \n\tother_utilised_agricultural_area_in_hectares NUMERIC, \n\tlivestock_beef_cattle_and_cows NUMERIC, \n\tlivestock_horses_and_other_equines NUMERIC, \n\tlivestock_sheep NUMERIC, \n\tlivestock_goats NUMERIC, \n\tlivestock_pigs NUMERIC, \n\tlivestock_poultry NUMERIC, \n\tlivestock_other_animals NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT employees_farmholdings_agricultural_area_livestock_per_can_pkey PRIMARY KEY (uid), \n\tCONSTRAINT employees_farmholdings_agricultural_area_l_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in employees_farmholdings_agricultural_area_livestock_per_canton and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nyear : 2015, 2009, 2000, 2012, 2019\nfarmholdings : 3300, 412, 3149, 348, 51860\nemployees_total : 13632, 189566, 225149, 17343, 149521\nfull_time_employees_75_percent_or_more : 5316, 72633, 70625, 80436, 4937\npart_time_employees_50_75_percent : 2056, 2277, 41165, 2120, 37276\npart_time_employees_2_less_than_50_percent : 51446, 4005, 3014, 4506, 3404\nemployees_men : 144280, 839, 125547, 98822, 5275\nemployees_women : 71887, 459, 54872, 7197, 3312\nemployees_women_manager_label : 1393, 192, 2560, 412, 459\nemployees_swiss : 140137, 17057, 140683, 11125, 9677\nemployees_foreign_nationals : 17032, 1510, 1025, 870, 1146\nfamily_employees : 928, 1053, 9874, 823, 180894\nbeef_cattle_and_cows_farm : 5242, 252, 235, 4937, 3103\nhorse_and_other_equine_farm : 12225, 127, 839, 870, 115\nsheep_farm : 11399, 72, 291, 88, 335\ngoat_farm : 5076, 8496, 8083, 5151, 8168\npig_farms : 235, 252, 291, 136, 333\npoultry_farm : 1800, 2163, 2033, 11387, 1608\nfarms_with_other_animals : 72, 6098, 57, 348, 358\nutilised_agricultural_area_in_hectares : 76523.139999999999418, 935676.880299999960698, 67243.500000000000000, 67686.110000000000582, 1082876.239999999990687\narable_land_in_hectares : 4430.869999999999890861, 269648.469999999972060323, 279671.130000000004656613, 28704.027600000001257285, 30115.979999999999563443\ngrassland_in_hectares : 4136.470000000000255, 39994.673999999999069, 4332.409999999999854, 38283.739999999997963, 98902.110000000000582\npermanent_crops_in_hectares : 21936.409999999999854481, 1407.559999999999945430, 23116.000000000000000000, 1321.730000000000018190, 22537.479999999999563443\nother_utilised_agricultural_area_in_hectares : 1630.089999999999918145, 1998.039999999999963620, 11233.479999999999563443, 12720.547099999999772990, 9423.579999999999927240\nlivestock_beef_cattle_and_cows : 160950, 1427327, 1544612, 95020, 9387\nlivestock_horses_and_other_equines : 75864, 69723, 68180, 10577, 6035\nlivestock_sheep : 263861, 11709, 256902, 329033, 417274\nlivestock_goats : 66007, 2226, 67416, 2192, 333\nlivestock_pigs : 42366, 31885, 1468313, 559, 1544017\nlivestock_poultry : 360738, 327285, 34710, 10824616, 342966\nlivestock_other_animals : 481, 81566, 4893, 111801, 9194\n*/\n\n/*\nColumn name, Column discription, Example values\nfarmholding_system, None, Farmholding system - total,Organic farming,Conventional farming\nfarmholdings, None, 48344,48864,49363\nemployees_total, None, 149578,150231,149521\nfull_time_employees_75_percent_or_more, None, 66349,66453,66333\npart_time_employees_50_75_percent, None, 30083,30038,29920\npart_time_employees_2_less_than_50_percent, None, 53146,53740,53268\nemployees_men, None, 94706,95486,95252\nemployees_women, None, 54872,54745,54269\nemployees_women_manager_label, None, 3472,3362,3233\nemployees_swiss, None, 131072,131955,131581\nemployees_foreign_nationals, None, 18506,18276,17940\nfamily_employees, None, 112047,113317,113847\nbeef_cattle_and_cows_farm, None, 32581,33091,33662\nhorse_and_other_equine_farm, None, 11123,11196,11227\nsheep_farm, None, 7969,7977,8016\ngoat_farm, None, 6559,6592,6355\npig_farms, None, 5467,5561,5600\npoultry_farm, None, 14876,14434,13485\nfarms_with_other_animals, None, 6138,6101,6000\nutilised_agricultural_area_in_hectares, None, 1042013.785,1042053.004,1044033.706\narable_land_in_hectares, None, 276114.0758,276496.4816,274448.9291\ngrassland_in_hectares, None, 726091.9808,725854.0912,730039.4586\npermanent_crops_in_hectares, None, 24040.2951,24285.0786,24061.4945\nother_utilised_agricultural_area_in_hectares, None, 15767.4333,15417.3522,15483.8239\nlivestock_beef_cattle_and_cows, None, 1525270,1513701,1515123\nlivestock_horses_and_other_equines, None, 80950,80096,80072\nlivestock_sheep, None, 355893,349112,343528\nlivestock_goats, None, 82313,82045,79562\nlivestock_pigs, None, 1372772,1366359,1348306\nlivestock_poultry, None, 13219724,12676402,12541044\nlivestock_other_animals, None, 126789,137616,131876\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nHow was the split between Swiss population and foreign nationals on Swiss farms in 2022?\n### SQL query\nSELECT ROUND(100 * employees_swiss / employees_total, 2) AS percentage_of_swiss_employees,\n  ROUND(100 * employees_foreign_nationals / employees_total, 2) AS percentage_foreign_nationals_employees\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total';\n\n\n### Question\nWhich 5 cantons had in 2022 the biggest precentage of their farm area used by organic farming? Order by the percentage of area used for organic farming.\n### SQL query\nSELECT S.name,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) /\n   NULLIF(SUM(CASE WHEN T.farmholding_system = 'Farmholding system - total'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END), 0), 2) AS percentage_of_organically_used_farmarea\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.canton = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Farmholding system - total')\nGROUP BY S.name\nORDER BY percentage_of_organically_used_farmarea DESC LIMIT 5;\n\n\n### Question\nWhat were the 5 cantons farming the most pigs in 2012?\n### SQL query\nSELECT S.name as canton_name, livestock_pigs as total_pigs\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2012\n    AND T.farmholding_system = 'Farmholding system - total'\nORDER BY livestock_pigs DESC\nLIMIT 5;\n\n\n### Question\nWhat was the precentage of family employees in organic and conventional farming in 2022?\n### SQL query\nSELECT\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.family_employees ELSE 0 END) /\n   SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.employees_total ELSE 0 END), 2) AS percentage_family_employees_organic_farming,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Conventional farming'\n       THEN T.family_employees ELSE 0 END) /\n   SUM(CASE WHEN T.farmholding_system = 'Conventional farming'\n       THEN T.employees_total ELSE 0 END), 2) AS percentage_family_employees_conventional_farming\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n\n\n### Question\nWhat were the 5 cantons farming the most pigs in 2012?\n### SQL query\nSELECT S.name as canton_name, livestock_pigs as total_pigs\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2012\n    AND T.farmholding_system = 'Farmholding system - total'\nORDER BY livestock_pigs DESC\nLIMIT 5;\n\n\n### Question\nDoes the average organic farm have less employees than the average non-organic farm in 2022?\n### SQL query\nSELECT farmholding_system, employees_total / farmholdings AS average_employees_per_farm\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.name = 'Switzerland'\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n\n\n### Question\nWhich five cantons had in 2022 the highest percentage of women farmers in mangement position? Also provide the precentage of women who had a manager position.\n### SQL query\nSELECT S.name as canton,\n  ROUND(100 * SUM(T.employees_women_manager_label) / SUM(T.employees_women), 2) AS percentage_women_managers\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total'\nGROUP BY S.name\nORDER BY percentage_women_managers DESC\nLIMIT 5;\n\n\n### Question\nHow was the split between Swiss population and foreign nationals on Swiss farms in 2022?\n### SQL query\nSELECT ROUND(100 * employees_swiss / employees_total, 2) AS percentage_of_swiss_employees,\n  ROUND(100 * employees_foreign_nationals / employees_total, 2) AS percentage_foreign_nationals_employees\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total';\n\n\n### Question\nWhich 5 cantons had in 2022 the biggest precentage of their farm area used by organic farming? Order by the percentage of area used for organic farming.\n### SQL query\nSELECT S.name,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) /\n   NULLIF(SUM(CASE WHEN T.farmholding_system = 'Farmholding system - total'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END), 0), 2) AS percentage_of_organically_used_farmarea\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.canton = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Farmholding system - total')\nGROUP BY S.name\nORDER BY percentage_of_organically_used_farmarea DESC LIMIT 5;\n\n\n### Question\nHow was the split between Swiss population and foreign nationals on Swiss farms in 2022?\n### SQL query\nSELECT ROUND(100 * employees_swiss / employees_total, 2) AS percentage_of_swiss_employees,\n  ROUND(100 * employees_foreign_nationals / employees_total, 2) AS percentage_foreign_nationals_employees\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total';\n\n\n### Question\nWhat are the percentages of part time work in Organic Farming?\n### SQL query\nSELECT ROUND(100 * full_time_employees_75_percent_or_more / employees_total, 2) AS precentage_75_percent_and_above,\n  ROUND(100 * part_time_employees_50_75_percent / employees_total, 2) AS percentage_of_between_50_and_75_percent,\n  ROUND(100 * part_time_employees_50_75_percent / employees_total, 2) AS percentage_below_50_precent\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2015\n    AND T.farmholding_system = 'Organic farming';\n\n\n### Question\nWhat kind of animal farms existed in Kanton Uri in 2012? Give the number of each farm type.\n### SQL query\n",
    "process_time": 11.510192946065217,
    "num_tokens": 4596,
    "hardness": "hard",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 10,
    "question": "How many farms were there in all of Switzerland between 2012 and 2018?",
    "query": "SELECT year, farmholdings\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n    AND S.country = 'TRUE'\n    AND year BETWEEN 2012 AND 2018\n    AND T.farmholding_system = 'Farmholding system - total';\n",
    "db_id": "employees_farmholdings_agricultural_area_livestock_per_canton",
    "generated_query": "SELECT SUM(farmholdings) AS total_farms\nFROM employees_farmholdings_agricultural_area_livestock_per_canton\nWHERE year BETWEEN 2012 AND 2018\n    AND farmholding_system = 'Farmholding system - total'\n    AND spatialunit_uid IN (\n        SELECT spatialunit_uid\n        FROM spatial_unit\n        WHERE country = 'TRUE'\n    );",
    "meta_data": [
      {
        "question": "What was the precentage of family employees in organic and conventional farming in 2022?",
        "query": "SELECT\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.family_employees ELSE 0 END) /\n   SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.employees_total ELSE 0 END), 2) AS percentage_family_employees_organic_farming,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Conventional farming'\n       THEN T.family_employees ELSE 0 END) /\n   SUM(CASE WHEN T.farmholding_system = 'Conventional farming'\n       THEN T.employees_total ELSE 0 END), 2) AS percentage_family_employees_conventional_farming\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n"
      },
      {
        "question": "What was the average number of cows per farm in the canton of Vaud since 2017?",
        "query": "SELECT year, livestock_beef_cattle_and_cows / farmholdings AS average_cows_per_farmholding_vaud\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Canton Vaud'\n    AND S.canton = 'TRUE'\n    AND year >= 2017\n    AND T.farmholding_system = 'Farmholding system - total';\n"
      },
      {
        "question": "What farm animals were bred in the canton of Bern in 2020?",
        "query": "SELECT livestock_beef_cattle_and_cows, livestock_sheep, livestock_goats, livestock_pigs, livestock_poultry, livestock_other_animals\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Bern%'\n    AND S.canton = 'TRUE'\n    AND T.year = 2020\n    AND T.farmholding_system = 'Farmholding system - total';\n"
      },
      {
        "question": "What canton has the highest percentage of organic farms most recently?",
        "query": "SELECT\n    year,\n    S.name AS canton_name,\n    (\n        SUM(\n            CASE WHEN farmholding_system = 'Organic farming'\n            THEN farmholdings\n            ELSE 0 END\n        ) * 100.0 / SUM(\n            CASE WHEN farmholding_system = 'Farmholding system - total'\n            THEN farmholdings\n            ELSE 0 END\n        )\n    ) AS percentage_organic_farms\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE year = (\n    SELECT MAX(year)\n    FROM employees_farmholdings_agricultural_area_livestock_per_canton\n)\nGROUP BY year, S.name\nORDER BY percentage_organic_farms DESC\nLIMIT 1;\n"
      },
      {
        "question": "What was the average number of cows per farm in the canton of Vaud since 2017?",
        "query": "SELECT year, livestock_beef_cattle_and_cows / farmholdings AS average_cows_per_farmholding_vaud\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Canton Vaud'\n    AND S.canton = 'TRUE'\n    AND year >= 2017\n    AND T.farmholding_system = 'Farmholding system - total';\n"
      },
      {
        "question": "What was the average number of cows per farm in the canton of Vaud since 2017?",
        "query": "SELECT year, livestock_beef_cattle_and_cows / farmholdings AS average_cows_per_farmholding_vaud\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Canton Vaud'\n    AND S.canton = 'TRUE'\n    AND year >= 2017\n    AND T.farmholding_system = 'Farmholding system - total';\n"
      },
      {
        "question": "Which five cantons had in 2022 the highest percentage of women farmers in mangement position? Also provide the precentage of women who had a manager position.",
        "query": "SELECT S.name as canton,\n  ROUND(100 * SUM(T.employees_women_manager_label) / SUM(T.employees_women), 2) AS percentage_women_managers\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total'\nGROUP BY S.name\nORDER BY percentage_women_managers DESC\nLIMIT 5;\n"
      },
      {
        "question": "What are the percentages of part time work in Organic Farming?",
        "query": "SELECT ROUND(100 * full_time_employees_75_percent_or_more / employees_total, 2) AS precentage_75_percent_and_above,\n  ROUND(100 * part_time_employees_50_75_percent / employees_total, 2) AS percentage_of_between_50_and_75_percent,\n  ROUND(100 * part_time_employees_50_75_percent / employees_total, 2) AS percentage_below_50_precent\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2015\n    AND T.farmholding_system = 'Organic farming';\n"
      },
      {
        "question": "What canton has the highest percentage of organic farms most recently?",
        "query": "SELECT\n    year,\n    S.name AS canton_name,\n    (\n        SUM(\n            CASE WHEN farmholding_system = 'Organic farming'\n            THEN farmholdings\n            ELSE 0 END\n        ) * 100.0 / SUM(\n            CASE WHEN farmholding_system = 'Farmholding system - total'\n            THEN farmholdings\n            ELSE 0 END\n        )\n    ) AS percentage_organic_farms\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE year = (\n    SELECT MAX(year)\n    FROM employees_farmholdings_agricultural_area_livestock_per_canton\n)\nGROUP BY year, S.name\nORDER BY percentage_organic_farms DESC\nLIMIT 1;\n"
      },
      {
        "question": "How was the split between Swiss population and foreign nationals on Swiss farms in 2022?",
        "query": "SELECT ROUND(100 * employees_swiss / employees_total, 2) AS percentage_of_swiss_employees,\n  ROUND(100 * employees_foreign_nationals / employees_total, 2) AS percentage_foreign_nationals_employees\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total';\n"
      },
      {
        "question": "Does the average organic farm have less employees than the average non-organic farm in 2022?",
        "query": "SELECT farmholding_system, employees_total / farmholdings AS average_employees_per_farm\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.name = 'Switzerland'\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.employees_farmholdings_agricultural_area_livestock_per_canton (\n\tuid SERIAL NOT NULL, \n\tfarmholding_system TEXT, \n\tyear INTEGER, \n\tfarmholdings NUMERIC, \n\temployees_total NUMERIC, \n\tfull_time_employees_75_percent_or_more NUMERIC, \n\tpart_time_employees_50_75_percent NUMERIC, \n\tpart_time_employees_2_less_than_50_percent NUMERIC, \n\temployees_men NUMERIC, \n\temployees_women NUMERIC, \n\temployees_women_manager_label NUMERIC, \n\temployees_swiss NUMERIC, \n\temployees_foreign_nationals NUMERIC, \n\tfamily_employees NUMERIC, \n\tbeef_cattle_and_cows_farm NUMERIC, \n\thorse_and_other_equine_farm NUMERIC, \n\tsheep_farm NUMERIC, \n\tgoat_farm NUMERIC, \n\tpig_farms NUMERIC, \n\tpoultry_farm NUMERIC, \n\tfarms_with_other_animals NUMERIC, \n\tutilised_agricultural_area_in_hectares NUMERIC, \n\tarable_land_in_hectares NUMERIC, \n\tgrassland_in_hectares NUMERIC, \n\tpermanent_crops_in_hectares NUMERIC, \n\tother_utilised_agricultural_area_in_hectares NUMERIC, \n\tlivestock_beef_cattle_and_cows NUMERIC, \n\tlivestock_horses_and_other_equines NUMERIC, \n\tlivestock_sheep NUMERIC, \n\tlivestock_goats NUMERIC, \n\tlivestock_pigs NUMERIC, \n\tlivestock_poultry NUMERIC, \n\tlivestock_other_animals NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT employees_farmholdings_agricultural_area_livestock_per_can_pkey PRIMARY KEY (uid), \n\tCONSTRAINT employees_farmholdings_agricultural_area_l_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in employees_farmholdings_agricultural_area_livestock_per_canton and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nyear : 2015, 2009, 2000, 2012, 2019\nfarmholdings : 3300, 412, 3149, 348, 51860\nemployees_total : 13632, 189566, 225149, 17343, 149521\nfull_time_employees_75_percent_or_more : 5316, 72633, 70625, 80436, 4937\npart_time_employees_50_75_percent : 2056, 2277, 41165, 2120, 37276\npart_time_employees_2_less_than_50_percent : 51446, 4005, 3014, 4506, 3404\nemployees_men : 144280, 839, 125547, 98822, 5275\nemployees_women : 71887, 459, 54872, 7197, 3312\nemployees_women_manager_label : 1393, 192, 2560, 412, 459\nemployees_swiss : 140137, 17057, 140683, 11125, 9677\nemployees_foreign_nationals : 17032, 1510, 1025, 870, 1146\nfamily_employees : 928, 1053, 9874, 823, 180894\nbeef_cattle_and_cows_farm : 5242, 252, 235, 4937, 3103\nhorse_and_other_equine_farm : 12225, 127, 839, 870, 115\nsheep_farm : 11399, 72, 291, 88, 335\ngoat_farm : 5076, 8496, 8083, 5151, 8168\npig_farms : 235, 252, 291, 136, 333\npoultry_farm : 1800, 2163, 2033, 11387, 1608\nfarms_with_other_animals : 72, 6098, 57, 348, 358\nutilised_agricultural_area_in_hectares : 76523.139999999999418, 935676.880299999960698, 67243.500000000000000, 67686.110000000000582, 1082876.239999999990687\narable_land_in_hectares : 4430.869999999999890861, 269648.469999999972060323, 279671.130000000004656613, 28704.027600000001257285, 30115.979999999999563443\ngrassland_in_hectares : 4136.470000000000255, 39994.673999999999069, 4332.409999999999854, 38283.739999999997963, 98902.110000000000582\npermanent_crops_in_hectares : 21936.409999999999854481, 1407.559999999999945430, 23116.000000000000000000, 1321.730000000000018190, 22537.479999999999563443\nother_utilised_agricultural_area_in_hectares : 1630.089999999999918145, 1998.039999999999963620, 11233.479999999999563443, 12720.547099999999772990, 9423.579999999999927240\nlivestock_beef_cattle_and_cows : 160950, 1427327, 1544612, 95020, 9387\nlivestock_horses_and_other_equines : 75864, 69723, 68180, 10577, 6035\nlivestock_sheep : 263861, 11709, 256902, 329033, 417274\nlivestock_goats : 66007, 2226, 67416, 2192, 333\nlivestock_pigs : 42366, 31885, 1468313, 559, 1544017\nlivestock_poultry : 360738, 327285, 34710, 10824616, 342966\nlivestock_other_animals : 481, 81566, 4893, 111801, 9194\n*/\n\n/*\nColumn name, Column discription, Example values\nfarmholding_system, None, Farmholding system - total,Organic farming,Conventional farming\nfarmholdings, None, 48344,48864,49363\nemployees_total, None, 149578,150231,149521\nfull_time_employees_75_percent_or_more, None, 66349,66453,66333\npart_time_employees_50_75_percent, None, 30083,30038,29920\npart_time_employees_2_less_than_50_percent, None, 53146,53740,53268\nemployees_men, None, 94706,95486,95252\nemployees_women, None, 54872,54745,54269\nemployees_women_manager_label, None, 3472,3362,3233\nemployees_swiss, None, 131072,131955,131581\nemployees_foreign_nationals, None, 18506,18276,17940\nfamily_employees, None, 112047,113317,113847\nbeef_cattle_and_cows_farm, None, 32581,33091,33662\nhorse_and_other_equine_farm, None, 11123,11196,11227\nsheep_farm, None, 7969,7977,8016\ngoat_farm, None, 6559,6592,6355\npig_farms, None, 5467,5561,5600\npoultry_farm, None, 14876,14434,13485\nfarms_with_other_animals, None, 6138,6101,6000\nutilised_agricultural_area_in_hectares, None, 1042013.785,1042053.004,1044033.706\narable_land_in_hectares, None, 276114.0758,276496.4816,274448.9291\ngrassland_in_hectares, None, 726091.9808,725854.0912,730039.4586\npermanent_crops_in_hectares, None, 24040.2951,24285.0786,24061.4945\nother_utilised_agricultural_area_in_hectares, None, 15767.4333,15417.3522,15483.8239\nlivestock_beef_cattle_and_cows, None, 1525270,1513701,1515123\nlivestock_horses_and_other_equines, None, 80950,80096,80072\nlivestock_sheep, None, 355893,349112,343528\nlivestock_goats, None, 82313,82045,79562\nlivestock_pigs, None, 1372772,1366359,1348306\nlivestock_poultry, None, 13219724,12676402,12541044\nlivestock_other_animals, None, 126789,137616,131876\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWhat was the precentage of family employees in organic and conventional farming in 2022?\n### SQL query\nSELECT\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.family_employees ELSE 0 END) /\n   SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.employees_total ELSE 0 END), 2) AS percentage_family_employees_organic_farming,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Conventional farming'\n       THEN T.family_employees ELSE 0 END) /\n   SUM(CASE WHEN T.farmholding_system = 'Conventional farming'\n       THEN T.employees_total ELSE 0 END), 2) AS percentage_family_employees_conventional_farming\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n\n\n### Question\nWhat was the average number of cows per farm in the canton of Vaud since 2017?\n### SQL query\nSELECT year, livestock_beef_cattle_and_cows / farmholdings AS average_cows_per_farmholding_vaud\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Canton Vaud'\n    AND S.canton = 'TRUE'\n    AND year >= 2017\n    AND T.farmholding_system = 'Farmholding system - total';\n\n\n### Question\nWhat farm animals were bred in the canton of Bern in 2020?\n### SQL query\nSELECT livestock_beef_cattle_and_cows, livestock_sheep, livestock_goats, livestock_pigs, livestock_poultry, livestock_other_animals\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Bern%'\n    AND S.canton = 'TRUE'\n    AND T.year = 2020\n    AND T.farmholding_system = 'Farmholding system - total';\n\n\n### Question\nWhat canton has the highest percentage of organic farms most recently?\n### SQL query\nSELECT\n    year,\n    S.name AS canton_name,\n    (\n        SUM(\n            CASE WHEN farmholding_system = 'Organic farming'\n            THEN farmholdings\n            ELSE 0 END\n        ) * 100.0 / SUM(\n            CASE WHEN farmholding_system = 'Farmholding system - total'\n            THEN farmholdings\n            ELSE 0 END\n        )\n    ) AS percentage_organic_farms\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE year = (\n    SELECT MAX(year)\n    FROM employees_farmholdings_agricultural_area_livestock_per_canton\n)\nGROUP BY year, S.name\nORDER BY percentage_organic_farms DESC\nLIMIT 1;\n\n\n### Question\nWhat was the average number of cows per farm in the canton of Vaud since 2017?\n### SQL query\nSELECT year, livestock_beef_cattle_and_cows / farmholdings AS average_cows_per_farmholding_vaud\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Canton Vaud'\n    AND S.canton = 'TRUE'\n    AND year >= 2017\n    AND T.farmholding_system = 'Farmholding system - total';\n\n\n### Question\nWhat was the average number of cows per farm in the canton of Vaud since 2017?\n### SQL query\nSELECT year, livestock_beef_cattle_and_cows / farmholdings AS average_cows_per_farmholding_vaud\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Canton Vaud'\n    AND S.canton = 'TRUE'\n    AND year >= 2017\n    AND T.farmholding_system = 'Farmholding system - total';\n\n\n### Question\nWhich five cantons had in 2022 the highest percentage of women farmers in mangement position? Also provide the precentage of women who had a manager position.\n### SQL query\nSELECT S.name as canton,\n  ROUND(100 * SUM(T.employees_women_manager_label) / SUM(T.employees_women), 2) AS percentage_women_managers\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total'\nGROUP BY S.name\nORDER BY percentage_women_managers DESC\nLIMIT 5;\n\n\n### Question\nWhat are the percentages of part time work in Organic Farming?\n### SQL query\nSELECT ROUND(100 * full_time_employees_75_percent_or_more / employees_total, 2) AS precentage_75_percent_and_above,\n  ROUND(100 * part_time_employees_50_75_percent / employees_total, 2) AS percentage_of_between_50_and_75_percent,\n  ROUND(100 * part_time_employees_50_75_percent / employees_total, 2) AS percentage_below_50_precent\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2015\n    AND T.farmholding_system = 'Organic farming';\n\n\n### Question\nWhat canton has the highest percentage of organic farms most recently?\n### SQL query\nSELECT\n    year,\n    S.name AS canton_name,\n    (\n        SUM(\n            CASE WHEN farmholding_system = 'Organic farming'\n            THEN farmholdings\n            ELSE 0 END\n        ) * 100.0 / SUM(\n            CASE WHEN farmholding_system = 'Farmholding system - total'\n            THEN farmholdings\n            ELSE 0 END\n        )\n    ) AS percentage_organic_farms\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE year = (\n    SELECT MAX(year)\n    FROM employees_farmholdings_agricultural_area_livestock_per_canton\n)\nGROUP BY year, S.name\nORDER BY percentage_organic_farms DESC\nLIMIT 1;\n\n\n### Question\nHow was the split between Swiss population and foreign nationals on Swiss farms in 2022?\n### SQL query\nSELECT ROUND(100 * employees_swiss / employees_total, 2) AS percentage_of_swiss_employees,\n  ROUND(100 * employees_foreign_nationals / employees_total, 2) AS percentage_foreign_nationals_employees\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total';\n\n\n### Question\nDoes the average organic farm have less employees than the average non-organic farm in 2022?\n### SQL query\nSELECT farmholding_system, employees_total / farmholdings AS average_employees_per_farm\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.name = 'Switzerland'\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n\n\n### Question\nHow many farms were there in all of Switzerland between 2012 and 2018?\n### SQL query\n",
    "process_time": 5.921662160893902,
    "num_tokens": 4524,
    "hardness": "extra",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 11,
    "question": "How was the farmland used in organic farming in 2017? Provide land usage in percentage of the farming area.",
    "query": "SELECT ROUND(100 * T.arable_land_in_hectares / T.utilised_agricultural_area_in_hectares, 2) AS percentage_arable_land,\n  ROUND(100 * T.grassland_in_hectares / T.utilised_agricultural_area_in_hectares, 2) AS percentage_grassland,\n  ROUND(100 * T.permanent_crops_in_hectares / T.utilised_agricultural_area_in_hectares, 2) AS percentage_permanent_crops,\n  ROUND(100 * T.other_utilised_agricultural_area_in_hectares / T.utilised_agricultural_area_in_hectares, 2) AS precentage_other_usage\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2015\n    AND T.farmholding_system = 'Organic farming';\n",
    "db_id": "employees_farmholdings_agricultural_area_livestock_per_canton",
    "generated_query": "SELECT \n    ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming' THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) / SUM(T.utilised_agricultural_area_in_hectares), 2) AS percentage_organic_farming,\n    ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Conventional farming' THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) / SUM(T.utilised_agricultural_area_in_hectares), 2) AS percentage_conventional_farming,\n    ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Farmholding system - total' THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) / SUM(T.utilised_agricultural_area_in_hectares), 2) AS percentage_total_farming\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nWHERE T.year = 2017;",
    "meta_data": [
      {
        "question": "Which five cantons had in 2022 the highest percentage of women farmers in mangement position? Also provide the precentage of women who had a manager position.",
        "query": "SELECT S.name as canton,\n  ROUND(100 * SUM(T.employees_women_manager_label) / SUM(T.employees_women), 2) AS percentage_women_managers\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total'\nGROUP BY S.name\nORDER BY percentage_women_managers DESC\nLIMIT 5;\n"
      },
      {
        "question": "How did organic versus conventional farming develop in Kanton Uri between 2010 and 2020? Consider the farm area and the number of farms and give the differences.",
        "query": "SELECT\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) AS increase_organic_farm_area_in_ha,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Organic farming'\n       THEN T.farmholdings ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Organic farming'\n       THEN T.farmholdings ELSE 0 END) AS increase_number_of_organic_farms,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Conventional farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Conventional farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) AS increase_conventional_farm_area_in_ha,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Conventional farming'\n       THEN T.farmholdings ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Conventional farming'\n       THEN T.farmholdings ELSE 0 END) AS increase_number_of_conventional_farms\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND S.name LIKE '%Uri%'\n  AND T.year IN (2010, 2020)\n  AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n"
      },
      {
        "question": "What was the average number of cows per farm in the canton of Vaud since 2017?",
        "query": "SELECT year, livestock_beef_cattle_and_cows / farmholdings AS average_cows_per_farmholding_vaud\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Canton Vaud'\n    AND S.canton = 'TRUE'\n    AND year >= 2017\n    AND T.farmholding_system = 'Farmholding system - total';\n"
      },
      {
        "question": "What was the average number of cows per farm in the canton of Vaud since 2017?",
        "query": "SELECT year, livestock_beef_cattle_and_cows / farmholdings AS average_cows_per_farmholding_vaud\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Canton Vaud'\n    AND S.canton = 'TRUE'\n    AND year >= 2017\n    AND T.farmholding_system = 'Farmholding system - total';\n"
      },
      {
        "question": "Which 5 cantons had in 2022 the biggest precentage of their farm area used by organic farming? Order by the percentage of area used for organic farming.",
        "query": "SELECT S.name,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) /\n   NULLIF(SUM(CASE WHEN T.farmholding_system = 'Farmholding system - total'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END), 0), 2) AS percentage_of_organically_used_farmarea\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.canton = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Farmholding system - total')\nGROUP BY S.name\nORDER BY percentage_of_organically_used_farmarea DESC LIMIT 5;\n"
      },
      {
        "question": "What was the average number of cows per farm in the canton of Vaud since 2017?",
        "query": "SELECT year, livestock_beef_cattle_and_cows / farmholdings AS average_cows_per_farmholding_vaud\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Canton Vaud'\n    AND S.canton = 'TRUE'\n    AND year >= 2017\n    AND T.farmholding_system = 'Farmholding system - total';\n"
      },
      {
        "question": "Which 5 cantons had in 2022 the biggest precentage of their farm area used by organic farming? Order by the percentage of area used for organic farming.",
        "query": "SELECT S.name,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) /\n   NULLIF(SUM(CASE WHEN T.farmholding_system = 'Farmholding system - total'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END), 0), 2) AS percentage_of_organically_used_farmarea\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.canton = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Farmholding system - total')\nGROUP BY S.name\nORDER BY percentage_of_organically_used_farmarea DESC LIMIT 5;\n"
      },
      {
        "question": "What are the percentages of part time work in Organic Farming?",
        "query": "SELECT ROUND(100 * full_time_employees_75_percent_or_more / employees_total, 2) AS precentage_75_percent_and_above,\n  ROUND(100 * part_time_employees_50_75_percent / employees_total, 2) AS percentage_of_between_50_and_75_percent,\n  ROUND(100 * part_time_employees_50_75_percent / employees_total, 2) AS percentage_below_50_precent\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2015\n    AND T.farmholding_system = 'Organic farming';\n"
      },
      {
        "question": "Does the average organic farm have less employees than the average non-organic farm in 2022?",
        "query": "SELECT farmholding_system, employees_total / farmholdings AS average_employees_per_farm\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.name = 'Switzerland'\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n"
      },
      {
        "question": "What was the average number of cows per farm in the canton of Vaud since 2017?",
        "query": "SELECT year, livestock_beef_cattle_and_cows / farmholdings AS average_cows_per_farmholding_vaud\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Canton Vaud'\n    AND S.canton = 'TRUE'\n    AND year >= 2017\n    AND T.farmholding_system = 'Farmholding system - total';\n"
      },
      {
        "question": "Which five cantons had in 2022 the highest percentage of women farmers in mangement position? Also provide the precentage of women who had a manager position.",
        "query": "SELECT S.name as canton,\n  ROUND(100 * SUM(T.employees_women_manager_label) / SUM(T.employees_women), 2) AS percentage_women_managers\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total'\nGROUP BY S.name\nORDER BY percentage_women_managers DESC\nLIMIT 5;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.employees_farmholdings_agricultural_area_livestock_per_canton (\n\tuid SERIAL NOT NULL, \n\tfarmholding_system TEXT, \n\tyear INTEGER, \n\tfarmholdings NUMERIC, \n\temployees_total NUMERIC, \n\tfull_time_employees_75_percent_or_more NUMERIC, \n\tpart_time_employees_50_75_percent NUMERIC, \n\tpart_time_employees_2_less_than_50_percent NUMERIC, \n\temployees_men NUMERIC, \n\temployees_women NUMERIC, \n\temployees_women_manager_label NUMERIC, \n\temployees_swiss NUMERIC, \n\temployees_foreign_nationals NUMERIC, \n\tfamily_employees NUMERIC, \n\tbeef_cattle_and_cows_farm NUMERIC, \n\thorse_and_other_equine_farm NUMERIC, \n\tsheep_farm NUMERIC, \n\tgoat_farm NUMERIC, \n\tpig_farms NUMERIC, \n\tpoultry_farm NUMERIC, \n\tfarms_with_other_animals NUMERIC, \n\tutilised_agricultural_area_in_hectares NUMERIC, \n\tarable_land_in_hectares NUMERIC, \n\tgrassland_in_hectares NUMERIC, \n\tpermanent_crops_in_hectares NUMERIC, \n\tother_utilised_agricultural_area_in_hectares NUMERIC, \n\tlivestock_beef_cattle_and_cows NUMERIC, \n\tlivestock_horses_and_other_equines NUMERIC, \n\tlivestock_sheep NUMERIC, \n\tlivestock_goats NUMERIC, \n\tlivestock_pigs NUMERIC, \n\tlivestock_poultry NUMERIC, \n\tlivestock_other_animals NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT employees_farmholdings_agricultural_area_livestock_per_can_pkey PRIMARY KEY (uid), \n\tCONSTRAINT employees_farmholdings_agricultural_area_l_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in employees_farmholdings_agricultural_area_livestock_per_canton and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nyear : 2015, 2009, 2000, 2012, 2019\nfarmholdings : 3300, 412, 3149, 348, 51860\nemployees_total : 13632, 189566, 225149, 17343, 149521\nfull_time_employees_75_percent_or_more : 5316, 72633, 70625, 80436, 4937\npart_time_employees_50_75_percent : 2056, 2277, 41165, 2120, 37276\npart_time_employees_2_less_than_50_percent : 51446, 4005, 3014, 4506, 3404\nemployees_men : 144280, 839, 125547, 98822, 5275\nemployees_women : 71887, 459, 54872, 7197, 3312\nemployees_women_manager_label : 1393, 192, 2560, 412, 459\nemployees_swiss : 140137, 17057, 140683, 11125, 9677\nemployees_foreign_nationals : 17032, 1510, 1025, 870, 1146\nfamily_employees : 928, 1053, 9874, 823, 180894\nbeef_cattle_and_cows_farm : 5242, 252, 235, 4937, 3103\nhorse_and_other_equine_farm : 12225, 127, 839, 870, 115\nsheep_farm : 11399, 72, 291, 88, 335\ngoat_farm : 5076, 8496, 8083, 5151, 8168\npig_farms : 235, 252, 291, 136, 333\npoultry_farm : 1800, 2163, 2033, 11387, 1608\nfarms_with_other_animals : 72, 6098, 57, 348, 358\nutilised_agricultural_area_in_hectares : 76523.139999999999418, 935676.880299999960698, 67243.500000000000000, 67686.110000000000582, 1082876.239999999990687\narable_land_in_hectares : 4430.869999999999890861, 269648.469999999972060323, 279671.130000000004656613, 28704.027600000001257285, 30115.979999999999563443\ngrassland_in_hectares : 4136.470000000000255, 39994.673999999999069, 4332.409999999999854, 38283.739999999997963, 98902.110000000000582\npermanent_crops_in_hectares : 21936.409999999999854481, 1407.559999999999945430, 23116.000000000000000000, 1321.730000000000018190, 22537.479999999999563443\nother_utilised_agricultural_area_in_hectares : 1630.089999999999918145, 1998.039999999999963620, 11233.479999999999563443, 12720.547099999999772990, 9423.579999999999927240\nlivestock_beef_cattle_and_cows : 160950, 1427327, 1544612, 95020, 9387\nlivestock_horses_and_other_equines : 75864, 69723, 68180, 10577, 6035\nlivestock_sheep : 263861, 11709, 256902, 329033, 417274\nlivestock_goats : 66007, 2226, 67416, 2192, 333\nlivestock_pigs : 42366, 31885, 1468313, 559, 1544017\nlivestock_poultry : 360738, 327285, 34710, 10824616, 342966\nlivestock_other_animals : 481, 81566, 4893, 111801, 9194\n*/\n\n/*\nColumn name, Column discription, Example values\nfarmholding_system, None, Farmholding system - total,Organic farming,Conventional farming\nfarmholdings, None, 48344,48864,49363\nemployees_total, None, 149578,150231,149521\nfull_time_employees_75_percent_or_more, None, 66349,66453,66333\npart_time_employees_50_75_percent, None, 30083,30038,29920\npart_time_employees_2_less_than_50_percent, None, 53146,53740,53268\nemployees_men, None, 94706,95486,95252\nemployees_women, None, 54872,54745,54269\nemployees_women_manager_label, None, 3472,3362,3233\nemployees_swiss, None, 131072,131955,131581\nemployees_foreign_nationals, None, 18506,18276,17940\nfamily_employees, None, 112047,113317,113847\nbeef_cattle_and_cows_farm, None, 32581,33091,33662\nhorse_and_other_equine_farm, None, 11123,11196,11227\nsheep_farm, None, 7969,7977,8016\ngoat_farm, None, 6559,6592,6355\npig_farms, None, 5467,5561,5600\npoultry_farm, None, 14876,14434,13485\nfarms_with_other_animals, None, 6138,6101,6000\nutilised_agricultural_area_in_hectares, None, 1042013.785,1042053.004,1044033.706\narable_land_in_hectares, None, 276114.0758,276496.4816,274448.9291\ngrassland_in_hectares, None, 726091.9808,725854.0912,730039.4586\npermanent_crops_in_hectares, None, 24040.2951,24285.0786,24061.4945\nother_utilised_agricultural_area_in_hectares, None, 15767.4333,15417.3522,15483.8239\nlivestock_beef_cattle_and_cows, None, 1525270,1513701,1515123\nlivestock_horses_and_other_equines, None, 80950,80096,80072\nlivestock_sheep, None, 355893,349112,343528\nlivestock_goats, None, 82313,82045,79562\nlivestock_pigs, None, 1372772,1366359,1348306\nlivestock_poultry, None, 13219724,12676402,12541044\nlivestock_other_animals, None, 126789,137616,131876\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWhich five cantons had in 2022 the highest percentage of women farmers in mangement position? Also provide the precentage of women who had a manager position.\n### SQL query\nSELECT S.name as canton,\n  ROUND(100 * SUM(T.employees_women_manager_label) / SUM(T.employees_women), 2) AS percentage_women_managers\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total'\nGROUP BY S.name\nORDER BY percentage_women_managers DESC\nLIMIT 5;\n\n\n### Question\nHow did organic versus conventional farming develop in Kanton Uri between 2010 and 2020? Consider the farm area and the number of farms and give the differences.\n### SQL query\nSELECT\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) AS increase_organic_farm_area_in_ha,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Organic farming'\n       THEN T.farmholdings ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Organic farming'\n       THEN T.farmholdings ELSE 0 END) AS increase_number_of_organic_farms,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Conventional farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Conventional farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) AS increase_conventional_farm_area_in_ha,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Conventional farming'\n       THEN T.farmholdings ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Conventional farming'\n       THEN T.farmholdings ELSE 0 END) AS increase_number_of_conventional_farms\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND S.name LIKE '%Uri%'\n  AND T.year IN (2010, 2020)\n  AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n\n\n### Question\nWhat was the average number of cows per farm in the canton of Vaud since 2017?\n### SQL query\nSELECT year, livestock_beef_cattle_and_cows / farmholdings AS average_cows_per_farmholding_vaud\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Canton Vaud'\n    AND S.canton = 'TRUE'\n    AND year >= 2017\n    AND T.farmholding_system = 'Farmholding system - total';\n\n\n### Question\nWhat was the average number of cows per farm in the canton of Vaud since 2017?\n### SQL query\nSELECT year, livestock_beef_cattle_and_cows / farmholdings AS average_cows_per_farmholding_vaud\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Canton Vaud'\n    AND S.canton = 'TRUE'\n    AND year >= 2017\n    AND T.farmholding_system = 'Farmholding system - total';\n\n\n### Question\nWhich 5 cantons had in 2022 the biggest precentage of their farm area used by organic farming? Order by the percentage of area used for organic farming.\n### SQL query\nSELECT S.name,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) /\n   NULLIF(SUM(CASE WHEN T.farmholding_system = 'Farmholding system - total'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END), 0), 2) AS percentage_of_organically_used_farmarea\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.canton = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Farmholding system - total')\nGROUP BY S.name\nORDER BY percentage_of_organically_used_farmarea DESC LIMIT 5;\n\n\n### Question\nWhat was the average number of cows per farm in the canton of Vaud since 2017?\n### SQL query\nSELECT year, livestock_beef_cattle_and_cows / farmholdings AS average_cows_per_farmholding_vaud\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Canton Vaud'\n    AND S.canton = 'TRUE'\n    AND year >= 2017\n    AND T.farmholding_system = 'Farmholding system - total';\n\n\n### Question\nWhich 5 cantons had in 2022 the biggest precentage of their farm area used by organic farming? Order by the percentage of area used for organic farming.\n### SQL query\nSELECT S.name,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) /\n   NULLIF(SUM(CASE WHEN T.farmholding_system = 'Farmholding system - total'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END), 0), 2) AS percentage_of_organically_used_farmarea\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.canton = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Farmholding system - total')\nGROUP BY S.name\nORDER BY percentage_of_organically_used_farmarea DESC LIMIT 5;\n\n\n### Question\nWhat are the percentages of part time work in Organic Farming?\n### SQL query\nSELECT ROUND(100 * full_time_employees_75_percent_or_more / employees_total, 2) AS precentage_75_percent_and_above,\n  ROUND(100 * part_time_employees_50_75_percent / employees_total, 2) AS percentage_of_between_50_and_75_percent,\n  ROUND(100 * part_time_employees_50_75_percent / employees_total, 2) AS percentage_below_50_precent\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2015\n    AND T.farmholding_system = 'Organic farming';\n\n\n### Question\nDoes the average organic farm have less employees than the average non-organic farm in 2022?\n### SQL query\nSELECT farmholding_system, employees_total / farmholdings AS average_employees_per_farm\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.name = 'Switzerland'\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n\n\n### Question\nWhat was the average number of cows per farm in the canton of Vaud since 2017?\n### SQL query\nSELECT year, livestock_beef_cattle_and_cows / farmholdings AS average_cows_per_farmholding_vaud\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Canton Vaud'\n    AND S.canton = 'TRUE'\n    AND year >= 2017\n    AND T.farmholding_system = 'Farmholding system - total';\n\n\n### Question\nWhich five cantons had in 2022 the highest percentage of women farmers in mangement position? Also provide the precentage of women who had a manager position.\n### SQL query\nSELECT S.name as canton,\n  ROUND(100 * SUM(T.employees_women_manager_label) / SUM(T.employees_women), 2) AS percentage_women_managers\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total'\nGROUP BY S.name\nORDER BY percentage_women_managers DESC\nLIMIT 5;\n\n\n### Question\nHow was the farmland used in organic farming in 2017? Provide land usage in percentage of the farming area.\n### SQL query\n",
    "process_time": 21.41123211500235,
    "num_tokens": 4868,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 12,
    "question": "How was the split between men and women in farm employment in canton Uri in 2015?",
    "query": "SELECT ROUND(100 * employees_women / employees_total, 2) AS percentage_of_female_employees,\n  ROUND(100 * employees_men / employees_total, 2) AS percentage_of_male_employees\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2015\n    AND T.farmholding_system = 'Farmholding system - total';\n",
    "db_id": "employees_farmholdings_agricultural_area_livestock_per_canton",
    "generated_query": "SELECT employees_men, employees_women\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Uri%'\n    AND S.canton = 'TRUE'\n    AND T.year = 2015\n    AND T.farmholding_system = 'Farmholding system - total';",
    "meta_data": [
      {
        "question": "How did organic versus conventional farming develop in Kanton Uri between 2010 and 2020? Consider the farm area and the number of farms and give the differences.",
        "query": "SELECT\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) AS increase_organic_farm_area_in_ha,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Organic farming'\n       THEN T.farmholdings ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Organic farming'\n       THEN T.farmholdings ELSE 0 END) AS increase_number_of_organic_farms,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Conventional farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Conventional farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) AS increase_conventional_farm_area_in_ha,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Conventional farming'\n       THEN T.farmholdings ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Conventional farming'\n       THEN T.farmholdings ELSE 0 END) AS increase_number_of_conventional_farms\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND S.name LIKE '%Uri%'\n  AND T.year IN (2010, 2020)\n  AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n"
      },
      {
        "question": "What were the 5 cantons farming the most pigs in 2012?",
        "query": "SELECT S.name as canton_name, livestock_pigs as total_pigs\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2012\n    AND T.farmholding_system = 'Farmholding system - total'\nORDER BY livestock_pigs DESC\nLIMIT 5;\n"
      },
      {
        "question": "What farm animals were bred in the canton of Bern in 2020?",
        "query": "SELECT livestock_beef_cattle_and_cows, livestock_sheep, livestock_goats, livestock_pigs, livestock_poultry, livestock_other_animals\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Bern%'\n    AND S.canton = 'TRUE'\n    AND T.year = 2020\n    AND T.farmholding_system = 'Farmholding system - total';\n"
      },
      {
        "question": "What were the 5 cantons farming the most pigs in 2012?",
        "query": "SELECT S.name as canton_name, livestock_pigs as total_pigs\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2012\n    AND T.farmholding_system = 'Farmholding system - total'\nORDER BY livestock_pigs DESC\nLIMIT 5;\n"
      },
      {
        "question": "Which 5 cantons had in 2022 the biggest precentage of their farm area used by organic farming? Order by the percentage of area used for organic farming.",
        "query": "SELECT S.name,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) /\n   NULLIF(SUM(CASE WHEN T.farmholding_system = 'Farmholding system - total'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END), 0), 2) AS percentage_of_organically_used_farmarea\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.canton = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Farmholding system - total')\nGROUP BY S.name\nORDER BY percentage_of_organically_used_farmarea DESC LIMIT 5;\n"
      },
      {
        "question": "What was the precentage of family employees in organic and conventional farming in 2022?",
        "query": "SELECT\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.family_employees ELSE 0 END) /\n   SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.employees_total ELSE 0 END), 2) AS percentage_family_employees_organic_farming,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Conventional farming'\n       THEN T.family_employees ELSE 0 END) /\n   SUM(CASE WHEN T.farmholding_system = 'Conventional farming'\n       THEN T.employees_total ELSE 0 END), 2) AS percentage_family_employees_conventional_farming\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n"
      },
      {
        "question": "Does the average organic farm have less employees than the average non-organic farm in 2022?",
        "query": "SELECT farmholding_system, employees_total / farmholdings AS average_employees_per_farm\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.name = 'Switzerland'\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n"
      },
      {
        "question": "What farm animals were bred in the canton of Bern in 2020?",
        "query": "SELECT livestock_beef_cattle_and_cows, livestock_sheep, livestock_goats, livestock_pigs, livestock_poultry, livestock_other_animals\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Bern%'\n    AND S.canton = 'TRUE'\n    AND T.year = 2020\n    AND T.farmholding_system = 'Farmholding system - total';\n"
      },
      {
        "question": "Does the average organic farm have less employees than the average non-organic farm in 2022?",
        "query": "SELECT farmholding_system, employees_total / farmholdings AS average_employees_per_farm\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.name = 'Switzerland'\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n"
      },
      {
        "question": "Which five cantons had in 2022 the highest percentage of women farmers in mangement position? Also provide the precentage of women who had a manager position.",
        "query": "SELECT S.name as canton,\n  ROUND(100 * SUM(T.employees_women_manager_label) / SUM(T.employees_women), 2) AS percentage_women_managers\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total'\nGROUP BY S.name\nORDER BY percentage_women_managers DESC\nLIMIT 5;\n"
      },
      {
        "question": "How did organic versus conventional farming develop in Kanton Uri between 2010 and 2020? Consider the farm area and the number of farms and give the differences.",
        "query": "SELECT\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) AS increase_organic_farm_area_in_ha,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Organic farming'\n       THEN T.farmholdings ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Organic farming'\n       THEN T.farmholdings ELSE 0 END) AS increase_number_of_organic_farms,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Conventional farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Conventional farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) AS increase_conventional_farm_area_in_ha,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Conventional farming'\n       THEN T.farmholdings ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Conventional farming'\n       THEN T.farmholdings ELSE 0 END) AS increase_number_of_conventional_farms\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND S.name LIKE '%Uri%'\n  AND T.year IN (2010, 2020)\n  AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.employees_farmholdings_agricultural_area_livestock_per_canton (\n\tuid SERIAL NOT NULL, \n\tfarmholding_system TEXT, \n\tyear INTEGER, \n\tfarmholdings NUMERIC, \n\temployees_total NUMERIC, \n\tfull_time_employees_75_percent_or_more NUMERIC, \n\tpart_time_employees_50_75_percent NUMERIC, \n\tpart_time_employees_2_less_than_50_percent NUMERIC, \n\temployees_men NUMERIC, \n\temployees_women NUMERIC, \n\temployees_women_manager_label NUMERIC, \n\temployees_swiss NUMERIC, \n\temployees_foreign_nationals NUMERIC, \n\tfamily_employees NUMERIC, \n\tbeef_cattle_and_cows_farm NUMERIC, \n\thorse_and_other_equine_farm NUMERIC, \n\tsheep_farm NUMERIC, \n\tgoat_farm NUMERIC, \n\tpig_farms NUMERIC, \n\tpoultry_farm NUMERIC, \n\tfarms_with_other_animals NUMERIC, \n\tutilised_agricultural_area_in_hectares NUMERIC, \n\tarable_land_in_hectares NUMERIC, \n\tgrassland_in_hectares NUMERIC, \n\tpermanent_crops_in_hectares NUMERIC, \n\tother_utilised_agricultural_area_in_hectares NUMERIC, \n\tlivestock_beef_cattle_and_cows NUMERIC, \n\tlivestock_horses_and_other_equines NUMERIC, \n\tlivestock_sheep NUMERIC, \n\tlivestock_goats NUMERIC, \n\tlivestock_pigs NUMERIC, \n\tlivestock_poultry NUMERIC, \n\tlivestock_other_animals NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT employees_farmholdings_agricultural_area_livestock_per_can_pkey PRIMARY KEY (uid), \n\tCONSTRAINT employees_farmholdings_agricultural_area_l_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in employees_farmholdings_agricultural_area_livestock_per_canton and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nyear : 2015, 2009, 2000, 2012, 2019\nfarmholdings : 3300, 412, 3149, 348, 51860\nemployees_total : 13632, 189566, 225149, 17343, 149521\nfull_time_employees_75_percent_or_more : 5316, 72633, 70625, 80436, 4937\npart_time_employees_50_75_percent : 2056, 2277, 41165, 2120, 37276\npart_time_employees_2_less_than_50_percent : 51446, 4005, 3014, 4506, 3404\nemployees_men : 144280, 839, 125547, 98822, 5275\nemployees_women : 71887, 459, 54872, 7197, 3312\nemployees_women_manager_label : 1393, 192, 2560, 412, 459\nemployees_swiss : 140137, 17057, 140683, 11125, 9677\nemployees_foreign_nationals : 17032, 1510, 1025, 870, 1146\nfamily_employees : 928, 1053, 9874, 823, 180894\nbeef_cattle_and_cows_farm : 5242, 252, 235, 4937, 3103\nhorse_and_other_equine_farm : 12225, 127, 839, 870, 115\nsheep_farm : 11399, 72, 291, 88, 335\ngoat_farm : 5076, 8496, 8083, 5151, 8168\npig_farms : 235, 252, 291, 136, 333\npoultry_farm : 1800, 2163, 2033, 11387, 1608\nfarms_with_other_animals : 72, 6098, 57, 348, 358\nutilised_agricultural_area_in_hectares : 76523.139999999999418, 935676.880299999960698, 67243.500000000000000, 67686.110000000000582, 1082876.239999999990687\narable_land_in_hectares : 4430.869999999999890861, 269648.469999999972060323, 279671.130000000004656613, 28704.027600000001257285, 30115.979999999999563443\ngrassland_in_hectares : 4136.470000000000255, 39994.673999999999069, 4332.409999999999854, 38283.739999999997963, 98902.110000000000582\npermanent_crops_in_hectares : 21936.409999999999854481, 1407.559999999999945430, 23116.000000000000000000, 1321.730000000000018190, 22537.479999999999563443\nother_utilised_agricultural_area_in_hectares : 1630.089999999999918145, 1998.039999999999963620, 11233.479999999999563443, 12720.547099999999772990, 9423.579999999999927240\nlivestock_beef_cattle_and_cows : 160950, 1427327, 1544612, 95020, 9387\nlivestock_horses_and_other_equines : 75864, 69723, 68180, 10577, 6035\nlivestock_sheep : 263861, 11709, 256902, 329033, 417274\nlivestock_goats : 66007, 2226, 67416, 2192, 333\nlivestock_pigs : 42366, 31885, 1468313, 559, 1544017\nlivestock_poultry : 360738, 327285, 34710, 10824616, 342966\nlivestock_other_animals : 481, 81566, 4893, 111801, 9194\n*/\n\n/*\nColumn name, Column discription, Example values\nfarmholding_system, None, Farmholding system - total,Organic farming,Conventional farming\nfarmholdings, None, 48344,48864,49363\nemployees_total, None, 149578,150231,149521\nfull_time_employees_75_percent_or_more, None, 66349,66453,66333\npart_time_employees_50_75_percent, None, 30083,30038,29920\npart_time_employees_2_less_than_50_percent, None, 53146,53740,53268\nemployees_men, None, 94706,95486,95252\nemployees_women, None, 54872,54745,54269\nemployees_women_manager_label, None, 3472,3362,3233\nemployees_swiss, None, 131072,131955,131581\nemployees_foreign_nationals, None, 18506,18276,17940\nfamily_employees, None, 112047,113317,113847\nbeef_cattle_and_cows_farm, None, 32581,33091,33662\nhorse_and_other_equine_farm, None, 11123,11196,11227\nsheep_farm, None, 7969,7977,8016\ngoat_farm, None, 6559,6592,6355\npig_farms, None, 5467,5561,5600\npoultry_farm, None, 14876,14434,13485\nfarms_with_other_animals, None, 6138,6101,6000\nutilised_agricultural_area_in_hectares, None, 1042013.785,1042053.004,1044033.706\narable_land_in_hectares, None, 276114.0758,276496.4816,274448.9291\ngrassland_in_hectares, None, 726091.9808,725854.0912,730039.4586\npermanent_crops_in_hectares, None, 24040.2951,24285.0786,24061.4945\nother_utilised_agricultural_area_in_hectares, None, 15767.4333,15417.3522,15483.8239\nlivestock_beef_cattle_and_cows, None, 1525270,1513701,1515123\nlivestock_horses_and_other_equines, None, 80950,80096,80072\nlivestock_sheep, None, 355893,349112,343528\nlivestock_goats, None, 82313,82045,79562\nlivestock_pigs, None, 1372772,1366359,1348306\nlivestock_poultry, None, 13219724,12676402,12541044\nlivestock_other_animals, None, 126789,137616,131876\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nHow did organic versus conventional farming develop in Kanton Uri between 2010 and 2020? Consider the farm area and the number of farms and give the differences.\n### SQL query\nSELECT\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) AS increase_organic_farm_area_in_ha,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Organic farming'\n       THEN T.farmholdings ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Organic farming'\n       THEN T.farmholdings ELSE 0 END) AS increase_number_of_organic_farms,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Conventional farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Conventional farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) AS increase_conventional_farm_area_in_ha,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Conventional farming'\n       THEN T.farmholdings ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Conventional farming'\n       THEN T.farmholdings ELSE 0 END) AS increase_number_of_conventional_farms\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND S.name LIKE '%Uri%'\n  AND T.year IN (2010, 2020)\n  AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n\n\n### Question\nWhat were the 5 cantons farming the most pigs in 2012?\n### SQL query\nSELECT S.name as canton_name, livestock_pigs as total_pigs\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2012\n    AND T.farmholding_system = 'Farmholding system - total'\nORDER BY livestock_pigs DESC\nLIMIT 5;\n\n\n### Question\nWhat farm animals were bred in the canton of Bern in 2020?\n### SQL query\nSELECT livestock_beef_cattle_and_cows, livestock_sheep, livestock_goats, livestock_pigs, livestock_poultry, livestock_other_animals\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Bern%'\n    AND S.canton = 'TRUE'\n    AND T.year = 2020\n    AND T.farmholding_system = 'Farmholding system - total';\n\n\n### Question\nWhat were the 5 cantons farming the most pigs in 2012?\n### SQL query\nSELECT S.name as canton_name, livestock_pigs as total_pigs\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2012\n    AND T.farmholding_system = 'Farmholding system - total'\nORDER BY livestock_pigs DESC\nLIMIT 5;\n\n\n### Question\nWhich 5 cantons had in 2022 the biggest precentage of their farm area used by organic farming? Order by the percentage of area used for organic farming.\n### SQL query\nSELECT S.name,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) /\n   NULLIF(SUM(CASE WHEN T.farmholding_system = 'Farmholding system - total'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END), 0), 2) AS percentage_of_organically_used_farmarea\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.canton = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Farmholding system - total')\nGROUP BY S.name\nORDER BY percentage_of_organically_used_farmarea DESC LIMIT 5;\n\n\n### Question\nWhat was the precentage of family employees in organic and conventional farming in 2022?\n### SQL query\nSELECT\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.family_employees ELSE 0 END) /\n   SUM(CASE WHEN T.farmholding_system = 'Organic farming'\n       THEN T.employees_total ELSE 0 END), 2) AS percentage_family_employees_organic_farming,\n   ROUND(100 * SUM(CASE WHEN T.farmholding_system = 'Conventional farming'\n       THEN T.family_employees ELSE 0 END) /\n   SUM(CASE WHEN T.farmholding_system = 'Conventional farming'\n       THEN T.employees_total ELSE 0 END), 2) AS percentage_family_employees_conventional_farming\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n\n\n### Question\nDoes the average organic farm have less employees than the average non-organic farm in 2022?\n### SQL query\nSELECT farmholding_system, employees_total / farmholdings AS average_employees_per_farm\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.name = 'Switzerland'\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n\n\n### Question\nWhat farm animals were bred in the canton of Bern in 2020?\n### SQL query\nSELECT livestock_beef_cattle_and_cows, livestock_sheep, livestock_goats, livestock_pigs, livestock_poultry, livestock_other_animals\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Bern%'\n    AND S.canton = 'TRUE'\n    AND T.year = 2020\n    AND T.farmholding_system = 'Farmholding system - total';\n\n\n### Question\nDoes the average organic farm have less employees than the average non-organic farm in 2022?\n### SQL query\nSELECT farmholding_system, employees_total / farmholdings AS average_employees_per_farm\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.name = 'Switzerland'\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n\n\n### Question\nWhich five cantons had in 2022 the highest percentage of women farmers in mangement position? Also provide the precentage of women who had a manager position.\n### SQL query\nSELECT S.name as canton,\n  ROUND(100 * SUM(T.employees_women_manager_label) / SUM(T.employees_women), 2) AS percentage_women_managers\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total'\nGROUP BY S.name\nORDER BY percentage_women_managers DESC\nLIMIT 5;\n\n\n### Question\nHow did organic versus conventional farming develop in Kanton Uri between 2010 and 2020? Consider the farm area and the number of farms and give the differences.\n### SQL query\nSELECT\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) AS increase_organic_farm_area_in_ha,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Organic farming'\n       THEN T.farmholdings ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Organic farming'\n       THEN T.farmholdings ELSE 0 END) AS increase_number_of_organic_farms,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Conventional farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Conventional farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) AS increase_conventional_farm_area_in_ha,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Conventional farming'\n       THEN T.farmholdings ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Conventional farming'\n       THEN T.farmholdings ELSE 0 END) AS increase_number_of_conventional_farms\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND S.name LIKE '%Uri%'\n  AND T.year IN (2010, 2020)\n  AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n\n\n### Question\nHow was the split between men and women in farm employment in canton Uri in 2015?\n### SQL query\n",
    "process_time": 9.161468436010182,
    "num_tokens": 5099,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 13,
    "question": "What was the total agricultural surface area in the canton of Geneva in 2000?",
    "query": "SELECT utilised_agricultural_area_in_hectares as utilised_agricultural_area_in_hectares_canton_geneva\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Canton Geneva'\n    AND S.canton = 'TRUE'\n    AND year = 2000\n    AND T.farmholding_system = 'Farmholding system - total';\n",
    "db_id": "employees_farmholdings_agricultural_area_livestock_per_canton",
    "generated_query": "SELECT utilised_agricultural_area_in_hectares\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Canton Geneva'\n    AND S.canton = 'TRUE'\n    AND year = 2000\n    AND T.farmholding_system = 'Farmholding system - total';",
    "meta_data": [
      {
        "question": "Which five cantons had in 2022 the highest percentage of women farmers in mangement position? Also provide the precentage of women who had a manager position.",
        "query": "SELECT S.name as canton,\n  ROUND(100 * SUM(T.employees_women_manager_label) / SUM(T.employees_women), 2) AS percentage_women_managers\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total'\nGROUP BY S.name\nORDER BY percentage_women_managers DESC\nLIMIT 5;\n"
      },
      {
        "question": "What are the percentages of part time work in Organic Farming?",
        "query": "SELECT ROUND(100 * full_time_employees_75_percent_or_more / employees_total, 2) AS precentage_75_percent_and_above,\n  ROUND(100 * part_time_employees_50_75_percent / employees_total, 2) AS percentage_of_between_50_and_75_percent,\n  ROUND(100 * part_time_employees_50_75_percent / employees_total, 2) AS percentage_below_50_precent\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2015\n    AND T.farmholding_system = 'Organic farming';\n"
      },
      {
        "question": "What farm animals were bred in the canton of Bern in 2020?",
        "query": "SELECT livestock_beef_cattle_and_cows, livestock_sheep, livestock_goats, livestock_pigs, livestock_poultry, livestock_other_animals\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Bern%'\n    AND S.canton = 'TRUE'\n    AND T.year = 2020\n    AND T.farmholding_system = 'Farmholding system - total';\n"
      },
      {
        "question": "How was the split between Swiss population and foreign nationals on Swiss farms in 2022?",
        "query": "SELECT ROUND(100 * employees_swiss / employees_total, 2) AS percentage_of_swiss_employees,\n  ROUND(100 * employees_foreign_nationals / employees_total, 2) AS percentage_foreign_nationals_employees\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total';\n"
      },
      {
        "question": "How was the split between Swiss population and foreign nationals on Swiss farms in 2022?",
        "query": "SELECT ROUND(100 * employees_swiss / employees_total, 2) AS percentage_of_swiss_employees,\n  ROUND(100 * employees_foreign_nationals / employees_total, 2) AS percentage_foreign_nationals_employees\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total';\n"
      },
      {
        "question": "How did organic versus conventional farming develop in Kanton Uri between 2010 and 2020? Consider the farm area and the number of farms and give the differences.",
        "query": "SELECT\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) AS increase_organic_farm_area_in_ha,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Organic farming'\n       THEN T.farmholdings ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Organic farming'\n       THEN T.farmholdings ELSE 0 END) AS increase_number_of_organic_farms,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Conventional farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Conventional farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) AS increase_conventional_farm_area_in_ha,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Conventional farming'\n       THEN T.farmholdings ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Conventional farming'\n       THEN T.farmholdings ELSE 0 END) AS increase_number_of_conventional_farms\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND S.name LIKE '%Uri%'\n  AND T.year IN (2010, 2020)\n  AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n"
      },
      {
        "question": "What was the average number of cows per farm in the canton of Vaud since 2017?",
        "query": "SELECT year, livestock_beef_cattle_and_cows / farmholdings AS average_cows_per_farmholding_vaud\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Canton Vaud'\n    AND S.canton = 'TRUE'\n    AND year >= 2017\n    AND T.farmholding_system = 'Farmholding system - total';\n"
      },
      {
        "question": "How was the split between Swiss population and foreign nationals on Swiss farms in 2022?",
        "query": "SELECT ROUND(100 * employees_swiss / employees_total, 2) AS percentage_of_swiss_employees,\n  ROUND(100 * employees_foreign_nationals / employees_total, 2) AS percentage_foreign_nationals_employees\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total';\n"
      },
      {
        "question": "What were the 5 cantons farming the most pigs in 2012?",
        "query": "SELECT S.name as canton_name, livestock_pigs as total_pigs\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2012\n    AND T.farmholding_system = 'Farmholding system - total'\nORDER BY livestock_pigs DESC\nLIMIT 5;\n"
      },
      {
        "question": "Does the average organic farm have less employees than the average non-organic farm in 2022?",
        "query": "SELECT farmholding_system, employees_total / farmholdings AS average_employees_per_farm\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.name = 'Switzerland'\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n"
      },
      {
        "question": "Does the average organic farm have less employees than the average non-organic farm in 2022?",
        "query": "SELECT farmholding_system, employees_total / farmholdings AS average_employees_per_farm\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.name = 'Switzerland'\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.employees_farmholdings_agricultural_area_livestock_per_canton (\n\tuid SERIAL NOT NULL, \n\tfarmholding_system TEXT, \n\tyear INTEGER, \n\tfarmholdings NUMERIC, \n\temployees_total NUMERIC, \n\tfull_time_employees_75_percent_or_more NUMERIC, \n\tpart_time_employees_50_75_percent NUMERIC, \n\tpart_time_employees_2_less_than_50_percent NUMERIC, \n\temployees_men NUMERIC, \n\temployees_women NUMERIC, \n\temployees_women_manager_label NUMERIC, \n\temployees_swiss NUMERIC, \n\temployees_foreign_nationals NUMERIC, \n\tfamily_employees NUMERIC, \n\tbeef_cattle_and_cows_farm NUMERIC, \n\thorse_and_other_equine_farm NUMERIC, \n\tsheep_farm NUMERIC, \n\tgoat_farm NUMERIC, \n\tpig_farms NUMERIC, \n\tpoultry_farm NUMERIC, \n\tfarms_with_other_animals NUMERIC, \n\tutilised_agricultural_area_in_hectares NUMERIC, \n\tarable_land_in_hectares NUMERIC, \n\tgrassland_in_hectares NUMERIC, \n\tpermanent_crops_in_hectares NUMERIC, \n\tother_utilised_agricultural_area_in_hectares NUMERIC, \n\tlivestock_beef_cattle_and_cows NUMERIC, \n\tlivestock_horses_and_other_equines NUMERIC, \n\tlivestock_sheep NUMERIC, \n\tlivestock_goats NUMERIC, \n\tlivestock_pigs NUMERIC, \n\tlivestock_poultry NUMERIC, \n\tlivestock_other_animals NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT employees_farmholdings_agricultural_area_livestock_per_can_pkey PRIMARY KEY (uid), \n\tCONSTRAINT employees_farmholdings_agricultural_area_l_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in employees_farmholdings_agricultural_area_livestock_per_canton and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nyear : 2015, 2009, 2000, 2012, 2019\nfarmholdings : 3300, 412, 3149, 348, 51860\nemployees_total : 13632, 189566, 225149, 17343, 149521\nfull_time_employees_75_percent_or_more : 5316, 72633, 70625, 80436, 4937\npart_time_employees_50_75_percent : 2056, 2277, 41165, 2120, 37276\npart_time_employees_2_less_than_50_percent : 51446, 4005, 3014, 4506, 3404\nemployees_men : 144280, 839, 125547, 98822, 5275\nemployees_women : 71887, 459, 54872, 7197, 3312\nemployees_women_manager_label : 1393, 192, 2560, 412, 459\nemployees_swiss : 140137, 17057, 140683, 11125, 9677\nemployees_foreign_nationals : 17032, 1510, 1025, 870, 1146\nfamily_employees : 928, 1053, 9874, 823, 180894\nbeef_cattle_and_cows_farm : 5242, 252, 235, 4937, 3103\nhorse_and_other_equine_farm : 12225, 127, 839, 870, 115\nsheep_farm : 11399, 72, 291, 88, 335\ngoat_farm : 5076, 8496, 8083, 5151, 8168\npig_farms : 235, 252, 291, 136, 333\npoultry_farm : 1800, 2163, 2033, 11387, 1608\nfarms_with_other_animals : 72, 6098, 57, 348, 358\nutilised_agricultural_area_in_hectares : 76523.139999999999418, 935676.880299999960698, 67243.500000000000000, 67686.110000000000582, 1082876.239999999990687\narable_land_in_hectares : 4430.869999999999890861, 269648.469999999972060323, 279671.130000000004656613, 28704.027600000001257285, 30115.979999999999563443\ngrassland_in_hectares : 4136.470000000000255, 39994.673999999999069, 4332.409999999999854, 38283.739999999997963, 98902.110000000000582\npermanent_crops_in_hectares : 21936.409999999999854481, 1407.559999999999945430, 23116.000000000000000000, 1321.730000000000018190, 22537.479999999999563443\nother_utilised_agricultural_area_in_hectares : 1630.089999999999918145, 1998.039999999999963620, 11233.479999999999563443, 12720.547099999999772990, 9423.579999999999927240\nlivestock_beef_cattle_and_cows : 160950, 1427327, 1544612, 95020, 9387\nlivestock_horses_and_other_equines : 75864, 69723, 68180, 10577, 6035\nlivestock_sheep : 263861, 11709, 256902, 329033, 417274\nlivestock_goats : 66007, 2226, 67416, 2192, 333\nlivestock_pigs : 42366, 31885, 1468313, 559, 1544017\nlivestock_poultry : 360738, 327285, 34710, 10824616, 342966\nlivestock_other_animals : 481, 81566, 4893, 111801, 9194\n*/\n\n/*\nColumn name, Column discription, Example values\nfarmholding_system, None, Farmholding system - total,Organic farming,Conventional farming\nfarmholdings, None, 48344,48864,49363\nemployees_total, None, 149578,150231,149521\nfull_time_employees_75_percent_or_more, None, 66349,66453,66333\npart_time_employees_50_75_percent, None, 30083,30038,29920\npart_time_employees_2_less_than_50_percent, None, 53146,53740,53268\nemployees_men, None, 94706,95486,95252\nemployees_women, None, 54872,54745,54269\nemployees_women_manager_label, None, 3472,3362,3233\nemployees_swiss, None, 131072,131955,131581\nemployees_foreign_nationals, None, 18506,18276,17940\nfamily_employees, None, 112047,113317,113847\nbeef_cattle_and_cows_farm, None, 32581,33091,33662\nhorse_and_other_equine_farm, None, 11123,11196,11227\nsheep_farm, None, 7969,7977,8016\ngoat_farm, None, 6559,6592,6355\npig_farms, None, 5467,5561,5600\npoultry_farm, None, 14876,14434,13485\nfarms_with_other_animals, None, 6138,6101,6000\nutilised_agricultural_area_in_hectares, None, 1042013.785,1042053.004,1044033.706\narable_land_in_hectares, None, 276114.0758,276496.4816,274448.9291\ngrassland_in_hectares, None, 726091.9808,725854.0912,730039.4586\npermanent_crops_in_hectares, None, 24040.2951,24285.0786,24061.4945\nother_utilised_agricultural_area_in_hectares, None, 15767.4333,15417.3522,15483.8239\nlivestock_beef_cattle_and_cows, None, 1525270,1513701,1515123\nlivestock_horses_and_other_equines, None, 80950,80096,80072\nlivestock_sheep, None, 355893,349112,343528\nlivestock_goats, None, 82313,82045,79562\nlivestock_pigs, None, 1372772,1366359,1348306\nlivestock_poultry, None, 13219724,12676402,12541044\nlivestock_other_animals, None, 126789,137616,131876\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWhich five cantons had in 2022 the highest percentage of women farmers in mangement position? Also provide the precentage of women who had a manager position.\n### SQL query\nSELECT S.name as canton,\n  ROUND(100 * SUM(T.employees_women_manager_label) / SUM(T.employees_women), 2) AS percentage_women_managers\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total'\nGROUP BY S.name\nORDER BY percentage_women_managers DESC\nLIMIT 5;\n\n\n### Question\nWhat are the percentages of part time work in Organic Farming?\n### SQL query\nSELECT ROUND(100 * full_time_employees_75_percent_or_more / employees_total, 2) AS precentage_75_percent_and_above,\n  ROUND(100 * part_time_employees_50_75_percent / employees_total, 2) AS percentage_of_between_50_and_75_percent,\n  ROUND(100 * part_time_employees_50_75_percent / employees_total, 2) AS percentage_below_50_precent\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2015\n    AND T.farmholding_system = 'Organic farming';\n\n\n### Question\nWhat farm animals were bred in the canton of Bern in 2020?\n### SQL query\nSELECT livestock_beef_cattle_and_cows, livestock_sheep, livestock_goats, livestock_pigs, livestock_poultry, livestock_other_animals\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name LIKE '%Bern%'\n    AND S.canton = 'TRUE'\n    AND T.year = 2020\n    AND T.farmholding_system = 'Farmholding system - total';\n\n\n### Question\nHow was the split between Swiss population and foreign nationals on Swiss farms in 2022?\n### SQL query\nSELECT ROUND(100 * employees_swiss / employees_total, 2) AS percentage_of_swiss_employees,\n  ROUND(100 * employees_foreign_nationals / employees_total, 2) AS percentage_foreign_nationals_employees\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total';\n\n\n### Question\nHow was the split between Swiss population and foreign nationals on Swiss farms in 2022?\n### SQL query\nSELECT ROUND(100 * employees_swiss / employees_total, 2) AS percentage_of_swiss_employees,\n  ROUND(100 * employees_foreign_nationals / employees_total, 2) AS percentage_foreign_nationals_employees\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total';\n\n\n### Question\nHow did organic versus conventional farming develop in Kanton Uri between 2010 and 2020? Consider the farm area and the number of farms and give the differences.\n### SQL query\nSELECT\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Organic farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) AS increase_organic_farm_area_in_ha,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Organic farming'\n       THEN T.farmholdings ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Organic farming'\n       THEN T.farmholdings ELSE 0 END) AS increase_number_of_organic_farms,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Conventional farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Conventional farming'\n       THEN T.utilised_agricultural_area_in_hectares ELSE 0 END) AS increase_conventional_farm_area_in_ha,\n   SUM(CASE WHEN T.year = 2020 AND T.farmholding_system = 'Conventional farming'\n       THEN T.farmholdings ELSE 0 END) -\n   SUM(CASE WHEN T.year = 2010 AND T.farmholding_system = 'Conventional farming'\n       THEN T.farmholdings ELSE 0 END) AS increase_number_of_conventional_farms\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND S.name LIKE '%Uri%'\n  AND T.year IN (2010, 2020)\n  AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n\n\n### Question\nWhat was the average number of cows per farm in the canton of Vaud since 2017?\n### SQL query\nSELECT year, livestock_beef_cattle_and_cows / farmholdings AS average_cows_per_farmholding_vaud\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Canton Vaud'\n    AND S.canton = 'TRUE'\n    AND year >= 2017\n    AND T.farmholding_system = 'Farmholding system - total';\n\n\n### Question\nHow was the split between Swiss population and foreign nationals on Swiss farms in 2022?\n### SQL query\nSELECT ROUND(100 * employees_swiss / employees_total, 2) AS percentage_of_swiss_employees,\n  ROUND(100 * employees_foreign_nationals / employees_total, 2) AS percentage_foreign_nationals_employees\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND year = 2022\n    AND T.farmholding_system = 'Farmholding system - total';\n\n\n### Question\nWhat were the 5 cantons farming the most pigs in 2012?\n### SQL query\nSELECT S.name as canton_name, livestock_pigs as total_pigs\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND year = 2012\n    AND T.farmholding_system = 'Farmholding system - total'\nORDER BY livestock_pigs DESC\nLIMIT 5;\n\n\n### Question\nDoes the average organic farm have less employees than the average non-organic farm in 2022?\n### SQL query\nSELECT farmholding_system, employees_total / farmholdings AS average_employees_per_farm\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.name = 'Switzerland'\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n\n\n### Question\nDoes the average organic farm have less employees than the average non-organic farm in 2022?\n### SQL query\nSELECT farmholding_system, employees_total / farmholdings AS average_employees_per_farm\nFROM employees_farmholdings_agricultural_area_livestock_per_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2022\n    AND S.name = 'Switzerland'\n    AND S.country = 'TRUE'\n    AND T.farmholding_system IN ('Organic farming', 'Conventional farming');\n\n\n### Question\nWhat was the total agricultural surface area in the canton of Geneva in 2000?\n### SQL query\n",
    "process_time": 9.556117210071534,
    "num_tokens": 4627,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 14,
    "question": "What was the population change due to natural factors among the residents of Canton Vaud between 2015 and 2020?",
    "query": "SELECT year, births - deaths\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Vaud%'\n    AND T.year >= 2015\n    AND T.year >= 2020\n    AND T.citizenship_category = 'Citizenship (category) - total';\n",
    "db_id": "demographic_balance_by_canton",
    "generated_query": "SELECT population_change\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Vaud'\n    AND T.year >= 2015\n    AND T.year <= 2020\n    AND T.citizenship_category = 'Citizenship (category) - total'",
    "meta_data": [
      {
        "question": "In which year did Switzerland experience its highest birth rate?",
        "query": "SELECT T.year, T.births / T.total_population as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND S.name = 'Switzerland'\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, T.births, T.total_population\nORDER BY birthrate DESC\nLIMIT 1;\n"
      },
      {
        "question": "In which year did Switzerland experience its highest birth rate?",
        "query": "SELECT T.year, T.births / T.total_population as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND S.name = 'Switzerland'\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, T.births, T.total_population\nORDER BY birthrate DESC\nLIMIT 1;\n"
      },
      {
        "question": "Which five cantons had the highest number of Swiss citizenship acquisitions in 2017 relative to their population?",
        "query": "SELECT S.name, acquisition_of_swiss_citizenship / total_population as relative_acquisition\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2017\n    AND T.citizenship_category = 'Switzerland'\nORDER BY relative_acquisition DESC\nLIMIT 5;\n"
      },
      {
        "question": "Give me the total population of each canton in 2019.",
        "query": "SELECT S.name as canton, total_population as total_population_2019\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2019\n    AND T.citizenship_category = 'Citizenship (category) - total'\nORDER BY total_population DESC;\n"
      },
      {
        "question": "Which five cantons had the highest number of Swiss citizenship acquisitions in 2017 relative to their population?",
        "query": "SELECT S.name, acquisition_of_swiss_citizenship / total_population as relative_acquisition\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2017\n    AND T.citizenship_category = 'Switzerland'\nORDER BY relative_acquisition DESC\nLIMIT 5;\n"
      },
      {
        "question": "In which year did Switzerland experience its highest birth rate?",
        "query": "SELECT T.year, T.births / T.total_population as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND S.name = 'Switzerland'\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, T.births, T.total_population\nORDER BY birthrate DESC\nLIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.demographic_balance_by_canton (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tcitizenship_category TEXT, \n\ttotal_population NUMERIC, \n\tbirths NUMERIC, \n\tdeaths NUMERIC, \n\timmigration NUMERIC, \n\tin_migration_from_another_canton NUMERIC, \n\temigration NUMERIC, \n\tout_migration_to_another_canton NUMERIC, \n\tnet_migration NUMERIC, \n\tacquisition_of_swiss_citizenship NUMERIC, \n\tstatistical_adjustment NUMERIC, \n\tpopulation_change NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT demographic_balance_by_canton_pkey PRIMARY KEY (uid), \n\tCONSTRAINT demographic_balance_by_canton_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in demographic_balance_by_canton and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nyear : 1988, 1989, 2000, 1991, 1993\ntotal_population : 937551, 1127659, 5917216, 1187609, 6409713\nbirths : 10555, 12542, 62457, 12743, 23291\ndeaths : 3662, 58242, 9994, 57885, 1018\nimmigration : 4838, 99091, 4290, 16001, 120188\nin_migration_from_another_canton : 7025, 88649, 14196, 128201, 1997\nemigration : 15189, 78419, 103881, 54435, 28496\nout_migration_to_another_canton : 88649, 128201, 2192, 3447, 138936\nnet_migration : 98167, 89541, 1606, 26392, 21600\nacquisition_of_swiss_citizenship : -27583, -43889, 12898, 5200, 39314\nstatistical_adjustment : -1037, 1510, -3710, -193, 3820\npopulation_change : 6484, 85580, 3391, 21244, 15119\n*/\n\n/*\nColumn name, Column discription, Example values\ntotal_population, Total population recorded this year, 6335243,5421746,913497\nbirths, Number of live births recorded, 73747,61611,12136\ndeaths, Number of deaths recorded, 59763,56032,3731\nimmigration, Number of people becoming Swiss residents, 121420,28483,92937\nemigration, Number of Swiss residents leaving, 97743,27796,69947\nin_migration_from_another_canton, Number of people moving in from another canton, 134359,119608,14751\nout_migration_to_another_canton, Number of people moving to a different canton, 134359,119608,14751\nnet_migration, Difference between the number of arrivals and departures, 23677,687,22990\nacquisition_of_swiss_citizenship, Number of people acquiring swiss nationality, 0,14299,-14299\nstatistical_adjustment, Changes to the population size that cannot be clearly attributed to demographic movements, 0,574,-34\npopulation_change, Difference in the number of people compared to the previous year, 37661,20565,17096\ncitizenship_category, Citizenship category, Citizenship (category) - total,Foreign country,Switzerland\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nIn which year did Switzerland experience its highest birth rate?\n### SQL query\nSELECT T.year, T.births / T.total_population as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND S.name = 'Switzerland'\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, T.births, T.total_population\nORDER BY birthrate DESC\nLIMIT 1;\n\n\n### Question\nIn which year did Switzerland experience its highest birth rate?\n### SQL query\nSELECT T.year, T.births / T.total_population as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND S.name = 'Switzerland'\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, T.births, T.total_population\nORDER BY birthrate DESC\nLIMIT 1;\n\n\n### Question\nWhich five cantons had the highest number of Swiss citizenship acquisitions in 2017 relative to their population?\n### SQL query\nSELECT S.name, acquisition_of_swiss_citizenship / total_population as relative_acquisition\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2017\n    AND T.citizenship_category = 'Switzerland'\nORDER BY relative_acquisition DESC\nLIMIT 5;\n\n\n### Question\nGive me the total population of each canton in 2019.\n### SQL query\nSELECT S.name as canton, total_population as total_population_2019\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2019\n    AND T.citizenship_category = 'Citizenship (category) - total'\nORDER BY total_population DESC;\n\n\n### Question\nWhich five cantons had the highest number of Swiss citizenship acquisitions in 2017 relative to their population?\n### SQL query\nSELECT S.name, acquisition_of_swiss_citizenship / total_population as relative_acquisition\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2017\n    AND T.citizenship_category = 'Switzerland'\nORDER BY relative_acquisition DESC\nLIMIT 5;\n\n\n### Question\nIn which year did Switzerland experience its highest birth rate?\n### SQL query\nSELECT T.year, T.births / T.total_population as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND S.name = 'Switzerland'\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, T.births, T.total_population\nORDER BY birthrate DESC\nLIMIT 1;\n\n\n### Question\nWhat was the population change due to natural factors among the residents of Canton Vaud between 2015 and 2020?\n### SQL query\n",
    "process_time": 9.187336642062292,
    "num_tokens": 2139,
    "hardness": "hard",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 15,
    "question": "Which canton has the highest number of residents who have moved from other cantons in 2016?",
    "query": "SELECT S.name, T.in_migration_from_another_canton\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2016\n    AND T.citizenship_category = 'Citizenship (category) - total'\nORDER BY T.in_migration_from_another_canton DESC\nLIMIT 1;\n",
    "db_id": "demographic_balance_by_canton",
    "generated_query": "SELECT S.name, in_migration_from_another_canton as residents_from_other_cantons\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2016\n    AND T.citizenship_category = 'Citizenship (category) - total'\nORDER BY residents_from_other_cantons DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "In which year did Switzerland experience its highest birth rate?",
        "query": "SELECT T.year, T.births / T.total_population as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND S.name = 'Switzerland'\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, T.births, T.total_population\nORDER BY birthrate DESC\nLIMIT 1;\n"
      },
      {
        "question": "Which five cantons had the highest number of Swiss citizenship acquisitions in 2017 relative to their population?",
        "query": "SELECT S.name, acquisition_of_swiss_citizenship / total_population as relative_acquisition\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2017\n    AND T.citizenship_category = 'Switzerland'\nORDER BY relative_acquisition DESC\nLIMIT 5;\n"
      },
      {
        "question": "Give me the total population of each canton in 2019.",
        "query": "SELECT S.name as canton, total_population as total_population_2019\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2019\n    AND T.citizenship_category = 'Citizenship (category) - total'\nORDER BY total_population DESC;\n"
      },
      {
        "question": "Give me the total population of each canton in 2019.",
        "query": "SELECT S.name as canton, total_population as total_population_2019\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2019\n    AND T.citizenship_category = 'Citizenship (category) - total'\nORDER BY total_population DESC;\n"
      },
      {
        "question": "Which cantons experienced a population decline in 2017, and by how much?",
        "query": "SELECT S.name, population_change\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.population_change < 0\n    AND T.year = 2017\n    AND T.citizenship_category = 'Citizenship (category) - total';\n"
      },
      {
        "question": "Show me the cantons with the highest birth rates every year between 1995 and 2010.",
        "query": "SELECT year, S.name as most_populout_canton, MAX(births / total_population) as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year >= 1995\n    AND T.year <= 2010\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, S.name, T.births\nORDER BY year ASC;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.demographic_balance_by_canton (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tcitizenship_category TEXT, \n\ttotal_population NUMERIC, \n\tbirths NUMERIC, \n\tdeaths NUMERIC, \n\timmigration NUMERIC, \n\tin_migration_from_another_canton NUMERIC, \n\temigration NUMERIC, \n\tout_migration_to_another_canton NUMERIC, \n\tnet_migration NUMERIC, \n\tacquisition_of_swiss_citizenship NUMERIC, \n\tstatistical_adjustment NUMERIC, \n\tpopulation_change NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT demographic_balance_by_canton_pkey PRIMARY KEY (uid), \n\tCONSTRAINT demographic_balance_by_canton_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in demographic_balance_by_canton and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nyear : 1988, 1989, 2000, 1991, 1993\ntotal_population : 937551, 1127659, 5917216, 1187609, 6409713\nbirths : 10555, 12542, 62457, 12743, 23291\ndeaths : 3662, 58242, 9994, 57885, 1018\nimmigration : 4838, 99091, 4290, 16001, 120188\nin_migration_from_another_canton : 7025, 88649, 14196, 128201, 1997\nemigration : 15189, 78419, 103881, 54435, 28496\nout_migration_to_another_canton : 88649, 128201, 2192, 3447, 138936\nnet_migration : 98167, 89541, 1606, 26392, 21600\nacquisition_of_swiss_citizenship : -27583, -43889, 12898, 5200, 39314\nstatistical_adjustment : -1037, 1510, -3710, -193, 3820\npopulation_change : 6484, 85580, 3391, 21244, 15119\n*/\n\n/*\nColumn name, Column discription, Example values\ntotal_population, Total population recorded this year, 6335243,5421746,913497\nbirths, Number of live births recorded, 73747,61611,12136\ndeaths, Number of deaths recorded, 59763,56032,3731\nimmigration, Number of people becoming Swiss residents, 121420,28483,92937\nemigration, Number of Swiss residents leaving, 97743,27796,69947\nin_migration_from_another_canton, Number of people moving in from another canton, 134359,119608,14751\nout_migration_to_another_canton, Number of people moving to a different canton, 134359,119608,14751\nnet_migration, Difference between the number of arrivals and departures, 23677,687,22990\nacquisition_of_swiss_citizenship, Number of people acquiring swiss nationality, 0,14299,-14299\nstatistical_adjustment, Changes to the population size that cannot be clearly attributed to demographic movements, 0,574,-34\npopulation_change, Difference in the number of people compared to the previous year, 37661,20565,17096\ncitizenship_category, Citizenship category, Citizenship (category) - total,Foreign country,Switzerland\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nIn which year did Switzerland experience its highest birth rate?\n### SQL query\nSELECT T.year, T.births / T.total_population as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND S.name = 'Switzerland'\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, T.births, T.total_population\nORDER BY birthrate DESC\nLIMIT 1;\n\n\n### Question\nWhich five cantons had the highest number of Swiss citizenship acquisitions in 2017 relative to their population?\n### SQL query\nSELECT S.name, acquisition_of_swiss_citizenship / total_population as relative_acquisition\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2017\n    AND T.citizenship_category = 'Switzerland'\nORDER BY relative_acquisition DESC\nLIMIT 5;\n\n\n### Question\nGive me the total population of each canton in 2019.\n### SQL query\nSELECT S.name as canton, total_population as total_population_2019\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2019\n    AND T.citizenship_category = 'Citizenship (category) - total'\nORDER BY total_population DESC;\n\n\n### Question\nGive me the total population of each canton in 2019.\n### SQL query\nSELECT S.name as canton, total_population as total_population_2019\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2019\n    AND T.citizenship_category = 'Citizenship (category) - total'\nORDER BY total_population DESC;\n\n\n### Question\nWhich cantons experienced a population decline in 2017, and by how much?\n### SQL query\nSELECT S.name, population_change\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.population_change < 0\n    AND T.year = 2017\n    AND T.citizenship_category = 'Citizenship (category) - total';\n\n\n### Question\nShow me the cantons with the highest birth rates every year between 1995 and 2010.\n### SQL query\nSELECT year, S.name as most_populout_canton, MAX(births / total_population) as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year >= 1995\n    AND T.year <= 2010\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, S.name, T.births\nORDER BY year ASC;\n\n\n### Question\nWhich canton has the highest number of residents who have moved from other cantons in 2016?\n### SQL query\n",
    "process_time": 5.993826929014176,
    "num_tokens": 2134,
    "hardness": "extra",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 16,
    "question": "How many residents were in Switzerland in 2018?",
    "query": "SELECT total_population as total_population_of_switzerland_in_2018\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n    AND S.country = 'TRUE'\n    AND T.year = 2018\n    AND T.citizenship_category = 'Citizenship (category) - total';\n",
    "db_id": "demographic_balance_by_canton",
    "generated_query": "SELECT SUM(total_population) as total_residents\nFROM demographic_balance_by_canton\nWHERE year = 2018\n    AND citizenship_category = 'Citizenship (category) - total';",
    "meta_data": [
      {
        "question": "Give me the total population of each canton in 2019.",
        "query": "SELECT S.name as canton, total_population as total_population_2019\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2019\n    AND T.citizenship_category = 'Citizenship (category) - total'\nORDER BY total_population DESC;\n"
      },
      {
        "question": "Show me the cantons with the highest birth rates every year between 1995 and 2010.",
        "query": "SELECT year, S.name as most_populout_canton, MAX(births / total_population) as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year >= 1995\n    AND T.year <= 2010\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, S.name, T.births\nORDER BY year ASC;\n"
      },
      {
        "question": "Give me the total population of each canton in 2019.",
        "query": "SELECT S.name as canton, total_population as total_population_2019\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2019\n    AND T.citizenship_category = 'Citizenship (category) - total'\nORDER BY total_population DESC;\n"
      },
      {
        "question": "Which cantons experienced a population decline in 2017, and by how much?",
        "query": "SELECT S.name, population_change\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.population_change < 0\n    AND T.year = 2017\n    AND T.citizenship_category = 'Citizenship (category) - total';\n"
      },
      {
        "question": "Which five cantons had the highest number of Swiss citizenship acquisitions in 2017 relative to their population?",
        "query": "SELECT S.name, acquisition_of_swiss_citizenship / total_population as relative_acquisition\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2017\n    AND T.citizenship_category = 'Switzerland'\nORDER BY relative_acquisition DESC\nLIMIT 5;\n"
      },
      {
        "question": "Which cantons experienced a population decline in 2017, and by how much?",
        "query": "SELECT S.name, population_change\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.population_change < 0\n    AND T.year = 2017\n    AND T.citizenship_category = 'Citizenship (category) - total';\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.demographic_balance_by_canton (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tcitizenship_category TEXT, \n\ttotal_population NUMERIC, \n\tbirths NUMERIC, \n\tdeaths NUMERIC, \n\timmigration NUMERIC, \n\tin_migration_from_another_canton NUMERIC, \n\temigration NUMERIC, \n\tout_migration_to_another_canton NUMERIC, \n\tnet_migration NUMERIC, \n\tacquisition_of_swiss_citizenship NUMERIC, \n\tstatistical_adjustment NUMERIC, \n\tpopulation_change NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT demographic_balance_by_canton_pkey PRIMARY KEY (uid), \n\tCONSTRAINT demographic_balance_by_canton_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in demographic_balance_by_canton and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nyear : 1988, 1989, 2000, 1991, 1993\ntotal_population : 937551, 1127659, 5917216, 1187609, 6409713\nbirths : 10555, 12542, 62457, 12743, 23291\ndeaths : 3662, 58242, 9994, 57885, 1018\nimmigration : 4838, 99091, 4290, 16001, 120188\nin_migration_from_another_canton : 7025, 88649, 14196, 128201, 1997\nemigration : 15189, 78419, 103881, 54435, 28496\nout_migration_to_another_canton : 88649, 128201, 2192, 3447, 138936\nnet_migration : 98167, 89541, 1606, 26392, 21600\nacquisition_of_swiss_citizenship : -27583, -43889, 12898, 5200, 39314\nstatistical_adjustment : -1037, 1510, -3710, -193, 3820\npopulation_change : 6484, 85580, 3391, 21244, 15119\n*/\n\n/*\nColumn name, Column discription, Example values\ntotal_population, Total population recorded this year, 6335243,5421746,913497\nbirths, Number of live births recorded, 73747,61611,12136\ndeaths, Number of deaths recorded, 59763,56032,3731\nimmigration, Number of people becoming Swiss residents, 121420,28483,92937\nemigration, Number of Swiss residents leaving, 97743,27796,69947\nin_migration_from_another_canton, Number of people moving in from another canton, 134359,119608,14751\nout_migration_to_another_canton, Number of people moving to a different canton, 134359,119608,14751\nnet_migration, Difference between the number of arrivals and departures, 23677,687,22990\nacquisition_of_swiss_citizenship, Number of people acquiring swiss nationality, 0,14299,-14299\nstatistical_adjustment, Changes to the population size that cannot be clearly attributed to demographic movements, 0,574,-34\npopulation_change, Difference in the number of people compared to the previous year, 37661,20565,17096\ncitizenship_category, Citizenship category, Citizenship (category) - total,Foreign country,Switzerland\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nGive me the total population of each canton in 2019.\n### SQL query\nSELECT S.name as canton, total_population as total_population_2019\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2019\n    AND T.citizenship_category = 'Citizenship (category) - total'\nORDER BY total_population DESC;\n\n\n### Question\nShow me the cantons with the highest birth rates every year between 1995 and 2010.\n### SQL query\nSELECT year, S.name as most_populout_canton, MAX(births / total_population) as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year >= 1995\n    AND T.year <= 2010\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, S.name, T.births\nORDER BY year ASC;\n\n\n### Question\nGive me the total population of each canton in 2019.\n### SQL query\nSELECT S.name as canton, total_population as total_population_2019\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2019\n    AND T.citizenship_category = 'Citizenship (category) - total'\nORDER BY total_population DESC;\n\n\n### Question\nWhich cantons experienced a population decline in 2017, and by how much?\n### SQL query\nSELECT S.name, population_change\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.population_change < 0\n    AND T.year = 2017\n    AND T.citizenship_category = 'Citizenship (category) - total';\n\n\n### Question\nWhich five cantons had the highest number of Swiss citizenship acquisitions in 2017 relative to their population?\n### SQL query\nSELECT S.name, acquisition_of_swiss_citizenship / total_population as relative_acquisition\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2017\n    AND T.citizenship_category = 'Switzerland'\nORDER BY relative_acquisition DESC\nLIMIT 5;\n\n\n### Question\nWhich cantons experienced a population decline in 2017, and by how much?\n### SQL query\nSELECT S.name, population_change\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.population_change < 0\n    AND T.year = 2017\n    AND T.citizenship_category = 'Citizenship (category) - total';\n\n\n### Question\nHow many residents were in Switzerland in 2018?\n### SQL query\n",
    "process_time": 4.917031429009512,
    "num_tokens": 2109,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 17,
    "question": "What was the net migration of Switzerland from 2012 to 2022?",
    "query": "SELECT year, net_migration as net_migration_of_switzerland\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n    AND S.country = 'TRUE'\n    AND T.year >= 2012\n    AND T.year <= 2022\n    AND T.citizenship_category = 'Citizenship (category) - total';\n",
    "db_id": "demographic_balance_by_canton",
    "generated_query": "SELECT SUM(net_migration) as net_migration\nFROM demographic_balance_by_canton\nWHERE year >= 2012 AND year <= 2022\n    AND citizenship_category = 'Citizenship (category) - total';",
    "meta_data": [
      {
        "question": "In which year did Switzerland experience its highest birth rate?",
        "query": "SELECT T.year, T.births / T.total_population as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND S.name = 'Switzerland'\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, T.births, T.total_population\nORDER BY birthrate DESC\nLIMIT 1;\n"
      },
      {
        "question": "In which year did Switzerland experience its highest birth rate?",
        "query": "SELECT T.year, T.births / T.total_population as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND S.name = 'Switzerland'\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, T.births, T.total_population\nORDER BY birthrate DESC\nLIMIT 1;\n"
      },
      {
        "question": "Show me the cantons with the highest birth rates every year between 1995 and 2010.",
        "query": "SELECT year, S.name as most_populout_canton, MAX(births / total_population) as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year >= 1995\n    AND T.year <= 2010\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, S.name, T.births\nORDER BY year ASC;\n"
      },
      {
        "question": "Which five cantons had the highest number of Swiss citizenship acquisitions in 2017 relative to their population?",
        "query": "SELECT S.name, acquisition_of_swiss_citizenship / total_population as relative_acquisition\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2017\n    AND T.citizenship_category = 'Switzerland'\nORDER BY relative_acquisition DESC\nLIMIT 5;\n"
      },
      {
        "question": "Which cantons experienced a population decline in 2017, and by how much?",
        "query": "SELECT S.name, population_change\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.population_change < 0\n    AND T.year = 2017\n    AND T.citizenship_category = 'Citizenship (category) - total';\n"
      },
      {
        "question": "In which year did Switzerland experience its highest birth rate?",
        "query": "SELECT T.year, T.births / T.total_population as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND S.name = 'Switzerland'\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, T.births, T.total_population\nORDER BY birthrate DESC\nLIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.demographic_balance_by_canton (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tcitizenship_category TEXT, \n\ttotal_population NUMERIC, \n\tbirths NUMERIC, \n\tdeaths NUMERIC, \n\timmigration NUMERIC, \n\tin_migration_from_another_canton NUMERIC, \n\temigration NUMERIC, \n\tout_migration_to_another_canton NUMERIC, \n\tnet_migration NUMERIC, \n\tacquisition_of_swiss_citizenship NUMERIC, \n\tstatistical_adjustment NUMERIC, \n\tpopulation_change NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT demographic_balance_by_canton_pkey PRIMARY KEY (uid), \n\tCONSTRAINT demographic_balance_by_canton_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in demographic_balance_by_canton and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nyear : 1988, 1989, 2000, 1991, 1993\ntotal_population : 937551, 1127659, 5917216, 1187609, 6409713\nbirths : 10555, 12542, 62457, 12743, 23291\ndeaths : 3662, 58242, 9994, 57885, 1018\nimmigration : 4838, 99091, 4290, 16001, 120188\nin_migration_from_another_canton : 7025, 88649, 14196, 128201, 1997\nemigration : 15189, 78419, 103881, 54435, 28496\nout_migration_to_another_canton : 88649, 128201, 2192, 3447, 138936\nnet_migration : 98167, 89541, 1606, 26392, 21600\nacquisition_of_swiss_citizenship : -27583, -43889, 12898, 5200, 39314\nstatistical_adjustment : -1037, 1510, -3710, -193, 3820\npopulation_change : 6484, 85580, 3391, 21244, 15119\n*/\n\n/*\nColumn name, Column discription, Example values\ntotal_population, Total population recorded this year, 6335243,5421746,913497\nbirths, Number of live births recorded, 73747,61611,12136\ndeaths, Number of deaths recorded, 59763,56032,3731\nimmigration, Number of people becoming Swiss residents, 121420,28483,92937\nemigration, Number of Swiss residents leaving, 97743,27796,69947\nin_migration_from_another_canton, Number of people moving in from another canton, 134359,119608,14751\nout_migration_to_another_canton, Number of people moving to a different canton, 134359,119608,14751\nnet_migration, Difference between the number of arrivals and departures, 23677,687,22990\nacquisition_of_swiss_citizenship, Number of people acquiring swiss nationality, 0,14299,-14299\nstatistical_adjustment, Changes to the population size that cannot be clearly attributed to demographic movements, 0,574,-34\npopulation_change, Difference in the number of people compared to the previous year, 37661,20565,17096\ncitizenship_category, Citizenship category, Citizenship (category) - total,Foreign country,Switzerland\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nIn which year did Switzerland experience its highest birth rate?\n### SQL query\nSELECT T.year, T.births / T.total_population as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND S.name = 'Switzerland'\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, T.births, T.total_population\nORDER BY birthrate DESC\nLIMIT 1;\n\n\n### Question\nIn which year did Switzerland experience its highest birth rate?\n### SQL query\nSELECT T.year, T.births / T.total_population as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND S.name = 'Switzerland'\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, T.births, T.total_population\nORDER BY birthrate DESC\nLIMIT 1;\n\n\n### Question\nShow me the cantons with the highest birth rates every year between 1995 and 2010.\n### SQL query\nSELECT year, S.name as most_populout_canton, MAX(births / total_population) as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year >= 1995\n    AND T.year <= 2010\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, S.name, T.births\nORDER BY year ASC;\n\n\n### Question\nWhich five cantons had the highest number of Swiss citizenship acquisitions in 2017 relative to their population?\n### SQL query\nSELECT S.name, acquisition_of_swiss_citizenship / total_population as relative_acquisition\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.year = 2017\n    AND T.citizenship_category = 'Switzerland'\nORDER BY relative_acquisition DESC\nLIMIT 5;\n\n\n### Question\nWhich cantons experienced a population decline in 2017, and by how much?\n### SQL query\nSELECT S.name, population_change\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.population_change < 0\n    AND T.year = 2017\n    AND T.citizenship_category = 'Citizenship (category) - total';\n\n\n### Question\nIn which year did Switzerland experience its highest birth rate?\n### SQL query\nSELECT T.year, T.births / T.total_population as birthrate\nFROM demographic_balance_by_canton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND S.name = 'Switzerland'\n    AND T.citizenship_category = 'Citizenship (category) - total'\nGROUP BY T.year, T.births, T.total_population\nORDER BY birthrate DESC\nLIMIT 1;\n\n\n### Question\nWhat was the net migration of Switzerland from 2012 to 2022?\n### SQL query\n",
    "process_time": 4.978357522049919,
    "num_tokens": 2153,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 18,
    "question": "What greenhouse gas footprint had Switzerland in 2000 through consumption?",
    "query": "SELECT T.emissions_in_million_tons_co2_equivalent\nFROM greenhouse_gas_emissions_through_consumption as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Switzerland'\n  AND S.country = 'TRUE'\n  AND T.year = 2000;\n",
    "db_id": "greenhouse_gas_emissions_through_consumption",
    "generated_query": "SELECT emissions_in_million_tons_co2_equivalent\nFROM greenhouse_gas_emissions_through_consumption\nWHERE year = 2000;",
    "meta_data": [
      {
        "question": "How much was the greenhouse gas footprint reduced as percentage of the total footprint in the observation period?",
        "query": "WITH FirstYearEmissions AS (\n    SELECT\n        year AS first_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_first_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year ASC\n    LIMIT 1\n),\nLastYearEmissions AS (\n    SELECT\n        year AS last_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_last_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year DESC\n    LIMIT 1\n)\nSELECT\n    first_observation_year,\n    last_observation_year,\n    ((emissions_last_year - emissions_first_year) * 100 / emissions_first_year) AS emission_precentage_change_in_observered_period\nFROM FirstYearEmissions AS CROSS JOIN LastYearEmissions;\n"
      },
      {
        "question": "What years did the greenhouse gas footprint of Switzerland decrease compared to the previous year and by how much? Order by magnitude of decrease",
        "query": "WITH EmissionsChange AS (\n    SELECT\n        T1.year AS current_year,\n        T1.emissions_in_million_tons_co2_equivalent AS emissions_current_year,\n        (T1.year - 1) AS previous_year,\n        T2.emissions_in_million_tons_co2_equivalent AS emissions_previous_year,\n        T1.emissions_in_million_tons_co2_equivalent - T2.emissions_in_million_tons_co2_equivalent\n          AS decrease_from_previous_year\n    FROM greenhouse_gas_emissions_through_consumption AS T1\n    JOIN greenhouse_gas_emissions_through_consumption AS T2 ON T1.year = T2.year + 1\n    WHERE T1.year > 2000\n)\nSELECT current_year, decrease_from_previous_year\nFROM EmissionsChange WHERE decrease_from_previous_year < 0\nORDER BY decrease_from_previous_year ASC;\n"
      },
      {
        "question": "How did the greenhouse gas footprint develop overall? Did it go up or down and by how much? Compare the first and last year in the data and show both years and the change of the footprint.",
        "query": "WITH FirstYearEmissions AS (\n    SELECT\n        year AS first_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_first_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year ASC\n    LIMIT 1\n),\nLastYearEmissions AS (\n    SELECT\n        year AS last_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_last_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year DESC\n    LIMIT 1\n)\nSELECT\n    first_observation_year,\n    last_observation_year,\n    emissions_last_year - emissions_first_year AS emission_change_in_observered_period\nFROM FirstYearEmissions AS CROSS JOIN LastYearEmissions;\n"
      },
      {
        "question": "What years did the greenhouse gas footprint of Switzerland decrease compared to the previous year and by how much? Order by magnitude of decrease",
        "query": "WITH EmissionsChange AS (\n    SELECT\n        T1.year AS current_year,\n        T1.emissions_in_million_tons_co2_equivalent AS emissions_current_year,\n        (T1.year - 1) AS previous_year,\n        T2.emissions_in_million_tons_co2_equivalent AS emissions_previous_year,\n        T1.emissions_in_million_tons_co2_equivalent - T2.emissions_in_million_tons_co2_equivalent\n          AS decrease_from_previous_year\n    FROM greenhouse_gas_emissions_through_consumption AS T1\n    JOIN greenhouse_gas_emissions_through_consumption AS T2 ON T1.year = T2.year + 1\n    WHERE T1.year > 2000\n)\nSELECT current_year, decrease_from_previous_year\nFROM EmissionsChange WHERE decrease_from_previous_year < 0\nORDER BY decrease_from_previous_year ASC;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.greenhouse_gas_emissions_through_consumption (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\temissions_in_million_tons_co2_equivalent NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT greenhouse_gas_emissions_through_consumption_pkey PRIMARY KEY (uid), \n\tCONSTRAINT greenhouse_gas_emissions_through_consumpti_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in greenhouse_gas_emissions_through_consumption and 5 examples in each column for high cardinality columns :\nuid : 4, 18, 17, 11, 13\nyear : 2015, 2000, 2009, 2012, 2019\nemissions_in_million_tons_co2_equivalent : 111.69297268884500, 124.98857752186900, 117.90056180040800, 116.21843319733000, 113.05347920007300\n*/\n\n/*\nColumn name, Column discription, Example values\nemissions_in_million_tons_co2_equivalent, Greenhouse gas emissions in million metric tons of CO2 equivalent, 117.900561800408\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nHow much was the greenhouse gas footprint reduced as percentage of the total footprint in the observation period?\n### SQL query\nWITH FirstYearEmissions AS (\n    SELECT\n        year AS first_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_first_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year ASC\n    LIMIT 1\n),\nLastYearEmissions AS (\n    SELECT\n        year AS last_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_last_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year DESC\n    LIMIT 1\n)\nSELECT\n    first_observation_year,\n    last_observation_year,\n    ((emissions_last_year - emissions_first_year) * 100 / emissions_first_year) AS emission_precentage_change_in_observered_period\nFROM FirstYearEmissions AS CROSS JOIN LastYearEmissions;\n\n\n### Question\nWhat years did the greenhouse gas footprint of Switzerland decrease compared to the previous year and by how much? Order by magnitude of decrease\n### SQL query\nWITH EmissionsChange AS (\n    SELECT\n        T1.year AS current_year,\n        T1.emissions_in_million_tons_co2_equivalent AS emissions_current_year,\n        (T1.year - 1) AS previous_year,\n        T2.emissions_in_million_tons_co2_equivalent AS emissions_previous_year,\n        T1.emissions_in_million_tons_co2_equivalent - T2.emissions_in_million_tons_co2_equivalent\n          AS decrease_from_previous_year\n    FROM greenhouse_gas_emissions_through_consumption AS T1\n    JOIN greenhouse_gas_emissions_through_consumption AS T2 ON T1.year = T2.year + 1\n    WHERE T1.year > 2000\n)\nSELECT current_year, decrease_from_previous_year\nFROM EmissionsChange WHERE decrease_from_previous_year < 0\nORDER BY decrease_from_previous_year ASC;\n\n\n### Question\nHow did the greenhouse gas footprint develop overall? Did it go up or down and by how much? Compare the first and last year in the data and show both years and the change of the footprint.\n### SQL query\nWITH FirstYearEmissions AS (\n    SELECT\n        year AS first_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_first_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year ASC\n    LIMIT 1\n),\nLastYearEmissions AS (\n    SELECT\n        year AS last_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_last_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year DESC\n    LIMIT 1\n)\nSELECT\n    first_observation_year,\n    last_observation_year,\n    emissions_last_year - emissions_first_year AS emission_change_in_observered_period\nFROM FirstYearEmissions AS CROSS JOIN LastYearEmissions;\n\n\n### Question\nWhat years did the greenhouse gas footprint of Switzerland decrease compared to the previous year and by how much? Order by magnitude of decrease\n### SQL query\nWITH EmissionsChange AS (\n    SELECT\n        T1.year AS current_year,\n        T1.emissions_in_million_tons_co2_equivalent AS emissions_current_year,\n        (T1.year - 1) AS previous_year,\n        T2.emissions_in_million_tons_co2_equivalent AS emissions_previous_year,\n        T1.emissions_in_million_tons_co2_equivalent - T2.emissions_in_million_tons_co2_equivalent\n          AS decrease_from_previous_year\n    FROM greenhouse_gas_emissions_through_consumption AS T1\n    JOIN greenhouse_gas_emissions_through_consumption AS T2 ON T1.year = T2.year + 1\n    WHERE T1.year > 2000\n)\nSELECT current_year, decrease_from_previous_year\nFROM EmissionsChange WHERE decrease_from_previous_year < 0\nORDER BY decrease_from_previous_year ASC;\n\n\n### Question\nWhat greenhouse gas footprint had Switzerland in 2000 through consumption?\n### SQL query\n",
    "process_time": 2.4472888538148254,
    "num_tokens": 1731,
    "hardness": "medium",
    "scores": [
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 19,
    "question": "In which years did the greenhouse footprint increase and by how much? Order by years and start from the present",
    "query": "WITH EmissionsChange AS (\n    SELECT\n        T1.year AS current_year,\n        T1.emissions_in_million_tons_co2_equivalent AS emissions_current_year,\n        (T1.year - 1) AS previous_year,\n        T2.emissions_in_million_tons_co2_equivalent AS emissions_previous_year,\n        T1.emissions_in_million_tons_co2_equivalent - T2.emissions_in_million_tons_co2_equivalent\n          AS increase_from_previous_year\n    FROM greenhouse_gas_emissions_through_consumption AS T1\n    JOIN greenhouse_gas_emissions_through_consumption AS T2 ON T1.year = T2.year + 1\n    WHERE T1.year > 2000\n)\nSELECT current_year, increase_from_previous_year\nFROM EmissionsChange WHERE increase_from_previous_year > 0\nORDER BY current_year DESC;\n",
    "db_id": "greenhouse_gas_emissions_through_consumption",
    "generated_query": "WITH EmissionsChange AS (\n    SELECT\n        year,\n        emissions_in_million_tons_co2_equivalent,\n        LAG(emissions_in_million_tons_co2_equivalent) OVER (ORDER BY year DESC) AS previous_emissions,\n        emissions_in_million_tons_co2_equivalent - LAG(emissions_in_million_tons_co2_equivalent) OVER (ORDER BY year DESC) AS increase_from_previous_year\n    FROM greenhouse_gas_emissions_through_consumption\n)\nSELECT year, increase_from_previous_year\nFROM EmissionsChange\nWHERE increase_from_previous_year > 0\nORDER BY year DESC;",
    "meta_data": [
      {
        "question": "How much was the greenhouse gas footprint reduced as percentage of the total footprint in the observation period?",
        "query": "WITH FirstYearEmissions AS (\n    SELECT\n        year AS first_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_first_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year ASC\n    LIMIT 1\n),\nLastYearEmissions AS (\n    SELECT\n        year AS last_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_last_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year DESC\n    LIMIT 1\n)\nSELECT\n    first_observation_year,\n    last_observation_year,\n    ((emissions_last_year - emissions_first_year) * 100 / emissions_first_year) AS emission_precentage_change_in_observered_period\nFROM FirstYearEmissions AS CROSS JOIN LastYearEmissions;\n"
      },
      {
        "question": "How much was the greenhouse gas footprint reduced as percentage of the total footprint in the observation period?",
        "query": "WITH FirstYearEmissions AS (\n    SELECT\n        year AS first_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_first_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year ASC\n    LIMIT 1\n),\nLastYearEmissions AS (\n    SELECT\n        year AS last_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_last_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year DESC\n    LIMIT 1\n)\nSELECT\n    first_observation_year,\n    last_observation_year,\n    ((emissions_last_year - emissions_first_year) * 100 / emissions_first_year) AS emission_precentage_change_in_observered_period\nFROM FirstYearEmissions AS CROSS JOIN LastYearEmissions;\n"
      },
      {
        "question": "What years did the greenhouse gas footprint of Switzerland decrease compared to the previous year and by how much? Order by magnitude of decrease",
        "query": "WITH EmissionsChange AS (\n    SELECT\n        T1.year AS current_year,\n        T1.emissions_in_million_tons_co2_equivalent AS emissions_current_year,\n        (T1.year - 1) AS previous_year,\n        T2.emissions_in_million_tons_co2_equivalent AS emissions_previous_year,\n        T1.emissions_in_million_tons_co2_equivalent - T2.emissions_in_million_tons_co2_equivalent\n          AS decrease_from_previous_year\n    FROM greenhouse_gas_emissions_through_consumption AS T1\n    JOIN greenhouse_gas_emissions_through_consumption AS T2 ON T1.year = T2.year + 1\n    WHERE T1.year > 2000\n)\nSELECT current_year, decrease_from_previous_year\nFROM EmissionsChange WHERE decrease_from_previous_year < 0\nORDER BY decrease_from_previous_year ASC;\n"
      },
      {
        "question": "How did the greenhouse gas footprint develop overall? Did it go up or down and by how much? Compare the first and last year in the data and show both years and the change of the footprint.",
        "query": "WITH FirstYearEmissions AS (\n    SELECT\n        year AS first_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_first_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year ASC\n    LIMIT 1\n),\nLastYearEmissions AS (\n    SELECT\n        year AS last_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_last_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year DESC\n    LIMIT 1\n)\nSELECT\n    first_observation_year,\n    last_observation_year,\n    emissions_last_year - emissions_first_year AS emission_change_in_observered_period\nFROM FirstYearEmissions AS CROSS JOIN LastYearEmissions;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.greenhouse_gas_emissions_through_consumption (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\temissions_in_million_tons_co2_equivalent NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT greenhouse_gas_emissions_through_consumption_pkey PRIMARY KEY (uid), \n\tCONSTRAINT greenhouse_gas_emissions_through_consumpti_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in greenhouse_gas_emissions_through_consumption and 5 examples in each column for high cardinality columns :\nuid : 4, 18, 17, 11, 13\nyear : 2015, 2000, 2009, 2012, 2019\nemissions_in_million_tons_co2_equivalent : 111.69297268884500, 124.98857752186900, 117.90056180040800, 116.21843319733000, 113.05347920007300\n*/\n\n/*\nColumn name, Column discription, Example values\nemissions_in_million_tons_co2_equivalent, Greenhouse gas emissions in million metric tons of CO2 equivalent, 117.900561800408\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nHow much was the greenhouse gas footprint reduced as percentage of the total footprint in the observation period?\n### SQL query\nWITH FirstYearEmissions AS (\n    SELECT\n        year AS first_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_first_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year ASC\n    LIMIT 1\n),\nLastYearEmissions AS (\n    SELECT\n        year AS last_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_last_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year DESC\n    LIMIT 1\n)\nSELECT\n    first_observation_year,\n    last_observation_year,\n    ((emissions_last_year - emissions_first_year) * 100 / emissions_first_year) AS emission_precentage_change_in_observered_period\nFROM FirstYearEmissions AS CROSS JOIN LastYearEmissions;\n\n\n### Question\nHow much was the greenhouse gas footprint reduced as percentage of the total footprint in the observation period?\n### SQL query\nWITH FirstYearEmissions AS (\n    SELECT\n        year AS first_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_first_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year ASC\n    LIMIT 1\n),\nLastYearEmissions AS (\n    SELECT\n        year AS last_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_last_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year DESC\n    LIMIT 1\n)\nSELECT\n    first_observation_year,\n    last_observation_year,\n    ((emissions_last_year - emissions_first_year) * 100 / emissions_first_year) AS emission_precentage_change_in_observered_period\nFROM FirstYearEmissions AS CROSS JOIN LastYearEmissions;\n\n\n### Question\nWhat years did the greenhouse gas footprint of Switzerland decrease compared to the previous year and by how much? Order by magnitude of decrease\n### SQL query\nWITH EmissionsChange AS (\n    SELECT\n        T1.year AS current_year,\n        T1.emissions_in_million_tons_co2_equivalent AS emissions_current_year,\n        (T1.year - 1) AS previous_year,\n        T2.emissions_in_million_tons_co2_equivalent AS emissions_previous_year,\n        T1.emissions_in_million_tons_co2_equivalent - T2.emissions_in_million_tons_co2_equivalent\n          AS decrease_from_previous_year\n    FROM greenhouse_gas_emissions_through_consumption AS T1\n    JOIN greenhouse_gas_emissions_through_consumption AS T2 ON T1.year = T2.year + 1\n    WHERE T1.year > 2000\n)\nSELECT current_year, decrease_from_previous_year\nFROM EmissionsChange WHERE decrease_from_previous_year < 0\nORDER BY decrease_from_previous_year ASC;\n\n\n### Question\nHow did the greenhouse gas footprint develop overall? Did it go up or down and by how much? Compare the first and last year in the data and show both years and the change of the footprint.\n### SQL query\nWITH FirstYearEmissions AS (\n    SELECT\n        year AS first_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_first_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year ASC\n    LIMIT 1\n),\nLastYearEmissions AS (\n    SELECT\n        year AS last_observation_year,\n        emissions_in_million_tons_co2_equivalent AS emissions_last_year\n    FROM greenhouse_gas_emissions_through_consumption ORDER BY year DESC\n    LIMIT 1\n)\nSELECT\n    first_observation_year,\n    last_observation_year,\n    emissions_last_year - emissions_first_year AS emission_change_in_observered_period\nFROM FirstYearEmissions AS CROSS JOIN LastYearEmissions;\n\n\n### Question\nIn which years did the greenhouse footprint increase and by how much? Order by years and start from the present\n### SQL query\n",
    "process_time": 8.478438996011391,
    "num_tokens": 1714,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 20,
    "question": "What types of fuel are there?",
    "query": "SELECT DISTINCT fuel_type FROM stock_vehicles;\n",
    "db_id": "stock_vehicles",
    "generated_query": "SELECT DISTINCT fuel_type\nFROM stock_vehicles;",
    "meta_data": [
      {
        "question": "What type of vehicle is the most frequent in the canton of Basel?",
        "query": "SELECT\n    vehicle_type,\n    SUM(amount) AS total_amount\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.canton = 'true'\n    AND su.name ILIKE '%basel%'\nGROUP BY\n    vehicle_type\nORDER BY\n    total_amount DESC\nLIMIT 1;\n"
      },
      {
        "question": "In how many cities are vehicles records available?",
        "query": "SELECT COUNT(DISTINCT spatialunit_uid) AS total_cities\nFROM stock_vehicles;\n"
      },
      {
        "question": "What fuel type is most frequently used for motorcycles?",
        "query": "SELECT\n    fuel_type,\n    SUM(amount) AS total_amount\nFROM stock_vehicles WHERE vehicle_type ILIKE '%motorcycle%'\n    AND fuel_type != 'total'\nGROUP BY fuel_type\nORDER BY total_amount DESC\nLIMIT 1;\n"
      },
      {
        "question": "What is the proportion of electric vehicles of each type in the most recent year, in descending order?",
        "query": "SELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n"
      },
      {
        "question": "When was the first record of an electric vehicle?",
        "query": "SELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n"
      },
      {
        "question": "What type of vehicle is the most frequent in the canton of Basel?",
        "query": "SELECT\n    vehicle_type,\n    SUM(amount) AS total_amount\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.canton = 'true'\n    AND su.name ILIKE '%basel%'\nGROUP BY\n    vehicle_type\nORDER BY\n    total_amount DESC\nLIMIT 1;\n"
      },
      {
        "question": "What canton has the most agricultural vehicles across all years?",
        "query": "SELECT\n    su.name AS city,\n    SUM(sv.amount) AS total_agricultural_vehicles\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    sv.vehicle_type ILIKE '%agricultural%'\n    AND su.canton = 'True'\nGROUP BY\n    su.name\nORDER BY\n    total_agricultural_vehicles DESC\nLIMIT 1;\n"
      },
      {
        "question": "When was the first record of an electric vehicle?",
        "query": "SELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n"
      },
      {
        "question": "How many electric-only cars are registered in 2013?",
        "query": "SELECT SUM(amount) AS total_electric_cars\nFROM stock_vehicles WHERE fuel_type = 'Electric'\n    AND year = 2013;\n"
      },
      {
        "question": "How many diesel industrial vehicles were there in Switzerland in 2013?",
        "query": "SELECT SUM(amount) AS total_diesel_industrial_vehicles\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name = 'Switzerland'\n    AND sv.vehicle_type = 'industrial vehicles'\n    AND sv.fuel_type = 'Diesel'\n    AND sv.year = 2013;"
      },
      {
        "question": "What is the percent change in the number of hybrid cars change in the city of Basel between 2013 and 2014?",
        "query": "SELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2014 THEN amount ELSE 0 END) -\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END) AS hybrid_change,\n    (SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2014 THEN amount ELSE 0 END) -\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END)) * 100.0 / NULLIF(SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END), 0) AS hybrid_percent_change\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.name ILIKE 'Basel'\n    AND su.municipal = 'True' AND fuel_type ILIKE '%hybrid%'\n    AND (year = 2013 OR year = 2014)\nGROUP BY\n    vehicle_type;\n"
      },
      {
        "question": "What is the proportion of electric vehicles of each type in the most recent year, in descending order?",
        "query": "SELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n"
      },
      {
        "question": "What cities do not have any electric cars registered?",
        "query": "SELECT su.name AS city\nFROM spatial_unit AS su\nWHERE NOT EXISTS (\n    SELECT 1\n    FROM stock_vehicles AS sv\n    WHERE su.spatialunit_uid = sv.spatialunit_uid\n        AND sv.fuel_type = 'Electric'\n);\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.stock_vehicles (\n\tuid BIGINT NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tvehicle_type VARCHAR(50), \n\tyear INTEGER, \n\tamount INTEGER, \n\tfuel_type VARCHAR(50), \n\tCONSTRAINT stock_vehicles_pk PRIMARY KEY (uid), \n\tCONSTRAINT stock_vehicles_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in stock_vehicles and 5 examples in each column for high cardinality columns :\nuid : 8829, 8857, 8759, 8774, 8796\nspatialunit_uid : 2079_A.ADM3, 31_A.ADM3, 609_A.ADM3, 23_A.ADM1, 4239_A.ADM3\nyear : 2014, 2011, 2013, 2015, 2020\namount : 97, 72, 23, 29, 17\nfuel_type : Electric, Gas (mono- and bivalent), Benzine-electric: Normal-hybrid, Benzine, Diesel-electric: Plug-in-hybrid\n*/\n\n/*\nColumn name, Column discription, Example values\nvehicle_type, Vehicle type, passenger_cars,trailers,motorcycles\namount, Amount of vehicles, 0,2,240\nfuel_type, Fuel type, Hydrogen,Electric,Diesel-electric: Normal-hybrid\n*/\n\n\n\n### Question\nWhat type of vehicle is the most frequent in the canton of Basel?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(amount) AS total_amount\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.canton = 'true'\n    AND su.name ILIKE '%basel%'\nGROUP BY\n    vehicle_type\nORDER BY\n    total_amount DESC\nLIMIT 1;\n\n\n### Question\nIn how many cities are vehicles records available?\n### SQL query\nSELECT COUNT(DISTINCT spatialunit_uid) AS total_cities\nFROM stock_vehicles;\n\n\n### Question\nWhat fuel type is most frequently used for motorcycles?\n### SQL query\nSELECT\n    fuel_type,\n    SUM(amount) AS total_amount\nFROM stock_vehicles WHERE vehicle_type ILIKE '%motorcycle%'\n    AND fuel_type != 'total'\nGROUP BY fuel_type\nORDER BY total_amount DESC\nLIMIT 1;\n\n\n### Question\nWhat is the proportion of electric vehicles of each type in the most recent year, in descending order?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n\n\n### Question\nWhen was the first record of an electric vehicle?\n### SQL query\nSELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n\n\n### Question\nWhat type of vehicle is the most frequent in the canton of Basel?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(amount) AS total_amount\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.canton = 'true'\n    AND su.name ILIKE '%basel%'\nGROUP BY\n    vehicle_type\nORDER BY\n    total_amount DESC\nLIMIT 1;\n\n\n### Question\nWhat canton has the most agricultural vehicles across all years?\n### SQL query\nSELECT\n    su.name AS city,\n    SUM(sv.amount) AS total_agricultural_vehicles\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    sv.vehicle_type ILIKE '%agricultural%'\n    AND su.canton = 'True'\nGROUP BY\n    su.name\nORDER BY\n    total_agricultural_vehicles DESC\nLIMIT 1;\n\n\n### Question\nWhen was the first record of an electric vehicle?\n### SQL query\nSELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n\n\n### Question\nHow many electric-only cars are registered in 2013?\n### SQL query\nSELECT SUM(amount) AS total_electric_cars\nFROM stock_vehicles WHERE fuel_type = 'Electric'\n    AND year = 2013;\n\n\n### Question\nHow many diesel industrial vehicles were there in Switzerland in 2013?\n### SQL query\nSELECT SUM(amount) AS total_diesel_industrial_vehicles\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name = 'Switzerland'\n    AND sv.vehicle_type = 'industrial vehicles'\n    AND sv.fuel_type = 'Diesel'\n    AND sv.year = 2013;\n\n### Question\nWhat is the percent change in the number of hybrid cars change in the city of Basel between 2013 and 2014?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2014 THEN amount ELSE 0 END) -\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END) AS hybrid_change,\n    (SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2014 THEN amount ELSE 0 END) -\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END)) * 100.0 / NULLIF(SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END), 0) AS hybrid_percent_change\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.name ILIKE 'Basel'\n    AND su.municipal = 'True' AND fuel_type ILIKE '%hybrid%'\n    AND (year = 2013 OR year = 2014)\nGROUP BY\n    vehicle_type;\n\n\n### Question\nWhat is the proportion of electric vehicles of each type in the most recent year, in descending order?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n\n\n### Question\nWhat cities do not have any electric cars registered?\n### SQL query\nSELECT su.name AS city\nFROM spatial_unit AS su\nWHERE NOT EXISTS (\n    SELECT 1\n    FROM stock_vehicles AS sv\n    WHERE su.spatialunit_uid = sv.spatialunit_uid\n        AND sv.fuel_type = 'Electric'\n);\n\n\n### Question\nWhat types of fuel are there?\n### SQL query\n",
    "process_time": 1.7216269271448255,
    "num_tokens": 2219,
    "hardness": "easy",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 21,
    "question": "What was the proportion of electric vehicles in Geneva in 2010?",
    "query": "SELECT\n    SUM(CASE WHEN sv.fuel_type ILIKE '%electric%' THEN sv.amount ELSE 0 END) AS electric_vehicles,\n    SUM(sv.amount) AS total_vehicles,\n    (\n        SUM(CASE WHEN sv.fuel_type ILIKE '%electric%' THEN sv.amount ELSE 0 END) * 100.0 / NULLIF(SUM(sv.amount), 0)\n    ) AS proportion_electric_vehicles\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name ILIKE '%geneva%'\n    AND sv.year = 2010;\n",
    "db_id": "stock_vehicles",
    "generated_query": "SELECT\n    sv.year,\n    sv.fuel_type,\n    SUM(sv.amount) AS total_cars,\n    (SUM(sv.amount) * 100.0 / NULLIF(SUM(SUM(sv.amount)) OVER (PARTITION BY sv.year), 0)) AS proportion\nFROM stock_vehicles AS sv\n    INNER JOIN spatial_unit AS su ON sv.spatialunit_uid = su.spatialunit_uid\nWHERE\n    su.name ILIKE '%geneva%'\n    AND sv.year = 2010\n    AND sv.fuel_type = 'Electric'\nGROUP BY\n    sv.year, sv.fuel_type;",
    "meta_data": [
      {
        "question": "How did the proportion of fuel types evolve since 2010?",
        "query": "SELECT\n    sv.year,\n    sv.fuel_type,\n    SUM(sv.amount) AS total_cars,\n    (SUM(sv.amount) * 100.0 / NULLIF(SUM(SUM(sv.amount)) OVER (PARTITION BY sv.year), 0)) AS proportion\nFROM stock_vehicles AS sv\nWHERE\n    sv.year >= 2010 and sv.fuel_type != 'total'\nGROUP BY\n    sv.year, sv.fuel_type\nORDER BY\n    sv.year, sv.fuel_type;\n"
      },
      {
        "question": "When was the first record of an electric vehicle?",
        "query": "SELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n"
      },
      {
        "question": "How many electric-only cars are registered in 2013?",
        "query": "SELECT SUM(amount) AS total_electric_cars\nFROM stock_vehicles WHERE fuel_type = 'Electric'\n    AND year = 2013;\n"
      },
      {
        "question": "What type of vehicle is the most frequent in the canton of Basel?",
        "query": "SELECT\n    vehicle_type,\n    SUM(amount) AS total_amount\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.canton = 'true'\n    AND su.name ILIKE '%basel%'\nGROUP BY\n    vehicle_type\nORDER BY\n    total_amount DESC\nLIMIT 1;\n"
      },
      {
        "question": "When was the first record of an electric vehicle?",
        "query": "SELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n"
      },
      {
        "question": "When was the first record of an electric vehicle?",
        "query": "SELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n"
      },
      {
        "question": "What is the most popular car type in the canton of Zurich?",
        "query": "SELECT\n    sv.vehicle_type AS car_type,\n    SUM(sv.amount) AS total_cars\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name ILIKE '%zurich%'\n    AND su.canton = 'True'\n    AND sv.fuel_type = 'total'\n    AND sv.year BETWEEN 2013 AND 2018\nGROUP BY sv.vehicle_type\nORDER BY total_cars DESC\nLIMIT 1;\n"
      },
      {
        "question": "What is the percent change in the number of hybrid cars change in the city of Basel between 2013 and 2014?",
        "query": "SELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2014 THEN amount ELSE 0 END) -\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END) AS hybrid_change,\n    (SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2014 THEN amount ELSE 0 END) -\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END)) * 100.0 / NULLIF(SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END), 0) AS hybrid_percent_change\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.name ILIKE 'Basel'\n    AND su.municipal = 'True' AND fuel_type ILIKE '%hybrid%'\n    AND (year = 2013 OR year = 2014)\nGROUP BY\n    vehicle_type;\n"
      },
      {
        "question": "When was the first record of an electric vehicle?",
        "query": "SELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n"
      },
      {
        "question": "What fuel type is most frequently used for motorcycles?",
        "query": "SELECT\n    fuel_type,\n    SUM(amount) AS total_amount\nFROM stock_vehicles WHERE vehicle_type ILIKE '%motorcycle%'\n    AND fuel_type != 'total'\nGROUP BY fuel_type\nORDER BY total_amount DESC\nLIMIT 1;\n"
      },
      {
        "question": "What fuel type is most frequently used for motorcycles?",
        "query": "SELECT\n    fuel_type,\n    SUM(amount) AS total_amount\nFROM stock_vehicles WHERE vehicle_type ILIKE '%motorcycle%'\n    AND fuel_type != 'total'\nGROUP BY fuel_type\nORDER BY total_amount DESC\nLIMIT 1;\n"
      },
      {
        "question": "What is the most popular car type in the canton of Zurich?",
        "query": "SELECT\n    sv.vehicle_type AS car_type,\n    SUM(sv.amount) AS total_cars\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name ILIKE '%zurich%'\n    AND su.canton = 'True'\n    AND sv.fuel_type = 'total'\n    AND sv.year BETWEEN 2013 AND 2018\nGROUP BY sv.vehicle_type\nORDER BY total_cars DESC\nLIMIT 1;\n"
      },
      {
        "question": "In how many cities are vehicles records available?",
        "query": "SELECT COUNT(DISTINCT spatialunit_uid) AS total_cities\nFROM stock_vehicles;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.stock_vehicles (\n\tuid BIGINT NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tvehicle_type VARCHAR(50), \n\tyear INTEGER, \n\tamount INTEGER, \n\tfuel_type VARCHAR(50), \n\tCONSTRAINT stock_vehicles_pk PRIMARY KEY (uid), \n\tCONSTRAINT stock_vehicles_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in stock_vehicles and 5 examples in each column for high cardinality columns :\nuid : 8829, 8857, 8759, 8774, 8796\nspatialunit_uid : 2079_A.ADM3, 31_A.ADM3, 609_A.ADM3, 23_A.ADM1, 4239_A.ADM3\nyear : 2014, 2011, 2013, 2015, 2020\namount : 97, 72, 23, 29, 17\nfuel_type : Electric, Gas (mono- and bivalent), Benzine-electric: Normal-hybrid, Benzine, Diesel-electric: Plug-in-hybrid\n*/\n\n/*\nColumn name, Column discription, Example values\nvehicle_type, Vehicle type, passenger_cars,trailers,motorcycles\namount, Amount of vehicles, 0,2,240\nfuel_type, Fuel type, Hydrogen,Electric,Diesel-electric: Normal-hybrid\n*/\n\n\n\n### Question\nHow did the proportion of fuel types evolve since 2010?\n### SQL query\nSELECT\n    sv.year,\n    sv.fuel_type,\n    SUM(sv.amount) AS total_cars,\n    (SUM(sv.amount) * 100.0 / NULLIF(SUM(SUM(sv.amount)) OVER (PARTITION BY sv.year), 0)) AS proportion\nFROM stock_vehicles AS sv\nWHERE\n    sv.year >= 2010 and sv.fuel_type != 'total'\nGROUP BY\n    sv.year, sv.fuel_type\nORDER BY\n    sv.year, sv.fuel_type;\n\n\n### Question\nWhen was the first record of an electric vehicle?\n### SQL query\nSELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n\n\n### Question\nHow many electric-only cars are registered in 2013?\n### SQL query\nSELECT SUM(amount) AS total_electric_cars\nFROM stock_vehicles WHERE fuel_type = 'Electric'\n    AND year = 2013;\n\n\n### Question\nWhat type of vehicle is the most frequent in the canton of Basel?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(amount) AS total_amount\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.canton = 'true'\n    AND su.name ILIKE '%basel%'\nGROUP BY\n    vehicle_type\nORDER BY\n    total_amount DESC\nLIMIT 1;\n\n\n### Question\nWhen was the first record of an electric vehicle?\n### SQL query\nSELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n\n\n### Question\nWhen was the first record of an electric vehicle?\n### SQL query\nSELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n\n\n### Question\nWhat is the most popular car type in the canton of Zurich?\n### SQL query\nSELECT\n    sv.vehicle_type AS car_type,\n    SUM(sv.amount) AS total_cars\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name ILIKE '%zurich%'\n    AND su.canton = 'True'\n    AND sv.fuel_type = 'total'\n    AND sv.year BETWEEN 2013 AND 2018\nGROUP BY sv.vehicle_type\nORDER BY total_cars DESC\nLIMIT 1;\n\n\n### Question\nWhat is the percent change in the number of hybrid cars change in the city of Basel between 2013 and 2014?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2014 THEN amount ELSE 0 END) -\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END) AS hybrid_change,\n    (SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2014 THEN amount ELSE 0 END) -\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END)) * 100.0 / NULLIF(SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END), 0) AS hybrid_percent_change\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.name ILIKE 'Basel'\n    AND su.municipal = 'True' AND fuel_type ILIKE '%hybrid%'\n    AND (year = 2013 OR year = 2014)\nGROUP BY\n    vehicle_type;\n\n\n### Question\nWhen was the first record of an electric vehicle?\n### SQL query\nSELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n\n\n### Question\nWhat fuel type is most frequently used for motorcycles?\n### SQL query\nSELECT\n    fuel_type,\n    SUM(amount) AS total_amount\nFROM stock_vehicles WHERE vehicle_type ILIKE '%motorcycle%'\n    AND fuel_type != 'total'\nGROUP BY fuel_type\nORDER BY total_amount DESC\nLIMIT 1;\n\n\n### Question\nWhat fuel type is most frequently used for motorcycles?\n### SQL query\nSELECT\n    fuel_type,\n    SUM(amount) AS total_amount\nFROM stock_vehicles WHERE vehicle_type ILIKE '%motorcycle%'\n    AND fuel_type != 'total'\nGROUP BY fuel_type\nORDER BY total_amount DESC\nLIMIT 1;\n\n\n### Question\nWhat is the most popular car type in the canton of Zurich?\n### SQL query\nSELECT\n    sv.vehicle_type AS car_type,\n    SUM(sv.amount) AS total_cars\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name ILIKE '%zurich%'\n    AND su.canton = 'True'\n    AND sv.fuel_type = 'total'\n    AND sv.year BETWEEN 2013 AND 2018\nGROUP BY sv.vehicle_type\nORDER BY total_cars DESC\nLIMIT 1;\n\n\n### Question\nIn how many cities are vehicles records available?\n### SQL query\nSELECT COUNT(DISTINCT spatialunit_uid) AS total_cities\nFROM stock_vehicles;\n\n\n### Question\nWhat was the proportion of electric vehicles in Geneva in 2010?\n### SQL query\n",
    "process_time": 8.138982524862513,
    "num_tokens": 2091,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 22,
    "question": "What was the city with the most cars in 2015?",
    "query": "SELECT\n    su.name AS city,\n    SUM(sv.amount) AS total_cars\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE sv.year = 2015\n    AND su.municipal = 'True'\n    AND sv.fuel_type = 'total'\nGROUP BY\n    su.name\nORDER BY total_cars DESC\nLIMIT 1;\n",
    "db_id": "stock_vehicles",
    "generated_query": "SELECT\n    su.name AS city,\n    SUM(sv.amount) AS total_cars\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE sv.year = 2015\nGROUP BY su.name\nORDER BY total_cars DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "What is the percent change in the number of hybrid cars change in the city of Basel between 2013 and 2014?",
        "query": "SELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2014 THEN amount ELSE 0 END) -\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END) AS hybrid_change,\n    (SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2014 THEN amount ELSE 0 END) -\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END)) * 100.0 / NULLIF(SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END), 0) AS hybrid_percent_change\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.name ILIKE 'Basel'\n    AND su.municipal = 'True' AND fuel_type ILIKE '%hybrid%'\n    AND (year = 2013 OR year = 2014)\nGROUP BY\n    vehicle_type;\n"
      },
      {
        "question": "When was the first record of an electric vehicle?",
        "query": "SELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n"
      },
      {
        "question": "How did the proportion of fuel types evolve since 2010?",
        "query": "SELECT\n    sv.year,\n    sv.fuel_type,\n    SUM(sv.amount) AS total_cars,\n    (SUM(sv.amount) * 100.0 / NULLIF(SUM(SUM(sv.amount)) OVER (PARTITION BY sv.year), 0)) AS proportion\nFROM stock_vehicles AS sv\nWHERE\n    sv.year >= 2010 and sv.fuel_type != 'total'\nGROUP BY\n    sv.year, sv.fuel_type\nORDER BY\n    sv.year, sv.fuel_type;\n"
      },
      {
        "question": "How many diesel industrial vehicles were there in Switzerland in 2013?",
        "query": "SELECT SUM(amount) AS total_diesel_industrial_vehicles\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name = 'Switzerland'\n    AND sv.vehicle_type = 'industrial vehicles'\n    AND sv.fuel_type = 'Diesel'\n    AND sv.year = 2013;"
      },
      {
        "question": "What type of vehicle is the most frequent in the canton of Basel?",
        "query": "SELECT\n    vehicle_type,\n    SUM(amount) AS total_amount\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.canton = 'true'\n    AND su.name ILIKE '%basel%'\nGROUP BY\n    vehicle_type\nORDER BY\n    total_amount DESC\nLIMIT 1;\n"
      },
      {
        "question": "What cities do not have any electric cars registered?",
        "query": "SELECT su.name AS city\nFROM spatial_unit AS su\nWHERE NOT EXISTS (\n    SELECT 1\n    FROM stock_vehicles AS sv\n    WHERE su.spatialunit_uid = sv.spatialunit_uid\n        AND sv.fuel_type = 'Electric'\n);\n"
      },
      {
        "question": "What are the 5 cantons with the most agricultural vehicles per passenger transportation vehicle in 2010?",
        "query": "SELECT\n    su.name AS canton,\n    SUM(CASE WHEN sv.vehicle_type ILIKE '%agricultural%' THEN sv.amount ELSE 0 END) AS total_agricultural_vehicles,\n    SUM(CASE WHEN sv.vehicle_type ILIKE '%passenger transportation%' THEN sv.amount ELSE 0 END) AS total_passenger_vehicles,\n    (SUM(CASE WHEN sv.vehicle_type ILIKE '%agricultural%' THEN sv.amount ELSE 0 END) * 1.0 / NULLIF(SUM(CASE WHEN sv.vehicle_type ILIKE '%passenger transportation%' THEN sv.amount ELSE 0 END), 0)) AS ratio_agricultural_to_passenger\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE sv.year = 2010\n    AND su.canton = 'True'\nGROUP BY su.name\nORDER BY ratio_agricultural_to_passenger DESC\nLIMIT 5;\n"
      },
      {
        "question": "What are the 5 cantons with the most agricultural vehicles per passenger transportation vehicle in 2010?",
        "query": "SELECT\n    su.name AS canton,\n    SUM(CASE WHEN sv.vehicle_type ILIKE '%agricultural%' THEN sv.amount ELSE 0 END) AS total_agricultural_vehicles,\n    SUM(CASE WHEN sv.vehicle_type ILIKE '%passenger transportation%' THEN sv.amount ELSE 0 END) AS total_passenger_vehicles,\n    (SUM(CASE WHEN sv.vehicle_type ILIKE '%agricultural%' THEN sv.amount ELSE 0 END) * 1.0 / NULLIF(SUM(CASE WHEN sv.vehicle_type ILIKE '%passenger transportation%' THEN sv.amount ELSE 0 END), 0)) AS ratio_agricultural_to_passenger\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE sv.year = 2010\n    AND su.canton = 'True'\nGROUP BY su.name\nORDER BY ratio_agricultural_to_passenger DESC\nLIMIT 5;\n"
      },
      {
        "question": "When was the first record of an electric vehicle?",
        "query": "SELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n"
      },
      {
        "question": "How did the proportion of fuel types evolve since 2010?",
        "query": "SELECT\n    sv.year,\n    sv.fuel_type,\n    SUM(sv.amount) AS total_cars,\n    (SUM(sv.amount) * 100.0 / NULLIF(SUM(SUM(sv.amount)) OVER (PARTITION BY sv.year), 0)) AS proportion\nFROM stock_vehicles AS sv\nWHERE\n    sv.year >= 2010 and sv.fuel_type != 'total'\nGROUP BY\n    sv.year, sv.fuel_type\nORDER BY\n    sv.year, sv.fuel_type;\n"
      },
      {
        "question": "What is the proportion of electric vehicles of each type in the most recent year, in descending order?",
        "query": "SELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n"
      },
      {
        "question": "What is the proportion of electric vehicles of each type in the most recent year, in descending order?",
        "query": "SELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n"
      },
      {
        "question": "What cities do not have any electric cars registered?",
        "query": "SELECT su.name AS city\nFROM spatial_unit AS su\nWHERE NOT EXISTS (\n    SELECT 1\n    FROM stock_vehicles AS sv\n    WHERE su.spatialunit_uid = sv.spatialunit_uid\n        AND sv.fuel_type = 'Electric'\n);\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.stock_vehicles (\n\tuid BIGINT NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tvehicle_type VARCHAR(50), \n\tyear INTEGER, \n\tamount INTEGER, \n\tfuel_type VARCHAR(50), \n\tCONSTRAINT stock_vehicles_pk PRIMARY KEY (uid), \n\tCONSTRAINT stock_vehicles_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in stock_vehicles and 5 examples in each column for high cardinality columns :\nuid : 8829, 8857, 8759, 8774, 8796\nspatialunit_uid : 2079_A.ADM3, 31_A.ADM3, 609_A.ADM3, 23_A.ADM1, 4239_A.ADM3\nyear : 2014, 2011, 2013, 2015, 2020\namount : 97, 72, 23, 29, 17\nfuel_type : Electric, Gas (mono- and bivalent), Benzine-electric: Normal-hybrid, Benzine, Diesel-electric: Plug-in-hybrid\n*/\n\n/*\nColumn name, Column discription, Example values\nvehicle_type, Vehicle type, passenger_cars,trailers,motorcycles\namount, Amount of vehicles, 0,2,240\nfuel_type, Fuel type, Hydrogen,Electric,Diesel-electric: Normal-hybrid\n*/\n\n\n\n### Question\nWhat is the percent change in the number of hybrid cars change in the city of Basel between 2013 and 2014?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2014 THEN amount ELSE 0 END) -\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END) AS hybrid_change,\n    (SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2014 THEN amount ELSE 0 END) -\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END)) * 100.0 / NULLIF(SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END), 0) AS hybrid_percent_change\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.name ILIKE 'Basel'\n    AND su.municipal = 'True' AND fuel_type ILIKE '%hybrid%'\n    AND (year = 2013 OR year = 2014)\nGROUP BY\n    vehicle_type;\n\n\n### Question\nWhen was the first record of an electric vehicle?\n### SQL query\nSELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n\n\n### Question\nHow did the proportion of fuel types evolve since 2010?\n### SQL query\nSELECT\n    sv.year,\n    sv.fuel_type,\n    SUM(sv.amount) AS total_cars,\n    (SUM(sv.amount) * 100.0 / NULLIF(SUM(SUM(sv.amount)) OVER (PARTITION BY sv.year), 0)) AS proportion\nFROM stock_vehicles AS sv\nWHERE\n    sv.year >= 2010 and sv.fuel_type != 'total'\nGROUP BY\n    sv.year, sv.fuel_type\nORDER BY\n    sv.year, sv.fuel_type;\n\n\n### Question\nHow many diesel industrial vehicles were there in Switzerland in 2013?\n### SQL query\nSELECT SUM(amount) AS total_diesel_industrial_vehicles\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name = 'Switzerland'\n    AND sv.vehicle_type = 'industrial vehicles'\n    AND sv.fuel_type = 'Diesel'\n    AND sv.year = 2013;\n\n### Question\nWhat type of vehicle is the most frequent in the canton of Basel?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(amount) AS total_amount\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.canton = 'true'\n    AND su.name ILIKE '%basel%'\nGROUP BY\n    vehicle_type\nORDER BY\n    total_amount DESC\nLIMIT 1;\n\n\n### Question\nWhat cities do not have any electric cars registered?\n### SQL query\nSELECT su.name AS city\nFROM spatial_unit AS su\nWHERE NOT EXISTS (\n    SELECT 1\n    FROM stock_vehicles AS sv\n    WHERE su.spatialunit_uid = sv.spatialunit_uid\n        AND sv.fuel_type = 'Electric'\n);\n\n\n### Question\nWhat are the 5 cantons with the most agricultural vehicles per passenger transportation vehicle in 2010?\n### SQL query\nSELECT\n    su.name AS canton,\n    SUM(CASE WHEN sv.vehicle_type ILIKE '%agricultural%' THEN sv.amount ELSE 0 END) AS total_agricultural_vehicles,\n    SUM(CASE WHEN sv.vehicle_type ILIKE '%passenger transportation%' THEN sv.amount ELSE 0 END) AS total_passenger_vehicles,\n    (SUM(CASE WHEN sv.vehicle_type ILIKE '%agricultural%' THEN sv.amount ELSE 0 END) * 1.0 / NULLIF(SUM(CASE WHEN sv.vehicle_type ILIKE '%passenger transportation%' THEN sv.amount ELSE 0 END), 0)) AS ratio_agricultural_to_passenger\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE sv.year = 2010\n    AND su.canton = 'True'\nGROUP BY su.name\nORDER BY ratio_agricultural_to_passenger DESC\nLIMIT 5;\n\n\n### Question\nWhat are the 5 cantons with the most agricultural vehicles per passenger transportation vehicle in 2010?\n### SQL query\nSELECT\n    su.name AS canton,\n    SUM(CASE WHEN sv.vehicle_type ILIKE '%agricultural%' THEN sv.amount ELSE 0 END) AS total_agricultural_vehicles,\n    SUM(CASE WHEN sv.vehicle_type ILIKE '%passenger transportation%' THEN sv.amount ELSE 0 END) AS total_passenger_vehicles,\n    (SUM(CASE WHEN sv.vehicle_type ILIKE '%agricultural%' THEN sv.amount ELSE 0 END) * 1.0 / NULLIF(SUM(CASE WHEN sv.vehicle_type ILIKE '%passenger transportation%' THEN sv.amount ELSE 0 END), 0)) AS ratio_agricultural_to_passenger\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE sv.year = 2010\n    AND su.canton = 'True'\nGROUP BY su.name\nORDER BY ratio_agricultural_to_passenger DESC\nLIMIT 5;\n\n\n### Question\nWhen was the first record of an electric vehicle?\n### SQL query\nSELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n\n\n### Question\nHow did the proportion of fuel types evolve since 2010?\n### SQL query\nSELECT\n    sv.year,\n    sv.fuel_type,\n    SUM(sv.amount) AS total_cars,\n    (SUM(sv.amount) * 100.0 / NULLIF(SUM(SUM(sv.amount)) OVER (PARTITION BY sv.year), 0)) AS proportion\nFROM stock_vehicles AS sv\nWHERE\n    sv.year >= 2010 and sv.fuel_type != 'total'\nGROUP BY\n    sv.year, sv.fuel_type\nORDER BY\n    sv.year, sv.fuel_type;\n\n\n### Question\nWhat is the proportion of electric vehicles of each type in the most recent year, in descending order?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n\n\n### Question\nWhat is the proportion of electric vehicles of each type in the most recent year, in descending order?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n\n\n### Question\nWhat cities do not have any electric cars registered?\n### SQL query\nSELECT su.name AS city\nFROM spatial_unit AS su\nWHERE NOT EXISTS (\n    SELECT 1\n    FROM stock_vehicles AS sv\n    WHERE su.spatialunit_uid = sv.spatialunit_uid\n        AND sv.fuel_type = 'Electric'\n);\n\n\n### Question\nWhat was the city with the most cars in 2015?\n### SQL query\n",
    "process_time": 4.666063035838306,
    "num_tokens": 2639,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 23,
    "question": "What are fuel types starting with d?",
    "query": "SELECT DISTINCT fuel_type\nFROM stock_vehicles WHERE fuel_type ILIKE 'd%';\n",
    "db_id": "stock_vehicles",
    "generated_query": "SELECT DISTINCT fuel_type\nFROM stock_vehicles\nWHERE fuel_type ILIKE 'd%';",
    "meta_data": [
      {
        "question": "What canton has the most agricultural vehicles across all years?",
        "query": "SELECT\n    su.name AS city,\n    SUM(sv.amount) AS total_agricultural_vehicles\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    sv.vehicle_type ILIKE '%agricultural%'\n    AND su.canton = 'True'\nGROUP BY\n    su.name\nORDER BY\n    total_agricultural_vehicles DESC\nLIMIT 1;\n"
      },
      {
        "question": "What is the percent change in the number of hybrid cars change in the city of Basel between 2013 and 2014?",
        "query": "SELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2014 THEN amount ELSE 0 END) -\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END) AS hybrid_change,\n    (SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2014 THEN amount ELSE 0 END) -\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END)) * 100.0 / NULLIF(SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END), 0) AS hybrid_percent_change\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.name ILIKE 'Basel'\n    AND su.municipal = 'True' AND fuel_type ILIKE '%hybrid%'\n    AND (year = 2013 OR year = 2014)\nGROUP BY\n    vehicle_type;\n"
      },
      {
        "question": "How many diesel industrial vehicles were there in Switzerland in 2013?",
        "query": "SELECT SUM(amount) AS total_diesel_industrial_vehicles\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name = 'Switzerland'\n    AND sv.vehicle_type = 'industrial vehicles'\n    AND sv.fuel_type = 'Diesel'\n    AND sv.year = 2013;"
      },
      {
        "question": "How did the proportion of fuel types evolve since 2010?",
        "query": "SELECT\n    sv.year,\n    sv.fuel_type,\n    SUM(sv.amount) AS total_cars,\n    (SUM(sv.amount) * 100.0 / NULLIF(SUM(SUM(sv.amount)) OVER (PARTITION BY sv.year), 0)) AS proportion\nFROM stock_vehicles AS sv\nWHERE\n    sv.year >= 2010 and sv.fuel_type != 'total'\nGROUP BY\n    sv.year, sv.fuel_type\nORDER BY\n    sv.year, sv.fuel_type;\n"
      },
      {
        "question": "What is the proportion of electric vehicles of each type in the most recent year, in descending order?",
        "query": "SELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n"
      },
      {
        "question": "How many electric-only cars are registered in 2013?",
        "query": "SELECT SUM(amount) AS total_electric_cars\nFROM stock_vehicles WHERE fuel_type = 'Electric'\n    AND year = 2013;\n"
      },
      {
        "question": "What fuel type is most frequently used for motorcycles?",
        "query": "SELECT\n    fuel_type,\n    SUM(amount) AS total_amount\nFROM stock_vehicles WHERE vehicle_type ILIKE '%motorcycle%'\n    AND fuel_type != 'total'\nGROUP BY fuel_type\nORDER BY total_amount DESC\nLIMIT 1;\n"
      },
      {
        "question": "In how many cities are vehicles records available?",
        "query": "SELECT COUNT(DISTINCT spatialunit_uid) AS total_cities\nFROM stock_vehicles;\n"
      },
      {
        "question": "When was the first record of an electric vehicle?",
        "query": "SELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n"
      },
      {
        "question": "What is the proportion of electric vehicles of each type in the most recent year, in descending order?",
        "query": "SELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n"
      },
      {
        "question": "What is the proportion of electric vehicles of each type in the most recent year, in descending order?",
        "query": "SELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n"
      },
      {
        "question": "In how many cities are vehicles records available?",
        "query": "SELECT COUNT(DISTINCT spatialunit_uid) AS total_cities\nFROM stock_vehicles;\n"
      },
      {
        "question": "In how many cities are vehicles records available?",
        "query": "SELECT COUNT(DISTINCT spatialunit_uid) AS total_cities\nFROM stock_vehicles;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.stock_vehicles (\n\tuid BIGINT NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tvehicle_type VARCHAR(50), \n\tyear INTEGER, \n\tamount INTEGER, \n\tfuel_type VARCHAR(50), \n\tCONSTRAINT stock_vehicles_pk PRIMARY KEY (uid), \n\tCONSTRAINT stock_vehicles_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in stock_vehicles and 5 examples in each column for high cardinality columns :\nuid : 8829, 8857, 8759, 8774, 8796\nspatialunit_uid : 2079_A.ADM3, 31_A.ADM3, 609_A.ADM3, 23_A.ADM1, 4239_A.ADM3\nyear : 2014, 2011, 2013, 2015, 2020\namount : 97, 72, 23, 29, 17\nfuel_type : Electric, Gas (mono- and bivalent), Benzine-electric: Normal-hybrid, Benzine, Diesel-electric: Plug-in-hybrid\n*/\n\n/*\nColumn name, Column discription, Example values\nvehicle_type, Vehicle type, passenger_cars,trailers,motorcycles\namount, Amount of vehicles, 0,2,240\nfuel_type, Fuel type, Hydrogen,Electric,Diesel-electric: Normal-hybrid\n*/\n\n\n\n### Question\nWhat canton has the most agricultural vehicles across all years?\n### SQL query\nSELECT\n    su.name AS city,\n    SUM(sv.amount) AS total_agricultural_vehicles\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    sv.vehicle_type ILIKE '%agricultural%'\n    AND su.canton = 'True'\nGROUP BY\n    su.name\nORDER BY\n    total_agricultural_vehicles DESC\nLIMIT 1;\n\n\n### Question\nWhat is the percent change in the number of hybrid cars change in the city of Basel between 2013 and 2014?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2014 THEN amount ELSE 0 END) -\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END) AS hybrid_change,\n    (SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2014 THEN amount ELSE 0 END) -\n    SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END)) * 100.0 / NULLIF(SUM(CASE WHEN fuel_type ILIKE '%hybrid%' AND year = 2013 THEN amount ELSE 0 END), 0) AS hybrid_percent_change\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.name ILIKE 'Basel'\n    AND su.municipal = 'True' AND fuel_type ILIKE '%hybrid%'\n    AND (year = 2013 OR year = 2014)\nGROUP BY\n    vehicle_type;\n\n\n### Question\nHow many diesel industrial vehicles were there in Switzerland in 2013?\n### SQL query\nSELECT SUM(amount) AS total_diesel_industrial_vehicles\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name = 'Switzerland'\n    AND sv.vehicle_type = 'industrial vehicles'\n    AND sv.fuel_type = 'Diesel'\n    AND sv.year = 2013;\n\n### Question\nHow did the proportion of fuel types evolve since 2010?\n### SQL query\nSELECT\n    sv.year,\n    sv.fuel_type,\n    SUM(sv.amount) AS total_cars,\n    (SUM(sv.amount) * 100.0 / NULLIF(SUM(SUM(sv.amount)) OVER (PARTITION BY sv.year), 0)) AS proportion\nFROM stock_vehicles AS sv\nWHERE\n    sv.year >= 2010 and sv.fuel_type != 'total'\nGROUP BY\n    sv.year, sv.fuel_type\nORDER BY\n    sv.year, sv.fuel_type;\n\n\n### Question\nWhat is the proportion of electric vehicles of each type in the most recent year, in descending order?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n\n\n### Question\nHow many electric-only cars are registered in 2013?\n### SQL query\nSELECT SUM(amount) AS total_electric_cars\nFROM stock_vehicles WHERE fuel_type = 'Electric'\n    AND year = 2013;\n\n\n### Question\nWhat fuel type is most frequently used for motorcycles?\n### SQL query\nSELECT\n    fuel_type,\n    SUM(amount) AS total_amount\nFROM stock_vehicles WHERE vehicle_type ILIKE '%motorcycle%'\n    AND fuel_type != 'total'\nGROUP BY fuel_type\nORDER BY total_amount DESC\nLIMIT 1;\n\n\n### Question\nIn how many cities are vehicles records available?\n### SQL query\nSELECT COUNT(DISTINCT spatialunit_uid) AS total_cities\nFROM stock_vehicles;\n\n\n### Question\nWhen was the first record of an electric vehicle?\n### SQL query\nSELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n\n\n### Question\nWhat is the proportion of electric vehicles of each type in the most recent year, in descending order?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n\n\n### Question\nWhat is the proportion of electric vehicles of each type in the most recent year, in descending order?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n\n\n### Question\nIn how many cities are vehicles records available?\n### SQL query\nSELECT COUNT(DISTINCT spatialunit_uid) AS total_cities\nFROM stock_vehicles;\n\n\n### Question\nIn how many cities are vehicles records available?\n### SQL query\nSELECT COUNT(DISTINCT spatialunit_uid) AS total_cities\nFROM stock_vehicles;\n\n\n### Question\nWhat are fuel types starting with d?\n### SQL query\n",
    "process_time": 4.146671551978216,
    "num_tokens": 2248,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 24,
    "question": "What are the top 10 cities with the highest proportion of diesel cars?",
    "query": "SELECT\n    su.name AS city,\n    (SUM(CASE WHEN sv.fuel_type ILIKE '%diesel%' THEN sv.amount ELSE 0 END) * 100.0 / SUM(CASE WHEN sv.fuel_type = 'total' THEN sv.amount ELSE 0 END) ) AS proportion_diesel\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.name IS NOT NULL\nGROUP BY\n    su.name\nORDER BY\n    proportion_diesel DESC\nLIMIT 10;\n",
    "db_id": "stock_vehicles",
    "generated_query": "SELECT\n    su.name AS city,\n    SUM(CASE WHEN sv.fuel_type = 'Diesel' THEN sv.amount ELSE 0 END) AS total_diesel_cars,\n    SUM(sv.amount) AS total_cars,\n    (SUM(CASE WHEN sv.fuel_type = 'Diesel' THEN sv.amount ELSE 0 END) * 100.0 / NULLIF(SUM(sv.amount), 0)) AS proportion_diesel\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.country = true\nGROUP BY su.name\nORDER BY proportion_diesel DESC\nLIMIT 10;",
    "meta_data": [
      {
        "question": "How many diesel industrial vehicles were there in Switzerland in 2013?",
        "query": "SELECT SUM(amount) AS total_diesel_industrial_vehicles\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name = 'Switzerland'\n    AND sv.vehicle_type = 'industrial vehicles'\n    AND sv.fuel_type = 'Diesel'\n    AND sv.year = 2013;"
      },
      {
        "question": "What is the proportion of electric vehicles of each type in the most recent year, in descending order?",
        "query": "SELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n"
      },
      {
        "question": "What fuel type is most frequently used for motorcycles?",
        "query": "SELECT\n    fuel_type,\n    SUM(amount) AS total_amount\nFROM stock_vehicles WHERE vehicle_type ILIKE '%motorcycle%'\n    AND fuel_type != 'total'\nGROUP BY fuel_type\nORDER BY total_amount DESC\nLIMIT 1;\n"
      },
      {
        "question": "What type of vehicle is the most frequent in the canton of Basel?",
        "query": "SELECT\n    vehicle_type,\n    SUM(amount) AS total_amount\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.canton = 'true'\n    AND su.name ILIKE '%basel%'\nGROUP BY\n    vehicle_type\nORDER BY\n    total_amount DESC\nLIMIT 1;\n"
      },
      {
        "question": "What is the most popular car type in the canton of Zurich?",
        "query": "SELECT\n    sv.vehicle_type AS car_type,\n    SUM(sv.amount) AS total_cars\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name ILIKE '%zurich%'\n    AND su.canton = 'True'\n    AND sv.fuel_type = 'total'\n    AND sv.year BETWEEN 2013 AND 2018\nGROUP BY sv.vehicle_type\nORDER BY total_cars DESC\nLIMIT 1;\n"
      },
      {
        "question": "How many diesel industrial vehicles were there in Switzerland in 2013?",
        "query": "SELECT SUM(amount) AS total_diesel_industrial_vehicles\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name = 'Switzerland'\n    AND sv.vehicle_type = 'industrial vehicles'\n    AND sv.fuel_type = 'Diesel'\n    AND sv.year = 2013;"
      },
      {
        "question": "What are the 5 cantons with the most agricultural vehicles per passenger transportation vehicle in 2010?",
        "query": "SELECT\n    su.name AS canton,\n    SUM(CASE WHEN sv.vehicle_type ILIKE '%agricultural%' THEN sv.amount ELSE 0 END) AS total_agricultural_vehicles,\n    SUM(CASE WHEN sv.vehicle_type ILIKE '%passenger transportation%' THEN sv.amount ELSE 0 END) AS total_passenger_vehicles,\n    (SUM(CASE WHEN sv.vehicle_type ILIKE '%agricultural%' THEN sv.amount ELSE 0 END) * 1.0 / NULLIF(SUM(CASE WHEN sv.vehicle_type ILIKE '%passenger transportation%' THEN sv.amount ELSE 0 END), 0)) AS ratio_agricultural_to_passenger\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE sv.year = 2010\n    AND su.canton = 'True'\nGROUP BY su.name\nORDER BY ratio_agricultural_to_passenger DESC\nLIMIT 5;\n"
      },
      {
        "question": "How many diesel industrial vehicles were there in Switzerland in 2013?",
        "query": "SELECT SUM(amount) AS total_diesel_industrial_vehicles\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name = 'Switzerland'\n    AND sv.vehicle_type = 'industrial vehicles'\n    AND sv.fuel_type = 'Diesel'\n    AND sv.year = 2013;"
      },
      {
        "question": "How many diesel industrial vehicles were there in Switzerland in 2013?",
        "query": "SELECT SUM(amount) AS total_diesel_industrial_vehicles\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name = 'Switzerland'\n    AND sv.vehicle_type = 'industrial vehicles'\n    AND sv.fuel_type = 'Diesel'\n    AND sv.year = 2013;"
      },
      {
        "question": "What fuel type is most frequently used for motorcycles?",
        "query": "SELECT\n    fuel_type,\n    SUM(amount) AS total_amount\nFROM stock_vehicles WHERE vehicle_type ILIKE '%motorcycle%'\n    AND fuel_type != 'total'\nGROUP BY fuel_type\nORDER BY total_amount DESC\nLIMIT 1;\n"
      },
      {
        "question": "When was the first record of an electric vehicle?",
        "query": "SELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n"
      },
      {
        "question": "What cities do not have any electric cars registered?",
        "query": "SELECT su.name AS city\nFROM spatial_unit AS su\nWHERE NOT EXISTS (\n    SELECT 1\n    FROM stock_vehicles AS sv\n    WHERE su.spatialunit_uid = sv.spatialunit_uid\n        AND sv.fuel_type = 'Electric'\n);\n"
      },
      {
        "question": "When was the first record of an electric vehicle?",
        "query": "SELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.stock_vehicles (\n\tuid BIGINT NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tvehicle_type VARCHAR(50), \n\tyear INTEGER, \n\tamount INTEGER, \n\tfuel_type VARCHAR(50), \n\tCONSTRAINT stock_vehicles_pk PRIMARY KEY (uid), \n\tCONSTRAINT stock_vehicles_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in stock_vehicles and 5 examples in each column for high cardinality columns :\nuid : 8829, 8857, 8759, 8774, 8796\nspatialunit_uid : 2079_A.ADM3, 31_A.ADM3, 609_A.ADM3, 23_A.ADM1, 4239_A.ADM3\nyear : 2014, 2011, 2013, 2015, 2020\namount : 97, 72, 23, 29, 17\nfuel_type : Electric, Gas (mono- and bivalent), Benzine-electric: Normal-hybrid, Benzine, Diesel-electric: Plug-in-hybrid\n*/\n\n/*\nColumn name, Column discription, Example values\nvehicle_type, Vehicle type, passenger_cars,trailers,motorcycles\namount, Amount of vehicles, 0,2,240\nfuel_type, Fuel type, Hydrogen,Electric,Diesel-electric: Normal-hybrid\n*/\n\n\n\n### Question\nHow many diesel industrial vehicles were there in Switzerland in 2013?\n### SQL query\nSELECT SUM(amount) AS total_diesel_industrial_vehicles\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name = 'Switzerland'\n    AND sv.vehicle_type = 'industrial vehicles'\n    AND sv.fuel_type = 'Diesel'\n    AND sv.year = 2013;\n\n### Question\nWhat is the proportion of electric vehicles of each type in the most recent year, in descending order?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n\n\n### Question\nWhat fuel type is most frequently used for motorcycles?\n### SQL query\nSELECT\n    fuel_type,\n    SUM(amount) AS total_amount\nFROM stock_vehicles WHERE vehicle_type ILIKE '%motorcycle%'\n    AND fuel_type != 'total'\nGROUP BY fuel_type\nORDER BY total_amount DESC\nLIMIT 1;\n\n\n### Question\nWhat type of vehicle is the most frequent in the canton of Basel?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(amount) AS total_amount\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.canton = 'true'\n    AND su.name ILIKE '%basel%'\nGROUP BY\n    vehicle_type\nORDER BY\n    total_amount DESC\nLIMIT 1;\n\n\n### Question\nWhat is the most popular car type in the canton of Zurich?\n### SQL query\nSELECT\n    sv.vehicle_type AS car_type,\n    SUM(sv.amount) AS total_cars\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name ILIKE '%zurich%'\n    AND su.canton = 'True'\n    AND sv.fuel_type = 'total'\n    AND sv.year BETWEEN 2013 AND 2018\nGROUP BY sv.vehicle_type\nORDER BY total_cars DESC\nLIMIT 1;\n\n\n### Question\nHow many diesel industrial vehicles were there in Switzerland in 2013?\n### SQL query\nSELECT SUM(amount) AS total_diesel_industrial_vehicles\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name = 'Switzerland'\n    AND sv.vehicle_type = 'industrial vehicles'\n    AND sv.fuel_type = 'Diesel'\n    AND sv.year = 2013;\n\n### Question\nWhat are the 5 cantons with the most agricultural vehicles per passenger transportation vehicle in 2010?\n### SQL query\nSELECT\n    su.name AS canton,\n    SUM(CASE WHEN sv.vehicle_type ILIKE '%agricultural%' THEN sv.amount ELSE 0 END) AS total_agricultural_vehicles,\n    SUM(CASE WHEN sv.vehicle_type ILIKE '%passenger transportation%' THEN sv.amount ELSE 0 END) AS total_passenger_vehicles,\n    (SUM(CASE WHEN sv.vehicle_type ILIKE '%agricultural%' THEN sv.amount ELSE 0 END) * 1.0 / NULLIF(SUM(CASE WHEN sv.vehicle_type ILIKE '%passenger transportation%' THEN sv.amount ELSE 0 END), 0)) AS ratio_agricultural_to_passenger\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE sv.year = 2010\n    AND su.canton = 'True'\nGROUP BY su.name\nORDER BY ratio_agricultural_to_passenger DESC\nLIMIT 5;\n\n\n### Question\nHow many diesel industrial vehicles were there in Switzerland in 2013?\n### SQL query\nSELECT SUM(amount) AS total_diesel_industrial_vehicles\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name = 'Switzerland'\n    AND sv.vehicle_type = 'industrial vehicles'\n    AND sv.fuel_type = 'Diesel'\n    AND sv.year = 2013;\n\n### Question\nHow many diesel industrial vehicles were there in Switzerland in 2013?\n### SQL query\nSELECT SUM(amount) AS total_diesel_industrial_vehicles\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name = 'Switzerland'\n    AND sv.vehicle_type = 'industrial vehicles'\n    AND sv.fuel_type = 'Diesel'\n    AND sv.year = 2013;\n\n### Question\nWhat fuel type is most frequently used for motorcycles?\n### SQL query\nSELECT\n    fuel_type,\n    SUM(amount) AS total_amount\nFROM stock_vehicles WHERE vehicle_type ILIKE '%motorcycle%'\n    AND fuel_type != 'total'\nGROUP BY fuel_type\nORDER BY total_amount DESC\nLIMIT 1;\n\n\n### Question\nWhen was the first record of an electric vehicle?\n### SQL query\nSELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n\n\n### Question\nWhat cities do not have any electric cars registered?\n### SQL query\nSELECT su.name AS city\nFROM spatial_unit AS su\nWHERE NOT EXISTS (\n    SELECT 1\n    FROM stock_vehicles AS sv\n    WHERE su.spatialunit_uid = sv.spatialunit_uid\n        AND sv.fuel_type = 'Electric'\n);\n\n\n### Question\nWhen was the first record of an electric vehicle?\n### SQL query\nSELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n\n\n### Question\nWhat are the top 10 cities with the highest proportion of diesel cars?\n### SQL query\n",
    "process_time": 15.3549090300221,
    "num_tokens": 2232,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 25,
    "question": "What year saw the biggest year-on-year increase in electric cars in the city of Basel?",
    "query": "SELECT\n    year,\n    year_on_year_increase\nFROM (\n    SELECT\n        sv.year,\n        (sv.amount - lag(sv.amount) OVER (ORDER BY sv.year)) AS year_on_year_increase\n    FROM spatial_unit AS su\n        INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\n    WHERE\n        su.name = 'Basel' and su.municipal = 'True'\n        AND sv.fuel_type ILIKE '%electric%'\n) AS subquery\nWHERE\n    year_on_year_increase IS NOT NULL\nORDER BY\n    year_on_year_increase DESC\nLIMIT 1;\n",
    "db_id": "stock_vehicles",
    "generated_query": "SELECT\n    sv.year AS start_year,\n    sv.year + 1 AS end_year,\n    SUM(sv.amount) AS increase_in_electric_cars\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.name ILIKE '%basel%'\n    AND sv.fuel_type ILIKE '%electric%'\nGROUP BY\n    sv.year\nHAVING\n    SUM(sv.amount) > 0\nORDER BY\n    increase_in_electric_cars DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "What is the proportion of electric vehicles of each type in the most recent year, in descending order?",
        "query": "SELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n"
      },
      {
        "question": "What is the most popular car type in the canton of Zurich?",
        "query": "SELECT\n    sv.vehicle_type AS car_type,\n    SUM(sv.amount) AS total_cars\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name ILIKE '%zurich%'\n    AND su.canton = 'True'\n    AND sv.fuel_type = 'total'\n    AND sv.year BETWEEN 2013 AND 2018\nGROUP BY sv.vehicle_type\nORDER BY total_cars DESC\nLIMIT 1;\n"
      },
      {
        "question": "How many electric-only cars are registered in 2013?",
        "query": "SELECT SUM(amount) AS total_electric_cars\nFROM stock_vehicles WHERE fuel_type = 'Electric'\n    AND year = 2013;\n"
      },
      {
        "question": "How many diesel industrial vehicles were there in Switzerland in 2013?",
        "query": "SELECT SUM(amount) AS total_diesel_industrial_vehicles\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name = 'Switzerland'\n    AND sv.vehicle_type = 'industrial vehicles'\n    AND sv.fuel_type = 'Diesel'\n    AND sv.year = 2013;"
      },
      {
        "question": "In how many cities are vehicles records available?",
        "query": "SELECT COUNT(DISTINCT spatialunit_uid) AS total_cities\nFROM stock_vehicles;\n"
      },
      {
        "question": "What are the 5 cantons with the most agricultural vehicles per passenger transportation vehicle in 2010?",
        "query": "SELECT\n    su.name AS canton,\n    SUM(CASE WHEN sv.vehicle_type ILIKE '%agricultural%' THEN sv.amount ELSE 0 END) AS total_agricultural_vehicles,\n    SUM(CASE WHEN sv.vehicle_type ILIKE '%passenger transportation%' THEN sv.amount ELSE 0 END) AS total_passenger_vehicles,\n    (SUM(CASE WHEN sv.vehicle_type ILIKE '%agricultural%' THEN sv.amount ELSE 0 END) * 1.0 / NULLIF(SUM(CASE WHEN sv.vehicle_type ILIKE '%passenger transportation%' THEN sv.amount ELSE 0 END), 0)) AS ratio_agricultural_to_passenger\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE sv.year = 2010\n    AND su.canton = 'True'\nGROUP BY su.name\nORDER BY ratio_agricultural_to_passenger DESC\nLIMIT 5;\n"
      },
      {
        "question": "What is the proportion of electric vehicles of each type in the most recent year, in descending order?",
        "query": "SELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n"
      },
      {
        "question": "What is the proportion of electric vehicles of each type in the most recent year, in descending order?",
        "query": "SELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n"
      },
      {
        "question": "How many diesel industrial vehicles were there in Switzerland in 2013?",
        "query": "SELECT SUM(amount) AS total_diesel_industrial_vehicles\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name = 'Switzerland'\n    AND sv.vehicle_type = 'industrial vehicles'\n    AND sv.fuel_type = 'Diesel'\n    AND sv.year = 2013;"
      },
      {
        "question": "How many diesel industrial vehicles were there in Switzerland in 2013?",
        "query": "SELECT SUM(amount) AS total_diesel_industrial_vehicles\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name = 'Switzerland'\n    AND sv.vehicle_type = 'industrial vehicles'\n    AND sv.fuel_type = 'Diesel'\n    AND sv.year = 2013;"
      },
      {
        "question": "What type of vehicle is the most frequent in the canton of Basel?",
        "query": "SELECT\n    vehicle_type,\n    SUM(amount) AS total_amount\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.canton = 'true'\n    AND su.name ILIKE '%basel%'\nGROUP BY\n    vehicle_type\nORDER BY\n    total_amount DESC\nLIMIT 1;\n"
      },
      {
        "question": "What canton has the most agricultural vehicles across all years?",
        "query": "SELECT\n    su.name AS city,\n    SUM(sv.amount) AS total_agricultural_vehicles\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    sv.vehicle_type ILIKE '%agricultural%'\n    AND su.canton = 'True'\nGROUP BY\n    su.name\nORDER BY\n    total_agricultural_vehicles DESC\nLIMIT 1;\n"
      },
      {
        "question": "When was the first record of an electric vehicle?",
        "query": "SELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.stock_vehicles (\n\tuid BIGINT NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tvehicle_type VARCHAR(50), \n\tyear INTEGER, \n\tamount INTEGER, \n\tfuel_type VARCHAR(50), \n\tCONSTRAINT stock_vehicles_pk PRIMARY KEY (uid), \n\tCONSTRAINT stock_vehicles_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in stock_vehicles and 5 examples in each column for high cardinality columns :\nuid : 8829, 8857, 8759, 8774, 8796\nspatialunit_uid : 2079_A.ADM3, 31_A.ADM3, 609_A.ADM3, 23_A.ADM1, 4239_A.ADM3\nyear : 2014, 2011, 2013, 2015, 2020\namount : 97, 72, 23, 29, 17\nfuel_type : Electric, Gas (mono- and bivalent), Benzine-electric: Normal-hybrid, Benzine, Diesel-electric: Plug-in-hybrid\n*/\n\n/*\nColumn name, Column discription, Example values\nvehicle_type, Vehicle type, passenger_cars,trailers,motorcycles\namount, Amount of vehicles, 0,2,240\nfuel_type, Fuel type, Hydrogen,Electric,Diesel-electric: Normal-hybrid\n*/\n\n\n\n### Question\nWhat is the proportion of electric vehicles of each type in the most recent year, in descending order?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n\n\n### Question\nWhat is the most popular car type in the canton of Zurich?\n### SQL query\nSELECT\n    sv.vehicle_type AS car_type,\n    SUM(sv.amount) AS total_cars\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name ILIKE '%zurich%'\n    AND su.canton = 'True'\n    AND sv.fuel_type = 'total'\n    AND sv.year BETWEEN 2013 AND 2018\nGROUP BY sv.vehicle_type\nORDER BY total_cars DESC\nLIMIT 1;\n\n\n### Question\nHow many electric-only cars are registered in 2013?\n### SQL query\nSELECT SUM(amount) AS total_electric_cars\nFROM stock_vehicles WHERE fuel_type = 'Electric'\n    AND year = 2013;\n\n\n### Question\nHow many diesel industrial vehicles were there in Switzerland in 2013?\n### SQL query\nSELECT SUM(amount) AS total_diesel_industrial_vehicles\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name = 'Switzerland'\n    AND sv.vehicle_type = 'industrial vehicles'\n    AND sv.fuel_type = 'Diesel'\n    AND sv.year = 2013;\n\n### Question\nIn how many cities are vehicles records available?\n### SQL query\nSELECT COUNT(DISTINCT spatialunit_uid) AS total_cities\nFROM stock_vehicles;\n\n\n### Question\nWhat are the 5 cantons with the most agricultural vehicles per passenger transportation vehicle in 2010?\n### SQL query\nSELECT\n    su.name AS canton,\n    SUM(CASE WHEN sv.vehicle_type ILIKE '%agricultural%' THEN sv.amount ELSE 0 END) AS total_agricultural_vehicles,\n    SUM(CASE WHEN sv.vehicle_type ILIKE '%passenger transportation%' THEN sv.amount ELSE 0 END) AS total_passenger_vehicles,\n    (SUM(CASE WHEN sv.vehicle_type ILIKE '%agricultural%' THEN sv.amount ELSE 0 END) * 1.0 / NULLIF(SUM(CASE WHEN sv.vehicle_type ILIKE '%passenger transportation%' THEN sv.amount ELSE 0 END), 0)) AS ratio_agricultural_to_passenger\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv\nON su.spatialunit_uid = sv.spatialunit_uid\nWHERE sv.year = 2010\n    AND su.canton = 'True'\nGROUP BY su.name\nORDER BY ratio_agricultural_to_passenger DESC\nLIMIT 5;\n\n\n### Question\nWhat is the proportion of electric vehicles of each type in the most recent year, in descending order?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n\n\n### Question\nWhat is the proportion of electric vehicles of each type in the most recent year, in descending order?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) AS electric_cars,\n    SUM(amount) AS total_cars,\n    (\n        SUM(CASE WHEN fuel_type ILIKE '%electric%' THEN amount ELSE 0 END) * 100.0 / NULLIF(SUM(amount), 0)\n    ) AS proportion_electric\nFROM stock_vehicles WHERE year = (\n    SELECT MAX(year)\n    FROM stock_vehicles\n    )\nGROUP BY vehicle_type\nORDER BY proportion_electric DESC;\n\n\n### Question\nHow many diesel industrial vehicles were there in Switzerland in 2013?\n### SQL query\nSELECT SUM(amount) AS total_diesel_industrial_vehicles\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name = 'Switzerland'\n    AND sv.vehicle_type = 'industrial vehicles'\n    AND sv.fuel_type = 'Diesel'\n    AND sv.year = 2013;\n\n### Question\nHow many diesel industrial vehicles were there in Switzerland in 2013?\n### SQL query\nSELECT SUM(amount) AS total_diesel_industrial_vehicles\nFROM spatial_unit AS su\nINNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE su.name = 'Switzerland'\n    AND sv.vehicle_type = 'industrial vehicles'\n    AND sv.fuel_type = 'Diesel'\n    AND sv.year = 2013;\n\n### Question\nWhat type of vehicle is the most frequent in the canton of Basel?\n### SQL query\nSELECT\n    vehicle_type,\n    SUM(amount) AS total_amount\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    su.canton = 'true'\n    AND su.name ILIKE '%basel%'\nGROUP BY\n    vehicle_type\nORDER BY\n    total_amount DESC\nLIMIT 1;\n\n\n### Question\nWhat canton has the most agricultural vehicles across all years?\n### SQL query\nSELECT\n    su.name AS city,\n    SUM(sv.amount) AS total_agricultural_vehicles\nFROM spatial_unit AS su\n    INNER JOIN stock_vehicles AS sv ON su.spatialunit_uid = sv.spatialunit_uid\nWHERE\n    sv.vehicle_type ILIKE '%agricultural%'\n    AND su.canton = 'True'\nGROUP BY\n    su.name\nORDER BY\n    total_agricultural_vehicles DESC\nLIMIT 1;\n\n\n### Question\nWhen was the first record of an electric vehicle?\n### SQL query\nSELECT\n    MIN(year) AS first_record_year\nFROM stock_vehicles WHERE fuel_type ILIKE '%electric%';\n\n\n### Question\nWhat year saw the biggest year-on-year increase in electric cars in the city of Basel?\n### SQL query\n",
    "process_time": 8.10864275903441,
    "num_tokens": 2372,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 26,
    "question": "How many favorite babynames are registered in year 2011?",
    "query": "SELECT DISTINCT COUNT(bnff.first_name)\nFROM baby_names_favorite_firstname as bnff\nWHERE bnff.year = 2011;\n",
    "db_id": "baby_names_favorite_firstname",
    "generated_query": "SELECT COUNT(*)\nFROM baby_names_favorite_firstname\nWHERE year = 2011;",
    "meta_data": [
      {
        "question": "Show me all registered gender-universal names in Switzerland.",
        "query": "SELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Switzerland%' and su.country = 'TRUE' and gender = 'girl'\nintersect\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Switzerland%' and su.country = 'TRUE' and gender = 'boy';\n"
      },
      {
        "question": "Which year has the most registered baby names for all cantons?",
        "query": "SELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n"
      },
      {
        "question": "All names that have been utilized by over 50 baby girls in canton Vaud. Please order the results by year.",
        "query": "SELECT bnff.first_name, bnff.year, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Vaud%'  and bnff.gender = 'girl' and bnff.amount > 50\nORDER BY bnff.year;\n"
      },
      {
        "question": "Show me the top one ranking boy names for each year after 2012 in canton Zug. Fetch me the result in an ascending order of the year.",
        "query": "SELECT bnff.first_name, bnff.year\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Zug%' and bnff.gender = 'boy' and bnff.year > 2012 and bnff.rank = 1\nORDER BY bnff.year;\n"
      },
      {
        "question": "Show me all registered names in records.",
        "query": "SELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff;\n"
      },
      {
        "question": "How many girls borned in 2014 in Switzeland is named as Lena. Return me the rank as well.",
        "query": "SELECT amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2014\n    AND bnff.gender = 'girl'\n    AND bnff.first_name = 'Lena'\n    AND su.name = 'Switzerland'\n    AND su.country = 'TRUE';\n"
      },
      {
        "question": "All names that have been utilized by over 50 baby girls in canton Vaud. Please order the results by year.",
        "query": "SELECT bnff.first_name, bnff.year, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Vaud%'  and bnff.gender = 'girl' and bnff.amount > 50\nORDER BY bnff.year;\n"
      },
      {
        "question": "Show me the top one ranking boy names for each year after 2012 in canton Zug. Fetch me the result in an ascending order of the year.",
        "query": "SELECT bnff.first_name, bnff.year\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Zug%' and bnff.gender = 'boy' and bnff.year > 2012 and bnff.rank = 1\nORDER BY bnff.year;\n"
      },
      {
        "question": "Show me all top-1 ranked boy names for in each canton in year 2014.",
        "query": "SELECT bnff.first_name, su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2014 and bnff.rank = 1;;\n"
      },
      {
        "question": "How many boys were registered in Canton Valais in year 2011?",
        "query": "SELECT sum(amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2011 AND gender = 'boy' AND su.name ilike '%valais%' AND su.canton = 'TRUE';\n"
      },
      {
        "question": "Which year has the most registered baby names for all cantons?",
        "query": "SELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n"
      },
      {
        "question": "Show me the most popular names of girls in Switzerland in 2016.",
        "query": "SELECT first_name, gender, amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 and gender = 'girl' AND su.country = ''True'' AND su.name = 'Switzerland'\nORDER BY bnff.amount DESC LIMIT 1;\n"
      },
      {
        "question": "How many boys were registered in Canton Valais in year 2011?",
        "query": "SELECT sum(amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2011 AND gender = 'boy' AND su.name ilike '%valais%' AND su.canton = 'TRUE';\n"
      },
      {
        "question": "All names that have been utilized by over 50 baby girls in canton Vaud. Please order the results by year.",
        "query": "SELECT bnff.first_name, bnff.year, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Vaud%'  and bnff.gender = 'girl' and bnff.amount > 50\nORDER BY bnff.year;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.baby_names_favorite_firstname (\n\tuid SERIAL NOT NULL, \n\tgender TEXT, \n\tyear INTEGER, \n\tfirst_name TEXT, \n\tamount NUMERIC, \n\trank NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT baby_names_favorite_firstname_pkey PRIMARY KEY (uid), \n\tCONSTRAINT baby_names_favorite_firstname_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in baby_names_favorite_firstname and 5 examples in each column for high cardinality columns :\nuid : 1690640, 1690652, 1690508, 1690655, 1690653\nyear : 2015, 2000, 2009, 2012, 2019\namount : 4, 0, 2, 6, 10\nrank : 72, 29, 57, 28, 110\n*/\n\n/*\nColumn name, Column discription, Example values\ngender, gender, girl,boy\nfirst_name, First name, Anna,Martin\nrank, rank, 12\namount, amount, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nShow me all registered gender-universal names in Switzerland.\n### SQL query\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Switzerland%' and su.country = 'TRUE' and gender = 'girl'\nintersect\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Switzerland%' and su.country = 'TRUE' and gender = 'boy';\n\n\n### Question\nWhich year has the most registered baby names for all cantons?\n### SQL query\nSELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n\n\n### Question\nAll names that have been utilized by over 50 baby girls in canton Vaud. Please order the results by year.\n### SQL query\nSELECT bnff.first_name, bnff.year, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Vaud%'  and bnff.gender = 'girl' and bnff.amount > 50\nORDER BY bnff.year;\n\n\n### Question\nShow me the top one ranking boy names for each year after 2012 in canton Zug. Fetch me the result in an ascending order of the year.\n### SQL query\nSELECT bnff.first_name, bnff.year\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Zug%' and bnff.gender = 'boy' and bnff.year > 2012 and bnff.rank = 1\nORDER BY bnff.year;\n\n\n### Question\nShow me all registered names in records.\n### SQL query\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff;\n\n\n### Question\nHow many girls borned in 2014 in Switzeland is named as Lena. Return me the rank as well.\n### SQL query\nSELECT amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2014\n    AND bnff.gender = 'girl'\n    AND bnff.first_name = 'Lena'\n    AND su.name = 'Switzerland'\n    AND su.country = 'TRUE';\n\n\n### Question\nAll names that have been utilized by over 50 baby girls in canton Vaud. Please order the results by year.\n### SQL query\nSELECT bnff.first_name, bnff.year, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Vaud%'  and bnff.gender = 'girl' and bnff.amount > 50\nORDER BY bnff.year;\n\n\n### Question\nShow me the top one ranking boy names for each year after 2012 in canton Zug. Fetch me the result in an ascending order of the year.\n### SQL query\nSELECT bnff.first_name, bnff.year\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Zug%' and bnff.gender = 'boy' and bnff.year > 2012 and bnff.rank = 1\nORDER BY bnff.year;\n\n\n### Question\nShow me all top-1 ranked boy names for in each canton in year 2014.\n### SQL query\nSELECT bnff.first_name, su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2014 and bnff.rank = 1;;\n\n\n### Question\nHow many boys were registered in Canton Valais in year 2011?\n### SQL query\nSELECT sum(amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2011 AND gender = 'boy' AND su.name ilike '%valais%' AND su.canton = 'TRUE';\n\n\n### Question\nWhich year has the most registered baby names for all cantons?\n### SQL query\nSELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n\n\n### Question\nShow me the most popular names of girls in Switzerland in 2016.\n### SQL query\nSELECT first_name, gender, amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 and gender = 'girl' AND su.country = ''True'' AND su.name = 'Switzerland'\nORDER BY bnff.amount DESC LIMIT 1;\n\n\n### Question\nHow many boys were registered in Canton Valais in year 2011?\n### SQL query\nSELECT sum(amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2011 AND gender = 'boy' AND su.name ilike '%valais%' AND su.canton = 'TRUE';\n\n\n### Question\nAll names that have been utilized by over 50 baby girls in canton Vaud. Please order the results by year.\n### SQL query\nSELECT bnff.first_name, bnff.year, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Vaud%'  and bnff.gender = 'girl' and bnff.amount > 50\nORDER BY bnff.year;\n\n\n### Question\nHow many favorite babynames are registered in year 2011?\n### SQL query\n",
    "process_time": 1.8884101461153477,
    "num_tokens": 2264,
    "hardness": "easy",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 27,
    "question": "Show me all amount of baby names in all municipalities.",
    "query": "SELECT bnff.first_name, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.municipal = 'TRUE';\n",
    "db_id": "baby_names_favorite_firstname",
    "generated_query": "SELECT sum(amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.municipal = 'TRUE';",
    "meta_data": [
      {
        "question": "How many baby names were registered?",
        "query": "SELECT DISTINCT COUNT(bnff.first_name)\nFROM baby_names_favorite_firstname as bnff;\n"
      },
      {
        "question": "Please list all registered baby names in Canton Zug in all years. Return me the result in order of alphabets.",
        "query": "SELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Zug%' and su.canton = 'TRUE'\nORDER BY bnff.first_name;\n"
      },
      {
        "question": "Show me the most popular names of girls in Switzerland in 2016.",
        "query": "SELECT first_name, gender, amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 and gender = 'girl' AND su.country = ''True'' AND su.name = 'Switzerland'\nORDER BY bnff.amount DESC LIMIT 1;\n"
      },
      {
        "question": "Which year has the least registered baby names for all cantons?",
        "query": "SELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) LIMIT 1;\n"
      },
      {
        "question": "Please list all registered baby names in Canton Zug in all years. Return me the result in order of alphabets.",
        "query": "SELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Zug%' and su.canton = 'TRUE'\nORDER BY bnff.first_name;\n"
      },
      {
        "question": "All names that have been utilized by over 50 baby girls in canton Vaud. Please order the results by year.",
        "query": "SELECT bnff.first_name, bnff.year, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Vaud%'  and bnff.gender = 'girl' and bnff.amount > 50\nORDER BY bnff.year;\n"
      },
      {
        "question": "All names that have been utilized by over 50 baby girls in canton Vaud. Please order the results by year.",
        "query": "SELECT bnff.first_name, bnff.year, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Vaud%'  and bnff.gender = 'girl' and bnff.amount > 50\nORDER BY bnff.year;\n"
      },
      {
        "question": "Which canton has most borned girls registed in 2011?",
        "query": "SELECT sum(bnff.amount), su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'girl' and bnff.year = 2011\nGROUP BY su.name\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n"
      },
      {
        "question": "All names that have been utilized by over 50 baby girls in canton Vaud. Please order the results by year.",
        "query": "SELECT bnff.first_name, bnff.year, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Vaud%'  and bnff.gender = 'girl' and bnff.amount > 50\nORDER BY bnff.year;\n"
      },
      {
        "question": "Show me the top one ranking boy names for each year after 2012 in canton Zug. Fetch me the result in an ascending order of the year.",
        "query": "SELECT bnff.first_name, bnff.year\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Zug%' and bnff.gender = 'boy' and bnff.year > 2012 and bnff.rank = 1\nORDER BY bnff.year;\n"
      },
      {
        "question": "Which year has the most registered baby names for all cantons?",
        "query": "SELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n"
      },
      {
        "question": "How many boys were registered in Canton Valais in year 2011?",
        "query": "SELECT sum(amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2011 AND gender = 'boy' AND su.name ilike '%valais%' AND su.canton = 'TRUE';\n"
      },
      {
        "question": "Show me all registered names in records.",
        "query": "SELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff;\n"
      },
      {
        "question": "Please list all registered baby names in Canton Zug in all years. Return me the result in order of alphabets.",
        "query": "SELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Zug%' and su.canton = 'TRUE'\nORDER BY bnff.first_name;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.baby_names_favorite_firstname (\n\tuid SERIAL NOT NULL, \n\tgender TEXT, \n\tyear INTEGER, \n\tfirst_name TEXT, \n\tamount NUMERIC, \n\trank NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT baby_names_favorite_firstname_pkey PRIMARY KEY (uid), \n\tCONSTRAINT baby_names_favorite_firstname_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in baby_names_favorite_firstname and 5 examples in each column for high cardinality columns :\nuid : 1690640, 1690652, 1690508, 1690655, 1690653\nyear : 2015, 2000, 2009, 2012, 2019\namount : 4, 0, 2, 6, 10\nrank : 72, 29, 57, 28, 110\n*/\n\n/*\nColumn name, Column discription, Example values\ngender, gender, girl,boy\nfirst_name, First name, Anna,Martin\nrank, rank, 12\namount, amount, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nHow many baby names were registered?\n### SQL query\nSELECT DISTINCT COUNT(bnff.first_name)\nFROM baby_names_favorite_firstname as bnff;\n\n\n### Question\nPlease list all registered baby names in Canton Zug in all years. Return me the result in order of alphabets.\n### SQL query\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Zug%' and su.canton = 'TRUE'\nORDER BY bnff.first_name;\n\n\n### Question\nShow me the most popular names of girls in Switzerland in 2016.\n### SQL query\nSELECT first_name, gender, amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 and gender = 'girl' AND su.country = ''True'' AND su.name = 'Switzerland'\nORDER BY bnff.amount DESC LIMIT 1;\n\n\n### Question\nWhich year has the least registered baby names for all cantons?\n### SQL query\nSELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) LIMIT 1;\n\n\n### Question\nPlease list all registered baby names in Canton Zug in all years. Return me the result in order of alphabets.\n### SQL query\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Zug%' and su.canton = 'TRUE'\nORDER BY bnff.first_name;\n\n\n### Question\nAll names that have been utilized by over 50 baby girls in canton Vaud. Please order the results by year.\n### SQL query\nSELECT bnff.first_name, bnff.year, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Vaud%'  and bnff.gender = 'girl' and bnff.amount > 50\nORDER BY bnff.year;\n\n\n### Question\nAll names that have been utilized by over 50 baby girls in canton Vaud. Please order the results by year.\n### SQL query\nSELECT bnff.first_name, bnff.year, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Vaud%'  and bnff.gender = 'girl' and bnff.amount > 50\nORDER BY bnff.year;\n\n\n### Question\nWhich canton has most borned girls registed in 2011?\n### SQL query\nSELECT sum(bnff.amount), su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'girl' and bnff.year = 2011\nGROUP BY su.name\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n\n\n### Question\nAll names that have been utilized by over 50 baby girls in canton Vaud. Please order the results by year.\n### SQL query\nSELECT bnff.first_name, bnff.year, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Vaud%'  and bnff.gender = 'girl' and bnff.amount > 50\nORDER BY bnff.year;\n\n\n### Question\nShow me the top one ranking boy names for each year after 2012 in canton Zug. Fetch me the result in an ascending order of the year.\n### SQL query\nSELECT bnff.first_name, bnff.year\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Zug%' and bnff.gender = 'boy' and bnff.year > 2012 and bnff.rank = 1\nORDER BY bnff.year;\n\n\n### Question\nWhich year has the most registered baby names for all cantons?\n### SQL query\nSELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n\n\n### Question\nHow many boys were registered in Canton Valais in year 2011?\n### SQL query\nSELECT sum(amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2011 AND gender = 'boy' AND su.name ilike '%valais%' AND su.canton = 'TRUE';\n\n\n### Question\nShow me all registered names in records.\n### SQL query\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff;\n\n\n### Question\nPlease list all registered baby names in Canton Zug in all years. Return me the result in order of alphabets.\n### SQL query\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Zug%' and su.canton = 'TRUE'\nORDER BY bnff.first_name;\n\n\n### Question\nShow me all amount of baby names in all municipalities.\n### SQL query\n",
    "process_time": 5.267265795962885,
    "num_tokens": 2122,
    "hardness": "medium",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 28,
    "question": "Which canton has the most borned boys called 'Oscar' in 2016?",
    "query": "SELECT su.name, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 AND gender = 'boy' AND bnff.first_name = 'Oscar' AND su.canton = 'TRUE'\nORDER BY bnff.amount DESC LIMIT 1;\n",
    "db_id": "baby_names_favorite_firstname",
    "generated_query": "SELECT sum(bnff.amount), su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2016 and bnff.first_name = 'Oscar'\nGROUP BY su.name\nORDER BY sum(bnff.amount) DESC LIMIT 1;",
    "meta_data": [
      {
        "question": "Which canton has most borned girls registed in 2011?",
        "query": "SELECT sum(bnff.amount), su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'girl' and bnff.year = 2011\nGROUP BY su.name\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n"
      },
      {
        "question": "How many baby names were registered?",
        "query": "SELECT DISTINCT COUNT(bnff.first_name)\nFROM baby_names_favorite_firstname as bnff;\n"
      },
      {
        "question": "Show me all registered gender-universal names in Switzerland.",
        "query": "SELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Switzerland%' and su.country = 'TRUE' and gender = 'girl'\nintersect\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Switzerland%' and su.country = 'TRUE' and gender = 'boy';\n"
      },
      {
        "question": "Show me all registered gender-universal names in Switzerland.",
        "query": "SELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Switzerland%' and su.country = 'TRUE' and gender = 'girl'\nintersect\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Switzerland%' and su.country = 'TRUE' and gender = 'boy';\n"
      },
      {
        "question": "Show me all registered names in records.",
        "query": "SELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff;\n"
      },
      {
        "question": "Show me the most popular names of girls in Switzerland in 2016.",
        "query": "SELECT first_name, gender, amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 and gender = 'girl' AND su.country = ''True'' AND su.name = 'Switzerland'\nORDER BY bnff.amount DESC LIMIT 1;\n"
      },
      {
        "question": "Which canton has least borned boys registed in 2011?",
        "query": "SELECT sum(bnff.amount), su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2011\nGROUP BY su.name\nORDER BY sum(bnff.amount) LIMIT 1;\n"
      },
      {
        "question": "Which year has the most registered baby names for all cantons?",
        "query": "SELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n"
      },
      {
        "question": "Which year has the most registered baby names for all cantons?",
        "query": "SELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n"
      },
      {
        "question": "Show me the most popular names of girls in Switzerland in 2016.",
        "query": "SELECT first_name, gender, amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 and gender = 'girl' AND su.country = ''True'' AND su.name = 'Switzerland'\nORDER BY bnff.amount DESC LIMIT 1;\n"
      },
      {
        "question": "How many boys were registered in Canton Valais in year 2011?",
        "query": "SELECT sum(amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2011 AND gender = 'boy' AND su.name ilike '%valais%' AND su.canton = 'TRUE';\n"
      },
      {
        "question": "Please list all registered baby names in Canton Zug in all years. Return me the result in order of alphabets.",
        "query": "SELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Zug%' and su.canton = 'TRUE'\nORDER BY bnff.first_name;\n"
      },
      {
        "question": "Which year has the most registered baby names for all cantons?",
        "query": "SELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n"
      },
      {
        "question": "Which year has the least registered baby names for all cantons?",
        "query": "SELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) LIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.baby_names_favorite_firstname (\n\tuid SERIAL NOT NULL, \n\tgender TEXT, \n\tyear INTEGER, \n\tfirst_name TEXT, \n\tamount NUMERIC, \n\trank NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT baby_names_favorite_firstname_pkey PRIMARY KEY (uid), \n\tCONSTRAINT baby_names_favorite_firstname_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in baby_names_favorite_firstname and 5 examples in each column for high cardinality columns :\nuid : 1690640, 1690652, 1690508, 1690655, 1690653\nyear : 2015, 2000, 2009, 2012, 2019\namount : 4, 0, 2, 6, 10\nrank : 72, 29, 57, 28, 110\n*/\n\n/*\nColumn name, Column discription, Example values\ngender, gender, girl,boy\nfirst_name, First name, Anna,Martin\nrank, rank, 12\namount, amount, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWhich canton has most borned girls registed in 2011?\n### SQL query\nSELECT sum(bnff.amount), su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'girl' and bnff.year = 2011\nGROUP BY su.name\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n\n\n### Question\nHow many baby names were registered?\n### SQL query\nSELECT DISTINCT COUNT(bnff.first_name)\nFROM baby_names_favorite_firstname as bnff;\n\n\n### Question\nShow me all registered gender-universal names in Switzerland.\n### SQL query\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Switzerland%' and su.country = 'TRUE' and gender = 'girl'\nintersect\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Switzerland%' and su.country = 'TRUE' and gender = 'boy';\n\n\n### Question\nShow me all registered gender-universal names in Switzerland.\n### SQL query\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Switzerland%' and su.country = 'TRUE' and gender = 'girl'\nintersect\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Switzerland%' and su.country = 'TRUE' and gender = 'boy';\n\n\n### Question\nShow me all registered names in records.\n### SQL query\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff;\n\n\n### Question\nShow me the most popular names of girls in Switzerland in 2016.\n### SQL query\nSELECT first_name, gender, amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 and gender = 'girl' AND su.country = ''True'' AND su.name = 'Switzerland'\nORDER BY bnff.amount DESC LIMIT 1;\n\n\n### Question\nWhich canton has least borned boys registed in 2011?\n### SQL query\nSELECT sum(bnff.amount), su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2011\nGROUP BY su.name\nORDER BY sum(bnff.amount) LIMIT 1;\n\n\n### Question\nWhich year has the most registered baby names for all cantons?\n### SQL query\nSELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n\n\n### Question\nWhich year has the most registered baby names for all cantons?\n### SQL query\nSELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n\n\n### Question\nShow me the most popular names of girls in Switzerland in 2016.\n### SQL query\nSELECT first_name, gender, amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 and gender = 'girl' AND su.country = ''True'' AND su.name = 'Switzerland'\nORDER BY bnff.amount DESC LIMIT 1;\n\n\n### Question\nHow many boys were registered in Canton Valais in year 2011?\n### SQL query\nSELECT sum(amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2011 AND gender = 'boy' AND su.name ilike '%valais%' AND su.canton = 'TRUE';\n\n\n### Question\nPlease list all registered baby names in Canton Zug in all years. Return me the result in order of alphabets.\n### SQL query\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Zug%' and su.canton = 'TRUE'\nORDER BY bnff.first_name;\n\n\n### Question\nWhich year has the most registered baby names for all cantons?\n### SQL query\nSELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n\n\n### Question\nWhich year has the least registered baby names for all cantons?\n### SQL query\nSELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) LIMIT 1;\n\n\n### Question\nWhich canton has the most borned boys called 'Oscar' in 2016?\n### SQL query\n",
    "process_time": 6.679007388884202,
    "num_tokens": 2119,
    "hardness": "extra",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 29,
    "question": "Show me all top-1 ranked girl names for in each canton in year 2016. Return me the amount and year as well.",
    "query": "SELECT bnff.first_name, su.name, bnff.amount, bnff.year\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'girl' and bnff.year = 2016 and bnff.rank = 1;\n",
    "db_id": "baby_names_favorite_firstname",
    "generated_query": "SELECT bnff.first_name, su.name, bnff.amount, bnff.year\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'girl' and bnff.year = 2016 and bnff.rank = 1;",
    "meta_data": [
      {
        "question": "Which year has the least registered baby names for all cantons?",
        "query": "SELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) LIMIT 1;\n"
      },
      {
        "question": "Which canton has most borned girls registed in 2011?",
        "query": "SELECT sum(bnff.amount), su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'girl' and bnff.year = 2011\nGROUP BY su.name\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n"
      },
      {
        "question": "How many boys were registered in Canton Valais in year 2011?",
        "query": "SELECT sum(amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2011 AND gender = 'boy' AND su.name ilike '%valais%' AND su.canton = 'TRUE';\n"
      },
      {
        "question": "Show me all top-1 ranked boy names for in each canton in year 2014.",
        "query": "SELECT bnff.first_name, su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2014 and bnff.rank = 1;;\n"
      },
      {
        "question": "How many baby names were registered?",
        "query": "SELECT DISTINCT COUNT(bnff.first_name)\nFROM baby_names_favorite_firstname as bnff;\n"
      },
      {
        "question": "All names that have been utilized by over 50 baby girls in canton Vaud. Please order the results by year.",
        "query": "SELECT bnff.first_name, bnff.year, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Vaud%'  and bnff.gender = 'girl' and bnff.amount > 50\nORDER BY bnff.year;\n"
      },
      {
        "question": "Which year has the most registered baby names for all cantons?",
        "query": "SELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n"
      },
      {
        "question": "How many baby names were registered?",
        "query": "SELECT DISTINCT COUNT(bnff.first_name)\nFROM baby_names_favorite_firstname as bnff;\n"
      },
      {
        "question": "How many girls borned in 2014 in Switzeland is named as Lena. Return me the rank as well.",
        "query": "SELECT amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2014\n    AND bnff.gender = 'girl'\n    AND bnff.first_name = 'Lena'\n    AND su.name = 'Switzerland'\n    AND su.country = 'TRUE';\n"
      },
      {
        "question": "Show me all top-1 ranked boy names for in each canton in year 2014.",
        "query": "SELECT bnff.first_name, su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2014 and bnff.rank = 1;;\n"
      },
      {
        "question": "Show me all registered gender-universal names in Switzerland.",
        "query": "SELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Switzerland%' and su.country = 'TRUE' and gender = 'girl'\nintersect\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Switzerland%' and su.country = 'TRUE' and gender = 'boy';\n"
      },
      {
        "question": "How many baby names were registered?",
        "query": "SELECT DISTINCT COUNT(bnff.first_name)\nFROM baby_names_favorite_firstname as bnff;\n"
      },
      {
        "question": "Which year has the most registered baby names for all cantons?",
        "query": "SELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n"
      },
      {
        "question": "Show me the most popular names of girls in Switzerland in 2016.",
        "query": "SELECT first_name, gender, amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 and gender = 'girl' AND su.country = ''True'' AND su.name = 'Switzerland'\nORDER BY bnff.amount DESC LIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.baby_names_favorite_firstname (\n\tuid SERIAL NOT NULL, \n\tgender TEXT, \n\tyear INTEGER, \n\tfirst_name TEXT, \n\tamount NUMERIC, \n\trank NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT baby_names_favorite_firstname_pkey PRIMARY KEY (uid), \n\tCONSTRAINT baby_names_favorite_firstname_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in baby_names_favorite_firstname and 5 examples in each column for high cardinality columns :\nuid : 1690640, 1690652, 1690508, 1690655, 1690653\nyear : 2015, 2000, 2009, 2012, 2019\namount : 4, 0, 2, 6, 10\nrank : 72, 29, 57, 28, 110\n*/\n\n/*\nColumn name, Column discription, Example values\ngender, gender, girl,boy\nfirst_name, First name, Anna,Martin\nrank, rank, 12\namount, amount, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWhich year has the least registered baby names for all cantons?\n### SQL query\nSELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) LIMIT 1;\n\n\n### Question\nWhich canton has most borned girls registed in 2011?\n### SQL query\nSELECT sum(bnff.amount), su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'girl' and bnff.year = 2011\nGROUP BY su.name\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n\n\n### Question\nHow many boys were registered in Canton Valais in year 2011?\n### SQL query\nSELECT sum(amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2011 AND gender = 'boy' AND su.name ilike '%valais%' AND su.canton = 'TRUE';\n\n\n### Question\nShow me all top-1 ranked boy names for in each canton in year 2014.\n### SQL query\nSELECT bnff.first_name, su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2014 and bnff.rank = 1;;\n\n\n### Question\nHow many baby names were registered?\n### SQL query\nSELECT DISTINCT COUNT(bnff.first_name)\nFROM baby_names_favorite_firstname as bnff;\n\n\n### Question\nAll names that have been utilized by over 50 baby girls in canton Vaud. Please order the results by year.\n### SQL query\nSELECT bnff.first_name, bnff.year, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Vaud%'  and bnff.gender = 'girl' and bnff.amount > 50\nORDER BY bnff.year;\n\n\n### Question\nWhich year has the most registered baby names for all cantons?\n### SQL query\nSELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n\n\n### Question\nHow many baby names were registered?\n### SQL query\nSELECT DISTINCT COUNT(bnff.first_name)\nFROM baby_names_favorite_firstname as bnff;\n\n\n### Question\nHow many girls borned in 2014 in Switzeland is named as Lena. Return me the rank as well.\n### SQL query\nSELECT amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2014\n    AND bnff.gender = 'girl'\n    AND bnff.first_name = 'Lena'\n    AND su.name = 'Switzerland'\n    AND su.country = 'TRUE';\n\n\n### Question\nShow me all top-1 ranked boy names for in each canton in year 2014.\n### SQL query\nSELECT bnff.first_name, su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2014 and bnff.rank = 1;;\n\n\n### Question\nShow me all registered gender-universal names in Switzerland.\n### SQL query\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Switzerland%' and su.country = 'TRUE' and gender = 'girl'\nintersect\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Switzerland%' and su.country = 'TRUE' and gender = 'boy';\n\n\n### Question\nHow many baby names were registered?\n### SQL query\nSELECT DISTINCT COUNT(bnff.first_name)\nFROM baby_names_favorite_firstname as bnff;\n\n\n### Question\nWhich year has the most registered baby names for all cantons?\n### SQL query\nSELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n\n\n### Question\nShow me the most popular names of girls in Switzerland in 2016.\n### SQL query\nSELECT first_name, gender, amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 and gender = 'girl' AND su.country = ''True'' AND su.name = 'Switzerland'\nORDER BY bnff.amount DESC LIMIT 1;\n\n\n### Question\nShow me all top-1 ranked girl names for in each canton in year 2016. Return me the amount and year as well.\n### SQL query\n",
    "process_time": 7.613155613886192,
    "num_tokens": 2074,
    "hardness": "extra",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 30,
    "question": "How many girls new borned with name initial L from canton Zurich in 2016?",
    "query": "SELECT sum(amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 AND gender = 'girl' AND su.canton = ''True''\nAND su.name ilike '%zurich%' AND bnff.first_name ilike 'l%';\n",
    "db_id": "baby_names_favorite_firstname",
    "generated_query": "SELECT sum(amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 AND gender = 'girl' AND su.name ilike '%zurich%' AND first_name ilike 'L%';",
    "meta_data": [
      {
        "question": "Show me the most popular names of girls in Switzerland in 2016.",
        "query": "SELECT first_name, gender, amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 and gender = 'girl' AND su.country = ''True'' AND su.name = 'Switzerland'\nORDER BY bnff.amount DESC LIMIT 1;\n"
      },
      {
        "question": "Show me the most popular names of girls in Switzerland in 2016.",
        "query": "SELECT first_name, gender, amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 and gender = 'girl' AND su.country = ''True'' AND su.name = 'Switzerland'\nORDER BY bnff.amount DESC LIMIT 1;\n"
      },
      {
        "question": "Show me the top one ranking boy names for each year after 2012 in canton Zug. Fetch me the result in an ascending order of the year.",
        "query": "SELECT bnff.first_name, bnff.year\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Zug%' and bnff.gender = 'boy' and bnff.year > 2012 and bnff.rank = 1\nORDER BY bnff.year;\n"
      },
      {
        "question": "Please list all registered baby names in Canton Zug in all years. Return me the result in order of alphabets.",
        "query": "SELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Zug%' and su.canton = 'TRUE'\nORDER BY bnff.first_name;\n"
      },
      {
        "question": "All names that have been utilized by over 50 baby girls in canton Vaud. Please order the results by year.",
        "query": "SELECT bnff.first_name, bnff.year, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Vaud%'  and bnff.gender = 'girl' and bnff.amount > 50\nORDER BY bnff.year;\n"
      },
      {
        "question": "Show me all registered names in records.",
        "query": "SELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff;\n"
      },
      {
        "question": "How many boys were registered in Canton Valais in year 2011?",
        "query": "SELECT sum(amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2011 AND gender = 'boy' AND su.name ilike '%valais%' AND su.canton = 'TRUE';\n"
      },
      {
        "question": "All names that have been utilized by over 50 baby girls in canton Vaud. Please order the results by year.",
        "query": "SELECT bnff.first_name, bnff.year, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Vaud%'  and bnff.gender = 'girl' and bnff.amount > 50\nORDER BY bnff.year;\n"
      },
      {
        "question": "Please list all registered baby names in Canton Zug in all years. Return me the result in order of alphabets.",
        "query": "SELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Zug%' and su.canton = 'TRUE'\nORDER BY bnff.first_name;\n"
      },
      {
        "question": "Which canton has least borned boys registed in 2011?",
        "query": "SELECT sum(bnff.amount), su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2011\nGROUP BY su.name\nORDER BY sum(bnff.amount) LIMIT 1;\n"
      },
      {
        "question": "Which year has the least registered baby names for all cantons?",
        "query": "SELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) LIMIT 1;\n"
      },
      {
        "question": "Show me all top-1 ranked boy names for in each canton in year 2014.",
        "query": "SELECT bnff.first_name, su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2014 and bnff.rank = 1;;\n"
      },
      {
        "question": "Show me the most popular names of girls in Switzerland in 2016.",
        "query": "SELECT first_name, gender, amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 and gender = 'girl' AND su.country = ''True'' AND su.name = 'Switzerland'\nORDER BY bnff.amount DESC LIMIT 1;\n"
      },
      {
        "question": "Which canton has most borned girls registed in 2011?",
        "query": "SELECT sum(bnff.amount), su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'girl' and bnff.year = 2011\nGROUP BY su.name\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.baby_names_favorite_firstname (\n\tuid SERIAL NOT NULL, \n\tgender TEXT, \n\tyear INTEGER, \n\tfirst_name TEXT, \n\tamount NUMERIC, \n\trank NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT baby_names_favorite_firstname_pkey PRIMARY KEY (uid), \n\tCONSTRAINT baby_names_favorite_firstname_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in baby_names_favorite_firstname and 5 examples in each column for high cardinality columns :\nuid : 1690640, 1690652, 1690508, 1690655, 1690653\nyear : 2015, 2000, 2009, 2012, 2019\namount : 4, 0, 2, 6, 10\nrank : 72, 29, 57, 28, 110\n*/\n\n/*\nColumn name, Column discription, Example values\ngender, gender, girl,boy\nfirst_name, First name, Anna,Martin\nrank, rank, 12\namount, amount, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nShow me the most popular names of girls in Switzerland in 2016.\n### SQL query\nSELECT first_name, gender, amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 and gender = 'girl' AND su.country = ''True'' AND su.name = 'Switzerland'\nORDER BY bnff.amount DESC LIMIT 1;\n\n\n### Question\nShow me the most popular names of girls in Switzerland in 2016.\n### SQL query\nSELECT first_name, gender, amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 and gender = 'girl' AND su.country = ''True'' AND su.name = 'Switzerland'\nORDER BY bnff.amount DESC LIMIT 1;\n\n\n### Question\nShow me the top one ranking boy names for each year after 2012 in canton Zug. Fetch me the result in an ascending order of the year.\n### SQL query\nSELECT bnff.first_name, bnff.year\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Zug%' and bnff.gender = 'boy' and bnff.year > 2012 and bnff.rank = 1\nORDER BY bnff.year;\n\n\n### Question\nPlease list all registered baby names in Canton Zug in all years. Return me the result in order of alphabets.\n### SQL query\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Zug%' and su.canton = 'TRUE'\nORDER BY bnff.first_name;\n\n\n### Question\nAll names that have been utilized by over 50 baby girls in canton Vaud. Please order the results by year.\n### SQL query\nSELECT bnff.first_name, bnff.year, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Vaud%'  and bnff.gender = 'girl' and bnff.amount > 50\nORDER BY bnff.year;\n\n\n### Question\nShow me all registered names in records.\n### SQL query\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff;\n\n\n### Question\nHow many boys were registered in Canton Valais in year 2011?\n### SQL query\nSELECT sum(amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2011 AND gender = 'boy' AND su.name ilike '%valais%' AND su.canton = 'TRUE';\n\n\n### Question\nAll names that have been utilized by over 50 baby girls in canton Vaud. Please order the results by year.\n### SQL query\nSELECT bnff.first_name, bnff.year, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Vaud%'  and bnff.gender = 'girl' and bnff.amount > 50\nORDER BY bnff.year;\n\n\n### Question\nPlease list all registered baby names in Canton Zug in all years. Return me the result in order of alphabets.\n### SQL query\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Zug%' and su.canton = 'TRUE'\nORDER BY bnff.first_name;\n\n\n### Question\nWhich canton has least borned boys registed in 2011?\n### SQL query\nSELECT sum(bnff.amount), su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2011\nGROUP BY su.name\nORDER BY sum(bnff.amount) LIMIT 1;\n\n\n### Question\nWhich year has the least registered baby names for all cantons?\n### SQL query\nSELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) LIMIT 1;\n\n\n### Question\nShow me all top-1 ranked boy names for in each canton in year 2014.\n### SQL query\nSELECT bnff.first_name, su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2014 and bnff.rank = 1;;\n\n\n### Question\nShow me the most popular names of girls in Switzerland in 2016.\n### SQL query\nSELECT first_name, gender, amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 and gender = 'girl' AND su.country = ''True'' AND su.name = 'Switzerland'\nORDER BY bnff.amount DESC LIMIT 1;\n\n\n### Question\nWhich canton has most borned girls registed in 2011?\n### SQL query\nSELECT sum(bnff.amount), su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'girl' and bnff.year = 2011\nGROUP BY su.name\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n\n\n### Question\nHow many girls new borned with name initial L from canton Zurich in 2016?\n### SQL query\n",
    "process_time": 6.457790859974921,
    "num_tokens": 2199,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 31,
    "question": "Show me the top one ranking girl names from year 2010 in Switzerland.",
    "query": "SELECT bnff.first_name, bnff.year\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.country = 'TRUE' and su.name ilike '%Switzerland%' and bnff.gender = 'girl'\nand bnff.year >= 2010 and bnff.rank = 1\nORDER BY bnff.year;\n",
    "db_id": "baby_names_favorite_firstname",
    "generated_query": "SELECT bnff.first_name, bnff.year\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name = 'Switzerland' and bnff.gender = 'girl' and bnff.year >= 2010 and bnff.rank = 1\nORDER BY bnff.year;",
    "meta_data": [
      {
        "question": "Please list all registered baby names in Canton Zug in all years. Return me the result in order of alphabets.",
        "query": "SELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Zug%' and su.canton = 'TRUE'\nORDER BY bnff.first_name;\n"
      },
      {
        "question": "How many girls borned in 2014 in Switzeland is named as Lena. Return me the rank as well.",
        "query": "SELECT amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2014\n    AND bnff.gender = 'girl'\n    AND bnff.first_name = 'Lena'\n    AND su.name = 'Switzerland'\n    AND su.country = 'TRUE';\n"
      },
      {
        "question": "Show me all registered names in records.",
        "query": "SELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff;\n"
      },
      {
        "question": "All names that have been utilized by over 50 baby girls in canton Vaud. Please order the results by year.",
        "query": "SELECT bnff.first_name, bnff.year, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Vaud%'  and bnff.gender = 'girl' and bnff.amount > 50\nORDER BY bnff.year;\n"
      },
      {
        "question": "Please list all registered baby names in Canton Zug in all years. Return me the result in order of alphabets.",
        "query": "SELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Zug%' and su.canton = 'TRUE'\nORDER BY bnff.first_name;\n"
      },
      {
        "question": "Show me all registered names in records.",
        "query": "SELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff;\n"
      },
      {
        "question": "Show me the top one ranking boy names for each year after 2012 in canton Zug. Fetch me the result in an ascending order of the year.",
        "query": "SELECT bnff.first_name, bnff.year\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Zug%' and bnff.gender = 'boy' and bnff.year > 2012 and bnff.rank = 1\nORDER BY bnff.year;\n"
      },
      {
        "question": "Which canton has most borned girls registed in 2011?",
        "query": "SELECT sum(bnff.amount), su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'girl' and bnff.year = 2011\nGROUP BY su.name\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n"
      },
      {
        "question": "How many girls borned in 2014 in Switzeland is named as Lena. Return me the rank as well.",
        "query": "SELECT amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2014\n    AND bnff.gender = 'girl'\n    AND bnff.first_name = 'Lena'\n    AND su.name = 'Switzerland'\n    AND su.country = 'TRUE';\n"
      },
      {
        "question": "Show me the most popular names of girls in Switzerland in 2016.",
        "query": "SELECT first_name, gender, amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 and gender = 'girl' AND su.country = ''True'' AND su.name = 'Switzerland'\nORDER BY bnff.amount DESC LIMIT 1;\n"
      },
      {
        "question": "Which year has the least registered baby names for all cantons?",
        "query": "SELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) LIMIT 1;\n"
      },
      {
        "question": "Which year has the least registered baby names for all cantons?",
        "query": "SELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) LIMIT 1;\n"
      },
      {
        "question": "Show me the top one ranking boy names for each year after 2012 in canton Zug. Fetch me the result in an ascending order of the year.",
        "query": "SELECT bnff.first_name, bnff.year\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Zug%' and bnff.gender = 'boy' and bnff.year > 2012 and bnff.rank = 1\nORDER BY bnff.year;\n"
      },
      {
        "question": "Show me all top-1 ranked boy names for in each canton in year 2014.",
        "query": "SELECT bnff.first_name, su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2014 and bnff.rank = 1;;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.baby_names_favorite_firstname (\n\tuid SERIAL NOT NULL, \n\tgender TEXT, \n\tyear INTEGER, \n\tfirst_name TEXT, \n\tamount NUMERIC, \n\trank NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT baby_names_favorite_firstname_pkey PRIMARY KEY (uid), \n\tCONSTRAINT baby_names_favorite_firstname_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in baby_names_favorite_firstname and 5 examples in each column for high cardinality columns :\nuid : 1690640, 1690652, 1690508, 1690655, 1690653\nyear : 2015, 2000, 2009, 2012, 2019\namount : 4, 0, 2, 6, 10\nrank : 72, 29, 57, 28, 110\n*/\n\n/*\nColumn name, Column discription, Example values\ngender, gender, girl,boy\nfirst_name, First name, Anna,Martin\nrank, rank, 12\namount, amount, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nPlease list all registered baby names in Canton Zug in all years. Return me the result in order of alphabets.\n### SQL query\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Zug%' and su.canton = 'TRUE'\nORDER BY bnff.first_name;\n\n\n### Question\nHow many girls borned in 2014 in Switzeland is named as Lena. Return me the rank as well.\n### SQL query\nSELECT amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2014\n    AND bnff.gender = 'girl'\n    AND bnff.first_name = 'Lena'\n    AND su.name = 'Switzerland'\n    AND su.country = 'TRUE';\n\n\n### Question\nShow me all registered names in records.\n### SQL query\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff;\n\n\n### Question\nAll names that have been utilized by over 50 baby girls in canton Vaud. Please order the results by year.\n### SQL query\nSELECT bnff.first_name, bnff.year, bnff.amount\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Vaud%'  and bnff.gender = 'girl' and bnff.amount > 50\nORDER BY bnff.year;\n\n\n### Question\nPlease list all registered baby names in Canton Zug in all years. Return me the result in order of alphabets.\n### SQL query\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.name ilike '%Zug%' and su.canton = 'TRUE'\nORDER BY bnff.first_name;\n\n\n### Question\nShow me all registered names in records.\n### SQL query\nSELECT DISTINCT bnff.first_name\nFROM baby_names_favorite_firstname as bnff;\n\n\n### Question\nShow me the top one ranking boy names for each year after 2012 in canton Zug. Fetch me the result in an ascending order of the year.\n### SQL query\nSELECT bnff.first_name, bnff.year\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Zug%' and bnff.gender = 'boy' and bnff.year > 2012 and bnff.rank = 1\nORDER BY bnff.year;\n\n\n### Question\nWhich canton has most borned girls registed in 2011?\n### SQL query\nSELECT sum(bnff.amount), su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'girl' and bnff.year = 2011\nGROUP BY su.name\nORDER BY sum(bnff.amount) DESC LIMIT 1;\n\n\n### Question\nHow many girls borned in 2014 in Switzeland is named as Lena. Return me the rank as well.\n### SQL query\nSELECT amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2014\n    AND bnff.gender = 'girl'\n    AND bnff.first_name = 'Lena'\n    AND su.name = 'Switzerland'\n    AND su.country = 'TRUE';\n\n\n### Question\nShow me the most popular names of girls in Switzerland in 2016.\n### SQL query\nSELECT first_name, gender, amount, rank\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2016 and gender = 'girl' AND su.country = ''True'' AND su.name = 'Switzerland'\nORDER BY bnff.amount DESC LIMIT 1;\n\n\n### Question\nWhich year has the least registered baby names for all cantons?\n### SQL query\nSELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) LIMIT 1;\n\n\n### Question\nWhich year has the least registered baby names for all cantons?\n### SQL query\nSELECT bnff.year, sum(bnff.amount)\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE'\ngroup by bnff.year\nORDER BY sum(bnff.amount) LIMIT 1;\n\n\n### Question\nShow me the top one ranking boy names for each year after 2012 in canton Zug. Fetch me the result in an ascending order of the year.\n### SQL query\nSELECT bnff.first_name, bnff.year\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and su.name ilike '%Zug%' and bnff.gender = 'boy' and bnff.year > 2012 and bnff.rank = 1\nORDER BY bnff.year;\n\n\n### Question\nShow me all top-1 ranked boy names for in each canton in year 2014.\n### SQL query\nSELECT bnff.first_name, su.name\nFROM baby_names_favorite_firstname as bnff\nJOIN spatial_unit as su ON bnff.spatialunit_uid = su.spatialunit_uid\nWHERE su.canton = 'TRUE' and bnff.gender = 'boy' and bnff.year = 2014 and bnff.rank = 1;;\n\n\n### Question\nShow me the top one ranking girl names from year 2010 in Switzerland.\n### SQL query\n",
    "process_time": 5.6128358780406415,
    "num_tokens": 2163,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 32,
    "question": "How many divorces were there in canton zurich in 2020?",
    "query": "SELECT S.name, T.year, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Zurich%'\nAND T.year = 2020\nAND S.canton = 'True'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nGROUP BY S.name, T.year;\n",
    "db_id": "divorces_duration_of_marriage_age_classes",
    "generated_query": "SELECT S.name, T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2020\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.name = 'Zurich'\nGROUP BY S.name, T.year;",
    "meta_data": [
      {
        "question": "Which Kanton had the most divorces after only a very long marriage in 2020?",
        "query": "SELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2020\nAND T.duration_of_marriage = '20 years or more'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "How many couples were divorced in Switzerland in the year 2000?",
        "query": "SELECT T.year, S.name, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = s.spatialunit_uid\nWHERE S.country\nAND T.year = '2000'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nGROUP BY S.name, T.year;\n"
      },
      {
        "question": "Which Kanton had the most divorces in 2015?",
        "query": "SELECT S.name, T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2015\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.year\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "What was the prominent age for women that divorced in Switzerland in 2000?",
        "query": "SELECT T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife != 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_wife\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "Did any person divorce at an age of 90 or above in Switzerland since 2000?",
        "query": "SELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '90 years or older'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '90 years or older'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;\n"
      },
      {
        "question": "Did any men divorce at an age of 90 or above in Switzerland in 2000?",
        "query": "SELECT S.name, T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = '90 years or older'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.country\nGROUP BY S.name, T.age_class_husband\nORDER BY total_divorces ASC\nLIMIT 1;\n"
      },
      {
        "question": "Did any person divorce at an age of 90 or above in Switzerland since 2000?",
        "query": "SELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '90 years or older'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '90 years or older'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;\n"
      },
      {
        "question": "Did any person divorce at an age of 90 or above in Switzerland since 2000?",
        "query": "SELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '90 years or older'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '90 years or older'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;\n"
      },
      {
        "question": "How many couples were divorced in Switzerland in the year 2000?",
        "query": "SELECT T.year, S.name, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = s.spatialunit_uid\nWHERE S.country\nAND T.year = '2000'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nGROUP BY S.name, T.year;\n"
      },
      {
        "question": "What was the prominent age for men that divorced in Switzerland in 2000?",
        "query": "SELECT T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband != 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_husband\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "Which Kanton had the most divorces in 2015?",
        "query": "SELECT S.name, T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2015\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.year\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "Which Canton had the least divorces in 2002?",
        "query": "SELECT T.year, T.duration_of_marriage, T.amount AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 1990\nAND T.duration_of_marriage != 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year, T.duration_of_marriage, T.amount\nORDER BY T.year, T.duration_of_marriage;\n"
      },
      {
        "question": "Did any person divorce at an age of 90 or above in Switzerland since 2000?",
        "query": "SELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '90 years or older'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '90 years or older'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;\n"
      },
      {
        "question": "Did 2020 have more divorces than 2019?",
        "query": "SELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE (T.year = 2019 OR T.year = 2020)\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year\nORDER BY T.year DESC;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_age_classes (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tage_class_husband VARCHAR(50), \n\tage_class_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_spatial_unit_spatialu FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_age_classes and 5 examples in each column for high cardinality columns :\nuid : 857227, 857324, 857392, 857371, 857366\nspatialunit_uid : 0_CH, 25_A.ADM1, 22_A.ADM1, 2_A.ADM1, 23_A.ADM1\nyear : 2015, 1988, 1989, 2000, 2012\namount : 4, 27, 18, 59, 1050\n*/\n\n/*\nColumn name, Column discription, Example values\nage_class_husband, age class of the husband, Age class of husband - total,Less than 20 years,80-89 years\nage_class_wife, age class of the wife, Age class of wife - total,Less than 20 years,80-89 years\nduration_of_marriage, duration class of marriage, Duration of marriage - total,5-9 years,20 years or more\namount, Count of divorces, 120\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWhich Kanton had the most divorces after only a very long marriage in 2020?\n### SQL query\nSELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2020\nAND T.duration_of_marriage = '20 years or more'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nHow many couples were divorced in Switzerland in the year 2000?\n### SQL query\nSELECT T.year, S.name, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = s.spatialunit_uid\nWHERE S.country\nAND T.year = '2000'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nGROUP BY S.name, T.year;\n\n\n### Question\nWhich Kanton had the most divorces in 2015?\n### SQL query\nSELECT S.name, T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2015\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.year\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nWhat was the prominent age for women that divorced in Switzerland in 2000?\n### SQL query\nSELECT T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife != 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_wife\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nDid any person divorce at an age of 90 or above in Switzerland since 2000?\n### SQL query\nSELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '90 years or older'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '90 years or older'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;\n\n\n### Question\nDid any men divorce at an age of 90 or above in Switzerland in 2000?\n### SQL query\nSELECT S.name, T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = '90 years or older'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.country\nGROUP BY S.name, T.age_class_husband\nORDER BY total_divorces ASC\nLIMIT 1;\n\n\n### Question\nDid any person divorce at an age of 90 or above in Switzerland since 2000?\n### SQL query\nSELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '90 years or older'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '90 years or older'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;\n\n\n### Question\nDid any person divorce at an age of 90 or above in Switzerland since 2000?\n### SQL query\nSELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '90 years or older'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '90 years or older'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;\n\n\n### Question\nHow many couples were divorced in Switzerland in the year 2000?\n### SQL query\nSELECT T.year, S.name, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = s.spatialunit_uid\nWHERE S.country\nAND T.year = '2000'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nGROUP BY S.name, T.year;\n\n\n### Question\nWhat was the prominent age for men that divorced in Switzerland in 2000?\n### SQL query\nSELECT T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband != 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_husband\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nWhich Kanton had the most divorces in 2015?\n### SQL query\nSELECT S.name, T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2015\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.year\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nWhich Canton had the least divorces in 2002?\n### SQL query\nSELECT T.year, T.duration_of_marriage, T.amount AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 1990\nAND T.duration_of_marriage != 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year, T.duration_of_marriage, T.amount\nORDER BY T.year, T.duration_of_marriage;\n\n\n### Question\nDid any person divorce at an age of 90 or above in Switzerland since 2000?\n### SQL query\nSELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '90 years or older'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '90 years or older'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;\n\n\n### Question\nDid 2020 have more divorces than 2019?\n### SQL query\nSELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE (T.year = 2019 OR T.year = 2020)\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year\nORDER BY T.year DESC;\n\n\n### Question\nHow many divorces were there in canton zurich in 2020?\n### SQL query\n",
    "process_time": 12.41332083218731,
    "num_tokens": 3218,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 33,
    "question": "Did any people divorce at an age of 70 or above in Switzerland in 2000?",
    "query": "SELECT S.name, T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND (T.age_class_husband = '90 years or older' OR T.age_class_husband = '70-79 years')\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.country\nGROUP BY S.name, T.age_class_husband;\n",
    "db_id": "divorces_duration_of_marriage_age_classes",
    "generated_query": "SELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '70-79 years'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '70-79 years'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;",
    "meta_data": [
      {
        "question": "Which Kanton had the most divorces after only a very long marriage in 2020?",
        "query": "SELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2020\nAND T.duration_of_marriage = '20 years or more'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "How many couples were divorced in Switzerland in the year 2000?",
        "query": "SELECT T.year, S.name, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = s.spatialunit_uid\nWHERE S.country\nAND T.year = '2000'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nGROUP BY S.name, T.year;\n"
      },
      {
        "question": "In Canton Uri how many marriages where divorced in 2003 after more than 10 years?",
        "query": "SELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2003\nAND (T.duration_of_marriage = '10-14 years'\n         OR T.duration_of_marriage = '15-19 years'\n         OR T.duration_of_marriage = '20 years or more')\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton AND S.name ilike '% Uri%'\nGROUP BY S.name, T.duration_of_marriage\nORDER BY T.duration_of_marriage DESC;"
      },
      {
        "question": "Did any person divorce at an age of 90 or above in Switzerland since 2000?",
        "query": "SELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '90 years or older'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '90 years or older'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;\n"
      },
      {
        "question": "In Canton Uri how many marriages where divorced in 2003 after more than 10 years?",
        "query": "SELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2003\nAND (T.duration_of_marriage = '10-14 years'\n         OR T.duration_of_marriage = '15-19 years'\n         OR T.duration_of_marriage = '20 years or more')\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton AND S.name ilike '% Uri%'\nGROUP BY S.name, T.duration_of_marriage\nORDER BY T.duration_of_marriage DESC;"
      },
      {
        "question": "Did any men divorce at an age of 90 or above in Switzerland in 2000?",
        "query": "SELECT S.name, T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = '90 years or older'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.country\nGROUP BY S.name, T.age_class_husband\nORDER BY total_divorces ASC\nLIMIT 1;\n"
      },
      {
        "question": "Did any person divorce at an age of 90 or above in Switzerland since 2000?",
        "query": "SELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '90 years or older'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '90 years or older'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;\n"
      },
      {
        "question": "How many women divorced at age between 20 and 29 in canton zurich in 2020?",
        "query": "SELECT S.name, T.year, T.age_class_wife, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Zurich%'\nAND T.year = 2020\nAND S.canton = 'True'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = '20-29 years'\nGROUP BY S.name, T.year, T.age_class_wife;\n"
      },
      {
        "question": "Which Canton had the least divorces in 2002?",
        "query": "SELECT T.year, T.duration_of_marriage, T.amount AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 1990\nAND T.duration_of_marriage != 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year, T.duration_of_marriage, T.amount\nORDER BY T.year, T.duration_of_marriage;\n"
      },
      {
        "question": "What was the prominent age for women that divorced in Switzerland in 2000?",
        "query": "SELECT T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife != 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_wife\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "In Canton Uri how many marriages where divorced in 2003 after more than 10 years?",
        "query": "SELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2003\nAND (T.duration_of_marriage = '10-14 years'\n         OR T.duration_of_marriage = '15-19 years'\n         OR T.duration_of_marriage = '20 years or more')\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton AND S.name ilike '% Uri%'\nGROUP BY S.name, T.duration_of_marriage\nORDER BY T.duration_of_marriage DESC;"
      },
      {
        "question": "Did any men divorce at an age of 90 or above in Switzerland in 2000?",
        "query": "SELECT S.name, T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = '90 years or older'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.country\nGROUP BY S.name, T.age_class_husband\nORDER BY total_divorces ASC\nLIMIT 1;\n"
      },
      {
        "question": "Did any person divorce at an age of 90 or above in Switzerland since 2000?",
        "query": "SELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '90 years or older'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '90 years or older'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;\n"
      },
      {
        "question": "Did any men divorce at an age of 90 or above in Switzerland in 2000?",
        "query": "SELECT S.name, T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = '90 years or older'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.country\nGROUP BY S.name, T.age_class_husband\nORDER BY total_divorces ASC\nLIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_age_classes (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tage_class_husband VARCHAR(50), \n\tage_class_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_spatial_unit_spatialu FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_age_classes and 5 examples in each column for high cardinality columns :\nuid : 857227, 857324, 857392, 857371, 857366\nspatialunit_uid : 0_CH, 25_A.ADM1, 22_A.ADM1, 2_A.ADM1, 23_A.ADM1\nyear : 2015, 1988, 1989, 2000, 2012\namount : 4, 27, 18, 59, 1050\n*/\n\n/*\nColumn name, Column discription, Example values\nage_class_husband, age class of the husband, Age class of husband - total,Less than 20 years,80-89 years\nage_class_wife, age class of the wife, Age class of wife - total,Less than 20 years,80-89 years\nduration_of_marriage, duration class of marriage, Duration of marriage - total,5-9 years,20 years or more\namount, Count of divorces, 120\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWhich Kanton had the most divorces after only a very long marriage in 2020?\n### SQL query\nSELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2020\nAND T.duration_of_marriage = '20 years or more'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nHow many couples were divorced in Switzerland in the year 2000?\n### SQL query\nSELECT T.year, S.name, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = s.spatialunit_uid\nWHERE S.country\nAND T.year = '2000'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nGROUP BY S.name, T.year;\n\n\n### Question\nIn Canton Uri how many marriages where divorced in 2003 after more than 10 years?\n### SQL query\nSELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2003\nAND (T.duration_of_marriage = '10-14 years'\n         OR T.duration_of_marriage = '15-19 years'\n         OR T.duration_of_marriage = '20 years or more')\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton AND S.name ilike '% Uri%'\nGROUP BY S.name, T.duration_of_marriage\nORDER BY T.duration_of_marriage DESC;\n\n### Question\nDid any person divorce at an age of 90 or above in Switzerland since 2000?\n### SQL query\nSELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '90 years or older'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '90 years or older'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;\n\n\n### Question\nIn Canton Uri how many marriages where divorced in 2003 after more than 10 years?\n### SQL query\nSELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2003\nAND (T.duration_of_marriage = '10-14 years'\n         OR T.duration_of_marriage = '15-19 years'\n         OR T.duration_of_marriage = '20 years or more')\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton AND S.name ilike '% Uri%'\nGROUP BY S.name, T.duration_of_marriage\nORDER BY T.duration_of_marriage DESC;\n\n### Question\nDid any men divorce at an age of 90 or above in Switzerland in 2000?\n### SQL query\nSELECT S.name, T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = '90 years or older'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.country\nGROUP BY S.name, T.age_class_husband\nORDER BY total_divorces ASC\nLIMIT 1;\n\n\n### Question\nDid any person divorce at an age of 90 or above in Switzerland since 2000?\n### SQL query\nSELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '90 years or older'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '90 years or older'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;\n\n\n### Question\nHow many women divorced at age between 20 and 29 in canton zurich in 2020?\n### SQL query\nSELECT S.name, T.year, T.age_class_wife, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Zurich%'\nAND T.year = 2020\nAND S.canton = 'True'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = '20-29 years'\nGROUP BY S.name, T.year, T.age_class_wife;\n\n\n### Question\nWhich Canton had the least divorces in 2002?\n### SQL query\nSELECT T.year, T.duration_of_marriage, T.amount AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 1990\nAND T.duration_of_marriage != 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year, T.duration_of_marriage, T.amount\nORDER BY T.year, T.duration_of_marriage;\n\n\n### Question\nWhat was the prominent age for women that divorced in Switzerland in 2000?\n### SQL query\nSELECT T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife != 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_wife\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nIn Canton Uri how many marriages where divorced in 2003 after more than 10 years?\n### SQL query\nSELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2003\nAND (T.duration_of_marriage = '10-14 years'\n         OR T.duration_of_marriage = '15-19 years'\n         OR T.duration_of_marriage = '20 years or more')\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton AND S.name ilike '% Uri%'\nGROUP BY S.name, T.duration_of_marriage\nORDER BY T.duration_of_marriage DESC;\n\n### Question\nDid any men divorce at an age of 90 or above in Switzerland in 2000?\n### SQL query\nSELECT S.name, T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = '90 years or older'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.country\nGROUP BY S.name, T.age_class_husband\nORDER BY total_divorces ASC\nLIMIT 1;\n\n\n### Question\nDid any person divorce at an age of 90 or above in Switzerland since 2000?\n### SQL query\nSELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '90 years or older'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '90 years or older'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;\n\n\n### Question\nDid any men divorce at an age of 90 or above in Switzerland in 2000?\n### SQL query\nSELECT S.name, T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = '90 years or older'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.country\nGROUP BY S.name, T.age_class_husband\nORDER BY total_divorces ASC\nLIMIT 1;\n\n\n### Question\nDid any people divorce at an age of 70 or above in Switzerland in 2000?\n### SQL query\n",
    "process_time": 11.213575051166117,
    "num_tokens": 3356,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 34,
    "question": "Which year between 1990 and 2000 had the least divorces in Stadt Basel?",
    "query": "SELECT S.name, T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 1990\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.country\nGROUP BY S.name, T.year\nORDER BY T.year;\n",
    "db_id": "divorces_duration_of_marriage_age_classes",
    "generated_query": "SELECT S.name, T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year BETWEEN 1990 AND 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.name ILIKE '%Basel%'\nGROUP BY S.name, T.year\nORDER BY total_divorces ASC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "What was the prominent age for men that divorced in Switzerland in 2000?",
        "query": "SELECT T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband != 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_husband\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "Did any men divorce at an age of 90 or above in Switzerland in 2000?",
        "query": "SELECT S.name, T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = '90 years or older'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.country\nGROUP BY S.name, T.age_class_husband\nORDER BY total_divorces ASC\nLIMIT 1;\n"
      },
      {
        "question": "Which Kanton had the most divorces in 2015?",
        "query": "SELECT S.name, T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2015\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.year\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "Did any person divorce at an age of 90 or above in Switzerland since 2000?",
        "query": "SELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '90 years or older'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '90 years or older'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;\n"
      },
      {
        "question": "Did any person divorce at an age of 90 or above in Switzerland since 2000?",
        "query": "SELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '90 years or older'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '90 years or older'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;\n"
      },
      {
        "question": "What was the prominent age for men that divorced in Switzerland in 2000?",
        "query": "SELECT T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband != 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_husband\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "Did any men divorce at an age of 90 or above in Switzerland in 2000?",
        "query": "SELECT S.name, T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = '90 years or older'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.country\nGROUP BY S.name, T.age_class_husband\nORDER BY total_divorces ASC\nLIMIT 1;\n"
      },
      {
        "question": "How many divorces happened in Basel in 2015 and after how many years of marriage?",
        "query": "SELECT S.name, S.spatialunit_ontology, T.year, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM divorces_duration_of_marriage_age_classes AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2015\nAND T.duration_of_marriage != 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.name ilike '%basel%'\nGROUP BY T.year, T.duration_of_marriage, S.spatialunit_ontology, S.name;\n"
      },
      {
        "question": "What was the prominent age for women that divorced in Switzerland in 2000?",
        "query": "SELECT T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife != 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_wife\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "Did any men divorce at an age of 90 or above in Switzerland in 2000?",
        "query": "SELECT S.name, T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = '90 years or older'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.country\nGROUP BY S.name, T.age_class_husband\nORDER BY total_divorces ASC\nLIMIT 1;\n"
      },
      {
        "question": "What was the prominent age for men that divorced in Switzerland in 2000?",
        "query": "SELECT T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband != 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_husband\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "How many women divorced at age between 20 and 29 in canton zurich in 2020?",
        "query": "SELECT S.name, T.year, T.age_class_wife, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Zurich%'\nAND T.year = 2020\nAND S.canton = 'True'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = '20-29 years'\nGROUP BY S.name, T.year, T.age_class_wife;\n"
      },
      {
        "question": "How many couples were divorced in Switzerland in the year 2000?",
        "query": "SELECT T.year, S.name, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = s.spatialunit_uid\nWHERE S.country\nAND T.year = '2000'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nGROUP BY S.name, T.year;\n"
      },
      {
        "question": "What was the prominent age for women that divorced in Switzerland in 2000?",
        "query": "SELECT T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife != 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_wife\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_age_classes (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tage_class_husband VARCHAR(50), \n\tage_class_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_spatial_unit_spatialu FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_age_classes and 5 examples in each column for high cardinality columns :\nuid : 857227, 857324, 857392, 857371, 857366\nspatialunit_uid : 0_CH, 25_A.ADM1, 22_A.ADM1, 2_A.ADM1, 23_A.ADM1\nyear : 2015, 1988, 1989, 2000, 2012\namount : 4, 27, 18, 59, 1050\n*/\n\n/*\nColumn name, Column discription, Example values\nage_class_husband, age class of the husband, Age class of husband - total,Less than 20 years,80-89 years\nage_class_wife, age class of the wife, Age class of wife - total,Less than 20 years,80-89 years\nduration_of_marriage, duration class of marriage, Duration of marriage - total,5-9 years,20 years or more\namount, Count of divorces, 120\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWhat was the prominent age for men that divorced in Switzerland in 2000?\n### SQL query\nSELECT T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband != 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_husband\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nDid any men divorce at an age of 90 or above in Switzerland in 2000?\n### SQL query\nSELECT S.name, T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = '90 years or older'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.country\nGROUP BY S.name, T.age_class_husband\nORDER BY total_divorces ASC\nLIMIT 1;\n\n\n### Question\nWhich Kanton had the most divorces in 2015?\n### SQL query\nSELECT S.name, T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2015\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.year\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nDid any person divorce at an age of 90 or above in Switzerland since 2000?\n### SQL query\nSELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '90 years or older'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '90 years or older'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;\n\n\n### Question\nDid any person divorce at an age of 90 or above in Switzerland since 2000?\n### SQL query\nSELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '90 years or older'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '90 years or older'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;\n\n\n### Question\nWhat was the prominent age for men that divorced in Switzerland in 2000?\n### SQL query\nSELECT T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband != 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_husband\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nDid any men divorce at an age of 90 or above in Switzerland in 2000?\n### SQL query\nSELECT S.name, T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = '90 years or older'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.country\nGROUP BY S.name, T.age_class_husband\nORDER BY total_divorces ASC\nLIMIT 1;\n\n\n### Question\nHow many divorces happened in Basel in 2015 and after how many years of marriage?\n### SQL query\nSELECT S.name, S.spatialunit_ontology, T.year, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM divorces_duration_of_marriage_age_classes AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2015\nAND T.duration_of_marriage != 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.name ilike '%basel%'\nGROUP BY T.year, T.duration_of_marriage, S.spatialunit_ontology, S.name;\n\n\n### Question\nWhat was the prominent age for women that divorced in Switzerland in 2000?\n### SQL query\nSELECT T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife != 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_wife\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nDid any men divorce at an age of 90 or above in Switzerland in 2000?\n### SQL query\nSELECT S.name, T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = '90 years or older'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.country\nGROUP BY S.name, T.age_class_husband\nORDER BY total_divorces ASC\nLIMIT 1;\n\n\n### Question\nWhat was the prominent age for men that divorced in Switzerland in 2000?\n### SQL query\nSELECT T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband != 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_husband\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nHow many women divorced at age between 20 and 29 in canton zurich in 2020?\n### SQL query\nSELECT S.name, T.year, T.age_class_wife, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Zurich%'\nAND T.year = 2020\nAND S.canton = 'True'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = '20-29 years'\nGROUP BY S.name, T.year, T.age_class_wife;\n\n\n### Question\nHow many couples were divorced in Switzerland in the year 2000?\n### SQL query\nSELECT T.year, S.name, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = s.spatialunit_uid\nWHERE S.country\nAND T.year = '2000'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nGROUP BY S.name, T.year;\n\n\n### Question\nWhat was the prominent age for women that divorced in Switzerland in 2000?\n### SQL query\nSELECT T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife != 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_wife\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nWhich year between 1990 and 2000 had the least divorces in Stadt Basel?\n### SQL query\n",
    "process_time": 13.42223494593054,
    "num_tokens": 3187,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 35,
    "question": "How many men divorced at an age between 60 and 69 in canton zurich in 2020?",
    "query": "SELECT S.name, T.year, T.age_class_husband, sum(T.amount) AS total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Zurich%'\nAND T.year = 2020\nAND S.canton = 'True'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = '60-69 years'\nAND T.age_class_wife = 'Age class of wife - total'\nGROUP BY S.name, T.year, T.age_class_husband;\n",
    "db_id": "divorces_duration_of_marriage_age_classes",
    "generated_query": "SELECT S.name, T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2020\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = '60-69 years'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.name = 'Zurich'\nGROUP BY S.name, T.age_class_husband\nORDER BY total_divorces DESC;",
    "meta_data": [
      {
        "question": "Did any person divorce at an age of 90 or above in Switzerland since 2000?",
        "query": "SELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '90 years or older'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '90 years or older'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;\n"
      },
      {
        "question": "In Canton Uri how many marriages where divorced in 2003 after more than 10 years?",
        "query": "SELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2003\nAND (T.duration_of_marriage = '10-14 years'\n         OR T.duration_of_marriage = '15-19 years'\n         OR T.duration_of_marriage = '20 years or more')\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton AND S.name ilike '% Uri%'\nGROUP BY S.name, T.duration_of_marriage\nORDER BY T.duration_of_marriage DESC;"
      },
      {
        "question": "What was the prominent age for men that divorced in Switzerland in 2000?",
        "query": "SELECT T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband != 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_husband\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "Which Kanton had the most divorces after only a very long marriage in 2020?",
        "query": "SELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2020\nAND T.duration_of_marriage = '20 years or more'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "Did 2020 have more divorces than 2019?",
        "query": "SELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE (T.year = 2019 OR T.year = 2020)\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year\nORDER BY T.year DESC;\n"
      },
      {
        "question": "In Canton Uri how many marriages where divorced in 2003 after more than 10 years?",
        "query": "SELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2003\nAND (T.duration_of_marriage = '10-14 years'\n         OR T.duration_of_marriage = '15-19 years'\n         OR T.duration_of_marriage = '20 years or more')\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton AND S.name ilike '% Uri%'\nGROUP BY S.name, T.duration_of_marriage\nORDER BY T.duration_of_marriage DESC;"
      },
      {
        "question": "Which Kanton had the most divorces after only a short marriage in 2020?",
        "query": "SELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2020\nAND T.duration_of_marriage = '0-4 years'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "In Canton Uri how many marriages where divorced in 2003 after more than 10 years?",
        "query": "SELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2003\nAND (T.duration_of_marriage = '10-14 years'\n         OR T.duration_of_marriage = '15-19 years'\n         OR T.duration_of_marriage = '20 years or more')\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton AND S.name ilike '% Uri%'\nGROUP BY S.name, T.duration_of_marriage\nORDER BY T.duration_of_marriage DESC;"
      },
      {
        "question": "Which Kanton had the most divorces in 2015?",
        "query": "SELECT S.name, T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2015\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.year\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "In Canton Uri how many marriages where divorced in 2003 after more than 10 years?",
        "query": "SELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2003\nAND (T.duration_of_marriage = '10-14 years'\n         OR T.duration_of_marriage = '15-19 years'\n         OR T.duration_of_marriage = '20 years or more')\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton AND S.name ilike '% Uri%'\nGROUP BY S.name, T.duration_of_marriage\nORDER BY T.duration_of_marriage DESC;"
      },
      {
        "question": "How many couples were divorced in Switzerland in the year 2000?",
        "query": "SELECT T.year, S.name, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = s.spatialunit_uid\nWHERE S.country\nAND T.year = '2000'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nGROUP BY S.name, T.year;\n"
      },
      {
        "question": "In Canton Uri how many marriages where divorced in 2003 after more than 10 years?",
        "query": "SELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2003\nAND (T.duration_of_marriage = '10-14 years'\n         OR T.duration_of_marriage = '15-19 years'\n         OR T.duration_of_marriage = '20 years or more')\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton AND S.name ilike '% Uri%'\nGROUP BY S.name, T.duration_of_marriage\nORDER BY T.duration_of_marriage DESC;"
      },
      {
        "question": "What was the prominent age for men that divorced in Switzerland in 2000?",
        "query": "SELECT T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband != 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_husband\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "Which Kanton had the most divorces in 2015?",
        "query": "SELECT S.name, T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2015\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.year\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_age_classes (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tage_class_husband VARCHAR(50), \n\tage_class_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_spatial_unit_spatialu FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_age_classes and 5 examples in each column for high cardinality columns :\nuid : 857227, 857324, 857392, 857371, 857366\nspatialunit_uid : 0_CH, 25_A.ADM1, 22_A.ADM1, 2_A.ADM1, 23_A.ADM1\nyear : 2015, 1988, 1989, 2000, 2012\namount : 4, 27, 18, 59, 1050\n*/\n\n/*\nColumn name, Column discription, Example values\nage_class_husband, age class of the husband, Age class of husband - total,Less than 20 years,80-89 years\nage_class_wife, age class of the wife, Age class of wife - total,Less than 20 years,80-89 years\nduration_of_marriage, duration class of marriage, Duration of marriage - total,5-9 years,20 years or more\namount, Count of divorces, 120\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nDid any person divorce at an age of 90 or above in Switzerland since 2000?\n### SQL query\nSELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '90 years or older'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '90 years or older'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;\n\n\n### Question\nIn Canton Uri how many marriages where divorced in 2003 after more than 10 years?\n### SQL query\nSELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2003\nAND (T.duration_of_marriage = '10-14 years'\n         OR T.duration_of_marriage = '15-19 years'\n         OR T.duration_of_marriage = '20 years or more')\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton AND S.name ilike '% Uri%'\nGROUP BY S.name, T.duration_of_marriage\nORDER BY T.duration_of_marriage DESC;\n\n### Question\nWhat was the prominent age for men that divorced in Switzerland in 2000?\n### SQL query\nSELECT T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband != 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_husband\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nWhich Kanton had the most divorces after only a very long marriage in 2020?\n### SQL query\nSELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2020\nAND T.duration_of_marriage = '20 years or more'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nDid 2020 have more divorces than 2019?\n### SQL query\nSELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE (T.year = 2019 OR T.year = 2020)\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year\nORDER BY T.year DESC;\n\n\n### Question\nIn Canton Uri how many marriages where divorced in 2003 after more than 10 years?\n### SQL query\nSELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2003\nAND (T.duration_of_marriage = '10-14 years'\n         OR T.duration_of_marriage = '15-19 years'\n         OR T.duration_of_marriage = '20 years or more')\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton AND S.name ilike '% Uri%'\nGROUP BY S.name, T.duration_of_marriage\nORDER BY T.duration_of_marriage DESC;\n\n### Question\nWhich Kanton had the most divorces after only a short marriage in 2020?\n### SQL query\nSELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2020\nAND T.duration_of_marriage = '0-4 years'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nIn Canton Uri how many marriages where divorced in 2003 after more than 10 years?\n### SQL query\nSELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2003\nAND (T.duration_of_marriage = '10-14 years'\n         OR T.duration_of_marriage = '15-19 years'\n         OR T.duration_of_marriage = '20 years or more')\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton AND S.name ilike '% Uri%'\nGROUP BY S.name, T.duration_of_marriage\nORDER BY T.duration_of_marriage DESC;\n\n### Question\nWhich Kanton had the most divorces in 2015?\n### SQL query\nSELECT S.name, T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2015\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.year\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nIn Canton Uri how many marriages where divorced in 2003 after more than 10 years?\n### SQL query\nSELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2003\nAND (T.duration_of_marriage = '10-14 years'\n         OR T.duration_of_marriage = '15-19 years'\n         OR T.duration_of_marriage = '20 years or more')\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton AND S.name ilike '% Uri%'\nGROUP BY S.name, T.duration_of_marriage\nORDER BY T.duration_of_marriage DESC;\n\n### Question\nHow many couples were divorced in Switzerland in the year 2000?\n### SQL query\nSELECT T.year, S.name, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = s.spatialunit_uid\nWHERE S.country\nAND T.year = '2000'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nGROUP BY S.name, T.year;\n\n\n### Question\nIn Canton Uri how many marriages where divorced in 2003 after more than 10 years?\n### SQL query\nSELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2003\nAND (T.duration_of_marriage = '10-14 years'\n         OR T.duration_of_marriage = '15-19 years'\n         OR T.duration_of_marriage = '20 years or more')\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton AND S.name ilike '% Uri%'\nGROUP BY S.name, T.duration_of_marriage\nORDER BY T.duration_of_marriage DESC;\n\n### Question\nWhat was the prominent age for men that divorced in Switzerland in 2000?\n### SQL query\nSELECT T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband != 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_husband\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nWhich Kanton had the most divorces in 2015?\n### SQL query\nSELECT S.name, T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2015\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.year\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nHow many men divorced at an age between 60 and 69 in canton zurich in 2020?\n### SQL query\n",
    "process_time": 9.404734115116298,
    "num_tokens": 3306,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 36,
    "question": "From 2000 to 2022 which year saw the most divorces in Switzerland?",
    "query": "SELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.year <= 2022\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year\nORDER BY total_divorces DESC\nLIMIT 1;\n",
    "db_id": "divorces_duration_of_marriage_age_classes",
    "generated_query": "SELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000 AND T.year <= 2022\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year\nORDER BY total_divorces DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "How many divorces happened in Basel in 2015 and after how many years of marriage?",
        "query": "SELECT S.name, S.spatialunit_ontology, T.year, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM divorces_duration_of_marriage_age_classes AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2015\nAND T.duration_of_marriage != 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.name ilike '%basel%'\nGROUP BY T.year, T.duration_of_marriage, S.spatialunit_ontology, S.name;\n"
      },
      {
        "question": "Which Canton had the least divorces in 2002?",
        "query": "SELECT T.year, T.duration_of_marriage, T.amount AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 1990\nAND T.duration_of_marriage != 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year, T.duration_of_marriage, T.amount\nORDER BY T.year, T.duration_of_marriage;\n"
      },
      {
        "question": "What was the prominent age for women that divorced in Switzerland in 2000?",
        "query": "SELECT T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife != 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_wife\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "Which Kanton had the most divorces after only a very long marriage in 2020?",
        "query": "SELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2020\nAND T.duration_of_marriage = '20 years or more'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "Which Kanton had the most divorces after only a short marriage in 2020?",
        "query": "SELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2020\nAND T.duration_of_marriage = '0-4 years'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "Did 2020 have more divorces than 2019?",
        "query": "SELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE (T.year = 2019 OR T.year = 2020)\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year\nORDER BY T.year DESC;\n"
      },
      {
        "question": "Which Kanton had the most divorces after only a very long marriage in 2020?",
        "query": "SELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2020\nAND T.duration_of_marriage = '20 years or more'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "What was the prominent age for men that divorced in Switzerland in 2000?",
        "query": "SELECT T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband != 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_husband\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "How did the amount of divorces in Switzerland develop since 1990?",
        "query": "SELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 1990\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year\nORDER BY T.year;\n"
      },
      {
        "question": "How many women divorced at age between 20 and 29 in canton zurich in 2020?",
        "query": "SELECT S.name, T.year, T.age_class_wife, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Zurich%'\nAND T.year = 2020\nAND S.canton = 'True'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = '20-29 years'\nGROUP BY S.name, T.year, T.age_class_wife;\n"
      },
      {
        "question": "Did any person divorce at an age of 90 or above in Switzerland since 2000?",
        "query": "SELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '90 years or older'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '90 years or older'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;\n"
      },
      {
        "question": "Which Kanton had the most divorces after only a short marriage in 2020?",
        "query": "SELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2020\nAND T.duration_of_marriage = '0-4 years'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "Which Canton had the least divorces in 2002?",
        "query": "SELECT T.year, T.duration_of_marriage, T.amount AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 1990\nAND T.duration_of_marriage != 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year, T.duration_of_marriage, T.amount\nORDER BY T.year, T.duration_of_marriage;\n"
      },
      {
        "question": "Which Canton had the least divorces in 2002?",
        "query": "SELECT T.year, T.duration_of_marriage, T.amount AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 1990\nAND T.duration_of_marriage != 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year, T.duration_of_marriage, T.amount\nORDER BY T.year, T.duration_of_marriage;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_age_classes (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tage_class_husband VARCHAR(50), \n\tage_class_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_spatial_unit_spatialu FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_age_classes and 5 examples in each column for high cardinality columns :\nuid : 857227, 857324, 857392, 857371, 857366\nspatialunit_uid : 0_CH, 25_A.ADM1, 22_A.ADM1, 2_A.ADM1, 23_A.ADM1\nyear : 2015, 1988, 1989, 2000, 2012\namount : 4, 27, 18, 59, 1050\n*/\n\n/*\nColumn name, Column discription, Example values\nage_class_husband, age class of the husband, Age class of husband - total,Less than 20 years,80-89 years\nage_class_wife, age class of the wife, Age class of wife - total,Less than 20 years,80-89 years\nduration_of_marriage, duration class of marriage, Duration of marriage - total,5-9 years,20 years or more\namount, Count of divorces, 120\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nHow many divorces happened in Basel in 2015 and after how many years of marriage?\n### SQL query\nSELECT S.name, S.spatialunit_ontology, T.year, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM divorces_duration_of_marriage_age_classes AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.year = 2015\nAND T.duration_of_marriage != 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.name ilike '%basel%'\nGROUP BY T.year, T.duration_of_marriage, S.spatialunit_ontology, S.name;\n\n\n### Question\nWhich Canton had the least divorces in 2002?\n### SQL query\nSELECT T.year, T.duration_of_marriage, T.amount AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 1990\nAND T.duration_of_marriage != 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year, T.duration_of_marriage, T.amount\nORDER BY T.year, T.duration_of_marriage;\n\n\n### Question\nWhat was the prominent age for women that divorced in Switzerland in 2000?\n### SQL query\nSELECT T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife != 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_wife\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nWhich Kanton had the most divorces after only a very long marriage in 2020?\n### SQL query\nSELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2020\nAND T.duration_of_marriage = '20 years or more'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nWhich Kanton had the most divorces after only a short marriage in 2020?\n### SQL query\nSELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2020\nAND T.duration_of_marriage = '0-4 years'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nDid 2020 have more divorces than 2019?\n### SQL query\nSELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE (T.year = 2019 OR T.year = 2020)\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year\nORDER BY T.year DESC;\n\n\n### Question\nWhich Kanton had the most divorces after only a very long marriage in 2020?\n### SQL query\nSELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2020\nAND T.duration_of_marriage = '20 years or more'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nWhat was the prominent age for men that divorced in Switzerland in 2000?\n### SQL query\nSELECT T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband != 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_husband\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nHow did the amount of divorces in Switzerland develop since 1990?\n### SQL query\nSELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 1990\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year\nORDER BY T.year;\n\n\n### Question\nHow many women divorced at age between 20 and 29 in canton zurich in 2020?\n### SQL query\nSELECT S.name, T.year, T.age_class_wife, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Zurich%'\nAND T.year = 2020\nAND S.canton = 'True'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = '20-29 years'\nGROUP BY S.name, T.year, T.age_class_wife;\n\n\n### Question\nDid any person divorce at an age of 90 or above in Switzerland since 2000?\n### SQL query\nSELECT S.name, T.age_class_husband, T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND ((T.age_class_husband = '90 years or older'\n          AND T.age_class_wife = 'Age class of wife - total')\n        OR (T.age_class_wife = '90 years or older'\n         AND T.age_class_husband = 'Age class of husband - total'))\nAND S.country\nGROUP BY S.name, T.age_class_husband, T.age_class_wife\nORDER BY total_divorces ASC;\n\n\n### Question\nWhich Kanton had the most divorces after only a short marriage in 2020?\n### SQL query\nSELECT S.name, T.duration_of_marriage, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2020\nAND T.duration_of_marriage = '0-4 years'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nWhich Canton had the least divorces in 2002?\n### SQL query\nSELECT T.year, T.duration_of_marriage, T.amount AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 1990\nAND T.duration_of_marriage != 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year, T.duration_of_marriage, T.amount\nORDER BY T.year, T.duration_of_marriage;\n\n\n### Question\nWhich Canton had the least divorces in 2002?\n### SQL query\nSELECT T.year, T.duration_of_marriage, T.amount AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 1990\nAND T.duration_of_marriage != 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year, T.duration_of_marriage, T.amount\nORDER BY T.year, T.duration_of_marriage;\n\n\n### Question\nFrom 2000 to 2022 which year saw the most divorces in Switzerland?\n### SQL query\n",
    "process_time": 10.071189407026395,
    "num_tokens": 3154,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 37,
    "question": "How many marriages in Switzerland got divorced after less then 5 years in 2000?",
    "query": "SELECT sum(amount) AS total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = s.spatialunit_uid\nWHERE S.country\nAND T.year = '2000'\nAND T.duration_of_marriage = '0-4 years'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total';\n",
    "db_id": "divorces_duration_of_marriage_age_classes",
    "generated_query": "SELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = '5-9 years'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.country\nGROUP BY T.year;",
    "meta_data": [
      {
        "question": "How did the amount of divorces in Switzerland develop since 1990?",
        "query": "SELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 1990\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year\nORDER BY T.year;\n"
      },
      {
        "question": "Did 2020 have more divorces than 2019?",
        "query": "SELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE (T.year = 2019 OR T.year = 2020)\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year\nORDER BY T.year DESC;\n"
      },
      {
        "question": "How many women divorced at age between 20 and 29 in canton zurich in 2020?",
        "query": "SELECT S.name, T.year, T.age_class_wife, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Zurich%'\nAND T.year = 2020\nAND S.canton = 'True'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = '20-29 years'\nGROUP BY S.name, T.year, T.age_class_wife;\n"
      },
      {
        "question": "How did the amount of divorces in Switzerland develop since 1990?",
        "query": "SELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 1990\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year\nORDER BY T.year;\n"
      },
      {
        "question": "What was the prominent age for women that divorced in Switzerland in 2000?",
        "query": "SELECT T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife != 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_wife\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "What was the prominent age for women that divorced in Switzerland in 2000?",
        "query": "SELECT T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife != 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_wife\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "Did any men divorce at an age of 90 or above in Switzerland in 2000?",
        "query": "SELECT S.name, T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = '90 years or older'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.country\nGROUP BY S.name, T.age_class_husband\nORDER BY total_divorces ASC\nLIMIT 1;\n"
      },
      {
        "question": "Which Canton had the least divorces in 2002?",
        "query": "SELECT T.year, T.duration_of_marriage, T.amount AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 1990\nAND T.duration_of_marriage != 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year, T.duration_of_marriage, T.amount\nORDER BY T.year, T.duration_of_marriage;\n"
      },
      {
        "question": "What was the prominent age for women that divorced in Switzerland in 2000?",
        "query": "SELECT T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife != 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_wife\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "What was the prominent age for women that divorced in Switzerland in 2000?",
        "query": "SELECT T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife != 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_wife\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "Did 2020 have more divorces than 2019?",
        "query": "SELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE (T.year = 2019 OR T.year = 2020)\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year\nORDER BY T.year DESC;\n"
      },
      {
        "question": "Did 2020 have more divorces than 2019?",
        "query": "SELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE (T.year = 2019 OR T.year = 2020)\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year\nORDER BY T.year DESC;\n"
      },
      {
        "question": "What was the prominent age for women that divorced in Switzerland in 2000?",
        "query": "SELECT T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife != 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_wife\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "Which Kanton had the most divorces in 2015?",
        "query": "SELECT S.name, T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2015\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.year\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_age_classes (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tage_class_husband VARCHAR(50), \n\tage_class_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_age_classes_spatial_unit_spatialu FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_age_classes and 5 examples in each column for high cardinality columns :\nuid : 857227, 857324, 857392, 857371, 857366\nspatialunit_uid : 0_CH, 25_A.ADM1, 22_A.ADM1, 2_A.ADM1, 23_A.ADM1\nyear : 2015, 1988, 1989, 2000, 2012\namount : 4, 27, 18, 59, 1050\n*/\n\n/*\nColumn name, Column discription, Example values\nage_class_husband, age class of the husband, Age class of husband - total,Less than 20 years,80-89 years\nage_class_wife, age class of the wife, Age class of wife - total,Less than 20 years,80-89 years\nduration_of_marriage, duration class of marriage, Duration of marriage - total,5-9 years,20 years or more\namount, Count of divorces, 120\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nHow did the amount of divorces in Switzerland develop since 1990?\n### SQL query\nSELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 1990\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year\nORDER BY T.year;\n\n\n### Question\nDid 2020 have more divorces than 2019?\n### SQL query\nSELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE (T.year = 2019 OR T.year = 2020)\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year\nORDER BY T.year DESC;\n\n\n### Question\nHow many women divorced at age between 20 and 29 in canton zurich in 2020?\n### SQL query\nSELECT S.name, T.year, T.age_class_wife, sum(T.amount) as total_divorces\nFROM divorces_duration_of_marriage_age_classes as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Zurich%'\nAND T.year = 2020\nAND S.canton = 'True'\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = '20-29 years'\nGROUP BY S.name, T.year, T.age_class_wife;\n\n\n### Question\nHow did the amount of divorces in Switzerland develop since 1990?\n### SQL query\nSELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 1990\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year\nORDER BY T.year;\n\n\n### Question\nWhat was the prominent age for women that divorced in Switzerland in 2000?\n### SQL query\nSELECT T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife != 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_wife\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nWhat was the prominent age for women that divorced in Switzerland in 2000?\n### SQL query\nSELECT T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife != 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_wife\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nDid any men divorce at an age of 90 or above in Switzerland in 2000?\n### SQL query\nSELECT S.name, T.age_class_husband, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = '90 years or older'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.country\nGROUP BY S.name, T.age_class_husband\nORDER BY total_divorces ASC\nLIMIT 1;\n\n\n### Question\nWhich Canton had the least divorces in 2002?\n### SQL query\nSELECT T.year, T.duration_of_marriage, T.amount AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year >= 1990\nAND T.duration_of_marriage != 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year, T.duration_of_marriage, T.amount\nORDER BY T.year, T.duration_of_marriage;\n\n\n### Question\nWhat was the prominent age for women that divorced in Switzerland in 2000?\n### SQL query\nSELECT T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife != 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_wife\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nWhat was the prominent age for women that divorced in Switzerland in 2000?\n### SQL query\nSELECT T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife != 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_wife\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nDid 2020 have more divorces than 2019?\n### SQL query\nSELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE (T.year = 2019 OR T.year = 2020)\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year\nORDER BY T.year DESC;\n\n\n### Question\nDid 2020 have more divorces than 2019?\n### SQL query\nSELECT T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE (T.year = 2019 OR T.year = 2020)\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.year\nORDER BY T.year DESC;\n\n\n### Question\nWhat was the prominent age for women that divorced in Switzerland in 2000?\n### SQL query\nSELECT T.age_class_wife, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2000\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_wife != 'Age class of wife - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND S.country\nGROUP BY T.age_class_wife\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nWhich Kanton had the most divorces in 2015?\n### SQL query\nSELECT S.name, T.year, SUM(T.amount) AS total_divorces\nFROM spatial_unit AS S\nINNER JOIN divorces_duration_of_marriage_age_classes AS T\nON S.spatialunit_uid = T.spatialunit_uid\nWHERE T.year = 2015\nAND T.duration_of_marriage = 'Duration of marriage - total'\nAND T.age_class_husband = 'Age class of husband - total'\nAND T.age_class_wife = 'Age class of wife - total'\nAND S.canton\nGROUP BY S.name, T.year\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nHow many marriages in Switzerland got divorced after less then 5 years in 2000?\n### SQL query\n",
    "process_time": 12.95815018680878,
    "num_tokens": 3027,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 38,
    "question": "What is the total number of divorces for Swiss couples where the duration of the marriage was 20 years or more in 1994?",
    "query": "SELECT SUM(amount)\nFROM divorces_duration_of_marriage_citizenship_categories WHERE year = 1994\n  AND duration_of_marriage = '20 years or more'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland';\n",
    "db_id": "divorces_duration_of_marriage_citizenship_categories",
    "generated_query": "SELECT SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories\nWHERE duration_of_marriage = '20 years or more'\n  AND year = 1994\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland';",
    "meta_data": [
      {
        "question": "Which canton had the least divorces in 2000 between couples where at least one partner is a foreigner?",
        "query": "SELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2000\n  AND su.spatialunit_uid LIKE '%_A.ADM1'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\nGROUP BY su.name\nORDER BY total_divorces ASC\nLIMIT 1;\n"
      },
      {
        "question": "Over the years 2000 to 2020, which Swiss municipality experienced the largest increase in total divorces, regardless of citizenship status and duration of marriage?",
        "query": "WITH yearly_totals AS (\n  SELECT year, su.name, sum(amount) as total_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories AS div\n  JOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 2000 AND 2020\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND su.spatialunit_uid LIKE '%_A.ADM3'\n  GROUP BY year, su.name\n),\nyear_2000 AS (\n  SELECT name, total_divorces\n  FROM yearly_totals WHERE year = 2000\n),\nyear_2020 AS (\n  SELECT name, total_divorces\n  FROM yearly_totals WHERE year = 2020\n)\nSELECT year_2000.name, (year_2020.total_divorces - year_2000.total_divorces) as divorce_increase\nFROM year_2000 JOIN year_2020 ON year_2000.name = year_2020.name\nORDER BY divorce_increase DESC\nLIMIT 1;"
      },
      {
        "question": "Is there a year where the Canton of Appenzell Innerrhoden had more divorces than the canton of Appenzell Ausserrhoden (in the years 2000 between 2015)?\t\"",
        "query": "SELECT innerrhoden.year, innerrhoden.total_divorces AS innerrhoden_divorces, ausserrhoden.total_divorces AS ausserrhoden_divorces\nFROM (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '16_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS innerrhoden\nJOIN (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '15_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS ausserrhoden ON innerrhoden.year = ausserrhoden.year\nWHERE innerrhoden.total_divorces > ausserrhoden.total_divorces;\n"
      },
      {
        "question": "In which year did the canton of Vaud experience the highest number of divorces between Swiss couples who were married for 15-19 years?",
        "query": "SELECT year, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE su.spatialunit_uid = '22_A.ADM1'\n  AND duration_of_marriage = '15-19 years'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY year\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "at which duration of marriage most marriages end in divorce across the entire country for all citizenships?",
        "query": "SELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '0_CH'\n  AND duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "In which year between 1990 and 2000 did the canton of zurich have more divorces between Swiss couples than the canton of geneva?",
        "query": "WITH zurich AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '1_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n),\ngeneva AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '25_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n)\nSELECT z.year\nFROM zurich AS z\nJOIN geneva AS g ON z.year = g.year\nWHERE z.total > g.total;\n"
      },
      {
        "question": "How many municipalites had zero/the least amount of divorces between swiss couples in the year 2012?",
        "query": "SELECT COUNT(*) AS number_of_municipalities\nFROM (\n    SELECT su.name, SUM(d.amount) as total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories AS d\n    JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n    WHERE d.year = 2012\n      AND d.duration_of_marriage = 'Duration of marriage - total'\n      AND su.spatialunit_uid LIKE '%_A.ADM3'\n      AND d.citizenship_category_husband = 'Switzerland'\n      AND d.citizenship_category_wife = 'Switzerland'\n    GROUP BY su.name\n) AS subquery\nWHERE total_divorces = (\n    SELECT MIN(total_divorces)\n    FROM (\n        SELECT su.name, SUM(d.amount) as total_divorces\n        FROM divorces_duration_of_marriage_citizenship_categories AS d\n        JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n        WHERE d.year = 2012\n          AND d.duration_of_marriage = 'Duration of marriage - total'\n          AND su.spatialunit_uid LIKE '%_A.ADM3'\n          AND d.citizenship_category_husband = 'Switzerland'\n          AND d.citizenship_category_wife = 'Switzerland'\n        GROUP BY su.name\n    ) AS inner_subquery\n);\n"
      },
      {
        "question": "At what duration of marriage do most divorces occur?",
        "query": "SELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "In which year between 1990 and 2000 did the canton of zurich have more divorces between Swiss couples than the canton of geneva?",
        "query": "WITH zurich AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '1_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n),\ngeneva AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '25_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n)\nSELECT z.year\nFROM zurich AS z\nJOIN geneva AS g ON z.year = g.year\nWHERE z.total > g.total;\n"
      },
      {
        "question": "In 1995, which municipality had the highest number of divorces between Swiss couples who were married for 10-14 years?",
        "query": "SELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE duration_of_marriage = '10-14 years'\n  AND year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "at which duration of marriage most marriages end in divorce across the entire country for all citizenships?",
        "query": "SELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '0_CH'\n  AND duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "Is there a year where the Canton of Appenzell Innerrhoden had more divorces than the canton of Appenzell Ausserrhoden (in the years 2000 between 2015)?\t\"",
        "query": "SELECT innerrhoden.year, innerrhoden.total_divorces AS innerrhoden_divorces, ausserrhoden.total_divorces AS ausserrhoden_divorces\nFROM (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '16_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS innerrhoden\nJOIN (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '15_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS ausserrhoden ON innerrhoden.year = ausserrhoden.year\nWHERE innerrhoden.total_divorces > ausserrhoden.total_divorces;\n"
      },
      {
        "question": "In 1995, which municipality had the highest number of divorces between Swiss couples who were married for 10-14 years?",
        "query": "SELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE duration_of_marriage = '10-14 years'\n  AND year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "In 1995, which municipality had the highest number of divorces between Swiss couples who were married for 10-14 years?",
        "query": "SELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE duration_of_marriage = '10-14 years'\n  AND year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_citizenship_categories (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_spatial_un FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_citizenship_categories and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nspatialunit_uid : 249_A.ADM3, 4074_A.ADM3, 410_A.ADM3, 2869_A.ADM3, 67_A.ADM3\nyear : 2015, 1989, 2000, 2009, 1991\namount : 4, 0, 14, 2, 6\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\nduration_of_marriage, duration class of marriage, Duration of marriage - total,10-14 years,20 years or more\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWhich canton had the least divorces in 2000 between couples where at least one partner is a foreigner?\n### SQL query\nSELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2000\n  AND su.spatialunit_uid LIKE '%_A.ADM1'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\nGROUP BY su.name\nORDER BY total_divorces ASC\nLIMIT 1;\n\n\n### Question\nOver the years 2000 to 2020, which Swiss municipality experienced the largest increase in total divorces, regardless of citizenship status and duration of marriage?\n### SQL query\nWITH yearly_totals AS (\n  SELECT year, su.name, sum(amount) as total_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories AS div\n  JOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 2000 AND 2020\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND su.spatialunit_uid LIKE '%_A.ADM3'\n  GROUP BY year, su.name\n),\nyear_2000 AS (\n  SELECT name, total_divorces\n  FROM yearly_totals WHERE year = 2000\n),\nyear_2020 AS (\n  SELECT name, total_divorces\n  FROM yearly_totals WHERE year = 2020\n)\nSELECT year_2000.name, (year_2020.total_divorces - year_2000.total_divorces) as divorce_increase\nFROM year_2000 JOIN year_2020 ON year_2000.name = year_2020.name\nORDER BY divorce_increase DESC\nLIMIT 1;\n\n### Question\nIs there a year where the Canton of Appenzell Innerrhoden had more divorces than the canton of Appenzell Ausserrhoden (in the years 2000 between 2015)?\t\"\n### SQL query\nSELECT innerrhoden.year, innerrhoden.total_divorces AS innerrhoden_divorces, ausserrhoden.total_divorces AS ausserrhoden_divorces\nFROM (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '16_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS innerrhoden\nJOIN (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '15_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS ausserrhoden ON innerrhoden.year = ausserrhoden.year\nWHERE innerrhoden.total_divorces > ausserrhoden.total_divorces;\n\n\n### Question\nIn which year did the canton of Vaud experience the highest number of divorces between Swiss couples who were married for 15-19 years?\n### SQL query\nSELECT year, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE su.spatialunit_uid = '22_A.ADM1'\n  AND duration_of_marriage = '15-19 years'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY year\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nat which duration of marriage most marriages end in divorce across the entire country for all citizenships?\n### SQL query\nSELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '0_CH'\n  AND duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nIn which year between 1990 and 2000 did the canton of zurich have more divorces between Swiss couples than the canton of geneva?\n### SQL query\nWITH zurich AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '1_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n),\ngeneva AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '25_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n)\nSELECT z.year\nFROM zurich AS z\nJOIN geneva AS g ON z.year = g.year\nWHERE z.total > g.total;\n\n\n### Question\nHow many municipalites had zero/the least amount of divorces between swiss couples in the year 2012?\n### SQL query\nSELECT COUNT(*) AS number_of_municipalities\nFROM (\n    SELECT su.name, SUM(d.amount) as total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories AS d\n    JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n    WHERE d.year = 2012\n      AND d.duration_of_marriage = 'Duration of marriage - total'\n      AND su.spatialunit_uid LIKE '%_A.ADM3'\n      AND d.citizenship_category_husband = 'Switzerland'\n      AND d.citizenship_category_wife = 'Switzerland'\n    GROUP BY su.name\n) AS subquery\nWHERE total_divorces = (\n    SELECT MIN(total_divorces)\n    FROM (\n        SELECT su.name, SUM(d.amount) as total_divorces\n        FROM divorces_duration_of_marriage_citizenship_categories AS d\n        JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n        WHERE d.year = 2012\n          AND d.duration_of_marriage = 'Duration of marriage - total'\n          AND su.spatialunit_uid LIKE '%_A.ADM3'\n          AND d.citizenship_category_husband = 'Switzerland'\n          AND d.citizenship_category_wife = 'Switzerland'\n        GROUP BY su.name\n    ) AS inner_subquery\n);\n\n\n### Question\nAt what duration of marriage do most divorces occur?\n### SQL query\nSELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nIn which year between 1990 and 2000 did the canton of zurich have more divorces between Swiss couples than the canton of geneva?\n### SQL query\nWITH zurich AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '1_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n),\ngeneva AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '25_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n)\nSELECT z.year\nFROM zurich AS z\nJOIN geneva AS g ON z.year = g.year\nWHERE z.total > g.total;\n\n\n### Question\nIn 1995, which municipality had the highest number of divorces between Swiss couples who were married for 10-14 years?\n### SQL query\nSELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE duration_of_marriage = '10-14 years'\n  AND year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nat which duration of marriage most marriages end in divorce across the entire country for all citizenships?\n### SQL query\nSELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '0_CH'\n  AND duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nIs there a year where the Canton of Appenzell Innerrhoden had more divorces than the canton of Appenzell Ausserrhoden (in the years 2000 between 2015)?\t\"\n### SQL query\nSELECT innerrhoden.year, innerrhoden.total_divorces AS innerrhoden_divorces, ausserrhoden.total_divorces AS ausserrhoden_divorces\nFROM (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '16_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS innerrhoden\nJOIN (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '15_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS ausserrhoden ON innerrhoden.year = ausserrhoden.year\nWHERE innerrhoden.total_divorces > ausserrhoden.total_divorces;\n\n\n### Question\nIn 1995, which municipality had the highest number of divorces between Swiss couples who were married for 10-14 years?\n### SQL query\nSELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE duration_of_marriage = '10-14 years'\n  AND year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nIn 1995, which municipality had the highest number of divorces between Swiss couples who were married for 10-14 years?\n### SQL query\nSELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE duration_of_marriage = '10-14 years'\n  AND year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nWhat is the total number of divorces for Swiss couples where the duration of the marriage was 20 years or more in 1994?\n### SQL query\n",
    "process_time": 4.908974824938923,
    "num_tokens": 3771,
    "hardness": "medium",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 39,
    "question": "What are the top 5 cantons with the highest number of divorces in 1994 for Swiss couples?",
    "query": "SELECT su.name, SUM(div.amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su on div.spatialunit_uid = su.spatialunit_uid\nWHERE div.year = 1994\n  AND div.duration_of_marriage = 'Duration of marriage - total'\n  AND div.citizenship_category_husband = 'Switzerland'\n  AND div.citizenship_category_wife = 'Switzerland'\n  AND su.name LIKE '%Canton%'\nGROUP BY su.name\nORDER BY total DESC\nLIMIT 5;\n",
    "db_id": "divorces_duration_of_marriage_citizenship_categories",
    "generated_query": "SELECT su.spatialunit_uid, SUM(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1994\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid\nORDER BY total_divorces DESC\nLIMIT 5;",
    "meta_data": [
      {
        "question": "How many divorces occurred in Switzerland in 1995 between Swiss couples who were married for less than 5 years?",
        "query": "SELECT SUM(amount)\nFROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2001\n  AND su.spatialunit_uid = '0_CH'\n  AND duration_of_marriage = '0-4 years'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland';\n"
      },
      {
        "question": "In 1995, which municipality had the highest number of divorces between Swiss couples who were married for 10-14 years?",
        "query": "SELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE duration_of_marriage = '10-14 years'\n  AND year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "In which year did the canton of Vaud experience the highest number of divorces between Swiss couples who were married for 15-19 years?",
        "query": "SELECT year, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE su.spatialunit_uid = '22_A.ADM1'\n  AND duration_of_marriage = '15-19 years'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY year\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "In 2010, which municipality had the highest number of divorces between couples who were married for 5-9 years and at least one partner was not Swiss?",
        "query": "SELECT su.name, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2010\n  AND duration_of_marriage = '5-9 years'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "How many divorces occurred in Switzerland in 1995 between Swiss couples who were married for less than 5 years?",
        "query": "SELECT SUM(amount)\nFROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2001\n  AND su.spatialunit_uid = '0_CH'\n  AND duration_of_marriage = '0-4 years'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland';\n"
      },
      {
        "question": "What is the average number of divorces per year between 1990 and 2000 in Switzerland among Swiss couples?",
        "query": "SELECT AVG(total) as average_divorces_per_year\nFROM (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '0_CH'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n) as subquery;\n"
      },
      {
        "question": "How many municipalites had zero/the least amount of divorces between swiss couples in the year 2012?",
        "query": "SELECT COUNT(*) AS number_of_municipalities\nFROM (\n    SELECT su.name, SUM(d.amount) as total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories AS d\n    JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n    WHERE d.year = 2012\n      AND d.duration_of_marriage = 'Duration of marriage - total'\n      AND su.spatialunit_uid LIKE '%_A.ADM3'\n      AND d.citizenship_category_husband = 'Switzerland'\n      AND d.citizenship_category_wife = 'Switzerland'\n    GROUP BY su.name\n) AS subquery\nWHERE total_divorces = (\n    SELECT MIN(total_divorces)\n    FROM (\n        SELECT su.name, SUM(d.amount) as total_divorces\n        FROM divorces_duration_of_marriage_citizenship_categories AS d\n        JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n        WHERE d.year = 2012\n          AND d.duration_of_marriage = 'Duration of marriage - total'\n          AND su.spatialunit_uid LIKE '%_A.ADM3'\n          AND d.citizenship_category_husband = 'Switzerland'\n          AND d.citizenship_category_wife = 'Switzerland'\n        GROUP BY su.name\n    ) AS inner_subquery\n);\n"
      },
      {
        "question": "at which duration of marriage most marriages end in divorce across the entire country for all citizenships?",
        "query": "SELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '0_CH'\n  AND duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "In which year between 1990 and 2000 did the canton of zurich have more divorces between Swiss couples than the canton of geneva?",
        "query": "WITH zurich AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '1_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n),\ngeneva AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '25_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n)\nSELECT z.year\nFROM zurich AS z\nJOIN geneva AS g ON z.year = g.year\nWHERE z.total > g.total;\n"
      },
      {
        "question": "In 2010, which municipality had the highest number of divorces between couples who were married for 5-9 years and at least one partner was not Swiss?",
        "query": "SELECT su.name, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2010\n  AND duration_of_marriage = '5-9 years'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "In which year between 1996 and 2017 did the canton of Graub\u00fcnden experience the biggest difference in the percentage of total divorces between Swiss couples and couples where at least one partner was not Swiss?",
        "query": "WITH swiss AS (\n  SELECT year,\n         SUM(amount) AS swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n),\nnot_swiss AS (\n  SELECT year,\n         SUM(amount) AS not_swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n)\nSELECT swiss.year,\n       COALESCE(swiss.swiss_divorces, 0) AS swiss_divorces,\n       COALESCE(not_swiss.not_swiss_divorces, 0) AS not_swiss_divorces,\n       ABS(100.0 * COALESCE(swiss.swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0))\n          - 100.0 * COALESCE(not_swiss.not_swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0)))\n           AS percentage_difference\nFROM swiss JOIN not_swiss ON swiss.year = not_swiss.year\nORDER BY percentage_difference DESC\nLIMIT 1;\n"
      },
      {
        "question": "Is there a year where the Canton of Appenzell Innerrhoden had more divorces than the canton of Appenzell Ausserrhoden (in the years 2000 between 2015)?\t\"",
        "query": "SELECT innerrhoden.year, innerrhoden.total_divorces AS innerrhoden_divorces, ausserrhoden.total_divorces AS ausserrhoden_divorces\nFROM (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '16_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS innerrhoden\nJOIN (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '15_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS ausserrhoden ON innerrhoden.year = ausserrhoden.year\nWHERE innerrhoden.total_divorces > ausserrhoden.total_divorces;\n"
      },
      {
        "question": "How did the total number of divorces between Swiss couples compare between the cantons of Zurich and Geneva in the year 1995?",
        "query": "SELECT su.spatialunit_uid, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND (su.spatialunit_uid = '1_A.ADM1' OR su.spatialunit_uid = '25_A.ADM1')\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid;\n"
      },
      {
        "question": "How many divorces occurred in Switzerland in 1995 between Swiss couples who were married for less than 5 years?",
        "query": "SELECT SUM(amount)\nFROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2001\n  AND su.spatialunit_uid = '0_CH'\n  AND duration_of_marriage = '0-4 years'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland';\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_citizenship_categories (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_spatial_un FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_citizenship_categories and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nspatialunit_uid : 249_A.ADM3, 4074_A.ADM3, 410_A.ADM3, 2869_A.ADM3, 67_A.ADM3\nyear : 2015, 1989, 2000, 2009, 1991\namount : 4, 0, 14, 2, 6\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\nduration_of_marriage, duration class of marriage, Duration of marriage - total,10-14 years,20 years or more\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nHow many divorces occurred in Switzerland in 1995 between Swiss couples who were married for less than 5 years?\n### SQL query\nSELECT SUM(amount)\nFROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2001\n  AND su.spatialunit_uid = '0_CH'\n  AND duration_of_marriage = '0-4 years'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland';\n\n\n### Question\nIn 1995, which municipality had the highest number of divorces between Swiss couples who were married for 10-14 years?\n### SQL query\nSELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE duration_of_marriage = '10-14 years'\n  AND year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nIn which year did the canton of Vaud experience the highest number of divorces between Swiss couples who were married for 15-19 years?\n### SQL query\nSELECT year, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE su.spatialunit_uid = '22_A.ADM1'\n  AND duration_of_marriage = '15-19 years'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY year\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nIn 2010, which municipality had the highest number of divorces between couples who were married for 5-9 years and at least one partner was not Swiss?\n### SQL query\nSELECT su.name, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2010\n  AND duration_of_marriage = '5-9 years'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nHow many divorces occurred in Switzerland in 1995 between Swiss couples who were married for less than 5 years?\n### SQL query\nSELECT SUM(amount)\nFROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2001\n  AND su.spatialunit_uid = '0_CH'\n  AND duration_of_marriage = '0-4 years'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland';\n\n\n### Question\nWhat is the average number of divorces per year between 1990 and 2000 in Switzerland among Swiss couples?\n### SQL query\nSELECT AVG(total) as average_divorces_per_year\nFROM (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '0_CH'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n) as subquery;\n\n\n### Question\nHow many municipalites had zero/the least amount of divorces between swiss couples in the year 2012?\n### SQL query\nSELECT COUNT(*) AS number_of_municipalities\nFROM (\n    SELECT su.name, SUM(d.amount) as total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories AS d\n    JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n    WHERE d.year = 2012\n      AND d.duration_of_marriage = 'Duration of marriage - total'\n      AND su.spatialunit_uid LIKE '%_A.ADM3'\n      AND d.citizenship_category_husband = 'Switzerland'\n      AND d.citizenship_category_wife = 'Switzerland'\n    GROUP BY su.name\n) AS subquery\nWHERE total_divorces = (\n    SELECT MIN(total_divorces)\n    FROM (\n        SELECT su.name, SUM(d.amount) as total_divorces\n        FROM divorces_duration_of_marriage_citizenship_categories AS d\n        JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n        WHERE d.year = 2012\n          AND d.duration_of_marriage = 'Duration of marriage - total'\n          AND su.spatialunit_uid LIKE '%_A.ADM3'\n          AND d.citizenship_category_husband = 'Switzerland'\n          AND d.citizenship_category_wife = 'Switzerland'\n        GROUP BY su.name\n    ) AS inner_subquery\n);\n\n\n### Question\nat which duration of marriage most marriages end in divorce across the entire country for all citizenships?\n### SQL query\nSELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '0_CH'\n  AND duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nIn which year between 1990 and 2000 did the canton of zurich have more divorces between Swiss couples than the canton of geneva?\n### SQL query\nWITH zurich AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '1_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n),\ngeneva AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '25_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n)\nSELECT z.year\nFROM zurich AS z\nJOIN geneva AS g ON z.year = g.year\nWHERE z.total > g.total;\n\n\n### Question\nIn 2010, which municipality had the highest number of divorces between couples who were married for 5-9 years and at least one partner was not Swiss?\n### SQL query\nSELECT su.name, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2010\n  AND duration_of_marriage = '5-9 years'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nIn which year between 1996 and 2017 did the canton of Graub\u00fcnden experience the biggest difference in the percentage of total divorces between Swiss couples and couples where at least one partner was not Swiss?\n### SQL query\nWITH swiss AS (\n  SELECT year,\n         SUM(amount) AS swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n),\nnot_swiss AS (\n  SELECT year,\n         SUM(amount) AS not_swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n)\nSELECT swiss.year,\n       COALESCE(swiss.swiss_divorces, 0) AS swiss_divorces,\n       COALESCE(not_swiss.not_swiss_divorces, 0) AS not_swiss_divorces,\n       ABS(100.0 * COALESCE(swiss.swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0))\n          - 100.0 * COALESCE(not_swiss.not_swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0)))\n           AS percentage_difference\nFROM swiss JOIN not_swiss ON swiss.year = not_swiss.year\nORDER BY percentage_difference DESC\nLIMIT 1;\n\n\n### Question\nIs there a year where the Canton of Appenzell Innerrhoden had more divorces than the canton of Appenzell Ausserrhoden (in the years 2000 between 2015)?\t\"\n### SQL query\nSELECT innerrhoden.year, innerrhoden.total_divorces AS innerrhoden_divorces, ausserrhoden.total_divorces AS ausserrhoden_divorces\nFROM (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '16_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS innerrhoden\nJOIN (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '15_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS ausserrhoden ON innerrhoden.year = ausserrhoden.year\nWHERE innerrhoden.total_divorces > ausserrhoden.total_divorces;\n\n\n### Question\nHow did the total number of divorces between Swiss couples compare between the cantons of Zurich and Geneva in the year 1995?\n### SQL query\nSELECT su.spatialunit_uid, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND (su.spatialunit_uid = '1_A.ADM1' OR su.spatialunit_uid = '25_A.ADM1')\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid;\n\n\n### Question\nHow many divorces occurred in Switzerland in 1995 between Swiss couples who were married for less than 5 years?\n### SQL query\nSELECT SUM(amount)\nFROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2001\n  AND su.spatialunit_uid = '0_CH'\n  AND duration_of_marriage = '0-4 years'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland';\n\n\n### Question\nWhat are the top 5 cantons with the highest number of divorces in 1994 for Swiss couples?\n### SQL query\n",
    "process_time": 11.214736290974542,
    "num_tokens": 3781,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 40,
    "question": "In which year between 1990 and 2000 did the Canton of Zurich have the highest number of divorces between Swiss couples?",
    "query": "SELECT year, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year BETWEEN 2000 AND 2010\n  AND su.spatialunit_uid = '1_A.ADM1'\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY year\nORDER BY total DESC\nLIMIT 1;\n",
    "db_id": "divorces_duration_of_marriage_citizenship_categories",
    "generated_query": "SELECT year, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE su.spatialunit_uid = '1_A.ADM1'\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\n  AND year BETWEEN 1990 AND 2000\nGROUP BY year\nORDER BY total_divorces DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "At what duration of marriage do most divorces occur?",
        "query": "SELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "How did the total number of divorces between Swiss couples compare between the cantons of Zurich and Geneva in the year 1995?",
        "query": "SELECT su.spatialunit_uid, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND (su.spatialunit_uid = '1_A.ADM1' OR su.spatialunit_uid = '25_A.ADM1')\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid;\n"
      },
      {
        "question": "In 1995, which municipality had the highest number of divorces between Swiss couples who were married for 10-14 years?",
        "query": "SELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE duration_of_marriage = '10-14 years'\n  AND year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "In 2010, which municipality had the highest number of divorces between couples who were married for 5-9 years and at least one partner was not Swiss?",
        "query": "SELECT su.name, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2010\n  AND duration_of_marriage = '5-9 years'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "What is the average number of divorces per year between 1990 and 2000 in Switzerland among Swiss couples?",
        "query": "SELECT AVG(total) as average_divorces_per_year\nFROM (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '0_CH'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n) as subquery;\n"
      },
      {
        "question": "Which canton had the least divorces in 2000 between couples where at least one partner is a foreigner?",
        "query": "SELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2000\n  AND su.spatialunit_uid LIKE '%_A.ADM1'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\nGROUP BY su.name\nORDER BY total_divorces ASC\nLIMIT 1;\n"
      },
      {
        "question": "at which duration of marriage most marriages end in divorce across the entire country for all citizenships?",
        "query": "SELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '0_CH'\n  AND duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "How many divorces occurred in Switzerland in 1995 between Swiss couples who were married for less than 5 years?",
        "query": "SELECT SUM(amount)\nFROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2001\n  AND su.spatialunit_uid = '0_CH'\n  AND duration_of_marriage = '0-4 years'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland';\n"
      },
      {
        "question": "Is there a year where the Canton of Appenzell Innerrhoden had more divorces than the canton of Appenzell Ausserrhoden (in the years 2000 between 2015)?\t\"",
        "query": "SELECT innerrhoden.year, innerrhoden.total_divorces AS innerrhoden_divorces, ausserrhoden.total_divorces AS ausserrhoden_divorces\nFROM (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '16_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS innerrhoden\nJOIN (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '15_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS ausserrhoden ON innerrhoden.year = ausserrhoden.year\nWHERE innerrhoden.total_divorces > ausserrhoden.total_divorces;\n"
      },
      {
        "question": "In 1995, which municipality had the highest number of divorces between Swiss couples who were married for 10-14 years?",
        "query": "SELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE duration_of_marriage = '10-14 years'\n  AND year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "How did the total number of divorces between Swiss couples compare between the cantons of Zurich and Geneva in the year 1995?",
        "query": "SELECT su.spatialunit_uid, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND (su.spatialunit_uid = '1_A.ADM1' OR su.spatialunit_uid = '25_A.ADM1')\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid;\n"
      },
      {
        "question": "Is there a year where the Canton of Appenzell Innerrhoden had more divorces than the canton of Appenzell Ausserrhoden (in the years 2000 between 2015)?\t\"",
        "query": "SELECT innerrhoden.year, innerrhoden.total_divorces AS innerrhoden_divorces, ausserrhoden.total_divorces AS ausserrhoden_divorces\nFROM (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '16_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS innerrhoden\nJOIN (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '15_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS ausserrhoden ON innerrhoden.year = ausserrhoden.year\nWHERE innerrhoden.total_divorces > ausserrhoden.total_divorces;\n"
      },
      {
        "question": "At what duration of marriage do most divorces occur?",
        "query": "SELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "In which year between 1996 and 2017 did the canton of Graub\u00fcnden experience the biggest difference in the percentage of total divorces between Swiss couples and couples where at least one partner was not Swiss?",
        "query": "WITH swiss AS (\n  SELECT year,\n         SUM(amount) AS swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n),\nnot_swiss AS (\n  SELECT year,\n         SUM(amount) AS not_swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n)\nSELECT swiss.year,\n       COALESCE(swiss.swiss_divorces, 0) AS swiss_divorces,\n       COALESCE(not_swiss.not_swiss_divorces, 0) AS not_swiss_divorces,\n       ABS(100.0 * COALESCE(swiss.swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0))\n          - 100.0 * COALESCE(not_swiss.not_swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0)))\n           AS percentage_difference\nFROM swiss JOIN not_swiss ON swiss.year = not_swiss.year\nORDER BY percentage_difference DESC\nLIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_citizenship_categories (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_spatial_un FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_citizenship_categories and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nspatialunit_uid : 249_A.ADM3, 4074_A.ADM3, 410_A.ADM3, 2869_A.ADM3, 67_A.ADM3\nyear : 2015, 1989, 2000, 2009, 1991\namount : 4, 0, 14, 2, 6\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\nduration_of_marriage, duration class of marriage, Duration of marriage - total,10-14 years,20 years or more\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nAt what duration of marriage do most divorces occur?\n### SQL query\nSELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nHow did the total number of divorces between Swiss couples compare between the cantons of Zurich and Geneva in the year 1995?\n### SQL query\nSELECT su.spatialunit_uid, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND (su.spatialunit_uid = '1_A.ADM1' OR su.spatialunit_uid = '25_A.ADM1')\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid;\n\n\n### Question\nIn 1995, which municipality had the highest number of divorces between Swiss couples who were married for 10-14 years?\n### SQL query\nSELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE duration_of_marriage = '10-14 years'\n  AND year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nIn 2010, which municipality had the highest number of divorces between couples who were married for 5-9 years and at least one partner was not Swiss?\n### SQL query\nSELECT su.name, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2010\n  AND duration_of_marriage = '5-9 years'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nWhat is the average number of divorces per year between 1990 and 2000 in Switzerland among Swiss couples?\n### SQL query\nSELECT AVG(total) as average_divorces_per_year\nFROM (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '0_CH'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n) as subquery;\n\n\n### Question\nWhich canton had the least divorces in 2000 between couples where at least one partner is a foreigner?\n### SQL query\nSELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2000\n  AND su.spatialunit_uid LIKE '%_A.ADM1'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\nGROUP BY su.name\nORDER BY total_divorces ASC\nLIMIT 1;\n\n\n### Question\nat which duration of marriage most marriages end in divorce across the entire country for all citizenships?\n### SQL query\nSELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '0_CH'\n  AND duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nHow many divorces occurred in Switzerland in 1995 between Swiss couples who were married for less than 5 years?\n### SQL query\nSELECT SUM(amount)\nFROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2001\n  AND su.spatialunit_uid = '0_CH'\n  AND duration_of_marriage = '0-4 years'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland';\n\n\n### Question\nIs there a year where the Canton of Appenzell Innerrhoden had more divorces than the canton of Appenzell Ausserrhoden (in the years 2000 between 2015)?\t\"\n### SQL query\nSELECT innerrhoden.year, innerrhoden.total_divorces AS innerrhoden_divorces, ausserrhoden.total_divorces AS ausserrhoden_divorces\nFROM (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '16_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS innerrhoden\nJOIN (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '15_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS ausserrhoden ON innerrhoden.year = ausserrhoden.year\nWHERE innerrhoden.total_divorces > ausserrhoden.total_divorces;\n\n\n### Question\nIn 1995, which municipality had the highest number of divorces between Swiss couples who were married for 10-14 years?\n### SQL query\nSELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE duration_of_marriage = '10-14 years'\n  AND year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nHow did the total number of divorces between Swiss couples compare between the cantons of Zurich and Geneva in the year 1995?\n### SQL query\nSELECT su.spatialunit_uid, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND (su.spatialunit_uid = '1_A.ADM1' OR su.spatialunit_uid = '25_A.ADM1')\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid;\n\n\n### Question\nIs there a year where the Canton of Appenzell Innerrhoden had more divorces than the canton of Appenzell Ausserrhoden (in the years 2000 between 2015)?\t\"\n### SQL query\nSELECT innerrhoden.year, innerrhoden.total_divorces AS innerrhoden_divorces, ausserrhoden.total_divorces AS ausserrhoden_divorces\nFROM (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '16_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS innerrhoden\nJOIN (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '15_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS ausserrhoden ON innerrhoden.year = ausserrhoden.year\nWHERE innerrhoden.total_divorces > ausserrhoden.total_divorces;\n\n\n### Question\nAt what duration of marriage do most divorces occur?\n### SQL query\nSELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nIn which year between 1996 and 2017 did the canton of Graub\u00fcnden experience the biggest difference in the percentage of total divorces between Swiss couples and couples where at least one partner was not Swiss?\n### SQL query\nWITH swiss AS (\n  SELECT year,\n         SUM(amount) AS swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n),\nnot_swiss AS (\n  SELECT year,\n         SUM(amount) AS not_swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n)\nSELECT swiss.year,\n       COALESCE(swiss.swiss_divorces, 0) AS swiss_divorces,\n       COALESCE(not_swiss.not_swiss_divorces, 0) AS not_swiss_divorces,\n       ABS(100.0 * COALESCE(swiss.swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0))\n          - 100.0 * COALESCE(not_swiss.not_swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0)))\n           AS percentage_difference\nFROM swiss JOIN not_swiss ON swiss.year = not_swiss.year\nORDER BY percentage_difference DESC\nLIMIT 1;\n\n\n### Question\nIn which year between 1990 and 2000 did the Canton of Zurich have the highest number of divorces between Swiss couples?\n### SQL query\n",
    "process_time": 8.256079969927669,
    "num_tokens": 3496,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 41,
    "question": "In 1995, which municipality had the lowest number of divorces between Swiss couples who were married for 10-14 years?",
    "query": "SELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE duration_of_marriage = '10-14 years'\n  AND year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces ASC\nLIMIT 1;\n",
    "db_id": "divorces_duration_of_marriage_citizenship_categories",
    "generated_query": "SELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE duration_of_marriage = '10-14 years'\n  AND year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces ASC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "In which year between 1996 and 2017 did the canton of Graub\u00fcnden experience the biggest difference in the percentage of total divorces between Swiss couples and couples where at least one partner was not Swiss?",
        "query": "WITH swiss AS (\n  SELECT year,\n         SUM(amount) AS swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n),\nnot_swiss AS (\n  SELECT year,\n         SUM(amount) AS not_swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n)\nSELECT swiss.year,\n       COALESCE(swiss.swiss_divorces, 0) AS swiss_divorces,\n       COALESCE(not_swiss.not_swiss_divorces, 0) AS not_swiss_divorces,\n       ABS(100.0 * COALESCE(swiss.swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0))\n          - 100.0 * COALESCE(not_swiss.not_swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0)))\n           AS percentage_difference\nFROM swiss JOIN not_swiss ON swiss.year = not_swiss.year\nORDER BY percentage_difference DESC\nLIMIT 1;\n"
      },
      {
        "question": "What is the average number of divorces per year between 1990 and 2000 in Switzerland among Swiss couples?",
        "query": "SELECT AVG(total) as average_divorces_per_year\nFROM (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '0_CH'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n) as subquery;\n"
      },
      {
        "question": "Which canton had the least divorces in 2000 between couples where at least one partner is a foreigner?",
        "query": "SELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2000\n  AND su.spatialunit_uid LIKE '%_A.ADM1'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\nGROUP BY su.name\nORDER BY total_divorces ASC\nLIMIT 1;\n"
      },
      {
        "question": "How many divorces occurred in Switzerland in 1995 between Swiss couples who were married for less than 5 years?",
        "query": "SELECT SUM(amount)\nFROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2001\n  AND su.spatialunit_uid = '0_CH'\n  AND duration_of_marriage = '0-4 years'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland';\n"
      },
      {
        "question": "Over the years 2000 to 2020, which Swiss municipality experienced the largest increase in total divorces, regardless of citizenship status and duration of marriage?",
        "query": "WITH yearly_totals AS (\n  SELECT year, su.name, sum(amount) as total_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories AS div\n  JOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 2000 AND 2020\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND su.spatialunit_uid LIKE '%_A.ADM3'\n  GROUP BY year, su.name\n),\nyear_2000 AS (\n  SELECT name, total_divorces\n  FROM yearly_totals WHERE year = 2000\n),\nyear_2020 AS (\n  SELECT name, total_divorces\n  FROM yearly_totals WHERE year = 2020\n)\nSELECT year_2000.name, (year_2020.total_divorces - year_2000.total_divorces) as divorce_increase\nFROM year_2000 JOIN year_2020 ON year_2000.name = year_2020.name\nORDER BY divorce_increase DESC\nLIMIT 1;"
      },
      {
        "question": "How many municipalites had zero/the least amount of divorces between swiss couples in the year 2012?",
        "query": "SELECT COUNT(*) AS number_of_municipalities\nFROM (\n    SELECT su.name, SUM(d.amount) as total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories AS d\n    JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n    WHERE d.year = 2012\n      AND d.duration_of_marriage = 'Duration of marriage - total'\n      AND su.spatialunit_uid LIKE '%_A.ADM3'\n      AND d.citizenship_category_husband = 'Switzerland'\n      AND d.citizenship_category_wife = 'Switzerland'\n    GROUP BY su.name\n) AS subquery\nWHERE total_divorces = (\n    SELECT MIN(total_divorces)\n    FROM (\n        SELECT su.name, SUM(d.amount) as total_divorces\n        FROM divorces_duration_of_marriage_citizenship_categories AS d\n        JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n        WHERE d.year = 2012\n          AND d.duration_of_marriage = 'Duration of marriage - total'\n          AND su.spatialunit_uid LIKE '%_A.ADM3'\n          AND d.citizenship_category_husband = 'Switzerland'\n          AND d.citizenship_category_wife = 'Switzerland'\n        GROUP BY su.name\n    ) AS inner_subquery\n);\n"
      },
      {
        "question": "At what duration of marriage do most divorces occur?",
        "query": "SELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "How did the total number of divorces between Swiss couples compare between the cantons of Zurich and Geneva in the year 1995?",
        "query": "SELECT su.spatialunit_uid, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND (su.spatialunit_uid = '1_A.ADM1' OR su.spatialunit_uid = '25_A.ADM1')\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid;\n"
      },
      {
        "question": "In 2010, which municipality had the highest number of divorces between couples who were married for 5-9 years and at least one partner was not Swiss?",
        "query": "SELECT su.name, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2010\n  AND duration_of_marriage = '5-9 years'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "In 1995, which municipality had the highest number of divorces between Swiss couples who were married for 10-14 years?",
        "query": "SELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE duration_of_marriage = '10-14 years'\n  AND year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "In 2010, which municipality had the highest number of divorces between couples who were married for 5-9 years and at least one partner was not Swiss?",
        "query": "SELECT su.name, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2010\n  AND duration_of_marriage = '5-9 years'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "Is there a year where the Canton of Appenzell Innerrhoden had more divorces than the canton of Appenzell Ausserrhoden (in the years 2000 between 2015)?\t\"",
        "query": "SELECT innerrhoden.year, innerrhoden.total_divorces AS innerrhoden_divorces, ausserrhoden.total_divorces AS ausserrhoden_divorces\nFROM (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '16_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS innerrhoden\nJOIN (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '15_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS ausserrhoden ON innerrhoden.year = ausserrhoden.year\nWHERE innerrhoden.total_divorces > ausserrhoden.total_divorces;\n"
      },
      {
        "question": "Over the years 2000 to 2020, which Swiss municipality experienced the largest increase in total divorces, regardless of citizenship status and duration of marriage?",
        "query": "WITH yearly_totals AS (\n  SELECT year, su.name, sum(amount) as total_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories AS div\n  JOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 2000 AND 2020\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND su.spatialunit_uid LIKE '%_A.ADM3'\n  GROUP BY year, su.name\n),\nyear_2000 AS (\n  SELECT name, total_divorces\n  FROM yearly_totals WHERE year = 2000\n),\nyear_2020 AS (\n  SELECT name, total_divorces\n  FROM yearly_totals WHERE year = 2020\n)\nSELECT year_2000.name, (year_2020.total_divorces - year_2000.total_divorces) as divorce_increase\nFROM year_2000 JOIN year_2020 ON year_2000.name = year_2020.name\nORDER BY divorce_increase DESC\nLIMIT 1;"
      },
      {
        "question": "at which duration of marriage most marriages end in divorce across the entire country for all citizenships?",
        "query": "SELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '0_CH'\n  AND duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_citizenship_categories (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_spatial_un FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_citizenship_categories and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nspatialunit_uid : 249_A.ADM3, 4074_A.ADM3, 410_A.ADM3, 2869_A.ADM3, 67_A.ADM3\nyear : 2015, 1989, 2000, 2009, 1991\namount : 4, 0, 14, 2, 6\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\nduration_of_marriage, duration class of marriage, Duration of marriage - total,10-14 years,20 years or more\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nIn which year between 1996 and 2017 did the canton of Graub\u00fcnden experience the biggest difference in the percentage of total divorces between Swiss couples and couples where at least one partner was not Swiss?\n### SQL query\nWITH swiss AS (\n  SELECT year,\n         SUM(amount) AS swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n),\nnot_swiss AS (\n  SELECT year,\n         SUM(amount) AS not_swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n)\nSELECT swiss.year,\n       COALESCE(swiss.swiss_divorces, 0) AS swiss_divorces,\n       COALESCE(not_swiss.not_swiss_divorces, 0) AS not_swiss_divorces,\n       ABS(100.0 * COALESCE(swiss.swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0))\n          - 100.0 * COALESCE(not_swiss.not_swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0)))\n           AS percentage_difference\nFROM swiss JOIN not_swiss ON swiss.year = not_swiss.year\nORDER BY percentage_difference DESC\nLIMIT 1;\n\n\n### Question\nWhat is the average number of divorces per year between 1990 and 2000 in Switzerland among Swiss couples?\n### SQL query\nSELECT AVG(total) as average_divorces_per_year\nFROM (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '0_CH'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n) as subquery;\n\n\n### Question\nWhich canton had the least divorces in 2000 between couples where at least one partner is a foreigner?\n### SQL query\nSELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2000\n  AND su.spatialunit_uid LIKE '%_A.ADM1'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\nGROUP BY su.name\nORDER BY total_divorces ASC\nLIMIT 1;\n\n\n### Question\nHow many divorces occurred in Switzerland in 1995 between Swiss couples who were married for less than 5 years?\n### SQL query\nSELECT SUM(amount)\nFROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2001\n  AND su.spatialunit_uid = '0_CH'\n  AND duration_of_marriage = '0-4 years'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland';\n\n\n### Question\nOver the years 2000 to 2020, which Swiss municipality experienced the largest increase in total divorces, regardless of citizenship status and duration of marriage?\n### SQL query\nWITH yearly_totals AS (\n  SELECT year, su.name, sum(amount) as total_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories AS div\n  JOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 2000 AND 2020\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND su.spatialunit_uid LIKE '%_A.ADM3'\n  GROUP BY year, su.name\n),\nyear_2000 AS (\n  SELECT name, total_divorces\n  FROM yearly_totals WHERE year = 2000\n),\nyear_2020 AS (\n  SELECT name, total_divorces\n  FROM yearly_totals WHERE year = 2020\n)\nSELECT year_2000.name, (year_2020.total_divorces - year_2000.total_divorces) as divorce_increase\nFROM year_2000 JOIN year_2020 ON year_2000.name = year_2020.name\nORDER BY divorce_increase DESC\nLIMIT 1;\n\n### Question\nHow many municipalites had zero/the least amount of divorces between swiss couples in the year 2012?\n### SQL query\nSELECT COUNT(*) AS number_of_municipalities\nFROM (\n    SELECT su.name, SUM(d.amount) as total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories AS d\n    JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n    WHERE d.year = 2012\n      AND d.duration_of_marriage = 'Duration of marriage - total'\n      AND su.spatialunit_uid LIKE '%_A.ADM3'\n      AND d.citizenship_category_husband = 'Switzerland'\n      AND d.citizenship_category_wife = 'Switzerland'\n    GROUP BY su.name\n) AS subquery\nWHERE total_divorces = (\n    SELECT MIN(total_divorces)\n    FROM (\n        SELECT su.name, SUM(d.amount) as total_divorces\n        FROM divorces_duration_of_marriage_citizenship_categories AS d\n        JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n        WHERE d.year = 2012\n          AND d.duration_of_marriage = 'Duration of marriage - total'\n          AND su.spatialunit_uid LIKE '%_A.ADM3'\n          AND d.citizenship_category_husband = 'Switzerland'\n          AND d.citizenship_category_wife = 'Switzerland'\n        GROUP BY su.name\n    ) AS inner_subquery\n);\n\n\n### Question\nAt what duration of marriage do most divorces occur?\n### SQL query\nSELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nHow did the total number of divorces between Swiss couples compare between the cantons of Zurich and Geneva in the year 1995?\n### SQL query\nSELECT su.spatialunit_uid, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND (su.spatialunit_uid = '1_A.ADM1' OR su.spatialunit_uid = '25_A.ADM1')\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid;\n\n\n### Question\nIn 2010, which municipality had the highest number of divorces between couples who were married for 5-9 years and at least one partner was not Swiss?\n### SQL query\nSELECT su.name, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2010\n  AND duration_of_marriage = '5-9 years'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nIn 1995, which municipality had the highest number of divorces between Swiss couples who were married for 10-14 years?\n### SQL query\nSELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE duration_of_marriage = '10-14 years'\n  AND year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nIn 2010, which municipality had the highest number of divorces between couples who were married for 5-9 years and at least one partner was not Swiss?\n### SQL query\nSELECT su.name, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2010\n  AND duration_of_marriage = '5-9 years'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nIs there a year where the Canton of Appenzell Innerrhoden had more divorces than the canton of Appenzell Ausserrhoden (in the years 2000 between 2015)?\t\"\n### SQL query\nSELECT innerrhoden.year, innerrhoden.total_divorces AS innerrhoden_divorces, ausserrhoden.total_divorces AS ausserrhoden_divorces\nFROM (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '16_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS innerrhoden\nJOIN (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '15_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS ausserrhoden ON innerrhoden.year = ausserrhoden.year\nWHERE innerrhoden.total_divorces > ausserrhoden.total_divorces;\n\n\n### Question\nOver the years 2000 to 2020, which Swiss municipality experienced the largest increase in total divorces, regardless of citizenship status and duration of marriage?\n### SQL query\nWITH yearly_totals AS (\n  SELECT year, su.name, sum(amount) as total_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories AS div\n  JOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 2000 AND 2020\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND su.spatialunit_uid LIKE '%_A.ADM3'\n  GROUP BY year, su.name\n),\nyear_2000 AS (\n  SELECT name, total_divorces\n  FROM yearly_totals WHERE year = 2000\n),\nyear_2020 AS (\n  SELECT name, total_divorces\n  FROM yearly_totals WHERE year = 2020\n)\nSELECT year_2000.name, (year_2020.total_divorces - year_2000.total_divorces) as divorce_increase\nFROM year_2000 JOIN year_2020 ON year_2000.name = year_2020.name\nORDER BY divorce_increase DESC\nLIMIT 1;\n\n### Question\nat which duration of marriage most marriages end in divorce across the entire country for all citizenships?\n### SQL query\nSELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '0_CH'\n  AND duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nIn 1995, which municipality had the lowest number of divorces between Swiss couples who were married for 10-14 years?\n### SQL query\n",
    "process_time": 9.39344309293665,
    "num_tokens": 3823,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 42,
    "question": "How has the number of divorces for Swiss couples changed from 1990 to 2000?",
    "query": "SELECT year, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories WHERE year BETWEEN 1990 AND 2000\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY year\nORDER BY year;\n",
    "db_id": "divorces_duration_of_marriage_citizenship_categories",
    "generated_query": "SELECT year, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE year BETWEEN 1990 AND 2000\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY year\nORDER BY year;",
    "meta_data": [
      {
        "question": "Over the years 2000 to 2020, which Swiss municipality experienced the largest increase in total divorces, regardless of citizenship status and duration of marriage?",
        "query": "WITH yearly_totals AS (\n  SELECT year, su.name, sum(amount) as total_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories AS div\n  JOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 2000 AND 2020\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND su.spatialunit_uid LIKE '%_A.ADM3'\n  GROUP BY year, su.name\n),\nyear_2000 AS (\n  SELECT name, total_divorces\n  FROM yearly_totals WHERE year = 2000\n),\nyear_2020 AS (\n  SELECT name, total_divorces\n  FROM yearly_totals WHERE year = 2020\n)\nSELECT year_2000.name, (year_2020.total_divorces - year_2000.total_divorces) as divorce_increase\nFROM year_2000 JOIN year_2020 ON year_2000.name = year_2020.name\nORDER BY divorce_increase DESC\nLIMIT 1;"
      },
      {
        "question": "In which year did the canton of Vaud experience the highest number of divorces between Swiss couples who were married for 15-19 years?",
        "query": "SELECT year, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE su.spatialunit_uid = '22_A.ADM1'\n  AND duration_of_marriage = '15-19 years'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY year\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "at which duration of marriage most marriages end in divorce across the entire country for all citizenships?",
        "query": "SELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '0_CH'\n  AND duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "In which year between 1996 and 2017 did the canton of Graub\u00fcnden experience the biggest difference in the percentage of total divorces between Swiss couples and couples where at least one partner was not Swiss?",
        "query": "WITH swiss AS (\n  SELECT year,\n         SUM(amount) AS swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n),\nnot_swiss AS (\n  SELECT year,\n         SUM(amount) AS not_swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n)\nSELECT swiss.year,\n       COALESCE(swiss.swiss_divorces, 0) AS swiss_divorces,\n       COALESCE(not_swiss.not_swiss_divorces, 0) AS not_swiss_divorces,\n       ABS(100.0 * COALESCE(swiss.swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0))\n          - 100.0 * COALESCE(not_swiss.not_swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0)))\n           AS percentage_difference\nFROM swiss JOIN not_swiss ON swiss.year = not_swiss.year\nORDER BY percentage_difference DESC\nLIMIT 1;\n"
      },
      {
        "question": "How many municipalites had zero/the least amount of divorces between swiss couples in the year 2012?",
        "query": "SELECT COUNT(*) AS number_of_municipalities\nFROM (\n    SELECT su.name, SUM(d.amount) as total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories AS d\n    JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n    WHERE d.year = 2012\n      AND d.duration_of_marriage = 'Duration of marriage - total'\n      AND su.spatialunit_uid LIKE '%_A.ADM3'\n      AND d.citizenship_category_husband = 'Switzerland'\n      AND d.citizenship_category_wife = 'Switzerland'\n    GROUP BY su.name\n) AS subquery\nWHERE total_divorces = (\n    SELECT MIN(total_divorces)\n    FROM (\n        SELECT su.name, SUM(d.amount) as total_divorces\n        FROM divorces_duration_of_marriage_citizenship_categories AS d\n        JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n        WHERE d.year = 2012\n          AND d.duration_of_marriage = 'Duration of marriage - total'\n          AND su.spatialunit_uid LIKE '%_A.ADM3'\n          AND d.citizenship_category_husband = 'Switzerland'\n          AND d.citizenship_category_wife = 'Switzerland'\n        GROUP BY su.name\n    ) AS inner_subquery\n);\n"
      },
      {
        "question": "In 2010, which municipality had the highest number of divorces between couples who were married for 5-9 years and at least one partner was not Swiss?",
        "query": "SELECT su.name, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2010\n  AND duration_of_marriage = '5-9 years'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "How many municipalites had zero/the least amount of divorces between swiss couples in the year 2012?",
        "query": "SELECT COUNT(*) AS number_of_municipalities\nFROM (\n    SELECT su.name, SUM(d.amount) as total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories AS d\n    JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n    WHERE d.year = 2012\n      AND d.duration_of_marriage = 'Duration of marriage - total'\n      AND su.spatialunit_uid LIKE '%_A.ADM3'\n      AND d.citizenship_category_husband = 'Switzerland'\n      AND d.citizenship_category_wife = 'Switzerland'\n    GROUP BY su.name\n) AS subquery\nWHERE total_divorces = (\n    SELECT MIN(total_divorces)\n    FROM (\n        SELECT su.name, SUM(d.amount) as total_divorces\n        FROM divorces_duration_of_marriage_citizenship_categories AS d\n        JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n        WHERE d.year = 2012\n          AND d.duration_of_marriage = 'Duration of marriage - total'\n          AND su.spatialunit_uid LIKE '%_A.ADM3'\n          AND d.citizenship_category_husband = 'Switzerland'\n          AND d.citizenship_category_wife = 'Switzerland'\n        GROUP BY su.name\n    ) AS inner_subquery\n);\n"
      },
      {
        "question": "In which year did the canton of Vaud experience the highest number of divorces between Swiss couples who were married for 15-19 years?",
        "query": "SELECT year, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE su.spatialunit_uid = '22_A.ADM1'\n  AND duration_of_marriage = '15-19 years'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY year\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "In which year between 1996 and 2017 did the canton of Graub\u00fcnden experience the biggest difference in the percentage of total divorces between Swiss couples and couples where at least one partner was not Swiss?",
        "query": "WITH swiss AS (\n  SELECT year,\n         SUM(amount) AS swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n),\nnot_swiss AS (\n  SELECT year,\n         SUM(amount) AS not_swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n)\nSELECT swiss.year,\n       COALESCE(swiss.swiss_divorces, 0) AS swiss_divorces,\n       COALESCE(not_swiss.not_swiss_divorces, 0) AS not_swiss_divorces,\n       ABS(100.0 * COALESCE(swiss.swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0))\n          - 100.0 * COALESCE(not_swiss.not_swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0)))\n           AS percentage_difference\nFROM swiss JOIN not_swiss ON swiss.year = not_swiss.year\nORDER BY percentage_difference DESC\nLIMIT 1;\n"
      },
      {
        "question": "In 1995, which municipality had the highest number of divorces between Swiss couples who were married for 10-14 years?",
        "query": "SELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE duration_of_marriage = '10-14 years'\n  AND year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "How did the total number of divorces between Swiss couples compare between the cantons of Zurich and Geneva in the year 1995?",
        "query": "SELECT su.spatialunit_uid, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND (su.spatialunit_uid = '1_A.ADM1' OR su.spatialunit_uid = '25_A.ADM1')\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid;\n"
      },
      {
        "question": "How did the total number of divorces between Swiss couples compare between the cantons of Zurich and Geneva in the year 1995?",
        "query": "SELECT su.spatialunit_uid, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND (su.spatialunit_uid = '1_A.ADM1' OR su.spatialunit_uid = '25_A.ADM1')\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid;\n"
      },
      {
        "question": "at which duration of marriage most marriages end in divorce across the entire country for all citizenships?",
        "query": "SELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '0_CH'\n  AND duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "In which year between 1996 and 2017 did the canton of Graub\u00fcnden experience the biggest difference in the percentage of total divorces between Swiss couples and couples where at least one partner was not Swiss?",
        "query": "WITH swiss AS (\n  SELECT year,\n         SUM(amount) AS swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n),\nnot_swiss AS (\n  SELECT year,\n         SUM(amount) AS not_swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n)\nSELECT swiss.year,\n       COALESCE(swiss.swiss_divorces, 0) AS swiss_divorces,\n       COALESCE(not_swiss.not_swiss_divorces, 0) AS not_swiss_divorces,\n       ABS(100.0 * COALESCE(swiss.swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0))\n          - 100.0 * COALESCE(not_swiss.not_swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0)))\n           AS percentage_difference\nFROM swiss JOIN not_swiss ON swiss.year = not_swiss.year\nORDER BY percentage_difference DESC\nLIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_citizenship_categories (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_spatial_un FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_citizenship_categories and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nspatialunit_uid : 249_A.ADM3, 4074_A.ADM3, 410_A.ADM3, 2869_A.ADM3, 67_A.ADM3\nyear : 2015, 1989, 2000, 2009, 1991\namount : 4, 0, 14, 2, 6\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\nduration_of_marriage, duration class of marriage, Duration of marriage - total,10-14 years,20 years or more\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nOver the years 2000 to 2020, which Swiss municipality experienced the largest increase in total divorces, regardless of citizenship status and duration of marriage?\n### SQL query\nWITH yearly_totals AS (\n  SELECT year, su.name, sum(amount) as total_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories AS div\n  JOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 2000 AND 2020\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND su.spatialunit_uid LIKE '%_A.ADM3'\n  GROUP BY year, su.name\n),\nyear_2000 AS (\n  SELECT name, total_divorces\n  FROM yearly_totals WHERE year = 2000\n),\nyear_2020 AS (\n  SELECT name, total_divorces\n  FROM yearly_totals WHERE year = 2020\n)\nSELECT year_2000.name, (year_2020.total_divorces - year_2000.total_divorces) as divorce_increase\nFROM year_2000 JOIN year_2020 ON year_2000.name = year_2020.name\nORDER BY divorce_increase DESC\nLIMIT 1;\n\n### Question\nIn which year did the canton of Vaud experience the highest number of divorces between Swiss couples who were married for 15-19 years?\n### SQL query\nSELECT year, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE su.spatialunit_uid = '22_A.ADM1'\n  AND duration_of_marriage = '15-19 years'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY year\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nat which duration of marriage most marriages end in divorce across the entire country for all citizenships?\n### SQL query\nSELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '0_CH'\n  AND duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nIn which year between 1996 and 2017 did the canton of Graub\u00fcnden experience the biggest difference in the percentage of total divorces between Swiss couples and couples where at least one partner was not Swiss?\n### SQL query\nWITH swiss AS (\n  SELECT year,\n         SUM(amount) AS swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n),\nnot_swiss AS (\n  SELECT year,\n         SUM(amount) AS not_swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n)\nSELECT swiss.year,\n       COALESCE(swiss.swiss_divorces, 0) AS swiss_divorces,\n       COALESCE(not_swiss.not_swiss_divorces, 0) AS not_swiss_divorces,\n       ABS(100.0 * COALESCE(swiss.swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0))\n          - 100.0 * COALESCE(not_swiss.not_swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0)))\n           AS percentage_difference\nFROM swiss JOIN not_swiss ON swiss.year = not_swiss.year\nORDER BY percentage_difference DESC\nLIMIT 1;\n\n\n### Question\nHow many municipalites had zero/the least amount of divorces between swiss couples in the year 2012?\n### SQL query\nSELECT COUNT(*) AS number_of_municipalities\nFROM (\n    SELECT su.name, SUM(d.amount) as total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories AS d\n    JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n    WHERE d.year = 2012\n      AND d.duration_of_marriage = 'Duration of marriage - total'\n      AND su.spatialunit_uid LIKE '%_A.ADM3'\n      AND d.citizenship_category_husband = 'Switzerland'\n      AND d.citizenship_category_wife = 'Switzerland'\n    GROUP BY su.name\n) AS subquery\nWHERE total_divorces = (\n    SELECT MIN(total_divorces)\n    FROM (\n        SELECT su.name, SUM(d.amount) as total_divorces\n        FROM divorces_duration_of_marriage_citizenship_categories AS d\n        JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n        WHERE d.year = 2012\n          AND d.duration_of_marriage = 'Duration of marriage - total'\n          AND su.spatialunit_uid LIKE '%_A.ADM3'\n          AND d.citizenship_category_husband = 'Switzerland'\n          AND d.citizenship_category_wife = 'Switzerland'\n        GROUP BY su.name\n    ) AS inner_subquery\n);\n\n\n### Question\nIn 2010, which municipality had the highest number of divorces between couples who were married for 5-9 years and at least one partner was not Swiss?\n### SQL query\nSELECT su.name, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2010\n  AND duration_of_marriage = '5-9 years'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nHow many municipalites had zero/the least amount of divorces between swiss couples in the year 2012?\n### SQL query\nSELECT COUNT(*) AS number_of_municipalities\nFROM (\n    SELECT su.name, SUM(d.amount) as total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories AS d\n    JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n    WHERE d.year = 2012\n      AND d.duration_of_marriage = 'Duration of marriage - total'\n      AND su.spatialunit_uid LIKE '%_A.ADM3'\n      AND d.citizenship_category_husband = 'Switzerland'\n      AND d.citizenship_category_wife = 'Switzerland'\n    GROUP BY su.name\n) AS subquery\nWHERE total_divorces = (\n    SELECT MIN(total_divorces)\n    FROM (\n        SELECT su.name, SUM(d.amount) as total_divorces\n        FROM divorces_duration_of_marriage_citizenship_categories AS d\n        JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n        WHERE d.year = 2012\n          AND d.duration_of_marriage = 'Duration of marriage - total'\n          AND su.spatialunit_uid LIKE '%_A.ADM3'\n          AND d.citizenship_category_husband = 'Switzerland'\n          AND d.citizenship_category_wife = 'Switzerland'\n        GROUP BY su.name\n    ) AS inner_subquery\n);\n\n\n### Question\nIn which year did the canton of Vaud experience the highest number of divorces between Swiss couples who were married for 15-19 years?\n### SQL query\nSELECT year, sum(amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS div\nJOIN spatial_unit AS su ON div.spatialunit_uid = su.spatialunit_uid\nWHERE su.spatialunit_uid = '22_A.ADM1'\n  AND duration_of_marriage = '15-19 years'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY year\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nIn which year between 1996 and 2017 did the canton of Graub\u00fcnden experience the biggest difference in the percentage of total divorces between Swiss couples and couples where at least one partner was not Swiss?\n### SQL query\nWITH swiss AS (\n  SELECT year,\n         SUM(amount) AS swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n),\nnot_swiss AS (\n  SELECT year,\n         SUM(amount) AS not_swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n)\nSELECT swiss.year,\n       COALESCE(swiss.swiss_divorces, 0) AS swiss_divorces,\n       COALESCE(not_swiss.not_swiss_divorces, 0) AS not_swiss_divorces,\n       ABS(100.0 * COALESCE(swiss.swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0))\n          - 100.0 * COALESCE(not_swiss.not_swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0)))\n           AS percentage_difference\nFROM swiss JOIN not_swiss ON swiss.year = not_swiss.year\nORDER BY percentage_difference DESC\nLIMIT 1;\n\n\n### Question\nIn 1995, which municipality had the highest number of divorces between Swiss couples who were married for 10-14 years?\n### SQL query\nSELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE duration_of_marriage = '10-14 years'\n  AND year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nHow did the total number of divorces between Swiss couples compare between the cantons of Zurich and Geneva in the year 1995?\n### SQL query\nSELECT su.spatialunit_uid, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND (su.spatialunit_uid = '1_A.ADM1' OR su.spatialunit_uid = '25_A.ADM1')\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid;\n\n\n### Question\nHow did the total number of divorces between Swiss couples compare between the cantons of Zurich and Geneva in the year 1995?\n### SQL query\nSELECT su.spatialunit_uid, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND (su.spatialunit_uid = '1_A.ADM1' OR su.spatialunit_uid = '25_A.ADM1')\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid;\n\n\n### Question\nat which duration of marriage most marriages end in divorce across the entire country for all citizenships?\n### SQL query\nSELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '0_CH'\n  AND duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nIn which year between 1996 and 2017 did the canton of Graub\u00fcnden experience the biggest difference in the percentage of total divorces between Swiss couples and couples where at least one partner was not Swiss?\n### SQL query\nWITH swiss AS (\n  SELECT year,\n         SUM(amount) AS swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n),\nnot_swiss AS (\n  SELECT year,\n         SUM(amount) AS not_swiss_divorces\n  FROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage = 'Duration of marriage - total'\n    AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\n    AND year BETWEEN 1996 AND 2017\n    AND spatialunit_uid = '18_A.ADM1'\n  GROUP BY year\n)\nSELECT swiss.year,\n       COALESCE(swiss.swiss_divorces, 0) AS swiss_divorces,\n       COALESCE(not_swiss.not_swiss_divorces, 0) AS not_swiss_divorces,\n       ABS(100.0 * COALESCE(swiss.swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0))\n          - 100.0 * COALESCE(not_swiss.not_swiss_divorces, 0) / (COALESCE(swiss.swiss_divorces, 0) + COALESCE(not_swiss.not_swiss_divorces, 0)))\n           AS percentage_difference\nFROM swiss JOIN not_swiss ON swiss.year = not_swiss.year\nORDER BY percentage_difference DESC\nLIMIT 1;\n\n\n### Question\nHow has the number of divorces for Swiss couples changed from 1990 to 2000?\n### SQL query\n",
    "process_time": 8.09648257214576,
    "num_tokens": 4372,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 43,
    "question": "Which municipality had the highest number of divorces in 1995 between Swiss couples?",
    "query": "SELECT su.name, d.year, SUM(d.amount) as total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE d.year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND d.duration_of_marriage = 'Duration of marriage - total'\n  AND d.citizenship_category_husband = 'Switzerland'\n  AND d.citizenship_category_wife = 'Switzerland'\nGROUP BY su.name, d.year\nORDER BY total_divorces DESC\nLIMIT 1;\n",
    "db_id": "divorces_duration_of_marriage_citizenship_categories",
    "generated_query": "SELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND su.spatialunit_uid LIKE '%_A.ADM3'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.name\nORDER BY total_divorces DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "How many municipalites had zero/the least amount of divorces between swiss couples in the year 2012?",
        "query": "SELECT COUNT(*) AS number_of_municipalities\nFROM (\n    SELECT su.name, SUM(d.amount) as total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories AS d\n    JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n    WHERE d.year = 2012\n      AND d.duration_of_marriage = 'Duration of marriage - total'\n      AND su.spatialunit_uid LIKE '%_A.ADM3'\n      AND d.citizenship_category_husband = 'Switzerland'\n      AND d.citizenship_category_wife = 'Switzerland'\n    GROUP BY su.name\n) AS subquery\nWHERE total_divorces = (\n    SELECT MIN(total_divorces)\n    FROM (\n        SELECT su.name, SUM(d.amount) as total_divorces\n        FROM divorces_duration_of_marriage_citizenship_categories AS d\n        JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n        WHERE d.year = 2012\n          AND d.duration_of_marriage = 'Duration of marriage - total'\n          AND su.spatialunit_uid LIKE '%_A.ADM3'\n          AND d.citizenship_category_husband = 'Switzerland'\n          AND d.citizenship_category_wife = 'Switzerland'\n        GROUP BY su.name\n    ) AS inner_subquery\n);\n"
      },
      {
        "question": "at which duration of marriage most marriages end in divorce across the entire country for all citizenships?",
        "query": "SELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '0_CH'\n  AND duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "How did the total number of divorces between Swiss couples compare between the cantons of Zurich and Geneva in the year 1995?",
        "query": "SELECT su.spatialunit_uid, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND (su.spatialunit_uid = '1_A.ADM1' OR su.spatialunit_uid = '25_A.ADM1')\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid;\n"
      },
      {
        "question": "What is the average number of divorces per year between 1990 and 2000 in Switzerland among Swiss couples?",
        "query": "SELECT AVG(total) as average_divorces_per_year\nFROM (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '0_CH'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n) as subquery;\n"
      },
      {
        "question": "In which year between 1990 and 2000 did the canton of zurich have more divorces between Swiss couples than the canton of geneva?",
        "query": "WITH zurich AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '1_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n),\ngeneva AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '25_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n)\nSELECT z.year\nFROM zurich AS z\nJOIN geneva AS g ON z.year = g.year\nWHERE z.total > g.total;\n"
      },
      {
        "question": "How did the total number of divorces between Swiss couples compare between the cantons of Zurich and Geneva in the year 1995?",
        "query": "SELECT su.spatialunit_uid, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND (su.spatialunit_uid = '1_A.ADM1' OR su.spatialunit_uid = '25_A.ADM1')\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid;\n"
      },
      {
        "question": "In which year between 1990 and 2000 did the canton of zurich have more divorces between Swiss couples than the canton of geneva?",
        "query": "WITH zurich AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '1_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n),\ngeneva AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '25_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n)\nSELECT z.year\nFROM zurich AS z\nJOIN geneva AS g ON z.year = g.year\nWHERE z.total > g.total;\n"
      },
      {
        "question": "How many municipalites had zero/the least amount of divorces between swiss couples in the year 2012?",
        "query": "SELECT COUNT(*) AS number_of_municipalities\nFROM (\n    SELECT su.name, SUM(d.amount) as total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories AS d\n    JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n    WHERE d.year = 2012\n      AND d.duration_of_marriage = 'Duration of marriage - total'\n      AND su.spatialunit_uid LIKE '%_A.ADM3'\n      AND d.citizenship_category_husband = 'Switzerland'\n      AND d.citizenship_category_wife = 'Switzerland'\n    GROUP BY su.name\n) AS subquery\nWHERE total_divorces = (\n    SELECT MIN(total_divorces)\n    FROM (\n        SELECT su.name, SUM(d.amount) as total_divorces\n        FROM divorces_duration_of_marriage_citizenship_categories AS d\n        JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n        WHERE d.year = 2012\n          AND d.duration_of_marriage = 'Duration of marriage - total'\n          AND su.spatialunit_uid LIKE '%_A.ADM3'\n          AND d.citizenship_category_husband = 'Switzerland'\n          AND d.citizenship_category_wife = 'Switzerland'\n        GROUP BY su.name\n    ) AS inner_subquery\n);\n"
      },
      {
        "question": "What is the average number of divorces per year between 1990 and 2000 in Switzerland among Swiss couples?",
        "query": "SELECT AVG(total) as average_divorces_per_year\nFROM (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '0_CH'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n) as subquery;\n"
      },
      {
        "question": "How did the total number of divorces between Swiss couples compare between the cantons of Zurich and Geneva in the year 1995?",
        "query": "SELECT su.spatialunit_uid, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND (su.spatialunit_uid = '1_A.ADM1' OR su.spatialunit_uid = '25_A.ADM1')\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid;\n"
      },
      {
        "question": "Is there a year where the Canton of Appenzell Innerrhoden had more divorces than the canton of Appenzell Ausserrhoden (in the years 2000 between 2015)?\t\"",
        "query": "SELECT innerrhoden.year, innerrhoden.total_divorces AS innerrhoden_divorces, ausserrhoden.total_divorces AS ausserrhoden_divorces\nFROM (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '16_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS innerrhoden\nJOIN (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '15_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS ausserrhoden ON innerrhoden.year = ausserrhoden.year\nWHERE innerrhoden.total_divorces > ausserrhoden.total_divorces;\n"
      },
      {
        "question": "Is there a year where the Canton of Appenzell Innerrhoden had more divorces than the canton of Appenzell Ausserrhoden (in the years 2000 between 2015)?\t\"",
        "query": "SELECT innerrhoden.year, innerrhoden.total_divorces AS innerrhoden_divorces, ausserrhoden.total_divorces AS ausserrhoden_divorces\nFROM (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '16_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS innerrhoden\nJOIN (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '15_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS ausserrhoden ON innerrhoden.year = ausserrhoden.year\nWHERE innerrhoden.total_divorces > ausserrhoden.total_divorces;\n"
      },
      {
        "question": "At what duration of marriage do most divorces occur?",
        "query": "SELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n"
      },
      {
        "question": "Which canton had the least divorces in 2000 between couples where at least one partner is a foreigner?",
        "query": "SELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2000\n  AND su.spatialunit_uid LIKE '%_A.ADM1'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\nGROUP BY su.name\nORDER BY total_divorces ASC\nLIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.divorces_duration_of_marriage_citizenship_categories (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tduration_of_marriage VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_pk PRIMARY KEY (uid), \n\tCONSTRAINT divorces_duration_of_marriage_citizenship_categories_spatial_un FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in divorces_duration_of_marriage_citizenship_categories and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nspatialunit_uid : 249_A.ADM3, 4074_A.ADM3, 410_A.ADM3, 2869_A.ADM3, 67_A.ADM3\nyear : 2015, 1989, 2000, 2009, 1991\namount : 4, 0, 14, 2, 6\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\nduration_of_marriage, duration class of marriage, Duration of marriage - total,10-14 years,20 years or more\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nHow many municipalites had zero/the least amount of divorces between swiss couples in the year 2012?\n### SQL query\nSELECT COUNT(*) AS number_of_municipalities\nFROM (\n    SELECT su.name, SUM(d.amount) as total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories AS d\n    JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n    WHERE d.year = 2012\n      AND d.duration_of_marriage = 'Duration of marriage - total'\n      AND su.spatialunit_uid LIKE '%_A.ADM3'\n      AND d.citizenship_category_husband = 'Switzerland'\n      AND d.citizenship_category_wife = 'Switzerland'\n    GROUP BY su.name\n) AS subquery\nWHERE total_divorces = (\n    SELECT MIN(total_divorces)\n    FROM (\n        SELECT su.name, SUM(d.amount) as total_divorces\n        FROM divorces_duration_of_marriage_citizenship_categories AS d\n        JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n        WHERE d.year = 2012\n          AND d.duration_of_marriage = 'Duration of marriage - total'\n          AND su.spatialunit_uid LIKE '%_A.ADM3'\n          AND d.citizenship_category_husband = 'Switzerland'\n          AND d.citizenship_category_wife = 'Switzerland'\n        GROUP BY su.name\n    ) AS inner_subquery\n);\n\n\n### Question\nat which duration of marriage most marriages end in divorce across the entire country for all citizenships?\n### SQL query\nSELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '0_CH'\n  AND duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nHow did the total number of divorces between Swiss couples compare between the cantons of Zurich and Geneva in the year 1995?\n### SQL query\nSELECT su.spatialunit_uid, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND (su.spatialunit_uid = '1_A.ADM1' OR su.spatialunit_uid = '25_A.ADM1')\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid;\n\n\n### Question\nWhat is the average number of divorces per year between 1990 and 2000 in Switzerland among Swiss couples?\n### SQL query\nSELECT AVG(total) as average_divorces_per_year\nFROM (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '0_CH'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n) as subquery;\n\n\n### Question\nIn which year between 1990 and 2000 did the canton of zurich have more divorces between Swiss couples than the canton of geneva?\n### SQL query\nWITH zurich AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '1_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n),\ngeneva AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '25_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n)\nSELECT z.year\nFROM zurich AS z\nJOIN geneva AS g ON z.year = g.year\nWHERE z.total > g.total;\n\n\n### Question\nHow did the total number of divorces between Swiss couples compare between the cantons of Zurich and Geneva in the year 1995?\n### SQL query\nSELECT su.spatialunit_uid, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND (su.spatialunit_uid = '1_A.ADM1' OR su.spatialunit_uid = '25_A.ADM1')\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid;\n\n\n### Question\nIn which year between 1990 and 2000 did the canton of zurich have more divorces between Swiss couples than the canton of geneva?\n### SQL query\nWITH zurich AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '1_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n),\ngeneva AS (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories AS d\n  JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '25_A.ADM1'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n)\nSELECT z.year\nFROM zurich AS z\nJOIN geneva AS g ON z.year = g.year\nWHERE z.total > g.total;\n\n\n### Question\nHow many municipalites had zero/the least amount of divorces between swiss couples in the year 2012?\n### SQL query\nSELECT COUNT(*) AS number_of_municipalities\nFROM (\n    SELECT su.name, SUM(d.amount) as total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories AS d\n    JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n    WHERE d.year = 2012\n      AND d.duration_of_marriage = 'Duration of marriage - total'\n      AND su.spatialunit_uid LIKE '%_A.ADM3'\n      AND d.citizenship_category_husband = 'Switzerland'\n      AND d.citizenship_category_wife = 'Switzerland'\n    GROUP BY su.name\n) AS subquery\nWHERE total_divorces = (\n    SELECT MIN(total_divorces)\n    FROM (\n        SELECT su.name, SUM(d.amount) as total_divorces\n        FROM divorces_duration_of_marriage_citizenship_categories AS d\n        JOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\n        WHERE d.year = 2012\n          AND d.duration_of_marriage = 'Duration of marriage - total'\n          AND su.spatialunit_uid LIKE '%_A.ADM3'\n          AND d.citizenship_category_husband = 'Switzerland'\n          AND d.citizenship_category_wife = 'Switzerland'\n        GROUP BY su.name\n    ) AS inner_subquery\n);\n\n\n### Question\nWhat is the average number of divorces per year between 1990 and 2000 in Switzerland among Swiss couples?\n### SQL query\nSELECT AVG(total) as average_divorces_per_year\nFROM (\n  SELECT year, SUM(amount) as total\n  FROM divorces_duration_of_marriage_citizenship_categories JOIN spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\n  WHERE year BETWEEN 1990 AND 2000\n    AND su.spatialunit_uid = '0_CH'\n    AND duration_of_marriage = 'Duration of marriage - total'\n    AND citizenship_category_husband = 'Switzerland'\n    AND citizenship_category_wife = 'Switzerland'\n  GROUP BY year\n) as subquery;\n\n\n### Question\nHow did the total number of divorces between Swiss couples compare between the cantons of Zurich and Geneva in the year 1995?\n### SQL query\nSELECT su.spatialunit_uid, SUM(amount) as total\nFROM divorces_duration_of_marriage_citizenship_categories join spatial_unit su on divorces_duration_of_marriage_citizenship_categories.spatialunit_uid = su.spatialunit_uid\nWHERE year = 1995\n  AND (su.spatialunit_uid = '1_A.ADM1' OR su.spatialunit_uid = '25_A.ADM1')\n  AND duration_of_marriage = 'Duration of marriage - total'\n  AND citizenship_category_husband = 'Switzerland'\n  AND citizenship_category_wife = 'Switzerland'\nGROUP BY su.spatialunit_uid;\n\n\n### Question\nIs there a year where the Canton of Appenzell Innerrhoden had more divorces than the canton of Appenzell Ausserrhoden (in the years 2000 between 2015)?\t\"\n### SQL query\nSELECT innerrhoden.year, innerrhoden.total_divorces AS innerrhoden_divorces, ausserrhoden.total_divorces AS ausserrhoden_divorces\nFROM (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '16_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS innerrhoden\nJOIN (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '15_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS ausserrhoden ON innerrhoden.year = ausserrhoden.year\nWHERE innerrhoden.total_divorces > ausserrhoden.total_divorces;\n\n\n### Question\nIs there a year where the Canton of Appenzell Innerrhoden had more divorces than the canton of Appenzell Ausserrhoden (in the years 2000 between 2015)?\t\"\n### SQL query\nSELECT innerrhoden.year, innerrhoden.total_divorces AS innerrhoden_divorces, ausserrhoden.total_divorces AS ausserrhoden_divorces\nFROM (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '16_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS innerrhoden\nJOIN (\n    SELECT year, SUM(amount) AS total_divorces\n    FROM divorces_duration_of_marriage_citizenship_categories WHERE spatialunit_uid = '15_A.ADM1'\n      AND duration_of_marriage = 'Duration of marriage - total'\n      AND year BETWEEN 2000 AND 2015\n    GROUP BY year\n) AS ausserrhoden ON innerrhoden.year = ausserrhoden.year\nWHERE innerrhoden.total_divorces > ausserrhoden.total_divorces;\n\n\n### Question\nAt what duration of marriage do most divorces occur?\n### SQL query\nSELECT duration_of_marriage, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories WHERE duration_of_marriage != 'Duration of marriage - total'\nGROUP BY duration_of_marriage\nORDER BY total_divorces DESC\nLIMIT 1;\n\n\n### Question\nWhich canton had the least divorces in 2000 between couples where at least one partner is a foreigner?\n### SQL query\nSELECT su.name, SUM(amount) AS total_divorces\nFROM divorces_duration_of_marriage_citizenship_categories AS d\nJOIN spatial_unit AS su ON d.spatialunit_uid = su.spatialunit_uid\nWHERE year = 2000\n  AND su.spatialunit_uid LIKE '%_A.ADM1'\n  AND (citizenship_category_husband = 'Foreign country' OR citizenship_category_wife = 'Foreign country')\nGROUP BY su.name\nORDER BY total_divorces ASC\nLIMIT 1;\n\n\n### Question\nWhich municipality had the highest number of divorces in 1995 between Swiss couples?\n### SQL query\n",
    "process_time": 8.539672460174188,
    "num_tokens": 3934,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 44,
    "question": "Give me the average number of marriages at the canton level in 2001, where both the husband and wife are citizens of Swiss?",
    "query": "SELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T1.year = 2001  AND T1.citizenship_category_husband = 'Switzerland' AND  T1.citizenship_category_wife = 'Switzerland';\n",
    "db_id": "marriage_citizenship",
    "generated_query": "SELECT AVG(amount) FROM marriage_citizenship\nWHERE year = 2001 AND citizenship_category_husband = 'Switzerland' AND citizenship_category_wife = 'Switzerland'\nGROUP BY spatialunit_uid\nHAVING COUNT(*) > 1;",
    "meta_data": [
      {
        "question": "Give me the 5 highest numbers of marriages that occurred at the canton level in 2010, where both the wife and husband were citizens of foreign countries?",
        "query": "SELECT  T2.name, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T1.year = 2010  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n"
      },
      {
        "question": "In the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?",
        "query": "SELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n"
      },
      {
        "question": "How many marriages occurred in switzerland in the year 2010?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' and T1.year = 2010 and T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total';\n"
      },
      {
        "question": "In the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?",
        "query": "SELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n"
      },
      {
        "question": "which year has the most number of marriage between swiss man and woman from other nationalty in Switzerlan?",
        "query": "SELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.country = 'True'  AND T2.name = 'Switzerland'  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Switzerland'\nORDER BY T1.amount DESC\nLIMIT 1;\n"
      },
      {
        "question": "Show me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?",
        "query": "SELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n"
      },
      {
        "question": "Please provide a summary of the number of marriages for each combination of male and female citizenships in the canton of Zurich since 2000.",
        "query": "SELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%z_rich%'  AND T2.canton = 'True' AND T1.year >= 2000  AND T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total'\nORDER BY T1.year ASC, T1.citizenship_category_wife ASC , T1.citizenship_category_husband ASC;\n"
      },
      {
        "question": "In terms of the number of marriages between two foreigners on 2012, how does Canton Zurich compare to Canton Neuch\u00e2tel?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T1.year = 2012 AND T2.canton = 'True' AND (T2.name  ilike '%z_rich%' OR T2.name  ilike '%Neuch_tel%')  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC;\n"
      },
      {
        "question": "Which five cantons have the highest number of marriages between Swiss men and foreign women on 2011?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n"
      },
      {
        "question": "In the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?",
        "query": "SELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n"
      },
      {
        "question": "In which region are the fewest marriages recorded between Swiss men and foreign women?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' and T1.year = 2018 and T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY  T1.amount ASC\nLIMIT 10;\n"
      },
      {
        "question": "What is the highest number of marriages that occurred at the district level in 2012, where both the wife and husband were citizens of foreign countries?",
        "query": "SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount,T1.citizenship_category_husband,T1.citizenship_category_wife  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.district = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country'  AND T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n"
      },
      {
        "question": "Which five cantons have the highest number of marriages between Swiss men and foreign women on 2011?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n"
      },
      {
        "question": "In terms of the number of marriages between two foreigners on 2012, how does Canton Zurich compare to Canton Neuch\u00e2tel?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T1.year = 2012 AND T2.canton = 'True' AND (T2.name  ilike '%z_rich%' OR T2.name  ilike '%Neuch_tel%')  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC;\n"
      },
      {
        "question": "which year has the most number of marriage between swiss femal and man from other nationalty in canton Argua?",
        "query": "SELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T2.name ilike '%Aargau%'  AND T1.citizenship_category_wife = 'Switzerland' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;"
      },
      {
        "question": "In the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?",
        "query": "SELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.marriage_citizenship (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT marriage_citizenship_pk PRIMARY KEY (uid), \n\tCONSTRAINT marriage_citizenship_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in marriage_citizenship and 5 examples in each column for high cardinality columns :\nuid : 563962, 564122, 564042, 564067, 564123\nspatialunit_uid : 6620_A.ADM3, 3746_A.ADM3, 103_A.ADM2, 4063_A.ADM3, 4065_A.ADM3\nyear : 2015, 1988, 2009, 2000, 2012\namount : 4, 27, 252, 18, 59\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nGive me the 5 highest numbers of marriages that occurred at the canton level in 2010, where both the wife and husband were citizens of foreign countries?\n### SQL query\nSELECT  T2.name, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T1.year = 2010  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n\n\n### Question\nIn the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?\n### SQL query\nSELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n\n\n### Question\nHow many marriages occurred in switzerland in the year 2010?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' and T1.year = 2010 and T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total';\n\n\n### Question\nIn the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?\n### SQL query\nSELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n\n\n### Question\nwhich year has the most number of marriage between swiss man and woman from other nationalty in Switzerlan?\n### SQL query\nSELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.country = 'True'  AND T2.name = 'Switzerland'  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Switzerland'\nORDER BY T1.amount DESC\nLIMIT 1;\n\n\n### Question\nShow me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?\n### SQL query\nSELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n\n\n### Question\nPlease provide a summary of the number of marriages for each combination of male and female citizenships in the canton of Zurich since 2000.\n### SQL query\nSELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%z_rich%'  AND T2.canton = 'True' AND T1.year >= 2000  AND T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total'\nORDER BY T1.year ASC, T1.citizenship_category_wife ASC , T1.citizenship_category_husband ASC;\n\n\n### Question\nIn terms of the number of marriages between two foreigners on 2012, how does Canton Zurich compare to Canton Neuch\u00e2tel?\n### SQL query\nSELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T1.year = 2012 AND T2.canton = 'True' AND (T2.name  ilike '%z_rich%' OR T2.name  ilike '%Neuch_tel%')  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC;\n\n\n### Question\nWhich five cantons have the highest number of marriages between Swiss men and foreign women on 2011?\n### SQL query\nSELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n\n\n### Question\nIn the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?\n### SQL query\nSELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n\n\n### Question\nIn which region are the fewest marriages recorded between Swiss men and foreign women?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' and T1.year = 2018 and T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY  T1.amount ASC\nLIMIT 10;\n\n\n### Question\nWhat is the highest number of marriages that occurred at the district level in 2012, where both the wife and husband were citizens of foreign countries?\n### SQL query\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount,T1.citizenship_category_husband,T1.citizenship_category_wife  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.district = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country'  AND T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n\n\n### Question\nWhich five cantons have the highest number of marriages between Swiss men and foreign women on 2011?\n### SQL query\nSELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n\n\n### Question\nIn terms of the number of marriages between two foreigners on 2012, how does Canton Zurich compare to Canton Neuch\u00e2tel?\n### SQL query\nSELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T1.year = 2012 AND T2.canton = 'True' AND (T2.name  ilike '%z_rich%' OR T2.name  ilike '%Neuch_tel%')  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC;\n\n\n### Question\nwhich year has the most number of marriage between swiss femal and man from other nationalty in canton Argua?\n### SQL query\nSELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T2.name ilike '%Aargau%'  AND T1.citizenship_category_wife = 'Switzerland' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n\n### Question\nIn the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?\n### SQL query\nSELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n\n\n### Question\nGive me the average number of marriages at the canton level in 2001, where both the husband and wife are citizens of Swiss?\n### SQL query\n",
    "process_time": 4.233339569997042,
    "num_tokens": 3490,
    "hardness": "medium",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 45,
    "question": "Give me the minimum , maximum and average number of marriages at the municipal level in 2011, where both the husband and wife are citizens of foreign countries?",
    "query": "SELECT  MIN(T1.amount),Max(T1.amount),AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2011  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Foreign country';\n",
    "db_id": "marriage_citizenship",
    "generated_query": "SELECT MIN(amount) AS min_marriages, MAX(amount) AS max_marriages, AVG(amount) AS avg_marriages FROM marriage_citizenship\nWHERE year = 2011 AND citizenship_category_husband = 'Foreign country' AND citizenship_category_wife = 'Foreign country'\nGROUP BY year;",
    "meta_data": [
      {
        "question": "Please provide a summary of the number of marriages for each combination of male and female citizenships in the canton of Zurich since 2000.",
        "query": "SELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%z_rich%'  AND T2.canton = 'True' AND T1.year >= 2000  AND T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total'\nORDER BY T1.year ASC, T1.citizenship_category_wife ASC , T1.citizenship_category_husband ASC;\n"
      },
      {
        "question": "Give me the 5 highest numbers of marriages that occurred at the canton level in 2010, where both the wife and husband were citizens of foreign countries?",
        "query": "SELECT  T2.name, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T1.year = 2010  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n"
      },
      {
        "question": "Show me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?",
        "query": "SELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n"
      },
      {
        "question": "How many marriages occurred in switzerland in the year 2010?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' and T1.year = 2010 and T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total';\n"
      },
      {
        "question": "How many marriages occurred in switzerland in the year 2010?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' and T1.year = 2010 and T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total';\n"
      },
      {
        "question": "In the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?",
        "query": "SELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n"
      },
      {
        "question": "In which region are the fewest marriages recorded between Swiss men and foreign women?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' and T1.year = 2018 and T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY  T1.amount ASC\nLIMIT 10;\n"
      },
      {
        "question": "What is the highest number of marriages that occurred at the district level in 2012, where both the wife and husband were citizens of foreign countries?",
        "query": "SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount,T1.citizenship_category_husband,T1.citizenship_category_wife  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.district = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country'  AND T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n"
      },
      {
        "question": "How many marriages occurred in Oberdorf (BL) each year?",
        "query": "SELECT T2.name, T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%Oberdorf (BL)%' AND T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.year ASC;\n"
      },
      {
        "question": "In the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?",
        "query": "SELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n"
      },
      {
        "question": "How many marriages occurred in Heitenried in the year 2008 for individuals of different nationalities?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Heitenried%' and T1.year = 2008  and T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total';\n"
      },
      {
        "question": "Show me the top-10 municipalities with the lowest numbers of marriages that the wives were Swiss citizens on 2016?",
        "query": "SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount   FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_wife = 'Switzerland' AND  T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.amount ASC\nLIMIT 10;\n"
      },
      {
        "question": "How many marriages occurred in Heitenried in the year 2008 for individuals of different nationalities?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Heitenried%' and T1.year = 2008  and T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total';\n"
      },
      {
        "question": "Show me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?",
        "query": "SELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n"
      },
      {
        "question": "In which region are the fewest marriages recorded between Swiss men and foreign women?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' and T1.year = 2018 and T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY  T1.amount ASC\nLIMIT 10;\n"
      },
      {
        "question": "In the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?",
        "query": "SELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.marriage_citizenship (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT marriage_citizenship_pk PRIMARY KEY (uid), \n\tCONSTRAINT marriage_citizenship_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in marriage_citizenship and 5 examples in each column for high cardinality columns :\nuid : 563962, 564122, 564042, 564067, 564123\nspatialunit_uid : 6620_A.ADM3, 3746_A.ADM3, 103_A.ADM2, 4063_A.ADM3, 4065_A.ADM3\nyear : 2015, 1988, 2009, 2000, 2012\namount : 4, 27, 252, 18, 59\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nPlease provide a summary of the number of marriages for each combination of male and female citizenships in the canton of Zurich since 2000.\n### SQL query\nSELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%z_rich%'  AND T2.canton = 'True' AND T1.year >= 2000  AND T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total'\nORDER BY T1.year ASC, T1.citizenship_category_wife ASC , T1.citizenship_category_husband ASC;\n\n\n### Question\nGive me the 5 highest numbers of marriages that occurred at the canton level in 2010, where both the wife and husband were citizens of foreign countries?\n### SQL query\nSELECT  T2.name, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T1.year = 2010  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n\n\n### Question\nShow me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?\n### SQL query\nSELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n\n\n### Question\nHow many marriages occurred in switzerland in the year 2010?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' and T1.year = 2010 and T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total';\n\n\n### Question\nHow many marriages occurred in switzerland in the year 2010?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' and T1.year = 2010 and T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total';\n\n\n### Question\nIn the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?\n### SQL query\nSELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n\n\n### Question\nIn which region are the fewest marriages recorded between Swiss men and foreign women?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' and T1.year = 2018 and T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY  T1.amount ASC\nLIMIT 10;\n\n\n### Question\nWhat is the highest number of marriages that occurred at the district level in 2012, where both the wife and husband were citizens of foreign countries?\n### SQL query\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount,T1.citizenship_category_husband,T1.citizenship_category_wife  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.district = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country'  AND T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n\n\n### Question\nHow many marriages occurred in Oberdorf (BL) each year?\n### SQL query\nSELECT T2.name, T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%Oberdorf (BL)%' AND T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.year ASC;\n\n\n### Question\nIn the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?\n### SQL query\nSELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n\n\n### Question\nHow many marriages occurred in Heitenried in the year 2008 for individuals of different nationalities?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Heitenried%' and T1.year = 2008  and T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total';\n\n\n### Question\nShow me the top-10 municipalities with the lowest numbers of marriages that the wives were Swiss citizens on 2016?\n### SQL query\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount   FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_wife = 'Switzerland' AND  T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.amount ASC\nLIMIT 10;\n\n\n### Question\nHow many marriages occurred in Heitenried in the year 2008 for individuals of different nationalities?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Heitenried%' and T1.year = 2008  and T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total';\n\n\n### Question\nShow me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?\n### SQL query\nSELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n\n\n### Question\nIn which region are the fewest marriages recorded between Swiss men and foreign women?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' and T1.year = 2018 and T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY  T1.amount ASC\nLIMIT 10;\n\n\n### Question\nIn the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?\n### SQL query\nSELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n\n\n### Question\nGive me the minimum , maximum and average number of marriages at the municipal level in 2011, where both the husband and wife are citizens of foreign countries?\n### SQL query\n",
    "process_time": 5.339133717818186,
    "num_tokens": 3559,
    "hardness": "hard",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 46,
    "question": "In 2006, what were the top 10 cantons with the highest number of marriages where the grooms were Swiss nationals?",
    "query": "SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount   FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Switzerland' AND  T1.citizenship_category_wife = 'Citizenship of wife - total'\nORDER BY T1.amount DESC\nLIMIT 10;\n",
    "db_id": "marriage_citizenship",
    "generated_query": "SELECT T2.name, T1.citizenship_category_husband, T1.amount\nFROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True'\nAND T1.year = 2006\nAND T1.citizenship_category_husband = 'Switzerland'\nORDER BY T1.amount DESC\nLIMIT 10;",
    "meta_data": [
      {
        "question": "Show me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?",
        "query": "SELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n"
      },
      {
        "question": "In which region are the fewest marriages recorded between Swiss men and foreign women?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' and T1.year = 2018 and T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY  T1.amount ASC\nLIMIT 10;\n"
      },
      {
        "question": "How many marriages occurred in Oberdorf (BL) each year?",
        "query": "SELECT T2.name, T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%Oberdorf (BL)%' AND T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.year ASC;\n"
      },
      {
        "question": "How many marriages occurred in Heitenried in the year 2008 for individuals of different nationalities?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Heitenried%' and T1.year = 2008  and T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total';\n"
      },
      {
        "question": "Show me the top-10 municipalities with the lowest numbers of marriages that the wives were Swiss citizens on 2016?",
        "query": "SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount   FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_wife = 'Switzerland' AND  T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.amount ASC\nLIMIT 10;\n"
      },
      {
        "question": "In which region are the fewest marriages recorded between Swiss men and foreign women?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' and T1.year = 2018 and T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY  T1.amount ASC\nLIMIT 10;\n"
      },
      {
        "question": "In the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?",
        "query": "SELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n"
      },
      {
        "question": "How many marriages occurred in switzerland in the year 2010?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' and T1.year = 2010 and T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total';\n"
      },
      {
        "question": "What is the highest number of marriages that occurred at the district level in 2012, where both the wife and husband were citizens of foreign countries?",
        "query": "SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount,T1.citizenship_category_husband,T1.citizenship_category_wife  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.district = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country'  AND T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n"
      },
      {
        "question": "Which five cantons have the highest number of marriages between Swiss men and foreign women on 2011?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n"
      },
      {
        "question": "In the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?",
        "query": "SELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n"
      },
      {
        "question": "Which five cantons have the highest number of marriages between Swiss men and foreign women on 2011?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n"
      },
      {
        "question": "In terms of the number of marriages between two foreigners on 2012, how does Canton Zurich compare to Canton Neuch\u00e2tel?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T1.year = 2012 AND T2.canton = 'True' AND (T2.name  ilike '%z_rich%' OR T2.name  ilike '%Neuch_tel%')  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC;\n"
      },
      {
        "question": "In 2000, among the municipalities, which had the highest and lowest numbers of marriages where the husbands were Swiss citizens?",
        "query": "(SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT Max(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1)\nUNION ALL\n(\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT MIN(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1);\n"
      },
      {
        "question": "What is the number of marriages in Reichenbach im Kandertal in 2020 where both the wife and husband are citizens of foreign countries?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Reichenbach im Kandertal%' and T1.year = 2020 and T1.citizenship_category_husband = 'Foreign country' and T1.citizenship_category_wife = 'Foreign country';\n"
      },
      {
        "question": "In which region are the fewest marriages recorded between Swiss men and foreign women?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' and T1.year = 2018 and T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY  T1.amount ASC\nLIMIT 10;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.marriage_citizenship (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT marriage_citizenship_pk PRIMARY KEY (uid), \n\tCONSTRAINT marriage_citizenship_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in marriage_citizenship and 5 examples in each column for high cardinality columns :\nuid : 563962, 564122, 564042, 564067, 564123\nspatialunit_uid : 6620_A.ADM3, 3746_A.ADM3, 103_A.ADM2, 4063_A.ADM3, 4065_A.ADM3\nyear : 2015, 1988, 2009, 2000, 2012\namount : 4, 27, 252, 18, 59\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nShow me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?\n### SQL query\nSELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n\n\n### Question\nIn which region are the fewest marriages recorded between Swiss men and foreign women?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' and T1.year = 2018 and T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY  T1.amount ASC\nLIMIT 10;\n\n\n### Question\nHow many marriages occurred in Oberdorf (BL) each year?\n### SQL query\nSELECT T2.name, T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%Oberdorf (BL)%' AND T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.year ASC;\n\n\n### Question\nHow many marriages occurred in Heitenried in the year 2008 for individuals of different nationalities?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Heitenried%' and T1.year = 2008  and T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total';\n\n\n### Question\nShow me the top-10 municipalities with the lowest numbers of marriages that the wives were Swiss citizens on 2016?\n### SQL query\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount   FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_wife = 'Switzerland' AND  T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.amount ASC\nLIMIT 10;\n\n\n### Question\nIn which region are the fewest marriages recorded between Swiss men and foreign women?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' and T1.year = 2018 and T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY  T1.amount ASC\nLIMIT 10;\n\n\n### Question\nIn the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?\n### SQL query\nSELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n\n\n### Question\nHow many marriages occurred in switzerland in the year 2010?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' and T1.year = 2010 and T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total';\n\n\n### Question\nWhat is the highest number of marriages that occurred at the district level in 2012, where both the wife and husband were citizens of foreign countries?\n### SQL query\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount,T1.citizenship_category_husband,T1.citizenship_category_wife  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.district = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country'  AND T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n\n\n### Question\nWhich five cantons have the highest number of marriages between Swiss men and foreign women on 2011?\n### SQL query\nSELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n\n\n### Question\nIn the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?\n### SQL query\nSELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n\n\n### Question\nWhich five cantons have the highest number of marriages between Swiss men and foreign women on 2011?\n### SQL query\nSELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n\n\n### Question\nIn terms of the number of marriages between two foreigners on 2012, how does Canton Zurich compare to Canton Neuch\u00e2tel?\n### SQL query\nSELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T1.year = 2012 AND T2.canton = 'True' AND (T2.name  ilike '%z_rich%' OR T2.name  ilike '%Neuch_tel%')  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC;\n\n\n### Question\nIn 2000, among the municipalities, which had the highest and lowest numbers of marriages where the husbands were Swiss citizens?\n### SQL query\n(SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT Max(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1)\nUNION ALL\n(\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT MIN(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1);\n\n\n### Question\nWhat is the number of marriages in Reichenbach im Kandertal in 2020 where both the wife and husband are citizens of foreign countries?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Reichenbach im Kandertal%' and T1.year = 2020 and T1.citizenship_category_husband = 'Foreign country' and T1.citizenship_category_wife = 'Foreign country';\n\n\n### Question\nIn which region are the fewest marriages recorded between Swiss men and foreign women?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' and T1.year = 2018 and T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY  T1.amount ASC\nLIMIT 10;\n\n\n### Question\nIn 2006, what were the top 10 cantons with the highest number of marriages where the grooms were Swiss nationals?\n### SQL query\n",
    "process_time": 7.258484828984365,
    "num_tokens": 3723,
    "hardness": "extra",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 47,
    "question": "Which canton has the highest number of marriages between Swiss women and Swiss men on 2018?",
    "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' and T1.year = 2018 and T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Switzerland'\nORDER BY  T1.amount DESC\nLIMIT 1;\n",
    "db_id": "marriage_citizenship",
    "generated_query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2018 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Switzerland'\nORDER BY T1.amount DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Give me the 5 highest numbers of marriages that occurred at the canton level in 2010, where both the wife and husband were citizens of foreign countries?",
        "query": "SELECT  T2.name, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T1.year = 2010  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n"
      },
      {
        "question": "which year has the most number of marriage between swiss femal and man from other nationalty in canton Argua?",
        "query": "SELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T2.name ilike '%Aargau%'  AND T1.citizenship_category_wife = 'Switzerland' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;"
      },
      {
        "question": "What is the highest number of marriages that occurred at the district level in 2012, where both the wife and husband were citizens of foreign countries?",
        "query": "SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount,T1.citizenship_category_husband,T1.citizenship_category_wife  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.district = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country'  AND T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n"
      },
      {
        "question": "How many marriages occurred in Oberdorf (BL) each year?",
        "query": "SELECT T2.name, T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%Oberdorf (BL)%' AND T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.year ASC;\n"
      },
      {
        "question": "Which five cantons have the highest number of marriages between Swiss men and foreign women on 2011?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n"
      },
      {
        "question": "How many marriages occurred in Oberdorf (BL) each year?",
        "query": "SELECT T2.name, T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%Oberdorf (BL)%' AND T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.year ASC;\n"
      },
      {
        "question": "Which five cantons have the highest number of marriages between Swiss men and foreign women on 2011?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n"
      },
      {
        "question": "which year has the most number of marriage between swiss femal and man from other nationalty in canton Argua?",
        "query": "SELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T2.name ilike '%Aargau%'  AND T1.citizenship_category_wife = 'Switzerland' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;"
      },
      {
        "question": "How many marriages occurred in switzerland in the year 2010?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' and T1.year = 2010 and T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total';\n"
      },
      {
        "question": "In which region are the fewest marriages recorded between Swiss men and foreign women?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' and T1.year = 2018 and T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY  T1.amount ASC\nLIMIT 10;\n"
      },
      {
        "question": "How many marriages occurred in Heitenried in the year 2008 for individuals of different nationalities?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Heitenried%' and T1.year = 2008  and T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total';\n"
      },
      {
        "question": "How many marriages occurred in Heitenried in the year 2008 for individuals of different nationalities?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Heitenried%' and T1.year = 2008  and T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total';\n"
      },
      {
        "question": "How many marriages occurred in Oberdorf (BL) each year?",
        "query": "SELECT T2.name, T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%Oberdorf (BL)%' AND T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.year ASC;\n"
      },
      {
        "question": "Show me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?",
        "query": "SELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n"
      },
      {
        "question": "How many marriages occurred in switzerland in the year 2010?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' and T1.year = 2010 and T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total';\n"
      },
      {
        "question": "Please provide a summary of the number of marriages for each combination of male and female citizenships in the canton of Zurich since 2000.",
        "query": "SELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%z_rich%'  AND T2.canton = 'True' AND T1.year >= 2000  AND T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total'\nORDER BY T1.year ASC, T1.citizenship_category_wife ASC , T1.citizenship_category_husband ASC;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.marriage_citizenship (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT marriage_citizenship_pk PRIMARY KEY (uid), \n\tCONSTRAINT marriage_citizenship_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in marriage_citizenship and 5 examples in each column for high cardinality columns :\nuid : 563962, 564122, 564042, 564067, 564123\nspatialunit_uid : 6620_A.ADM3, 3746_A.ADM3, 103_A.ADM2, 4063_A.ADM3, 4065_A.ADM3\nyear : 2015, 1988, 2009, 2000, 2012\namount : 4, 27, 252, 18, 59\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nGive me the 5 highest numbers of marriages that occurred at the canton level in 2010, where both the wife and husband were citizens of foreign countries?\n### SQL query\nSELECT  T2.name, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T1.year = 2010  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n\n\n### Question\nwhich year has the most number of marriage between swiss femal and man from other nationalty in canton Argua?\n### SQL query\nSELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T2.name ilike '%Aargau%'  AND T1.citizenship_category_wife = 'Switzerland' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n\n### Question\nWhat is the highest number of marriages that occurred at the district level in 2012, where both the wife and husband were citizens of foreign countries?\n### SQL query\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount,T1.citizenship_category_husband,T1.citizenship_category_wife  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.district = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country'  AND T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n\n\n### Question\nHow many marriages occurred in Oberdorf (BL) each year?\n### SQL query\nSELECT T2.name, T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%Oberdorf (BL)%' AND T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.year ASC;\n\n\n### Question\nWhich five cantons have the highest number of marriages between Swiss men and foreign women on 2011?\n### SQL query\nSELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n\n\n### Question\nHow many marriages occurred in Oberdorf (BL) each year?\n### SQL query\nSELECT T2.name, T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%Oberdorf (BL)%' AND T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.year ASC;\n\n\n### Question\nWhich five cantons have the highest number of marriages between Swiss men and foreign women on 2011?\n### SQL query\nSELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n\n\n### Question\nwhich year has the most number of marriage between swiss femal and man from other nationalty in canton Argua?\n### SQL query\nSELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T2.name ilike '%Aargau%'  AND T1.citizenship_category_wife = 'Switzerland' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n\n### Question\nHow many marriages occurred in switzerland in the year 2010?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' and T1.year = 2010 and T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total';\n\n\n### Question\nIn which region are the fewest marriages recorded between Swiss men and foreign women?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' and T1.year = 2018 and T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY  T1.amount ASC\nLIMIT 10;\n\n\n### Question\nHow many marriages occurred in Heitenried in the year 2008 for individuals of different nationalities?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Heitenried%' and T1.year = 2008  and T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total';\n\n\n### Question\nHow many marriages occurred in Heitenried in the year 2008 for individuals of different nationalities?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Heitenried%' and T1.year = 2008  and T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total';\n\n\n### Question\nHow many marriages occurred in Oberdorf (BL) each year?\n### SQL query\nSELECT T2.name, T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%Oberdorf (BL)%' AND T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.year ASC;\n\n\n### Question\nShow me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?\n### SQL query\nSELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n\n\n### Question\nHow many marriages occurred in switzerland in the year 2010?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' and T1.year = 2010 and T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total';\n\n\n### Question\nPlease provide a summary of the number of marriages for each combination of male and female citizenships in the canton of Zurich since 2000.\n### SQL query\nSELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%z_rich%'  AND T2.canton = 'True' AND T1.year >= 2000  AND T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total'\nORDER BY T1.year ASC, T1.citizenship_category_wife ASC , T1.citizenship_category_husband ASC;\n\n\n### Question\nWhich canton has the highest number of marriages between Swiss women and Swiss men on 2018?\n### SQL query\n",
    "process_time": 11.748317382996902,
    "num_tokens": 3431,
    "hardness": "extra",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 48,
    "question": "What are the top five municipalities with the highest number of marriages between Swiss men and foreign women in the year 2018?",
    "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.municipal = 'True' AND T1.year = 2018 AND T1.citizenship_category_husband = 'Foreign country' and T1.citizenship_category_wife = 'Switzerland'\nORDER BY T1.amount DESC\nLIMIT 5;\n",
    "db_id": "marriage_citizenship",
    "generated_query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.municipal = 'True' AND T1.year = 2018 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;",
    "meta_data": [
      {
        "question": "Which five cantons have the highest number of marriages between Swiss men and foreign women on 2011?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n"
      },
      {
        "question": "How many marriages occurred in Heitenried in the year 2008 for individuals of different nationalities?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Heitenried%' and T1.year = 2008  and T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total';\n"
      },
      {
        "question": "Show me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?",
        "query": "SELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n"
      },
      {
        "question": "Please provide a summary of the number of marriages for each combination of male and female citizenships in the canton of Zurich since 2000.",
        "query": "SELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%z_rich%'  AND T2.canton = 'True' AND T1.year >= 2000  AND T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total'\nORDER BY T1.year ASC, T1.citizenship_category_wife ASC , T1.citizenship_category_husband ASC;\n"
      },
      {
        "question": "What is the number of marriages in Reichenbach im Kandertal in 2020 where both the wife and husband are citizens of foreign countries?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Reichenbach im Kandertal%' and T1.year = 2020 and T1.citizenship_category_husband = 'Foreign country' and T1.citizenship_category_wife = 'Foreign country';\n"
      },
      {
        "question": "In terms of the number of marriages between two foreigners on 2012, how does Canton Zurich compare to Canton Neuch\u00e2tel?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T1.year = 2012 AND T2.canton = 'True' AND (T2.name  ilike '%z_rich%' OR T2.name  ilike '%Neuch_tel%')  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC;\n"
      },
      {
        "question": "which year has the most number of marriage between swiss femal and man from other nationalty in canton Argua?",
        "query": "SELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T2.name ilike '%Aargau%'  AND T1.citizenship_category_wife = 'Switzerland' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;"
      },
      {
        "question": "What is the number of marriages in Reichenbach im Kandertal in 2020 where both the wife and husband are citizens of foreign countries?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Reichenbach im Kandertal%' and T1.year = 2020 and T1.citizenship_category_husband = 'Foreign country' and T1.citizenship_category_wife = 'Foreign country';\n"
      },
      {
        "question": "In which region are the fewest marriages recorded between Swiss men and foreign women?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' and T1.year = 2018 and T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY  T1.amount ASC\nLIMIT 10;\n"
      },
      {
        "question": "In 2000, among the municipalities, which had the highest and lowest numbers of marriages where the husbands were Swiss citizens?",
        "query": "(SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT Max(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1)\nUNION ALL\n(\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT MIN(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1);\n"
      },
      {
        "question": "How many marriages occurred in Oberdorf (BL) each year?",
        "query": "SELECT T2.name, T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%Oberdorf (BL)%' AND T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.year ASC;\n"
      },
      {
        "question": "which year has the most number of marriage between swiss femal and man from other nationalty in canton Argua?",
        "query": "SELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T2.name ilike '%Aargau%'  AND T1.citizenship_category_wife = 'Switzerland' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;"
      },
      {
        "question": "In the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?",
        "query": "SELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n"
      },
      {
        "question": "Please provide a summary of the number of marriages for each combination of male and female citizenships in the canton of Zurich since 2000.",
        "query": "SELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%z_rich%'  AND T2.canton = 'True' AND T1.year >= 2000  AND T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total'\nORDER BY T1.year ASC, T1.citizenship_category_wife ASC , T1.citizenship_category_husband ASC;\n"
      },
      {
        "question": "What is the number of marriages in Reichenbach im Kandertal in 2020 where both the wife and husband are citizens of foreign countries?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Reichenbach im Kandertal%' and T1.year = 2020 and T1.citizenship_category_husband = 'Foreign country' and T1.citizenship_category_wife = 'Foreign country';\n"
      },
      {
        "question": "Please provide a summary of the number of marriages for each combination of male and female citizenships in the canton of Zurich since 2000.",
        "query": "SELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%z_rich%'  AND T2.canton = 'True' AND T1.year >= 2000  AND T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total'\nORDER BY T1.year ASC, T1.citizenship_category_wife ASC , T1.citizenship_category_husband ASC;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.marriage_citizenship (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT marriage_citizenship_pk PRIMARY KEY (uid), \n\tCONSTRAINT marriage_citizenship_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in marriage_citizenship and 5 examples in each column for high cardinality columns :\nuid : 563962, 564122, 564042, 564067, 564123\nspatialunit_uid : 6620_A.ADM3, 3746_A.ADM3, 103_A.ADM2, 4063_A.ADM3, 4065_A.ADM3\nyear : 2015, 1988, 2009, 2000, 2012\namount : 4, 27, 252, 18, 59\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWhich five cantons have the highest number of marriages between Swiss men and foreign women on 2011?\n### SQL query\nSELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n\n\n### Question\nHow many marriages occurred in Heitenried in the year 2008 for individuals of different nationalities?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Heitenried%' and T1.year = 2008  and T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total';\n\n\n### Question\nShow me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?\n### SQL query\nSELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n\n\n### Question\nPlease provide a summary of the number of marriages for each combination of male and female citizenships in the canton of Zurich since 2000.\n### SQL query\nSELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%z_rich%'  AND T2.canton = 'True' AND T1.year >= 2000  AND T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total'\nORDER BY T1.year ASC, T1.citizenship_category_wife ASC , T1.citizenship_category_husband ASC;\n\n\n### Question\nWhat is the number of marriages in Reichenbach im Kandertal in 2020 where both the wife and husband are citizens of foreign countries?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Reichenbach im Kandertal%' and T1.year = 2020 and T1.citizenship_category_husband = 'Foreign country' and T1.citizenship_category_wife = 'Foreign country';\n\n\n### Question\nIn terms of the number of marriages between two foreigners on 2012, how does Canton Zurich compare to Canton Neuch\u00e2tel?\n### SQL query\nSELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T1.year = 2012 AND T2.canton = 'True' AND (T2.name  ilike '%z_rich%' OR T2.name  ilike '%Neuch_tel%')  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC;\n\n\n### Question\nwhich year has the most number of marriage between swiss femal and man from other nationalty in canton Argua?\n### SQL query\nSELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T2.name ilike '%Aargau%'  AND T1.citizenship_category_wife = 'Switzerland' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n\n### Question\nWhat is the number of marriages in Reichenbach im Kandertal in 2020 where both the wife and husband are citizens of foreign countries?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Reichenbach im Kandertal%' and T1.year = 2020 and T1.citizenship_category_husband = 'Foreign country' and T1.citizenship_category_wife = 'Foreign country';\n\n\n### Question\nIn which region are the fewest marriages recorded between Swiss men and foreign women?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' and T1.year = 2018 and T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY  T1.amount ASC\nLIMIT 10;\n\n\n### Question\nIn 2000, among the municipalities, which had the highest and lowest numbers of marriages where the husbands were Swiss citizens?\n### SQL query\n(SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT Max(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1)\nUNION ALL\n(\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT MIN(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1);\n\n\n### Question\nHow many marriages occurred in Oberdorf (BL) each year?\n### SQL query\nSELECT T2.name, T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%Oberdorf (BL)%' AND T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.year ASC;\n\n\n### Question\nwhich year has the most number of marriage between swiss femal and man from other nationalty in canton Argua?\n### SQL query\nSELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T2.name ilike '%Aargau%'  AND T1.citizenship_category_wife = 'Switzerland' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n\n### Question\nIn the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?\n### SQL query\nSELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n\n\n### Question\nPlease provide a summary of the number of marriages for each combination of male and female citizenships in the canton of Zurich since 2000.\n### SQL query\nSELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%z_rich%'  AND T2.canton = 'True' AND T1.year >= 2000  AND T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total'\nORDER BY T1.year ASC, T1.citizenship_category_wife ASC , T1.citizenship_category_husband ASC;\n\n\n### Question\nWhat is the number of marriages in Reichenbach im Kandertal in 2020 where both the wife and husband are citizens of foreign countries?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Reichenbach im Kandertal%' and T1.year = 2020 and T1.citizenship_category_husband = 'Foreign country' and T1.citizenship_category_wife = 'Foreign country';\n\n\n### Question\nPlease provide a summary of the number of marriages for each combination of male and female citizenships in the canton of Zurich since 2000.\n### SQL query\nSELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%z_rich%'  AND T2.canton = 'True' AND T1.year >= 2000  AND T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total'\nORDER BY T1.year ASC, T1.citizenship_category_wife ASC , T1.citizenship_category_husband ASC;\n\n\n### Question\nWhat are the top five municipalities with the highest number of marriages between Swiss men and foreign women in the year 2018?\n### SQL query\n",
    "process_time": 10.78196715307422,
    "num_tokens": 3917,
    "hardness": "extra",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 49,
    "question": "In 2012, how many marriages took place in the District of Affoltern, categorized by the citizenships of the wives and husbands involved?",
    "query": "SELECT T2.name,T1.citizenship_category_husband ,T1.citizenship_category_wife , T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.district = 'True' AND T1.year = 2010  AND T2.name ilike '%Affoltern%' AND T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total';\n",
    "db_id": "marriage_citizenship",
    "generated_query": "SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.spatialunit_ontology = 'A.ADM3' AND T2.name ilike '%Affoltern%' AND T1.year = 2012;",
    "meta_data": [
      {
        "question": "How many marriages occurred in Oberdorf (BL) each year?",
        "query": "SELECT T2.name, T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%Oberdorf (BL)%' AND T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.year ASC;\n"
      },
      {
        "question": "What is the number of marriages in Reichenbach im Kandertal in 2020 where both the wife and husband are citizens of foreign countries?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Reichenbach im Kandertal%' and T1.year = 2020 and T1.citizenship_category_husband = 'Foreign country' and T1.citizenship_category_wife = 'Foreign country';\n"
      },
      {
        "question": "Which five cantons have the highest number of marriages between Swiss men and foreign women on 2011?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n"
      },
      {
        "question": "In terms of the number of marriages between two foreigners on 2012, how does Canton Zurich compare to Canton Neuch\u00e2tel?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T1.year = 2012 AND T2.canton = 'True' AND (T2.name  ilike '%z_rich%' OR T2.name  ilike '%Neuch_tel%')  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC;\n"
      },
      {
        "question": "Show me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?",
        "query": "SELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n"
      },
      {
        "question": "What is the number of marriages in Reichenbach im Kandertal in 2020 where both the wife and husband are citizens of foreign countries?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Reichenbach im Kandertal%' and T1.year = 2020 and T1.citizenship_category_husband = 'Foreign country' and T1.citizenship_category_wife = 'Foreign country';\n"
      },
      {
        "question": "which year has the most number of marriage between swiss femal and man from other nationalty in canton Argua?",
        "query": "SELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T2.name ilike '%Aargau%'  AND T1.citizenship_category_wife = 'Switzerland' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;"
      },
      {
        "question": "Which five cantons have the highest number of marriages between Swiss men and foreign women on 2011?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n"
      },
      {
        "question": "What is the highest number of marriages that occurred at the district level in 2012, where both the wife and husband were citizens of foreign countries?",
        "query": "SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount,T1.citizenship_category_husband,T1.citizenship_category_wife  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.district = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country'  AND T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n"
      },
      {
        "question": "In the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?",
        "query": "SELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n"
      },
      {
        "question": "What is the highest number of marriages that occurred at the district level in 2012, where both the wife and husband were citizens of foreign countries?",
        "query": "SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount,T1.citizenship_category_husband,T1.citizenship_category_wife  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.district = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country'  AND T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n"
      },
      {
        "question": "Give me the 5 highest numbers of marriages that occurred at the canton level in 2010, where both the wife and husband were citizens of foreign countries?",
        "query": "SELECT  T2.name, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T1.year = 2010  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n"
      },
      {
        "question": "What is the highest number of marriages that occurred at the district level in 2012, where both the wife and husband were citizens of foreign countries?",
        "query": "SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount,T1.citizenship_category_husband,T1.citizenship_category_wife  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.district = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country'  AND T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n"
      },
      {
        "question": "In terms of the number of marriages between two foreigners on 2012, how does Canton Zurich compare to Canton Neuch\u00e2tel?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T1.year = 2012 AND T2.canton = 'True' AND (T2.name  ilike '%z_rich%' OR T2.name  ilike '%Neuch_tel%')  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC;\n"
      },
      {
        "question": "In terms of the number of marriages between two foreigners on 2012, how does Canton Zurich compare to Canton Neuch\u00e2tel?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T1.year = 2012 AND T2.canton = 'True' AND (T2.name  ilike '%z_rich%' OR T2.name  ilike '%Neuch_tel%')  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC;\n"
      },
      {
        "question": "What is the number of marriages in Reichenbach im Kandertal in 2020 where both the wife and husband are citizens of foreign countries?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Reichenbach im Kandertal%' and T1.year = 2020 and T1.citizenship_category_husband = 'Foreign country' and T1.citizenship_category_wife = 'Foreign country';\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.marriage_citizenship (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT marriage_citizenship_pk PRIMARY KEY (uid), \n\tCONSTRAINT marriage_citizenship_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in marriage_citizenship and 5 examples in each column for high cardinality columns :\nuid : 563962, 564122, 564042, 564067, 564123\nspatialunit_uid : 6620_A.ADM3, 3746_A.ADM3, 103_A.ADM2, 4063_A.ADM3, 4065_A.ADM3\nyear : 2015, 1988, 2009, 2000, 2012\namount : 4, 27, 252, 18, 59\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nHow many marriages occurred in Oberdorf (BL) each year?\n### SQL query\nSELECT T2.name, T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%Oberdorf (BL)%' AND T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.year ASC;\n\n\n### Question\nWhat is the number of marriages in Reichenbach im Kandertal in 2020 where both the wife and husband are citizens of foreign countries?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Reichenbach im Kandertal%' and T1.year = 2020 and T1.citizenship_category_husband = 'Foreign country' and T1.citizenship_category_wife = 'Foreign country';\n\n\n### Question\nWhich five cantons have the highest number of marriages between Swiss men and foreign women on 2011?\n### SQL query\nSELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n\n\n### Question\nIn terms of the number of marriages between two foreigners on 2012, how does Canton Zurich compare to Canton Neuch\u00e2tel?\n### SQL query\nSELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T1.year = 2012 AND T2.canton = 'True' AND (T2.name  ilike '%z_rich%' OR T2.name  ilike '%Neuch_tel%')  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC;\n\n\n### Question\nShow me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?\n### SQL query\nSELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n\n\n### Question\nWhat is the number of marriages in Reichenbach im Kandertal in 2020 where both the wife and husband are citizens of foreign countries?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Reichenbach im Kandertal%' and T1.year = 2020 and T1.citizenship_category_husband = 'Foreign country' and T1.citizenship_category_wife = 'Foreign country';\n\n\n### Question\nwhich year has the most number of marriage between swiss femal and man from other nationalty in canton Argua?\n### SQL query\nSELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T2.name ilike '%Aargau%'  AND T1.citizenship_category_wife = 'Switzerland' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n\n### Question\nWhich five cantons have the highest number of marriages between Swiss men and foreign women on 2011?\n### SQL query\nSELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n\n\n### Question\nWhat is the highest number of marriages that occurred at the district level in 2012, where both the wife and husband were citizens of foreign countries?\n### SQL query\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount,T1.citizenship_category_husband,T1.citizenship_category_wife  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.district = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country'  AND T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n\n\n### Question\nIn the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?\n### SQL query\nSELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n\n\n### Question\nWhat is the highest number of marriages that occurred at the district level in 2012, where both the wife and husband were citizens of foreign countries?\n### SQL query\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount,T1.citizenship_category_husband,T1.citizenship_category_wife  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.district = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country'  AND T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n\n\n### Question\nGive me the 5 highest numbers of marriages that occurred at the canton level in 2010, where both the wife and husband were citizens of foreign countries?\n### SQL query\nSELECT  T2.name, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T1.year = 2010  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n\n\n### Question\nWhat is the highest number of marriages that occurred at the district level in 2012, where both the wife and husband were citizens of foreign countries?\n### SQL query\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount,T1.citizenship_category_husband,T1.citizenship_category_wife  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.district = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country'  AND T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n\n\n### Question\nIn terms of the number of marriages between two foreigners on 2012, how does Canton Zurich compare to Canton Neuch\u00e2tel?\n### SQL query\nSELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T1.year = 2012 AND T2.canton = 'True' AND (T2.name  ilike '%z_rich%' OR T2.name  ilike '%Neuch_tel%')  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC;\n\n\n### Question\nIn terms of the number of marriages between two foreigners on 2012, how does Canton Zurich compare to Canton Neuch\u00e2tel?\n### SQL query\nSELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T1.year = 2012 AND T2.canton = 'True' AND (T2.name  ilike '%z_rich%' OR T2.name  ilike '%Neuch_tel%')  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC;\n\n\n### Question\nWhat is the number of marriages in Reichenbach im Kandertal in 2020 where both the wife and husband are citizens of foreign countries?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Reichenbach im Kandertal%' and T1.year = 2020 and T1.citizenship_category_husband = 'Foreign country' and T1.citizenship_category_wife = 'Foreign country';\n\n\n### Question\nIn 2012, how many marriages took place in the District of Affoltern, categorized by the citizenships of the wives and husbands involved?\n### SQL query\n",
    "process_time": 6.606786633841693,
    "num_tokens": 3565,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 50,
    "question": "How many marriages occurred in Reiden in 1999 with a wife who held Swiss citizenship?",
    "query": "SELECT  T1.citizenship_category_wife, T2.name,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike  '%Reiden%' and T1.year = 1999 and T1.citizenship_category_wife = 'Switzerland' and T1.citizenship_category_husband = 'Citizenship of husband - total';\n",
    "db_id": "marriage_citizenship",
    "generated_query": "SELECT T2.name, T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%Reiden%' AND T1.year = 1999 AND T1.citizenship_category_wife = 'Switzerland'\nORDER BY T1.amount ASC;",
    "meta_data": [
      {
        "question": "which year has the most number of marriage between swiss femal and man from other nationalty in canton Argua?",
        "query": "SELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T2.name ilike '%Aargau%'  AND T1.citizenship_category_wife = 'Switzerland' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;"
      },
      {
        "question": "How many marriages occurred in Oberdorf (BL) each year?",
        "query": "SELECT T2.name, T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%Oberdorf (BL)%' AND T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.year ASC;\n"
      },
      {
        "question": "In terms of the number of marriages between two foreigners on 2012, how does Canton Zurich compare to Canton Neuch\u00e2tel?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T1.year = 2012 AND T2.canton = 'True' AND (T2.name  ilike '%z_rich%' OR T2.name  ilike '%Neuch_tel%')  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC;\n"
      },
      {
        "question": "Please provide a summary of the number of marriages for each combination of male and female citizenships in the canton of Zurich since 2000.",
        "query": "SELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%z_rich%'  AND T2.canton = 'True' AND T1.year >= 2000  AND T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total'\nORDER BY T1.year ASC, T1.citizenship_category_wife ASC , T1.citizenship_category_husband ASC;\n"
      },
      {
        "question": "In the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?",
        "query": "SELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n"
      },
      {
        "question": "Please provide a summary of the number of marriages for each combination of male and female citizenships in the canton of Zurich since 2000.",
        "query": "SELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%z_rich%'  AND T2.canton = 'True' AND T1.year >= 2000  AND T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total'\nORDER BY T1.year ASC, T1.citizenship_category_wife ASC , T1.citizenship_category_husband ASC;\n"
      },
      {
        "question": "which year has the most number of marriage between swiss femal and man from other nationalty in canton Argua?",
        "query": "SELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T2.name ilike '%Aargau%'  AND T1.citizenship_category_wife = 'Switzerland' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;"
      },
      {
        "question": "In 2000, among the municipalities, which had the highest and lowest numbers of marriages where the husbands were Swiss citizens?",
        "query": "(SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT Max(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1)\nUNION ALL\n(\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT MIN(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1);\n"
      },
      {
        "question": "Which five cantons have the highest number of marriages between Swiss men and foreign women on 2011?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n"
      },
      {
        "question": "Give me the 5 highest numbers of marriages that occurred at the canton level in 2010, where both the wife and husband were citizens of foreign countries?",
        "query": "SELECT  T2.name, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T1.year = 2010  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n"
      },
      {
        "question": "Show me the top-10 municipalities with the lowest numbers of marriages that the wives were Swiss citizens on 2016?",
        "query": "SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount   FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_wife = 'Switzerland' AND  T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.amount ASC\nLIMIT 10;\n"
      },
      {
        "question": "In the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?",
        "query": "SELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n"
      },
      {
        "question": "Please provide a summary of the number of marriages for each combination of male and female citizenships in the canton of Zurich since 2000.",
        "query": "SELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%z_rich%'  AND T2.canton = 'True' AND T1.year >= 2000  AND T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total'\nORDER BY T1.year ASC, T1.citizenship_category_wife ASC , T1.citizenship_category_husband ASC;\n"
      },
      {
        "question": "In 2000, among the municipalities, which had the highest and lowest numbers of marriages where the husbands were Swiss citizens?",
        "query": "(SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT Max(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1)\nUNION ALL\n(\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT MIN(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1);\n"
      },
      {
        "question": "In terms of the number of marriages between two foreigners on 2012, how does Canton Zurich compare to Canton Neuch\u00e2tel?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T1.year = 2012 AND T2.canton = 'True' AND (T2.name  ilike '%z_rich%' OR T2.name  ilike '%Neuch_tel%')  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC;\n"
      },
      {
        "question": "In terms of the number of marriages between two foreigners on 2012, how does Canton Zurich compare to Canton Neuch\u00e2tel?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T1.year = 2012 AND T2.canton = 'True' AND (T2.name  ilike '%z_rich%' OR T2.name  ilike '%Neuch_tel%')  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.marriage_citizenship (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT marriage_citizenship_pk PRIMARY KEY (uid), \n\tCONSTRAINT marriage_citizenship_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in marriage_citizenship and 5 examples in each column for high cardinality columns :\nuid : 563962, 564122, 564042, 564067, 564123\nspatialunit_uid : 6620_A.ADM3, 3746_A.ADM3, 103_A.ADM2, 4063_A.ADM3, 4065_A.ADM3\nyear : 2015, 1988, 2009, 2000, 2012\namount : 4, 27, 252, 18, 59\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nwhich year has the most number of marriage between swiss femal and man from other nationalty in canton Argua?\n### SQL query\nSELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T2.name ilike '%Aargau%'  AND T1.citizenship_category_wife = 'Switzerland' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n\n### Question\nHow many marriages occurred in Oberdorf (BL) each year?\n### SQL query\nSELECT T2.name, T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%Oberdorf (BL)%' AND T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.year ASC;\n\n\n### Question\nIn terms of the number of marriages between two foreigners on 2012, how does Canton Zurich compare to Canton Neuch\u00e2tel?\n### SQL query\nSELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T1.year = 2012 AND T2.canton = 'True' AND (T2.name  ilike '%z_rich%' OR T2.name  ilike '%Neuch_tel%')  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC;\n\n\n### Question\nPlease provide a summary of the number of marriages for each combination of male and female citizenships in the canton of Zurich since 2000.\n### SQL query\nSELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%z_rich%'  AND T2.canton = 'True' AND T1.year >= 2000  AND T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total'\nORDER BY T1.year ASC, T1.citizenship_category_wife ASC , T1.citizenship_category_husband ASC;\n\n\n### Question\nIn the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?\n### SQL query\nSELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n\n\n### Question\nPlease provide a summary of the number of marriages for each combination of male and female citizenships in the canton of Zurich since 2000.\n### SQL query\nSELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%z_rich%'  AND T2.canton = 'True' AND T1.year >= 2000  AND T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total'\nORDER BY T1.year ASC, T1.citizenship_category_wife ASC , T1.citizenship_category_husband ASC;\n\n\n### Question\nwhich year has the most number of marriage between swiss femal and man from other nationalty in canton Argua?\n### SQL query\nSELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T2.name ilike '%Aargau%'  AND T1.citizenship_category_wife = 'Switzerland' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n\n### Question\nIn 2000, among the municipalities, which had the highest and lowest numbers of marriages where the husbands were Swiss citizens?\n### SQL query\n(SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT Max(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1)\nUNION ALL\n(\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT MIN(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1);\n\n\n### Question\nWhich five cantons have the highest number of marriages between Swiss men and foreign women on 2011?\n### SQL query\nSELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n\n\n### Question\nGive me the 5 highest numbers of marriages that occurred at the canton level in 2010, where both the wife and husband were citizens of foreign countries?\n### SQL query\nSELECT  T2.name, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T1.year = 2010  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n\n\n### Question\nShow me the top-10 municipalities with the lowest numbers of marriages that the wives were Swiss citizens on 2016?\n### SQL query\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount   FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_wife = 'Switzerland' AND  T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.amount ASC\nLIMIT 10;\n\n\n### Question\nIn the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?\n### SQL query\nSELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n\n\n### Question\nPlease provide a summary of the number of marriages for each combination of male and female citizenships in the canton of Zurich since 2000.\n### SQL query\nSELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%z_rich%'  AND T2.canton = 'True' AND T1.year >= 2000  AND T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total'\nORDER BY T1.year ASC, T1.citizenship_category_wife ASC , T1.citizenship_category_husband ASC;\n\n\n### Question\nIn 2000, among the municipalities, which had the highest and lowest numbers of marriages where the husbands were Swiss citizens?\n### SQL query\n(SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT Max(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1)\nUNION ALL\n(\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT MIN(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1);\n\n\n### Question\nIn terms of the number of marriages between two foreigners on 2012, how does Canton Zurich compare to Canton Neuch\u00e2tel?\n### SQL query\nSELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T1.year = 2012 AND T2.canton = 'True' AND (T2.name  ilike '%z_rich%' OR T2.name  ilike '%Neuch_tel%')  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC;\n\n\n### Question\nIn terms of the number of marriages between two foreigners on 2012, how does Canton Zurich compare to Canton Neuch\u00e2tel?\n### SQL query\nSELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T1.year = 2012 AND T2.canton = 'True' AND (T2.name  ilike '%z_rich%' OR T2.name  ilike '%Neuch_tel%')  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC;\n\n\n### Question\nHow many marriages occurred in Reiden in 1999 with a wife who held Swiss citizenship?\n### SQL query\n",
    "process_time": 5.741954030934721,
    "num_tokens": 4086,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 51,
    "question": "In which year did the Canton of Bern have the highest number of marriages between Swiss citizens and foreigners?",
    "query": "SELECT UN.year, UN.citizenship_category_husband, UN.citizenship_category_wife, UN.amount FROM\n(SELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T2.name  ilike '%Bern%'  AND T1.citizenship_category_wife = 'Switzerland' AND T1.citizenship_category_husband = 'Foreign country'\nUNION ALL\nSELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T2.name  ilike '%Bern%'  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Switzerland') AS UN\nORDER BY UN.amount DESC\nLIMIT 1;\n",
    "db_id": "marriage_citizenship",
    "generated_query": "SELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T2.name = 'Bern' AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "What is the number of marriages in Reichenbach im Kandertal in 2020 where both the wife and husband are citizens of foreign countries?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Reichenbach im Kandertal%' and T1.year = 2020 and T1.citizenship_category_husband = 'Foreign country' and T1.citizenship_category_wife = 'Foreign country';\n"
      },
      {
        "question": "which year has the most number of marriage between swiss man and woman from other nationalty in Switzerlan?",
        "query": "SELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.country = 'True'  AND T2.name = 'Switzerland'  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Switzerland'\nORDER BY T1.amount DESC\nLIMIT 1;\n"
      },
      {
        "question": "How many marriages occurred in switzerland in the year 2010?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' and T1.year = 2010 and T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total';\n"
      },
      {
        "question": "Show me the top-10 municipalities with the lowest numbers of marriages that the wives were Swiss citizens on 2016?",
        "query": "SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount   FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_wife = 'Switzerland' AND  T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.amount ASC\nLIMIT 10;\n"
      },
      {
        "question": "Show me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?",
        "query": "SELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n"
      },
      {
        "question": "In the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?",
        "query": "SELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n"
      },
      {
        "question": "In which region are the fewest marriages recorded between Swiss men and foreign women?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' and T1.year = 2018 and T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY  T1.amount ASC\nLIMIT 10;\n"
      },
      {
        "question": "In terms of the number of marriages between two foreigners on 2012, how does Canton Zurich compare to Canton Neuch\u00e2tel?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T1.year = 2012 AND T2.canton = 'True' AND (T2.name  ilike '%z_rich%' OR T2.name  ilike '%Neuch_tel%')  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC;\n"
      },
      {
        "question": "How many marriages occurred in Heitenried in the year 2008 for individuals of different nationalities?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Heitenried%' and T1.year = 2008  and T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total';\n"
      },
      {
        "question": "How many marriages occurred in switzerland in the year 2010?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' and T1.year = 2010 and T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total';\n"
      },
      {
        "question": "Which five cantons have the highest number of marriages between Swiss men and foreign women on 2011?",
        "query": "SELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n"
      },
      {
        "question": "What is the highest number of marriages that occurred at the district level in 2012, where both the wife and husband were citizens of foreign countries?",
        "query": "SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount,T1.citizenship_category_husband,T1.citizenship_category_wife  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.district = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country'  AND T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n"
      },
      {
        "question": "which year has the most number of marriage between swiss man and woman from other nationalty in Switzerlan?",
        "query": "SELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.country = 'True'  AND T2.name = 'Switzerland'  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Switzerland'\nORDER BY T1.amount DESC\nLIMIT 1;\n"
      },
      {
        "question": "Please provide a summary of the number of marriages for each combination of male and female citizenships in the canton of Zurich since 2000.",
        "query": "SELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%z_rich%'  AND T2.canton = 'True' AND T1.year >= 2000  AND T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total'\nORDER BY T1.year ASC, T1.citizenship_category_wife ASC , T1.citizenship_category_husband ASC;\n"
      },
      {
        "question": "In 2000, among the municipalities, which had the highest and lowest numbers of marriages where the husbands were Swiss citizens?",
        "query": "(SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT Max(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1)\nUNION ALL\n(\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT MIN(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1);\n"
      },
      {
        "question": "In which region are the fewest marriages recorded between Swiss men and foreign women?",
        "query": "SELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' and T1.year = 2018 and T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY  T1.amount ASC\nLIMIT 10;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.marriage_citizenship (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tcitizenship_category_husband VARCHAR(50), \n\tcitizenship_category_wife VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT marriage_citizenship_pk PRIMARY KEY (uid), \n\tCONSTRAINT marriage_citizenship_spatial_unit_spatialunit_uid_fk FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in marriage_citizenship and 5 examples in each column for high cardinality columns :\nuid : 563962, 564122, 564042, 564067, 564123\nspatialunit_uid : 6620_A.ADM3, 3746_A.ADM3, 103_A.ADM2, 4063_A.ADM3, 4065_A.ADM3\nyear : 2015, 1988, 2009, 2000, 2012\namount : 4, 27, 252, 18, 59\n*/\n\n/*\nColumn name, Column discription, Example values\ncitizenship_category_husband, citizen category husband: either foreign or Swiss, Foreign country,Citizenship of husband - total,Switzerland\ncitizenship_category_wife, citizen category wife: either foreign or Swiss, Foreign country,Citizenship of wife - total,Switzerland\namount, number of divorces, 10\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWhat is the number of marriages in Reichenbach im Kandertal in 2020 where both the wife and husband are citizens of foreign countries?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Reichenbach im Kandertal%' and T1.year = 2020 and T1.citizenship_category_husband = 'Foreign country' and T1.citizenship_category_wife = 'Foreign country';\n\n\n### Question\nwhich year has the most number of marriage between swiss man and woman from other nationalty in Switzerlan?\n### SQL query\nSELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.country = 'True'  AND T2.name = 'Switzerland'  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Switzerland'\nORDER BY T1.amount DESC\nLIMIT 1;\n\n\n### Question\nHow many marriages occurred in switzerland in the year 2010?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' and T1.year = 2010 and T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total';\n\n\n### Question\nShow me the top-10 municipalities with the lowest numbers of marriages that the wives were Swiss citizens on 2016?\n### SQL query\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount   FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_wife = 'Switzerland' AND  T1.citizenship_category_husband = 'Citizenship of husband - total'\nORDER BY T1.amount ASC\nLIMIT 10;\n\n\n### Question\nShow me the lowet number of marriages that occurred at the canton level in 1990, where both the wife and husband were from different nationalities?\n### SQL query\nSELECT A. * from (SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Foreign country'\n                 and T1.citizenship_category_wife = 'Switzerland'\n               UNION\n               SELECT T2.name, T1.citizenship_category_husband, T1.citizenship_category_wife, T1.amount\n               FROM marriage_citizenship as T1\n                        JOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\n               WHERE T2.canton = 'True'\n                 AND T1.year = 1990\n                 AND T1.citizenship_category_husband = 'Switzerland'\n                 and T1.citizenship_category_wife = 'Foreign country') A\nORDER BY A.amount ASC\nLIMIT 1;\n\n\n### Question\nIn the year 1982, what was the average number of marriages at the municipal level, where the husbands were citizens of foreign countries?\n### SQL query\nSELECT  AVG(T1.amount)  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country' AND  T1.citizenship_category_wife = 'Citizenship of wife - total';\n\n\n### Question\nIn which region are the fewest marriages recorded between Swiss men and foreign women?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' and T1.year = 2018 and T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY  T1.amount ASC\nLIMIT 10;\n\n\n### Question\nIn terms of the number of marriages between two foreigners on 2012, how does Canton Zurich compare to Canton Neuch\u00e2tel?\n### SQL query\nSELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T1.year = 2012 AND T2.canton = 'True' AND (T2.name  ilike '%z_rich%' OR T2.name  ilike '%Neuch_tel%')  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Foreign country'\nORDER BY T1.amount DESC;\n\n\n### Question\nHow many marriages occurred in Heitenried in the year 2008 for individuals of different nationalities?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.name ilike '%Heitenried%' and T1.year = 2008  and T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total';\n\n\n### Question\nHow many marriages occurred in switzerland in the year 2010?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' and T1.year = 2010 and T1.citizenship_category_wife = 'Citizenship of wife - total' and T1.citizenship_category_husband = 'Citizenship of husband - total';\n\n\n### Question\nWhich five cantons have the highest number of marriages between Swiss men and foreign women on 2011?\n### SQL query\nSELECT T2.name, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.canton = 'True' AND T1.year = 2011 AND T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 5;\n\n\n### Question\nWhat is the highest number of marriages that occurred at the district level in 2012, where both the wife and husband were citizens of foreign countries?\n### SQL query\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount,T1.citizenship_category_husband,T1.citizenship_category_wife  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.district = 'True' AND T1.year = 2012  AND T1.citizenship_category_husband = 'Foreign country'  AND T1.citizenship_category_wife = 'Foreign country'\nORDER BY T1.amount DESC\nLIMIT 1;\n\n\n### Question\nwhich year has the most number of marriage between swiss man and woman from other nationalty in Switzerlan?\n### SQL query\nSELECT T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.country = 'True'  AND T2.name = 'Switzerland'  AND T1.citizenship_category_wife = 'Foreign country' AND T1.citizenship_category_husband = 'Switzerland'\nORDER BY T1.amount DESC\nLIMIT 1;\n\n\n### Question\nPlease provide a summary of the number of marriages for each combination of male and female citizenships in the canton of Zurich since 2000.\n### SQL query\nSELECT T2.name, T1.year, T1.citizenship_category_husband , T1.citizenship_category_wife, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE  T2.name ilike '%z_rich%'  AND T2.canton = 'True' AND T1.year >= 2000  AND T1.citizenship_category_wife != 'Citizenship of wife - total' and T1.citizenship_category_husband != 'Citizenship of husband - total'\nORDER BY T1.year ASC, T1.citizenship_category_wife ASC , T1.citizenship_category_husband ASC;\n\n\n### Question\nIn 2000, among the municipalities, which had the highest and lowest numbers of marriages where the husbands were Swiss citizens?\n### SQL query\n(SELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT Max(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1)\nUNION ALL\n(\nSELECT  T2.name, T2.spatialunit_ontology,T1.year, T1.amount  FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total'\nAND T1.amount =(SELECT MIN(T1.amount) FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' AND T1.year = 2000  AND T1.citizenship_category_husband = 'Switzerland'  AND T1.citizenship_category_wife = 'Citizenship of wife - total' )\nLIMIT 1);\n\n\n### Question\nIn which region are the fewest marriages recorded between Swiss men and foreign women?\n### SQL query\nSELECT  T2.name,T1.citizenship_category_wife,T1.citizenship_category_husband,T1.year, T1.amount FROM marriage_citizenship as T1\nJOIN spatial_unit AS T2 on T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True' and T1.year = 2018 and T1.citizenship_category_husband = 'Switzerland' and T1.citizenship_category_wife = 'Foreign country'\nORDER BY  T1.amount ASC\nLIMIT 10;\n\n\n### Question\nIn which year did the Canton of Bern have the highest number of marriages between Swiss citizens and foreigners?\n### SQL query\n",
    "process_time": 12.051284143002704,
    "num_tokens": 3809,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 52,
    "question": "What was the total population count in each canton , considering both non-permanent and permanent residents on the year of 2018?",
    "query": "SELECT T1.year, T2.name, T1.population_type, T1.place_of_birth, T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True'  AND T1.year = 2018 AND T1.place_of_birth = 'Place of birth - total' AND T1.citizenship = 'Citizenship - total'\nORDER BY  T1.amount DESC;\n",
    "db_id": "resident_population_birthplace_citizenship_type",
    "generated_query": "SELECT T2.name, sum(T1.amount) as total_population from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T1.year = 2018 AND (T1.population_type = 'Non permanent resident population' OR T1.population_type = 'Permanent resident population') AND T1.place_of_birth = 'Place of birth - total' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T2.name;",
    "meta_data": [
      {
        "question": "Can you provide the breakdown of the population by different citizenships, different place of the birth and different residentship in the Canton of Obwaldent in 2011?",
        "query": "SELECT T1.citizenship, T1.population_type, T1.place_of_birth,  T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Obwalden%' AND T1.year = 2011  AND T1.place_of_birth != 'Place of birth - total' AND T1.citizenship != 'Citizenship - total'\nORDER BY citizenship;"
      },
      {
        "question": "How many vehicles do we have in zurich in 2020?",
        "query": "SELECT S.name, S.spatialunit_ontology, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Z_rich%'  and T.year = 2020 and (S.canton = 'True' or S.municipal = 'True' or S.district = 'True')\nGROUP BY S.name, S.spatialunit_ontology;\n"
      },
      {
        "question": "How many of the people were born abroad in municipality level  had the permanent residenship on 2010?",
        "query": "SELECT T1.year, T2.spatialunit_ontology, T2.name, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2010 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "Can you provide a breakdown of the number of people who hold Swiss permanent residency and were born in Switzerland in 2020, categorized by their respective citizenships?",
        "query": "SELECT T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship != 'Citizenship - total';\n"
      },
      {
        "question": "How many of the people were born abroad in municipality level  had the permanent residenship on 2010?",
        "query": "SELECT T1.year, T2.spatialunit_ontology, T2.name, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2010 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "In 2020, what was the number of individuals categorized as non-permanent residents in the Canton of Zug?",
        "query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Zug%' AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Place of birth - total' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "In 2021, what percentage of the population in Switzerland consisted of individuals who were born within the country's borders?",
        "query": "SELECT un.in, un.out , un.in/(un.in + un.out) AS percentage FROM\n(SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount as in, 0 as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nUNION\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, 0 as in, T1.amount as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\n) AS un;\n"
      },
      {
        "question": "Can you provide a breakdown of the number of people who hold Swiss permanent residency and were born in Switzerland in 2020, categorized by their respective citizenships?",
        "query": "SELECT T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship != 'Citizenship - total';\n"
      },
      {
        "question": "How many people who were born in Switzerland  did not possess permanent residency status by 2010?",
        "query": "SELECT T1.year, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True'  AND T1.year = 2015 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "How many vehicles do we have in zurich in 2020?",
        "query": "SELECT S.name, S.spatialunit_ontology, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Z_rich%'  and T.year = 2020 and (S.canton = 'True' or S.municipal = 'True' or S.district = 'True')\nGROUP BY S.name, S.spatialunit_ontology;\n"
      },
      {
        "question": "How many hybrid cars do we have in the city of basel?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n"
      },
      {
        "question": "In 2020, what was the number of individuals categorized as non-permanent residents in the Canton of Zug?",
        "query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Zug%' AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Place of birth - total' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "How many of the permanent population of Switzerlan have been born Aborad on the year of 2020?",
        "query": "SELECT T1.year, T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "What was the percentage of the population in Switerland who were born in a foreign country on 2017?",
        "query": "SELECT sum(un.in), sum(un.out) , sum(un.out)/(sum(un.in)+sum(un.out)) AS percentage FROM\n(SELECT T1.year,T1.place_of_birth,T1.citizenship, Sum(T1.amount) as in, sum(0) as out  from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year,  T1.place_of_birth, T1.citizenship\nUNION\nSELECT T1.year,T1.place_of_birth,T1.citizenship, sum(0) as in, Sum(T1.amount) as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year, T1.place_of_birth, T1.citizenship\n) AS un;\n"
      },
      {
        "question": "Can you provide a breakdown of the number of people who hold Swiss permanent residency and were born in Switzerland in 2020, categorized by their respective citizenships?",
        "query": "SELECT T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship != 'Citizenship - total';\n"
      },
      {
        "question": "What was the percentage of the population in Switerland who were born in a foreign country on 2017?",
        "query": "SELECT sum(un.in), sum(un.out) , sum(un.out)/(sum(un.in)+sum(un.out)) AS percentage FROM\n(SELECT T1.year,T1.place_of_birth,T1.citizenship, Sum(T1.amount) as in, sum(0) as out  from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year,  T1.place_of_birth, T1.citizenship\nUNION\nSELECT T1.year,T1.place_of_birth,T1.citizenship, sum(0) as in, Sum(T1.amount) as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year, T1.place_of_birth, T1.citizenship\n) AS un;\n"
      },
      {
        "question": "In 2021, how many people were living in Switzerland who were not born there and did not have permanent residency?",
        "query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2021 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.resident_population_birthplace_citizenship_type (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tpopulation_type VARCHAR(50), \n\tplace_of_birth VARCHAR(50), \n\tcitizenship VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT resident_population_birthplace_citizenship_type_pk PRIMARY KEY (uid), \n\tCONSTRAINT resident_population_birthplace_citizenship_type_spatial_unit_sp FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in resident_population_birthplace_citizenship_type and 5 examples in each column for high cardinality columns :\nuid : 11360041, 11359891, 11359925, 11360078, 11359962\nspatialunit_uid : 4071_A.ADM3, 869_A.ADM3, 5403_A.ADM3, 5860_A.ADM3, 2087_A.ADM3\nyear : 2014, 2011, 2013, 2015, 2012\ncitizenship : Antigua and Barbuda, Bulgaria, Sri Lanka, Rwanda, Philippines\namount : 4, 1476, 2877, 0, 2\n*/\n\n/*\nColumn name, Column discription, Example values\npopulation_type, population type, Non permanent resident population,Permanent resident population\nplace_of_birth, Place of birth: Switzerland or abroad, Abroad,Switzerland,Place of birth - total\ncitizenship, citizenship, Sweden,S\u00e3o Tom\u00e9 and Pr\u00edncipe,Uganda\namount, number of persons, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nCan you provide the breakdown of the population by different citizenships, different place of the birth and different residentship in the Canton of Obwaldent in 2011?\n### SQL query\nSELECT T1.citizenship, T1.population_type, T1.place_of_birth,  T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Obwalden%' AND T1.year = 2011  AND T1.place_of_birth != 'Place of birth - total' AND T1.citizenship != 'Citizenship - total'\nORDER BY citizenship;\n\n### Question\nHow many vehicles do we have in zurich in 2020?\n### SQL query\nSELECT S.name, S.spatialunit_ontology, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Z_rich%'  and T.year = 2020 and (S.canton = 'True' or S.municipal = 'True' or S.district = 'True')\nGROUP BY S.name, S.spatialunit_ontology;\n\n\n### Question\nHow many of the people were born abroad in municipality level  had the permanent residenship on 2010?\n### SQL query\nSELECT T1.year, T2.spatialunit_ontology, T2.name, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2010 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nCan you provide a breakdown of the number of people who hold Swiss permanent residency and were born in Switzerland in 2020, categorized by their respective citizenships?\n### SQL query\nSELECT T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship != 'Citizenship - total';\n\n\n### Question\nHow many of the people were born abroad in municipality level  had the permanent residenship on 2010?\n### SQL query\nSELECT T1.year, T2.spatialunit_ontology, T2.name, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2010 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nIn 2020, what was the number of individuals categorized as non-permanent residents in the Canton of Zug?\n### SQL query\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Zug%' AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Place of birth - total' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nIn 2021, what percentage of the population in Switzerland consisted of individuals who were born within the country's borders?\n### SQL query\nSELECT un.in, un.out , un.in/(un.in + un.out) AS percentage FROM\n(SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount as in, 0 as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nUNION\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, 0 as in, T1.amount as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\n) AS un;\n\n\n### Question\nCan you provide a breakdown of the number of people who hold Swiss permanent residency and were born in Switzerland in 2020, categorized by their respective citizenships?\n### SQL query\nSELECT T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship != 'Citizenship - total';\n\n\n### Question\nHow many people who were born in Switzerland  did not possess permanent residency status by 2010?\n### SQL query\nSELECT T1.year, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True'  AND T1.year = 2015 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nHow many vehicles do we have in zurich in 2020?\n### SQL query\nSELECT S.name, S.spatialunit_ontology, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Z_rich%'  and T.year = 2020 and (S.canton = 'True' or S.municipal = 'True' or S.district = 'True')\nGROUP BY S.name, S.spatialunit_ontology;\n\n\n### Question\nHow many hybrid cars do we have in the city of basel?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n\n\n### Question\nIn 2020, what was the number of individuals categorized as non-permanent residents in the Canton of Zug?\n### SQL query\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Zug%' AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Place of birth - total' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nHow many of the permanent population of Switzerlan have been born Aborad on the year of 2020?\n### SQL query\nSELECT T1.year, T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nWhat was the percentage of the population in Switerland who were born in a foreign country on 2017?\n### SQL query\nSELECT sum(un.in), sum(un.out) , sum(un.out)/(sum(un.in)+sum(un.out)) AS percentage FROM\n(SELECT T1.year,T1.place_of_birth,T1.citizenship, Sum(T1.amount) as in, sum(0) as out  from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year,  T1.place_of_birth, T1.citizenship\nUNION\nSELECT T1.year,T1.place_of_birth,T1.citizenship, sum(0) as in, Sum(T1.amount) as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year, T1.place_of_birth, T1.citizenship\n) AS un;\n\n\n### Question\nCan you provide a breakdown of the number of people who hold Swiss permanent residency and were born in Switzerland in 2020, categorized by their respective citizenships?\n### SQL query\nSELECT T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship != 'Citizenship - total';\n\n\n### Question\nWhat was the percentage of the population in Switerland who were born in a foreign country on 2017?\n### SQL query\nSELECT sum(un.in), sum(un.out) , sum(un.out)/(sum(un.in)+sum(un.out)) AS percentage FROM\n(SELECT T1.year,T1.place_of_birth,T1.citizenship, Sum(T1.amount) as in, sum(0) as out  from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year,  T1.place_of_birth, T1.citizenship\nUNION\nSELECT T1.year,T1.place_of_birth,T1.citizenship, sum(0) as in, Sum(T1.amount) as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year, T1.place_of_birth, T1.citizenship\n) AS un;\n\n\n### Question\nIn 2021, how many people were living in Switzerland who were not born there and did not have permanent residency?\n### SQL query\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2021 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nWhat was the total population count in each canton , considering both non-permanent and permanent residents on the year of 2018?\n### SQL query\n",
    "process_time": 8.119200787041336,
    "num_tokens": 3896,
    "hardness": "hard",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 53,
    "question": "How many people who were born in Switzerland did not possess permanent residency status by 2015? List by citizenship",
    "query": "SELECT T1.year, T1.population_type,T1.place_of_birth, T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True'  AND T1.year = 2015 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship != 'Citizenship - total';\n",
    "db_id": "resident_population_birthplace_citizenship_type",
    "generated_query": "SELECT T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2015 AND T1.place_of_birth = 'Switzerland' AND T1.population_type = 'Non permanent resident population' AND T1.citizenship != 'Citizenship - total';",
    "meta_data": [
      {
        "question": "How many of the people were born abroad in municipality level  had the permanent residenship on 2010?",
        "query": "SELECT T1.year, T2.spatialunit_ontology, T2.name, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2010 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "How many of the permanent population of Switzerlan have been born Aborad on the year of 2020?",
        "query": "SELECT T1.year, T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "In 2020, what was the number of individuals categorized as non-permanent residents in the Canton of Zug?",
        "query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Zug%' AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Place of birth - total' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "give me the total number of passenger cars that are using diesel in each canton?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE  S.canton = 'True' and T.fuel_type ilike '%diesel%' and T.vehicle_type = 'passenger_cars'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type;\n"
      },
      {
        "question": "give me the total number of passenger cars that are using diesel in each canton?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE  S.canton = 'True' and T.fuel_type ilike '%diesel%' and T.vehicle_type = 'passenger_cars'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type;\n"
      },
      {
        "question": "How many electric cars do we have in the city of basel?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type = 'Electric'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n"
      },
      {
        "question": "How many hybrid cars do we have in the city of basel?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n"
      },
      {
        "question": "How many electric cars do we have in the city of basel?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type = 'Electric'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n"
      },
      {
        "question": "What was the percentage of the population in Switerland who were born in a foreign country on 2017?",
        "query": "SELECT sum(un.in), sum(un.out) , sum(un.out)/(sum(un.in)+sum(un.out)) AS percentage FROM\n(SELECT T1.year,T1.place_of_birth,T1.citizenship, Sum(T1.amount) as in, sum(0) as out  from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year,  T1.place_of_birth, T1.citizenship\nUNION\nSELECT T1.year,T1.place_of_birth,T1.citizenship, sum(0) as in, Sum(T1.amount) as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year, T1.place_of_birth, T1.citizenship\n) AS un;\n"
      },
      {
        "question": "How many of the people were born abroad in municipality level  had the permanent residenship on 2010?",
        "query": "SELECT T1.year, T2.spatialunit_ontology, T2.name, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2010 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "How many hybrid cars do we have in the city of basel?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n"
      },
      {
        "question": "How many hybrid cars do we have in the city of basel?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n"
      },
      {
        "question": "Can you provide a breakdown of the number of people who hold Swiss permanent residency and were born in Switzerland in 2020, categorized by their respective citizenships?",
        "query": "SELECT T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship != 'Citizenship - total';\n"
      },
      {
        "question": "How many of the people were born abroad in municipality level  had the permanent residenship on 2010?",
        "query": "SELECT T1.year, T2.spatialunit_ontology, T2.name, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2010 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "Can you provide the breakdown of the population by different citizenships, different place of the birth and different residentship in the Canton of Obwaldent in 2011?",
        "query": "SELECT T1.citizenship, T1.population_type, T1.place_of_birth,  T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Obwalden%' AND T1.year = 2011  AND T1.place_of_birth != 'Place of birth - total' AND T1.citizenship != 'Citizenship - total'\nORDER BY citizenship;"
      },
      {
        "question": "Can you provide a breakdown of the number of people who hold Swiss permanent residency and were born in Switzerland in 2020, categorized by their respective citizenships?",
        "query": "SELECT T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship != 'Citizenship - total';\n"
      },
      {
        "question": "give me the total number of passenger cars that are using diesel in each canton?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE  S.canton = 'True' and T.fuel_type ilike '%diesel%' and T.vehicle_type = 'passenger_cars'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.resident_population_birthplace_citizenship_type (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tpopulation_type VARCHAR(50), \n\tplace_of_birth VARCHAR(50), \n\tcitizenship VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT resident_population_birthplace_citizenship_type_pk PRIMARY KEY (uid), \n\tCONSTRAINT resident_population_birthplace_citizenship_type_spatial_unit_sp FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in resident_population_birthplace_citizenship_type and 5 examples in each column for high cardinality columns :\nuid : 11360041, 11359891, 11359925, 11360078, 11359962\nspatialunit_uid : 4071_A.ADM3, 869_A.ADM3, 5403_A.ADM3, 5860_A.ADM3, 2087_A.ADM3\nyear : 2014, 2011, 2013, 2015, 2012\ncitizenship : Antigua and Barbuda, Bulgaria, Sri Lanka, Rwanda, Philippines\namount : 4, 1476, 2877, 0, 2\n*/\n\n/*\nColumn name, Column discription, Example values\npopulation_type, population type, Non permanent resident population,Permanent resident population\nplace_of_birth, Place of birth: Switzerland or abroad, Abroad,Switzerland,Place of birth - total\ncitizenship, citizenship, Sweden,S\u00e3o Tom\u00e9 and Pr\u00edncipe,Uganda\namount, number of persons, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nHow many of the people were born abroad in municipality level  had the permanent residenship on 2010?\n### SQL query\nSELECT T1.year, T2.spatialunit_ontology, T2.name, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2010 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nHow many of the permanent population of Switzerlan have been born Aborad on the year of 2020?\n### SQL query\nSELECT T1.year, T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nIn 2020, what was the number of individuals categorized as non-permanent residents in the Canton of Zug?\n### SQL query\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Zug%' AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Place of birth - total' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\ngive me the total number of passenger cars that are using diesel in each canton?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE  S.canton = 'True' and T.fuel_type ilike '%diesel%' and T.vehicle_type = 'passenger_cars'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type;\n\n\n### Question\ngive me the total number of passenger cars that are using diesel in each canton?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE  S.canton = 'True' and T.fuel_type ilike '%diesel%' and T.vehicle_type = 'passenger_cars'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type;\n\n\n### Question\nHow many electric cars do we have in the city of basel?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type = 'Electric'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n\n\n### Question\nHow many hybrid cars do we have in the city of basel?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n\n\n### Question\nHow many electric cars do we have in the city of basel?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type = 'Electric'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n\n\n### Question\nWhat was the percentage of the population in Switerland who were born in a foreign country on 2017?\n### SQL query\nSELECT sum(un.in), sum(un.out) , sum(un.out)/(sum(un.in)+sum(un.out)) AS percentage FROM\n(SELECT T1.year,T1.place_of_birth,T1.citizenship, Sum(T1.amount) as in, sum(0) as out  from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year,  T1.place_of_birth, T1.citizenship\nUNION\nSELECT T1.year,T1.place_of_birth,T1.citizenship, sum(0) as in, Sum(T1.amount) as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year, T1.place_of_birth, T1.citizenship\n) AS un;\n\n\n### Question\nHow many of the people were born abroad in municipality level  had the permanent residenship on 2010?\n### SQL query\nSELECT T1.year, T2.spatialunit_ontology, T2.name, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2010 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nHow many hybrid cars do we have in the city of basel?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n\n\n### Question\nHow many hybrid cars do we have in the city of basel?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n\n\n### Question\nCan you provide a breakdown of the number of people who hold Swiss permanent residency and were born in Switzerland in 2020, categorized by their respective citizenships?\n### SQL query\nSELECT T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship != 'Citizenship - total';\n\n\n### Question\nHow many of the people were born abroad in municipality level  had the permanent residenship on 2010?\n### SQL query\nSELECT T1.year, T2.spatialunit_ontology, T2.name, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2010 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nCan you provide the breakdown of the population by different citizenships, different place of the birth and different residentship in the Canton of Obwaldent in 2011?\n### SQL query\nSELECT T1.citizenship, T1.population_type, T1.place_of_birth,  T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Obwalden%' AND T1.year = 2011  AND T1.place_of_birth != 'Place of birth - total' AND T1.citizenship != 'Citizenship - total'\nORDER BY citizenship;\n\n### Question\nCan you provide a breakdown of the number of people who hold Swiss permanent residency and were born in Switzerland in 2020, categorized by their respective citizenships?\n### SQL query\nSELECT T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship != 'Citizenship - total';\n\n\n### Question\ngive me the total number of passenger cars that are using diesel in each canton?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE  S.canton = 'True' and T.fuel_type ilike '%diesel%' and T.vehicle_type = 'passenger_cars'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type;\n\n\n### Question\nHow many people who were born in Switzerland did not possess permanent residency status by 2015? List by citizenship\n### SQL query\n",
    "process_time": 6.058251061011106,
    "num_tokens": 3427,
    "hardness": "extra",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 54,
    "question": "How many individuals with Swiss permanent residency were born within the country's borders on 2006?",
    "query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2019 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total';\n",
    "db_id": "resident_population_birthplace_citizenship_type",
    "generated_query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2006 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total';",
    "meta_data": [
      {
        "question": "How many vehicles do we have in zurich in 2020?",
        "query": "SELECT S.name, S.spatialunit_ontology, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Z_rich%'  and T.year = 2020 and (S.canton = 'True' or S.municipal = 'True' or S.district = 'True')\nGROUP BY S.name, S.spatialunit_ontology;\n"
      },
      {
        "question": "How many hybrid cars do we have in the city of basel?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n"
      },
      {
        "question": "How many hybrid cars do we have in the city of basel?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n"
      },
      {
        "question": "How many hybrid cars do we have in the city of basel?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n"
      },
      {
        "question": "How many vehicles do we have in the city of zurich in 2021?",
        "query": "SELECT S.name, S.spatialunit_ontology, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Z_rich%'  and T.year = 2021 and S.municipal = 'True' and T.fuel_type != 'total'\nGROUP BY S.name, S.spatialunit_ontology;\n"
      },
      {
        "question": "What was the percentage of the population in Switerland who were born in a foreign country on 2017?",
        "query": "SELECT sum(un.in), sum(un.out) , sum(un.out)/(sum(un.in)+sum(un.out)) AS percentage FROM\n(SELECT T1.year,T1.place_of_birth,T1.citizenship, Sum(T1.amount) as in, sum(0) as out  from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year,  T1.place_of_birth, T1.citizenship\nUNION\nSELECT T1.year,T1.place_of_birth,T1.citizenship, sum(0) as in, Sum(T1.amount) as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year, T1.place_of_birth, T1.citizenship\n) AS un;\n"
      },
      {
        "question": "give me the total number of passenger cars that are using diesel in each canton?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE  S.canton = 'True' and T.fuel_type ilike '%diesel%' and T.vehicle_type = 'passenger_cars'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type;\n"
      },
      {
        "question": "Can you provide the breakdown of the population by different citizenships, different place of the birth and different residentship in the Canton of Obwaldent in 2011?",
        "query": "SELECT T1.citizenship, T1.population_type, T1.place_of_birth,  T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Obwalden%' AND T1.year = 2011  AND T1.place_of_birth != 'Place of birth - total' AND T1.citizenship != 'Citizenship - total'\nORDER BY citizenship;"
      },
      {
        "question": "What was the percentage of the population in Switerland who were born in a foreign country on 2017?",
        "query": "SELECT sum(un.in), sum(un.out) , sum(un.out)/(sum(un.in)+sum(un.out)) AS percentage FROM\n(SELECT T1.year,T1.place_of_birth,T1.citizenship, Sum(T1.amount) as in, sum(0) as out  from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year,  T1.place_of_birth, T1.citizenship\nUNION\nSELECT T1.year,T1.place_of_birth,T1.citizenship, sum(0) as in, Sum(T1.amount) as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year, T1.place_of_birth, T1.citizenship\n) AS un;\n"
      },
      {
        "question": "In 2020, what was the number of individuals categorized as non-permanent residents in the Canton of Zug?",
        "query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Zug%' AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Place of birth - total' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "How many electric cars do we have in the city of basel?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type = 'Electric'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n"
      },
      {
        "question": "Which municipalities had the largest population of people born in Switzerland who did not have permanent residency by 2020? show me top 5.",
        "query": "SELECT T1.year, T2.name, T1.population_type,T1.place_of_birth, T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nORDER BY T1.amount DESC\nLIMIT 5;\n"
      },
      {
        "question": "Can you provide a breakdown of the number of people who hold Swiss permanent residency and were born in Switzerland in 2020, categorized by their respective citizenships?",
        "query": "SELECT T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship != 'Citizenship - total';\n"
      },
      {
        "question": "Which municipalities had the largest population of people born in Switzerland who did not have permanent residency by 2020? show me top 5.",
        "query": "SELECT T1.year, T2.name, T1.population_type,T1.place_of_birth, T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nORDER BY T1.amount DESC\nLIMIT 5;\n"
      },
      {
        "question": "What was the percentage of the population in Switerland who were born in a foreign country on 2017?",
        "query": "SELECT sum(un.in), sum(un.out) , sum(un.out)/(sum(un.in)+sum(un.out)) AS percentage FROM\n(SELECT T1.year,T1.place_of_birth,T1.citizenship, Sum(T1.amount) as in, sum(0) as out  from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year,  T1.place_of_birth, T1.citizenship\nUNION\nSELECT T1.year,T1.place_of_birth,T1.citizenship, sum(0) as in, Sum(T1.amount) as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year, T1.place_of_birth, T1.citizenship\n) AS un;\n"
      },
      {
        "question": "In 2021, how many people were living in Switzerland who were not born there and did not have permanent residency?",
        "query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2021 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "In 2021, how many people were living in Switzerland who were not born there and did not have permanent residency?",
        "query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2021 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.resident_population_birthplace_citizenship_type (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tpopulation_type VARCHAR(50), \n\tplace_of_birth VARCHAR(50), \n\tcitizenship VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT resident_population_birthplace_citizenship_type_pk PRIMARY KEY (uid), \n\tCONSTRAINT resident_population_birthplace_citizenship_type_spatial_unit_sp FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in resident_population_birthplace_citizenship_type and 5 examples in each column for high cardinality columns :\nuid : 11360041, 11359891, 11359925, 11360078, 11359962\nspatialunit_uid : 4071_A.ADM3, 869_A.ADM3, 5403_A.ADM3, 5860_A.ADM3, 2087_A.ADM3\nyear : 2014, 2011, 2013, 2015, 2012\ncitizenship : Antigua and Barbuda, Bulgaria, Sri Lanka, Rwanda, Philippines\namount : 4, 1476, 2877, 0, 2\n*/\n\n/*\nColumn name, Column discription, Example values\npopulation_type, population type, Non permanent resident population,Permanent resident population\nplace_of_birth, Place of birth: Switzerland or abroad, Abroad,Switzerland,Place of birth - total\ncitizenship, citizenship, Sweden,S\u00e3o Tom\u00e9 and Pr\u00edncipe,Uganda\namount, number of persons, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nHow many vehicles do we have in zurich in 2020?\n### SQL query\nSELECT S.name, S.spatialunit_ontology, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Z_rich%'  and T.year = 2020 and (S.canton = 'True' or S.municipal = 'True' or S.district = 'True')\nGROUP BY S.name, S.spatialunit_ontology;\n\n\n### Question\nHow many hybrid cars do we have in the city of basel?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n\n\n### Question\nHow many hybrid cars do we have in the city of basel?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n\n\n### Question\nHow many hybrid cars do we have in the city of basel?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n\n\n### Question\nHow many vehicles do we have in the city of zurich in 2021?\n### SQL query\nSELECT S.name, S.spatialunit_ontology, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Z_rich%'  and T.year = 2021 and S.municipal = 'True' and T.fuel_type != 'total'\nGROUP BY S.name, S.spatialunit_ontology;\n\n\n### Question\nWhat was the percentage of the population in Switerland who were born in a foreign country on 2017?\n### SQL query\nSELECT sum(un.in), sum(un.out) , sum(un.out)/(sum(un.in)+sum(un.out)) AS percentage FROM\n(SELECT T1.year,T1.place_of_birth,T1.citizenship, Sum(T1.amount) as in, sum(0) as out  from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year,  T1.place_of_birth, T1.citizenship\nUNION\nSELECT T1.year,T1.place_of_birth,T1.citizenship, sum(0) as in, Sum(T1.amount) as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year, T1.place_of_birth, T1.citizenship\n) AS un;\n\n\n### Question\ngive me the total number of passenger cars that are using diesel in each canton?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE  S.canton = 'True' and T.fuel_type ilike '%diesel%' and T.vehicle_type = 'passenger_cars'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type;\n\n\n### Question\nCan you provide the breakdown of the population by different citizenships, different place of the birth and different residentship in the Canton of Obwaldent in 2011?\n### SQL query\nSELECT T1.citizenship, T1.population_type, T1.place_of_birth,  T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Obwalden%' AND T1.year = 2011  AND T1.place_of_birth != 'Place of birth - total' AND T1.citizenship != 'Citizenship - total'\nORDER BY citizenship;\n\n### Question\nWhat was the percentage of the population in Switerland who were born in a foreign country on 2017?\n### SQL query\nSELECT sum(un.in), sum(un.out) , sum(un.out)/(sum(un.in)+sum(un.out)) AS percentage FROM\n(SELECT T1.year,T1.place_of_birth,T1.citizenship, Sum(T1.amount) as in, sum(0) as out  from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year,  T1.place_of_birth, T1.citizenship\nUNION\nSELECT T1.year,T1.place_of_birth,T1.citizenship, sum(0) as in, Sum(T1.amount) as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year, T1.place_of_birth, T1.citizenship\n) AS un;\n\n\n### Question\nIn 2020, what was the number of individuals categorized as non-permanent residents in the Canton of Zug?\n### SQL query\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Zug%' AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Place of birth - total' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nHow many electric cars do we have in the city of basel?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type = 'Electric'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n\n\n### Question\nWhich municipalities had the largest population of people born in Switzerland who did not have permanent residency by 2020? show me top 5.\n### SQL query\nSELECT T1.year, T2.name, T1.population_type,T1.place_of_birth, T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nORDER BY T1.amount DESC\nLIMIT 5;\n\n\n### Question\nCan you provide a breakdown of the number of people who hold Swiss permanent residency and were born in Switzerland in 2020, categorized by their respective citizenships?\n### SQL query\nSELECT T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship != 'Citizenship - total';\n\n\n### Question\nWhich municipalities had the largest population of people born in Switzerland who did not have permanent residency by 2020? show me top 5.\n### SQL query\nSELECT T1.year, T2.name, T1.population_type,T1.place_of_birth, T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nORDER BY T1.amount DESC\nLIMIT 5;\n\n\n### Question\nWhat was the percentage of the population in Switerland who were born in a foreign country on 2017?\n### SQL query\nSELECT sum(un.in), sum(un.out) , sum(un.out)/(sum(un.in)+sum(un.out)) AS percentage FROM\n(SELECT T1.year,T1.place_of_birth,T1.citizenship, Sum(T1.amount) as in, sum(0) as out  from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year,  T1.place_of_birth, T1.citizenship\nUNION\nSELECT T1.year,T1.place_of_birth,T1.citizenship, sum(0) as in, Sum(T1.amount) as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year, T1.place_of_birth, T1.citizenship\n) AS un;\n\n\n### Question\nIn 2021, how many people were living in Switzerland who were not born there and did not have permanent residency?\n### SQL query\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2021 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nIn 2021, how many people were living in Switzerland who were not born there and did not have permanent residency?\n### SQL query\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2021 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nHow many individuals with Swiss permanent residency were born within the country's borders on 2006?\n### SQL query\n",
    "process_time": 11.255543672014028,
    "num_tokens": 3822,
    "hardness": "extra",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 55,
    "question": "How many individuals in each canton of Switzerland were born abroad and hold Swiss citizenship?",
    "query": "SELECT T2.name, T1.place_of_birth, T1.citizenship, Sum(T1.amount) from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True'   AND T1.place_of_birth = 'Abroad' AND T1.citizenship ilike '%Switzerland%'\nGROUP BY T2.name, T1.place_of_birth, T1.citizenship;\n",
    "db_id": "resident_population_birthplace_citizenship_type",
    "generated_query": "SELECT T2.name, T1.place_of_birth, T1.citizenship, Sum(T1.amount) from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Switzerland'\nGROUP BY T2.name, T1.place_of_birth, T1.citizenship;",
    "meta_data": [
      {
        "question": "How many hybrid cars do we have in the city of basel?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n"
      },
      {
        "question": "How many vehicles do we have in the city of zurich in 2021?",
        "query": "SELECT S.name, S.spatialunit_ontology, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Z_rich%'  and T.year = 2021 and S.municipal = 'True' and T.fuel_type != 'total'\nGROUP BY S.name, S.spatialunit_ontology;\n"
      },
      {
        "question": "How many individuals born abroad in canton zurich hold citizenship from Brazil?",
        "query": "SELECT T2.name, T1.place_of_birth, T1.citizenship, Sum(T1.amount) from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Z_rich%'  AND T1.place_of_birth = 'Abroad' AND T1.citizenship ilike '%Brazil%'\nGROUP BY T2.name, T1.place_of_birth, T1.citizenship;\n"
      },
      {
        "question": "Can you provide a breakdown of the number of people who hold Swiss permanent residency and were born in Switzerland in 2020, categorized by their respective citizenships?",
        "query": "SELECT T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship != 'Citizenship - total';\n"
      },
      {
        "question": "How many people who were born in Switzerland  did not possess permanent residency status by 2010?",
        "query": "SELECT T1.year, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True'  AND T1.year = 2015 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "In year 2019, how many individuals in Switzerland's permanent population were not born within the country's territory?",
        "query": "SELECT T1.year, T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2019 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "How many vehicles do we have in zurich in 2020?",
        "query": "SELECT S.name, S.spatialunit_ontology, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Z_rich%'  and T.year = 2020 and (S.canton = 'True' or S.municipal = 'True' or S.district = 'True')\nGROUP BY S.name, S.spatialunit_ontology;\n"
      },
      {
        "question": "In 2021, what percentage of the population in Switzerland consisted of individuals who were born within the country's borders?",
        "query": "SELECT un.in, un.out , un.in/(un.in + un.out) AS percentage FROM\n(SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount as in, 0 as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nUNION\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, 0 as in, T1.amount as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\n) AS un;\n"
      },
      {
        "question": "How many vehicles do we have in the city of zurich in 2021?",
        "query": "SELECT S.name, S.spatialunit_ontology, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Z_rich%'  and T.year = 2021 and S.municipal = 'True' and T.fuel_type != 'total'\nGROUP BY S.name, S.spatialunit_ontology;\n"
      },
      {
        "question": "How many electric cars do we have in the city of basel?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type = 'Electric'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n"
      },
      {
        "question": "What was the percentage of the population in Switerland who were born in a foreign country on 2017?",
        "query": "SELECT sum(un.in), sum(un.out) , sum(un.out)/(sum(un.in)+sum(un.out)) AS percentage FROM\n(SELECT T1.year,T1.place_of_birth,T1.citizenship, Sum(T1.amount) as in, sum(0) as out  from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year,  T1.place_of_birth, T1.citizenship\nUNION\nSELECT T1.year,T1.place_of_birth,T1.citizenship, sum(0) as in, Sum(T1.amount) as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year, T1.place_of_birth, T1.citizenship\n) AS un;\n"
      },
      {
        "question": "How many of the permanent population of Switzerlan have been born Aborad on the year of 2020?",
        "query": "SELECT T1.year, T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "Can you provide the breakdown of the population by different citizenships, different place of the birth and different residentship in the Canton of Obwaldent in 2011?",
        "query": "SELECT T1.citizenship, T1.population_type, T1.place_of_birth,  T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Obwalden%' AND T1.year = 2011  AND T1.place_of_birth != 'Place of birth - total' AND T1.citizenship != 'Citizenship - total'\nORDER BY citizenship;"
      },
      {
        "question": "How many electric cars do we have in the city of basel?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type = 'Electric'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n"
      },
      {
        "question": "How many of the people were born abroad in municipality level  had the permanent residenship on 2010?",
        "query": "SELECT T1.year, T2.spatialunit_ontology, T2.name, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2010 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "In 2021, what percentage of the population in Switzerland consisted of individuals who were born within the country's borders?",
        "query": "SELECT un.in, un.out , un.in/(un.in + un.out) AS percentage FROM\n(SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount as in, 0 as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nUNION\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, 0 as in, T1.amount as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\n) AS un;\n"
      },
      {
        "question": "How many people who were born in Switzerland  did not possess permanent residency status by 2010?",
        "query": "SELECT T1.year, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True'  AND T1.year = 2015 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total';\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.resident_population_birthplace_citizenship_type (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tpopulation_type VARCHAR(50), \n\tplace_of_birth VARCHAR(50), \n\tcitizenship VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT resident_population_birthplace_citizenship_type_pk PRIMARY KEY (uid), \n\tCONSTRAINT resident_population_birthplace_citizenship_type_spatial_unit_sp FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in resident_population_birthplace_citizenship_type and 5 examples in each column for high cardinality columns :\nuid : 11360041, 11359891, 11359925, 11360078, 11359962\nspatialunit_uid : 4071_A.ADM3, 869_A.ADM3, 5403_A.ADM3, 5860_A.ADM3, 2087_A.ADM3\nyear : 2014, 2011, 2013, 2015, 2012\ncitizenship : Antigua and Barbuda, Bulgaria, Sri Lanka, Rwanda, Philippines\namount : 4, 1476, 2877, 0, 2\n*/\n\n/*\nColumn name, Column discription, Example values\npopulation_type, population type, Non permanent resident population,Permanent resident population\nplace_of_birth, Place of birth: Switzerland or abroad, Abroad,Switzerland,Place of birth - total\ncitizenship, citizenship, Sweden,S\u00e3o Tom\u00e9 and Pr\u00edncipe,Uganda\namount, number of persons, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nHow many hybrid cars do we have in the city of basel?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n\n\n### Question\nHow many vehicles do we have in the city of zurich in 2021?\n### SQL query\nSELECT S.name, S.spatialunit_ontology, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Z_rich%'  and T.year = 2021 and S.municipal = 'True' and T.fuel_type != 'total'\nGROUP BY S.name, S.spatialunit_ontology;\n\n\n### Question\nHow many individuals born abroad in canton zurich hold citizenship from Brazil?\n### SQL query\nSELECT T2.name, T1.place_of_birth, T1.citizenship, Sum(T1.amount) from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Z_rich%'  AND T1.place_of_birth = 'Abroad' AND T1.citizenship ilike '%Brazil%'\nGROUP BY T2.name, T1.place_of_birth, T1.citizenship;\n\n\n### Question\nCan you provide a breakdown of the number of people who hold Swiss permanent residency and were born in Switzerland in 2020, categorized by their respective citizenships?\n### SQL query\nSELECT T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship != 'Citizenship - total';\n\n\n### Question\nHow many people who were born in Switzerland  did not possess permanent residency status by 2010?\n### SQL query\nSELECT T1.year, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True'  AND T1.year = 2015 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nIn year 2019, how many individuals in Switzerland's permanent population were not born within the country's territory?\n### SQL query\nSELECT T1.year, T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2019 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nHow many vehicles do we have in zurich in 2020?\n### SQL query\nSELECT S.name, S.spatialunit_ontology, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Z_rich%'  and T.year = 2020 and (S.canton = 'True' or S.municipal = 'True' or S.district = 'True')\nGROUP BY S.name, S.spatialunit_ontology;\n\n\n### Question\nIn 2021, what percentage of the population in Switzerland consisted of individuals who were born within the country's borders?\n### SQL query\nSELECT un.in, un.out , un.in/(un.in + un.out) AS percentage FROM\n(SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount as in, 0 as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nUNION\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, 0 as in, T1.amount as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\n) AS un;\n\n\n### Question\nHow many vehicles do we have in the city of zurich in 2021?\n### SQL query\nSELECT S.name, S.spatialunit_ontology, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Z_rich%'  and T.year = 2021 and S.municipal = 'True' and T.fuel_type != 'total'\nGROUP BY S.name, S.spatialunit_ontology;\n\n\n### Question\nHow many electric cars do we have in the city of basel?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type = 'Electric'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n\n\n### Question\nWhat was the percentage of the population in Switerland who were born in a foreign country on 2017?\n### SQL query\nSELECT sum(un.in), sum(un.out) , sum(un.out)/(sum(un.in)+sum(un.out)) AS percentage FROM\n(SELECT T1.year,T1.place_of_birth,T1.citizenship, Sum(T1.amount) as in, sum(0) as out  from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year,  T1.place_of_birth, T1.citizenship\nUNION\nSELECT T1.year,T1.place_of_birth,T1.citizenship, sum(0) as in, Sum(T1.amount) as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year, T1.place_of_birth, T1.citizenship\n) AS un;\n\n\n### Question\nHow many of the permanent population of Switzerlan have been born Aborad on the year of 2020?\n### SQL query\nSELECT T1.year, T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nCan you provide the breakdown of the population by different citizenships, different place of the birth and different residentship in the Canton of Obwaldent in 2011?\n### SQL query\nSELECT T1.citizenship, T1.population_type, T1.place_of_birth,  T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Obwalden%' AND T1.year = 2011  AND T1.place_of_birth != 'Place of birth - total' AND T1.citizenship != 'Citizenship - total'\nORDER BY citizenship;\n\n### Question\nHow many electric cars do we have in the city of basel?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type = 'Electric'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n\n\n### Question\nHow many of the people were born abroad in municipality level  had the permanent residenship on 2010?\n### SQL query\nSELECT T1.year, T2.spatialunit_ontology, T2.name, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2010 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nIn 2021, what percentage of the population in Switzerland consisted of individuals who were born within the country's borders?\n### SQL query\nSELECT un.in, un.out , un.in/(un.in + un.out) AS percentage FROM\n(SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount as in, 0 as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nUNION\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, 0 as in, T1.amount as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\n) AS un;\n\n\n### Question\nHow many people who were born in Switzerland  did not possess permanent residency status by 2010?\n### SQL query\nSELECT T1.year, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True'  AND T1.year = 2015 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nHow many individuals in each canton of Switzerland were born abroad and hold Swiss citizenship?\n### SQL query\n",
    "process_time": 6.83284312998876,
    "num_tokens": 3713,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 56,
    "question": "How many of Swiss residenc were born within the country and had Iranian Citizenship on 2018?",
    "query": "SELECT T1.year, T1.population_type, T1.place_of_birth, T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True'  AND T1.year = 2018 AND T1.place_of_birth = 'Switzerland' AND T1.citizenship ilike '%iran%';\n",
    "db_id": "resident_population_birthplace_citizenship_type",
    "generated_query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2018 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Iran';",
    "meta_data": [
      {
        "question": "How many hybrid cars do we have in the city of basel?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n"
      },
      {
        "question": "Can you provide a breakdown of the number of people who hold Swiss permanent residency and were born in Switzerland in 2020, categorized by their respective citizenships?",
        "query": "SELECT T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship != 'Citizenship - total';\n"
      },
      {
        "question": "In 2021, how many people were living in Switzerland who were not born there and did not have permanent residency?",
        "query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2021 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "In 2021, how many people were living in Switzerland who were not born there and did not have permanent residency?",
        "query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2021 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "Which municipalities had the largest population of people born in Switzerland who did not have permanent residency by 2020? show me top 5.",
        "query": "SELECT T1.year, T2.name, T1.population_type,T1.place_of_birth, T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nORDER BY T1.amount DESC\nLIMIT 5;\n"
      },
      {
        "question": "Can you provide the breakdown of the population by different citizenships, different place of the birth and different residentship in the Canton of Obwaldent in 2011?",
        "query": "SELECT T1.citizenship, T1.population_type, T1.place_of_birth,  T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Obwalden%' AND T1.year = 2011  AND T1.place_of_birth != 'Place of birth - total' AND T1.citizenship != 'Citizenship - total'\nORDER BY citizenship;"
      },
      {
        "question": "How many of the permanent population of Switzerlan have been born Aborad on the year of 2020?",
        "query": "SELECT T1.year, T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "In 2021, what percentage of the population in Switzerland consisted of individuals who were born within the country's borders?",
        "query": "SELECT un.in, un.out , un.in/(un.in + un.out) AS percentage FROM\n(SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount as in, 0 as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nUNION\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, 0 as in, T1.amount as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\n) AS un;\n"
      },
      {
        "question": "In 2021, what percentage of the population in Switzerland consisted of individuals who were born within the country's borders?",
        "query": "SELECT un.in, un.out , un.in/(un.in + un.out) AS percentage FROM\n(SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount as in, 0 as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nUNION\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, 0 as in, T1.amount as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\n) AS un;\n"
      },
      {
        "question": "How many of the people were born abroad in municipality level  had the permanent residenship on 2010?",
        "query": "SELECT T1.year, T2.spatialunit_ontology, T2.name, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2010 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "Can you provide the breakdown of the population by different citizenships, different place of the birth and different residentship in the Canton of Obwaldent in 2011?",
        "query": "SELECT T1.citizenship, T1.population_type, T1.place_of_birth,  T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Obwalden%' AND T1.year = 2011  AND T1.place_of_birth != 'Place of birth - total' AND T1.citizenship != 'Citizenship - total'\nORDER BY citizenship;"
      },
      {
        "question": "How many hybrid cars do we have in the city of basel?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n"
      },
      {
        "question": "How many hybrid cars do we have in the city of basel?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n"
      },
      {
        "question": "In 2020, what was the number of individuals categorized as non-permanent residents in the Canton of Zug?",
        "query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Zug%' AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Place of birth - total' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "How many electric cars do we have in the city of basel?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type = 'Electric'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n"
      },
      {
        "question": "How many electric cars do we have in the city of basel?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type = 'Electric'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n"
      },
      {
        "question": "How many vehicles do we have in zurich in 2020?",
        "query": "SELECT S.name, S.spatialunit_ontology, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Z_rich%'  and T.year = 2020 and (S.canton = 'True' or S.municipal = 'True' or S.district = 'True')\nGROUP BY S.name, S.spatialunit_ontology;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.resident_population_birthplace_citizenship_type (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tpopulation_type VARCHAR(50), \n\tplace_of_birth VARCHAR(50), \n\tcitizenship VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT resident_population_birthplace_citizenship_type_pk PRIMARY KEY (uid), \n\tCONSTRAINT resident_population_birthplace_citizenship_type_spatial_unit_sp FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in resident_population_birthplace_citizenship_type and 5 examples in each column for high cardinality columns :\nuid : 11360041, 11359891, 11359925, 11360078, 11359962\nspatialunit_uid : 4071_A.ADM3, 869_A.ADM3, 5403_A.ADM3, 5860_A.ADM3, 2087_A.ADM3\nyear : 2014, 2011, 2013, 2015, 2012\ncitizenship : Antigua and Barbuda, Bulgaria, Sri Lanka, Rwanda, Philippines\namount : 4, 1476, 2877, 0, 2\n*/\n\n/*\nColumn name, Column discription, Example values\npopulation_type, population type, Non permanent resident population,Permanent resident population\nplace_of_birth, Place of birth: Switzerland or abroad, Abroad,Switzerland,Place of birth - total\ncitizenship, citizenship, Sweden,S\u00e3o Tom\u00e9 and Pr\u00edncipe,Uganda\namount, number of persons, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nHow many hybrid cars do we have in the city of basel?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n\n\n### Question\nCan you provide a breakdown of the number of people who hold Swiss permanent residency and were born in Switzerland in 2020, categorized by their respective citizenships?\n### SQL query\nSELECT T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship != 'Citizenship - total';\n\n\n### Question\nIn 2021, how many people were living in Switzerland who were not born there and did not have permanent residency?\n### SQL query\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2021 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nIn 2021, how many people were living in Switzerland who were not born there and did not have permanent residency?\n### SQL query\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2021 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nWhich municipalities had the largest population of people born in Switzerland who did not have permanent residency by 2020? show me top 5.\n### SQL query\nSELECT T1.year, T2.name, T1.population_type,T1.place_of_birth, T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nORDER BY T1.amount DESC\nLIMIT 5;\n\n\n### Question\nCan you provide the breakdown of the population by different citizenships, different place of the birth and different residentship in the Canton of Obwaldent in 2011?\n### SQL query\nSELECT T1.citizenship, T1.population_type, T1.place_of_birth,  T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Obwalden%' AND T1.year = 2011  AND T1.place_of_birth != 'Place of birth - total' AND T1.citizenship != 'Citizenship - total'\nORDER BY citizenship;\n\n### Question\nHow many of the permanent population of Switzerlan have been born Aborad on the year of 2020?\n### SQL query\nSELECT T1.year, T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2020 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nIn 2021, what percentage of the population in Switzerland consisted of individuals who were born within the country's borders?\n### SQL query\nSELECT un.in, un.out , un.in/(un.in + un.out) AS percentage FROM\n(SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount as in, 0 as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nUNION\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, 0 as in, T1.amount as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\n) AS un;\n\n\n### Question\nIn 2021, what percentage of the population in Switzerland consisted of individuals who were born within the country's borders?\n### SQL query\nSELECT un.in, un.out , un.in/(un.in + un.out) AS percentage FROM\n(SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount as in, 0 as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nUNION\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, 0 as in, T1.amount as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\n) AS un;\n\n\n### Question\nHow many of the people were born abroad in municipality level  had the permanent residenship on 2010?\n### SQL query\nSELECT T1.year, T2.spatialunit_ontology, T2.name, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2010 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nCan you provide the breakdown of the population by different citizenships, different place of the birth and different residentship in the Canton of Obwaldent in 2011?\n### SQL query\nSELECT T1.citizenship, T1.population_type, T1.place_of_birth,  T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Obwalden%' AND T1.year = 2011  AND T1.place_of_birth != 'Place of birth - total' AND T1.citizenship != 'Citizenship - total'\nORDER BY citizenship;\n\n### Question\nHow many hybrid cars do we have in the city of basel?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n\n\n### Question\nHow many hybrid cars do we have in the city of basel?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n\n\n### Question\nIn 2020, what was the number of individuals categorized as non-permanent residents in the Canton of Zug?\n### SQL query\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Zug%' AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Place of birth - total' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nHow many electric cars do we have in the city of basel?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type = 'Electric'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n\n\n### Question\nHow many electric cars do we have in the city of basel?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type = 'Electric'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n\n\n### Question\nHow many vehicles do we have in zurich in 2020?\n### SQL query\nSELECT S.name, S.spatialunit_ontology, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Z_rich%'  and T.year = 2020 and (S.canton = 'True' or S.municipal = 'True' or S.district = 'True')\nGROUP BY S.name, S.spatialunit_ontology;\n\n\n### Question\nHow many of Swiss residenc were born within the country and had Iranian Citizenship on 2018?\n### SQL query\n",
    "process_time": 11.08132762904279,
    "num_tokens": 3622,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 57,
    "question": "How many vehicles do we have in canton zurich in 2020?",
    "query": "SELECT S.name, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Zurich%'  and T.year = 2020 and S.canton = 'True'\nGROUP BY S.name;\n",
    "db_id": "resident_population_birthplace_citizenship_type",
    "generated_query": "SELECT S.name, S.spatialunit_ontology, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Z_rich%'  and T.year = 2020\nGROUP BY S.name, S.spatialunit_ontology;",
    "meta_data": [
      {
        "question": "How many vehicles do we have in the city of zurich in 2021?",
        "query": "SELECT S.name, S.spatialunit_ontology, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Z_rich%'  and T.year = 2021 and S.municipal = 'True' and T.fuel_type != 'total'\nGROUP BY S.name, S.spatialunit_ontology;\n"
      },
      {
        "question": "In 2021, how many people were living in Switzerland who were not born there and did not have permanent residency?",
        "query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2021 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "In 2021, what percentage of the population in Switzerland consisted of individuals who were born within the country's borders?",
        "query": "SELECT un.in, un.out , un.in/(un.in + un.out) AS percentage FROM\n(SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount as in, 0 as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nUNION\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, 0 as in, T1.amount as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\n) AS un;\n"
      },
      {
        "question": "give me the total number of passenger cars that are using diesel in each canton?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE  S.canton = 'True' and T.fuel_type ilike '%diesel%' and T.vehicle_type = 'passenger_cars'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type;\n"
      },
      {
        "question": "How many hybrid cars do we have in the city of basel?",
        "query": "SELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n"
      },
      {
        "question": "How many of the people were born abroad in municipality level  had the permanent residenship on 2010?",
        "query": "SELECT T1.year, T2.spatialunit_ontology, T2.name, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2010 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "In 2020, what was the number of individuals categorized as non-permanent residents in the Canton of Zug?",
        "query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Zug%' AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Place of birth - total' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "In 2021, how many people were living in Switzerland who were not born there and did not have permanent residency?",
        "query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2021 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "In 2020, what was the number of individuals categorized as non-permanent residents in the Canton of Zug?",
        "query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Zug%' AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Place of birth - total' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "How many individuals born abroad in canton zurich hold citizenship from Brazil?",
        "query": "SELECT T2.name, T1.place_of_birth, T1.citizenship, Sum(T1.amount) from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Z_rich%'  AND T1.place_of_birth = 'Abroad' AND T1.citizenship ilike '%Brazil%'\nGROUP BY T2.name, T1.place_of_birth, T1.citizenship;\n"
      },
      {
        "question": "How many people who were born in Switzerland  did not possess permanent residency status by 2010?",
        "query": "SELECT T1.year, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True'  AND T1.year = 2015 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "In 2021, what percentage of the population in Switzerland consisted of individuals who were born within the country's borders?",
        "query": "SELECT un.in, un.out , un.in/(un.in + un.out) AS percentage FROM\n(SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount as in, 0 as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nUNION\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, 0 as in, T1.amount as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\n) AS un;\n"
      },
      {
        "question": "In 2020, what was the number of individuals categorized as non-permanent residents in the Canton of Zug?",
        "query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Zug%' AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Place of birth - total' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "How many individuals born abroad in canton zurich hold citizenship from Brazil?",
        "query": "SELECT T2.name, T1.place_of_birth, T1.citizenship, Sum(T1.amount) from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Z_rich%'  AND T1.place_of_birth = 'Abroad' AND T1.citizenship ilike '%Brazil%'\nGROUP BY T2.name, T1.place_of_birth, T1.citizenship;\n"
      },
      {
        "question": "In 2021, how many people were living in Switzerland who were not born there and did not have permanent residency?",
        "query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2021 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n"
      },
      {
        "question": "What was the percentage of the population in Switerland who were born in a foreign country on 2017?",
        "query": "SELECT sum(un.in), sum(un.out) , sum(un.out)/(sum(un.in)+sum(un.out)) AS percentage FROM\n(SELECT T1.year,T1.place_of_birth,T1.citizenship, Sum(T1.amount) as in, sum(0) as out  from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year,  T1.place_of_birth, T1.citizenship\nUNION\nSELECT T1.year,T1.place_of_birth,T1.citizenship, sum(0) as in, Sum(T1.amount) as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year, T1.place_of_birth, T1.citizenship\n) AS un;\n"
      },
      {
        "question": "In 2020, what was the number of individuals categorized as non-permanent residents in the Canton of Zug?",
        "query": "SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Zug%' AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Place of birth - total' AND T1.citizenship = 'Citizenship - total';\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.resident_population_birthplace_citizenship_type (\n\tuid BIGSERIAL NOT NULL, \n\tspatialunit_uid VARCHAR(100), \n\tyear INTEGER, \n\tpopulation_type VARCHAR(50), \n\tplace_of_birth VARCHAR(50), \n\tcitizenship VARCHAR(50), \n\tamount INTEGER, \n\tCONSTRAINT resident_population_birthplace_citizenship_type_pk PRIMARY KEY (uid), \n\tCONSTRAINT resident_population_birthplace_citizenship_type_spatial_unit_sp FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in resident_population_birthplace_citizenship_type and 5 examples in each column for high cardinality columns :\nuid : 11360041, 11359891, 11359925, 11360078, 11359962\nspatialunit_uid : 4071_A.ADM3, 869_A.ADM3, 5403_A.ADM3, 5860_A.ADM3, 2087_A.ADM3\nyear : 2014, 2011, 2013, 2015, 2012\ncitizenship : Antigua and Barbuda, Bulgaria, Sri Lanka, Rwanda, Philippines\namount : 4, 1476, 2877, 0, 2\n*/\n\n/*\nColumn name, Column discription, Example values\npopulation_type, population type, Non permanent resident population,Permanent resident population\nplace_of_birth, Place of birth: Switzerland or abroad, Abroad,Switzerland,Place of birth - total\ncitizenship, citizenship, Sweden,S\u00e3o Tom\u00e9 and Pr\u00edncipe,Uganda\namount, number of persons, 20\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nHow many vehicles do we have in the city of zurich in 2021?\n### SQL query\nSELECT S.name, S.spatialunit_ontology, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%Z_rich%'  and T.year = 2021 and S.municipal = 'True' and T.fuel_type != 'total'\nGROUP BY S.name, S.spatialunit_ontology;\n\n\n### Question\nIn 2021, how many people were living in Switzerland who were not born there and did not have permanent residency?\n### SQL query\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2021 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nIn 2021, what percentage of the population in Switzerland consisted of individuals who were born within the country's borders?\n### SQL query\nSELECT un.in, un.out , un.in/(un.in + un.out) AS percentage FROM\n(SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount as in, 0 as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nUNION\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, 0 as in, T1.amount as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\n) AS un;\n\n\n### Question\ngive me the total number of passenger cars that are using diesel in each canton?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE  S.canton = 'True' and T.fuel_type ilike '%diesel%' and T.vehicle_type = 'passenger_cars'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type;\n\n\n### Question\nHow many hybrid cars do we have in the city of basel?\n### SQL query\nSELECT S.name, S.spatialunit_ontology,T.fuel_type,T.year, sum(T.amount) as amount from stock_vehicles as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name ilike '%basel%'  and S.municipal = 'True' and T.fuel_type ilike '%hybrid%'\nGROUP BY S.spatialunit_ontology, S.name,T.fuel_type, T.year;\n\n\n### Question\nHow many of the people were born abroad in municipality level  had the permanent residenship on 2010?\n### SQL query\nSELECT T1.year, T2.spatialunit_ontology, T2.name, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.municipal = 'True'  AND T1.year = 2010 AND T1.population_type = 'Permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nIn 2020, what was the number of individuals categorized as non-permanent residents in the Canton of Zug?\n### SQL query\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Zug%' AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Place of birth - total' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nIn 2021, how many people were living in Switzerland who were not born there and did not have permanent residency?\n### SQL query\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2021 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nIn 2020, what was the number of individuals categorized as non-permanent residents in the Canton of Zug?\n### SQL query\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Zug%' AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Place of birth - total' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nHow many individuals born abroad in canton zurich hold citizenship from Brazil?\n### SQL query\nSELECT T2.name, T1.place_of_birth, T1.citizenship, Sum(T1.amount) from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Z_rich%'  AND T1.place_of_birth = 'Abroad' AND T1.citizenship ilike '%Brazil%'\nGROUP BY T2.name, T1.place_of_birth, T1.citizenship;\n\n\n### Question\nHow many people who were born in Switzerland  did not possess permanent residency status by 2010?\n### SQL query\nSELECT T1.year, T1.population_type,T1.place_of_birth, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True'  AND T1.year = 2015 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nIn 2021, what percentage of the population in Switzerland consisted of individuals who were born within the country's borders?\n### SQL query\nSELECT un.in, un.out , un.in/(un.in + un.out) AS percentage FROM\n(SELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount as in, 0 as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nUNION\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, 0 as in, T1.amount as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2001 AND T1.population_type = 'total' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\n) AS un;\n\n\n### Question\nIn 2020, what was the number of individuals categorized as non-permanent residents in the Canton of Zug?\n### SQL query\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Zug%' AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Place of birth - total' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nHow many individuals born abroad in canton zurich hold citizenship from Brazil?\n### SQL query\nSELECT T2.name, T1.place_of_birth, T1.citizenship, Sum(T1.amount) from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Z_rich%'  AND T1.place_of_birth = 'Abroad' AND T1.citizenship ilike '%Brazil%'\nGROUP BY T2.name, T1.place_of_birth, T1.citizenship;\n\n\n### Question\nIn 2021, how many people were living in Switzerland who were not born there and did not have permanent residency?\n### SQL query\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2021 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nWhat was the percentage of the population in Switerland who were born in a foreign country on 2017?\n### SQL query\nSELECT sum(un.in), sum(un.out) , sum(un.out)/(sum(un.in)+sum(un.out)) AS percentage FROM\n(SELECT T1.year,T1.place_of_birth,T1.citizenship, Sum(T1.amount) as in, sum(0) as out  from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Switzerland' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year,  T1.place_of_birth, T1.citizenship\nUNION\nSELECT T1.year,T1.place_of_birth,T1.citizenship, sum(0) as in, Sum(T1.amount) as out from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.country = 'True' AND T1.year = 2017  AND T1.place_of_birth = 'Abroad' AND T1.citizenship = 'Citizenship - total'\nGROUP BY T1.year, T1.place_of_birth, T1.citizenship\n) AS un;\n\n\n### Question\nIn 2020, what was the number of individuals categorized as non-permanent residents in the Canton of Zug?\n### SQL query\nSELECT T1.year,T1.population_type,T1.place_of_birth,T1.citizenship, T1.amount from resident_population_birthplace_citizenship_type AS T1\nJOIN spatial_unit AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nWHERE T2.canton = 'True' AND T2.name ilike '%Zug%' AND T1.year = 2020 AND T1.population_type = 'Non permanent resident population' AND T1.place_of_birth = 'Place of birth - total' AND T1.citizenship = 'Citizenship - total';\n\n\n### Question\nHow many vehicles do we have in canton zurich in 2020?\n### SQL query\n",
    "process_time": 8.889621712034568,
    "num_tokens": 3838,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 58,
    "question": "What proportion of the Swiss budget will be spent on health in 2010 and 2020?",
    "query": "SELECT year, SUM(percentage_of_total_expenses) as precentage_of_total_expenses_for_health\nFROM government_expenditure_by_function_cofog WHERE function_cofog_broad = 'Health'\n    AND institutional_sector = 'Government'\n    AND year <= 2020\n    AND year >= 2010\nGROUP BY year\nORDER BY year ASC;\n",
    "db_id": "government_expenditure_by_function_cofog",
    "generated_query": "SELECT year, SUM(percentage_of_total_expenses) as proportion_of_budget_for_health\nFROM government_expenditure_by_function_cofog\nWHERE function_cofog_broad = 'Health'\n    AND year IN (2010, 2020)\n    AND institutional_sector = 'Confederation'\nGROUP BY year\nORDER BY year ASC;",
    "meta_data": [
      {
        "question": "What is the distribution of cantonal education spending in year 2010?",
        "query": "SELECT function_cofog_narrow, expenses_in_million_chf as cantonal_expenses_in_mio_chf_in_2010_on_education\nFROM government_expenditure_by_function_cofog as T\nWHERE function_cofog_broad = 'Education'\n    AND year = 2020\n    AND institutional_sector = 'Canton'\nORDER BY expenses_in_million_chf DESC;\n"
      },
      {
        "question": "What percentage of the commune budget that has been allocated to communications since 2011?",
        "query": "SELECT year, SUM(T.percentage_of_total_expenses) as precentage_of_total_expenses_for_communication_by_communes\nFROM government_expenditure_by_function_cofog as T\nWHERE LOWER(function_cofog_narrow) LIKE '%communication%'\n    AND institutional_sector = 'Commune'\n    AND year >= 2011\nGROUP BY year\nORDER BY year ASC;\n"
      },
      {
        "question": "Which division had the highest government spending in 2020?",
        "query": "SELECT T.function_cofog_broad as sector_with_highest_expenses_2020\nFROM government_expenditure_by_function_cofog as T\nWHERE T.institutional_sector = 'Government' AND year = 2020\nGROUP BY T.function_cofog_broad, T.year\nORDER BY SUM(T.expenses_in_million_chf) DESC LIMIT 1;\n"
      },
      {
        "question": "What percentage of the government budget was spent on education in year 2021?",
        "query": "SELECT SUM(T.percentage_of_total_expenses) as percentage_for_total_expenses_for_education\nFROM government_expenditure_by_function_cofog as T\nWHERE institutional_sector = 'Government'\n    AND T.year = 2021\n    AND T.function_cofog_broad = 'Education'\nGROUP BY T.function_cofog_broad;\n"
      },
      {
        "question": "What were the cantons' religion-related expenditures in the year of their peak?",
        "query": "SELECT t1.year, t1.function_cofog_narrow, t1.expenses_in_million_chf\nFROM government_expenditure_by_function_cofog AS t1\nINNER JOIN (\n    SELECT year, SUM(expenses_in_million_chf) AS tot_spending\n    FROM government_expenditure_by_function_cofog WHERE LOWER(function_cofog_narrow) LIKE '%religious%' AND institutional_sector = 'Canton'\n    GROUP BY year\n    ORDER BY tot_spending DESC LIMIT 1\n) t2 ON t1.year = t2.year\nWHERE LOWER(function_cofog_narrow) LIKE '%religio%' AND t1.institutional_sector = 'Canton';\n"
      },
      {
        "question": "What percentage of the commune budget that has been allocated to communications since 2011?",
        "query": "SELECT year, SUM(T.percentage_of_total_expenses) as precentage_of_total_expenses_for_communication_by_communes\nFROM government_expenditure_by_function_cofog as T\nWHERE LOWER(function_cofog_narrow) LIKE '%communication%'\n    AND institutional_sector = 'Commune'\n    AND year >= 2011\nGROUP BY year\nORDER BY year ASC;\n"
      },
      {
        "question": "How much did each institutional sector spend on environmental protection in 2018?",
        "query": "SELECT SUM(expenses_in_million_chf) as expenses_in_mio_chf, institutional_sector\nFROM government_expenditure_by_function_cofog WHERE year = 2018 AND function_cofog_broad = 'Environmental protection'\nGROUP BY institutional_sector\nORDER BY SUM(expenses_in_million_chf) ASC;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.government_expenditure_by_function_cofog (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tfunction_cofog_narrow TEXT, \n\tfunction_cofog_broad TEXT, \n\tinstitutional_sector TEXT, \n\texpenses_in_million_chf NUMERIC, \n\tpercentage_of_total_expenses NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT government_expenditure_by_function_cofog_pkey PRIMARY KEY (uid), \n\tCONSTRAINT government_expenditure_by_function_cofog_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in government_expenditure_by_function_cofog and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nyear : 2015, 2000, 2009, 2012, 2019\nexpenses_in_million_chf : 9734, 2629, 2207, 1354, 1814\npercentage_of_total_expenses : 1.19999999999999996, 3.29999999999999982, 4.00000000000000000, 3.10000000000000009, 0E-17\n*/\n\n/*\nColumn name, Column discription, Example values\nfunction_cofog_narrow, Narrow function of govenrment by COFOG (Classification of the functions of government) of the United Nations, Foreign economic aid,General services,Executive and legislative organs, financial and fiscal affairs, external affairs\nfunction_cofog_broad, Broad function of govenrment by COFOG (Classification of the functions of government) of the United Nations, General public services,Defence,Public order and safety\ninstitutional_sector, Institutional Sector, Government,   Confederation,Canton,Commune,Social security funds\nexpenses_in_million_chf, Expenses in million CHF, 2167,2341,2599\npercentage_of_total_expenses, percentage of total expenses, 1.1,1.2,2.6\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWhat is the distribution of cantonal education spending in year 2010?\n### SQL query\nSELECT function_cofog_narrow, expenses_in_million_chf as cantonal_expenses_in_mio_chf_in_2010_on_education\nFROM government_expenditure_by_function_cofog as T\nWHERE function_cofog_broad = 'Education'\n    AND year = 2020\n    AND institutional_sector = 'Canton'\nORDER BY expenses_in_million_chf DESC;\n\n\n### Question\nWhat percentage of the commune budget that has been allocated to communications since 2011?\n### SQL query\nSELECT year, SUM(T.percentage_of_total_expenses) as precentage_of_total_expenses_for_communication_by_communes\nFROM government_expenditure_by_function_cofog as T\nWHERE LOWER(function_cofog_narrow) LIKE '%communication%'\n    AND institutional_sector = 'Commune'\n    AND year >= 2011\nGROUP BY year\nORDER BY year ASC;\n\n\n### Question\nWhich division had the highest government spending in 2020?\n### SQL query\nSELECT T.function_cofog_broad as sector_with_highest_expenses_2020\nFROM government_expenditure_by_function_cofog as T\nWHERE T.institutional_sector = 'Government' AND year = 2020\nGROUP BY T.function_cofog_broad, T.year\nORDER BY SUM(T.expenses_in_million_chf) DESC LIMIT 1;\n\n\n### Question\nWhat percentage of the government budget was spent on education in year 2021?\n### SQL query\nSELECT SUM(T.percentage_of_total_expenses) as percentage_for_total_expenses_for_education\nFROM government_expenditure_by_function_cofog as T\nWHERE institutional_sector = 'Government'\n    AND T.year = 2021\n    AND T.function_cofog_broad = 'Education'\nGROUP BY T.function_cofog_broad;\n\n\n### Question\nWhat were the cantons' religion-related expenditures in the year of their peak?\n### SQL query\nSELECT t1.year, t1.function_cofog_narrow, t1.expenses_in_million_chf\nFROM government_expenditure_by_function_cofog AS t1\nINNER JOIN (\n    SELECT year, SUM(expenses_in_million_chf) AS tot_spending\n    FROM government_expenditure_by_function_cofog WHERE LOWER(function_cofog_narrow) LIKE '%religious%' AND institutional_sector = 'Canton'\n    GROUP BY year\n    ORDER BY tot_spending DESC LIMIT 1\n) t2 ON t1.year = t2.year\nWHERE LOWER(function_cofog_narrow) LIKE '%religio%' AND t1.institutional_sector = 'Canton';\n\n\n### Question\nWhat percentage of the commune budget that has been allocated to communications since 2011?\n### SQL query\nSELECT year, SUM(T.percentage_of_total_expenses) as precentage_of_total_expenses_for_communication_by_communes\nFROM government_expenditure_by_function_cofog as T\nWHERE LOWER(function_cofog_narrow) LIKE '%communication%'\n    AND institutional_sector = 'Commune'\n    AND year >= 2011\nGROUP BY year\nORDER BY year ASC;\n\n\n### Question\nHow much did each institutional sector spend on environmental protection in 2018?\n### SQL query\nSELECT SUM(expenses_in_million_chf) as expenses_in_mio_chf, institutional_sector\nFROM government_expenditure_by_function_cofog WHERE year = 2018 AND function_cofog_broad = 'Environmental protection'\nGROUP BY institutional_sector\nORDER BY SUM(expenses_in_million_chf) ASC;\n\n\n### Question\nWhat proportion of the Swiss budget will be spent on health in 2010 and 2020?\n### SQL query\n",
    "process_time": 5.644288311013952,
    "num_tokens": 1872,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 59,
    "question": "What were the 3 largest sectors for spending of the confederation in year 2021 and how much were they?",
    "query": "SELECT SUM(T.expenses_in_million_chf) as expenses_in_mio_chf,\n  T.function_cofog_narrow as section_with_the_highest_expenses_2020\nFROM government_expenditure_by_function_cofog as T\nWHERE institutional_sector = 'Confederation' AND year = 2020\nGROUP BY T.function_cofog_narrow, T.year, T.institutional_sector\nORDER BY SUM(expenses_in_million_chf) DESC LIMIT 3;\n",
    "db_id": "government_expenditure_by_function_cofog",
    "generated_query": "SELECT function_cofog_broad, SUM(expenses_in_million_chf) as total_spending\nFROM government_expenditure_by_function_cofog\nWHERE year = 2021 AND institutional_sector = 'Confederation'\nGROUP BY function_cofog_broad\nORDER BY total_spending DESC\nLIMIT 3;",
    "meta_data": [
      {
        "question": "What were the cantons' religion-related expenditures in the year of their peak?",
        "query": "SELECT t1.year, t1.function_cofog_narrow, t1.expenses_in_million_chf\nFROM government_expenditure_by_function_cofog AS t1\nINNER JOIN (\n    SELECT year, SUM(expenses_in_million_chf) AS tot_spending\n    FROM government_expenditure_by_function_cofog WHERE LOWER(function_cofog_narrow) LIKE '%religious%' AND institutional_sector = 'Canton'\n    GROUP BY year\n    ORDER BY tot_spending DESC LIMIT 1\n) t2 ON t1.year = t2.year\nWHERE LOWER(function_cofog_narrow) LIKE '%religio%' AND t1.institutional_sector = 'Canton';\n"
      },
      {
        "question": "Which division had the highest government spending in 2020?",
        "query": "SELECT T.function_cofog_broad as sector_with_highest_expenses_2020\nFROM government_expenditure_by_function_cofog as T\nWHERE T.institutional_sector = 'Government' AND year = 2020\nGROUP BY T.function_cofog_broad, T.year\nORDER BY SUM(T.expenses_in_million_chf) DESC LIMIT 1;\n"
      },
      {
        "question": "How did police funding compare to fire funding in year 2020?",
        "query": "SELECT expenses_in_million_chf, function_cofog_narrow\nFROM government_expenditure_by_function_cofog WHERE (\n    LOWER(function_cofog_narrow) LIKE '%police%'\n    OR LOWER(function_cofog_narrow) LIKE '%fire - protection%'\n)\n    AND year = 2020\n    AND institutional_sector = 'Government';\n"
      },
      {
        "question": "How did police funding compare to fire funding in year 2020?",
        "query": "SELECT expenses_in_million_chf, function_cofog_narrow\nFROM government_expenditure_by_function_cofog WHERE (\n    LOWER(function_cofog_narrow) LIKE '%police%'\n    OR LOWER(function_cofog_narrow) LIKE '%fire - protection%'\n)\n    AND year = 2020\n    AND institutional_sector = 'Government';\n"
      },
      {
        "question": "What is the distribution of cantonal education spending in year 2010?",
        "query": "SELECT function_cofog_narrow, expenses_in_million_chf as cantonal_expenses_in_mio_chf_in_2010_on_education\nFROM government_expenditure_by_function_cofog as T\nWHERE function_cofog_broad = 'Education'\n    AND year = 2020\n    AND institutional_sector = 'Canton'\nORDER BY expenses_in_million_chf DESC;\n"
      },
      {
        "question": "How much did each institutional sector spend on environmental protection in 2018?",
        "query": "SELECT SUM(expenses_in_million_chf) as expenses_in_mio_chf, institutional_sector\nFROM government_expenditure_by_function_cofog WHERE year = 2018 AND function_cofog_broad = 'Environmental protection'\nGROUP BY institutional_sector\nORDER BY SUM(expenses_in_million_chf) ASC;\n"
      },
      {
        "question": "How much did each institutional sector spend on environmental protection in 2018?",
        "query": "SELECT SUM(expenses_in_million_chf) as expenses_in_mio_chf, institutional_sector\nFROM government_expenditure_by_function_cofog WHERE year = 2018 AND function_cofog_broad = 'Environmental protection'\nGROUP BY institutional_sector\nORDER BY SUM(expenses_in_million_chf) ASC;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.government_expenditure_by_function_cofog (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tfunction_cofog_narrow TEXT, \n\tfunction_cofog_broad TEXT, \n\tinstitutional_sector TEXT, \n\texpenses_in_million_chf NUMERIC, \n\tpercentage_of_total_expenses NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT government_expenditure_by_function_cofog_pkey PRIMARY KEY (uid), \n\tCONSTRAINT government_expenditure_by_function_cofog_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in government_expenditure_by_function_cofog and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nyear : 2015, 2000, 2009, 2012, 2019\nexpenses_in_million_chf : 9734, 2629, 2207, 1354, 1814\npercentage_of_total_expenses : 1.19999999999999996, 3.29999999999999982, 4.00000000000000000, 3.10000000000000009, 0E-17\n*/\n\n/*\nColumn name, Column discription, Example values\nfunction_cofog_narrow, Narrow function of govenrment by COFOG (Classification of the functions of government) of the United Nations, Foreign economic aid,General services,Executive and legislative organs, financial and fiscal affairs, external affairs\nfunction_cofog_broad, Broad function of govenrment by COFOG (Classification of the functions of government) of the United Nations, General public services,Defence,Public order and safety\ninstitutional_sector, Institutional Sector, Government,   Confederation,Canton,Commune,Social security funds\nexpenses_in_million_chf, Expenses in million CHF, 2167,2341,2599\npercentage_of_total_expenses, percentage of total expenses, 1.1,1.2,2.6\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWhat were the cantons' religion-related expenditures in the year of their peak?\n### SQL query\nSELECT t1.year, t1.function_cofog_narrow, t1.expenses_in_million_chf\nFROM government_expenditure_by_function_cofog AS t1\nINNER JOIN (\n    SELECT year, SUM(expenses_in_million_chf) AS tot_spending\n    FROM government_expenditure_by_function_cofog WHERE LOWER(function_cofog_narrow) LIKE '%religious%' AND institutional_sector = 'Canton'\n    GROUP BY year\n    ORDER BY tot_spending DESC LIMIT 1\n) t2 ON t1.year = t2.year\nWHERE LOWER(function_cofog_narrow) LIKE '%religio%' AND t1.institutional_sector = 'Canton';\n\n\n### Question\nWhich division had the highest government spending in 2020?\n### SQL query\nSELECT T.function_cofog_broad as sector_with_highest_expenses_2020\nFROM government_expenditure_by_function_cofog as T\nWHERE T.institutional_sector = 'Government' AND year = 2020\nGROUP BY T.function_cofog_broad, T.year\nORDER BY SUM(T.expenses_in_million_chf) DESC LIMIT 1;\n\n\n### Question\nHow did police funding compare to fire funding in year 2020?\n### SQL query\nSELECT expenses_in_million_chf, function_cofog_narrow\nFROM government_expenditure_by_function_cofog WHERE (\n    LOWER(function_cofog_narrow) LIKE '%police%'\n    OR LOWER(function_cofog_narrow) LIKE '%fire - protection%'\n)\n    AND year = 2020\n    AND institutional_sector = 'Government';\n\n\n### Question\nHow did police funding compare to fire funding in year 2020?\n### SQL query\nSELECT expenses_in_million_chf, function_cofog_narrow\nFROM government_expenditure_by_function_cofog WHERE (\n    LOWER(function_cofog_narrow) LIKE '%police%'\n    OR LOWER(function_cofog_narrow) LIKE '%fire - protection%'\n)\n    AND year = 2020\n    AND institutional_sector = 'Government';\n\n\n### Question\nWhat is the distribution of cantonal education spending in year 2010?\n### SQL query\nSELECT function_cofog_narrow, expenses_in_million_chf as cantonal_expenses_in_mio_chf_in_2010_on_education\nFROM government_expenditure_by_function_cofog as T\nWHERE function_cofog_broad = 'Education'\n    AND year = 2020\n    AND institutional_sector = 'Canton'\nORDER BY expenses_in_million_chf DESC;\n\n\n### Question\nHow much did each institutional sector spend on environmental protection in 2018?\n### SQL query\nSELECT SUM(expenses_in_million_chf) as expenses_in_mio_chf, institutional_sector\nFROM government_expenditure_by_function_cofog WHERE year = 2018 AND function_cofog_broad = 'Environmental protection'\nGROUP BY institutional_sector\nORDER BY SUM(expenses_in_million_chf) ASC;\n\n\n### Question\nHow much did each institutional sector spend on environmental protection in 2018?\n### SQL query\nSELECT SUM(expenses_in_million_chf) as expenses_in_mio_chf, institutional_sector\nFROM government_expenditure_by_function_cofog WHERE year = 2018 AND function_cofog_broad = 'Environmental protection'\nGROUP BY institutional_sector\nORDER BY SUM(expenses_in_million_chf) ASC;\n\n\n### Question\nWhat were the 3 largest sectors for spending of the confederation in year 2021 and how much were they?\n### SQL query\n",
    "process_time": 4.904512227978557,
    "num_tokens": 1856,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 60,
    "question": "What proportion of the Swiss budget is invested in public safety each year?",
    "query": "SELECT year, SUM(T.percentage_of_total_expenses) as percentage_of_total_expenses_for_safety\nFROM government_expenditure_by_function_cofog AS T\nWHERE LOWER(function_cofog_broad) LIKE '%public%safety%'\n    AND institutional_sector = 'Government'\nGROUP BY year\nORDER BY year ASC;\n",
    "db_id": "government_expenditure_by_function_cofog",
    "generated_query": "SELECT year, SUM(percentage_of_total_expenses) as proportion_invested_in_public_safety\nFROM government_expenditure_by_function_cofog\nWHERE function_cofog_broad = 'Public order and safety'\nGROUP BY year\nORDER BY year;",
    "meta_data": [
      {
        "question": "Which division had the highest government spending in 2020?",
        "query": "SELECT T.function_cofog_broad as sector_with_highest_expenses_2020\nFROM government_expenditure_by_function_cofog as T\nWHERE T.institutional_sector = 'Government' AND year = 2020\nGROUP BY T.function_cofog_broad, T.year\nORDER BY SUM(T.expenses_in_million_chf) DESC LIMIT 1;\n"
      },
      {
        "question": "Which division had the highest government spending in 2020?",
        "query": "SELECT T.function_cofog_broad as sector_with_highest_expenses_2020\nFROM government_expenditure_by_function_cofog as T\nWHERE T.institutional_sector = 'Government' AND year = 2020\nGROUP BY T.function_cofog_broad, T.year\nORDER BY SUM(T.expenses_in_million_chf) DESC LIMIT 1;\n"
      },
      {
        "question": "How much did each institutional sector spend on environmental protection in 2018?",
        "query": "SELECT SUM(expenses_in_million_chf) as expenses_in_mio_chf, institutional_sector\nFROM government_expenditure_by_function_cofog WHERE year = 2018 AND function_cofog_broad = 'Environmental protection'\nGROUP BY institutional_sector\nORDER BY SUM(expenses_in_million_chf) ASC;\n"
      },
      {
        "question": "What were the cantons' religion-related expenditures in the year of their peak?",
        "query": "SELECT t1.year, t1.function_cofog_narrow, t1.expenses_in_million_chf\nFROM government_expenditure_by_function_cofog AS t1\nINNER JOIN (\n    SELECT year, SUM(expenses_in_million_chf) AS tot_spending\n    FROM government_expenditure_by_function_cofog WHERE LOWER(function_cofog_narrow) LIKE '%religious%' AND institutional_sector = 'Canton'\n    GROUP BY year\n    ORDER BY tot_spending DESC LIMIT 1\n) t2 ON t1.year = t2.year\nWHERE LOWER(function_cofog_narrow) LIKE '%religio%' AND t1.institutional_sector = 'Canton';\n"
      },
      {
        "question": "What percentage of the government budget was spent on education in year 2021?",
        "query": "SELECT SUM(T.percentage_of_total_expenses) as percentage_for_total_expenses_for_education\nFROM government_expenditure_by_function_cofog as T\nWHERE institutional_sector = 'Government'\n    AND T.year = 2021\n    AND T.function_cofog_broad = 'Education'\nGROUP BY T.function_cofog_broad;\n"
      },
      {
        "question": "Which division had the highest government spending in 2020?",
        "query": "SELECT T.function_cofog_broad as sector_with_highest_expenses_2020\nFROM government_expenditure_by_function_cofog as T\nWHERE T.institutional_sector = 'Government' AND year = 2020\nGROUP BY T.function_cofog_broad, T.year\nORDER BY SUM(T.expenses_in_million_chf) DESC LIMIT 1;\n"
      },
      {
        "question": "What is the distribution of cantonal education spending in year 2010?",
        "query": "SELECT function_cofog_narrow, expenses_in_million_chf as cantonal_expenses_in_mio_chf_in_2010_on_education\nFROM government_expenditure_by_function_cofog as T\nWHERE function_cofog_broad = 'Education'\n    AND year = 2020\n    AND institutional_sector = 'Canton'\nORDER BY expenses_in_million_chf DESC;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.government_expenditure_by_function_cofog (\n\tuid SERIAL NOT NULL, \n\tyear INTEGER, \n\tfunction_cofog_narrow TEXT, \n\tfunction_cofog_broad TEXT, \n\tinstitutional_sector TEXT, \n\texpenses_in_million_chf NUMERIC, \n\tpercentage_of_total_expenses NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT government_expenditure_by_function_cofog_pkey PRIMARY KEY (uid), \n\tCONSTRAINT government_expenditure_by_function_cofog_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in government_expenditure_by_function_cofog and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nyear : 2015, 2000, 2009, 2012, 2019\nexpenses_in_million_chf : 9734, 2629, 2207, 1354, 1814\npercentage_of_total_expenses : 1.19999999999999996, 3.29999999999999982, 4.00000000000000000, 3.10000000000000009, 0E-17\n*/\n\n/*\nColumn name, Column discription, Example values\nfunction_cofog_narrow, Narrow function of govenrment by COFOG (Classification of the functions of government) of the United Nations, Foreign economic aid,General services,Executive and legislative organs, financial and fiscal affairs, external affairs\nfunction_cofog_broad, Broad function of govenrment by COFOG (Classification of the functions of government) of the United Nations, General public services,Defence,Public order and safety\ninstitutional_sector, Institutional Sector, Government,   Confederation,Canton,Commune,Social security funds\nexpenses_in_million_chf, Expenses in million CHF, 2167,2341,2599\npercentage_of_total_expenses, percentage of total expenses, 1.1,1.2,2.6\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWhich division had the highest government spending in 2020?\n### SQL query\nSELECT T.function_cofog_broad as sector_with_highest_expenses_2020\nFROM government_expenditure_by_function_cofog as T\nWHERE T.institutional_sector = 'Government' AND year = 2020\nGROUP BY T.function_cofog_broad, T.year\nORDER BY SUM(T.expenses_in_million_chf) DESC LIMIT 1;\n\n\n### Question\nWhich division had the highest government spending in 2020?\n### SQL query\nSELECT T.function_cofog_broad as sector_with_highest_expenses_2020\nFROM government_expenditure_by_function_cofog as T\nWHERE T.institutional_sector = 'Government' AND year = 2020\nGROUP BY T.function_cofog_broad, T.year\nORDER BY SUM(T.expenses_in_million_chf) DESC LIMIT 1;\n\n\n### Question\nHow much did each institutional sector spend on environmental protection in 2018?\n### SQL query\nSELECT SUM(expenses_in_million_chf) as expenses_in_mio_chf, institutional_sector\nFROM government_expenditure_by_function_cofog WHERE year = 2018 AND function_cofog_broad = 'Environmental protection'\nGROUP BY institutional_sector\nORDER BY SUM(expenses_in_million_chf) ASC;\n\n\n### Question\nWhat were the cantons' religion-related expenditures in the year of their peak?\n### SQL query\nSELECT t1.year, t1.function_cofog_narrow, t1.expenses_in_million_chf\nFROM government_expenditure_by_function_cofog AS t1\nINNER JOIN (\n    SELECT year, SUM(expenses_in_million_chf) AS tot_spending\n    FROM government_expenditure_by_function_cofog WHERE LOWER(function_cofog_narrow) LIKE '%religious%' AND institutional_sector = 'Canton'\n    GROUP BY year\n    ORDER BY tot_spending DESC LIMIT 1\n) t2 ON t1.year = t2.year\nWHERE LOWER(function_cofog_narrow) LIKE '%religio%' AND t1.institutional_sector = 'Canton';\n\n\n### Question\nWhat percentage of the government budget was spent on education in year 2021?\n### SQL query\nSELECT SUM(T.percentage_of_total_expenses) as percentage_for_total_expenses_for_education\nFROM government_expenditure_by_function_cofog as T\nWHERE institutional_sector = 'Government'\n    AND T.year = 2021\n    AND T.function_cofog_broad = 'Education'\nGROUP BY T.function_cofog_broad;\n\n\n### Question\nWhich division had the highest government spending in 2020?\n### SQL query\nSELECT T.function_cofog_broad as sector_with_highest_expenses_2020\nFROM government_expenditure_by_function_cofog as T\nWHERE T.institutional_sector = 'Government' AND year = 2020\nGROUP BY T.function_cofog_broad, T.year\nORDER BY SUM(T.expenses_in_million_chf) DESC LIMIT 1;\n\n\n### Question\nWhat is the distribution of cantonal education spending in year 2010?\n### SQL query\nSELECT function_cofog_narrow, expenses_in_million_chf as cantonal_expenses_in_mio_chf_in_2010_on_education\nFROM government_expenditure_by_function_cofog as T\nWHERE function_cofog_broad = 'Education'\n    AND year = 2020\n    AND institutional_sector = 'Canton'\nORDER BY expenses_in_million_chf DESC;\n\n\n### Question\nWhat proportion of the Swiss budget is invested in public safety each year?\n### SQL query\n",
    "process_time": 5.408930579200387,
    "num_tokens": 1858,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "en"
  },
  {
    "i": 61,
    "question": "Welches drei medizinischen Ger\u00e4te hatten den meisten Zuwachs zwischen 2013 und 2021 in der Schweiz und wieviele Neuanschaffungen gab es jeweils?",
    "query": "SELECT T.genutzte_infrastruktur,\n    SUM(CASE WHEN T.jahr = 2021 THEN T.anzahl_gerate ELSE - T.anzahl_gerate END) AS zuwachs_an_geraeten\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country\n    AND T.jahr IN (2013, 2021)\nGROUP BY T.genutzte_infrastruktur\nORDER BY zuwachs_an_geraeten DESC\nLIMIT 3;\n",
    "db_id": "medizinisch_technische_infrastruktur",
    "generated_query": "WITH Gerate2013 AS (\nSELECT SUM(T1.anzahl_gerate) as anzahl_gerate_2013,\n  T1.genutzte_infrastruktur\nFROM medizinisch_technische_infrastruktur as T1\nJOIN spatial_unit as S1 on T1.spatialunit_uid = S1.spatialunit_uid\nWHERE S1.country = 'TRUE'\n  AND T1.jahr = 2013\nGROUP BY T1.genutzte_infrastruktur\n),\nGerate2021 AS (\n    SELECT SUM(T2.anzahl_gerate) as anzahl_gerate_2021,\n      T2.genutzte_infrastruktur\n    FROM medizinisch_technische_infrastruktur as T2\n    JOIN spatial_unit as S2 on T2.spatialunit_uid = S2.spatialunit_uid\n    WHERE S2.country = 'TRUE'\n      AND T2.jahr = 2021\n    GROUP BY T2.genutzte_infrastruktur\n)\nSELECT\n    G2021.genutzte_infrastruktur,\n    G2021.anzahl_gerate_2021 - G2013.anzahl_gerate_2013 AS zuwachs_geraete\nFROM Gerate2013 AS G2013\nJOIN Gerate2021 AS G2021 ON G2013.genutzte_infrastruktur = G2021.genutzte_infrastruktur\nORDER BY zuwachs_geraete DESC\nLIMIT 3;",
    "meta_data": [
      {
        "question": "Welche medizinischen Ger\u00e4te z\u00e4hlen in der Schweiz zur medizinischen Infrastruktur und wieviele gab es davon jeweils 2020? Sortiere nach Ger\u00e4teanzahl.",
        "query": "SELECT SUM(T.anzahl_gerate) as gerate_anzahl_2020, T.genutzte_infrastruktur\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.jahr = 2020\nGROUP BY T.genutzte_infrastruktur\nORDER BY gerate_anzahl_2020 DESC;\n"
      },
      {
        "question": "Welche f\u00fcnf Kantone machte 2021 den besten Nutzen von seiner CT Scanner mit den meisten Untersuchungen pro CT Scanner und wieviele Untersuchungen gab es pro Ger\u00e4t und auf wieviele Ger\u00e4te verteilten sie sich?",
        "query": "SELECT S.name_de as kanton_mit_meisten_untersuchungen_pro_geraet,\n  ROUND(SUM(T.anzahl_untersuchungen_total) / SUM(T.anzahl_gerate), 0) as untersuchungen_pro_geraet,\n  SUM(T.anzahl_gerate) as anzahl_geraete\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.jahr = 2021\n  AND T.genutzte_infrastruktur LIKE 'CT%'\n  AND T.anzahl_gerate != 0\nGROUP BY S.name_de\nORDER BY untersuchungen_pro_geraet DESC LIMIT 5;\n"
      },
      {
        "question": "Welchem drei Kantone hatte den gr\u00f6ssten Zuwachs und Untersuchungen mit medizinischen Ger\u00e4ten zwischen 2013 and 2021 und wieviel hoch war der Zuwachs verteilt auf ambulante und station\u00e4re Untersuchungen und Ger\u00e4te?",
        "query": "WITH Untersuchungen2013 AS (\nSELECT SUM(T1.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2013,\n  SUM(T1.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2013,\n  SUM(T1.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2013,\n  SUM(T1.anzahl_gerate) as anzahl_gerate_2013,\n  S1.name_de as kanton\n    FROM medizinisch_technische_infrastruktur as T1\n    JOIN spatial_unit as S1 on T1.spatialunit_uid = S1.spatialunit_uid\n    WHERE S1.canton = 'TRUE'\n      AND T1.jahr = 2013\n    GROUP BY S1.name_de\n),\nUntersuchungen2021 AS (\n    SELECT SUM(T2.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2021,\n      SUM(T2.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2021,\n      SUM(T2.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2021,\n      SUM(T2.anzahl_gerate) as anzahl_gerate_2021,\n      S2.name_de as kanton2021\n    FROM medizinisch_technische_infrastruktur as T2\n    JOIN spatial_unit as S2 on T2.spatialunit_uid = S2.spatialunit_uid\n    WHERE S2.canton = 'TRUE'\n      AND T2.jahr = 2021\n    GROUP BY S2.name_de\n)\nSELECT\n    U2013.kanton,\n    U2021.anzahl_untersuchungen_gesamt_2021 - U2013.anzahl_untersuchungen_gesamt_2013 AS zuwachs_untersuchungen_gesamt,\n    U2021.anzahl_ambulante_untersuchungen_2021 - U2013.anzahl_ambulante_untersuchungen_2013 AS zuwachs_ambulante_untersuchungen,\n    U2021.anzahl_stationare_untersuchungen_2021 - U2013.anzahl_stationare_untersuchungen_2013 AS zuwachs_statinon\u00e4re_untersuchungen,\n    U2021.anzahl_gerate_2021 - U2013.anzahl_gerate_2013 AS zuwachs_geraete\nFROM Untersuchungen2013 AS U2013\nJOIN Untersuchungen2021 AS U2021 ON U2013.kanton = U2021.kanton2021\nORDER BY zuwachs_untersuchungen_gesamt DESC\nLIMIT 3;\n"
      },
      {
        "question": "Welchem drei Kantone hatte den gr\u00f6ssten Zuwachs und Untersuchungen mit medizinischen Ger\u00e4ten zwischen 2013 and 2021 und wieviel hoch war der Zuwachs verteilt auf ambulante und station\u00e4re Untersuchungen und Ger\u00e4te?",
        "query": "WITH Untersuchungen2013 AS (\nSELECT SUM(T1.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2013,\n  SUM(T1.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2013,\n  SUM(T1.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2013,\n  SUM(T1.anzahl_gerate) as anzahl_gerate_2013,\n  S1.name_de as kanton\n    FROM medizinisch_technische_infrastruktur as T1\n    JOIN spatial_unit as S1 on T1.spatialunit_uid = S1.spatialunit_uid\n    WHERE S1.canton = 'TRUE'\n      AND T1.jahr = 2013\n    GROUP BY S1.name_de\n),\nUntersuchungen2021 AS (\n    SELECT SUM(T2.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2021,\n      SUM(T2.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2021,\n      SUM(T2.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2021,\n      SUM(T2.anzahl_gerate) as anzahl_gerate_2021,\n      S2.name_de as kanton2021\n    FROM medizinisch_technische_infrastruktur as T2\n    JOIN spatial_unit as S2 on T2.spatialunit_uid = S2.spatialunit_uid\n    WHERE S2.canton = 'TRUE'\n      AND T2.jahr = 2021\n    GROUP BY S2.name_de\n)\nSELECT\n    U2013.kanton,\n    U2021.anzahl_untersuchungen_gesamt_2021 - U2013.anzahl_untersuchungen_gesamt_2013 AS zuwachs_untersuchungen_gesamt,\n    U2021.anzahl_ambulante_untersuchungen_2021 - U2013.anzahl_ambulante_untersuchungen_2013 AS zuwachs_ambulante_untersuchungen,\n    U2021.anzahl_stationare_untersuchungen_2021 - U2013.anzahl_stationare_untersuchungen_2013 AS zuwachs_statinon\u00e4re_untersuchungen,\n    U2021.anzahl_gerate_2021 - U2013.anzahl_gerate_2013 AS zuwachs_geraete\nFROM Untersuchungen2013 AS U2013\nJOIN Untersuchungen2021 AS U2021 ON U2013.kanton = U2021.kanton2021\nORDER BY zuwachs_untersuchungen_gesamt DESC\nLIMIT 3;\n"
      },
      {
        "question": "Welche f\u00fcnf Kantone machte 2021 den besten Nutzen von seiner CT Scanner mit den meisten Untersuchungen pro CT Scanner und wieviele Untersuchungen gab es pro Ger\u00e4t und auf wieviele Ger\u00e4te verteilten sie sich?",
        "query": "SELECT S.name_de as kanton_mit_meisten_untersuchungen_pro_geraet,\n  ROUND(SUM(T.anzahl_untersuchungen_total) / SUM(T.anzahl_gerate), 0) as untersuchungen_pro_geraet,\n  SUM(T.anzahl_gerate) as anzahl_geraete\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.jahr = 2021\n  AND T.genutzte_infrastruktur LIKE 'CT%'\n  AND T.anzahl_gerate != 0\nGROUP BY S.name_de\nORDER BY untersuchungen_pro_geraet DESC LIMIT 5;\n"
      },
      {
        "question": "Welche drei Kantone haben 2021 den h\u00f6chsten prozentualen Anteil an ambulanten CT Untersuchungen und wie hoch war er?",
        "query": "SELECT s.name_de as kanton,\n  ROUND(SUM(T.anzahl_ambulante_untersuchungen) * 100 / SUM(T.anzahl_untersuchungen_total), 2) as prozent_ambulante_untersuchungen\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.jahr = '2021'\n  AND T.genutzte_infrastruktur LIKE 'CT%'\n  AND T.anzahl_untersuchungen_total != 0\nGROUP BY S.name_de\nORDER BY prozent_ambulante_untersuchungen DESC LIMIT 3;\n"
      },
      {
        "question": "Wieviele Angiographieger\u00e4te gab es 2013 in der Schweiz?",
        "query": "SELECT SUM(anzahl_gerate) as anzahl_gerate_in_2013\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND jahr = '2013'\n  AND T.genutzte_infrastruktur LIKE '%Angiographie%';\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.medizinisch_technische_infrastruktur (\n\tuid SERIAL NOT NULL, \n\tgenutzte_infrastruktur TEXT, \n\tjahr INTEGER, \n\tanzahl_gerate NUMERIC, \n\tanzahl_untersuchungen_total NUMERIC, \n\tanzahl_ambulante_untersuchungen NUMERIC, \n\tanzahl_stationare_untersuchungen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT medizinisch_technische_infrastruktur_pkey PRIMARY KEY (uid), \n\tCONSTRAINT medizinisch_technische_infrastruktur_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in medizinisch_technische_infrastruktur and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nanzahl_gerate : 4, 27, 226, 23, 29\nanzahl_untersuchungen_total : 9631, 830373, 23916, 2401, 24595\nanzahl_ambulante_untersuchungen : 235, 481, 12225, 3727, 14415\nanzahl_stationare_untersuchungen : 54383, 23613, 7023, 5861, 110\nspatialunit_uid : 0_CH, 25_A.ADM1, 22_A.ADM1, 1_A.ADM1, 2_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\ngenutzte_infrastruktur, genutzte Infrastruktur, Gamma Camera (inklusive Szintigraphie und SPECT-Scanner),Linearbeschleuniger (Radiotherapie),MRI\nanzahl_gerate, Anzahl der Ger\u00e4te, None\nanzahl_untersuchungen_total, Anzahl aller Untersuchungen, None\nanzahl_ambulante_untersuchungen, Anzahl der ambulanten Untersuchungen, None\nanzahl_stationare_untersuchungen, Anzahl der station\u00e4ren Untersuchungen, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWelche medizinischen Ger\u00e4te z\u00e4hlen in der Schweiz zur medizinischen Infrastruktur und wieviele gab es davon jeweils 2020? Sortiere nach Ger\u00e4teanzahl.\n### SQL query\nSELECT SUM(T.anzahl_gerate) as gerate_anzahl_2020, T.genutzte_infrastruktur\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.jahr = 2020\nGROUP BY T.genutzte_infrastruktur\nORDER BY gerate_anzahl_2020 DESC;\n\n\n### Question\nWelche f\u00fcnf Kantone machte 2021 den besten Nutzen von seiner CT Scanner mit den meisten Untersuchungen pro CT Scanner und wieviele Untersuchungen gab es pro Ger\u00e4t und auf wieviele Ger\u00e4te verteilten sie sich?\n### SQL query\nSELECT S.name_de as kanton_mit_meisten_untersuchungen_pro_geraet,\n  ROUND(SUM(T.anzahl_untersuchungen_total) / SUM(T.anzahl_gerate), 0) as untersuchungen_pro_geraet,\n  SUM(T.anzahl_gerate) as anzahl_geraete\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.jahr = 2021\n  AND T.genutzte_infrastruktur LIKE 'CT%'\n  AND T.anzahl_gerate != 0\nGROUP BY S.name_de\nORDER BY untersuchungen_pro_geraet DESC LIMIT 5;\n\n\n### Question\nWelchem drei Kantone hatte den gr\u00f6ssten Zuwachs und Untersuchungen mit medizinischen Ger\u00e4ten zwischen 2013 and 2021 und wieviel hoch war der Zuwachs verteilt auf ambulante und station\u00e4re Untersuchungen und Ger\u00e4te?\n### SQL query\nWITH Untersuchungen2013 AS (\nSELECT SUM(T1.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2013,\n  SUM(T1.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2013,\n  SUM(T1.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2013,\n  SUM(T1.anzahl_gerate) as anzahl_gerate_2013,\n  S1.name_de as kanton\n    FROM medizinisch_technische_infrastruktur as T1\n    JOIN spatial_unit as S1 on T1.spatialunit_uid = S1.spatialunit_uid\n    WHERE S1.canton = 'TRUE'\n      AND T1.jahr = 2013\n    GROUP BY S1.name_de\n),\nUntersuchungen2021 AS (\n    SELECT SUM(T2.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2021,\n      SUM(T2.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2021,\n      SUM(T2.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2021,\n      SUM(T2.anzahl_gerate) as anzahl_gerate_2021,\n      S2.name_de as kanton2021\n    FROM medizinisch_technische_infrastruktur as T2\n    JOIN spatial_unit as S2 on T2.spatialunit_uid = S2.spatialunit_uid\n    WHERE S2.canton = 'TRUE'\n      AND T2.jahr = 2021\n    GROUP BY S2.name_de\n)\nSELECT\n    U2013.kanton,\n    U2021.anzahl_untersuchungen_gesamt_2021 - U2013.anzahl_untersuchungen_gesamt_2013 AS zuwachs_untersuchungen_gesamt,\n    U2021.anzahl_ambulante_untersuchungen_2021 - U2013.anzahl_ambulante_untersuchungen_2013 AS zuwachs_ambulante_untersuchungen,\n    U2021.anzahl_stationare_untersuchungen_2021 - U2013.anzahl_stationare_untersuchungen_2013 AS zuwachs_statinon\u00e4re_untersuchungen,\n    U2021.anzahl_gerate_2021 - U2013.anzahl_gerate_2013 AS zuwachs_geraete\nFROM Untersuchungen2013 AS U2013\nJOIN Untersuchungen2021 AS U2021 ON U2013.kanton = U2021.kanton2021\nORDER BY zuwachs_untersuchungen_gesamt DESC\nLIMIT 3;\n\n\n### Question\nWelchem drei Kantone hatte den gr\u00f6ssten Zuwachs und Untersuchungen mit medizinischen Ger\u00e4ten zwischen 2013 and 2021 und wieviel hoch war der Zuwachs verteilt auf ambulante und station\u00e4re Untersuchungen und Ger\u00e4te?\n### SQL query\nWITH Untersuchungen2013 AS (\nSELECT SUM(T1.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2013,\n  SUM(T1.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2013,\n  SUM(T1.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2013,\n  SUM(T1.anzahl_gerate) as anzahl_gerate_2013,\n  S1.name_de as kanton\n    FROM medizinisch_technische_infrastruktur as T1\n    JOIN spatial_unit as S1 on T1.spatialunit_uid = S1.spatialunit_uid\n    WHERE S1.canton = 'TRUE'\n      AND T1.jahr = 2013\n    GROUP BY S1.name_de\n),\nUntersuchungen2021 AS (\n    SELECT SUM(T2.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2021,\n      SUM(T2.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2021,\n      SUM(T2.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2021,\n      SUM(T2.anzahl_gerate) as anzahl_gerate_2021,\n      S2.name_de as kanton2021\n    FROM medizinisch_technische_infrastruktur as T2\n    JOIN spatial_unit as S2 on T2.spatialunit_uid = S2.spatialunit_uid\n    WHERE S2.canton = 'TRUE'\n      AND T2.jahr = 2021\n    GROUP BY S2.name_de\n)\nSELECT\n    U2013.kanton,\n    U2021.anzahl_untersuchungen_gesamt_2021 - U2013.anzahl_untersuchungen_gesamt_2013 AS zuwachs_untersuchungen_gesamt,\n    U2021.anzahl_ambulante_untersuchungen_2021 - U2013.anzahl_ambulante_untersuchungen_2013 AS zuwachs_ambulante_untersuchungen,\n    U2021.anzahl_stationare_untersuchungen_2021 - U2013.anzahl_stationare_untersuchungen_2013 AS zuwachs_statinon\u00e4re_untersuchungen,\n    U2021.anzahl_gerate_2021 - U2013.anzahl_gerate_2013 AS zuwachs_geraete\nFROM Untersuchungen2013 AS U2013\nJOIN Untersuchungen2021 AS U2021 ON U2013.kanton = U2021.kanton2021\nORDER BY zuwachs_untersuchungen_gesamt DESC\nLIMIT 3;\n\n\n### Question\nWelche f\u00fcnf Kantone machte 2021 den besten Nutzen von seiner CT Scanner mit den meisten Untersuchungen pro CT Scanner und wieviele Untersuchungen gab es pro Ger\u00e4t und auf wieviele Ger\u00e4te verteilten sie sich?\n### SQL query\nSELECT S.name_de as kanton_mit_meisten_untersuchungen_pro_geraet,\n  ROUND(SUM(T.anzahl_untersuchungen_total) / SUM(T.anzahl_gerate), 0) as untersuchungen_pro_geraet,\n  SUM(T.anzahl_gerate) as anzahl_geraete\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.jahr = 2021\n  AND T.genutzte_infrastruktur LIKE 'CT%'\n  AND T.anzahl_gerate != 0\nGROUP BY S.name_de\nORDER BY untersuchungen_pro_geraet DESC LIMIT 5;\n\n\n### Question\nWelche drei Kantone haben 2021 den h\u00f6chsten prozentualen Anteil an ambulanten CT Untersuchungen und wie hoch war er?\n### SQL query\nSELECT s.name_de as kanton,\n  ROUND(SUM(T.anzahl_ambulante_untersuchungen) * 100 / SUM(T.anzahl_untersuchungen_total), 2) as prozent_ambulante_untersuchungen\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.jahr = '2021'\n  AND T.genutzte_infrastruktur LIKE 'CT%'\n  AND T.anzahl_untersuchungen_total != 0\nGROUP BY S.name_de\nORDER BY prozent_ambulante_untersuchungen DESC LIMIT 3;\n\n\n### Question\nWieviele Angiographieger\u00e4te gab es 2013 in der Schweiz?\n### SQL query\nSELECT SUM(anzahl_gerate) as anzahl_gerate_in_2013\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND jahr = '2013'\n  AND T.genutzte_infrastruktur LIKE '%Angiographie%';\n\n\n### Question\nWelches drei medizinischen Ger\u00e4te hatten den meisten Zuwachs zwischen 2013 und 2021 in der Schweiz und wieviele Neuanschaffungen gab es jeweils?\n### SQL query\n",
    "process_time": 22.58926600101404,
    "num_tokens": 3469,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 62,
    "question": "Welches war das medizinische Ger\u00e4t 2021 in der Schweiz mit den meisten Untersuchungen und wieviele Untersuchungen gab es damit?",
    "query": "SELECT T.genutzte_infrastruktur as meistgenutztes_geraet_2021,\n  SUM(anzahl_untersuchungen_total) as anzahl_untersuchungen\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND jahr = '2021'\nGROUP BY T.genutzte_infrastruktur\nORDER BY anzahl_untersuchungen DESC LIMIT 1;\n",
    "db_id": "medizinisch_technische_infrastruktur",
    "generated_query": "SELECT T.genutzte_infrastruktur as medizinisches_gerat,\n  MAX(T.anzahl_untersuchungen_total) as anzahl_untersuchungen\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.jahr = 2021\nGROUP BY T.genutzte_infrastruktur\nORDER BY anzahl_untersuchungen DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Welche medizinischen Ger\u00e4te z\u00e4hlen in der Schweiz zur medizinischen Infrastruktur und wieviele gab es davon jeweils 2020? Sortiere nach Ger\u00e4teanzahl.",
        "query": "SELECT SUM(T.anzahl_gerate) as gerate_anzahl_2020, T.genutzte_infrastruktur\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.jahr = 2020\nGROUP BY T.genutzte_infrastruktur\nORDER BY gerate_anzahl_2020 DESC;\n"
      },
      {
        "question": "Welche Kantone hatten in 2021 noch keinen CT-Scanner?",
        "query": "SELECT S.name_de as kanton_ohne_ct_scanner_in_2021\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.genutzte_infrastruktur LIKE 'CT%'\n  AND T.anzahl_gerate = 0\n  AND T.jahr = 2021;\n"
      },
      {
        "question": "Welche f\u00fcnf Kantone machte 2021 den besten Nutzen von seiner CT Scanner mit den meisten Untersuchungen pro CT Scanner und wieviele Untersuchungen gab es pro Ger\u00e4t und auf wieviele Ger\u00e4te verteilten sie sich?",
        "query": "SELECT S.name_de as kanton_mit_meisten_untersuchungen_pro_geraet,\n  ROUND(SUM(T.anzahl_untersuchungen_total) / SUM(T.anzahl_gerate), 0) as untersuchungen_pro_geraet,\n  SUM(T.anzahl_gerate) as anzahl_geraete\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.jahr = 2021\n  AND T.genutzte_infrastruktur LIKE 'CT%'\n  AND T.anzahl_gerate != 0\nGROUP BY S.name_de\nORDER BY untersuchungen_pro_geraet DESC LIMIT 5;\n"
      },
      {
        "question": "Welchem drei Kantone hatte den gr\u00f6ssten Zuwachs und Untersuchungen mit medizinischen Ger\u00e4ten zwischen 2013 and 2021 und wieviel hoch war der Zuwachs verteilt auf ambulante und station\u00e4re Untersuchungen und Ger\u00e4te?",
        "query": "WITH Untersuchungen2013 AS (\nSELECT SUM(T1.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2013,\n  SUM(T1.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2013,\n  SUM(T1.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2013,\n  SUM(T1.anzahl_gerate) as anzahl_gerate_2013,\n  S1.name_de as kanton\n    FROM medizinisch_technische_infrastruktur as T1\n    JOIN spatial_unit as S1 on T1.spatialunit_uid = S1.spatialunit_uid\n    WHERE S1.canton = 'TRUE'\n      AND T1.jahr = 2013\n    GROUP BY S1.name_de\n),\nUntersuchungen2021 AS (\n    SELECT SUM(T2.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2021,\n      SUM(T2.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2021,\n      SUM(T2.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2021,\n      SUM(T2.anzahl_gerate) as anzahl_gerate_2021,\n      S2.name_de as kanton2021\n    FROM medizinisch_technische_infrastruktur as T2\n    JOIN spatial_unit as S2 on T2.spatialunit_uid = S2.spatialunit_uid\n    WHERE S2.canton = 'TRUE'\n      AND T2.jahr = 2021\n    GROUP BY S2.name_de\n)\nSELECT\n    U2013.kanton,\n    U2021.anzahl_untersuchungen_gesamt_2021 - U2013.anzahl_untersuchungen_gesamt_2013 AS zuwachs_untersuchungen_gesamt,\n    U2021.anzahl_ambulante_untersuchungen_2021 - U2013.anzahl_ambulante_untersuchungen_2013 AS zuwachs_ambulante_untersuchungen,\n    U2021.anzahl_stationare_untersuchungen_2021 - U2013.anzahl_stationare_untersuchungen_2013 AS zuwachs_statinon\u00e4re_untersuchungen,\n    U2021.anzahl_gerate_2021 - U2013.anzahl_gerate_2013 AS zuwachs_geraete\nFROM Untersuchungen2013 AS U2013\nJOIN Untersuchungen2021 AS U2021 ON U2013.kanton = U2021.kanton2021\nORDER BY zuwachs_untersuchungen_gesamt DESC\nLIMIT 3;\n"
      },
      {
        "question": "Welche drei Kantone haben 2021 den h\u00f6chsten prozentualen Anteil an ambulanten CT Untersuchungen und wie hoch war er?",
        "query": "SELECT s.name_de as kanton,\n  ROUND(SUM(T.anzahl_ambulante_untersuchungen) * 100 / SUM(T.anzahl_untersuchungen_total), 2) as prozent_ambulante_untersuchungen\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.jahr = '2021'\n  AND T.genutzte_infrastruktur LIKE 'CT%'\n  AND T.anzahl_untersuchungen_total != 0\nGROUP BY S.name_de\nORDER BY prozent_ambulante_untersuchungen DESC LIMIT 3;\n"
      },
      {
        "question": "Welche f\u00fcnf Kantone machte 2021 den besten Nutzen von seiner CT Scanner mit den meisten Untersuchungen pro CT Scanner und wieviele Untersuchungen gab es pro Ger\u00e4t und auf wieviele Ger\u00e4te verteilten sie sich?",
        "query": "SELECT S.name_de as kanton_mit_meisten_untersuchungen_pro_geraet,\n  ROUND(SUM(T.anzahl_untersuchungen_total) / SUM(T.anzahl_gerate), 0) as untersuchungen_pro_geraet,\n  SUM(T.anzahl_gerate) as anzahl_geraete\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.jahr = 2021\n  AND T.genutzte_infrastruktur LIKE 'CT%'\n  AND T.anzahl_gerate != 0\nGROUP BY S.name_de\nORDER BY untersuchungen_pro_geraet DESC LIMIT 5;\n"
      },
      {
        "question": "Welche f\u00fcnf Kantone machte 2021 den besten Nutzen von seiner CT Scanner mit den meisten Untersuchungen pro CT Scanner und wieviele Untersuchungen gab es pro Ger\u00e4t und auf wieviele Ger\u00e4te verteilten sie sich?",
        "query": "SELECT S.name_de as kanton_mit_meisten_untersuchungen_pro_geraet,\n  ROUND(SUM(T.anzahl_untersuchungen_total) / SUM(T.anzahl_gerate), 0) as untersuchungen_pro_geraet,\n  SUM(T.anzahl_gerate) as anzahl_geraete\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.jahr = 2021\n  AND T.genutzte_infrastruktur LIKE 'CT%'\n  AND T.anzahl_gerate != 0\nGROUP BY S.name_de\nORDER BY untersuchungen_pro_geraet DESC LIMIT 5;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.medizinisch_technische_infrastruktur (\n\tuid SERIAL NOT NULL, \n\tgenutzte_infrastruktur TEXT, \n\tjahr INTEGER, \n\tanzahl_gerate NUMERIC, \n\tanzahl_untersuchungen_total NUMERIC, \n\tanzahl_ambulante_untersuchungen NUMERIC, \n\tanzahl_stationare_untersuchungen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT medizinisch_technische_infrastruktur_pkey PRIMARY KEY (uid), \n\tCONSTRAINT medizinisch_technische_infrastruktur_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in medizinisch_technische_infrastruktur and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nanzahl_gerate : 4, 27, 226, 23, 29\nanzahl_untersuchungen_total : 9631, 830373, 23916, 2401, 24595\nanzahl_ambulante_untersuchungen : 235, 481, 12225, 3727, 14415\nanzahl_stationare_untersuchungen : 54383, 23613, 7023, 5861, 110\nspatialunit_uid : 0_CH, 25_A.ADM1, 22_A.ADM1, 1_A.ADM1, 2_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\ngenutzte_infrastruktur, genutzte Infrastruktur, Gamma Camera (inklusive Szintigraphie und SPECT-Scanner),Linearbeschleuniger (Radiotherapie),MRI\nanzahl_gerate, Anzahl der Ger\u00e4te, None\nanzahl_untersuchungen_total, Anzahl aller Untersuchungen, None\nanzahl_ambulante_untersuchungen, Anzahl der ambulanten Untersuchungen, None\nanzahl_stationare_untersuchungen, Anzahl der station\u00e4ren Untersuchungen, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWelche medizinischen Ger\u00e4te z\u00e4hlen in der Schweiz zur medizinischen Infrastruktur und wieviele gab es davon jeweils 2020? Sortiere nach Ger\u00e4teanzahl.\n### SQL query\nSELECT SUM(T.anzahl_gerate) as gerate_anzahl_2020, T.genutzte_infrastruktur\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.jahr = 2020\nGROUP BY T.genutzte_infrastruktur\nORDER BY gerate_anzahl_2020 DESC;\n\n\n### Question\nWelche Kantone hatten in 2021 noch keinen CT-Scanner?\n### SQL query\nSELECT S.name_de as kanton_ohne_ct_scanner_in_2021\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.genutzte_infrastruktur LIKE 'CT%'\n  AND T.anzahl_gerate = 0\n  AND T.jahr = 2021;\n\n\n### Question\nWelche f\u00fcnf Kantone machte 2021 den besten Nutzen von seiner CT Scanner mit den meisten Untersuchungen pro CT Scanner und wieviele Untersuchungen gab es pro Ger\u00e4t und auf wieviele Ger\u00e4te verteilten sie sich?\n### SQL query\nSELECT S.name_de as kanton_mit_meisten_untersuchungen_pro_geraet,\n  ROUND(SUM(T.anzahl_untersuchungen_total) / SUM(T.anzahl_gerate), 0) as untersuchungen_pro_geraet,\n  SUM(T.anzahl_gerate) as anzahl_geraete\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.jahr = 2021\n  AND T.genutzte_infrastruktur LIKE 'CT%'\n  AND T.anzahl_gerate != 0\nGROUP BY S.name_de\nORDER BY untersuchungen_pro_geraet DESC LIMIT 5;\n\n\n### Question\nWelchem drei Kantone hatte den gr\u00f6ssten Zuwachs und Untersuchungen mit medizinischen Ger\u00e4ten zwischen 2013 and 2021 und wieviel hoch war der Zuwachs verteilt auf ambulante und station\u00e4re Untersuchungen und Ger\u00e4te?\n### SQL query\nWITH Untersuchungen2013 AS (\nSELECT SUM(T1.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2013,\n  SUM(T1.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2013,\n  SUM(T1.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2013,\n  SUM(T1.anzahl_gerate) as anzahl_gerate_2013,\n  S1.name_de as kanton\n    FROM medizinisch_technische_infrastruktur as T1\n    JOIN spatial_unit as S1 on T1.spatialunit_uid = S1.spatialunit_uid\n    WHERE S1.canton = 'TRUE'\n      AND T1.jahr = 2013\n    GROUP BY S1.name_de\n),\nUntersuchungen2021 AS (\n    SELECT SUM(T2.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2021,\n      SUM(T2.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2021,\n      SUM(T2.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2021,\n      SUM(T2.anzahl_gerate) as anzahl_gerate_2021,\n      S2.name_de as kanton2021\n    FROM medizinisch_technische_infrastruktur as T2\n    JOIN spatial_unit as S2 on T2.spatialunit_uid = S2.spatialunit_uid\n    WHERE S2.canton = 'TRUE'\n      AND T2.jahr = 2021\n    GROUP BY S2.name_de\n)\nSELECT\n    U2013.kanton,\n    U2021.anzahl_untersuchungen_gesamt_2021 - U2013.anzahl_untersuchungen_gesamt_2013 AS zuwachs_untersuchungen_gesamt,\n    U2021.anzahl_ambulante_untersuchungen_2021 - U2013.anzahl_ambulante_untersuchungen_2013 AS zuwachs_ambulante_untersuchungen,\n    U2021.anzahl_stationare_untersuchungen_2021 - U2013.anzahl_stationare_untersuchungen_2013 AS zuwachs_statinon\u00e4re_untersuchungen,\n    U2021.anzahl_gerate_2021 - U2013.anzahl_gerate_2013 AS zuwachs_geraete\nFROM Untersuchungen2013 AS U2013\nJOIN Untersuchungen2021 AS U2021 ON U2013.kanton = U2021.kanton2021\nORDER BY zuwachs_untersuchungen_gesamt DESC\nLIMIT 3;\n\n\n### Question\nWelche drei Kantone haben 2021 den h\u00f6chsten prozentualen Anteil an ambulanten CT Untersuchungen und wie hoch war er?\n### SQL query\nSELECT s.name_de as kanton,\n  ROUND(SUM(T.anzahl_ambulante_untersuchungen) * 100 / SUM(T.anzahl_untersuchungen_total), 2) as prozent_ambulante_untersuchungen\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.jahr = '2021'\n  AND T.genutzte_infrastruktur LIKE 'CT%'\n  AND T.anzahl_untersuchungen_total != 0\nGROUP BY S.name_de\nORDER BY prozent_ambulante_untersuchungen DESC LIMIT 3;\n\n\n### Question\nWelche f\u00fcnf Kantone machte 2021 den besten Nutzen von seiner CT Scanner mit den meisten Untersuchungen pro CT Scanner und wieviele Untersuchungen gab es pro Ger\u00e4t und auf wieviele Ger\u00e4te verteilten sie sich?\n### SQL query\nSELECT S.name_de as kanton_mit_meisten_untersuchungen_pro_geraet,\n  ROUND(SUM(T.anzahl_untersuchungen_total) / SUM(T.anzahl_gerate), 0) as untersuchungen_pro_geraet,\n  SUM(T.anzahl_gerate) as anzahl_geraete\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.jahr = 2021\n  AND T.genutzte_infrastruktur LIKE 'CT%'\n  AND T.anzahl_gerate != 0\nGROUP BY S.name_de\nORDER BY untersuchungen_pro_geraet DESC LIMIT 5;\n\n\n### Question\nWelche f\u00fcnf Kantone machte 2021 den besten Nutzen von seiner CT Scanner mit den meisten Untersuchungen pro CT Scanner und wieviele Untersuchungen gab es pro Ger\u00e4t und auf wieviele Ger\u00e4te verteilten sie sich?\n### SQL query\nSELECT S.name_de as kanton_mit_meisten_untersuchungen_pro_geraet,\n  ROUND(SUM(T.anzahl_untersuchungen_total) / SUM(T.anzahl_gerate), 0) as untersuchungen_pro_geraet,\n  SUM(T.anzahl_gerate) as anzahl_geraete\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.jahr = 2021\n  AND T.genutzte_infrastruktur LIKE 'CT%'\n  AND T.anzahl_gerate != 0\nGROUP BY S.name_de\nORDER BY untersuchungen_pro_geraet DESC LIMIT 5;\n\n\n### Question\nWelches war das medizinische Ger\u00e4t 2021 in der Schweiz mit den meisten Untersuchungen und wieviele Untersuchungen gab es damit?\n### SQL query\n",
    "process_time": 7.848481375025585,
    "num_tokens": 3003,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 63,
    "question": "Welche f\u00fcnf Kantone hatte 2021 die gr\u00f6sste medizinische Infrastruktur mit den meisten Ger\u00e4ten und wieviele Ger\u00e4te waren es?",
    "query": "SELECT S.name_de as kanton_mit_groesster_medizinischer_infrastruktur, SUM(T.anzahl_gerate) as anzahl_geraete\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY anzahl_geraete DESC LIMIT 5;\n",
    "db_id": "medizinisch_technische_infrastruktur",
    "generated_query": "SELECT S.name_de as kanton_mit_meisten_geraeten,\n  SUM(T.anzahl_gerate) as anzahl_geraete\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY anzahl_geraete DESC LIMIT 5;",
    "meta_data": [
      {
        "question": "Welche Kantone hatten in 2021 noch keinen CT-Scanner?",
        "query": "SELECT S.name_de as kanton_ohne_ct_scanner_in_2021\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.genutzte_infrastruktur LIKE 'CT%'\n  AND T.anzahl_gerate = 0\n  AND T.jahr = 2021;\n"
      },
      {
        "question": "Wieviele Angiographieger\u00e4te gab es 2013 in der Schweiz?",
        "query": "SELECT SUM(anzahl_gerate) as anzahl_gerate_in_2013\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND jahr = '2013'\n  AND T.genutzte_infrastruktur LIKE '%Angiographie%';\n"
      },
      {
        "question": "Welches f\u00fcnf medizinische Ger\u00e4te haben den h\u00f6chsten prozentualen Anteil an ambulanten Untersuchungen und wie hoch ist er?",
        "query": "SELECT T.genutzte_infrastruktur,\n  ROUND(SUM(T.anzahl_ambulante_untersuchungen) * 100 / SUM(T.anzahl_untersuchungen_total), 2) as prozent_ambulante_untersuchungen\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.anzahl_untersuchungen_total != 0\nGROUP BY T.genutzte_infrastruktur\nORDER BY prozent_ambulante_untersuchungen DESC LIMIT 5;\n"
      },
      {
        "question": "Welches f\u00fcnf medizinische Ger\u00e4te haben den h\u00f6chsten prozentualen Anteil an ambulanten Untersuchungen und wie hoch ist er?",
        "query": "SELECT T.genutzte_infrastruktur,\n  ROUND(SUM(T.anzahl_ambulante_untersuchungen) * 100 / SUM(T.anzahl_untersuchungen_total), 2) as prozent_ambulante_untersuchungen\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.anzahl_untersuchungen_total != 0\nGROUP BY T.genutzte_infrastruktur\nORDER BY prozent_ambulante_untersuchungen DESC LIMIT 5;\n"
      },
      {
        "question": "Welche f\u00fcnf Kantone machte 2021 den besten Nutzen von seiner CT Scanner mit den meisten Untersuchungen pro CT Scanner und wieviele Untersuchungen gab es pro Ger\u00e4t und auf wieviele Ger\u00e4te verteilten sie sich?",
        "query": "SELECT S.name_de as kanton_mit_meisten_untersuchungen_pro_geraet,\n  ROUND(SUM(T.anzahl_untersuchungen_total) / SUM(T.anzahl_gerate), 0) as untersuchungen_pro_geraet,\n  SUM(T.anzahl_gerate) as anzahl_geraete\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.jahr = 2021\n  AND T.genutzte_infrastruktur LIKE 'CT%'\n  AND T.anzahl_gerate != 0\nGROUP BY S.name_de\nORDER BY untersuchungen_pro_geraet DESC LIMIT 5;\n"
      },
      {
        "question": "Welchem drei Kantone hatte den gr\u00f6ssten Zuwachs und Untersuchungen mit medizinischen Ger\u00e4ten zwischen 2013 and 2021 und wieviel hoch war der Zuwachs verteilt auf ambulante und station\u00e4re Untersuchungen und Ger\u00e4te?",
        "query": "WITH Untersuchungen2013 AS (\nSELECT SUM(T1.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2013,\n  SUM(T1.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2013,\n  SUM(T1.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2013,\n  SUM(T1.anzahl_gerate) as anzahl_gerate_2013,\n  S1.name_de as kanton\n    FROM medizinisch_technische_infrastruktur as T1\n    JOIN spatial_unit as S1 on T1.spatialunit_uid = S1.spatialunit_uid\n    WHERE S1.canton = 'TRUE'\n      AND T1.jahr = 2013\n    GROUP BY S1.name_de\n),\nUntersuchungen2021 AS (\n    SELECT SUM(T2.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2021,\n      SUM(T2.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2021,\n      SUM(T2.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2021,\n      SUM(T2.anzahl_gerate) as anzahl_gerate_2021,\n      S2.name_de as kanton2021\n    FROM medizinisch_technische_infrastruktur as T2\n    JOIN spatial_unit as S2 on T2.spatialunit_uid = S2.spatialunit_uid\n    WHERE S2.canton = 'TRUE'\n      AND T2.jahr = 2021\n    GROUP BY S2.name_de\n)\nSELECT\n    U2013.kanton,\n    U2021.anzahl_untersuchungen_gesamt_2021 - U2013.anzahl_untersuchungen_gesamt_2013 AS zuwachs_untersuchungen_gesamt,\n    U2021.anzahl_ambulante_untersuchungen_2021 - U2013.anzahl_ambulante_untersuchungen_2013 AS zuwachs_ambulante_untersuchungen,\n    U2021.anzahl_stationare_untersuchungen_2021 - U2013.anzahl_stationare_untersuchungen_2013 AS zuwachs_statinon\u00e4re_untersuchungen,\n    U2021.anzahl_gerate_2021 - U2013.anzahl_gerate_2013 AS zuwachs_geraete\nFROM Untersuchungen2013 AS U2013\nJOIN Untersuchungen2021 AS U2021 ON U2013.kanton = U2021.kanton2021\nORDER BY zuwachs_untersuchungen_gesamt DESC\nLIMIT 3;\n"
      },
      {
        "question": "Welches f\u00fcnf medizinische Ger\u00e4te haben den h\u00f6chsten prozentualen Anteil an ambulanten Untersuchungen und wie hoch ist er?",
        "query": "SELECT T.genutzte_infrastruktur,\n  ROUND(SUM(T.anzahl_ambulante_untersuchungen) * 100 / SUM(T.anzahl_untersuchungen_total), 2) as prozent_ambulante_untersuchungen\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.anzahl_untersuchungen_total != 0\nGROUP BY T.genutzte_infrastruktur\nORDER BY prozent_ambulante_untersuchungen DESC LIMIT 5;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.medizinisch_technische_infrastruktur (\n\tuid SERIAL NOT NULL, \n\tgenutzte_infrastruktur TEXT, \n\tjahr INTEGER, \n\tanzahl_gerate NUMERIC, \n\tanzahl_untersuchungen_total NUMERIC, \n\tanzahl_ambulante_untersuchungen NUMERIC, \n\tanzahl_stationare_untersuchungen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT medizinisch_technische_infrastruktur_pkey PRIMARY KEY (uid), \n\tCONSTRAINT medizinisch_technische_infrastruktur_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in medizinisch_technische_infrastruktur and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nanzahl_gerate : 4, 27, 226, 23, 29\nanzahl_untersuchungen_total : 9631, 830373, 23916, 2401, 24595\nanzahl_ambulante_untersuchungen : 235, 481, 12225, 3727, 14415\nanzahl_stationare_untersuchungen : 54383, 23613, 7023, 5861, 110\nspatialunit_uid : 0_CH, 25_A.ADM1, 22_A.ADM1, 1_A.ADM1, 2_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\ngenutzte_infrastruktur, genutzte Infrastruktur, Gamma Camera (inklusive Szintigraphie und SPECT-Scanner),Linearbeschleuniger (Radiotherapie),MRI\nanzahl_gerate, Anzahl der Ger\u00e4te, None\nanzahl_untersuchungen_total, Anzahl aller Untersuchungen, None\nanzahl_ambulante_untersuchungen, Anzahl der ambulanten Untersuchungen, None\nanzahl_stationare_untersuchungen, Anzahl der station\u00e4ren Untersuchungen, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWelche Kantone hatten in 2021 noch keinen CT-Scanner?\n### SQL query\nSELECT S.name_de as kanton_ohne_ct_scanner_in_2021\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.genutzte_infrastruktur LIKE 'CT%'\n  AND T.anzahl_gerate = 0\n  AND T.jahr = 2021;\n\n\n### Question\nWieviele Angiographieger\u00e4te gab es 2013 in der Schweiz?\n### SQL query\nSELECT SUM(anzahl_gerate) as anzahl_gerate_in_2013\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND jahr = '2013'\n  AND T.genutzte_infrastruktur LIKE '%Angiographie%';\n\n\n### Question\nWelches f\u00fcnf medizinische Ger\u00e4te haben den h\u00f6chsten prozentualen Anteil an ambulanten Untersuchungen und wie hoch ist er?\n### SQL query\nSELECT T.genutzte_infrastruktur,\n  ROUND(SUM(T.anzahl_ambulante_untersuchungen) * 100 / SUM(T.anzahl_untersuchungen_total), 2) as prozent_ambulante_untersuchungen\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.anzahl_untersuchungen_total != 0\nGROUP BY T.genutzte_infrastruktur\nORDER BY prozent_ambulante_untersuchungen DESC LIMIT 5;\n\n\n### Question\nWelches f\u00fcnf medizinische Ger\u00e4te haben den h\u00f6chsten prozentualen Anteil an ambulanten Untersuchungen und wie hoch ist er?\n### SQL query\nSELECT T.genutzte_infrastruktur,\n  ROUND(SUM(T.anzahl_ambulante_untersuchungen) * 100 / SUM(T.anzahl_untersuchungen_total), 2) as prozent_ambulante_untersuchungen\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.anzahl_untersuchungen_total != 0\nGROUP BY T.genutzte_infrastruktur\nORDER BY prozent_ambulante_untersuchungen DESC LIMIT 5;\n\n\n### Question\nWelche f\u00fcnf Kantone machte 2021 den besten Nutzen von seiner CT Scanner mit den meisten Untersuchungen pro CT Scanner und wieviele Untersuchungen gab es pro Ger\u00e4t und auf wieviele Ger\u00e4te verteilten sie sich?\n### SQL query\nSELECT S.name_de as kanton_mit_meisten_untersuchungen_pro_geraet,\n  ROUND(SUM(T.anzahl_untersuchungen_total) / SUM(T.anzahl_gerate), 0) as untersuchungen_pro_geraet,\n  SUM(T.anzahl_gerate) as anzahl_geraete\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.jahr = 2021\n  AND T.genutzte_infrastruktur LIKE 'CT%'\n  AND T.anzahl_gerate != 0\nGROUP BY S.name_de\nORDER BY untersuchungen_pro_geraet DESC LIMIT 5;\n\n\n### Question\nWelchem drei Kantone hatte den gr\u00f6ssten Zuwachs und Untersuchungen mit medizinischen Ger\u00e4ten zwischen 2013 and 2021 und wieviel hoch war der Zuwachs verteilt auf ambulante und station\u00e4re Untersuchungen und Ger\u00e4te?\n### SQL query\nWITH Untersuchungen2013 AS (\nSELECT SUM(T1.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2013,\n  SUM(T1.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2013,\n  SUM(T1.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2013,\n  SUM(T1.anzahl_gerate) as anzahl_gerate_2013,\n  S1.name_de as kanton\n    FROM medizinisch_technische_infrastruktur as T1\n    JOIN spatial_unit as S1 on T1.spatialunit_uid = S1.spatialunit_uid\n    WHERE S1.canton = 'TRUE'\n      AND T1.jahr = 2013\n    GROUP BY S1.name_de\n),\nUntersuchungen2021 AS (\n    SELECT SUM(T2.anzahl_untersuchungen_total) as anzahl_untersuchungen_gesamt_2021,\n      SUM(T2.anzahl_ambulante_untersuchungen) as anzahl_ambulante_untersuchungen_2021,\n      SUM(T2.anzahl_stationare_untersuchungen) as anzahl_stationare_untersuchungen_2021,\n      SUM(T2.anzahl_gerate) as anzahl_gerate_2021,\n      S2.name_de as kanton2021\n    FROM medizinisch_technische_infrastruktur as T2\n    JOIN spatial_unit as S2 on T2.spatialunit_uid = S2.spatialunit_uid\n    WHERE S2.canton = 'TRUE'\n      AND T2.jahr = 2021\n    GROUP BY S2.name_de\n)\nSELECT\n    U2013.kanton,\n    U2021.anzahl_untersuchungen_gesamt_2021 - U2013.anzahl_untersuchungen_gesamt_2013 AS zuwachs_untersuchungen_gesamt,\n    U2021.anzahl_ambulante_untersuchungen_2021 - U2013.anzahl_ambulante_untersuchungen_2013 AS zuwachs_ambulante_untersuchungen,\n    U2021.anzahl_stationare_untersuchungen_2021 - U2013.anzahl_stationare_untersuchungen_2013 AS zuwachs_statinon\u00e4re_untersuchungen,\n    U2021.anzahl_gerate_2021 - U2013.anzahl_gerate_2013 AS zuwachs_geraete\nFROM Untersuchungen2013 AS U2013\nJOIN Untersuchungen2021 AS U2021 ON U2013.kanton = U2021.kanton2021\nORDER BY zuwachs_untersuchungen_gesamt DESC\nLIMIT 3;\n\n\n### Question\nWelches f\u00fcnf medizinische Ger\u00e4te haben den h\u00f6chsten prozentualen Anteil an ambulanten Untersuchungen und wie hoch ist er?\n### SQL query\nSELECT T.genutzte_infrastruktur,\n  ROUND(SUM(T.anzahl_ambulante_untersuchungen) * 100 / SUM(T.anzahl_untersuchungen_total), 2) as prozent_ambulante_untersuchungen\nFROM medizinisch_technische_infrastruktur as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.anzahl_untersuchungen_total != 0\nGROUP BY T.genutzte_infrastruktur\nORDER BY prozent_ambulante_untersuchungen DESC LIMIT 5;\n\n\n### Question\nWelche f\u00fcnf Kantone hatte 2021 die gr\u00f6sste medizinische Infrastruktur mit den meisten Ger\u00e4ten und wieviele Ger\u00e4te waren es?\n### SQL query\n",
    "process_time": 7.196308329002932,
    "num_tokens": 2851,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 64,
    "question": "Welcher Vorlage in welchem Jahr hatte die meisten Nein Stimmen und bei welcher Wahlbeteiligung und wievielen Ja Stimmen in Prozent?",
    "query": "SELECT T.vorlage, T.jahr, T.anzahl_nein_stimmen AS hoechste_anzahl_nein_stimmen, T.beteiligung_in_prozent, T.ja_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\nORDER BY hoechste_anzahl_nein_stimmen DESC LIMIT 1;\n",
    "db_id": "volksabstimmung_nach_kanton_seit_1861",
    "generated_query": "SELECT T.vorlage, T.jahr, T.anzahl_nein_stimmen, T.beteiligung_in_prozent, T.ja_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.anzahl_nein_stimmen = (SELECT MAX(anzahl_nein_stimmen) FROM volksabstimmung_nach_kanton_seit_1861)\nAND T.ja_in_prozent IS NOT NULL;",
    "meta_data": [
      {
        "question": "Welche Volksabstimmung und in welchem Jahr hatte die wenigsten g\u00fcltigen Stimmenzettel? Wieviele waren es? Und wie hoch war die Wahlbeteiligung?",
        "query": "SELECT T.vorlage AS vorlage_mit_wenigsten_gueltigen_stimmenzetteln, T.jahr,\n  MIN(T.anzahl_gueltige_stimmzettel) AS anzahl_gueltige_stimmzettel, T.beteiligung_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE' AND S.name_de = 'Schweiz'\nGROUP BY T.vorlage, T.jahr, T.beteiligung_in_prozent\nORDER BY anzahl_gueltige_stimmzettel ASC LIMIT 1;\n"
      },
      {
        "question": "Wieviel Prozent der Vorlagen wurden angenommen und wieviel Prozent wurden zur\u00fcckgewiesen?",
        "query": "SELECT\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent > 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_angenommene_vorlagen,\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent <= 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_zurueckgewiesene_vorlagen\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE';\n"
      },
      {
        "question": "Welche Vorlage in welchem Jahr und welchem Kanton bekam jemals die h\u00f6chste Annahme in Prozent und wie hoch war diese Annahme bei welcher Wahlbeteiligung?",
        "query": "SELECT T.vorlage, T.jahr, S.name_de AS kanton, T.ja_in_prozent as hoechste_annahme, T.beteiligung_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.ja_in_prozent IS NOT NULL\nORDER BY hoechste_annahme DESC LIMIT 1;\n"
      },
      {
        "question": "Welche drei Kanton hatten im Jahr 2023 durchschnittlich die wenigsten Stimmberechtigten? Wieviel Stimmberechtigte waren es jeweils?",
        "query": "SELECT S.name_de AS kanton, AVG(T.anzahl_stimmberechtigte) AS durchschnittliche_anzahl_stimmberechtigte_2023\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nAND T.jahr = 2023\nGROUP BY S.name_de\nORDER BY durchschnittliche_anzahl_stimmberechtigte_2023 ASC LIMIT 3;\n"
      },
      {
        "question": "Welche Kantone haben 2023 gegen das Bundesgesetz \u00fcber Klimaschutz gestimmt und wieviel Prozent Ja Stimmen gab es dort jeweils?",
        "query": "SELECT S.name_de as kanton_gegen_klimaschutzgesetz, T.ja_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nAND LOWER(T.vorlage) LIKE '%bundesgesetz%klimaschutz%' AND T.jahr = 2023\nAND T.ja_in_prozent <= 50\nGROUP BY S.name_de, T.vorlage, T.jahr, T.ja_in_prozent;\n"
      },
      {
        "question": "Welche Kantone haben 2023 gegen das Bundesgesetz \u00fcber Klimaschutz gestimmt und wieviel Prozent Ja Stimmen gab es dort jeweils?",
        "query": "SELECT S.name_de as kanton_gegen_klimaschutzgesetz, T.ja_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nAND LOWER(T.vorlage) LIKE '%bundesgesetz%klimaschutz%' AND T.jahr = 2023\nAND T.ja_in_prozent <= 50\nGROUP BY S.name_de, T.vorlage, T.jahr, T.ja_in_prozent;\n"
      },
      {
        "question": "Wieviel Prozent der Vorlagen wurden angenommen und wieviel Prozent wurden zur\u00fcckgewiesen?",
        "query": "SELECT\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent > 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_angenommene_vorlagen,\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent <= 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_zurueckgewiesene_vorlagen\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE';\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.volksabstimmung_nach_kanton_seit_1861 (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tvorlage TEXT, \n\tanzahl_stimmberechtigte NUMERIC, \n\tanzahl_abgegebene_stimmen NUMERIC, \n\tbeteiligung_in_prozent NUMERIC, \n\tanzahl_gueltige_stimmzettel NUMERIC, \n\tanzahl_ja_stimmen NUMERIC, \n\tanzahl_nein_stimmen NUMERIC, \n\tja_in_prozent NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT volksabstimmung_nach_kanton_seit_1861_pkey PRIMARY KEY (uid), \n\tCONSTRAINT volksabstimmung_nach_kanton_seit_1861_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in volksabstimmung_nach_kanton_seit_1861 and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2015, 2009, 2000, 2012, 2019\nvorlage : Volksinitiative \u00abF\u00fcr faire Steuern. Stopp dem Missbrauch beim Steuerwettbewerb\u00bb, Bundesbeschluss \u00fcber die ordentliche Einb\u00fcrgerung sowie \u00fcber die erleichterte Einb\u00fcrgerung junger Ausl\u00e4nderinnen und Ausl\u00e4nder der zweiten Generation, Bundesgesetz \u00fcber die Erwerbsersatzordnung f\u00fcr Dienstleistende in Armee, Zivildienst und Zivilschutz (Erwerbsersatzgesetz, EOG), Volksinitiative \u00abAHVplus: f\u00fcr eine starke AHV\u00bb, Volksinitiative \u00abF\u00fcr den geordneten Ausstieg aus der Atomenergie\u00bb\nanzahl_stimmberechtigte : 5400197, 5166973, 4852272, 4681043, 5493036\nanzahl_abgegebene_stimmen : 1972596, 2590724, 3264252, 1990232, 2572040\nbeteiligung_in_prozent : 50.8500000000000014, 53.7599999999999980, 38.5300000000000011, 48.9099999999999966, 46.8400000000000034\nanzahl_gueltige_stimmzettel : 1737349, 3430137, 2271316, 2241395, 2897763\nanzahl_ja_stimmen : 1206323, 2222594, 1531027, 774821, 1156706\nanzahl_nein_stimmen : 836101, 893370, 1322587, 1452453, 1531986\nja_in_prozent : 57.00999999999999801, 34.00000000000000000, 38.15999999999999659, 60.97999999999999687, 49.15999999999999659\n*/\n\n/*\nColumn name, Column discription, Example values\nvorlage, Titel der Abstimmungsvorlage, Bundesgesetz \u00fcber die Errichtung der schweizerischen Bundesbank,Bundesbeschluss betreffend Revision von Art. 103 der Bundesverfassung und Aufnahme eines Artikels 114bis in die Bundesverfassung,Volksinitiative \u00abf\u00fcr die vermehrte Mitbestimmung der Bundesversammlung und des Schweizervolkes im Nationalstrassenbau\u00bb\nanzahl_stimmberechtigte, Anzahl Stimmberechtigte, None\nanzahl_abgegebene_stimmen, Anzahl abgegebene Stimmenen, None\nbeteiligung_in_prozent, Wahlbeteiligung in Prozent, None\nanzahl_gueltige_stimmzettel, Anzahl g\u00fcltige Stimmenzettel, None\nanzahl_ja_stimmen, Anzahl ja Stimmen, None\nanzahl_nein_stimmen, Anzahl nein Stimmen, None\nja_in_prozent, ja Stimmen in Prozent der Gesamtstimmen, None\n*/\n\n\n\n### Question\nWelche Volksabstimmung und in welchem Jahr hatte die wenigsten g\u00fcltigen Stimmenzettel? Wieviele waren es? Und wie hoch war die Wahlbeteiligung?\n### SQL query\nSELECT T.vorlage AS vorlage_mit_wenigsten_gueltigen_stimmenzetteln, T.jahr,\n  MIN(T.anzahl_gueltige_stimmzettel) AS anzahl_gueltige_stimmzettel, T.beteiligung_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE' AND S.name_de = 'Schweiz'\nGROUP BY T.vorlage, T.jahr, T.beteiligung_in_prozent\nORDER BY anzahl_gueltige_stimmzettel ASC LIMIT 1;\n\n\n### Question\nWieviel Prozent der Vorlagen wurden angenommen und wieviel Prozent wurden zur\u00fcckgewiesen?\n### SQL query\nSELECT\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent > 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_angenommene_vorlagen,\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent <= 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_zurueckgewiesene_vorlagen\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE';\n\n\n### Question\nWelche Vorlage in welchem Jahr und welchem Kanton bekam jemals die h\u00f6chste Annahme in Prozent und wie hoch war diese Annahme bei welcher Wahlbeteiligung?\n### SQL query\nSELECT T.vorlage, T.jahr, S.name_de AS kanton, T.ja_in_prozent as hoechste_annahme, T.beteiligung_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.ja_in_prozent IS NOT NULL\nORDER BY hoechste_annahme DESC LIMIT 1;\n\n\n### Question\nWelche drei Kanton hatten im Jahr 2023 durchschnittlich die wenigsten Stimmberechtigten? Wieviel Stimmberechtigte waren es jeweils?\n### SQL query\nSELECT S.name_de AS kanton, AVG(T.anzahl_stimmberechtigte) AS durchschnittliche_anzahl_stimmberechtigte_2023\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nAND T.jahr = 2023\nGROUP BY S.name_de\nORDER BY durchschnittliche_anzahl_stimmberechtigte_2023 ASC LIMIT 3;\n\n\n### Question\nWelche Kantone haben 2023 gegen das Bundesgesetz \u00fcber Klimaschutz gestimmt und wieviel Prozent Ja Stimmen gab es dort jeweils?\n### SQL query\nSELECT S.name_de as kanton_gegen_klimaschutzgesetz, T.ja_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nAND LOWER(T.vorlage) LIKE '%bundesgesetz%klimaschutz%' AND T.jahr = 2023\nAND T.ja_in_prozent <= 50\nGROUP BY S.name_de, T.vorlage, T.jahr, T.ja_in_prozent;\n\n\n### Question\nWelche Kantone haben 2023 gegen das Bundesgesetz \u00fcber Klimaschutz gestimmt und wieviel Prozent Ja Stimmen gab es dort jeweils?\n### SQL query\nSELECT S.name_de as kanton_gegen_klimaschutzgesetz, T.ja_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nAND LOWER(T.vorlage) LIKE '%bundesgesetz%klimaschutz%' AND T.jahr = 2023\nAND T.ja_in_prozent <= 50\nGROUP BY S.name_de, T.vorlage, T.jahr, T.ja_in_prozent;\n\n\n### Question\nWieviel Prozent der Vorlagen wurden angenommen und wieviel Prozent wurden zur\u00fcckgewiesen?\n### SQL query\nSELECT\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent > 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_angenommene_vorlagen,\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent <= 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_zurueckgewiesene_vorlagen\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE';\n\n\n### Question\nWelcher Vorlage in welchem Jahr hatte die meisten Nein Stimmen und bei welcher Wahlbeteiligung und wievielen Ja Stimmen in Prozent?\n### SQL query\n",
    "process_time": 12.513053366914392,
    "num_tokens": 2842,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 65,
    "question": "Welches waren die drei Volksabstimmung mit der h\u00f6chsten Beteiligung, wann fanden sie statt und wie hoch war die Beteiligung in Prozent?",
    "query": "SELECT T.jahr, MAX(T.beteiligung_in_prozent) AS hoechste_beteiligung_in_prozent, T.vorlage\nFROM volksabstimmung_nach_kanton_seit_1861 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.beteiligung_in_prozent IS NOT NULL\nGROUP BY T.jahr, T.vorlage\nORDER BY hoechste_beteiligung_in_prozent DESC\nLIMIT 3;\n",
    "db_id": "volksabstimmung_nach_kanton_seit_1861",
    "generated_query": "SELECT T.vorlage, T.jahr, T.beteiligung_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE' AND S.name_de = 'Schweiz'\nORDER BY T.beteiligung_in_prozent DESC\nLIMIT 3;",
    "meta_data": [
      {
        "question": "Wieviel Prozent der Vorlagen wurden angenommen und wieviel Prozent wurden zur\u00fcckgewiesen?",
        "query": "SELECT\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent > 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_angenommene_vorlagen,\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent <= 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_zurueckgewiesene_vorlagen\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE';\n"
      },
      {
        "question": "Welche Vorlage in welchem Jahr und welchem Kanton bekam jemals die h\u00f6chste Annahme in Prozent und wie hoch war diese Annahme bei welcher Wahlbeteiligung?",
        "query": "SELECT T.vorlage, T.jahr, S.name_de AS kanton, T.ja_in_prozent as hoechste_annahme, T.beteiligung_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.ja_in_prozent IS NOT NULL\nORDER BY hoechste_annahme DESC LIMIT 1;\n"
      },
      {
        "question": "Wieviel Prozent der Vorlagen wurden angenommen und wieviel Prozent wurden zur\u00fcckgewiesen?",
        "query": "SELECT\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent > 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_angenommene_vorlagen,\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent <= 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_zurueckgewiesene_vorlagen\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE';\n"
      },
      {
        "question": "Welche Kantone haben 2023 gegen das Bundesgesetz \u00fcber Klimaschutz gestimmt und wieviel Prozent Ja Stimmen gab es dort jeweils?",
        "query": "SELECT S.name_de as kanton_gegen_klimaschutzgesetz, T.ja_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nAND LOWER(T.vorlage) LIKE '%bundesgesetz%klimaschutz%' AND T.jahr = 2023\nAND T.ja_in_prozent <= 50\nGROUP BY S.name_de, T.vorlage, T.jahr, T.ja_in_prozent;\n"
      },
      {
        "question": "Welche Vorlage in welchem Jahr und welchem Kanton bekam jemals die h\u00f6chste Annahme in Prozent und wie hoch war diese Annahme bei welcher Wahlbeteiligung?",
        "query": "SELECT T.vorlage, T.jahr, S.name_de AS kanton, T.ja_in_prozent as hoechste_annahme, T.beteiligung_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.ja_in_prozent IS NOT NULL\nORDER BY hoechste_annahme DESC LIMIT 1;\n"
      },
      {
        "question": "Welche Volksabstimmung und in welchem Jahr hatte die wenigsten g\u00fcltigen Stimmenzettel? Wieviele waren es? Und wie hoch war die Wahlbeteiligung?",
        "query": "SELECT T.vorlage AS vorlage_mit_wenigsten_gueltigen_stimmenzetteln, T.jahr,\n  MIN(T.anzahl_gueltige_stimmzettel) AS anzahl_gueltige_stimmzettel, T.beteiligung_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE' AND S.name_de = 'Schweiz'\nGROUP BY T.vorlage, T.jahr, T.beteiligung_in_prozent\nORDER BY anzahl_gueltige_stimmzettel ASC LIMIT 1;\n"
      },
      {
        "question": "Welche Kantone haben 2023 gegen das Bundesgesetz \u00fcber Klimaschutz gestimmt und wieviel Prozent Ja Stimmen gab es dort jeweils?",
        "query": "SELECT S.name_de as kanton_gegen_klimaschutzgesetz, T.ja_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nAND LOWER(T.vorlage) LIKE '%bundesgesetz%klimaschutz%' AND T.jahr = 2023\nAND T.ja_in_prozent <= 50\nGROUP BY S.name_de, T.vorlage, T.jahr, T.ja_in_prozent;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.volksabstimmung_nach_kanton_seit_1861 (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tvorlage TEXT, \n\tanzahl_stimmberechtigte NUMERIC, \n\tanzahl_abgegebene_stimmen NUMERIC, \n\tbeteiligung_in_prozent NUMERIC, \n\tanzahl_gueltige_stimmzettel NUMERIC, \n\tanzahl_ja_stimmen NUMERIC, \n\tanzahl_nein_stimmen NUMERIC, \n\tja_in_prozent NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT volksabstimmung_nach_kanton_seit_1861_pkey PRIMARY KEY (uid), \n\tCONSTRAINT volksabstimmung_nach_kanton_seit_1861_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in volksabstimmung_nach_kanton_seit_1861 and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2015, 2009, 2000, 2012, 2019\nvorlage : Volksinitiative \u00abF\u00fcr faire Steuern. Stopp dem Missbrauch beim Steuerwettbewerb\u00bb, Bundesbeschluss \u00fcber die ordentliche Einb\u00fcrgerung sowie \u00fcber die erleichterte Einb\u00fcrgerung junger Ausl\u00e4nderinnen und Ausl\u00e4nder der zweiten Generation, Bundesgesetz \u00fcber die Erwerbsersatzordnung f\u00fcr Dienstleistende in Armee, Zivildienst und Zivilschutz (Erwerbsersatzgesetz, EOG), Volksinitiative \u00abAHVplus: f\u00fcr eine starke AHV\u00bb, Volksinitiative \u00abF\u00fcr den geordneten Ausstieg aus der Atomenergie\u00bb\nanzahl_stimmberechtigte : 5400197, 5166973, 4852272, 4681043, 5493036\nanzahl_abgegebene_stimmen : 1972596, 2590724, 3264252, 1990232, 2572040\nbeteiligung_in_prozent : 50.8500000000000014, 53.7599999999999980, 38.5300000000000011, 48.9099999999999966, 46.8400000000000034\nanzahl_gueltige_stimmzettel : 1737349, 3430137, 2271316, 2241395, 2897763\nanzahl_ja_stimmen : 1206323, 2222594, 1531027, 774821, 1156706\nanzahl_nein_stimmen : 836101, 893370, 1322587, 1452453, 1531986\nja_in_prozent : 57.00999999999999801, 34.00000000000000000, 38.15999999999999659, 60.97999999999999687, 49.15999999999999659\n*/\n\n/*\nColumn name, Column discription, Example values\nvorlage, Titel der Abstimmungsvorlage, Bundesgesetz \u00fcber die Errichtung der schweizerischen Bundesbank,Bundesbeschluss betreffend Revision von Art. 103 der Bundesverfassung und Aufnahme eines Artikels 114bis in die Bundesverfassung,Volksinitiative \u00abf\u00fcr die vermehrte Mitbestimmung der Bundesversammlung und des Schweizervolkes im Nationalstrassenbau\u00bb\nanzahl_stimmberechtigte, Anzahl Stimmberechtigte, None\nanzahl_abgegebene_stimmen, Anzahl abgegebene Stimmenen, None\nbeteiligung_in_prozent, Wahlbeteiligung in Prozent, None\nanzahl_gueltige_stimmzettel, Anzahl g\u00fcltige Stimmenzettel, None\nanzahl_ja_stimmen, Anzahl ja Stimmen, None\nanzahl_nein_stimmen, Anzahl nein Stimmen, None\nja_in_prozent, ja Stimmen in Prozent der Gesamtstimmen, None\n*/\n\n\n\n### Question\nWieviel Prozent der Vorlagen wurden angenommen und wieviel Prozent wurden zur\u00fcckgewiesen?\n### SQL query\nSELECT\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent > 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_angenommene_vorlagen,\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent <= 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_zurueckgewiesene_vorlagen\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE';\n\n\n### Question\nWelche Vorlage in welchem Jahr und welchem Kanton bekam jemals die h\u00f6chste Annahme in Prozent und wie hoch war diese Annahme bei welcher Wahlbeteiligung?\n### SQL query\nSELECT T.vorlage, T.jahr, S.name_de AS kanton, T.ja_in_prozent as hoechste_annahme, T.beteiligung_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.ja_in_prozent IS NOT NULL\nORDER BY hoechste_annahme DESC LIMIT 1;\n\n\n### Question\nWieviel Prozent der Vorlagen wurden angenommen und wieviel Prozent wurden zur\u00fcckgewiesen?\n### SQL query\nSELECT\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent > 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_angenommene_vorlagen,\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent <= 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_zurueckgewiesene_vorlagen\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE';\n\n\n### Question\nWelche Kantone haben 2023 gegen das Bundesgesetz \u00fcber Klimaschutz gestimmt und wieviel Prozent Ja Stimmen gab es dort jeweils?\n### SQL query\nSELECT S.name_de as kanton_gegen_klimaschutzgesetz, T.ja_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nAND LOWER(T.vorlage) LIKE '%bundesgesetz%klimaschutz%' AND T.jahr = 2023\nAND T.ja_in_prozent <= 50\nGROUP BY S.name_de, T.vorlage, T.jahr, T.ja_in_prozent;\n\n\n### Question\nWelche Vorlage in welchem Jahr und welchem Kanton bekam jemals die h\u00f6chste Annahme in Prozent und wie hoch war diese Annahme bei welcher Wahlbeteiligung?\n### SQL query\nSELECT T.vorlage, T.jahr, S.name_de AS kanton, T.ja_in_prozent as hoechste_annahme, T.beteiligung_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.ja_in_prozent IS NOT NULL\nORDER BY hoechste_annahme DESC LIMIT 1;\n\n\n### Question\nWelche Volksabstimmung und in welchem Jahr hatte die wenigsten g\u00fcltigen Stimmenzettel? Wieviele waren es? Und wie hoch war die Wahlbeteiligung?\n### SQL query\nSELECT T.vorlage AS vorlage_mit_wenigsten_gueltigen_stimmenzetteln, T.jahr,\n  MIN(T.anzahl_gueltige_stimmzettel) AS anzahl_gueltige_stimmzettel, T.beteiligung_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE' AND S.name_de = 'Schweiz'\nGROUP BY T.vorlage, T.jahr, T.beteiligung_in_prozent\nORDER BY anzahl_gueltige_stimmzettel ASC LIMIT 1;\n\n\n### Question\nWelche Kantone haben 2023 gegen das Bundesgesetz \u00fcber Klimaschutz gestimmt und wieviel Prozent Ja Stimmen gab es dort jeweils?\n### SQL query\nSELECT S.name_de as kanton_gegen_klimaschutzgesetz, T.ja_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nAND LOWER(T.vorlage) LIKE '%bundesgesetz%klimaschutz%' AND T.jahr = 2023\nAND T.ja_in_prozent <= 50\nGROUP BY S.name_de, T.vorlage, T.jahr, T.ja_in_prozent;\n\n\n### Question\nWelches waren die drei Volksabstimmung mit der h\u00f6chsten Beteiligung, wann fanden sie statt und wie hoch war die Beteiligung in Prozent?\n### SQL query\n",
    "process_time": 9.001961670117453,
    "num_tokens": 2843,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 66,
    "question": "Welches ist aktuellest Vorlage die schweizweit angenommen wurde, aber bei der in der Mehrheit der Kanton dagegen gestimmt wurde? Zeige auch wieviel Prozent Ja Stimmen sie Schweiz weit bekam.",
    "query": "SELECT T.vorlage,\n  MAX(CASE WHEN T.ja_in_prozent > 50 AND S.country = 'TRUE' THEN T.ja_in_prozent ELSE NULL END) AS angenommen_gesamt,\n  COUNT(CASE WHEN T.ja_in_prozent > 50 AND S.canton = 'TRUE' THEN 1 ELSE NULL END) AS angenommen_in,\n  COUNT(CASE WHEN T.ja_in_prozent <= 50 AND S.canton = 'TRUE' THEN 1 ELSE NULL END) AS abgelehnt_in\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.vorlage, T.jahr\nHAVING MAX(CASE WHEN T.ja_in_prozent > 50 AND S.country = 'TRUE' THEN T.ja_in_prozent ELSE NULL END) IS NOT NULL\n   AND COUNT(CASE WHEN T.ja_in_prozent <= 50 AND S.canton = 'TRUE' THEN 1 ELSE NULL END) > COUNT(CASE WHEN T.ja_in_prozent > 50 AND S.canton = 'TRUE' THEN 1 ELSE NULL END)\nORDER BY T.jahr DESC LIMIT 1;\n",
    "db_id": "volksabstimmung_nach_kanton_seit_1861",
    "generated_query": "SELECT T.vorlage, T.jahr, T.ja_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.ja_in_prozent > 50\nAND (SELECT COUNT(*) FROM volksabstimmung_nach_kanton_seit_1861 WHERE vorlage = T.vorlage AND ja_in_prozent <= 50) > (SELECT COUNT(*) FROM volksabstimmung_nach_kanton_seit_1861 WHERE vorlage = T.vorlage AND ja_in_prozent > 50)\nORDER BY T.jahr DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Wieviel Prozent der Vorlagen wurden angenommen und wieviel Prozent wurden zur\u00fcckgewiesen?",
        "query": "SELECT\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent > 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_angenommene_vorlagen,\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent <= 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_zurueckgewiesene_vorlagen\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE';\n"
      },
      {
        "question": "Welche Vorlagen hatten mit dem Klima zu tun, wann fanden sie statt, wie waren Beteiligung und Ergebnis?",
        "query": "SELECT T.vorlage, T.jahr, T.beteiligung_in_prozent, T.ja_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND LOWER(T.vorlage) LIKE '%klima%';\n"
      },
      {
        "question": "Wieviel Prozent der Vorlagen wurden angenommen und wieviel Prozent wurden zur\u00fcckgewiesen?",
        "query": "SELECT\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent > 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_angenommene_vorlagen,\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent <= 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_zurueckgewiesene_vorlagen\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE';\n"
      },
      {
        "question": "Welche drei Kanton hatten im Jahr 2023 durchschnittlich die wenigsten Stimmberechtigten? Wieviel Stimmberechtigte waren es jeweils?",
        "query": "SELECT S.name_de AS kanton, AVG(T.anzahl_stimmberechtigte) AS durchschnittliche_anzahl_stimmberechtigte_2023\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nAND T.jahr = 2023\nGROUP BY S.name_de\nORDER BY durchschnittliche_anzahl_stimmberechtigte_2023 ASC LIMIT 3;\n"
      },
      {
        "question": "Welche Volksabstimmung und in welchem Jahr hatte die wenigsten g\u00fcltigen Stimmenzettel? Wieviele waren es? Und wie hoch war die Wahlbeteiligung?",
        "query": "SELECT T.vorlage AS vorlage_mit_wenigsten_gueltigen_stimmenzetteln, T.jahr,\n  MIN(T.anzahl_gueltige_stimmzettel) AS anzahl_gueltige_stimmzettel, T.beteiligung_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE' AND S.name_de = 'Schweiz'\nGROUP BY T.vorlage, T.jahr, T.beteiligung_in_prozent\nORDER BY anzahl_gueltige_stimmzettel ASC LIMIT 1;\n"
      },
      {
        "question": "Welche drei Kanton hatten im Jahr 2023 durchschnittlich die wenigsten Stimmberechtigten? Wieviel Stimmberechtigte waren es jeweils?",
        "query": "SELECT S.name_de AS kanton, AVG(T.anzahl_stimmberechtigte) AS durchschnittliche_anzahl_stimmberechtigte_2023\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nAND T.jahr = 2023\nGROUP BY S.name_de\nORDER BY durchschnittliche_anzahl_stimmberechtigte_2023 ASC LIMIT 3;\n"
      },
      {
        "question": "Welche Vorlagen hatten mit dem Klima zu tun, wann fanden sie statt, wie waren Beteiligung und Ergebnis?",
        "query": "SELECT T.vorlage, T.jahr, T.beteiligung_in_prozent, T.ja_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND LOWER(T.vorlage) LIKE '%klima%';\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.volksabstimmung_nach_kanton_seit_1861 (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tvorlage TEXT, \n\tanzahl_stimmberechtigte NUMERIC, \n\tanzahl_abgegebene_stimmen NUMERIC, \n\tbeteiligung_in_prozent NUMERIC, \n\tanzahl_gueltige_stimmzettel NUMERIC, \n\tanzahl_ja_stimmen NUMERIC, \n\tanzahl_nein_stimmen NUMERIC, \n\tja_in_prozent NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT volksabstimmung_nach_kanton_seit_1861_pkey PRIMARY KEY (uid), \n\tCONSTRAINT volksabstimmung_nach_kanton_seit_1861_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in volksabstimmung_nach_kanton_seit_1861 and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2015, 2009, 2000, 2012, 2019\nvorlage : Volksinitiative \u00abF\u00fcr faire Steuern. Stopp dem Missbrauch beim Steuerwettbewerb\u00bb, Bundesbeschluss \u00fcber die ordentliche Einb\u00fcrgerung sowie \u00fcber die erleichterte Einb\u00fcrgerung junger Ausl\u00e4nderinnen und Ausl\u00e4nder der zweiten Generation, Bundesgesetz \u00fcber die Erwerbsersatzordnung f\u00fcr Dienstleistende in Armee, Zivildienst und Zivilschutz (Erwerbsersatzgesetz, EOG), Volksinitiative \u00abAHVplus: f\u00fcr eine starke AHV\u00bb, Volksinitiative \u00abF\u00fcr den geordneten Ausstieg aus der Atomenergie\u00bb\nanzahl_stimmberechtigte : 5400197, 5166973, 4852272, 4681043, 5493036\nanzahl_abgegebene_stimmen : 1972596, 2590724, 3264252, 1990232, 2572040\nbeteiligung_in_prozent : 50.8500000000000014, 53.7599999999999980, 38.5300000000000011, 48.9099999999999966, 46.8400000000000034\nanzahl_gueltige_stimmzettel : 1737349, 3430137, 2271316, 2241395, 2897763\nanzahl_ja_stimmen : 1206323, 2222594, 1531027, 774821, 1156706\nanzahl_nein_stimmen : 836101, 893370, 1322587, 1452453, 1531986\nja_in_prozent : 57.00999999999999801, 34.00000000000000000, 38.15999999999999659, 60.97999999999999687, 49.15999999999999659\n*/\n\n/*\nColumn name, Column discription, Example values\nvorlage, Titel der Abstimmungsvorlage, Bundesgesetz \u00fcber die Errichtung der schweizerischen Bundesbank,Bundesbeschluss betreffend Revision von Art. 103 der Bundesverfassung und Aufnahme eines Artikels 114bis in die Bundesverfassung,Volksinitiative \u00abf\u00fcr die vermehrte Mitbestimmung der Bundesversammlung und des Schweizervolkes im Nationalstrassenbau\u00bb\nanzahl_stimmberechtigte, Anzahl Stimmberechtigte, None\nanzahl_abgegebene_stimmen, Anzahl abgegebene Stimmenen, None\nbeteiligung_in_prozent, Wahlbeteiligung in Prozent, None\nanzahl_gueltige_stimmzettel, Anzahl g\u00fcltige Stimmenzettel, None\nanzahl_ja_stimmen, Anzahl ja Stimmen, None\nanzahl_nein_stimmen, Anzahl nein Stimmen, None\nja_in_prozent, ja Stimmen in Prozent der Gesamtstimmen, None\n*/\n\n\n\n### Question\nWieviel Prozent der Vorlagen wurden angenommen und wieviel Prozent wurden zur\u00fcckgewiesen?\n### SQL query\nSELECT\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent > 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_angenommene_vorlagen,\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent <= 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_zurueckgewiesene_vorlagen\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE';\n\n\n### Question\nWelche Vorlagen hatten mit dem Klima zu tun, wann fanden sie statt, wie waren Beteiligung und Ergebnis?\n### SQL query\nSELECT T.vorlage, T.jahr, T.beteiligung_in_prozent, T.ja_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND LOWER(T.vorlage) LIKE '%klima%';\n\n\n### Question\nWieviel Prozent der Vorlagen wurden angenommen und wieviel Prozent wurden zur\u00fcckgewiesen?\n### SQL query\nSELECT\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent > 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_angenommene_vorlagen,\n  ROUND((100 * COUNT(CASE WHEN T.ja_in_prozent <= 50 THEN 1 ELSE NULL END)) /\n  COUNT(*), 2) AS prozent_zurueckgewiesene_vorlagen\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE';\n\n\n### Question\nWelche drei Kanton hatten im Jahr 2023 durchschnittlich die wenigsten Stimmberechtigten? Wieviel Stimmberechtigte waren es jeweils?\n### SQL query\nSELECT S.name_de AS kanton, AVG(T.anzahl_stimmberechtigte) AS durchschnittliche_anzahl_stimmberechtigte_2023\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nAND T.jahr = 2023\nGROUP BY S.name_de\nORDER BY durchschnittliche_anzahl_stimmberechtigte_2023 ASC LIMIT 3;\n\n\n### Question\nWelche Volksabstimmung und in welchem Jahr hatte die wenigsten g\u00fcltigen Stimmenzettel? Wieviele waren es? Und wie hoch war die Wahlbeteiligung?\n### SQL query\nSELECT T.vorlage AS vorlage_mit_wenigsten_gueltigen_stimmenzetteln, T.jahr,\n  MIN(T.anzahl_gueltige_stimmzettel) AS anzahl_gueltige_stimmzettel, T.beteiligung_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE' AND S.name_de = 'Schweiz'\nGROUP BY T.vorlage, T.jahr, T.beteiligung_in_prozent\nORDER BY anzahl_gueltige_stimmzettel ASC LIMIT 1;\n\n\n### Question\nWelche drei Kanton hatten im Jahr 2023 durchschnittlich die wenigsten Stimmberechtigten? Wieviel Stimmberechtigte waren es jeweils?\n### SQL query\nSELECT S.name_de AS kanton, AVG(T.anzahl_stimmberechtigte) AS durchschnittliche_anzahl_stimmberechtigte_2023\nFROM volksabstimmung_nach_kanton_seit_1861 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nAND T.jahr = 2023\nGROUP BY S.name_de\nORDER BY durchschnittliche_anzahl_stimmberechtigte_2023 ASC LIMIT 3;\n\n\n### Question\nWelche Vorlagen hatten mit dem Klima zu tun, wann fanden sie statt, wie waren Beteiligung und Ergebnis?\n### SQL query\nSELECT T.vorlage, T.jahr, T.beteiligung_in_prozent, T.ja_in_prozent\nFROM volksabstimmung_nach_kanton_seit_1861 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND LOWER(T.vorlage) LIKE '%klima%';\n\n\n### Question\nWelches ist aktuellest Vorlage die schweizweit angenommen wurde, aber bei der in der Mehrheit der Kanton dagegen gestimmt wurde? Zeige auch wieviel Prozent Ja Stimmen sie Schweiz weit bekam.\n### SQL query\n",
    "process_time": 17.265078634023666,
    "num_tokens": 2772,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 67,
    "question": "Zeigen Sie mir den Gesamtstromverbrauch der Gemeinden in Basel-Landschaft im Jahr 2000 gegen\u00fcber 2020.",
    "query": "SELECT T.jahr , SUM(T.endverbrauch_elektrizitaet_mwh) as gesamt_endverbrauch_elektrizitaet_mwh_2020\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2000, 2020)\nGROUP BY T.jahr\nORDER BY gesamt_endverbrauch_elektrizitaet_mwh_2020 DESC;\n",
    "db_id": "basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr",
    "generated_query": "SELECT T.jahr, SUM(T.endverbrauch_elektrizitaet_mwh) as gesamtstromverbrauch\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND (T.jahr = 2000 OR T.jahr = 2020)\nGROUP BY T.jahr\nORDER BY T.jahr DESC;",
    "meta_data": [
      {
        "question": "Wie hoch war der j\u00e4hrliche Stromverbrauch von Blauen im Kanton Basel-Landschaft vor dem Jahr 2000?",
        "query": "SELECT T.jahr , T.endverbrauch_elektrizitaet_mwh as endverbrauch_elektrizitaet_mwh_blauen\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr < 2000\n    AND S.name IN ('Blauen', 'Blauen (BL)')\nORDER BY T.jahr DESC;\n"
      },
      {
        "question": "Wie hoch war der h\u00f6chste jemals gemessene j\u00e4hrliche Stromverbrauch in einer Gemeinde in Basel-Landschaft? Geben Sie auch den Namen der Gemeinde an.",
        "query": "SELECT T.jahr, S.name AS gemeinde, T.endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\nORDER BY T.endverbrauch_elektrizitaet_mwh DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wie hoch war der durchschnittliche j\u00e4hrliche Stromverbrauch der Gemeinden im Kanton Basel-Landschaft in den Jahren 2000 bis 2020?",
        "query": "SELECT T.jahr , AVG(T.endverbrauch_elektrizitaet_mwh) as mittlerer_endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr >= 2000\n    AND T.jahr <= 2020\nGROUP BY T.jahr\nORDER BY T.jahr DESC;\n"
      },
      {
        "question": "In welchem Jahr hatte Muttenz in Basel-Landschaft den h\u00f6chsten Stromverbrauch?",
        "query": "SELECT T.jahr, T.endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Muttenz', 'Muttenz (BL)')\nORDER BY T.endverbrauch_elektrizitaet_mwh DESC\nLIMIT 1;\n"
      },
      {
        "question": "Welche Gemeinde in Basel-Landschaft hatte 1995 den h\u00f6chsten Stromverbrauch?",
        "query": "SELECT S.name AS gemeinde, T.endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 1995\nORDER BY endverbrauch_elektrizitaet_mwh DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wie hoch war der h\u00f6chste jemals gemessene j\u00e4hrliche Stromverbrauch in einer Gemeinde in Basel-Landschaft? Geben Sie auch den Namen der Gemeinde an.",
        "query": "SELECT T.jahr, S.name AS gemeinde, T.endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\nORDER BY T.endverbrauch_elektrizitaet_mwh DESC\nLIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tendverbrauch_elektrizitaet_mwh NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und__pkey1 PRIMARY KEY (uid), \n\tCONSTRAINT basel_land_endverbrauch_von_ektrizitat_na_spatialunit_uid_fkey1 FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nendverbrauch_elektrizitaet_mwh : 811.00000000000000, 3101.00000000000000, 922.00000000000000, 90631.00000000000000, 5702.00000000000000\nspatialunit_uid : 2761_A.ADM3, 2790_A.ADM3, 2801_A.ADM3, 2858_A.ADM3, 649_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nendverbrauch_elektrizitaet_mwh, Endverbrauch Elektrizitaet Mwh, 536937258529674\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWie hoch war der j\u00e4hrliche Stromverbrauch von Blauen im Kanton Basel-Landschaft vor dem Jahr 2000?\n### SQL query\nSELECT T.jahr , T.endverbrauch_elektrizitaet_mwh as endverbrauch_elektrizitaet_mwh_blauen\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr < 2000\n    AND S.name IN ('Blauen', 'Blauen (BL)')\nORDER BY T.jahr DESC;\n\n\n### Question\nWie hoch war der h\u00f6chste jemals gemessene j\u00e4hrliche Stromverbrauch in einer Gemeinde in Basel-Landschaft? Geben Sie auch den Namen der Gemeinde an.\n### SQL query\nSELECT T.jahr, S.name AS gemeinde, T.endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\nORDER BY T.endverbrauch_elektrizitaet_mwh DESC\nLIMIT 1;\n\n\n### Question\nWie hoch war der durchschnittliche j\u00e4hrliche Stromverbrauch der Gemeinden im Kanton Basel-Landschaft in den Jahren 2000 bis 2020?\n### SQL query\nSELECT T.jahr , AVG(T.endverbrauch_elektrizitaet_mwh) as mittlerer_endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr >= 2000\n    AND T.jahr <= 2020\nGROUP BY T.jahr\nORDER BY T.jahr DESC;\n\n\n### Question\nIn welchem Jahr hatte Muttenz in Basel-Landschaft den h\u00f6chsten Stromverbrauch?\n### SQL query\nSELECT T.jahr, T.endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Muttenz', 'Muttenz (BL)')\nORDER BY T.endverbrauch_elektrizitaet_mwh DESC\nLIMIT 1;\n\n\n### Question\nWelche Gemeinde in Basel-Landschaft hatte 1995 den h\u00f6chsten Stromverbrauch?\n### SQL query\nSELECT S.name AS gemeinde, T.endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 1995\nORDER BY endverbrauch_elektrizitaet_mwh DESC\nLIMIT 1;\n\n\n### Question\nWie hoch war der h\u00f6chste jemals gemessene j\u00e4hrliche Stromverbrauch in einer Gemeinde in Basel-Landschaft? Geben Sie auch den Namen der Gemeinde an.\n### SQL query\nSELECT T.jahr, S.name AS gemeinde, T.endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\nORDER BY T.endverbrauch_elektrizitaet_mwh DESC\nLIMIT 1;\n\n\n### Question\nZeigen Sie mir den Gesamtstromverbrauch der Gemeinden in Basel-Landschaft im Jahr 2000 gegen\u00fcber 2020.\n### SQL query\n",
    "process_time": 8.647546696010977,
    "num_tokens": 1903,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 68,
    "question": "Welche der Gemeinden Bottmingen und Birsfelden in Basel-Landschaft hatte 2018 den h\u00f6chsten Stromverbrauch?",
    "query": "SELECT S.name AS gemeinde, T.endverbrauch_elektrizitaet_mwh as endverbrauch_elektrizitaet_mwh_2018\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2018\n    AND S.name IN ('Blauen', 'Blauen (BL)', 'Birsfelden', 'Birsfelden (BL)')\nORDER BY T.endverbrauch_elektrizitaet_mwh DESC;\n",
    "db_id": "basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr",
    "generated_query": "SELECT S.name AS gemeinde, T.endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2018\n    AND S.name IN ('Bottmingen', 'Birsfelden')\nORDER BY endverbrauch_elektrizitaet_mwh DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Wie hoch war der j\u00e4hrliche Stromverbrauch von Blauen im Kanton Basel-Landschaft vor dem Jahr 2000?",
        "query": "SELECT T.jahr , T.endverbrauch_elektrizitaet_mwh as endverbrauch_elektrizitaet_mwh_blauen\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr < 2000\n    AND S.name IN ('Blauen', 'Blauen (BL)')\nORDER BY T.jahr DESC;\n"
      },
      {
        "question": "Welche drei Gemeinden in Basel-Landschaft hatten im Jahr 2012 den geringsten Stromverbrauch?",
        "query": "SELECT S.name AS gemeinde, T.endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2012\nORDER BY endverbrauch_elektrizitaet_mwh ASC\nLIMIT 3;\n"
      },
      {
        "question": "Welche Gemeinde in Basel-Landschaft hatte 1995 den h\u00f6chsten Stromverbrauch?",
        "query": "SELECT S.name AS gemeinde, T.endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 1995\nORDER BY endverbrauch_elektrizitaet_mwh DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wie hoch war der j\u00e4hrliche Stromverbrauch von Blauen im Kanton Basel-Landschaft vor dem Jahr 2000?",
        "query": "SELECT T.jahr , T.endverbrauch_elektrizitaet_mwh as endverbrauch_elektrizitaet_mwh_blauen\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr < 2000\n    AND S.name IN ('Blauen', 'Blauen (BL)')\nORDER BY T.jahr DESC;\n"
      },
      {
        "question": "Wie hoch war der j\u00e4hrliche Stromverbrauch von Blauen im Kanton Basel-Landschaft vor dem Jahr 2000?",
        "query": "SELECT T.jahr , T.endverbrauch_elektrizitaet_mwh as endverbrauch_elektrizitaet_mwh_blauen\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr < 2000\n    AND S.name IN ('Blauen', 'Blauen (BL)')\nORDER BY T.jahr DESC;\n"
      },
      {
        "question": "Welche Gemeinde in Basel-Landschaft hatte 1995 den h\u00f6chsten Stromverbrauch?",
        "query": "SELECT S.name AS gemeinde, T.endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 1995\nORDER BY endverbrauch_elektrizitaet_mwh DESC\nLIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tendverbrauch_elektrizitaet_mwh NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und__pkey1 PRIMARY KEY (uid), \n\tCONSTRAINT basel_land_endverbrauch_von_ektrizitat_na_spatialunit_uid_fkey1 FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nendverbrauch_elektrizitaet_mwh : 811.00000000000000, 3101.00000000000000, 922.00000000000000, 90631.00000000000000, 5702.00000000000000\nspatialunit_uid : 2761_A.ADM3, 2790_A.ADM3, 2801_A.ADM3, 2858_A.ADM3, 649_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nendverbrauch_elektrizitaet_mwh, Endverbrauch Elektrizitaet Mwh, 536937258529674\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWie hoch war der j\u00e4hrliche Stromverbrauch von Blauen im Kanton Basel-Landschaft vor dem Jahr 2000?\n### SQL query\nSELECT T.jahr , T.endverbrauch_elektrizitaet_mwh as endverbrauch_elektrizitaet_mwh_blauen\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr < 2000\n    AND S.name IN ('Blauen', 'Blauen (BL)')\nORDER BY T.jahr DESC;\n\n\n### Question\nWelche drei Gemeinden in Basel-Landschaft hatten im Jahr 2012 den geringsten Stromverbrauch?\n### SQL query\nSELECT S.name AS gemeinde, T.endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2012\nORDER BY endverbrauch_elektrizitaet_mwh ASC\nLIMIT 3;\n\n\n### Question\nWelche Gemeinde in Basel-Landschaft hatte 1995 den h\u00f6chsten Stromverbrauch?\n### SQL query\nSELECT S.name AS gemeinde, T.endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 1995\nORDER BY endverbrauch_elektrizitaet_mwh DESC\nLIMIT 1;\n\n\n### Question\nWie hoch war der j\u00e4hrliche Stromverbrauch von Blauen im Kanton Basel-Landschaft vor dem Jahr 2000?\n### SQL query\nSELECT T.jahr , T.endverbrauch_elektrizitaet_mwh as endverbrauch_elektrizitaet_mwh_blauen\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr < 2000\n    AND S.name IN ('Blauen', 'Blauen (BL)')\nORDER BY T.jahr DESC;\n\n\n### Question\nWie hoch war der j\u00e4hrliche Stromverbrauch von Blauen im Kanton Basel-Landschaft vor dem Jahr 2000?\n### SQL query\nSELECT T.jahr , T.endverbrauch_elektrizitaet_mwh as endverbrauch_elektrizitaet_mwh_blauen\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr < 2000\n    AND S.name IN ('Blauen', 'Blauen (BL)')\nORDER BY T.jahr DESC;\n\n\n### Question\nWelche Gemeinde in Basel-Landschaft hatte 1995 den h\u00f6chsten Stromverbrauch?\n### SQL query\nSELECT S.name AS gemeinde, T.endverbrauch_elektrizitaet_mwh\nFROM basel_land_endverbrauch_von_ektrizitat_nach_gemeinde_und_jahr as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 1995\nORDER BY endverbrauch_elektrizitaet_mwh DESC\nLIMIT 1;\n\n\n### Question\nWelche der Gemeinden Bottmingen und Birsfelden in Basel-Landschaft hatte 2018 den h\u00f6chsten Stromverbrauch?\n### SQL query\n",
    "process_time": 7.437633354915306,
    "num_tokens": 1882,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 69,
    "question": "Wie viele Reformierte gab es im Kanton Basel-Landschaft in 2022?",
    "query": "SELECT SUM(T.anzahl_evangelisch_reformiert)\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2022;\n",
    "db_id": "basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde",
    "generated_query": "SELECT SUM(T.anzahl_evangelisch_reformiert) as number_reformed_evangelics\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name IN ('Basel-Landschaft', 'Basel-Landschaft (BL)')\n    AND T.jahr = 2022;",
    "meta_data": [
      {
        "question": "Wie hat sich die Anzahl der Reformierten in Allschwil, im Kanton Basel-Landschaft, zwischen 2010 und 2015 entwickelt?",
        "query": "SELECT T.jahr, SUM(T.anzahl_evangelisch_reformiert) as number_reformed_evangelics\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Allschwil', 'Allschwil (BL)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2015\nGROUP BY T.jahr;\n"
      },
      {
        "question": "Wie hat sich die Anzahl der Reformierten in Allschwil, im Kanton Basel-Landschaft, zwischen 2010 und 2015 entwickelt?",
        "query": "SELECT T.jahr, SUM(T.anzahl_evangelisch_reformiert) as number_reformed_evangelics\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Allschwil', 'Allschwil (BL)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2015\nGROUP BY T.jahr;\n"
      },
      {
        "question": "Zeigen Sie mir die Entwicklung der Bev\u00f6lkerung von Pratteln, in Basel-Landschaft, zwischen 2017 und 2019.",
        "query": "SELECT T.jahr, SUM(T.gesamt_anzahl_personen) as population\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Pratteln', 'Pratteln (BL)')\n    AND T.jahr >= 2017\n    AND T.jahr <= 2019\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Welcher Anteil der Bev\u00f6lkerung von Basel-Landschaft geh\u00f6rte 2021 einer bekannten Religion an?",
        "query": "SELECT 1 - (\n    SUM(CAST(T.anzahl_unbekannt_konfession AS FLOAT)) / SUM(T.gesamt_anzahl_personen)\n) AS proportion_known_religion_basel_land_2021\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nGROUP BY T.jahr;\n"
      },
      {
        "question": "Welcher Anteil der ausl\u00e4ndischen Bev\u00f6lkerung von Ettingen, BL, hatte 2011 eine unbekannte Konfession?",
        "query": "SELECT SUM(CAST(T.anzahl_unbekannt_konfession AS FLOAT)) / SUM(T.gesamt_anzahl_personen) AS proportion_unknown_religion_ettingen_2011\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Ettingen', 'Ettingen (BL)')\n    AND T.nationalitat = 'Ausland'\n    AND T.jahr = 2011;\n"
      },
      {
        "question": "Zeigen Sie mir die Entwicklung der Bev\u00f6lkerung von Pratteln, in Basel-Landschaft, zwischen 2017 und 2019.",
        "query": "SELECT T.jahr, SUM(T.gesamt_anzahl_personen) as population\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Pratteln', 'Pratteln (BL)')\n    AND T.jahr >= 2017\n    AND T.jahr <= 2019\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Welcher Anteil der ausl\u00e4ndischen Bev\u00f6lkerung von Ettingen, BL, hatte 2011 eine unbekannte Konfession?",
        "query": "SELECT SUM(CAST(T.anzahl_unbekannt_konfession AS FLOAT)) / SUM(T.gesamt_anzahl_personen) AS proportion_unknown_religion_ettingen_2011\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Ettingen', 'Ettingen (BL)')\n    AND T.nationalitat = 'Ausland'\n    AND T.jahr = 2011;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tnationalitat TEXT, \n\tanzahl_evangelisch_reformiert NUMERIC, \n\tanzahl_romisch_katholisch NUMERIC, \n\tanzahl_christkatholisch NUMERIC, \n\tanzahl_unbekannt_konfession NUMERIC, \n\tgesamt_anzahl_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_land_bevolkerung_nach_nationalitat_konfession_gemein_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_land_bevolkerung_nach_nationalitat_k_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nanzahl_evangelisch_reformiert : 459, 115, 359, 1326, 88\nanzahl_romisch_katholisch : 2226, 72, 459, 870, 88\nanzahl_christkatholisch : 4, 257, 24, 28, 17\nanzahl_unbekannt_konfession : 2911, 3014, 29, 88, 136\ngesamt_anzahl_personen : 5545, 1380, 2997, 1146, 14137\nspatialunit_uid : 2761_A.ADM3, 2790_A.ADM3, 2858_A.ADM3, 2866_A.ADM3, 2869_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nnationalitat, Nationalit\u00e4t, Schweiz,Ausland\ngesamt_anzahl_personen, Gesamtanzahl Personen, None\n\u200banzahl_evangelisch_reformiert, Anzahl Evangelisch-Reformierten, None\n\u200banzahl_romisch_katholisch, Anzahl der R\u00f6misch-Katholischen, None\nanzahl_christkatholisch, Anzahl der Christkatholischen, None\nanzahl_unbekannt_konfession, Anzahl der Personen mit unbekannter Konfession, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWie hat sich die Anzahl der Reformierten in Allschwil, im Kanton Basel-Landschaft, zwischen 2010 und 2015 entwickelt?\n### SQL query\nSELECT T.jahr, SUM(T.anzahl_evangelisch_reformiert) as number_reformed_evangelics\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Allschwil', 'Allschwil (BL)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2015\nGROUP BY T.jahr;\n\n\n### Question\nWie hat sich die Anzahl der Reformierten in Allschwil, im Kanton Basel-Landschaft, zwischen 2010 und 2015 entwickelt?\n### SQL query\nSELECT T.jahr, SUM(T.anzahl_evangelisch_reformiert) as number_reformed_evangelics\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Allschwil', 'Allschwil (BL)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2015\nGROUP BY T.jahr;\n\n\n### Question\nZeigen Sie mir die Entwicklung der Bev\u00f6lkerung von Pratteln, in Basel-Landschaft, zwischen 2017 und 2019.\n### SQL query\nSELECT T.jahr, SUM(T.gesamt_anzahl_personen) as population\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Pratteln', 'Pratteln (BL)')\n    AND T.jahr >= 2017\n    AND T.jahr <= 2019\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n\n\n### Question\nWelcher Anteil der Bev\u00f6lkerung von Basel-Landschaft geh\u00f6rte 2021 einer bekannten Religion an?\n### SQL query\nSELECT 1 - (\n    SUM(CAST(T.anzahl_unbekannt_konfession AS FLOAT)) / SUM(T.gesamt_anzahl_personen)\n) AS proportion_known_religion_basel_land_2021\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nGROUP BY T.jahr;\n\n\n### Question\nWelcher Anteil der ausl\u00e4ndischen Bev\u00f6lkerung von Ettingen, BL, hatte 2011 eine unbekannte Konfession?\n### SQL query\nSELECT SUM(CAST(T.anzahl_unbekannt_konfession AS FLOAT)) / SUM(T.gesamt_anzahl_personen) AS proportion_unknown_religion_ettingen_2011\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Ettingen', 'Ettingen (BL)')\n    AND T.nationalitat = 'Ausland'\n    AND T.jahr = 2011;\n\n\n### Question\nZeigen Sie mir die Entwicklung der Bev\u00f6lkerung von Pratteln, in Basel-Landschaft, zwischen 2017 und 2019.\n### SQL query\nSELECT T.jahr, SUM(T.gesamt_anzahl_personen) as population\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Pratteln', 'Pratteln (BL)')\n    AND T.jahr >= 2017\n    AND T.jahr <= 2019\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n\n\n### Question\nWelcher Anteil der ausl\u00e4ndischen Bev\u00f6lkerung von Ettingen, BL, hatte 2011 eine unbekannte Konfession?\n### SQL query\nSELECT SUM(CAST(T.anzahl_unbekannt_konfession AS FLOAT)) / SUM(T.gesamt_anzahl_personen) AS proportion_unknown_religion_ettingen_2011\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Ettingen', 'Ettingen (BL)')\n    AND T.nationalitat = 'Ausland'\n    AND T.jahr = 2011;\n\n\n### Question\nWie viele Reformierte gab es im Kanton Basel-Landschaft in 2022?\n### SQL query\n",
    "process_time": 6.827566346852109,
    "num_tokens": 2310,
    "hardness": "medium",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 70,
    "question": "Zwischen den Gemeinden Arlesheim und Birsfelden im Kanton Basel-Landschaft, welche hatte 2003 einen h\u00f6heren Anteil an Protestanten?",
    "query": "SELECT S.name AS gemeinde, CAST(SUM(T.anzahl_evangelisch_reformiert) AS FLOAT) / SUM(T.gesamt_anzahl_personen) as proportion_protestants_2003\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Ettingen', 'Ettingen (BL)', 'Birsfelden', 'Birsfelden (BL)')\n    AND T.jahr = 2003\nGROUP BY S.name\nORDER BY proportion_protestants_2003 DESC;\n",
    "db_id": "basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde",
    "generated_query": "SELECT S.name, CAST(T.anzahl_evangelisch_reformiert AS FLOAT) / T.gesamt_anzahl_personen as proportion_protestants_2003\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Arlesheim', 'Birsfelden')\n    AND T.jahr = 2003\nORDER BY proportion_protestants_2003 DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Zeigen Sie mir die Entwicklung der Bev\u00f6lkerung von Pratteln, in Basel-Landschaft, zwischen 2017 und 2019.",
        "query": "SELECT T.jahr, SUM(T.gesamt_anzahl_personen) as population\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Pratteln', 'Pratteln (BL)')\n    AND T.jahr >= 2017\n    AND T.jahr <= 2019\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Welche 5 Gemeinden hatten 2008 den h\u00f6chsten Anteil an Reformierten im Kanton Basel-Landschaft?",
        "query": "SELECT S.name, CAST(SUM(T.anzahl_evangelisch_reformiert) AS FLOAT) / SUM(T.gesamt_anzahl_personen) as proportion_protestants_2008\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2008\nGROUP BY S.name\nORDER BY proportion_protestants_2008 DESC\nLIMIT 5;\n"
      },
      {
        "question": "Welcher Anteil der ausl\u00e4ndischen Bev\u00f6lkerung von Ettingen, BL, hatte 2011 eine unbekannte Konfession?",
        "query": "SELECT SUM(CAST(T.anzahl_unbekannt_konfession AS FLOAT)) / SUM(T.gesamt_anzahl_personen) AS proportion_unknown_religion_ettingen_2011\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Ettingen', 'Ettingen (BL)')\n    AND T.nationalitat = 'Ausland'\n    AND T.jahr = 2011;\n"
      },
      {
        "question": "Wie hat sich die Anzahl der Reformierten in Allschwil, im Kanton Basel-Landschaft, zwischen 2010 und 2015 entwickelt?",
        "query": "SELECT T.jahr, SUM(T.anzahl_evangelisch_reformiert) as number_reformed_evangelics\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Allschwil', 'Allschwil (BL)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2015\nGROUP BY T.jahr;\n"
      },
      {
        "question": "Welche 5 Gemeinden hatten 2008 den h\u00f6chsten Anteil an Reformierten im Kanton Basel-Landschaft?",
        "query": "SELECT S.name, CAST(SUM(T.anzahl_evangelisch_reformiert) AS FLOAT) / SUM(T.gesamt_anzahl_personen) as proportion_protestants_2008\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2008\nGROUP BY S.name\nORDER BY proportion_protestants_2008 DESC\nLIMIT 5;\n"
      },
      {
        "question": "Zeigen Sie mir die Entwicklung der Bev\u00f6lkerung von Pratteln, in Basel-Landschaft, zwischen 2017 und 2019.",
        "query": "SELECT T.jahr, SUM(T.gesamt_anzahl_personen) as population\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Pratteln', 'Pratteln (BL)')\n    AND T.jahr >= 2017\n    AND T.jahr <= 2019\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Wie hoch war der Anteil der Gemeinden im Kanton Basel-Landschaft, in denen es 2018 mehr Katholiken als Protestanten unter der Schweizer Bev\u00f6lkerung gab?",
        "query": "SELECT SUM(\n    CASE WHEN (T1.anzahl_romisch_katholisch + T1.anzahl_christkatholisch) > T1.anzahl_evangelisch_reformiert THEN 1 ELSE 0 END\n) / CAST(COUNT(T1.anzahl_evangelisch_reformiert) AS FLOAT) AS proprtion_municipalities_more_catholics_than_reformed_2018\nFROM (\n    SELECT\n        S.name as municipality,\n        AVG(T.anzahl_christkatholisch) as anzahl_christkatholisch,\n        AVG(T.anzahl_romisch_katholisch) as anzahl_romisch_katholisch,\n        AVG(T.anzahl_evangelisch_reformiert) as anzahl_evangelisch_reformiert\n    FROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2018\n        AND T.nationalitat = 'Schweiz'\n    GROUP BY S.name\n) AS T1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tnationalitat TEXT, \n\tanzahl_evangelisch_reformiert NUMERIC, \n\tanzahl_romisch_katholisch NUMERIC, \n\tanzahl_christkatholisch NUMERIC, \n\tanzahl_unbekannt_konfession NUMERIC, \n\tgesamt_anzahl_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_land_bevolkerung_nach_nationalitat_konfession_gemein_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_land_bevolkerung_nach_nationalitat_k_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nanzahl_evangelisch_reformiert : 459, 115, 359, 1326, 88\nanzahl_romisch_katholisch : 2226, 72, 459, 870, 88\nanzahl_christkatholisch : 4, 257, 24, 28, 17\nanzahl_unbekannt_konfession : 2911, 3014, 29, 88, 136\ngesamt_anzahl_personen : 5545, 1380, 2997, 1146, 14137\nspatialunit_uid : 2761_A.ADM3, 2790_A.ADM3, 2858_A.ADM3, 2866_A.ADM3, 2869_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nnationalitat, Nationalit\u00e4t, Schweiz,Ausland\ngesamt_anzahl_personen, Gesamtanzahl Personen, None\n\u200banzahl_evangelisch_reformiert, Anzahl Evangelisch-Reformierten, None\n\u200banzahl_romisch_katholisch, Anzahl der R\u00f6misch-Katholischen, None\nanzahl_christkatholisch, Anzahl der Christkatholischen, None\nanzahl_unbekannt_konfession, Anzahl der Personen mit unbekannter Konfession, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nZeigen Sie mir die Entwicklung der Bev\u00f6lkerung von Pratteln, in Basel-Landschaft, zwischen 2017 und 2019.\n### SQL query\nSELECT T.jahr, SUM(T.gesamt_anzahl_personen) as population\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Pratteln', 'Pratteln (BL)')\n    AND T.jahr >= 2017\n    AND T.jahr <= 2019\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n\n\n### Question\nWelche 5 Gemeinden hatten 2008 den h\u00f6chsten Anteil an Reformierten im Kanton Basel-Landschaft?\n### SQL query\nSELECT S.name, CAST(SUM(T.anzahl_evangelisch_reformiert) AS FLOAT) / SUM(T.gesamt_anzahl_personen) as proportion_protestants_2008\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2008\nGROUP BY S.name\nORDER BY proportion_protestants_2008 DESC\nLIMIT 5;\n\n\n### Question\nWelcher Anteil der ausl\u00e4ndischen Bev\u00f6lkerung von Ettingen, BL, hatte 2011 eine unbekannte Konfession?\n### SQL query\nSELECT SUM(CAST(T.anzahl_unbekannt_konfession AS FLOAT)) / SUM(T.gesamt_anzahl_personen) AS proportion_unknown_religion_ettingen_2011\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Ettingen', 'Ettingen (BL)')\n    AND T.nationalitat = 'Ausland'\n    AND T.jahr = 2011;\n\n\n### Question\nWie hat sich die Anzahl der Reformierten in Allschwil, im Kanton Basel-Landschaft, zwischen 2010 und 2015 entwickelt?\n### SQL query\nSELECT T.jahr, SUM(T.anzahl_evangelisch_reformiert) as number_reformed_evangelics\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Allschwil', 'Allschwil (BL)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2015\nGROUP BY T.jahr;\n\n\n### Question\nWelche 5 Gemeinden hatten 2008 den h\u00f6chsten Anteil an Reformierten im Kanton Basel-Landschaft?\n### SQL query\nSELECT S.name, CAST(SUM(T.anzahl_evangelisch_reformiert) AS FLOAT) / SUM(T.gesamt_anzahl_personen) as proportion_protestants_2008\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2008\nGROUP BY S.name\nORDER BY proportion_protestants_2008 DESC\nLIMIT 5;\n\n\n### Question\nZeigen Sie mir die Entwicklung der Bev\u00f6lkerung von Pratteln, in Basel-Landschaft, zwischen 2017 und 2019.\n### SQL query\nSELECT T.jahr, SUM(T.gesamt_anzahl_personen) as population\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Pratteln', 'Pratteln (BL)')\n    AND T.jahr >= 2017\n    AND T.jahr <= 2019\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n\n\n### Question\nWie hoch war der Anteil der Gemeinden im Kanton Basel-Landschaft, in denen es 2018 mehr Katholiken als Protestanten unter der Schweizer Bev\u00f6lkerung gab?\n### SQL query\nSELECT SUM(\n    CASE WHEN (T1.anzahl_romisch_katholisch + T1.anzahl_christkatholisch) > T1.anzahl_evangelisch_reformiert THEN 1 ELSE 0 END\n) / CAST(COUNT(T1.anzahl_evangelisch_reformiert) AS FLOAT) AS proprtion_municipalities_more_catholics_than_reformed_2018\nFROM (\n    SELECT\n        S.name as municipality,\n        AVG(T.anzahl_christkatholisch) as anzahl_christkatholisch,\n        AVG(T.anzahl_romisch_katholisch) as anzahl_romisch_katholisch,\n        AVG(T.anzahl_evangelisch_reformiert) as anzahl_evangelisch_reformiert\n    FROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2018\n        AND T.nationalitat = 'Schweiz'\n    GROUP BY S.name\n) AS T1;\n\n\n### Question\nZwischen den Gemeinden Arlesheim und Birsfelden im Kanton Basel-Landschaft, welche hatte 2003 einen h\u00f6heren Anteil an Protestanten?\n### SQL query\n",
    "process_time": 9.447919872123748,
    "num_tokens": 2460,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 71,
    "question": "Wie hoch war der Anteil der r\u00f6misch-katholischen Personen an der ausl\u00e4ndischen Bev\u00f6lkerung des Kantons Basel-Landschaft im Jahr 2021?",
    "query": "SELECT SUM(CAST(T.anzahl_romisch_katholisch AS FLOAT)) / SUM(T.gesamt_anzahl_personen) AS proportion_foreign_romisch_katholisch_basel_land_2021\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\n    AND T.nationalitat = 'Ausland';\n",
    "db_id": "basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde",
    "generated_query": "SELECT SUM(T.anzahl_romisch_katholisch) / SUM(T.gesamt_anzahl_personen) AS proportion_catholics_foreign_population_2021\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n    AND T.nationalitat = 'Ausland'\n    AND T.jahr = 2021;",
    "meta_data": [
      {
        "question": "Wie hat sich die Anzahl der Reformierten in Allschwil, im Kanton Basel-Landschaft, zwischen 2010 und 2015 entwickelt?",
        "query": "SELECT T.jahr, SUM(T.anzahl_evangelisch_reformiert) as number_reformed_evangelics\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Allschwil', 'Allschwil (BL)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2015\nGROUP BY T.jahr;\n"
      },
      {
        "question": "Zeigen Sie mir die Entwicklung der Bev\u00f6lkerung von Pratteln, in Basel-Landschaft, zwischen 2017 und 2019.",
        "query": "SELECT T.jahr, SUM(T.gesamt_anzahl_personen) as population\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Pratteln', 'Pratteln (BL)')\n    AND T.jahr >= 2017\n    AND T.jahr <= 2019\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Wie hat sich die Anzahl der Reformierten in Allschwil, im Kanton Basel-Landschaft, zwischen 2010 und 2015 entwickelt?",
        "query": "SELECT T.jahr, SUM(T.anzahl_evangelisch_reformiert) as number_reformed_evangelics\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Allschwil', 'Allschwil (BL)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2015\nGROUP BY T.jahr;\n"
      },
      {
        "question": "Wie hat sich die Anzahl der Reformierten in Allschwil, im Kanton Basel-Landschaft, zwischen 2010 und 2015 entwickelt?",
        "query": "SELECT T.jahr, SUM(T.anzahl_evangelisch_reformiert) as number_reformed_evangelics\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Allschwil', 'Allschwil (BL)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2015\nGROUP BY T.jahr;\n"
      },
      {
        "question": "Welche 5 Gemeinden hatten 2008 den h\u00f6chsten Anteil an Reformierten im Kanton Basel-Landschaft?",
        "query": "SELECT S.name, CAST(SUM(T.anzahl_evangelisch_reformiert) AS FLOAT) / SUM(T.gesamt_anzahl_personen) as proportion_protestants_2008\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2008\nGROUP BY S.name\nORDER BY proportion_protestants_2008 DESC\nLIMIT 5;\n"
      },
      {
        "question": "Welcher Anteil der ausl\u00e4ndischen Bev\u00f6lkerung von Ettingen, BL, hatte 2011 eine unbekannte Konfession?",
        "query": "SELECT SUM(CAST(T.anzahl_unbekannt_konfession AS FLOAT)) / SUM(T.gesamt_anzahl_personen) AS proportion_unknown_religion_ettingen_2011\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Ettingen', 'Ettingen (BL)')\n    AND T.nationalitat = 'Ausland'\n    AND T.jahr = 2011;\n"
      },
      {
        "question": "Wie hoch war der Anteil der Gemeinden im Kanton Basel-Landschaft, in denen es 2018 mehr Katholiken als Protestanten unter der Schweizer Bev\u00f6lkerung gab?",
        "query": "SELECT SUM(\n    CASE WHEN (T1.anzahl_romisch_katholisch + T1.anzahl_christkatholisch) > T1.anzahl_evangelisch_reformiert THEN 1 ELSE 0 END\n) / CAST(COUNT(T1.anzahl_evangelisch_reformiert) AS FLOAT) AS proprtion_municipalities_more_catholics_than_reformed_2018\nFROM (\n    SELECT\n        S.name as municipality,\n        AVG(T.anzahl_christkatholisch) as anzahl_christkatholisch,\n        AVG(T.anzahl_romisch_katholisch) as anzahl_romisch_katholisch,\n        AVG(T.anzahl_evangelisch_reformiert) as anzahl_evangelisch_reformiert\n    FROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2018\n        AND T.nationalitat = 'Schweiz'\n    GROUP BY S.name\n) AS T1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tnationalitat TEXT, \n\tanzahl_evangelisch_reformiert NUMERIC, \n\tanzahl_romisch_katholisch NUMERIC, \n\tanzahl_christkatholisch NUMERIC, \n\tanzahl_unbekannt_konfession NUMERIC, \n\tgesamt_anzahl_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_land_bevolkerung_nach_nationalitat_konfession_gemein_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_land_bevolkerung_nach_nationalitat_k_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nanzahl_evangelisch_reformiert : 459, 115, 359, 1326, 88\nanzahl_romisch_katholisch : 2226, 72, 459, 870, 88\nanzahl_christkatholisch : 4, 257, 24, 28, 17\nanzahl_unbekannt_konfession : 2911, 3014, 29, 88, 136\ngesamt_anzahl_personen : 5545, 1380, 2997, 1146, 14137\nspatialunit_uid : 2761_A.ADM3, 2790_A.ADM3, 2858_A.ADM3, 2866_A.ADM3, 2869_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nnationalitat, Nationalit\u00e4t, Schweiz,Ausland\ngesamt_anzahl_personen, Gesamtanzahl Personen, None\n\u200banzahl_evangelisch_reformiert, Anzahl Evangelisch-Reformierten, None\n\u200banzahl_romisch_katholisch, Anzahl der R\u00f6misch-Katholischen, None\nanzahl_christkatholisch, Anzahl der Christkatholischen, None\nanzahl_unbekannt_konfession, Anzahl der Personen mit unbekannter Konfession, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWie hat sich die Anzahl der Reformierten in Allschwil, im Kanton Basel-Landschaft, zwischen 2010 und 2015 entwickelt?\n### SQL query\nSELECT T.jahr, SUM(T.anzahl_evangelisch_reformiert) as number_reformed_evangelics\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Allschwil', 'Allschwil (BL)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2015\nGROUP BY T.jahr;\n\n\n### Question\nZeigen Sie mir die Entwicklung der Bev\u00f6lkerung von Pratteln, in Basel-Landschaft, zwischen 2017 und 2019.\n### SQL query\nSELECT T.jahr, SUM(T.gesamt_anzahl_personen) as population\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Pratteln', 'Pratteln (BL)')\n    AND T.jahr >= 2017\n    AND T.jahr <= 2019\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n\n\n### Question\nWie hat sich die Anzahl der Reformierten in Allschwil, im Kanton Basel-Landschaft, zwischen 2010 und 2015 entwickelt?\n### SQL query\nSELECT T.jahr, SUM(T.anzahl_evangelisch_reformiert) as number_reformed_evangelics\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Allschwil', 'Allschwil (BL)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2015\nGROUP BY T.jahr;\n\n\n### Question\nWie hat sich die Anzahl der Reformierten in Allschwil, im Kanton Basel-Landschaft, zwischen 2010 und 2015 entwickelt?\n### SQL query\nSELECT T.jahr, SUM(T.anzahl_evangelisch_reformiert) as number_reformed_evangelics\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Allschwil', 'Allschwil (BL)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2015\nGROUP BY T.jahr;\n\n\n### Question\nWelche 5 Gemeinden hatten 2008 den h\u00f6chsten Anteil an Reformierten im Kanton Basel-Landschaft?\n### SQL query\nSELECT S.name, CAST(SUM(T.anzahl_evangelisch_reformiert) AS FLOAT) / SUM(T.gesamt_anzahl_personen) as proportion_protestants_2008\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2008\nGROUP BY S.name\nORDER BY proportion_protestants_2008 DESC\nLIMIT 5;\n\n\n### Question\nWelcher Anteil der ausl\u00e4ndischen Bev\u00f6lkerung von Ettingen, BL, hatte 2011 eine unbekannte Konfession?\n### SQL query\nSELECT SUM(CAST(T.anzahl_unbekannt_konfession AS FLOAT)) / SUM(T.gesamt_anzahl_personen) AS proportion_unknown_religion_ettingen_2011\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Ettingen', 'Ettingen (BL)')\n    AND T.nationalitat = 'Ausland'\n    AND T.jahr = 2011;\n\n\n### Question\nWie hoch war der Anteil der Gemeinden im Kanton Basel-Landschaft, in denen es 2018 mehr Katholiken als Protestanten unter der Schweizer Bev\u00f6lkerung gab?\n### SQL query\nSELECT SUM(\n    CASE WHEN (T1.anzahl_romisch_katholisch + T1.anzahl_christkatholisch) > T1.anzahl_evangelisch_reformiert THEN 1 ELSE 0 END\n) / CAST(COUNT(T1.anzahl_evangelisch_reformiert) AS FLOAT) AS proprtion_municipalities_more_catholics_than_reformed_2018\nFROM (\n    SELECT\n        S.name as municipality,\n        AVG(T.anzahl_christkatholisch) as anzahl_christkatholisch,\n        AVG(T.anzahl_romisch_katholisch) as anzahl_romisch_katholisch,\n        AVG(T.anzahl_evangelisch_reformiert) as anzahl_evangelisch_reformiert\n    FROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2018\n        AND T.nationalitat = 'Schweiz'\n    GROUP BY S.name\n) AS T1;\n\n\n### Question\nWie hoch war der Anteil der r\u00f6misch-katholischen Personen an der ausl\u00e4ndischen Bev\u00f6lkerung des Kantons Basel-Landschaft im Jahr 2021?\n### SQL query\n",
    "process_time": 8.226529002888128,
    "num_tokens": 2466,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 72,
    "question": "Welches waren im Jahr 2022 die 3 Gemeinden mit dem h\u00f6chsten Ausl\u00e4nderanteil im Kanton Basel-Landschaft?",
    "query": "SELECT S.name AS gemeinde, SUM(CASE WHEN T.nationalitat = 'Ausland' THEN T.gesamt_anzahl_personen ELSE 0 END) / CAST(SUM(T.gesamt_anzahl_personen) AS FLOAT) AS proportion_foreign_residents\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2022\nGROUP BY S.name\nORDER BY proportion_foreign_residents DESC\nLIMIT 3;\n",
    "db_id": "basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde",
    "generated_query": "SELECT S.name, SUM(T.gesamt_anzahl_personen) as total_population, SUM(T.gesamt_anzahl_personen) - SUM(T.anzahl_unbekannt_konfession) as known_religion_population, SUM(T.anzahl_unbekannt_konfession) as unknown_religion_population\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2022\nGROUP BY S.name\nORDER BY (SUM(T.gesamt_anzahl_personen) - SUM(T.anzahl_unbekannt_konfession)) / SUM(T.gesamt_anzahl_personen) DESC\nLIMIT 3;",
    "meta_data": [
      {
        "question": "Wie hat sich die Anzahl der Reformierten in Allschwil, im Kanton Basel-Landschaft, zwischen 2010 und 2015 entwickelt?",
        "query": "SELECT T.jahr, SUM(T.anzahl_evangelisch_reformiert) as number_reformed_evangelics\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Allschwil', 'Allschwil (BL)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2015\nGROUP BY T.jahr;\n"
      },
      {
        "question": "Zeigen Sie mir die Entwicklung der Bev\u00f6lkerung von Pratteln, in Basel-Landschaft, zwischen 2017 und 2019.",
        "query": "SELECT T.jahr, SUM(T.gesamt_anzahl_personen) as population\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Pratteln', 'Pratteln (BL)')\n    AND T.jahr >= 2017\n    AND T.jahr <= 2019\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Welcher Anteil der ausl\u00e4ndischen Bev\u00f6lkerung von Ettingen, BL, hatte 2011 eine unbekannte Konfession?",
        "query": "SELECT SUM(CAST(T.anzahl_unbekannt_konfession AS FLOAT)) / SUM(T.gesamt_anzahl_personen) AS proportion_unknown_religion_ettingen_2011\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Ettingen', 'Ettingen (BL)')\n    AND T.nationalitat = 'Ausland'\n    AND T.jahr = 2011;\n"
      },
      {
        "question": "Welche 5 Gemeinden hatten 2008 den h\u00f6chsten Anteil an Reformierten im Kanton Basel-Landschaft?",
        "query": "SELECT S.name, CAST(SUM(T.anzahl_evangelisch_reformiert) AS FLOAT) / SUM(T.gesamt_anzahl_personen) as proportion_protestants_2008\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2008\nGROUP BY S.name\nORDER BY proportion_protestants_2008 DESC\nLIMIT 5;\n"
      },
      {
        "question": "Wie hoch war der Anteil der Gemeinden im Kanton Basel-Landschaft, in denen es 2018 mehr Katholiken als Protestanten unter der Schweizer Bev\u00f6lkerung gab?",
        "query": "SELECT SUM(\n    CASE WHEN (T1.anzahl_romisch_katholisch + T1.anzahl_christkatholisch) > T1.anzahl_evangelisch_reformiert THEN 1 ELSE 0 END\n) / CAST(COUNT(T1.anzahl_evangelisch_reformiert) AS FLOAT) AS proprtion_municipalities_more_catholics_than_reformed_2018\nFROM (\n    SELECT\n        S.name as municipality,\n        AVG(T.anzahl_christkatholisch) as anzahl_christkatholisch,\n        AVG(T.anzahl_romisch_katholisch) as anzahl_romisch_katholisch,\n        AVG(T.anzahl_evangelisch_reformiert) as anzahl_evangelisch_reformiert\n    FROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2018\n        AND T.nationalitat = 'Schweiz'\n    GROUP BY S.name\n) AS T1;\n"
      },
      {
        "question": "Wie viele Schweizer Einwohner hatte Binningen, BL im Jahr 2005?",
        "query": "SELECT T.jahr, T.anzahl_romisch_katholisch\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Binningen', 'Binningen (BL)')\n    AND T.jahr = 2005\n    AND T.nationalitat = 'Schweiz';\n"
      },
      {
        "question": "Wie hat sich die Anzahl der Reformierten in Allschwil, im Kanton Basel-Landschaft, zwischen 2010 und 2015 entwickelt?",
        "query": "SELECT T.jahr, SUM(T.anzahl_evangelisch_reformiert) as number_reformed_evangelics\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Allschwil', 'Allschwil (BL)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2015\nGROUP BY T.jahr;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tnationalitat TEXT, \n\tanzahl_evangelisch_reformiert NUMERIC, \n\tanzahl_romisch_katholisch NUMERIC, \n\tanzahl_christkatholisch NUMERIC, \n\tanzahl_unbekannt_konfession NUMERIC, \n\tgesamt_anzahl_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_land_bevolkerung_nach_nationalitat_konfession_gemein_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_land_bevolkerung_nach_nationalitat_k_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nanzahl_evangelisch_reformiert : 459, 115, 359, 1326, 88\nanzahl_romisch_katholisch : 2226, 72, 459, 870, 88\nanzahl_christkatholisch : 4, 257, 24, 28, 17\nanzahl_unbekannt_konfession : 2911, 3014, 29, 88, 136\ngesamt_anzahl_personen : 5545, 1380, 2997, 1146, 14137\nspatialunit_uid : 2761_A.ADM3, 2790_A.ADM3, 2858_A.ADM3, 2866_A.ADM3, 2869_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nnationalitat, Nationalit\u00e4t, Schweiz,Ausland\ngesamt_anzahl_personen, Gesamtanzahl Personen, None\n\u200banzahl_evangelisch_reformiert, Anzahl Evangelisch-Reformierten, None\n\u200banzahl_romisch_katholisch, Anzahl der R\u00f6misch-Katholischen, None\nanzahl_christkatholisch, Anzahl der Christkatholischen, None\nanzahl_unbekannt_konfession, Anzahl der Personen mit unbekannter Konfession, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWie hat sich die Anzahl der Reformierten in Allschwil, im Kanton Basel-Landschaft, zwischen 2010 und 2015 entwickelt?\n### SQL query\nSELECT T.jahr, SUM(T.anzahl_evangelisch_reformiert) as number_reformed_evangelics\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Allschwil', 'Allschwil (BL)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2015\nGROUP BY T.jahr;\n\n\n### Question\nZeigen Sie mir die Entwicklung der Bev\u00f6lkerung von Pratteln, in Basel-Landschaft, zwischen 2017 und 2019.\n### SQL query\nSELECT T.jahr, SUM(T.gesamt_anzahl_personen) as population\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Pratteln', 'Pratteln (BL)')\n    AND T.jahr >= 2017\n    AND T.jahr <= 2019\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n\n\n### Question\nWelcher Anteil der ausl\u00e4ndischen Bev\u00f6lkerung von Ettingen, BL, hatte 2011 eine unbekannte Konfession?\n### SQL query\nSELECT SUM(CAST(T.anzahl_unbekannt_konfession AS FLOAT)) / SUM(T.gesamt_anzahl_personen) AS proportion_unknown_religion_ettingen_2011\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Ettingen', 'Ettingen (BL)')\n    AND T.nationalitat = 'Ausland'\n    AND T.jahr = 2011;\n\n\n### Question\nWelche 5 Gemeinden hatten 2008 den h\u00f6chsten Anteil an Reformierten im Kanton Basel-Landschaft?\n### SQL query\nSELECT S.name, CAST(SUM(T.anzahl_evangelisch_reformiert) AS FLOAT) / SUM(T.gesamt_anzahl_personen) as proportion_protestants_2008\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2008\nGROUP BY S.name\nORDER BY proportion_protestants_2008 DESC\nLIMIT 5;\n\n\n### Question\nWie hoch war der Anteil der Gemeinden im Kanton Basel-Landschaft, in denen es 2018 mehr Katholiken als Protestanten unter der Schweizer Bev\u00f6lkerung gab?\n### SQL query\nSELECT SUM(\n    CASE WHEN (T1.anzahl_romisch_katholisch + T1.anzahl_christkatholisch) > T1.anzahl_evangelisch_reformiert THEN 1 ELSE 0 END\n) / CAST(COUNT(T1.anzahl_evangelisch_reformiert) AS FLOAT) AS proprtion_municipalities_more_catholics_than_reformed_2018\nFROM (\n    SELECT\n        S.name as municipality,\n        AVG(T.anzahl_christkatholisch) as anzahl_christkatholisch,\n        AVG(T.anzahl_romisch_katholisch) as anzahl_romisch_katholisch,\n        AVG(T.anzahl_evangelisch_reformiert) as anzahl_evangelisch_reformiert\n    FROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2018\n        AND T.nationalitat = 'Schweiz'\n    GROUP BY S.name\n) AS T1;\n\n\n### Question\nWie viele Schweizer Einwohner hatte Binningen, BL im Jahr 2005?\n### SQL query\nSELECT T.jahr, T.anzahl_romisch_katholisch\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Binningen', 'Binningen (BL)')\n    AND T.jahr = 2005\n    AND T.nationalitat = 'Schweiz';\n\n\n### Question\nWie hat sich die Anzahl der Reformierten in Allschwil, im Kanton Basel-Landschaft, zwischen 2010 und 2015 entwickelt?\n### SQL query\nSELECT T.jahr, SUM(T.anzahl_evangelisch_reformiert) as number_reformed_evangelics\nFROM basel_land_bevolkerung_nach_nationalitat_konfession_gemeinde as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Allschwil', 'Allschwil (BL)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2015\nGROUP BY T.jahr;\n\n\n### Question\nWelches waren im Jahr 2022 die 3 Gemeinden mit dem h\u00f6chsten Ausl\u00e4nderanteil im Kanton Basel-Landschaft?\n### SQL query\n",
    "process_time": 11.592284651007503,
    "num_tokens": 2432,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 73,
    "question": "In welchem Jahr wurde die meiste Wohnfl\u00e4che im Kanton Basel-Landschaft gekauft?",
    "query": "SELECT T.jahr\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nGROUP BY T.jahr\nORDER BY SUM(T.flache_in_m2) DESC\nLIMIT 1;\n",
    "db_id": "basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr",
    "generated_query": "SELECT T.jahr AS kaufjahr, SUM(T.flache_in_m2) AS gesamtflache\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nGROUP BY T.jahr\nORDER BY gesamtflache DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Welche Gemeinden in Basel-Landschaft hatten zwischen 2015 und 2019 einen R\u00fcckgang der Wohnbaulandpreise? Zeigen Sie auch die Preis\u00e4nderungen an.",
        "query": "SELECT T1.name AS gemeinde, T1.preisanderung_chf\nFROM (\n    SELECT\n        S.name,\n        (\n            SUM(CASE WHEN T.jahr = 2019 THEN T.quadratmeterpreis_chf ELSE 0 END) -\n            SUM(CASE WHEN T.jahr = 2015 THEN T.quadratmeterpreis_chf ELSE 0 END)\n        ) AS preisanderung_chf\n    FROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr <= 2015\n        AND T.jahr <= 2019\n    GROUP BY S.name\n) as T1\nWHERE T1.preisanderung_chf < 0\nORDER BY T1.preisanderung_chf ASC ;\n"
      },
      {
        "question": "Welche Gemeinde in Basel-Landschaft hatte 2022 das teuerste Bauland?",
        "query": "SELECT S.name AS gemeinde\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2022\nORDER BY T.quadratmeterpreis_chf DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wie viele Wohnbaul\u00e4nder wurden 2018 in Basel-Landschaft gekauft?",
        "query": "SELECT SUM(T.falle) AS anzahl_wohnbaulander_basel_landschaft_2018\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018;\n"
      },
      {
        "question": "Welche Gemeinden in Basel-Landschaft hatten zwischen 2015 und 2019 einen R\u00fcckgang der Wohnbaulandpreise? Zeigen Sie auch die Preis\u00e4nderungen an.",
        "query": "SELECT T1.name AS gemeinde, T1.preisanderung_chf\nFROM (\n    SELECT\n        S.name,\n        (\n            SUM(CASE WHEN T.jahr = 2019 THEN T.quadratmeterpreis_chf ELSE 0 END) -\n            SUM(CASE WHEN T.jahr = 2015 THEN T.quadratmeterpreis_chf ELSE 0 END)\n        ) AS preisanderung_chf\n    FROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr <= 2015\n        AND T.jahr <= 2019\n    GROUP BY S.name\n) as T1\nWHERE T1.preisanderung_chf < 0\nORDER BY T1.preisanderung_chf ASC ;\n"
      },
      {
        "question": "Wie viele Wohnbaul\u00e4nder wurden 2018 in Basel-Landschaft gekauft?",
        "query": "SELECT SUM(T.falle) AS anzahl_wohnbaulander_basel_landschaft_2018\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018;\n"
      },
      {
        "question": "Wie viele Wohnbaul\u00e4nder wurden 2018 in Basel-Landschaft gekauft?",
        "query": "SELECT SUM(T.falle) AS anzahl_wohnbaulander_basel_landschaft_2018\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tfalle NUMERIC, \n\tflache_in_m2 NUMERIC, \n\tquadratmeterpreis_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_land_quadratmeterpreis_wohnbauland_n_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 1979, 1988, 1989, 1991, 1993\nfalle : 4, 18, 23, 24, 28\nflache_in_m2 : 3300, 1800, 5200, 6900, 14400\nquadratmeterpreis_chf : 252, 684, 870, 335, 229\nspatialunit_uid : 2803_A.ADM3, 2761_A.ADM3, 2802_A.ADM3, 2807_A.ADM3, 2801_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nfalle, F\u00e4lle, 17329\nflache_in_m2, Fl\u00e4che in m2, 12300104004700\nquadratmeterpreis_chf, Quadratmeterpreis in CHF, 213266221\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWelche Gemeinden in Basel-Landschaft hatten zwischen 2015 und 2019 einen R\u00fcckgang der Wohnbaulandpreise? Zeigen Sie auch die Preis\u00e4nderungen an.\n### SQL query\nSELECT T1.name AS gemeinde, T1.preisanderung_chf\nFROM (\n    SELECT\n        S.name,\n        (\n            SUM(CASE WHEN T.jahr = 2019 THEN T.quadratmeterpreis_chf ELSE 0 END) -\n            SUM(CASE WHEN T.jahr = 2015 THEN T.quadratmeterpreis_chf ELSE 0 END)\n        ) AS preisanderung_chf\n    FROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr <= 2015\n        AND T.jahr <= 2019\n    GROUP BY S.name\n) as T1\nWHERE T1.preisanderung_chf < 0\nORDER BY T1.preisanderung_chf ASC ;\n\n\n### Question\nWelche Gemeinde in Basel-Landschaft hatte 2022 das teuerste Bauland?\n### SQL query\nSELECT S.name AS gemeinde\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2022\nORDER BY T.quadratmeterpreis_chf DESC\nLIMIT 1;\n\n\n### Question\nWie viele Wohnbaul\u00e4nder wurden 2018 in Basel-Landschaft gekauft?\n### SQL query\nSELECT SUM(T.falle) AS anzahl_wohnbaulander_basel_landschaft_2018\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018;\n\n\n### Question\nWelche Gemeinden in Basel-Landschaft hatten zwischen 2015 und 2019 einen R\u00fcckgang der Wohnbaulandpreise? Zeigen Sie auch die Preis\u00e4nderungen an.\n### SQL query\nSELECT T1.name AS gemeinde, T1.preisanderung_chf\nFROM (\n    SELECT\n        S.name,\n        (\n            SUM(CASE WHEN T.jahr = 2019 THEN T.quadratmeterpreis_chf ELSE 0 END) -\n            SUM(CASE WHEN T.jahr = 2015 THEN T.quadratmeterpreis_chf ELSE 0 END)\n        ) AS preisanderung_chf\n    FROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr <= 2015\n        AND T.jahr <= 2019\n    GROUP BY S.name\n) as T1\nWHERE T1.preisanderung_chf < 0\nORDER BY T1.preisanderung_chf ASC ;\n\n\n### Question\nWie viele Wohnbaul\u00e4nder wurden 2018 in Basel-Landschaft gekauft?\n### SQL query\nSELECT SUM(T.falle) AS anzahl_wohnbaulander_basel_landschaft_2018\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018;\n\n\n### Question\nWie viele Wohnbaul\u00e4nder wurden 2018 in Basel-Landschaft gekauft?\n### SQL query\nSELECT SUM(T.falle) AS anzahl_wohnbaulander_basel_landschaft_2018\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018;\n\n\n### Question\nIn welchem Jahr wurde die meiste Wohnfl\u00e4che im Kanton Basel-Landschaft gekauft?\n### SQL query\n",
    "process_time": 9.727765124058351,
    "num_tokens": 1993,
    "hardness": "hard",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 74,
    "question": "Zeigen Sie mir den Preis f\u00fcr Wohnbauland in Basel-Landschaft, dessen Name mit A beginnt, im Jahr 2012.",
    "query": "SELECT S.name, T.quadratmeterpreis_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2008\n    AND S.name LIKE 'A%'\nLIMIT 10;\n",
    "db_id": "basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr",
    "generated_query": "SELECT S.name, T.quadratmeterpreis_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2012\n    AND S.name LIKE 'A%';",
    "meta_data": [
      {
        "question": "Welche Gemeinden in Basel-Landschaft hatten zwischen 2015 und 2019 einen R\u00fcckgang der Wohnbaulandpreise? Zeigen Sie auch die Preis\u00e4nderungen an.",
        "query": "SELECT T1.name AS gemeinde, T1.preisanderung_chf\nFROM (\n    SELECT\n        S.name,\n        (\n            SUM(CASE WHEN T.jahr = 2019 THEN T.quadratmeterpreis_chf ELSE 0 END) -\n            SUM(CASE WHEN T.jahr = 2015 THEN T.quadratmeterpreis_chf ELSE 0 END)\n        ) AS preisanderung_chf\n    FROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr <= 2015\n        AND T.jahr <= 2019\n    GROUP BY S.name\n) as T1\nWHERE T1.preisanderung_chf < 0\nORDER BY T1.preisanderung_chf ASC ;\n"
      },
      {
        "question": "In welcher Gemeinde des Kantons Basel-Landschaft ist der Preis f\u00fcr Wohnbauland zwischen 2010 und 2020 am st\u00e4rksten gestiegen, und um wie viel ist er gestiegen?",
        "query": "SELECT\n    S.name AS gemeinde,\n    (\n        SUM(CASE WHEN T.jahr = 2020 THEN T.quadratmeterpreis_chf ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2010 THEN T.quadratmeterpreis_chf ELSE 0 END)\n    ) AS preisanderung_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2010, 2020)\nGROUP BY S.name\nORDER BY preisanderung_chf DESC\nLIMIT 1;\n"
      },
      {
        "question": "In welcher Gemeinde des Kantons Basel-Landschaft ist der Preis f\u00fcr Wohnbauland zwischen 2010 und 2020 am st\u00e4rksten gestiegen, und um wie viel ist er gestiegen?",
        "query": "SELECT\n    S.name AS gemeinde,\n    (\n        SUM(CASE WHEN T.jahr = 2020 THEN T.quadratmeterpreis_chf ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2010 THEN T.quadratmeterpreis_chf ELSE 0 END)\n    ) AS preisanderung_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2010, 2020)\nGROUP BY S.name\nORDER BY preisanderung_chf DESC\nLIMIT 1;\n"
      },
      {
        "question": "Zeigen Sie mir den Preis f\u00fcr Wohnbauland in Muttenz, Birsfelden und Schonenbuch, in Basel-Landschaft im Jahr 1983.",
        "query": "SELECT S.name, T.quadratmeterpreis_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 1983\n    AND S.name IN ('Muttenz', 'Muttens (BL)', 'Bottmingen', 'Bottmingen (BL)', 'Binningen', 'Binningen (BL)');\n"
      },
      {
        "question": "Wie viele Wohnbaul\u00e4nder wurden 2018 in Basel-Landschaft gekauft?",
        "query": "SELECT SUM(T.falle) AS anzahl_wohnbaulander_basel_landschaft_2018\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018;\n"
      },
      {
        "question": "In welcher Gemeinde des Kantons Basel-Landschaft ist der Preis f\u00fcr Wohnbauland zwischen 2010 und 2020 am st\u00e4rksten gestiegen, und um wie viel ist er gestiegen?",
        "query": "SELECT\n    S.name AS gemeinde,\n    (\n        SUM(CASE WHEN T.jahr = 2020 THEN T.quadratmeterpreis_chf ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2010 THEN T.quadratmeterpreis_chf ELSE 0 END)\n    ) AS preisanderung_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2010, 2020)\nGROUP BY S.name\nORDER BY preisanderung_chf DESC\nLIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tfalle NUMERIC, \n\tflache_in_m2 NUMERIC, \n\tquadratmeterpreis_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_land_quadratmeterpreis_wohnbauland_n_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 1979, 1988, 1989, 1991, 1993\nfalle : 4, 18, 23, 24, 28\nflache_in_m2 : 3300, 1800, 5200, 6900, 14400\nquadratmeterpreis_chf : 252, 684, 870, 335, 229\nspatialunit_uid : 2803_A.ADM3, 2761_A.ADM3, 2802_A.ADM3, 2807_A.ADM3, 2801_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nfalle, F\u00e4lle, 17329\nflache_in_m2, Fl\u00e4che in m2, 12300104004700\nquadratmeterpreis_chf, Quadratmeterpreis in CHF, 213266221\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWelche Gemeinden in Basel-Landschaft hatten zwischen 2015 und 2019 einen R\u00fcckgang der Wohnbaulandpreise? Zeigen Sie auch die Preis\u00e4nderungen an.\n### SQL query\nSELECT T1.name AS gemeinde, T1.preisanderung_chf\nFROM (\n    SELECT\n        S.name,\n        (\n            SUM(CASE WHEN T.jahr = 2019 THEN T.quadratmeterpreis_chf ELSE 0 END) -\n            SUM(CASE WHEN T.jahr = 2015 THEN T.quadratmeterpreis_chf ELSE 0 END)\n        ) AS preisanderung_chf\n    FROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr <= 2015\n        AND T.jahr <= 2019\n    GROUP BY S.name\n) as T1\nWHERE T1.preisanderung_chf < 0\nORDER BY T1.preisanderung_chf ASC ;\n\n\n### Question\nIn welcher Gemeinde des Kantons Basel-Landschaft ist der Preis f\u00fcr Wohnbauland zwischen 2010 und 2020 am st\u00e4rksten gestiegen, und um wie viel ist er gestiegen?\n### SQL query\nSELECT\n    S.name AS gemeinde,\n    (\n        SUM(CASE WHEN T.jahr = 2020 THEN T.quadratmeterpreis_chf ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2010 THEN T.quadratmeterpreis_chf ELSE 0 END)\n    ) AS preisanderung_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2010, 2020)\nGROUP BY S.name\nORDER BY preisanderung_chf DESC\nLIMIT 1;\n\n\n### Question\nIn welcher Gemeinde des Kantons Basel-Landschaft ist der Preis f\u00fcr Wohnbauland zwischen 2010 und 2020 am st\u00e4rksten gestiegen, und um wie viel ist er gestiegen?\n### SQL query\nSELECT\n    S.name AS gemeinde,\n    (\n        SUM(CASE WHEN T.jahr = 2020 THEN T.quadratmeterpreis_chf ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2010 THEN T.quadratmeterpreis_chf ELSE 0 END)\n    ) AS preisanderung_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2010, 2020)\nGROUP BY S.name\nORDER BY preisanderung_chf DESC\nLIMIT 1;\n\n\n### Question\nZeigen Sie mir den Preis f\u00fcr Wohnbauland in Muttenz, Birsfelden und Schonenbuch, in Basel-Landschaft im Jahr 1983.\n### SQL query\nSELECT S.name, T.quadratmeterpreis_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 1983\n    AND S.name IN ('Muttenz', 'Muttens (BL)', 'Bottmingen', 'Bottmingen (BL)', 'Binningen', 'Binningen (BL)');\n\n\n### Question\nWie viele Wohnbaul\u00e4nder wurden 2018 in Basel-Landschaft gekauft?\n### SQL query\nSELECT SUM(T.falle) AS anzahl_wohnbaulander_basel_landschaft_2018\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018;\n\n\n### Question\nIn welcher Gemeinde des Kantons Basel-Landschaft ist der Preis f\u00fcr Wohnbauland zwischen 2010 und 2020 am st\u00e4rksten gestiegen, und um wie viel ist er gestiegen?\n### SQL query\nSELECT\n    S.name AS gemeinde,\n    (\n        SUM(CASE WHEN T.jahr = 2020 THEN T.quadratmeterpreis_chf ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2010 THEN T.quadratmeterpreis_chf ELSE 0 END)\n    ) AS preisanderung_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2010, 2020)\nGROUP BY S.name\nORDER BY preisanderung_chf DESC\nLIMIT 1;\n\n\n### Question\nZeigen Sie mir den Preis f\u00fcr Wohnbauland in Basel-Landschaft, dessen Name mit A beginnt, im Jahr 2012.\n### SQL query\n",
    "process_time": 7.862382997991517,
    "num_tokens": 2234,
    "hardness": "extra",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 75,
    "question": "Wie viel kostete ein Quadratmeter Wohnbauland in den f\u00fcnf teuersten Gemeinden von Basel-Landschaft im Jahr 2005?",
    "query": "SELECT S.name AS gemeinde, T.quadratmeterpreis_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2005\nORDER BY T.quadratmeterpreis_chf DESC\nLIMIT 5;\n",
    "db_id": "basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr",
    "generated_query": "SELECT S.name AS gemeinde, T.quadratmeterpreis_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2005\n    AND S.municipal = 'TRUE'\nORDER BY T.quadratmeterpreis_chf DESC\nLIMIT 5;",
    "meta_data": [
      {
        "question": "Zeigen Sie mir den Preis f\u00fcr Wohnbauland in Muttenz, Birsfelden und Schonenbuch, in Basel-Landschaft im Jahr 1983.",
        "query": "SELECT S.name, T.quadratmeterpreis_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 1983\n    AND S.name IN ('Muttenz', 'Muttens (BL)', 'Bottmingen', 'Bottmingen (BL)', 'Binningen', 'Binningen (BL)');\n"
      },
      {
        "question": "Welche Gemeinde in Basel-Landschaft hatte 2022 das teuerste Bauland?",
        "query": "SELECT S.name AS gemeinde\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2022\nORDER BY T.quadratmeterpreis_chf DESC\nLIMIT 1;\n"
      },
      {
        "question": "Zeigen Sie mir den Preis f\u00fcr Wohnbauland in Muttenz, Birsfelden und Schonenbuch, in Basel-Landschaft im Jahr 1983.",
        "query": "SELECT S.name, T.quadratmeterpreis_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 1983\n    AND S.name IN ('Muttenz', 'Muttens (BL)', 'Bottmingen', 'Bottmingen (BL)', 'Binningen', 'Binningen (BL)');\n"
      },
      {
        "question": "Zeigen Sie mir den Preis f\u00fcr Wohnbauland in Muttenz, Birsfelden und Schonenbuch, in Basel-Landschaft im Jahr 1983.",
        "query": "SELECT S.name, T.quadratmeterpreis_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 1983\n    AND S.name IN ('Muttenz', 'Muttens (BL)', 'Bottmingen', 'Bottmingen (BL)', 'Binningen', 'Binningen (BL)');\n"
      },
      {
        "question": "Zeigen Sie mir den Preis f\u00fcr Wohnbauland in Muttenz, Birsfelden und Schonenbuch, in Basel-Landschaft im Jahr 1983.",
        "query": "SELECT S.name, T.quadratmeterpreis_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 1983\n    AND S.name IN ('Muttenz', 'Muttens (BL)', 'Bottmingen', 'Bottmingen (BL)', 'Binningen', 'Binningen (BL)');\n"
      },
      {
        "question": "Welche Gemeinden in Basel-Landschaft hatten zwischen 2015 und 2019 einen R\u00fcckgang der Wohnbaulandpreise? Zeigen Sie auch die Preis\u00e4nderungen an.",
        "query": "SELECT T1.name AS gemeinde, T1.preisanderung_chf\nFROM (\n    SELECT\n        S.name,\n        (\n            SUM(CASE WHEN T.jahr = 2019 THEN T.quadratmeterpreis_chf ELSE 0 END) -\n            SUM(CASE WHEN T.jahr = 2015 THEN T.quadratmeterpreis_chf ELSE 0 END)\n        ) AS preisanderung_chf\n    FROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr <= 2015\n        AND T.jahr <= 2019\n    GROUP BY S.name\n) as T1\nWHERE T1.preisanderung_chf < 0\nORDER BY T1.preisanderung_chf ASC ;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tfalle NUMERIC, \n\tflache_in_m2 NUMERIC, \n\tquadratmeterpreis_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_land_quadratmeterpreis_wohnbauland_n_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 1979, 1988, 1989, 1991, 1993\nfalle : 4, 18, 23, 24, 28\nflache_in_m2 : 3300, 1800, 5200, 6900, 14400\nquadratmeterpreis_chf : 252, 684, 870, 335, 229\nspatialunit_uid : 2803_A.ADM3, 2761_A.ADM3, 2802_A.ADM3, 2807_A.ADM3, 2801_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nfalle, F\u00e4lle, 17329\nflache_in_m2, Fl\u00e4che in m2, 12300104004700\nquadratmeterpreis_chf, Quadratmeterpreis in CHF, 213266221\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nZeigen Sie mir den Preis f\u00fcr Wohnbauland in Muttenz, Birsfelden und Schonenbuch, in Basel-Landschaft im Jahr 1983.\n### SQL query\nSELECT S.name, T.quadratmeterpreis_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 1983\n    AND S.name IN ('Muttenz', 'Muttens (BL)', 'Bottmingen', 'Bottmingen (BL)', 'Binningen', 'Binningen (BL)');\n\n\n### Question\nWelche Gemeinde in Basel-Landschaft hatte 2022 das teuerste Bauland?\n### SQL query\nSELECT S.name AS gemeinde\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2022\nORDER BY T.quadratmeterpreis_chf DESC\nLIMIT 1;\n\n\n### Question\nZeigen Sie mir den Preis f\u00fcr Wohnbauland in Muttenz, Birsfelden und Schonenbuch, in Basel-Landschaft im Jahr 1983.\n### SQL query\nSELECT S.name, T.quadratmeterpreis_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 1983\n    AND S.name IN ('Muttenz', 'Muttens (BL)', 'Bottmingen', 'Bottmingen (BL)', 'Binningen', 'Binningen (BL)');\n\n\n### Question\nZeigen Sie mir den Preis f\u00fcr Wohnbauland in Muttenz, Birsfelden und Schonenbuch, in Basel-Landschaft im Jahr 1983.\n### SQL query\nSELECT S.name, T.quadratmeterpreis_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 1983\n    AND S.name IN ('Muttenz', 'Muttens (BL)', 'Bottmingen', 'Bottmingen (BL)', 'Binningen', 'Binningen (BL)');\n\n\n### Question\nZeigen Sie mir den Preis f\u00fcr Wohnbauland in Muttenz, Birsfelden und Schonenbuch, in Basel-Landschaft im Jahr 1983.\n### SQL query\nSELECT S.name, T.quadratmeterpreis_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 1983\n    AND S.name IN ('Muttenz', 'Muttens (BL)', 'Bottmingen', 'Bottmingen (BL)', 'Binningen', 'Binningen (BL)');\n\n\n### Question\nWelche Gemeinden in Basel-Landschaft hatten zwischen 2015 und 2019 einen R\u00fcckgang der Wohnbaulandpreise? Zeigen Sie auch die Preis\u00e4nderungen an.\n### SQL query\nSELECT T1.name AS gemeinde, T1.preisanderung_chf\nFROM (\n    SELECT\n        S.name,\n        (\n            SUM(CASE WHEN T.jahr = 2019 THEN T.quadratmeterpreis_chf ELSE 0 END) -\n            SUM(CASE WHEN T.jahr = 2015 THEN T.quadratmeterpreis_chf ELSE 0 END)\n        ) AS preisanderung_chf\n    FROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr <= 2015\n        AND T.jahr <= 2019\n    GROUP BY S.name\n) as T1\nWHERE T1.preisanderung_chf < 0\nORDER BY T1.preisanderung_chf ASC ;\n\n\n### Question\nWie viel kostete ein Quadratmeter Wohnbauland in den f\u00fcnf teuersten Gemeinden von Basel-Landschaft im Jahr 2005?\n### SQL query\n",
    "process_time": 6.142717564012855,
    "num_tokens": 2062,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 76,
    "question": "Wie viel Wohnbauland wurde zwischen 2010 und 2012 in Pratteln, BL, gekauft?",
    "query": "SELECT SUM(T.flache_in_m2) as gesamt_flache_in_m2\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Pratteln', 'Pratteln (BL)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2012;\n",
    "db_id": "basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr",
    "generated_query": "SELECT SUM(T.flache_in_m2) AS gesamtflache_in_m2_pratteln_2010_2012\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr >= 2010\n    AND T.jahr <= 2012\n    AND S.name IN ('Pratteln', 'Pratteln (BL)');",
    "meta_data": [
      {
        "question": "Wie viele Wohnbaul\u00e4nder wurden 2018 in Basel-Landschaft gekauft?",
        "query": "SELECT SUM(T.falle) AS anzahl_wohnbaulander_basel_landschaft_2018\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018;\n"
      },
      {
        "question": "Zeigen Sie mir den Preis f\u00fcr Wohnbauland in Muttenz, Birsfelden und Schonenbuch, in Basel-Landschaft im Jahr 1983.",
        "query": "SELECT S.name, T.quadratmeterpreis_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 1983\n    AND S.name IN ('Muttenz', 'Muttens (BL)', 'Bottmingen', 'Bottmingen (BL)', 'Binningen', 'Binningen (BL)');\n"
      },
      {
        "question": "Wie hoch war der Preis f\u00fcr Wohnbauland in Aesch im Jahr 1979 und 2020?",
        "query": "SELECT T.jahr, T.quadratmeterpreis_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Aesch', 'Aesch (BL)')\n    AND T.jahr IN (1980, 2020)\nLIMIT 10;"
      },
      {
        "question": "Welche Gemeinden in Basel-Landschaft hatten zwischen 2015 und 2019 einen R\u00fcckgang der Wohnbaulandpreise? Zeigen Sie auch die Preis\u00e4nderungen an.",
        "query": "SELECT T1.name AS gemeinde, T1.preisanderung_chf\nFROM (\n    SELECT\n        S.name,\n        (\n            SUM(CASE WHEN T.jahr = 2019 THEN T.quadratmeterpreis_chf ELSE 0 END) -\n            SUM(CASE WHEN T.jahr = 2015 THEN T.quadratmeterpreis_chf ELSE 0 END)\n        ) AS preisanderung_chf\n    FROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr <= 2015\n        AND T.jahr <= 2019\n    GROUP BY S.name\n) as T1\nWHERE T1.preisanderung_chf < 0\nORDER BY T1.preisanderung_chf ASC ;\n"
      },
      {
        "question": "Welche Gemeinde in Basel-Landschaft hatte 2022 das teuerste Bauland?",
        "query": "SELECT S.name AS gemeinde\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2022\nORDER BY T.quadratmeterpreis_chf DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wie viele Wohnbaul\u00e4nder wurden 2018 in Basel-Landschaft gekauft?",
        "query": "SELECT SUM(T.falle) AS anzahl_wohnbaulander_basel_landschaft_2018\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tfalle NUMERIC, \n\tflache_in_m2 NUMERIC, \n\tquadratmeterpreis_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_land_quadratmeterpreis_wohnbauland_n_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 1979, 1988, 1989, 1991, 1993\nfalle : 4, 18, 23, 24, 28\nflache_in_m2 : 3300, 1800, 5200, 6900, 14400\nquadratmeterpreis_chf : 252, 684, 870, 335, 229\nspatialunit_uid : 2803_A.ADM3, 2761_A.ADM3, 2802_A.ADM3, 2807_A.ADM3, 2801_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nfalle, F\u00e4lle, 17329\nflache_in_m2, Fl\u00e4che in m2, 12300104004700\nquadratmeterpreis_chf, Quadratmeterpreis in CHF, 213266221\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWie viele Wohnbaul\u00e4nder wurden 2018 in Basel-Landschaft gekauft?\n### SQL query\nSELECT SUM(T.falle) AS anzahl_wohnbaulander_basel_landschaft_2018\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018;\n\n\n### Question\nZeigen Sie mir den Preis f\u00fcr Wohnbauland in Muttenz, Birsfelden und Schonenbuch, in Basel-Landschaft im Jahr 1983.\n### SQL query\nSELECT S.name, T.quadratmeterpreis_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 1983\n    AND S.name IN ('Muttenz', 'Muttens (BL)', 'Bottmingen', 'Bottmingen (BL)', 'Binningen', 'Binningen (BL)');\n\n\n### Question\nWie hoch war der Preis f\u00fcr Wohnbauland in Aesch im Jahr 1979 und 2020?\n### SQL query\nSELECT T.jahr, T.quadratmeterpreis_chf\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Aesch', 'Aesch (BL)')\n    AND T.jahr IN (1980, 2020)\nLIMIT 10;\n\n### Question\nWelche Gemeinden in Basel-Landschaft hatten zwischen 2015 und 2019 einen R\u00fcckgang der Wohnbaulandpreise? Zeigen Sie auch die Preis\u00e4nderungen an.\n### SQL query\nSELECT T1.name AS gemeinde, T1.preisanderung_chf\nFROM (\n    SELECT\n        S.name,\n        (\n            SUM(CASE WHEN T.jahr = 2019 THEN T.quadratmeterpreis_chf ELSE 0 END) -\n            SUM(CASE WHEN T.jahr = 2015 THEN T.quadratmeterpreis_chf ELSE 0 END)\n        ) AS preisanderung_chf\n    FROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr <= 2015\n        AND T.jahr <= 2019\n    GROUP BY S.name\n) as T1\nWHERE T1.preisanderung_chf < 0\nORDER BY T1.preisanderung_chf ASC ;\n\n\n### Question\nWelche Gemeinde in Basel-Landschaft hatte 2022 das teuerste Bauland?\n### SQL query\nSELECT S.name AS gemeinde\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2022\nORDER BY T.quadratmeterpreis_chf DESC\nLIMIT 1;\n\n\n### Question\nWie viele Wohnbaul\u00e4nder wurden 2018 in Basel-Landschaft gekauft?\n### SQL query\nSELECT SUM(T.falle) AS anzahl_wohnbaulander_basel_landschaft_2018\nFROM basel_land_quadratmeterpreis_wohnbauland_nach_gemeinde_und_jahr AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018;\n\n\n### Question\nWie viel Wohnbauland wurde zwischen 2010 und 2012 in Pratteln, BL, gekauft?\n### SQL query\n",
    "process_time": 7.263844198081642,
    "num_tokens": 1918,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 77,
    "question": "Wie viele landwirtschaftliche Fahrzeuge gab es im Kanton Aargau im Jahr 2010?",
    "query": "SELECT anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name = 'Canton Aargau'\n    AND T.jahr = 2010;\n",
    "db_id": "aargau_privatverkehr_bestand_nach_fahrzeugarten",
    "generated_query": "SELECT SUM(anzahl_landwirtschaftliche_motorfahrzeuge) AS anzahl_landwirtschaftliche_fahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten\nWHERE jahr = 2010;",
    "meta_data": [
      {
        "question": "Zeigen Sie mir 3 Aargauer Gemeinden, in denen die Zahl der Personenwagen pro Einwohner zwischen 2018 und 2022 am st\u00e4rksten abgenommen hat.",
        "query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2018, 2022)\nGROUP BY S.name\nORDER BY\n    (\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2018 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END)\n    ) DESC\nLIMIT 3;\n"
      },
      {
        "question": "Wie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?",
        "query": "SELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Wie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?",
        "query": "SELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "In welchem Jahr gab es in Zuzgen, AG, die meisten motorisierten Arbeitsfahrzeuge?",
        "query": "SELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Zuzgen', 'Zuzgen (AG)')\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_arbeitsmotorfahrzeuge) DESC\nLIMIT 1;\n"
      },
      {
        "question": "Gab es 1930 oder 1940 im Kanton Aargau mehr Personenwagen?",
        "query": "SELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr IN (1930, 1940)\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_personenwagen) DESC\nLIMIT 1;\n"
      },
      {
        "question": "In welchem Jahr gab es in Zuzgen, AG, die meisten motorisierten Arbeitsfahrzeuge?",
        "query": "SELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Zuzgen', 'Zuzgen (AG)')\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_arbeitsmotorfahrzeuge) DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wie viele Kleinmotorr\u00e4der gab es im Kanton Aargau zwischen 2000 und 2016?",
        "query": "SELECT T.jahr, T.anzahl_klein_motorrader\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr <= 2016\n    AND T.jahr >= 2000;\n"
      },
      {
        "question": "Wie viele private Fahrzeuge gab es 2010 in Ueken im Kanton Aargau von jedem Typ?",
        "query": "SELECT\n    T.anzahl_anhaenger,\n    T.anzahl_arbeitsmotorfahrzeuge,\n    T.anzahl_klein_motorrader,\n    T.anzahl_kollektivfahrzeuge,\n    T.anzahl_landwirtschaftliche_motorfahrzeuge,\n    T.anzahl_motorfahrrader,\n    T.anzahl_motorrader,\n    T.anzahl_nutzfahrzeuge,\n    T.anzahl_personenwagen,\n    T.anzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2010\n    AND S.municipal = 'TRUE'\n    AND S.name IN ('Ueken', 'Ueken (AG)');\n"
      },
      {
        "question": "Wie viele Aargauer Gemeinden haben im Jahr 2020 keine Personenwagen gez\u00e4hlt?",
        "query": "SELECT COUNT(*) AS anzahl_gemeinden_ohne_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten WHERE jahr = 2020\n    AND anzahl_personenwagen = 0;\n"
      },
      {
        "question": "Welches waren 2015 die Top-3-Gemeinden im Aargau mit dem h\u00f6chsten Anteil an Motorr\u00e4dern gegen\u00fcber Autos? Zeigen Sie auch die Proportionen.",
        "query": "SELECT\n    S.name as gemeinde,\n    CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen AS ratio_motorrader_to_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nORDER BY ratio_motorrader_to_personenwagen DESC\nLIMIT 3;\n"
      },
      {
        "question": "In welchem Jahr gab es in Zuzgen, AG, die meisten motorisierten Arbeitsfahrzeuge?",
        "query": "SELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Zuzgen', 'Zuzgen (AG)')\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_arbeitsmotorfahrzeuge) DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wie viele Anh\u00e4nger gab es im Jahr 2000 in Suhr, Aargau?",
        "query": "SELECT T.anzahl_anhaenger\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Suhr', 'Suhr (AG)')\n    AND T.jahr = 2000;\n"
      },
      {
        "question": "Welches waren die 5 Aargauer Gemeinden mit den wenigsten Motorr\u00e4dern pro Personenwagen im Jahr 2015?",
        "query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2015\n    AND S.municipal = 'TRUE'\nORDER BY CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen ASC\nLIMIT 5;\n"
      },
      {
        "question": "Wie viele Aargauer Gemeinden haben im Jahr 2020 keine Personenwagen gez\u00e4hlt?",
        "query": "SELECT COUNT(*) AS anzahl_gemeinden_ohne_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten WHERE jahr = 2020\n    AND anzahl_personenwagen = 0;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_privatverkehr_bestand_nach_fahrzeugarten (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanzahl_personenwagen NUMERIC, \n\tanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars NUMERIC, \n\tanzahl_nutzfahrzeuge NUMERIC, \n\tanzahl_arbeitsmotorfahrzeuge NUMERIC, \n\tanzahl_motorrader NUMERIC, \n\tanzahl_klein_motorrader NUMERIC, \n\tanzahl_motorfahrrader NUMERIC, \n\tanzahl_landwirtschaftliche_motorfahrzeuge NUMERIC, \n\tanzahl_anhaenger NUMERIC, \n\tanzahl_kollektivfahrzeuge NUMERIC, \n\tanzahl_personenwagen_pro_1000_einwohner NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeugarten_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeug_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_privatverkehr_bestand_nach_fahrzeugarten and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2015, 1989, 2009, 2000, 2012\nanzahl_personenwagen : 127, 481, 2997, 412, 3291\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars : 94, 4, 102, 10, 86\nanzahl_nutzfahrzeuge : 252, 127, 459, 29, 28\nanzahl_arbeitsmotorfahrzeuge : 4, 17, 152, 11, 13\nanzahl_motorrader : 72, 115, 88, 1104, 28\nanzahl_klein_motorrader : 27, 751, 4, 23, 83\nanzahl_motorfahrrader : 72, 291, 29, 28, 348\nanzahl_landwirtschaftliche_motorfahrzeuge : 27, 91, 18, 59, 94\nanzahl_anhaenger : 29, 57, 123, 17, 110\nanzahl_kollektivfahrzeuge : 4, 59, 23, 24, 34\nanzahl_personenwagen_pro_1000_einwohner : 458.19999999999999, 418.50000000000000, 516.20000000000005, 309.10000000000002, 501.69999999999999\n*/\n\n/*\nColumn name, Column discription, Example values\nanzahl_personenwagen_pro_1000_einwohner, Motorisierungsgrad: Anzahl Personenwagen pro 1000 Einwonhner/-innen., 485.5,488.6,485.1\nanzahl_personenwagen, Anzahl Personenwagen, 10556,10618,10582\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars, Anzahl \u00dcbrige Personen Transportfahrzeuge (Kleinbusse, cars), 73,70,76\nanzahl_nutzfahrzeuge, Anzahl Nutzfahrzeuge, 1640,1617,1642\nanzahl_arbeitsmotorfahrzeuge, Anzahl Arbeitsmotorfahrzeuge, 142,152,159\nanzahl_motorrader, Anzahl Motorr\u00e4der, 1234,1225,1157\nanzahl_klein_motorrader, Anzahl kleine Motorr\u00e4der, 25,34,30\nanzahl_motorfahrrader, Anzahl Motorfahrr\u00e4der, 517,498,469\nanzahl_landwirtschaftliche_motorfahrzeuge, Anzahl Landwirtschaftliche Motorfahrzeuge, 46,49,45\nanzahl_anhaenger, Anzahl Anh\u00e4nger, 831,820,845\nanzahl_kollektivfahrzeuge, Anzahl Kollektivfahrzeuge, 53,56,55\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nZeigen Sie mir 3 Aargauer Gemeinden, in denen die Zahl der Personenwagen pro Einwohner zwischen 2018 und 2022 am st\u00e4rksten abgenommen hat.\n### SQL query\nSELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2018, 2022)\nGROUP BY S.name\nORDER BY\n    (\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2018 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END)\n    ) DESC\nLIMIT 3;\n\n\n### Question\nWie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?\n### SQL query\nSELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n\n\n### Question\nWie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?\n### SQL query\nSELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n\n\n### Question\nIn welchem Jahr gab es in Zuzgen, AG, die meisten motorisierten Arbeitsfahrzeuge?\n### SQL query\nSELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Zuzgen', 'Zuzgen (AG)')\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_arbeitsmotorfahrzeuge) DESC\nLIMIT 1;\n\n\n### Question\nGab es 1930 oder 1940 im Kanton Aargau mehr Personenwagen?\n### SQL query\nSELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr IN (1930, 1940)\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_personenwagen) DESC\nLIMIT 1;\n\n\n### Question\nIn welchem Jahr gab es in Zuzgen, AG, die meisten motorisierten Arbeitsfahrzeuge?\n### SQL query\nSELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Zuzgen', 'Zuzgen (AG)')\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_arbeitsmotorfahrzeuge) DESC\nLIMIT 1;\n\n\n### Question\nWie viele Kleinmotorr\u00e4der gab es im Kanton Aargau zwischen 2000 und 2016?\n### SQL query\nSELECT T.jahr, T.anzahl_klein_motorrader\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr <= 2016\n    AND T.jahr >= 2000;\n\n\n### Question\nWie viele private Fahrzeuge gab es 2010 in Ueken im Kanton Aargau von jedem Typ?\n### SQL query\nSELECT\n    T.anzahl_anhaenger,\n    T.anzahl_arbeitsmotorfahrzeuge,\n    T.anzahl_klein_motorrader,\n    T.anzahl_kollektivfahrzeuge,\n    T.anzahl_landwirtschaftliche_motorfahrzeuge,\n    T.anzahl_motorfahrrader,\n    T.anzahl_motorrader,\n    T.anzahl_nutzfahrzeuge,\n    T.anzahl_personenwagen,\n    T.anzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2010\n    AND S.municipal = 'TRUE'\n    AND S.name IN ('Ueken', 'Ueken (AG)');\n\n\n### Question\nWie viele Aargauer Gemeinden haben im Jahr 2020 keine Personenwagen gez\u00e4hlt?\n### SQL query\nSELECT COUNT(*) AS anzahl_gemeinden_ohne_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten WHERE jahr = 2020\n    AND anzahl_personenwagen = 0;\n\n\n### Question\nWelches waren 2015 die Top-3-Gemeinden im Aargau mit dem h\u00f6chsten Anteil an Motorr\u00e4dern gegen\u00fcber Autos? Zeigen Sie auch die Proportionen.\n### SQL query\nSELECT\n    S.name as gemeinde,\n    CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen AS ratio_motorrader_to_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nORDER BY ratio_motorrader_to_personenwagen DESC\nLIMIT 3;\n\n\n### Question\nIn welchem Jahr gab es in Zuzgen, AG, die meisten motorisierten Arbeitsfahrzeuge?\n### SQL query\nSELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Zuzgen', 'Zuzgen (AG)')\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_arbeitsmotorfahrzeuge) DESC\nLIMIT 1;\n\n\n### Question\nWie viele Anh\u00e4nger gab es im Jahr 2000 in Suhr, Aargau?\n### SQL query\nSELECT T.anzahl_anhaenger\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Suhr', 'Suhr (AG)')\n    AND T.jahr = 2000;\n\n\n### Question\nWelches waren die 5 Aargauer Gemeinden mit den wenigsten Motorr\u00e4dern pro Personenwagen im Jahr 2015?\n### SQL query\nSELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2015\n    AND S.municipal = 'TRUE'\nORDER BY CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen ASC\nLIMIT 5;\n\n\n### Question\nWie viele Aargauer Gemeinden haben im Jahr 2020 keine Personenwagen gez\u00e4hlt?\n### SQL query\nSELECT COUNT(*) AS anzahl_gemeinden_ohne_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten WHERE jahr = 2020\n    AND anzahl_personenwagen = 0;\n\n\n### Question\nWie viele landwirtschaftliche Fahrzeuge gab es im Kanton Aargau im Jahr 2010?\n### SQL query\n",
    "process_time": 3.412472842959687,
    "num_tokens": 3500,
    "hardness": "medium",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 78,
    "question": "Wie hat sich der Bestand an Motorr\u00e4dern und Personenwagen im Kanton Aargau im Zeitraum zwischen 1930 und 1960 entwickelt?",
    "query": "SELECT T.jahr, anzahl_motorrader, anzahl_klein_motorrader, anzahl_motorfahrrader, anzahl_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name = 'Canton Aargau'\n    AND T.jahr >= 1930\n    AND T.jahr <= 1960;\n",
    "db_id": "aargau_privatverkehr_bestand_nach_fahrzeugarten",
    "generated_query": "SELECT T.jahr, SUM(T.anzahl_motorrader) AS anzahl_motorrader, SUM(T.anzahl_personenwagen) AS anzahl_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr >= 1930\n    AND T.jahr <= 1960\nGROUP BY T.jahr\nORDER BY T.jahr ASC;",
    "meta_data": [
      {
        "question": "Wie viele Aargauer Gemeinden haben im Jahr 2020 keine Personenwagen gez\u00e4hlt?",
        "query": "SELECT COUNT(*) AS anzahl_gemeinden_ohne_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten WHERE jahr = 2020\n    AND anzahl_personenwagen = 0;\n"
      },
      {
        "question": "Wo im Aargau hatten Zeihen und Zufikon im Jahr 2001 mehr Personenwagen pro Einwohner?",
        "query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2001\n    AND S.name IN ('Zeihen', 'Zeihen (AG)' , 'Zufikon', 'Zufikon (AG)')\nORDER BY T.anzahl_personenwagen_pro_1000_einwohner DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wo im Aargau hatten Zeihen und Zufikon im Jahr 2001 mehr Personenwagen pro Einwohner?",
        "query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2001\n    AND S.name IN ('Zeihen', 'Zeihen (AG)' , 'Zufikon', 'Zufikon (AG)')\nORDER BY T.anzahl_personenwagen_pro_1000_einwohner DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?",
        "query": "SELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Wie viele private Fahrzeuge gab es 2010 in Ueken im Kanton Aargau von jedem Typ?",
        "query": "SELECT\n    T.anzahl_anhaenger,\n    T.anzahl_arbeitsmotorfahrzeuge,\n    T.anzahl_klein_motorrader,\n    T.anzahl_kollektivfahrzeuge,\n    T.anzahl_landwirtschaftliche_motorfahrzeuge,\n    T.anzahl_motorfahrrader,\n    T.anzahl_motorrader,\n    T.anzahl_nutzfahrzeuge,\n    T.anzahl_personenwagen,\n    T.anzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2010\n    AND S.municipal = 'TRUE'\n    AND S.name IN ('Ueken', 'Ueken (AG)');\n"
      },
      {
        "question": "Welches waren die 5 Aargauer Gemeinden mit den wenigsten Motorr\u00e4dern pro Personenwagen im Jahr 2015?",
        "query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2015\n    AND S.municipal = 'TRUE'\nORDER BY CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen ASC\nLIMIT 5;\n"
      },
      {
        "question": "Wie viele Kleinmotorr\u00e4der gab es im Kanton Aargau zwischen 2000 und 2016?",
        "query": "SELECT T.jahr, T.anzahl_klein_motorrader\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr <= 2016\n    AND T.jahr >= 2000;\n"
      },
      {
        "question": "Wie viele Kleinmotorr\u00e4der gab es im Kanton Aargau zwischen 2000 und 2016?",
        "query": "SELECT T.jahr, T.anzahl_klein_motorrader\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr <= 2016\n    AND T.jahr >= 2000;\n"
      },
      {
        "question": "Wie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?",
        "query": "SELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Wie hoch ist der Anteil der Gemeinden im Kanton Aargau, in denen die Zahl der Autos pro Einwohner zwischen 2015 und 2022 zugenommen hat?",
        "query": "SELECT CAST(SUM(CASE WHEN T1.diff > 0 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(T1.diff) AS ratio_gemeinden_mit_zunahme_autos_pro_einwohner\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) as diff\n    FROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2015, 2022)\n    GROUP BY S.name\n) as T1;\n"
      },
      {
        "question": "Wie hoch ist der Anteil der Gemeinden im Kanton Aargau, in denen die Zahl der Autos pro Einwohner zwischen 2015 und 2022 zugenommen hat?",
        "query": "SELECT CAST(SUM(CASE WHEN T1.diff > 0 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(T1.diff) AS ratio_gemeinden_mit_zunahme_autos_pro_einwohner\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) as diff\n    FROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2015, 2022)\n    GROUP BY S.name\n) as T1;\n"
      },
      {
        "question": "Zeigen Sie mir 3 Aargauer Gemeinden, in denen die Zahl der Personenwagen pro Einwohner zwischen 2018 und 2022 am st\u00e4rksten abgenommen hat.",
        "query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2018, 2022)\nGROUP BY S.name\nORDER BY\n    (\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2018 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END)\n    ) DESC\nLIMIT 3;\n"
      },
      {
        "question": "Wie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?",
        "query": "SELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Wie viele Anh\u00e4nger gab es im Jahr 2000 in Suhr, Aargau?",
        "query": "SELECT T.anzahl_anhaenger\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Suhr', 'Suhr (AG)')\n    AND T.jahr = 2000;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_privatverkehr_bestand_nach_fahrzeugarten (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanzahl_personenwagen NUMERIC, \n\tanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars NUMERIC, \n\tanzahl_nutzfahrzeuge NUMERIC, \n\tanzahl_arbeitsmotorfahrzeuge NUMERIC, \n\tanzahl_motorrader NUMERIC, \n\tanzahl_klein_motorrader NUMERIC, \n\tanzahl_motorfahrrader NUMERIC, \n\tanzahl_landwirtschaftliche_motorfahrzeuge NUMERIC, \n\tanzahl_anhaenger NUMERIC, \n\tanzahl_kollektivfahrzeuge NUMERIC, \n\tanzahl_personenwagen_pro_1000_einwohner NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeugarten_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeug_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_privatverkehr_bestand_nach_fahrzeugarten and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2015, 1989, 2009, 2000, 2012\nanzahl_personenwagen : 127, 481, 2997, 412, 3291\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars : 94, 4, 102, 10, 86\nanzahl_nutzfahrzeuge : 252, 127, 459, 29, 28\nanzahl_arbeitsmotorfahrzeuge : 4, 17, 152, 11, 13\nanzahl_motorrader : 72, 115, 88, 1104, 28\nanzahl_klein_motorrader : 27, 751, 4, 23, 83\nanzahl_motorfahrrader : 72, 291, 29, 28, 348\nanzahl_landwirtschaftliche_motorfahrzeuge : 27, 91, 18, 59, 94\nanzahl_anhaenger : 29, 57, 123, 17, 110\nanzahl_kollektivfahrzeuge : 4, 59, 23, 24, 34\nanzahl_personenwagen_pro_1000_einwohner : 458.19999999999999, 418.50000000000000, 516.20000000000005, 309.10000000000002, 501.69999999999999\n*/\n\n/*\nColumn name, Column discription, Example values\nanzahl_personenwagen_pro_1000_einwohner, Motorisierungsgrad: Anzahl Personenwagen pro 1000 Einwonhner/-innen., 485.5,488.6,485.1\nanzahl_personenwagen, Anzahl Personenwagen, 10556,10618,10582\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars, Anzahl \u00dcbrige Personen Transportfahrzeuge (Kleinbusse, cars), 73,70,76\nanzahl_nutzfahrzeuge, Anzahl Nutzfahrzeuge, 1640,1617,1642\nanzahl_arbeitsmotorfahrzeuge, Anzahl Arbeitsmotorfahrzeuge, 142,152,159\nanzahl_motorrader, Anzahl Motorr\u00e4der, 1234,1225,1157\nanzahl_klein_motorrader, Anzahl kleine Motorr\u00e4der, 25,34,30\nanzahl_motorfahrrader, Anzahl Motorfahrr\u00e4der, 517,498,469\nanzahl_landwirtschaftliche_motorfahrzeuge, Anzahl Landwirtschaftliche Motorfahrzeuge, 46,49,45\nanzahl_anhaenger, Anzahl Anh\u00e4nger, 831,820,845\nanzahl_kollektivfahrzeuge, Anzahl Kollektivfahrzeuge, 53,56,55\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWie viele Aargauer Gemeinden haben im Jahr 2020 keine Personenwagen gez\u00e4hlt?\n### SQL query\nSELECT COUNT(*) AS anzahl_gemeinden_ohne_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten WHERE jahr = 2020\n    AND anzahl_personenwagen = 0;\n\n\n### Question\nWo im Aargau hatten Zeihen und Zufikon im Jahr 2001 mehr Personenwagen pro Einwohner?\n### SQL query\nSELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2001\n    AND S.name IN ('Zeihen', 'Zeihen (AG)' , 'Zufikon', 'Zufikon (AG)')\nORDER BY T.anzahl_personenwagen_pro_1000_einwohner DESC\nLIMIT 1;\n\n\n### Question\nWo im Aargau hatten Zeihen und Zufikon im Jahr 2001 mehr Personenwagen pro Einwohner?\n### SQL query\nSELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2001\n    AND S.name IN ('Zeihen', 'Zeihen (AG)' , 'Zufikon', 'Zufikon (AG)')\nORDER BY T.anzahl_personenwagen_pro_1000_einwohner DESC\nLIMIT 1;\n\n\n### Question\nWie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?\n### SQL query\nSELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n\n\n### Question\nWie viele private Fahrzeuge gab es 2010 in Ueken im Kanton Aargau von jedem Typ?\n### SQL query\nSELECT\n    T.anzahl_anhaenger,\n    T.anzahl_arbeitsmotorfahrzeuge,\n    T.anzahl_klein_motorrader,\n    T.anzahl_kollektivfahrzeuge,\n    T.anzahl_landwirtschaftliche_motorfahrzeuge,\n    T.anzahl_motorfahrrader,\n    T.anzahl_motorrader,\n    T.anzahl_nutzfahrzeuge,\n    T.anzahl_personenwagen,\n    T.anzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2010\n    AND S.municipal = 'TRUE'\n    AND S.name IN ('Ueken', 'Ueken (AG)');\n\n\n### Question\nWelches waren die 5 Aargauer Gemeinden mit den wenigsten Motorr\u00e4dern pro Personenwagen im Jahr 2015?\n### SQL query\nSELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2015\n    AND S.municipal = 'TRUE'\nORDER BY CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen ASC\nLIMIT 5;\n\n\n### Question\nWie viele Kleinmotorr\u00e4der gab es im Kanton Aargau zwischen 2000 und 2016?\n### SQL query\nSELECT T.jahr, T.anzahl_klein_motorrader\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr <= 2016\n    AND T.jahr >= 2000;\n\n\n### Question\nWie viele Kleinmotorr\u00e4der gab es im Kanton Aargau zwischen 2000 und 2016?\n### SQL query\nSELECT T.jahr, T.anzahl_klein_motorrader\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr <= 2016\n    AND T.jahr >= 2000;\n\n\n### Question\nWie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?\n### SQL query\nSELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n\n\n### Question\nWie hoch ist der Anteil der Gemeinden im Kanton Aargau, in denen die Zahl der Autos pro Einwohner zwischen 2015 und 2022 zugenommen hat?\n### SQL query\nSELECT CAST(SUM(CASE WHEN T1.diff > 0 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(T1.diff) AS ratio_gemeinden_mit_zunahme_autos_pro_einwohner\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) as diff\n    FROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2015, 2022)\n    GROUP BY S.name\n) as T1;\n\n\n### Question\nWie hoch ist der Anteil der Gemeinden im Kanton Aargau, in denen die Zahl der Autos pro Einwohner zwischen 2015 und 2022 zugenommen hat?\n### SQL query\nSELECT CAST(SUM(CASE WHEN T1.diff > 0 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(T1.diff) AS ratio_gemeinden_mit_zunahme_autos_pro_einwohner\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) as diff\n    FROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2015, 2022)\n    GROUP BY S.name\n) as T1;\n\n\n### Question\nZeigen Sie mir 3 Aargauer Gemeinden, in denen die Zahl der Personenwagen pro Einwohner zwischen 2018 und 2022 am st\u00e4rksten abgenommen hat.\n### SQL query\nSELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2018, 2022)\nGROUP BY S.name\nORDER BY\n    (\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2018 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END)\n    ) DESC\nLIMIT 3;\n\n\n### Question\nWie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?\n### SQL query\nSELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n\n\n### Question\nWie viele Anh\u00e4nger gab es im Jahr 2000 in Suhr, Aargau?\n### SQL query\nSELECT T.anzahl_anhaenger\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Suhr', 'Suhr (AG)')\n    AND T.jahr = 2000;\n\n\n### Question\nWie hat sich der Bestand an Motorr\u00e4dern und Personenwagen im Kanton Aargau im Zeitraum zwischen 1930 und 1960 entwickelt?\n### SQL query\n",
    "process_time": 8.370611630147323,
    "num_tokens": 3806,
    "hardness": "extra",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 79,
    "question": "Welche Gemeinde im Kanton Aargau hatte im Jahr 2020 am meisten Autos pro Einwohner?",
    "query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.anzahl_personenwagen_pro_1000_einwohner DESC\nLIMIT 1;\n",
    "db_id": "aargau_privatverkehr_bestand_nach_fahrzeugarten",
    "generated_query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.anzahl_personenwagen_pro_1000_einwohner DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Wie viele Kleinmotorr\u00e4der gab es im Kanton Aargau zwischen 2000 und 2016?",
        "query": "SELECT T.jahr, T.anzahl_klein_motorrader\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr <= 2016\n    AND T.jahr >= 2000;\n"
      },
      {
        "question": "In welchem Jahr gab es in Zuzgen, AG, die meisten motorisierten Arbeitsfahrzeuge?",
        "query": "SELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Zuzgen', 'Zuzgen (AG)')\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_arbeitsmotorfahrzeuge) DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wie hoch war die Zahl der Wohnwagen von 1998 bis 2001 in Aarburg, AG?",
        "query": "SELECT T.jahr, T.anzahl_anhaenger\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Aarburg', 'Aargbug (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2001;\n"
      },
      {
        "question": "Zeigen Sie mir 3 Aargauer Gemeinden, in denen die Zahl der Personenwagen pro Einwohner zwischen 2018 und 2022 am st\u00e4rksten abgenommen hat.",
        "query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2018, 2022)\nGROUP BY S.name\nORDER BY\n    (\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2018 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END)\n    ) DESC\nLIMIT 3;\n"
      },
      {
        "question": "Wie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?",
        "query": "SELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "In welchem Jahr gab es in Zuzgen, AG, die meisten motorisierten Arbeitsfahrzeuge?",
        "query": "SELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Zuzgen', 'Zuzgen (AG)')\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_arbeitsmotorfahrzeuge) DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wie viele Aargauer Gemeinden haben im Jahr 2020 keine Personenwagen gez\u00e4hlt?",
        "query": "SELECT COUNT(*) AS anzahl_gemeinden_ohne_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten WHERE jahr = 2020\n    AND anzahl_personenwagen = 0;\n"
      },
      {
        "question": "Wie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?",
        "query": "SELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Wie hoch ist der Anteil der Gemeinden im Kanton Aargau, in denen die Zahl der Autos pro Einwohner zwischen 2015 und 2022 zugenommen hat?",
        "query": "SELECT CAST(SUM(CASE WHEN T1.diff > 0 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(T1.diff) AS ratio_gemeinden_mit_zunahme_autos_pro_einwohner\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) as diff\n    FROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2015, 2022)\n    GROUP BY S.name\n) as T1;\n"
      },
      {
        "question": "Wo im Aargau hatten Zeihen und Zufikon im Jahr 2001 mehr Personenwagen pro Einwohner?",
        "query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2001\n    AND S.name IN ('Zeihen', 'Zeihen (AG)' , 'Zufikon', 'Zufikon (AG)')\nORDER BY T.anzahl_personenwagen_pro_1000_einwohner DESC\nLIMIT 1;\n"
      },
      {
        "question": "Welches waren die 5 Aargauer Gemeinden mit den wenigsten Motorr\u00e4dern pro Personenwagen im Jahr 2015?",
        "query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2015\n    AND S.municipal = 'TRUE'\nORDER BY CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen ASC\nLIMIT 5;\n"
      },
      {
        "question": "Wie viele private Fahrzeuge gab es 2010 in Ueken im Kanton Aargau von jedem Typ?",
        "query": "SELECT\n    T.anzahl_anhaenger,\n    T.anzahl_arbeitsmotorfahrzeuge,\n    T.anzahl_klein_motorrader,\n    T.anzahl_kollektivfahrzeuge,\n    T.anzahl_landwirtschaftliche_motorfahrzeuge,\n    T.anzahl_motorfahrrader,\n    T.anzahl_motorrader,\n    T.anzahl_nutzfahrzeuge,\n    T.anzahl_personenwagen,\n    T.anzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2010\n    AND S.municipal = 'TRUE'\n    AND S.name IN ('Ueken', 'Ueken (AG)');\n"
      },
      {
        "question": "Welches waren 2015 die Top-3-Gemeinden im Aargau mit dem h\u00f6chsten Anteil an Motorr\u00e4dern gegen\u00fcber Autos? Zeigen Sie auch die Proportionen.",
        "query": "SELECT\n    S.name as gemeinde,\n    CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen AS ratio_motorrader_to_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nORDER BY ratio_motorrader_to_personenwagen DESC\nLIMIT 3;\n"
      },
      {
        "question": "Gab es 1930 oder 1940 im Kanton Aargau mehr Personenwagen?",
        "query": "SELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr IN (1930, 1940)\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_personenwagen) DESC\nLIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_privatverkehr_bestand_nach_fahrzeugarten (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanzahl_personenwagen NUMERIC, \n\tanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars NUMERIC, \n\tanzahl_nutzfahrzeuge NUMERIC, \n\tanzahl_arbeitsmotorfahrzeuge NUMERIC, \n\tanzahl_motorrader NUMERIC, \n\tanzahl_klein_motorrader NUMERIC, \n\tanzahl_motorfahrrader NUMERIC, \n\tanzahl_landwirtschaftliche_motorfahrzeuge NUMERIC, \n\tanzahl_anhaenger NUMERIC, \n\tanzahl_kollektivfahrzeuge NUMERIC, \n\tanzahl_personenwagen_pro_1000_einwohner NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeugarten_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeug_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_privatverkehr_bestand_nach_fahrzeugarten and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2015, 1989, 2009, 2000, 2012\nanzahl_personenwagen : 127, 481, 2997, 412, 3291\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars : 94, 4, 102, 10, 86\nanzahl_nutzfahrzeuge : 252, 127, 459, 29, 28\nanzahl_arbeitsmotorfahrzeuge : 4, 17, 152, 11, 13\nanzahl_motorrader : 72, 115, 88, 1104, 28\nanzahl_klein_motorrader : 27, 751, 4, 23, 83\nanzahl_motorfahrrader : 72, 291, 29, 28, 348\nanzahl_landwirtschaftliche_motorfahrzeuge : 27, 91, 18, 59, 94\nanzahl_anhaenger : 29, 57, 123, 17, 110\nanzahl_kollektivfahrzeuge : 4, 59, 23, 24, 34\nanzahl_personenwagen_pro_1000_einwohner : 458.19999999999999, 418.50000000000000, 516.20000000000005, 309.10000000000002, 501.69999999999999\n*/\n\n/*\nColumn name, Column discription, Example values\nanzahl_personenwagen_pro_1000_einwohner, Motorisierungsgrad: Anzahl Personenwagen pro 1000 Einwonhner/-innen., 485.5,488.6,485.1\nanzahl_personenwagen, Anzahl Personenwagen, 10556,10618,10582\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars, Anzahl \u00dcbrige Personen Transportfahrzeuge (Kleinbusse, cars), 73,70,76\nanzahl_nutzfahrzeuge, Anzahl Nutzfahrzeuge, 1640,1617,1642\nanzahl_arbeitsmotorfahrzeuge, Anzahl Arbeitsmotorfahrzeuge, 142,152,159\nanzahl_motorrader, Anzahl Motorr\u00e4der, 1234,1225,1157\nanzahl_klein_motorrader, Anzahl kleine Motorr\u00e4der, 25,34,30\nanzahl_motorfahrrader, Anzahl Motorfahrr\u00e4der, 517,498,469\nanzahl_landwirtschaftliche_motorfahrzeuge, Anzahl Landwirtschaftliche Motorfahrzeuge, 46,49,45\nanzahl_anhaenger, Anzahl Anh\u00e4nger, 831,820,845\nanzahl_kollektivfahrzeuge, Anzahl Kollektivfahrzeuge, 53,56,55\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWie viele Kleinmotorr\u00e4der gab es im Kanton Aargau zwischen 2000 und 2016?\n### SQL query\nSELECT T.jahr, T.anzahl_klein_motorrader\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr <= 2016\n    AND T.jahr >= 2000;\n\n\n### Question\nIn welchem Jahr gab es in Zuzgen, AG, die meisten motorisierten Arbeitsfahrzeuge?\n### SQL query\nSELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Zuzgen', 'Zuzgen (AG)')\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_arbeitsmotorfahrzeuge) DESC\nLIMIT 1;\n\n\n### Question\nWie hoch war die Zahl der Wohnwagen von 1998 bis 2001 in Aarburg, AG?\n### SQL query\nSELECT T.jahr, T.anzahl_anhaenger\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Aarburg', 'Aargbug (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2001;\n\n\n### Question\nZeigen Sie mir 3 Aargauer Gemeinden, in denen die Zahl der Personenwagen pro Einwohner zwischen 2018 und 2022 am st\u00e4rksten abgenommen hat.\n### SQL query\nSELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2018, 2022)\nGROUP BY S.name\nORDER BY\n    (\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2018 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END)\n    ) DESC\nLIMIT 3;\n\n\n### Question\nWie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?\n### SQL query\nSELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n\n\n### Question\nIn welchem Jahr gab es in Zuzgen, AG, die meisten motorisierten Arbeitsfahrzeuge?\n### SQL query\nSELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Zuzgen', 'Zuzgen (AG)')\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_arbeitsmotorfahrzeuge) DESC\nLIMIT 1;\n\n\n### Question\nWie viele Aargauer Gemeinden haben im Jahr 2020 keine Personenwagen gez\u00e4hlt?\n### SQL query\nSELECT COUNT(*) AS anzahl_gemeinden_ohne_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten WHERE jahr = 2020\n    AND anzahl_personenwagen = 0;\n\n\n### Question\nWie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?\n### SQL query\nSELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n\n\n### Question\nWie hoch ist der Anteil der Gemeinden im Kanton Aargau, in denen die Zahl der Autos pro Einwohner zwischen 2015 und 2022 zugenommen hat?\n### SQL query\nSELECT CAST(SUM(CASE WHEN T1.diff > 0 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(T1.diff) AS ratio_gemeinden_mit_zunahme_autos_pro_einwohner\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) as diff\n    FROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2015, 2022)\n    GROUP BY S.name\n) as T1;\n\n\n### Question\nWo im Aargau hatten Zeihen und Zufikon im Jahr 2001 mehr Personenwagen pro Einwohner?\n### SQL query\nSELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2001\n    AND S.name IN ('Zeihen', 'Zeihen (AG)' , 'Zufikon', 'Zufikon (AG)')\nORDER BY T.anzahl_personenwagen_pro_1000_einwohner DESC\nLIMIT 1;\n\n\n### Question\nWelches waren die 5 Aargauer Gemeinden mit den wenigsten Motorr\u00e4dern pro Personenwagen im Jahr 2015?\n### SQL query\nSELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2015\n    AND S.municipal = 'TRUE'\nORDER BY CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen ASC\nLIMIT 5;\n\n\n### Question\nWie viele private Fahrzeuge gab es 2010 in Ueken im Kanton Aargau von jedem Typ?\n### SQL query\nSELECT\n    T.anzahl_anhaenger,\n    T.anzahl_arbeitsmotorfahrzeuge,\n    T.anzahl_klein_motorrader,\n    T.anzahl_kollektivfahrzeuge,\n    T.anzahl_landwirtschaftliche_motorfahrzeuge,\n    T.anzahl_motorfahrrader,\n    T.anzahl_motorrader,\n    T.anzahl_nutzfahrzeuge,\n    T.anzahl_personenwagen,\n    T.anzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2010\n    AND S.municipal = 'TRUE'\n    AND S.name IN ('Ueken', 'Ueken (AG)');\n\n\n### Question\nWelches waren 2015 die Top-3-Gemeinden im Aargau mit dem h\u00f6chsten Anteil an Motorr\u00e4dern gegen\u00fcber Autos? Zeigen Sie auch die Proportionen.\n### SQL query\nSELECT\n    S.name as gemeinde,\n    CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen AS ratio_motorrader_to_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nORDER BY ratio_motorrader_to_personenwagen DESC\nLIMIT 3;\n\n\n### Question\nGab es 1930 oder 1940 im Kanton Aargau mehr Personenwagen?\n### SQL query\nSELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr IN (1930, 1940)\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_personenwagen) DESC\nLIMIT 1;\n\n\n### Question\nWelche Gemeinde im Kanton Aargau hatte im Jahr 2020 am meisten Autos pro Einwohner?\n### SQL query\n",
    "process_time": 9.393239401979372,
    "num_tokens": 3715,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 80,
    "question": "Wie hoch war die Zahl der Nutzfahrzeuge 1960 und 1980 im Kanton Aargau?",
    "query": "SELECT T.jahr, anzahl_nutzfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name = 'Canton Aargau'\n    AND T.jahr IN (1960, 1980);\n",
    "db_id": "aargau_privatverkehr_bestand_nach_fahrzeugarten",
    "generated_query": "SELECT T.jahr, SUM(T.anzahl_nutzfahrzeuge) AS anzahl_nutzfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr IN (1960, 1980)\nGROUP BY T.jahr;",
    "meta_data": [
      {
        "question": "Gab es 1930 oder 1940 im Kanton Aargau mehr Personenwagen?",
        "query": "SELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr IN (1930, 1940)\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_personenwagen) DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wo im Aargau hatten Zeihen und Zufikon im Jahr 2001 mehr Personenwagen pro Einwohner?",
        "query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2001\n    AND S.name IN ('Zeihen', 'Zeihen (AG)' , 'Zufikon', 'Zufikon (AG)')\nORDER BY T.anzahl_personenwagen_pro_1000_einwohner DESC\nLIMIT 1;\n"
      },
      {
        "question": "Welches waren 2015 die Top-3-Gemeinden im Aargau mit dem h\u00f6chsten Anteil an Motorr\u00e4dern gegen\u00fcber Autos? Zeigen Sie auch die Proportionen.",
        "query": "SELECT\n    S.name as gemeinde,\n    CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen AS ratio_motorrader_to_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nORDER BY ratio_motorrader_to_personenwagen DESC\nLIMIT 3;\n"
      },
      {
        "question": "Wie hoch war die Zahl der Wohnwagen von 1998 bis 2001 in Aarburg, AG?",
        "query": "SELECT T.jahr, T.anzahl_anhaenger\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Aarburg', 'Aargbug (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2001;\n"
      },
      {
        "question": "Wie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?",
        "query": "SELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Zeigen Sie mir 3 Aargauer Gemeinden, in denen die Zahl der Personenwagen pro Einwohner zwischen 2018 und 2022 am st\u00e4rksten abgenommen hat.",
        "query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2018, 2022)\nGROUP BY S.name\nORDER BY\n    (\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2018 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END)\n    ) DESC\nLIMIT 3;\n"
      },
      {
        "question": "Wie hat sich die Zahl der Autos pro Einwohner im Aargau im Zeitraum 2010 bis 2022 entwickelt?",
        "query": "SELECT T.jahr, T.anzahl_personenwagen_pro_1000_einwohner\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name = 'Canton Aargau'\n    AND T.jahr >= 2010\n    AND T.jahr <= 2022;\n"
      },
      {
        "question": "Wie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?",
        "query": "SELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Welches waren 2015 die Top-3-Gemeinden im Aargau mit dem h\u00f6chsten Anteil an Motorr\u00e4dern gegen\u00fcber Autos? Zeigen Sie auch die Proportionen.",
        "query": "SELECT\n    S.name as gemeinde,\n    CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen AS ratio_motorrader_to_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nORDER BY ratio_motorrader_to_personenwagen DESC\nLIMIT 3;\n"
      },
      {
        "question": "In welchem Jahr gab es in Zuzgen, AG, die meisten motorisierten Arbeitsfahrzeuge?",
        "query": "SELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Zuzgen', 'Zuzgen (AG)')\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_arbeitsmotorfahrzeuge) DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wie hat sich die Zahl der Autos pro Einwohner im Aargau im Zeitraum 2010 bis 2022 entwickelt?",
        "query": "SELECT T.jahr, T.anzahl_personenwagen_pro_1000_einwohner\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name = 'Canton Aargau'\n    AND T.jahr >= 2010\n    AND T.jahr <= 2022;\n"
      },
      {
        "question": "Wie hat sich die Zahl der Autos pro Einwohner im Aargau im Zeitraum 2010 bis 2022 entwickelt?",
        "query": "SELECT T.jahr, T.anzahl_personenwagen_pro_1000_einwohner\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name = 'Canton Aargau'\n    AND T.jahr >= 2010\n    AND T.jahr <= 2022;\n"
      },
      {
        "question": "Wie hoch ist der Anteil der Gemeinden im Kanton Aargau, in denen die Zahl der Autos pro Einwohner zwischen 2015 und 2022 zugenommen hat?",
        "query": "SELECT CAST(SUM(CASE WHEN T1.diff > 0 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(T1.diff) AS ratio_gemeinden_mit_zunahme_autos_pro_einwohner\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) as diff\n    FROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2015, 2022)\n    GROUP BY S.name\n) as T1;\n"
      },
      {
        "question": "Wo im Aargau hatten Zeihen und Zufikon im Jahr 2001 mehr Personenwagen pro Einwohner?",
        "query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2001\n    AND S.name IN ('Zeihen', 'Zeihen (AG)' , 'Zufikon', 'Zufikon (AG)')\nORDER BY T.anzahl_personenwagen_pro_1000_einwohner DESC\nLIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_privatverkehr_bestand_nach_fahrzeugarten (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanzahl_personenwagen NUMERIC, \n\tanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars NUMERIC, \n\tanzahl_nutzfahrzeuge NUMERIC, \n\tanzahl_arbeitsmotorfahrzeuge NUMERIC, \n\tanzahl_motorrader NUMERIC, \n\tanzahl_klein_motorrader NUMERIC, \n\tanzahl_motorfahrrader NUMERIC, \n\tanzahl_landwirtschaftliche_motorfahrzeuge NUMERIC, \n\tanzahl_anhaenger NUMERIC, \n\tanzahl_kollektivfahrzeuge NUMERIC, \n\tanzahl_personenwagen_pro_1000_einwohner NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeugarten_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeug_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_privatverkehr_bestand_nach_fahrzeugarten and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2015, 1989, 2009, 2000, 2012\nanzahl_personenwagen : 127, 481, 2997, 412, 3291\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars : 94, 4, 102, 10, 86\nanzahl_nutzfahrzeuge : 252, 127, 459, 29, 28\nanzahl_arbeitsmotorfahrzeuge : 4, 17, 152, 11, 13\nanzahl_motorrader : 72, 115, 88, 1104, 28\nanzahl_klein_motorrader : 27, 751, 4, 23, 83\nanzahl_motorfahrrader : 72, 291, 29, 28, 348\nanzahl_landwirtschaftliche_motorfahrzeuge : 27, 91, 18, 59, 94\nanzahl_anhaenger : 29, 57, 123, 17, 110\nanzahl_kollektivfahrzeuge : 4, 59, 23, 24, 34\nanzahl_personenwagen_pro_1000_einwohner : 458.19999999999999, 418.50000000000000, 516.20000000000005, 309.10000000000002, 501.69999999999999\n*/\n\n/*\nColumn name, Column discription, Example values\nanzahl_personenwagen_pro_1000_einwohner, Motorisierungsgrad: Anzahl Personenwagen pro 1000 Einwonhner/-innen., 485.5,488.6,485.1\nanzahl_personenwagen, Anzahl Personenwagen, 10556,10618,10582\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars, Anzahl \u00dcbrige Personen Transportfahrzeuge (Kleinbusse, cars), 73,70,76\nanzahl_nutzfahrzeuge, Anzahl Nutzfahrzeuge, 1640,1617,1642\nanzahl_arbeitsmotorfahrzeuge, Anzahl Arbeitsmotorfahrzeuge, 142,152,159\nanzahl_motorrader, Anzahl Motorr\u00e4der, 1234,1225,1157\nanzahl_klein_motorrader, Anzahl kleine Motorr\u00e4der, 25,34,30\nanzahl_motorfahrrader, Anzahl Motorfahrr\u00e4der, 517,498,469\nanzahl_landwirtschaftliche_motorfahrzeuge, Anzahl Landwirtschaftliche Motorfahrzeuge, 46,49,45\nanzahl_anhaenger, Anzahl Anh\u00e4nger, 831,820,845\nanzahl_kollektivfahrzeuge, Anzahl Kollektivfahrzeuge, 53,56,55\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nGab es 1930 oder 1940 im Kanton Aargau mehr Personenwagen?\n### SQL query\nSELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr IN (1930, 1940)\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_personenwagen) DESC\nLIMIT 1;\n\n\n### Question\nWo im Aargau hatten Zeihen und Zufikon im Jahr 2001 mehr Personenwagen pro Einwohner?\n### SQL query\nSELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2001\n    AND S.name IN ('Zeihen', 'Zeihen (AG)' , 'Zufikon', 'Zufikon (AG)')\nORDER BY T.anzahl_personenwagen_pro_1000_einwohner DESC\nLIMIT 1;\n\n\n### Question\nWelches waren 2015 die Top-3-Gemeinden im Aargau mit dem h\u00f6chsten Anteil an Motorr\u00e4dern gegen\u00fcber Autos? Zeigen Sie auch die Proportionen.\n### SQL query\nSELECT\n    S.name as gemeinde,\n    CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen AS ratio_motorrader_to_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nORDER BY ratio_motorrader_to_personenwagen DESC\nLIMIT 3;\n\n\n### Question\nWie hoch war die Zahl der Wohnwagen von 1998 bis 2001 in Aarburg, AG?\n### SQL query\nSELECT T.jahr, T.anzahl_anhaenger\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Aarburg', 'Aargbug (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2001;\n\n\n### Question\nWie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?\n### SQL query\nSELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n\n\n### Question\nZeigen Sie mir 3 Aargauer Gemeinden, in denen die Zahl der Personenwagen pro Einwohner zwischen 2018 und 2022 am st\u00e4rksten abgenommen hat.\n### SQL query\nSELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2018, 2022)\nGROUP BY S.name\nORDER BY\n    (\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2018 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END)\n    ) DESC\nLIMIT 3;\n\n\n### Question\nWie hat sich die Zahl der Autos pro Einwohner im Aargau im Zeitraum 2010 bis 2022 entwickelt?\n### SQL query\nSELECT T.jahr, T.anzahl_personenwagen_pro_1000_einwohner\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name = 'Canton Aargau'\n    AND T.jahr >= 2010\n    AND T.jahr <= 2022;\n\n\n### Question\nWie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?\n### SQL query\nSELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n\n\n### Question\nWelches waren 2015 die Top-3-Gemeinden im Aargau mit dem h\u00f6chsten Anteil an Motorr\u00e4dern gegen\u00fcber Autos? Zeigen Sie auch die Proportionen.\n### SQL query\nSELECT\n    S.name as gemeinde,\n    CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen AS ratio_motorrader_to_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nORDER BY ratio_motorrader_to_personenwagen DESC\nLIMIT 3;\n\n\n### Question\nIn welchem Jahr gab es in Zuzgen, AG, die meisten motorisierten Arbeitsfahrzeuge?\n### SQL query\nSELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Zuzgen', 'Zuzgen (AG)')\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_arbeitsmotorfahrzeuge) DESC\nLIMIT 1;\n\n\n### Question\nWie hat sich die Zahl der Autos pro Einwohner im Aargau im Zeitraum 2010 bis 2022 entwickelt?\n### SQL query\nSELECT T.jahr, T.anzahl_personenwagen_pro_1000_einwohner\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name = 'Canton Aargau'\n    AND T.jahr >= 2010\n    AND T.jahr <= 2022;\n\n\n### Question\nWie hat sich die Zahl der Autos pro Einwohner im Aargau im Zeitraum 2010 bis 2022 entwickelt?\n### SQL query\nSELECT T.jahr, T.anzahl_personenwagen_pro_1000_einwohner\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name = 'Canton Aargau'\n    AND T.jahr >= 2010\n    AND T.jahr <= 2022;\n\n\n### Question\nWie hoch ist der Anteil der Gemeinden im Kanton Aargau, in denen die Zahl der Autos pro Einwohner zwischen 2015 und 2022 zugenommen hat?\n### SQL query\nSELECT CAST(SUM(CASE WHEN T1.diff > 0 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(T1.diff) AS ratio_gemeinden_mit_zunahme_autos_pro_einwohner\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) as diff\n    FROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2015, 2022)\n    GROUP BY S.name\n) as T1;\n\n\n### Question\nWo im Aargau hatten Zeihen und Zufikon im Jahr 2001 mehr Personenwagen pro Einwohner?\n### SQL query\nSELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2001\n    AND S.name IN ('Zeihen', 'Zeihen (AG)' , 'Zufikon', 'Zufikon (AG)')\nORDER BY T.anzahl_personenwagen_pro_1000_einwohner DESC\nLIMIT 1;\n\n\n### Question\nWie hoch war die Zahl der Nutzfahrzeuge 1960 und 1980 im Kanton Aargau?\n### SQL query\n",
    "process_time": 11.271114735864103,
    "num_tokens": 3773,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 81,
    "question": "Wie hoch war die Zahl der Nutzfahrzeuge in Abtwil, AG im Jahr 2000 ?",
    "query": "SELECT T.anzahl_nutzfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Abtwil', 'Abtwil (AG)')\n    AND T.jahr = 2000;\n",
    "db_id": "aargau_privatverkehr_bestand_nach_fahrzeugarten",
    "generated_query": "SELECT T.anzahl_nutzfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Abtwil', 'Abtwil (AG)')\n    AND T.jahr = 2000;",
    "meta_data": [
      {
        "question": "Wie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?",
        "query": "SELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Wie viele Aargauer Gemeinden haben im Jahr 2020 keine Personenwagen gez\u00e4hlt?",
        "query": "SELECT COUNT(*) AS anzahl_gemeinden_ohne_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten WHERE jahr = 2020\n    AND anzahl_personenwagen = 0;\n"
      },
      {
        "question": "Welches waren 2015 die Top-3-Gemeinden im Aargau mit dem h\u00f6chsten Anteil an Motorr\u00e4dern gegen\u00fcber Autos? Zeigen Sie auch die Proportionen.",
        "query": "SELECT\n    S.name as gemeinde,\n    CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen AS ratio_motorrader_to_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nORDER BY ratio_motorrader_to_personenwagen DESC\nLIMIT 3;\n"
      },
      {
        "question": "In welchem Jahr gab es in Zuzgen, AG, die meisten motorisierten Arbeitsfahrzeuge?",
        "query": "SELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Zuzgen', 'Zuzgen (AG)')\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_arbeitsmotorfahrzeuge) DESC\nLIMIT 1;\n"
      },
      {
        "question": "Welches waren die 5 Aargauer Gemeinden mit den wenigsten Motorr\u00e4dern pro Personenwagen im Jahr 2015?",
        "query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2015\n    AND S.municipal = 'TRUE'\nORDER BY CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen ASC\nLIMIT 5;\n"
      },
      {
        "question": "Zeigen Sie mir 3 Aargauer Gemeinden, in denen die Zahl der Personenwagen pro Einwohner zwischen 2018 und 2022 am st\u00e4rksten abgenommen hat.",
        "query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2018, 2022)\nGROUP BY S.name\nORDER BY\n    (\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2018 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END)\n    ) DESC\nLIMIT 3;\n"
      },
      {
        "question": "Zeigen Sie mir 3 Aargauer Gemeinden, in denen die Zahl der Personenwagen pro Einwohner zwischen 2018 und 2022 am st\u00e4rksten abgenommen hat.",
        "query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2018, 2022)\nGROUP BY S.name\nORDER BY\n    (\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2018 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END)\n    ) DESC\nLIMIT 3;\n"
      },
      {
        "question": "Wie viele private Fahrzeuge gab es 2010 in Ueken im Kanton Aargau von jedem Typ?",
        "query": "SELECT\n    T.anzahl_anhaenger,\n    T.anzahl_arbeitsmotorfahrzeuge,\n    T.anzahl_klein_motorrader,\n    T.anzahl_kollektivfahrzeuge,\n    T.anzahl_landwirtschaftliche_motorfahrzeuge,\n    T.anzahl_motorfahrrader,\n    T.anzahl_motorrader,\n    T.anzahl_nutzfahrzeuge,\n    T.anzahl_personenwagen,\n    T.anzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2010\n    AND S.municipal = 'TRUE'\n    AND S.name IN ('Ueken', 'Ueken (AG)');\n"
      },
      {
        "question": "Wie hat sich die Zahl der Autos pro Einwohner im Aargau im Zeitraum 2010 bis 2022 entwickelt?",
        "query": "SELECT T.jahr, T.anzahl_personenwagen_pro_1000_einwohner\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name = 'Canton Aargau'\n    AND T.jahr >= 2010\n    AND T.jahr <= 2022;\n"
      },
      {
        "question": "Wo im Aargau hatten Zeihen und Zufikon im Jahr 2001 mehr Personenwagen pro Einwohner?",
        "query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2001\n    AND S.name IN ('Zeihen', 'Zeihen (AG)' , 'Zufikon', 'Zufikon (AG)')\nORDER BY T.anzahl_personenwagen_pro_1000_einwohner DESC\nLIMIT 1;\n"
      },
      {
        "question": "Welches waren 2015 die Top-3-Gemeinden im Aargau mit dem h\u00f6chsten Anteil an Motorr\u00e4dern gegen\u00fcber Autos? Zeigen Sie auch die Proportionen.",
        "query": "SELECT\n    S.name as gemeinde,\n    CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen AS ratio_motorrader_to_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nORDER BY ratio_motorrader_to_personenwagen DESC\nLIMIT 3;\n"
      },
      {
        "question": "Wie viele private Fahrzeuge gab es 2010 in Ueken im Kanton Aargau von jedem Typ?",
        "query": "SELECT\n    T.anzahl_anhaenger,\n    T.anzahl_arbeitsmotorfahrzeuge,\n    T.anzahl_klein_motorrader,\n    T.anzahl_kollektivfahrzeuge,\n    T.anzahl_landwirtschaftliche_motorfahrzeuge,\n    T.anzahl_motorfahrrader,\n    T.anzahl_motorrader,\n    T.anzahl_nutzfahrzeuge,\n    T.anzahl_personenwagen,\n    T.anzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2010\n    AND S.municipal = 'TRUE'\n    AND S.name IN ('Ueken', 'Ueken (AG)');\n"
      },
      {
        "question": "In welchem Jahr gab es in Zuzgen, AG, die meisten motorisierten Arbeitsfahrzeuge?",
        "query": "SELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Zuzgen', 'Zuzgen (AG)')\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_arbeitsmotorfahrzeuge) DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wie hat sich die Zahl der Autos pro Einwohner im Aargau im Zeitraum 2010 bis 2022 entwickelt?",
        "query": "SELECT T.jahr, T.anzahl_personenwagen_pro_1000_einwohner\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name = 'Canton Aargau'\n    AND T.jahr >= 2010\n    AND T.jahr <= 2022;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_privatverkehr_bestand_nach_fahrzeugarten (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanzahl_personenwagen NUMERIC, \n\tanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars NUMERIC, \n\tanzahl_nutzfahrzeuge NUMERIC, \n\tanzahl_arbeitsmotorfahrzeuge NUMERIC, \n\tanzahl_motorrader NUMERIC, \n\tanzahl_klein_motorrader NUMERIC, \n\tanzahl_motorfahrrader NUMERIC, \n\tanzahl_landwirtschaftliche_motorfahrzeuge NUMERIC, \n\tanzahl_anhaenger NUMERIC, \n\tanzahl_kollektivfahrzeuge NUMERIC, \n\tanzahl_personenwagen_pro_1000_einwohner NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeugarten_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeug_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_privatverkehr_bestand_nach_fahrzeugarten and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2015, 1989, 2009, 2000, 2012\nanzahl_personenwagen : 127, 481, 2997, 412, 3291\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars : 94, 4, 102, 10, 86\nanzahl_nutzfahrzeuge : 252, 127, 459, 29, 28\nanzahl_arbeitsmotorfahrzeuge : 4, 17, 152, 11, 13\nanzahl_motorrader : 72, 115, 88, 1104, 28\nanzahl_klein_motorrader : 27, 751, 4, 23, 83\nanzahl_motorfahrrader : 72, 291, 29, 28, 348\nanzahl_landwirtschaftliche_motorfahrzeuge : 27, 91, 18, 59, 94\nanzahl_anhaenger : 29, 57, 123, 17, 110\nanzahl_kollektivfahrzeuge : 4, 59, 23, 24, 34\nanzahl_personenwagen_pro_1000_einwohner : 458.19999999999999, 418.50000000000000, 516.20000000000005, 309.10000000000002, 501.69999999999999\n*/\n\n/*\nColumn name, Column discription, Example values\nanzahl_personenwagen_pro_1000_einwohner, Motorisierungsgrad: Anzahl Personenwagen pro 1000 Einwonhner/-innen., 485.5,488.6,485.1\nanzahl_personenwagen, Anzahl Personenwagen, 10556,10618,10582\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars, Anzahl \u00dcbrige Personen Transportfahrzeuge (Kleinbusse, cars), 73,70,76\nanzahl_nutzfahrzeuge, Anzahl Nutzfahrzeuge, 1640,1617,1642\nanzahl_arbeitsmotorfahrzeuge, Anzahl Arbeitsmotorfahrzeuge, 142,152,159\nanzahl_motorrader, Anzahl Motorr\u00e4der, 1234,1225,1157\nanzahl_klein_motorrader, Anzahl kleine Motorr\u00e4der, 25,34,30\nanzahl_motorfahrrader, Anzahl Motorfahrr\u00e4der, 517,498,469\nanzahl_landwirtschaftliche_motorfahrzeuge, Anzahl Landwirtschaftliche Motorfahrzeuge, 46,49,45\nanzahl_anhaenger, Anzahl Anh\u00e4nger, 831,820,845\nanzahl_kollektivfahrzeuge, Anzahl Kollektivfahrzeuge, 53,56,55\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?\n### SQL query\nSELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n\n\n### Question\nWie viele Aargauer Gemeinden haben im Jahr 2020 keine Personenwagen gez\u00e4hlt?\n### SQL query\nSELECT COUNT(*) AS anzahl_gemeinden_ohne_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten WHERE jahr = 2020\n    AND anzahl_personenwagen = 0;\n\n\n### Question\nWelches waren 2015 die Top-3-Gemeinden im Aargau mit dem h\u00f6chsten Anteil an Motorr\u00e4dern gegen\u00fcber Autos? Zeigen Sie auch die Proportionen.\n### SQL query\nSELECT\n    S.name as gemeinde,\n    CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen AS ratio_motorrader_to_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nORDER BY ratio_motorrader_to_personenwagen DESC\nLIMIT 3;\n\n\n### Question\nIn welchem Jahr gab es in Zuzgen, AG, die meisten motorisierten Arbeitsfahrzeuge?\n### SQL query\nSELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Zuzgen', 'Zuzgen (AG)')\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_arbeitsmotorfahrzeuge) DESC\nLIMIT 1;\n\n\n### Question\nWelches waren die 5 Aargauer Gemeinden mit den wenigsten Motorr\u00e4dern pro Personenwagen im Jahr 2015?\n### SQL query\nSELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2015\n    AND S.municipal = 'TRUE'\nORDER BY CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen ASC\nLIMIT 5;\n\n\n### Question\nZeigen Sie mir 3 Aargauer Gemeinden, in denen die Zahl der Personenwagen pro Einwohner zwischen 2018 und 2022 am st\u00e4rksten abgenommen hat.\n### SQL query\nSELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2018, 2022)\nGROUP BY S.name\nORDER BY\n    (\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2018 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END)\n    ) DESC\nLIMIT 3;\n\n\n### Question\nZeigen Sie mir 3 Aargauer Gemeinden, in denen die Zahl der Personenwagen pro Einwohner zwischen 2018 und 2022 am st\u00e4rksten abgenommen hat.\n### SQL query\nSELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2018, 2022)\nGROUP BY S.name\nORDER BY\n    (\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2018 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END)\n    ) DESC\nLIMIT 3;\n\n\n### Question\nWie viele private Fahrzeuge gab es 2010 in Ueken im Kanton Aargau von jedem Typ?\n### SQL query\nSELECT\n    T.anzahl_anhaenger,\n    T.anzahl_arbeitsmotorfahrzeuge,\n    T.anzahl_klein_motorrader,\n    T.anzahl_kollektivfahrzeuge,\n    T.anzahl_landwirtschaftliche_motorfahrzeuge,\n    T.anzahl_motorfahrrader,\n    T.anzahl_motorrader,\n    T.anzahl_nutzfahrzeuge,\n    T.anzahl_personenwagen,\n    T.anzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2010\n    AND S.municipal = 'TRUE'\n    AND S.name IN ('Ueken', 'Ueken (AG)');\n\n\n### Question\nWie hat sich die Zahl der Autos pro Einwohner im Aargau im Zeitraum 2010 bis 2022 entwickelt?\n### SQL query\nSELECT T.jahr, T.anzahl_personenwagen_pro_1000_einwohner\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name = 'Canton Aargau'\n    AND T.jahr >= 2010\n    AND T.jahr <= 2022;\n\n\n### Question\nWo im Aargau hatten Zeihen und Zufikon im Jahr 2001 mehr Personenwagen pro Einwohner?\n### SQL query\nSELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2001\n    AND S.name IN ('Zeihen', 'Zeihen (AG)' , 'Zufikon', 'Zufikon (AG)')\nORDER BY T.anzahl_personenwagen_pro_1000_einwohner DESC\nLIMIT 1;\n\n\n### Question\nWelches waren 2015 die Top-3-Gemeinden im Aargau mit dem h\u00f6chsten Anteil an Motorr\u00e4dern gegen\u00fcber Autos? Zeigen Sie auch die Proportionen.\n### SQL query\nSELECT\n    S.name as gemeinde,\n    CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen AS ratio_motorrader_to_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nORDER BY ratio_motorrader_to_personenwagen DESC\nLIMIT 3;\n\n\n### Question\nWie viele private Fahrzeuge gab es 2010 in Ueken im Kanton Aargau von jedem Typ?\n### SQL query\nSELECT\n    T.anzahl_anhaenger,\n    T.anzahl_arbeitsmotorfahrzeuge,\n    T.anzahl_klein_motorrader,\n    T.anzahl_kollektivfahrzeuge,\n    T.anzahl_landwirtschaftliche_motorfahrzeuge,\n    T.anzahl_motorfahrrader,\n    T.anzahl_motorrader,\n    T.anzahl_nutzfahrzeuge,\n    T.anzahl_personenwagen,\n    T.anzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2010\n    AND S.municipal = 'TRUE'\n    AND S.name IN ('Ueken', 'Ueken (AG)');\n\n\n### Question\nIn welchem Jahr gab es in Zuzgen, AG, die meisten motorisierten Arbeitsfahrzeuge?\n### SQL query\nSELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Zuzgen', 'Zuzgen (AG)')\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_arbeitsmotorfahrzeuge) DESC\nLIMIT 1;\n\n\n### Question\nWie hat sich die Zahl der Autos pro Einwohner im Aargau im Zeitraum 2010 bis 2022 entwickelt?\n### SQL query\nSELECT T.jahr, T.anzahl_personenwagen_pro_1000_einwohner\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name = 'Canton Aargau'\n    AND T.jahr >= 2010\n    AND T.jahr <= 2022;\n\n\n### Question\nWie hoch war die Zahl der Nutzfahrzeuge in Abtwil, AG im Jahr 2000 ?\n### SQL query\n",
    "process_time": 5.979673594003543,
    "num_tokens": 3858,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 82,
    "question": "Wie viele Kollektivfahrzeuge gab es 2022 in Wettingen, AG?",
    "query": "SELECT T.anzahl_kollektivfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Wettingen', 'Wettingen (AG)')\n    AND T.jahr = 2022;\n",
    "db_id": "aargau_privatverkehr_bestand_nach_fahrzeugarten",
    "generated_query": "SELECT T.anzahl_kollektivfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Wettingen', 'Wettingen (AG)')\n    AND T.jahr = 2022;",
    "meta_data": [
      {
        "question": "Zeigen Sie mir 3 Aargauer Gemeinden, in denen die Zahl der Personenwagen pro Einwohner zwischen 2018 und 2022 am st\u00e4rksten abgenommen hat.",
        "query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2018, 2022)\nGROUP BY S.name\nORDER BY\n    (\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2018 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END)\n    ) DESC\nLIMIT 3;\n"
      },
      {
        "question": "Zeigen Sie mir 3 Aargauer Gemeinden, in denen die Zahl der Personenwagen pro Einwohner zwischen 2018 und 2022 am st\u00e4rksten abgenommen hat.",
        "query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2018, 2022)\nGROUP BY S.name\nORDER BY\n    (\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2018 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END)\n    ) DESC\nLIMIT 3;\n"
      },
      {
        "question": "Wie viele Anh\u00e4nger gab es im Jahr 2000 in Suhr, Aargau?",
        "query": "SELECT T.anzahl_anhaenger\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Suhr', 'Suhr (AG)')\n    AND T.jahr = 2000;\n"
      },
      {
        "question": "Welches waren die 5 Aargauer Gemeinden mit den wenigsten Motorr\u00e4dern pro Personenwagen im Jahr 2015?",
        "query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2015\n    AND S.municipal = 'TRUE'\nORDER BY CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen ASC\nLIMIT 5;\n"
      },
      {
        "question": "Wie viele Anh\u00e4nger gab es im Jahr 2000 in Suhr, Aargau?",
        "query": "SELECT T.anzahl_anhaenger\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Suhr', 'Suhr (AG)')\n    AND T.jahr = 2000;\n"
      },
      {
        "question": "Wie viele Aargauer Gemeinden haben im Jahr 2020 keine Personenwagen gez\u00e4hlt?",
        "query": "SELECT COUNT(*) AS anzahl_gemeinden_ohne_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten WHERE jahr = 2020\n    AND anzahl_personenwagen = 0;\n"
      },
      {
        "question": "Wie hat sich die Zahl der Autos pro Einwohner im Aargau im Zeitraum 2010 bis 2022 entwickelt?",
        "query": "SELECT T.jahr, T.anzahl_personenwagen_pro_1000_einwohner\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name = 'Canton Aargau'\n    AND T.jahr >= 2010\n    AND T.jahr <= 2022;\n"
      },
      {
        "question": "Gab es 1930 oder 1940 im Kanton Aargau mehr Personenwagen?",
        "query": "SELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr IN (1930, 1940)\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_personenwagen) DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wie viele Aargauer Gemeinden haben im Jahr 2020 keine Personenwagen gez\u00e4hlt?",
        "query": "SELECT COUNT(*) AS anzahl_gemeinden_ohne_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten WHERE jahr = 2020\n    AND anzahl_personenwagen = 0;\n"
      },
      {
        "question": "Wie viele Kleinmotorr\u00e4der gab es im Kanton Aargau zwischen 2000 und 2016?",
        "query": "SELECT T.jahr, T.anzahl_klein_motorrader\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr <= 2016\n    AND T.jahr >= 2000;\n"
      },
      {
        "question": "Wie hoch ist der Anteil der Gemeinden im Kanton Aargau, in denen die Zahl der Autos pro Einwohner zwischen 2015 und 2022 zugenommen hat?",
        "query": "SELECT CAST(SUM(CASE WHEN T1.diff > 0 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(T1.diff) AS ratio_gemeinden_mit_zunahme_autos_pro_einwohner\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) as diff\n    FROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2015, 2022)\n    GROUP BY S.name\n) as T1;\n"
      },
      {
        "question": "Zeigen Sie mir 3 Aargauer Gemeinden, in denen die Zahl der Personenwagen pro Einwohner zwischen 2018 und 2022 am st\u00e4rksten abgenommen hat.",
        "query": "SELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2018, 2022)\nGROUP BY S.name\nORDER BY\n    (\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2018 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END)\n    ) DESC\nLIMIT 3;\n"
      },
      {
        "question": "In welchem Jahr gab es in Zuzgen, AG, die meisten motorisierten Arbeitsfahrzeuge?",
        "query": "SELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Zuzgen', 'Zuzgen (AG)')\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_arbeitsmotorfahrzeuge) DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?",
        "query": "SELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_privatverkehr_bestand_nach_fahrzeugarten (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanzahl_personenwagen NUMERIC, \n\tanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars NUMERIC, \n\tanzahl_nutzfahrzeuge NUMERIC, \n\tanzahl_arbeitsmotorfahrzeuge NUMERIC, \n\tanzahl_motorrader NUMERIC, \n\tanzahl_klein_motorrader NUMERIC, \n\tanzahl_motorfahrrader NUMERIC, \n\tanzahl_landwirtschaftliche_motorfahrzeuge NUMERIC, \n\tanzahl_anhaenger NUMERIC, \n\tanzahl_kollektivfahrzeuge NUMERIC, \n\tanzahl_personenwagen_pro_1000_einwohner NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeugarten_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_privatverkehr_bestand_nach_fahrzeug_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_privatverkehr_bestand_nach_fahrzeugarten and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2015, 1989, 2009, 2000, 2012\nanzahl_personenwagen : 127, 481, 2997, 412, 3291\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars : 94, 4, 102, 10, 86\nanzahl_nutzfahrzeuge : 252, 127, 459, 29, 28\nanzahl_arbeitsmotorfahrzeuge : 4, 17, 152, 11, 13\nanzahl_motorrader : 72, 115, 88, 1104, 28\nanzahl_klein_motorrader : 27, 751, 4, 23, 83\nanzahl_motorfahrrader : 72, 291, 29, 28, 348\nanzahl_landwirtschaftliche_motorfahrzeuge : 27, 91, 18, 59, 94\nanzahl_anhaenger : 29, 57, 123, 17, 110\nanzahl_kollektivfahrzeuge : 4, 59, 23, 24, 34\nanzahl_personenwagen_pro_1000_einwohner : 458.19999999999999, 418.50000000000000, 516.20000000000005, 309.10000000000002, 501.69999999999999\n*/\n\n/*\nColumn name, Column discription, Example values\nanzahl_personenwagen_pro_1000_einwohner, Motorisierungsgrad: Anzahl Personenwagen pro 1000 Einwonhner/-innen., 485.5,488.6,485.1\nanzahl_personenwagen, Anzahl Personenwagen, 10556,10618,10582\nanzahl_ubrige_personen_transportfahrzeuge_kleinbusse_cars, Anzahl \u00dcbrige Personen Transportfahrzeuge (Kleinbusse, cars), 73,70,76\nanzahl_nutzfahrzeuge, Anzahl Nutzfahrzeuge, 1640,1617,1642\nanzahl_arbeitsmotorfahrzeuge, Anzahl Arbeitsmotorfahrzeuge, 142,152,159\nanzahl_motorrader, Anzahl Motorr\u00e4der, 1234,1225,1157\nanzahl_klein_motorrader, Anzahl kleine Motorr\u00e4der, 25,34,30\nanzahl_motorfahrrader, Anzahl Motorfahrr\u00e4der, 517,498,469\nanzahl_landwirtschaftliche_motorfahrzeuge, Anzahl Landwirtschaftliche Motorfahrzeuge, 46,49,45\nanzahl_anhaenger, Anzahl Anh\u00e4nger, 831,820,845\nanzahl_kollektivfahrzeuge, Anzahl Kollektivfahrzeuge, 53,56,55\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nZeigen Sie mir 3 Aargauer Gemeinden, in denen die Zahl der Personenwagen pro Einwohner zwischen 2018 und 2022 am st\u00e4rksten abgenommen hat.\n### SQL query\nSELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2018, 2022)\nGROUP BY S.name\nORDER BY\n    (\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2018 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END)\n    ) DESC\nLIMIT 3;\n\n\n### Question\nZeigen Sie mir 3 Aargauer Gemeinden, in denen die Zahl der Personenwagen pro Einwohner zwischen 2018 und 2022 am st\u00e4rksten abgenommen hat.\n### SQL query\nSELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2018, 2022)\nGROUP BY S.name\nORDER BY\n    (\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2018 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END)\n    ) DESC\nLIMIT 3;\n\n\n### Question\nWie viele Anh\u00e4nger gab es im Jahr 2000 in Suhr, Aargau?\n### SQL query\nSELECT T.anzahl_anhaenger\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Suhr', 'Suhr (AG)')\n    AND T.jahr = 2000;\n\n\n### Question\nWelches waren die 5 Aargauer Gemeinden mit den wenigsten Motorr\u00e4dern pro Personenwagen im Jahr 2015?\n### SQL query\nSELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2015\n    AND S.municipal = 'TRUE'\nORDER BY CAST(T.anzahl_motorrader + T.anzahl_klein_motorrader + T.anzahl_motorfahrrader AS FLOAT) / T.anzahl_personenwagen ASC\nLIMIT 5;\n\n\n### Question\nWie viele Anh\u00e4nger gab es im Jahr 2000 in Suhr, Aargau?\n### SQL query\nSELECT T.anzahl_anhaenger\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Suhr', 'Suhr (AG)')\n    AND T.jahr = 2000;\n\n\n### Question\nWie viele Aargauer Gemeinden haben im Jahr 2020 keine Personenwagen gez\u00e4hlt?\n### SQL query\nSELECT COUNT(*) AS anzahl_gemeinden_ohne_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten WHERE jahr = 2020\n    AND anzahl_personenwagen = 0;\n\n\n### Question\nWie hat sich die Zahl der Autos pro Einwohner im Aargau im Zeitraum 2010 bis 2022 entwickelt?\n### SQL query\nSELECT T.jahr, T.anzahl_personenwagen_pro_1000_einwohner\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name = 'Canton Aargau'\n    AND T.jahr >= 2010\n    AND T.jahr <= 2022;\n\n\n### Question\nGab es 1930 oder 1940 im Kanton Aargau mehr Personenwagen?\n### SQL query\nSELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr IN (1930, 1940)\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_personenwagen) DESC\nLIMIT 1;\n\n\n### Question\nWie viele Aargauer Gemeinden haben im Jahr 2020 keine Personenwagen gez\u00e4hlt?\n### SQL query\nSELECT COUNT(*) AS anzahl_gemeinden_ohne_personenwagen\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten WHERE jahr = 2020\n    AND anzahl_personenwagen = 0;\n\n\n### Question\nWie viele Kleinmotorr\u00e4der gab es im Kanton Aargau zwischen 2000 und 2016?\n### SQL query\nSELECT T.jahr, T.anzahl_klein_motorrader\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr <= 2016\n    AND T.jahr >= 2000;\n\n\n### Question\nWie hoch ist der Anteil der Gemeinden im Kanton Aargau, in denen die Zahl der Autos pro Einwohner zwischen 2015 und 2022 zugenommen hat?\n### SQL query\nSELECT CAST(SUM(CASE WHEN T1.diff > 0 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(T1.diff) AS ratio_gemeinden_mit_zunahme_autos_pro_einwohner\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) as diff\n    FROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2015, 2022)\n    GROUP BY S.name\n) as T1;\n\n\n### Question\nZeigen Sie mir 3 Aargauer Gemeinden, in denen die Zahl der Personenwagen pro Einwohner zwischen 2018 und 2022 am st\u00e4rksten abgenommen hat.\n### SQL query\nSELECT S.name AS gemeinde\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2018, 2022)\nGROUP BY S.name\nORDER BY\n    (\n        SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END) -\n        SUM(CASE WHEN T.jahr = 2018 THEN T.anzahl_personenwagen_pro_1000_einwohner ELSE 0 END)\n    ) DESC\nLIMIT 3;\n\n\n### Question\nIn welchem Jahr gab es in Zuzgen, AG, die meisten motorisierten Arbeitsfahrzeuge?\n### SQL query\nSELECT T.jahr\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Zuzgen', 'Zuzgen (AG)')\nGROUP BY T.jahr\nORDER BY SUM(T.anzahl_arbeitsmotorfahrzeuge) DESC\nLIMIT 1;\n\n\n### Question\nWie viele landwirtschaftliche Fahrzeuge gab es in Rekingen im Aargau zwischen 1998 und 2000?\n### SQL query\nSELECT T.jahr, T.anzahl_landwirtschaftliche_motorfahrzeuge\nFROM aargau_privatverkehr_bestand_nach_fahrzeugarten AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Rekingen', 'Rekingen (AG)')\n    AND T.jahr >= 1998\n    AND T.jahr <= 2000\nORDER BY T.jahr ASC;\n\n\n### Question\nWie viele Kollektivfahrzeuge gab es 2022 in Wettingen, AG?\n### SQL query\n",
    "process_time": 6.58750913804397,
    "num_tokens": 3614,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 83,
    "question": "Wie viel Fl\u00e4che wurde im Jahr 2017 im Aargau f\u00fcr den Rotweinanbau genutzt?",
    "query": "SELECT T.flache_rebland_rote_europaische_reben_ha, T.flache_rebland_kreuzung_rote_weisse_ha\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;\n",
    "db_id": "aargau_obst_rebbau_rebland_wein_ernte",
    "generated_query": "SELECT T.flache_rebland_rote_europaische_reben_ha AS flache_rotwein_2017\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;",
    "meta_data": [
      {
        "question": "Wie viel Prozent des im Aargau geernteten Rotweins stammte im Jahr 2000 aus Kreuzungen?",
        "query": "SELECT (100 * CAST(T.weinernte_rot_kreuzung_rot_hl AS FLOAT) / T.weinernte_total_hl) AS prozent_rotwein_kreuzung_2000\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n"
      },
      {
        "question": "Wie viele Liter Wein wurden im Aargau zwischen 2000 und 2010 insgesamt produziert?",
        "query": "SELECT 100 * SUM(T.weinernte_total_hl) AS weinernte_2000_2010_total_liter\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2000\n    AND T.jahr <= 2010;\n"
      },
      {
        "question": "Wie hat sich die Weinbaufl\u00e4che im Aargau zwischen 1980 und 2000 relativ ver\u00e4ndert (in prozent)?",
        "query": "SELECT 100 * (T1.flache_ha_2000 - T1.flache_ha_1980) / T1.flache_ha_1980 AS weinrebflache_1980_2000_change_prozent\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 1980 THEN T.flache_total_ha ELSE 0 END) AS flache_ha_1980,\n        SUM(CASE WHEN T.jahr = 2000 THEN T.flache_total_ha ELSE 0 END) AS flache_ha_2000\n    FROM aargau_obst_rebbau_rebland_wein_ernte AS T\n    JOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.canton = 'TRUE'\n        AND S.name LIKE '%Aargau%'\n        AND T.jahr IN (1980, 2000)\n) AS T1;\n"
      },
      {
        "question": "Wie viel Prozent des im Aargau geernteten Rotweins stammte im Jahr 2000 aus Kreuzungen?",
        "query": "SELECT (100 * CAST(T.weinernte_rot_kreuzung_rot_hl AS FLOAT) / T.weinernte_total_hl) AS prozent_rotwein_kreuzung_2000\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n"
      },
      {
        "question": "Wie viel Prozent des Wertes des im Aargau produzierten Weines entfiel 2017 auf Rotwein?",
        "query": "SELECT 100.0 * T.erntewert_rot_1000_chf / (T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf) AS prozent_rotwein_wert_2017\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;\n"
      },
      {
        "question": "Wie hat sich die Weinbaufl\u00e4che im Aargau zwischen 1980 und 2000 relativ ver\u00e4ndert (in prozent)?",
        "query": "SELECT 100 * (T1.flache_ha_2000 - T1.flache_ha_1980) / T1.flache_ha_1980 AS weinrebflache_1980_2000_change_prozent\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 1980 THEN T.flache_total_ha ELSE 0 END) AS flache_ha_1980,\n        SUM(CASE WHEN T.jahr = 2000 THEN T.flache_total_ha ELSE 0 END) AS flache_ha_2000\n    FROM aargau_obst_rebbau_rebland_wein_ernte AS T\n    JOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.canton = 'TRUE'\n        AND S.name LIKE '%Aargau%'\n        AND T.jahr IN (1980, 2000)\n) AS T1;\n"
      },
      {
        "question": "Wie viel Prozent des Wertes des im Aargau produzierten Weines entfiel 2017 auf Rotwein?",
        "query": "SELECT 100.0 * T.erntewert_rot_1000_chf / (T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf) AS prozent_rotwein_wert_2017\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;\n"
      },
      {
        "question": "Wie viel Prozent des Wertes des im Aargau produzierten Weines entfiel 2017 auf Rotwein?",
        "query": "SELECT 100.0 * T.erntewert_rot_1000_chf / (T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf) AS prozent_rotwein_wert_2017\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_obst_rebbau_rebland_wein_ernte (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tflache_rebland_rote_europaische_reben_ha NUMERIC, \n\tflache_rebland_kreuzung_rote_weisse_ha NUMERIC, \n\tflache_rebland_weisse_reben_ha NUMERIC, \n\tflache_total_ha NUMERIC, \n\tweinernte_total_hl NUMERIC, \n\tweinernte_rot_europaische_hl NUMERIC, \n\tweinernte_rot_kreuzung_rot_hl NUMERIC, \n\tweinernte_europaische_weiss_hl NUMERIC, \n\terntewert_rot_1000_chf NUMERIC, \n\terntewert_weiss_1000_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_obst_rebbau_rebland_wein_ernte_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_obst_rebbau_rebland_wein_ernte_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_obst_rebbau_rebland_wein_ernte and 5 examples in each column for high cardinality columns :\nuid : 4, 27, 18, 23, 29\njahr : 2015, 1989, 2009, 2000, 2012\nflache_rebland_rote_europaische_reben_ha : 171, 252, 192, 226, 148\nflache_rebland_kreuzung_rote_weisse_ha : 4, 23, 34, 17, 13\nflache_rebland_weisse_reben_ha : 127, 91, 115, 148, 123\nflache_total_ha : 399, 338, 389, 265, 402\nweinernte_total_hl : 18540, 16789, 23490, 20166, 10545\nweinernte_rot_europaische_hl : 15540, 10183, 12101, 16426, 7000\nweinernte_rot_kreuzung_rot_hl : 94, 3100, 412, 670, 1300\nweinernte_europaische_weiss_hl : 5744, 13790, 8098, 10930, 5237\nerntewert_rot_1000_chf : 4449, 5907, 5744, 3746, 2498\nerntewert_weiss_1000_chf : 3100, 2083, 589, 2978, 2120\n*/\n\n/*\nColumn name, Column discription, Example values\nweinernte_total_hl, Weinernte in hl: Total, 167892306117054\nweinernte_rot_europaische_hl, Weinernte in hl: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 103651386111290\nweinernte_rot_kreuzung_rot_hl, Weinernte in hl: rotes Gew\u00e4chs: Direkttr\u00e4gerkreuzungen, 679795435\nweinernte_europaische_weiss_hl, Weinernte in hl: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 574484055329\nflache_rebland_rote_europaische_reben_ha, Fl\u00e4che Rebland in ha: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 244250253\nflache_rebland_kreuzung_rote_weisse_ha, Fl\u00e4che Rebland in ha: rotes Gew\u00e4chs: Direkttr\u00e4gerkreuzungen; ab 2016: Rote und weisse Sorten zusammen, 161413\nflache_total, Fl\u00e4che Rebland in ha: Total, 119126124\nerntewert_rot_1000_chf, Erntewert in 1000 Franken: rotes Gew\u00e4chs, 574487517001\nerntewert_weiss_1000_chf, Erntewert in 1000 Franken: weisse Gew\u00e4chs, 299643832779\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWie viel Prozent des im Aargau geernteten Rotweins stammte im Jahr 2000 aus Kreuzungen?\n### SQL query\nSELECT (100 * CAST(T.weinernte_rot_kreuzung_rot_hl AS FLOAT) / T.weinernte_total_hl) AS prozent_rotwein_kreuzung_2000\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n\n\n### Question\nWie viele Liter Wein wurden im Aargau zwischen 2000 und 2010 insgesamt produziert?\n### SQL query\nSELECT 100 * SUM(T.weinernte_total_hl) AS weinernte_2000_2010_total_liter\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2000\n    AND T.jahr <= 2010;\n\n\n### Question\nWie hat sich die Weinbaufl\u00e4che im Aargau zwischen 1980 und 2000 relativ ver\u00e4ndert (in prozent)?\n### SQL query\nSELECT 100 * (T1.flache_ha_2000 - T1.flache_ha_1980) / T1.flache_ha_1980 AS weinrebflache_1980_2000_change_prozent\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 1980 THEN T.flache_total_ha ELSE 0 END) AS flache_ha_1980,\n        SUM(CASE WHEN T.jahr = 2000 THEN T.flache_total_ha ELSE 0 END) AS flache_ha_2000\n    FROM aargau_obst_rebbau_rebland_wein_ernte AS T\n    JOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.canton = 'TRUE'\n        AND S.name LIKE '%Aargau%'\n        AND T.jahr IN (1980, 2000)\n) AS T1;\n\n\n### Question\nWie viel Prozent des im Aargau geernteten Rotweins stammte im Jahr 2000 aus Kreuzungen?\n### SQL query\nSELECT (100 * CAST(T.weinernte_rot_kreuzung_rot_hl AS FLOAT) / T.weinernte_total_hl) AS prozent_rotwein_kreuzung_2000\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n\n\n### Question\nWie viel Prozent des Wertes des im Aargau produzierten Weines entfiel 2017 auf Rotwein?\n### SQL query\nSELECT 100.0 * T.erntewert_rot_1000_chf / (T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf) AS prozent_rotwein_wert_2017\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;\n\n\n### Question\nWie hat sich die Weinbaufl\u00e4che im Aargau zwischen 1980 und 2000 relativ ver\u00e4ndert (in prozent)?\n### SQL query\nSELECT 100 * (T1.flache_ha_2000 - T1.flache_ha_1980) / T1.flache_ha_1980 AS weinrebflache_1980_2000_change_prozent\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 1980 THEN T.flache_total_ha ELSE 0 END) AS flache_ha_1980,\n        SUM(CASE WHEN T.jahr = 2000 THEN T.flache_total_ha ELSE 0 END) AS flache_ha_2000\n    FROM aargau_obst_rebbau_rebland_wein_ernte AS T\n    JOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.canton = 'TRUE'\n        AND S.name LIKE '%Aargau%'\n        AND T.jahr IN (1980, 2000)\n) AS T1;\n\n\n### Question\nWie viel Prozent des Wertes des im Aargau produzierten Weines entfiel 2017 auf Rotwein?\n### SQL query\nSELECT 100.0 * T.erntewert_rot_1000_chf / (T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf) AS prozent_rotwein_wert_2017\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;\n\n\n### Question\nWie viel Prozent des Wertes des im Aargau produzierten Weines entfiel 2017 auf Rotwein?\n### SQL query\nSELECT 100.0 * T.erntewert_rot_1000_chf / (T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf) AS prozent_rotwein_wert_2017\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;\n\n\n### Question\nWie viel Fl\u00e4che wurde im Jahr 2017 im Aargau f\u00fcr den Rotweinanbau genutzt?\n### SQL query\n",
    "process_time": 9.434686166001484,
    "num_tokens": 2962,
    "hardness": "hard",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 84,
    "question": "In welchem Jahr wurde im Aargau am meisten Wein geerntet?",
    "query": "SELECT T.jahr\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\nGROUP BY T.jahr\nORDER BY SUM(T.weinernte_total_hl) DESC\nLIMIT 1;\n",
    "db_id": "aargau_obst_rebbau_rebland_wein_ernte",
    "generated_query": "SELECT T.jahr, T.weinernte_total_hl\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\nORDER BY T.weinernte_total_hl DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Wie viel Prozent des Wertes des im Aargau produzierten Weines entfiel 2017 auf Rotwein?",
        "query": "SELECT 100.0 * T.erntewert_rot_1000_chf / (T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf) AS prozent_rotwein_wert_2017\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;\n"
      },
      {
        "question": "Wie viele Liter Wein wurden im Aargau zwischen 2000 und 2010 insgesamt produziert?",
        "query": "SELECT 100 * SUM(T.weinernte_total_hl) AS weinernte_2000_2010_total_liter\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2000\n    AND T.jahr <= 2010;\n"
      },
      {
        "question": "Wie viel Prozent des Wertes des im Aargau produzierten Weines entfiel 2017 auf Rotwein?",
        "query": "SELECT 100.0 * T.erntewert_rot_1000_chf / (T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf) AS prozent_rotwein_wert_2017\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;\n"
      },
      {
        "question": "Wie hoch war die Differenz in CHF zwischen dem Wert des im Aargau produzierten Rotweins in den Jahren 1999 und 2000?",
        "query": "SELECT (\n    SUM(CASE WHEN T.jahr = 2000 THEN T.erntewert_rot_1000_chf ELSE 0 END) -\n    SUM(CASE WHEN T.jahr = 1999 THEN T.erntewert_rot_1000_chf ELSE 0 END)\n) * 1000.0 AS wertanderung_1999_2000_chf\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1999, 2000);"
      },
      {
        "question": "Wie viel Prozent des Wertes des im Aargau produzierten Weines entfiel 2017 auf Rotwein?",
        "query": "SELECT 100.0 * T.erntewert_rot_1000_chf / (T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf) AS prozent_rotwein_wert_2017\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;\n"
      },
      {
        "question": "Wie viel Prozent des im Aargau geernteten Rotweins stammte im Jahr 2000 aus Kreuzungen?",
        "query": "SELECT (100 * CAST(T.weinernte_rot_kreuzung_rot_hl AS FLOAT) / T.weinernte_total_hl) AS prozent_rotwein_kreuzung_2000\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n"
      },
      {
        "question": "Wie hoch war der Wert des im Aargau produzierten Weissweins in den Jahren 2003 bis 2008?",
        "query": "SELECT T.jahr, T.erntewert_weiss_1000_chf\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2003\n    AND T.jahr <= 2008;\n"
      },
      {
        "question": "Wie hat sich die Weinbaufl\u00e4che im Aargau zwischen 1980 und 2000 relativ ver\u00e4ndert (in prozent)?",
        "query": "SELECT 100 * (T1.flache_ha_2000 - T1.flache_ha_1980) / T1.flache_ha_1980 AS weinrebflache_1980_2000_change_prozent\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 1980 THEN T.flache_total_ha ELSE 0 END) AS flache_ha_1980,\n        SUM(CASE WHEN T.jahr = 2000 THEN T.flache_total_ha ELSE 0 END) AS flache_ha_2000\n    FROM aargau_obst_rebbau_rebland_wein_ernte AS T\n    JOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.canton = 'TRUE'\n        AND S.name LIKE '%Aargau%'\n        AND T.jahr IN (1980, 2000)\n) AS T1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_obst_rebbau_rebland_wein_ernte (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tflache_rebland_rote_europaische_reben_ha NUMERIC, \n\tflache_rebland_kreuzung_rote_weisse_ha NUMERIC, \n\tflache_rebland_weisse_reben_ha NUMERIC, \n\tflache_total_ha NUMERIC, \n\tweinernte_total_hl NUMERIC, \n\tweinernte_rot_europaische_hl NUMERIC, \n\tweinernte_rot_kreuzung_rot_hl NUMERIC, \n\tweinernte_europaische_weiss_hl NUMERIC, \n\terntewert_rot_1000_chf NUMERIC, \n\terntewert_weiss_1000_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_obst_rebbau_rebland_wein_ernte_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_obst_rebbau_rebland_wein_ernte_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_obst_rebbau_rebland_wein_ernte and 5 examples in each column for high cardinality columns :\nuid : 4, 27, 18, 23, 29\njahr : 2015, 1989, 2009, 2000, 2012\nflache_rebland_rote_europaische_reben_ha : 171, 252, 192, 226, 148\nflache_rebland_kreuzung_rote_weisse_ha : 4, 23, 34, 17, 13\nflache_rebland_weisse_reben_ha : 127, 91, 115, 148, 123\nflache_total_ha : 399, 338, 389, 265, 402\nweinernte_total_hl : 18540, 16789, 23490, 20166, 10545\nweinernte_rot_europaische_hl : 15540, 10183, 12101, 16426, 7000\nweinernte_rot_kreuzung_rot_hl : 94, 3100, 412, 670, 1300\nweinernte_europaische_weiss_hl : 5744, 13790, 8098, 10930, 5237\nerntewert_rot_1000_chf : 4449, 5907, 5744, 3746, 2498\nerntewert_weiss_1000_chf : 3100, 2083, 589, 2978, 2120\n*/\n\n/*\nColumn name, Column discription, Example values\nweinernte_total_hl, Weinernte in hl: Total, 167892306117054\nweinernte_rot_europaische_hl, Weinernte in hl: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 103651386111290\nweinernte_rot_kreuzung_rot_hl, Weinernte in hl: rotes Gew\u00e4chs: Direkttr\u00e4gerkreuzungen, 679795435\nweinernte_europaische_weiss_hl, Weinernte in hl: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 574484055329\nflache_rebland_rote_europaische_reben_ha, Fl\u00e4che Rebland in ha: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 244250253\nflache_rebland_kreuzung_rote_weisse_ha, Fl\u00e4che Rebland in ha: rotes Gew\u00e4chs: Direkttr\u00e4gerkreuzungen; ab 2016: Rote und weisse Sorten zusammen, 161413\nflache_total, Fl\u00e4che Rebland in ha: Total, 119126124\nerntewert_rot_1000_chf, Erntewert in 1000 Franken: rotes Gew\u00e4chs, 574487517001\nerntewert_weiss_1000_chf, Erntewert in 1000 Franken: weisse Gew\u00e4chs, 299643832779\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWie viel Prozent des Wertes des im Aargau produzierten Weines entfiel 2017 auf Rotwein?\n### SQL query\nSELECT 100.0 * T.erntewert_rot_1000_chf / (T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf) AS prozent_rotwein_wert_2017\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;\n\n\n### Question\nWie viele Liter Wein wurden im Aargau zwischen 2000 und 2010 insgesamt produziert?\n### SQL query\nSELECT 100 * SUM(T.weinernte_total_hl) AS weinernte_2000_2010_total_liter\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2000\n    AND T.jahr <= 2010;\n\n\n### Question\nWie viel Prozent des Wertes des im Aargau produzierten Weines entfiel 2017 auf Rotwein?\n### SQL query\nSELECT 100.0 * T.erntewert_rot_1000_chf / (T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf) AS prozent_rotwein_wert_2017\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;\n\n\n### Question\nWie hoch war die Differenz in CHF zwischen dem Wert des im Aargau produzierten Rotweins in den Jahren 1999 und 2000?\n### SQL query\nSELECT (\n    SUM(CASE WHEN T.jahr = 2000 THEN T.erntewert_rot_1000_chf ELSE 0 END) -\n    SUM(CASE WHEN T.jahr = 1999 THEN T.erntewert_rot_1000_chf ELSE 0 END)\n) * 1000.0 AS wertanderung_1999_2000_chf\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1999, 2000);\n\n### Question\nWie viel Prozent des Wertes des im Aargau produzierten Weines entfiel 2017 auf Rotwein?\n### SQL query\nSELECT 100.0 * T.erntewert_rot_1000_chf / (T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf) AS prozent_rotwein_wert_2017\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;\n\n\n### Question\nWie viel Prozent des im Aargau geernteten Rotweins stammte im Jahr 2000 aus Kreuzungen?\n### SQL query\nSELECT (100 * CAST(T.weinernte_rot_kreuzung_rot_hl AS FLOAT) / T.weinernte_total_hl) AS prozent_rotwein_kreuzung_2000\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n\n\n### Question\nWie hoch war der Wert des im Aargau produzierten Weissweins in den Jahren 2003 bis 2008?\n### SQL query\nSELECT T.jahr, T.erntewert_weiss_1000_chf\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2003\n    AND T.jahr <= 2008;\n\n\n### Question\nWie hat sich die Weinbaufl\u00e4che im Aargau zwischen 1980 und 2000 relativ ver\u00e4ndert (in prozent)?\n### SQL query\nSELECT 100 * (T1.flache_ha_2000 - T1.flache_ha_1980) / T1.flache_ha_1980 AS weinrebflache_1980_2000_change_prozent\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 1980 THEN T.flache_total_ha ELSE 0 END) AS flache_ha_1980,\n        SUM(CASE WHEN T.jahr = 2000 THEN T.flache_total_ha ELSE 0 END) AS flache_ha_2000\n    FROM aargau_obst_rebbau_rebland_wein_ernte AS T\n    JOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.canton = 'TRUE'\n        AND S.name LIKE '%Aargau%'\n        AND T.jahr IN (1980, 2000)\n) AS T1;\n\n\n### Question\nIn welchem Jahr wurde im Aargau am meisten Wein geerntet?\n### SQL query\n",
    "process_time": 12.898586326977238,
    "num_tokens": 2898,
    "hardness": "extra",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 85,
    "question": "Um wie viel Franken hat sich der Gesamtwert der Weinernte im Aargau zwischen 1980 und 2016 ver\u00e4ndert?",
    "query": "SELECT (\n    SUM(CASE WHEN T.jahr = 2016 THEN T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf ELSE 0 END) -\n    SUM(CASE WHEN T.jahr = 1980 THEN T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf ELSE 0 END)\n) * 1000.0 AS wertanderung_1980_2016_chf\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1980, 2016);\n",
    "db_id": "aargau_obst_rebbau_rebland_wein_ernte",
    "generated_query": "SELECT (\n    SUM(CASE WHEN T.jahr = 2016 THEN T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf ELSE 0 END) -\n    SUM(CASE WHEN T.jahr = 1980 THEN T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf ELSE 0 END)\n) * 1000.0 AS wertanderung_1980_2016_chf\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1980, 2016);",
    "meta_data": [
      {
        "question": "Wie viel Prozent des Wertes des im Aargau produzierten Weines entfiel 2017 auf Rotwein?",
        "query": "SELECT 100.0 * T.erntewert_rot_1000_chf / (T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf) AS prozent_rotwein_wert_2017\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;\n"
      },
      {
        "question": "Wie viel Wein wurde im Aargau 1980 und 2010 geerntet?",
        "query": "SELECT T.jahr, T.weinernte_total_hl\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1980, 2010);\n"
      },
      {
        "question": "Wie viel Prozent des im Aargau geernteten Rotweins stammte im Jahr 2000 aus Kreuzungen?",
        "query": "SELECT (100 * CAST(T.weinernte_rot_kreuzung_rot_hl AS FLOAT) / T.weinernte_total_hl) AS prozent_rotwein_kreuzung_2000\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n"
      },
      {
        "question": "Wie viel Prozent des Wertes des im Aargau produzierten Weines entfiel 2017 auf Rotwein?",
        "query": "SELECT 100.0 * T.erntewert_rot_1000_chf / (T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf) AS prozent_rotwein_wert_2017\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;\n"
      },
      {
        "question": "Wie viel Rot- und Weisswein wurde im Jahr 2019 im Aargau geerntet?",
        "query": "SELECT T.weinernte_rot_europaische_hl, T.weinernte_rot_kreuzung_rot_hl, T.weinernte_europaische_weiss_hl\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2019;\n"
      },
      {
        "question": "Wie viel Rot- und Weisswein wurde im Jahr 2019 im Aargau geerntet?",
        "query": "SELECT T.weinernte_rot_europaische_hl, T.weinernte_rot_kreuzung_rot_hl, T.weinernte_europaische_weiss_hl\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2019;\n"
      },
      {
        "question": "Wie hat sich die Weinbaufl\u00e4che im Aargau zwischen 1980 und 2000 relativ ver\u00e4ndert (in prozent)?",
        "query": "SELECT 100 * (T1.flache_ha_2000 - T1.flache_ha_1980) / T1.flache_ha_1980 AS weinrebflache_1980_2000_change_prozent\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 1980 THEN T.flache_total_ha ELSE 0 END) AS flache_ha_1980,\n        SUM(CASE WHEN T.jahr = 2000 THEN T.flache_total_ha ELSE 0 END) AS flache_ha_2000\n    FROM aargau_obst_rebbau_rebland_wein_ernte AS T\n    JOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.canton = 'TRUE'\n        AND S.name LIKE '%Aargau%'\n        AND T.jahr IN (1980, 2000)\n) AS T1;\n"
      },
      {
        "question": "Wie hoch war die Differenz in CHF zwischen dem Wert des im Aargau produzierten Rotweins in den Jahren 1999 und 2000?",
        "query": "SELECT (\n    SUM(CASE WHEN T.jahr = 2000 THEN T.erntewert_rot_1000_chf ELSE 0 END) -\n    SUM(CASE WHEN T.jahr = 1999 THEN T.erntewert_rot_1000_chf ELSE 0 END)\n) * 1000.0 AS wertanderung_1999_2000_chf\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1999, 2000);"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_obst_rebbau_rebland_wein_ernte (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tflache_rebland_rote_europaische_reben_ha NUMERIC, \n\tflache_rebland_kreuzung_rote_weisse_ha NUMERIC, \n\tflache_rebland_weisse_reben_ha NUMERIC, \n\tflache_total_ha NUMERIC, \n\tweinernte_total_hl NUMERIC, \n\tweinernte_rot_europaische_hl NUMERIC, \n\tweinernte_rot_kreuzung_rot_hl NUMERIC, \n\tweinernte_europaische_weiss_hl NUMERIC, \n\terntewert_rot_1000_chf NUMERIC, \n\terntewert_weiss_1000_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_obst_rebbau_rebland_wein_ernte_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_obst_rebbau_rebland_wein_ernte_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_obst_rebbau_rebland_wein_ernte and 5 examples in each column for high cardinality columns :\nuid : 4, 27, 18, 23, 29\njahr : 2015, 1989, 2009, 2000, 2012\nflache_rebland_rote_europaische_reben_ha : 171, 252, 192, 226, 148\nflache_rebland_kreuzung_rote_weisse_ha : 4, 23, 34, 17, 13\nflache_rebland_weisse_reben_ha : 127, 91, 115, 148, 123\nflache_total_ha : 399, 338, 389, 265, 402\nweinernte_total_hl : 18540, 16789, 23490, 20166, 10545\nweinernte_rot_europaische_hl : 15540, 10183, 12101, 16426, 7000\nweinernte_rot_kreuzung_rot_hl : 94, 3100, 412, 670, 1300\nweinernte_europaische_weiss_hl : 5744, 13790, 8098, 10930, 5237\nerntewert_rot_1000_chf : 4449, 5907, 5744, 3746, 2498\nerntewert_weiss_1000_chf : 3100, 2083, 589, 2978, 2120\n*/\n\n/*\nColumn name, Column discription, Example values\nweinernte_total_hl, Weinernte in hl: Total, 167892306117054\nweinernte_rot_europaische_hl, Weinernte in hl: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 103651386111290\nweinernte_rot_kreuzung_rot_hl, Weinernte in hl: rotes Gew\u00e4chs: Direkttr\u00e4gerkreuzungen, 679795435\nweinernte_europaische_weiss_hl, Weinernte in hl: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 574484055329\nflache_rebland_rote_europaische_reben_ha, Fl\u00e4che Rebland in ha: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 244250253\nflache_rebland_kreuzung_rote_weisse_ha, Fl\u00e4che Rebland in ha: rotes Gew\u00e4chs: Direkttr\u00e4gerkreuzungen; ab 2016: Rote und weisse Sorten zusammen, 161413\nflache_total, Fl\u00e4che Rebland in ha: Total, 119126124\nerntewert_rot_1000_chf, Erntewert in 1000 Franken: rotes Gew\u00e4chs, 574487517001\nerntewert_weiss_1000_chf, Erntewert in 1000 Franken: weisse Gew\u00e4chs, 299643832779\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWie viel Prozent des Wertes des im Aargau produzierten Weines entfiel 2017 auf Rotwein?\n### SQL query\nSELECT 100.0 * T.erntewert_rot_1000_chf / (T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf) AS prozent_rotwein_wert_2017\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;\n\n\n### Question\nWie viel Wein wurde im Aargau 1980 und 2010 geerntet?\n### SQL query\nSELECT T.jahr, T.weinernte_total_hl\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1980, 2010);\n\n\n### Question\nWie viel Prozent des im Aargau geernteten Rotweins stammte im Jahr 2000 aus Kreuzungen?\n### SQL query\nSELECT (100 * CAST(T.weinernte_rot_kreuzung_rot_hl AS FLOAT) / T.weinernte_total_hl) AS prozent_rotwein_kreuzung_2000\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n\n\n### Question\nWie viel Prozent des Wertes des im Aargau produzierten Weines entfiel 2017 auf Rotwein?\n### SQL query\nSELECT 100.0 * T.erntewert_rot_1000_chf / (T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf) AS prozent_rotwein_wert_2017\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;\n\n\n### Question\nWie viel Rot- und Weisswein wurde im Jahr 2019 im Aargau geerntet?\n### SQL query\nSELECT T.weinernte_rot_europaische_hl, T.weinernte_rot_kreuzung_rot_hl, T.weinernte_europaische_weiss_hl\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2019;\n\n\n### Question\nWie viel Rot- und Weisswein wurde im Jahr 2019 im Aargau geerntet?\n### SQL query\nSELECT T.weinernte_rot_europaische_hl, T.weinernte_rot_kreuzung_rot_hl, T.weinernte_europaische_weiss_hl\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2019;\n\n\n### Question\nWie hat sich die Weinbaufl\u00e4che im Aargau zwischen 1980 und 2000 relativ ver\u00e4ndert (in prozent)?\n### SQL query\nSELECT 100 * (T1.flache_ha_2000 - T1.flache_ha_1980) / T1.flache_ha_1980 AS weinrebflache_1980_2000_change_prozent\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 1980 THEN T.flache_total_ha ELSE 0 END) AS flache_ha_1980,\n        SUM(CASE WHEN T.jahr = 2000 THEN T.flache_total_ha ELSE 0 END) AS flache_ha_2000\n    FROM aargau_obst_rebbau_rebland_wein_ernte AS T\n    JOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.canton = 'TRUE'\n        AND S.name LIKE '%Aargau%'\n        AND T.jahr IN (1980, 2000)\n) AS T1;\n\n\n### Question\nWie hoch war die Differenz in CHF zwischen dem Wert des im Aargau produzierten Rotweins in den Jahren 1999 und 2000?\n### SQL query\nSELECT (\n    SUM(CASE WHEN T.jahr = 2000 THEN T.erntewert_rot_1000_chf ELSE 0 END) -\n    SUM(CASE WHEN T.jahr = 1999 THEN T.erntewert_rot_1000_chf ELSE 0 END)\n) * 1000.0 AS wertanderung_1999_2000_chf\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1999, 2000);\n\n### Question\nUm wie viel Franken hat sich der Gesamtwert der Weinernte im Aargau zwischen 1980 und 2016 ver\u00e4ndert?\n### SQL query\n",
    "process_time": 18.32942027784884,
    "num_tokens": 2877,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 86,
    "question": "Wie viele Quadratkilometer Rebfl\u00e4che gab es im Aargau im Jahr 2018?",
    "query": "SELECT CAST(T.flache_total_ha AS FLOAT) / 100 AS flache_total_km2\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2018;\n",
    "db_id": "aargau_obst_rebbau_rebland_wein_ernte",
    "generated_query": "SELECT T.flache_total_ha / 100 AS rebflache_2018_km2\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2018;",
    "meta_data": [
      {
        "question": "Wie hat sich die Weinbaufl\u00e4che im Aargau zwischen 1980 und 2000 relativ ver\u00e4ndert (in prozent)?",
        "query": "SELECT 100 * (T1.flache_ha_2000 - T1.flache_ha_1980) / T1.flache_ha_1980 AS weinrebflache_1980_2000_change_prozent\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 1980 THEN T.flache_total_ha ELSE 0 END) AS flache_ha_1980,\n        SUM(CASE WHEN T.jahr = 2000 THEN T.flache_total_ha ELSE 0 END) AS flache_ha_2000\n    FROM aargau_obst_rebbau_rebland_wein_ernte AS T\n    JOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.canton = 'TRUE'\n        AND S.name LIKE '%Aargau%'\n        AND T.jahr IN (1980, 2000)\n) AS T1;\n"
      },
      {
        "question": "Wie hoch war die Differenz in CHF zwischen dem Wert des im Aargau produzierten Rotweins in den Jahren 1999 und 2000?",
        "query": "SELECT (\n    SUM(CASE WHEN T.jahr = 2000 THEN T.erntewert_rot_1000_chf ELSE 0 END) -\n    SUM(CASE WHEN T.jahr = 1999 THEN T.erntewert_rot_1000_chf ELSE 0 END)\n) * 1000.0 AS wertanderung_1999_2000_chf\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1999, 2000);"
      },
      {
        "question": "Wie viele Liter Wein wurden im Aargau zwischen 2000 und 2010 insgesamt produziert?",
        "query": "SELECT 100 * SUM(T.weinernte_total_hl) AS weinernte_2000_2010_total_liter\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2000\n    AND T.jahr <= 2010;\n"
      },
      {
        "question": "Wie viel Prozent des im Aargau geernteten Rotweins stammte im Jahr 2000 aus Kreuzungen?",
        "query": "SELECT (100 * CAST(T.weinernte_rot_kreuzung_rot_hl AS FLOAT) / T.weinernte_total_hl) AS prozent_rotwein_kreuzung_2000\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n"
      },
      {
        "question": "Wie viele Liter Wein wurden im Aargau zwischen 2000 und 2010 insgesamt produziert?",
        "query": "SELECT 100 * SUM(T.weinernte_total_hl) AS weinernte_2000_2010_total_liter\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2000\n    AND T.jahr <= 2010;\n"
      },
      {
        "question": "Wie hoch war der Wert des im Aargau produzierten Weissweins in den Jahren 2003 bis 2008?",
        "query": "SELECT T.jahr, T.erntewert_weiss_1000_chf\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2003\n    AND T.jahr <= 2008;\n"
      },
      {
        "question": "Wie viele Liter Wein wurden im Aargau zwischen 2000 und 2010 insgesamt produziert?",
        "query": "SELECT 100 * SUM(T.weinernte_total_hl) AS weinernte_2000_2010_total_liter\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2000\n    AND T.jahr <= 2010;\n"
      },
      {
        "question": "Wie viel Prozent des Wertes des im Aargau produzierten Weines entfiel 2017 auf Rotwein?",
        "query": "SELECT 100.0 * T.erntewert_rot_1000_chf / (T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf) AS prozent_rotwein_wert_2017\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_obst_rebbau_rebland_wein_ernte (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tflache_rebland_rote_europaische_reben_ha NUMERIC, \n\tflache_rebland_kreuzung_rote_weisse_ha NUMERIC, \n\tflache_rebland_weisse_reben_ha NUMERIC, \n\tflache_total_ha NUMERIC, \n\tweinernte_total_hl NUMERIC, \n\tweinernte_rot_europaische_hl NUMERIC, \n\tweinernte_rot_kreuzung_rot_hl NUMERIC, \n\tweinernte_europaische_weiss_hl NUMERIC, \n\terntewert_rot_1000_chf NUMERIC, \n\terntewert_weiss_1000_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_obst_rebbau_rebland_wein_ernte_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_obst_rebbau_rebland_wein_ernte_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_obst_rebbau_rebland_wein_ernte and 5 examples in each column for high cardinality columns :\nuid : 4, 27, 18, 23, 29\njahr : 2015, 1989, 2009, 2000, 2012\nflache_rebland_rote_europaische_reben_ha : 171, 252, 192, 226, 148\nflache_rebland_kreuzung_rote_weisse_ha : 4, 23, 34, 17, 13\nflache_rebland_weisse_reben_ha : 127, 91, 115, 148, 123\nflache_total_ha : 399, 338, 389, 265, 402\nweinernte_total_hl : 18540, 16789, 23490, 20166, 10545\nweinernte_rot_europaische_hl : 15540, 10183, 12101, 16426, 7000\nweinernte_rot_kreuzung_rot_hl : 94, 3100, 412, 670, 1300\nweinernte_europaische_weiss_hl : 5744, 13790, 8098, 10930, 5237\nerntewert_rot_1000_chf : 4449, 5907, 5744, 3746, 2498\nerntewert_weiss_1000_chf : 3100, 2083, 589, 2978, 2120\n*/\n\n/*\nColumn name, Column discription, Example values\nweinernte_total_hl, Weinernte in hl: Total, 167892306117054\nweinernte_rot_europaische_hl, Weinernte in hl: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 103651386111290\nweinernte_rot_kreuzung_rot_hl, Weinernte in hl: rotes Gew\u00e4chs: Direkttr\u00e4gerkreuzungen, 679795435\nweinernte_europaische_weiss_hl, Weinernte in hl: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 574484055329\nflache_rebland_rote_europaische_reben_ha, Fl\u00e4che Rebland in ha: rotes Gew\u00e4chs: Europ\u00e4ische Reben, 244250253\nflache_rebland_kreuzung_rote_weisse_ha, Fl\u00e4che Rebland in ha: rotes Gew\u00e4chs: Direkttr\u00e4gerkreuzungen; ab 2016: Rote und weisse Sorten zusammen, 161413\nflache_total, Fl\u00e4che Rebland in ha: Total, 119126124\nerntewert_rot_1000_chf, Erntewert in 1000 Franken: rotes Gew\u00e4chs, 574487517001\nerntewert_weiss_1000_chf, Erntewert in 1000 Franken: weisse Gew\u00e4chs, 299643832779\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWie hat sich die Weinbaufl\u00e4che im Aargau zwischen 1980 und 2000 relativ ver\u00e4ndert (in prozent)?\n### SQL query\nSELECT 100 * (T1.flache_ha_2000 - T1.flache_ha_1980) / T1.flache_ha_1980 AS weinrebflache_1980_2000_change_prozent\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 1980 THEN T.flache_total_ha ELSE 0 END) AS flache_ha_1980,\n        SUM(CASE WHEN T.jahr = 2000 THEN T.flache_total_ha ELSE 0 END) AS flache_ha_2000\n    FROM aargau_obst_rebbau_rebland_wein_ernte AS T\n    JOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.canton = 'TRUE'\n        AND S.name LIKE '%Aargau%'\n        AND T.jahr IN (1980, 2000)\n) AS T1;\n\n\n### Question\nWie hoch war die Differenz in CHF zwischen dem Wert des im Aargau produzierten Rotweins in den Jahren 1999 und 2000?\n### SQL query\nSELECT (\n    SUM(CASE WHEN T.jahr = 2000 THEN T.erntewert_rot_1000_chf ELSE 0 END) -\n    SUM(CASE WHEN T.jahr = 1999 THEN T.erntewert_rot_1000_chf ELSE 0 END)\n) * 1000.0 AS wertanderung_1999_2000_chf\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1999, 2000);\n\n### Question\nWie viele Liter Wein wurden im Aargau zwischen 2000 und 2010 insgesamt produziert?\n### SQL query\nSELECT 100 * SUM(T.weinernte_total_hl) AS weinernte_2000_2010_total_liter\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2000\n    AND T.jahr <= 2010;\n\n\n### Question\nWie viel Prozent des im Aargau geernteten Rotweins stammte im Jahr 2000 aus Kreuzungen?\n### SQL query\nSELECT (100 * CAST(T.weinernte_rot_kreuzung_rot_hl AS FLOAT) / T.weinernte_total_hl) AS prozent_rotwein_kreuzung_2000\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n\n\n### Question\nWie viele Liter Wein wurden im Aargau zwischen 2000 und 2010 insgesamt produziert?\n### SQL query\nSELECT 100 * SUM(T.weinernte_total_hl) AS weinernte_2000_2010_total_liter\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2000\n    AND T.jahr <= 2010;\n\n\n### Question\nWie hoch war der Wert des im Aargau produzierten Weissweins in den Jahren 2003 bis 2008?\n### SQL query\nSELECT T.jahr, T.erntewert_weiss_1000_chf\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2003\n    AND T.jahr <= 2008;\n\n\n### Question\nWie viele Liter Wein wurden im Aargau zwischen 2000 und 2010 insgesamt produziert?\n### SQL query\nSELECT 100 * SUM(T.weinernte_total_hl) AS weinernte_2000_2010_total_liter\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2000\n    AND T.jahr <= 2010;\n\n\n### Question\nWie viel Prozent des Wertes des im Aargau produzierten Weines entfiel 2017 auf Rotwein?\n### SQL query\nSELECT 100.0 * T.erntewert_rot_1000_chf / (T.erntewert_rot_1000_chf + T.erntewert_weiss_1000_chf) AS prozent_rotwein_wert_2017\nFROM aargau_obst_rebbau_rebland_wein_ernte AS T\nJOIN spatial_unit as S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2017;\n\n\n### Question\nWie viele Quadratkilometer Rebfl\u00e4che gab es im Aargau im Jahr 2018?\n### SQL query\n",
    "process_time": 8.62258890690282,
    "num_tokens": 2858,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 87,
    "question": "Wie viele Brandf\u00e4lle gab es im Jahr 2011 im Aargau?",
    "query": "SELECT T.total_anzahl_schadenfalle\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2011;\n",
    "db_id": "aargau_brandversicherung_brandschaden_anzahl_schadensummen",
    "generated_query": "SELECT T.total_anzahl_schadenfalle\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2011;",
    "meta_data": [
      {
        "question": "Wie viel kosteten Brandf\u00e4lle durch Explosionen die Versicherer im Kanton Aargau in den Jahren 1980, 1990, 2000 und 2010 in CHF?",
        "query": "SELECT T.jahr, T.explosion_schaden_1000_chf * 1000 AS explosion_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1980, 1990, 2000, 2010)\nORDER BY T.jahr DESC;\n"
      },
      {
        "question": "Wie viele Explosionen und Brandstiftungen wurden im Jahr 2000 im Aargau registriert?",
        "query": "SELECT T.explosion_anzahl_schadenfalle, T.vorsatzliche_brandstift_anzahl_schadenfalle\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n"
      },
      {
        "question": "Wie viele Brandstiftungen wurden von 1980 bis 2020 im Kanton Aargau insgesamt gemeldet?",
        "query": "SELECT SUM(T.vorsatzliche_brandstift_anzahl_schadenfalle)\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2020;"
      },
      {
        "question": "Wie viele Explosionen und Brandstiftungen wurden im Jahr 2000 im Aargau registriert?",
        "query": "SELECT T.explosion_anzahl_schadenfalle, T.vorsatzliche_brandstift_anzahl_schadenfalle\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n"
      },
      {
        "question": "Wie viele Brandstiftungen wurden von 1980 bis 2020 im Kanton Aargau insgesamt gemeldet?",
        "query": "SELECT SUM(T.vorsatzliche_brandstift_anzahl_schadenfalle)\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2020;"
      },
      {
        "question": "Wie viele Brandstiftungen wurden von 1980 bis 2020 im Kanton Aargau insgesamt gemeldet?",
        "query": "SELECT SUM(T.vorsatzliche_brandstift_anzahl_schadenfalle)\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2020;"
      },
      {
        "question": "Wie hoch (in prozent) ist der Anteil unbekannter Ursachen an der Zahl der Brandf\u00e4lle im Aargau im Jahr 2018?",
        "query": "SELECT T.unbekannt_anzahl_schadenfalle * 100.0 / T.total_anzahl_schadenfalle AS unbekannt_anzahl_schadenfalle_prozent\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2018;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_brandversicherung_brandschaden_anzahl_schadensummen (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\ttotal_anzahl_schadenfalle NUMERIC, \n\ttotal_schaden_1000_chf NUMERIC, \n\tfeuerzeug_rauchzeug_licht_anzahl_schadenfalle NUMERIC, \n\tfeuerzeug_rauchzeug_licht_schaden_1000_chf NUMERIC, \n\telektrizitaet_anzahl_schadenfalle NUMERIC, \n\telektrizitaet_schaden_1000_chf NUMERIC, \n\tvorsatzliche_brandstift_anzahl_schadenfalle NUMERIC, \n\tvorsatzliche_brandstift_schaden_1000_chf NUMERIC, \n\tfeuerungsanlagen_anzahl_schadenfalle NUMERIC, \n\tfeuerungsanlagen_schaden_1000_chf NUMERIC, \n\texplosion_anzahl_schadenfalle NUMERIC, \n\texplosion_schaden_1000_chf NUMERIC, \n\tuebrige_anzahl_schadenfalle NUMERIC, \n\tuebrige_schaden_1000_chf NUMERIC, \n\tunbekannt_anzahl_schadenfalle NUMERIC, \n\tunbekannt_schaden_1000_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_brandversicherung_brandschaden_anzahl_schadensummen_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_brandversicherung_brandschaden_anza_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_brandversicherung_brandschaden_anzahl_schadensummen and 5 examples in each column for high cardinality columns :\nuid : 4, 27, 18, 23, 29\njahr : 2015, 1989, 2009, 2000, 2012\ntotal_anzahl_schadenfalle : 1565, 681, 1050, 964, 1104\ntotal_schaden_1000_chf : 6214, 15679, 17703, 18247, 14537\nfeuerzeug_rauchzeug_licht_anzahl_schadenfalle : 127, 18, 125, 160, 83\nfeuerzeug_rauchzeug_licht_schaden_1000_chf : 127, 1304, 3884, 1042, 1203\nelektrizitaet_anzahl_schadenfalle : 252, 275, 91, 284, 291\nelektrizitaet_schaden_1000_chf : 1649, 473, 629, 4359, 6017\nvorsatzliche_brandstift_anzahl_schadenfalle : 27, 23, 83, 29, 24\nvorsatzliche_brandstift_schaden_1000_chf : 1708, 1229, 629, 905, 559\nfeuerungsanlagen_anzahl_schadenfalle : 59, 23, 29, 41, 85\nfeuerungsanlagen_schaden_1000_chf : 843, 1560, 473, 2228, 728\nexplosion_anzahl_schadenfalle : 94, 59, 23, 29, 28\nexplosion_schaden_1000_chf : 1640, 329, 498, 810, 681\nuebrige_anzahl_schadenfalle : 359, 1043, 566, 869, 176\nuebrige_schaden_1000_chf : 2455, 5907, 2911, 3191, 3759\nunbekannt_anzahl_schadenfalle : 97, 72, 29, 28, 57\nunbekannt_schaden_1000_chf : 5059, 8295, 6091, 5176, 4312\n*/\n\n/*\nColumn name, Column discription, Example values\ntotal_anzahl_schadenfalle, Total Anzahl Schadenfalle, 796681857\ntotal_schaden_1000_chf, Totale Schadensumme in 1000 CHF, 182472448024074\nfeuerzeug_rauchzeug_licht_anzahl_schadenfalle, None, 122123132\nfeuerzeug_rauchzeug_licht_schaden_1000_chf, None, 209525525078\nelektrizitaet_anzahl_schadenfalle, None, 234246228\nvorsatzliche_brandstift_schaden_1000_chf, None, 508360635374\nvorsatzliche_brandstift_anzahl_schadenfalle, None, 142225\nbrandstift_schaden_1000_chf, None, 2149632470\nfeuerungsanl_anzahl_schadenfalle, Feuerungsanlagen: Anzahl Schadenf\u00e4lle, 676547\nfeuerungsanl_schaden_1000_chf, Feuerungsanlagen: Totale Schadensumme in 1000 CHF, 15601231792\nexplosion_anzahl_schadenfalle, None, 262125\nexplosion_schaden_1000_chf, None, 7821180211\nuebrige_anzahl_schadenfalle, None, 269176342\nuebrige_schaden_1000_chf, None, 16449331734\nunbekannt_anzahl_schadenfalle, None, 512857\nunbekannt_schaden_1000_chf, None, 675118838678\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWie viel kosteten Brandf\u00e4lle durch Explosionen die Versicherer im Kanton Aargau in den Jahren 1980, 1990, 2000 und 2010 in CHF?\n### SQL query\nSELECT T.jahr, T.explosion_schaden_1000_chf * 1000 AS explosion_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1980, 1990, 2000, 2010)\nORDER BY T.jahr DESC;\n\n\n### Question\nWie viele Explosionen und Brandstiftungen wurden im Jahr 2000 im Aargau registriert?\n### SQL query\nSELECT T.explosion_anzahl_schadenfalle, T.vorsatzliche_brandstift_anzahl_schadenfalle\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n\n\n### Question\nWie viele Brandstiftungen wurden von 1980 bis 2020 im Kanton Aargau insgesamt gemeldet?\n### SQL query\nSELECT SUM(T.vorsatzliche_brandstift_anzahl_schadenfalle)\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2020;\n\n### Question\nWie viele Explosionen und Brandstiftungen wurden im Jahr 2000 im Aargau registriert?\n### SQL query\nSELECT T.explosion_anzahl_schadenfalle, T.vorsatzliche_brandstift_anzahl_schadenfalle\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n\n\n### Question\nWie viele Brandstiftungen wurden von 1980 bis 2020 im Kanton Aargau insgesamt gemeldet?\n### SQL query\nSELECT SUM(T.vorsatzliche_brandstift_anzahl_schadenfalle)\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2020;\n\n### Question\nWie viele Brandstiftungen wurden von 1980 bis 2020 im Kanton Aargau insgesamt gemeldet?\n### SQL query\nSELECT SUM(T.vorsatzliche_brandstift_anzahl_schadenfalle)\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2020;\n\n### Question\nWie hoch (in prozent) ist der Anteil unbekannter Ursachen an der Zahl der Brandf\u00e4lle im Aargau im Jahr 2018?\n### SQL query\nSELECT T.unbekannt_anzahl_schadenfalle * 100.0 / T.total_anzahl_schadenfalle AS unbekannt_anzahl_schadenfalle_prozent\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2018;\n\n\n### Question\nWie viele Brandf\u00e4lle gab es im Jahr 2011 im Aargau?\n### SQL query\n",
    "process_time": 9.271313373930752,
    "num_tokens": 2924,
    "hardness": "hard",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 88,
    "question": "In welchem Jahr wurden im Aargau die meisten Brandstiftungen gemeldet?",
    "query": "SELECT T.jahr\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\nORDER BY T.vorsatzliche_brandstift_anzahl_schadenfalle DESC\nLIMIT 1;\n",
    "db_id": "aargau_brandversicherung_brandschaden_anzahl_schadensummen",
    "generated_query": "SELECT T.jahr\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\nORDER BY T.vorsatzliche_brandstift_anzahl_schadenfalle DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Wie viele Brandstiftungen wurden von 1980 bis 2020 im Kanton Aargau insgesamt gemeldet?",
        "query": "SELECT SUM(T.vorsatzliche_brandstift_anzahl_schadenfalle)\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2020;"
      },
      {
        "question": "Wie viele Brandstiftungen wurden von 1980 bis 2020 im Kanton Aargau insgesamt gemeldet?",
        "query": "SELECT SUM(T.vorsatzliche_brandstift_anzahl_schadenfalle)\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2020;"
      },
      {
        "question": "Wie hoch (in prozent) ist der Anteil unbekannter Ursachen an der Zahl der Brandf\u00e4lle im Aargau im Jahr 2018?",
        "query": "SELECT T.unbekannt_anzahl_schadenfalle * 100.0 / T.total_anzahl_schadenfalle AS unbekannt_anzahl_schadenfalle_prozent\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2018;\n"
      },
      {
        "question": "Wie viel kosteten Brandf\u00e4lle durch Explosionen die Versicherer im Kanton Aargau in den Jahren 1980, 1990, 2000 und 2010 in CHF?",
        "query": "SELECT T.jahr, T.explosion_schaden_1000_chf * 1000 AS explosion_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1980, 1990, 2000, 2010)\nORDER BY T.jahr DESC;\n"
      },
      {
        "question": "Wie hoch (in prozent) ist der Anteil unbekannter Ursachen an der Zahl der Brandf\u00e4lle im Aargau im Jahr 2018?",
        "query": "SELECT T.unbekannt_anzahl_schadenfalle * 100.0 / T.total_anzahl_schadenfalle AS unbekannt_anzahl_schadenfalle_prozent\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2018;\n"
      },
      {
        "question": "Wie viele Explosionen und Brandstiftungen wurden im Jahr 2000 im Aargau registriert?",
        "query": "SELECT T.explosion_anzahl_schadenfalle, T.vorsatzliche_brandstift_anzahl_schadenfalle\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n"
      },
      {
        "question": "Wie hoch waren die j\u00e4hrlichen Kosten in CHF f\u00fcr die durch Elektrizit\u00e4t und Explosionen verursachten Brandsch\u00e4den im Kanton Aargau in den Jahren 2001 bis 2007?",
        "query": "SELECT T.jahr, T.elektrizitaet_schaden_1000_chf * 1000 AS elektrizitaet_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2001\n    AND T.jahr <= 2007\nORDER BY T.jahr DESC;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_brandversicherung_brandschaden_anzahl_schadensummen (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\ttotal_anzahl_schadenfalle NUMERIC, \n\ttotal_schaden_1000_chf NUMERIC, \n\tfeuerzeug_rauchzeug_licht_anzahl_schadenfalle NUMERIC, \n\tfeuerzeug_rauchzeug_licht_schaden_1000_chf NUMERIC, \n\telektrizitaet_anzahl_schadenfalle NUMERIC, \n\telektrizitaet_schaden_1000_chf NUMERIC, \n\tvorsatzliche_brandstift_anzahl_schadenfalle NUMERIC, \n\tvorsatzliche_brandstift_schaden_1000_chf NUMERIC, \n\tfeuerungsanlagen_anzahl_schadenfalle NUMERIC, \n\tfeuerungsanlagen_schaden_1000_chf NUMERIC, \n\texplosion_anzahl_schadenfalle NUMERIC, \n\texplosion_schaden_1000_chf NUMERIC, \n\tuebrige_anzahl_schadenfalle NUMERIC, \n\tuebrige_schaden_1000_chf NUMERIC, \n\tunbekannt_anzahl_schadenfalle NUMERIC, \n\tunbekannt_schaden_1000_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_brandversicherung_brandschaden_anzahl_schadensummen_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_brandversicherung_brandschaden_anza_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_brandversicherung_brandschaden_anzahl_schadensummen and 5 examples in each column for high cardinality columns :\nuid : 4, 27, 18, 23, 29\njahr : 2015, 1989, 2009, 2000, 2012\ntotal_anzahl_schadenfalle : 1565, 681, 1050, 964, 1104\ntotal_schaden_1000_chf : 6214, 15679, 17703, 18247, 14537\nfeuerzeug_rauchzeug_licht_anzahl_schadenfalle : 127, 18, 125, 160, 83\nfeuerzeug_rauchzeug_licht_schaden_1000_chf : 127, 1304, 3884, 1042, 1203\nelektrizitaet_anzahl_schadenfalle : 252, 275, 91, 284, 291\nelektrizitaet_schaden_1000_chf : 1649, 473, 629, 4359, 6017\nvorsatzliche_brandstift_anzahl_schadenfalle : 27, 23, 83, 29, 24\nvorsatzliche_brandstift_schaden_1000_chf : 1708, 1229, 629, 905, 559\nfeuerungsanlagen_anzahl_schadenfalle : 59, 23, 29, 41, 85\nfeuerungsanlagen_schaden_1000_chf : 843, 1560, 473, 2228, 728\nexplosion_anzahl_schadenfalle : 94, 59, 23, 29, 28\nexplosion_schaden_1000_chf : 1640, 329, 498, 810, 681\nuebrige_anzahl_schadenfalle : 359, 1043, 566, 869, 176\nuebrige_schaden_1000_chf : 2455, 5907, 2911, 3191, 3759\nunbekannt_anzahl_schadenfalle : 97, 72, 29, 28, 57\nunbekannt_schaden_1000_chf : 5059, 8295, 6091, 5176, 4312\n*/\n\n/*\nColumn name, Column discription, Example values\ntotal_anzahl_schadenfalle, Total Anzahl Schadenfalle, 796681857\ntotal_schaden_1000_chf, Totale Schadensumme in 1000 CHF, 182472448024074\nfeuerzeug_rauchzeug_licht_anzahl_schadenfalle, None, 122123132\nfeuerzeug_rauchzeug_licht_schaden_1000_chf, None, 209525525078\nelektrizitaet_anzahl_schadenfalle, None, 234246228\nvorsatzliche_brandstift_schaden_1000_chf, None, 508360635374\nvorsatzliche_brandstift_anzahl_schadenfalle, None, 142225\nbrandstift_schaden_1000_chf, None, 2149632470\nfeuerungsanl_anzahl_schadenfalle, Feuerungsanlagen: Anzahl Schadenf\u00e4lle, 676547\nfeuerungsanl_schaden_1000_chf, Feuerungsanlagen: Totale Schadensumme in 1000 CHF, 15601231792\nexplosion_anzahl_schadenfalle, None, 262125\nexplosion_schaden_1000_chf, None, 7821180211\nuebrige_anzahl_schadenfalle, None, 269176342\nuebrige_schaden_1000_chf, None, 16449331734\nunbekannt_anzahl_schadenfalle, None, 512857\nunbekannt_schaden_1000_chf, None, 675118838678\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWie viele Brandstiftungen wurden von 1980 bis 2020 im Kanton Aargau insgesamt gemeldet?\n### SQL query\nSELECT SUM(T.vorsatzliche_brandstift_anzahl_schadenfalle)\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2020;\n\n### Question\nWie viele Brandstiftungen wurden von 1980 bis 2020 im Kanton Aargau insgesamt gemeldet?\n### SQL query\nSELECT SUM(T.vorsatzliche_brandstift_anzahl_schadenfalle)\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2020;\n\n### Question\nWie hoch (in prozent) ist der Anteil unbekannter Ursachen an der Zahl der Brandf\u00e4lle im Aargau im Jahr 2018?\n### SQL query\nSELECT T.unbekannt_anzahl_schadenfalle * 100.0 / T.total_anzahl_schadenfalle AS unbekannt_anzahl_schadenfalle_prozent\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2018;\n\n\n### Question\nWie viel kosteten Brandf\u00e4lle durch Explosionen die Versicherer im Kanton Aargau in den Jahren 1980, 1990, 2000 und 2010 in CHF?\n### SQL query\nSELECT T.jahr, T.explosion_schaden_1000_chf * 1000 AS explosion_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr IN (1980, 1990, 2000, 2010)\nORDER BY T.jahr DESC;\n\n\n### Question\nWie hoch (in prozent) ist der Anteil unbekannter Ursachen an der Zahl der Brandf\u00e4lle im Aargau im Jahr 2018?\n### SQL query\nSELECT T.unbekannt_anzahl_schadenfalle * 100.0 / T.total_anzahl_schadenfalle AS unbekannt_anzahl_schadenfalle_prozent\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2018;\n\n\n### Question\nWie viele Explosionen und Brandstiftungen wurden im Jahr 2000 im Aargau registriert?\n### SQL query\nSELECT T.explosion_anzahl_schadenfalle, T.vorsatzliche_brandstift_anzahl_schadenfalle\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n\n\n### Question\nWie hoch waren die j\u00e4hrlichen Kosten in CHF f\u00fcr die durch Elektrizit\u00e4t und Explosionen verursachten Brandsch\u00e4den im Kanton Aargau in den Jahren 2001 bis 2007?\n### SQL query\nSELECT T.jahr, T.elektrizitaet_schaden_1000_chf * 1000 AS elektrizitaet_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2001\n    AND T.jahr <= 2007\nORDER BY T.jahr DESC;\n\n\n### Question\nIn welchem Jahr wurden im Aargau die meisten Brandstiftungen gemeldet?\n### SQL query\n",
    "process_time": 5.924468615092337,
    "num_tokens": 2993,
    "hardness": "extra",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 89,
    "question": "Welches waren die 3 h\u00e4ufigsten Ursachen f\u00fcr Brandf\u00e4lle im Aargau im Jahr 1985?",
    "query": "WITH T1 AS (\n    SELECT * FROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.canton = 'TRUE'\n        AND S.name LIKE '%Aargau%'\n        AND T.jahr = 1985\n)\nSELECT T2.source_name\nFROM (\n    SELECT T1.feuerzeug_rauchzeug_licht_anzahl_schadenfalle as source, 'feuerzeug_rauchzeug_licht_anzahl_schadenfalle' as source_name\n    FROM T1 AS UNION ALL\n    SELECT T1.elektrizitaet_anzahl_schadenfalle as source, 'elektrizitaet_anzahl_schadenfalle' as source_name\n    FROM T1 AS UNION ALL\n    SELECT T1.vorsatzliche_brandstift_anzahl_schadenfalle as source, 'vorsatzliche_brandstift_anzahl_schadenfalle' as source_name\n    FROM T1 AS UNION ALL\n    SELECT T1.feuerungsanlagen_anzahl_schadenfalle as source, 'feuerungsanlagen_anzahl_schadenfalle' as source_name\n    FROM T1 AS UNION ALL\n    SELECT T1.explosion_anzahl_schadenfalle as source, 'explosion_anzahl_schadenfalle' as source_name\n    FROM T1 AS UNION ALL\n    SELECT T1.uebrige_anzahl_schadenfalle as source, 'uebrige_anzahl_schadenfalle' as source_name\n    FROM T1 AS UNION ALL\n    SELECT T1.unbekannt_anzahl_schadenfalle as source, 'unbekannt_anzahl_schadenfalle' as source_name\n    FROM T1\n) AS T2\nORDER BY T2.source DESC\nLIMIT 3;\n",
    "db_id": "aargau_brandversicherung_brandschaden_anzahl_schadensummen",
    "generated_query": "SELECT T.feuerzeug_rauchzeug_licht_anzahl_schadenfalle, T.elektrizitaet_anzahl_schadenfalle, T.vorsatzliche_brandstift_anzahl_schadenfalle\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 1985\nORDER BY T.feuerzeug_rauchzeug_licht_anzahl_schadenfalle DESC, T.elektrizitaet_anzahl_schadenfalle DESC, T.vorsatzliche_brandstift_anzahl_schadenfalle DESC\nLIMIT 3;",
    "meta_data": [
      {
        "question": "Wie hoch waren die j\u00e4hrlichen Kosten in CHF f\u00fcr die durch Elektrizit\u00e4t und Explosionen verursachten Brandsch\u00e4den im Kanton Aargau in den Jahren 2001 bis 2007?",
        "query": "SELECT T.jahr, T.elektrizitaet_schaden_1000_chf * 1000 AS elektrizitaet_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2001\n    AND T.jahr <= 2007\nORDER BY T.jahr DESC;\n"
      },
      {
        "question": "Wie viel Franken kosteten Brandeins\u00e4tze aus unbekannter Ursache im Aargau im Jahr 2020?",
        "query": "SELECT T.unbekannt_schaden_1000_chf * 1000 AS unbekannt_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2020;\n"
      },
      {
        "question": "Wie viel Franken kosteten Brandeins\u00e4tze aus unbekannter Ursache im Aargau im Jahr 2020?",
        "query": "SELECT T.unbekannt_schaden_1000_chf * 1000 AS unbekannt_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2020;\n"
      },
      {
        "question": "Wie viel Franken kosteten Brandeins\u00e4tze aus unbekannter Ursache im Aargau im Jahr 2020?",
        "query": "SELECT T.unbekannt_schaden_1000_chf * 1000 AS unbekannt_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2020;\n"
      },
      {
        "question": "Wie hoch (in prozent) ist der Anteil unbekannter Ursachen an der Zahl der Brandf\u00e4lle im Aargau im Jahr 2018?",
        "query": "SELECT T.unbekannt_anzahl_schadenfalle * 100.0 / T.total_anzahl_schadenfalle AS unbekannt_anzahl_schadenfalle_prozent\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2018;\n"
      },
      {
        "question": "Wie viele Brandstiftungen wurden von 1980 bis 2020 im Kanton Aargau insgesamt gemeldet?",
        "query": "SELECT SUM(T.vorsatzliche_brandstift_anzahl_schadenfalle)\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2020;"
      },
      {
        "question": "Wie viele Explosionen und Brandstiftungen wurden im Jahr 2000 im Aargau registriert?",
        "query": "SELECT T.explosion_anzahl_schadenfalle, T.vorsatzliche_brandstift_anzahl_schadenfalle\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_brandversicherung_brandschaden_anzahl_schadensummen (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\ttotal_anzahl_schadenfalle NUMERIC, \n\ttotal_schaden_1000_chf NUMERIC, \n\tfeuerzeug_rauchzeug_licht_anzahl_schadenfalle NUMERIC, \n\tfeuerzeug_rauchzeug_licht_schaden_1000_chf NUMERIC, \n\telektrizitaet_anzahl_schadenfalle NUMERIC, \n\telektrizitaet_schaden_1000_chf NUMERIC, \n\tvorsatzliche_brandstift_anzahl_schadenfalle NUMERIC, \n\tvorsatzliche_brandstift_schaden_1000_chf NUMERIC, \n\tfeuerungsanlagen_anzahl_schadenfalle NUMERIC, \n\tfeuerungsanlagen_schaden_1000_chf NUMERIC, \n\texplosion_anzahl_schadenfalle NUMERIC, \n\texplosion_schaden_1000_chf NUMERIC, \n\tuebrige_anzahl_schadenfalle NUMERIC, \n\tuebrige_schaden_1000_chf NUMERIC, \n\tunbekannt_anzahl_schadenfalle NUMERIC, \n\tunbekannt_schaden_1000_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_brandversicherung_brandschaden_anzahl_schadensummen_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_brandversicherung_brandschaden_anza_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_brandversicherung_brandschaden_anzahl_schadensummen and 5 examples in each column for high cardinality columns :\nuid : 4, 27, 18, 23, 29\njahr : 2015, 1989, 2009, 2000, 2012\ntotal_anzahl_schadenfalle : 1565, 681, 1050, 964, 1104\ntotal_schaden_1000_chf : 6214, 15679, 17703, 18247, 14537\nfeuerzeug_rauchzeug_licht_anzahl_schadenfalle : 127, 18, 125, 160, 83\nfeuerzeug_rauchzeug_licht_schaden_1000_chf : 127, 1304, 3884, 1042, 1203\nelektrizitaet_anzahl_schadenfalle : 252, 275, 91, 284, 291\nelektrizitaet_schaden_1000_chf : 1649, 473, 629, 4359, 6017\nvorsatzliche_brandstift_anzahl_schadenfalle : 27, 23, 83, 29, 24\nvorsatzliche_brandstift_schaden_1000_chf : 1708, 1229, 629, 905, 559\nfeuerungsanlagen_anzahl_schadenfalle : 59, 23, 29, 41, 85\nfeuerungsanlagen_schaden_1000_chf : 843, 1560, 473, 2228, 728\nexplosion_anzahl_schadenfalle : 94, 59, 23, 29, 28\nexplosion_schaden_1000_chf : 1640, 329, 498, 810, 681\nuebrige_anzahl_schadenfalle : 359, 1043, 566, 869, 176\nuebrige_schaden_1000_chf : 2455, 5907, 2911, 3191, 3759\nunbekannt_anzahl_schadenfalle : 97, 72, 29, 28, 57\nunbekannt_schaden_1000_chf : 5059, 8295, 6091, 5176, 4312\n*/\n\n/*\nColumn name, Column discription, Example values\ntotal_anzahl_schadenfalle, Total Anzahl Schadenfalle, 796681857\ntotal_schaden_1000_chf, Totale Schadensumme in 1000 CHF, 182472448024074\nfeuerzeug_rauchzeug_licht_anzahl_schadenfalle, None, 122123132\nfeuerzeug_rauchzeug_licht_schaden_1000_chf, None, 209525525078\nelektrizitaet_anzahl_schadenfalle, None, 234246228\nvorsatzliche_brandstift_schaden_1000_chf, None, 508360635374\nvorsatzliche_brandstift_anzahl_schadenfalle, None, 142225\nbrandstift_schaden_1000_chf, None, 2149632470\nfeuerungsanl_anzahl_schadenfalle, Feuerungsanlagen: Anzahl Schadenf\u00e4lle, 676547\nfeuerungsanl_schaden_1000_chf, Feuerungsanlagen: Totale Schadensumme in 1000 CHF, 15601231792\nexplosion_anzahl_schadenfalle, None, 262125\nexplosion_schaden_1000_chf, None, 7821180211\nuebrige_anzahl_schadenfalle, None, 269176342\nuebrige_schaden_1000_chf, None, 16449331734\nunbekannt_anzahl_schadenfalle, None, 512857\nunbekannt_schaden_1000_chf, None, 675118838678\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWie hoch waren die j\u00e4hrlichen Kosten in CHF f\u00fcr die durch Elektrizit\u00e4t und Explosionen verursachten Brandsch\u00e4den im Kanton Aargau in den Jahren 2001 bis 2007?\n### SQL query\nSELECT T.jahr, T.elektrizitaet_schaden_1000_chf * 1000 AS elektrizitaet_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2001\n    AND T.jahr <= 2007\nORDER BY T.jahr DESC;\n\n\n### Question\nWie viel Franken kosteten Brandeins\u00e4tze aus unbekannter Ursache im Aargau im Jahr 2020?\n### SQL query\nSELECT T.unbekannt_schaden_1000_chf * 1000 AS unbekannt_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2020;\n\n\n### Question\nWie viel Franken kosteten Brandeins\u00e4tze aus unbekannter Ursache im Aargau im Jahr 2020?\n### SQL query\nSELECT T.unbekannt_schaden_1000_chf * 1000 AS unbekannt_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2020;\n\n\n### Question\nWie viel Franken kosteten Brandeins\u00e4tze aus unbekannter Ursache im Aargau im Jahr 2020?\n### SQL query\nSELECT T.unbekannt_schaden_1000_chf * 1000 AS unbekannt_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2020;\n\n\n### Question\nWie hoch (in prozent) ist der Anteil unbekannter Ursachen an der Zahl der Brandf\u00e4lle im Aargau im Jahr 2018?\n### SQL query\nSELECT T.unbekannt_anzahl_schadenfalle * 100.0 / T.total_anzahl_schadenfalle AS unbekannt_anzahl_schadenfalle_prozent\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2018;\n\n\n### Question\nWie viele Brandstiftungen wurden von 1980 bis 2020 im Kanton Aargau insgesamt gemeldet?\n### SQL query\nSELECT SUM(T.vorsatzliche_brandstift_anzahl_schadenfalle)\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2020;\n\n### Question\nWie viele Explosionen und Brandstiftungen wurden im Jahr 2000 im Aargau registriert?\n### SQL query\nSELECT T.explosion_anzahl_schadenfalle, T.vorsatzliche_brandstift_anzahl_schadenfalle\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n\n\n### Question\nWelches waren die 3 h\u00e4ufigsten Ursachen f\u00fcr Brandf\u00e4lle im Aargau im Jahr 1985?\n### SQL query\n",
    "process_time": 17.18634799309075,
    "num_tokens": 2937,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 90,
    "question": "Wie hoch waren die j\u00e4hrlichen Kosten in CHF f\u00fcr die durch Elektrizit\u00e4t und Explosionen verursachten Brandsch\u00e4den im Kanton Aargau in den Jahren 2001 bis 2007?",
    "query": "SELECT T.jahr, T.elektrizitaet_schaden_1000_chf * 1000 AS elektrizitaet_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2001\n    AND T.jahr <= 2007\nORDER BY T.jahr DESC;\n",
    "db_id": "aargau_brandversicherung_brandschaden_anzahl_schadensummen",
    "generated_query": "SELECT T.jahr, (T.elektrizitaet_schaden_1000_chf + T.explosion_schaden_1000_chf) * 1000 AS kosten_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2001\n    AND T.jahr <= 2007\nORDER BY T.jahr;",
    "meta_data": [
      {
        "question": "In Prozent, wie hat sich die Zahl der Elektrobr\u00e4nde im Kanton Aargau von 1990 bis 2020 ver\u00e4ndert?",
        "query": "SELECT 100.0 * (T1.anzahl_2020 - T1.anzahl_1990) / T1.anzahl_1990 AS prozent_anderung_elektrizitaet_anzahl_schadenfalle_1990_2020\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 1990 THEN T.elektrizitaet_anzahl_schadenfalle ELSE 0 END) AS anzahl_1990,\n        SUM(CASE WHEN T.jahr = 2020 THEN T.elektrizitaet_anzahl_schadenfalle ELSE 0 END) AS anzahl_2020\n    FROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.canton = 'TRUE'\n        AND S.name LIKE '%Aargau%'\n        AND T.jahr IN (1990, 2020)\n) AS T1;\n"
      },
      {
        "question": "Wie viele Explosionen und Brandstiftungen wurden im Jahr 2000 im Aargau registriert?",
        "query": "SELECT T.explosion_anzahl_schadenfalle, T.vorsatzliche_brandstift_anzahl_schadenfalle\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n"
      },
      {
        "question": "Wie viele Brandstiftungen wurden von 1980 bis 2020 im Kanton Aargau insgesamt gemeldet?",
        "query": "SELECT SUM(T.vorsatzliche_brandstift_anzahl_schadenfalle)\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2020;"
      },
      {
        "question": "Wie hoch waren die j\u00e4hrlichen Kosten in CHF f\u00fcr die durch Elektrizit\u00e4t und Explosionen verursachten Brandsch\u00e4den im Kanton Aargau in den Jahren 2001 bis 2007?",
        "query": "SELECT T.jahr, T.elektrizitaet_schaden_1000_chf * 1000 AS elektrizitaet_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2001\n    AND T.jahr <= 2007\nORDER BY T.jahr DESC;\n"
      },
      {
        "question": "Wie viele Brandstiftungen wurden von 1980 bis 2020 im Kanton Aargau insgesamt gemeldet?",
        "query": "SELECT SUM(T.vorsatzliche_brandstift_anzahl_schadenfalle)\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2020;"
      },
      {
        "question": "In Prozent, wie hat sich die Zahl der Elektrobr\u00e4nde im Kanton Aargau von 1990 bis 2020 ver\u00e4ndert?",
        "query": "SELECT 100.0 * (T1.anzahl_2020 - T1.anzahl_1990) / T1.anzahl_1990 AS prozent_anderung_elektrizitaet_anzahl_schadenfalle_1990_2020\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 1990 THEN T.elektrizitaet_anzahl_schadenfalle ELSE 0 END) AS anzahl_1990,\n        SUM(CASE WHEN T.jahr = 2020 THEN T.elektrizitaet_anzahl_schadenfalle ELSE 0 END) AS anzahl_2020\n    FROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.canton = 'TRUE'\n        AND S.name LIKE '%Aargau%'\n        AND T.jahr IN (1990, 2020)\n) AS T1;\n"
      },
      {
        "question": "Wie viele Explosionen und Brandstiftungen wurden im Jahr 2000 im Aargau registriert?",
        "query": "SELECT T.explosion_anzahl_schadenfalle, T.vorsatzliche_brandstift_anzahl_schadenfalle\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.aargau_brandversicherung_brandschaden_anzahl_schadensummen (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\ttotal_anzahl_schadenfalle NUMERIC, \n\ttotal_schaden_1000_chf NUMERIC, \n\tfeuerzeug_rauchzeug_licht_anzahl_schadenfalle NUMERIC, \n\tfeuerzeug_rauchzeug_licht_schaden_1000_chf NUMERIC, \n\telektrizitaet_anzahl_schadenfalle NUMERIC, \n\telektrizitaet_schaden_1000_chf NUMERIC, \n\tvorsatzliche_brandstift_anzahl_schadenfalle NUMERIC, \n\tvorsatzliche_brandstift_schaden_1000_chf NUMERIC, \n\tfeuerungsanlagen_anzahl_schadenfalle NUMERIC, \n\tfeuerungsanlagen_schaden_1000_chf NUMERIC, \n\texplosion_anzahl_schadenfalle NUMERIC, \n\texplosion_schaden_1000_chf NUMERIC, \n\tuebrige_anzahl_schadenfalle NUMERIC, \n\tuebrige_schaden_1000_chf NUMERIC, \n\tunbekannt_anzahl_schadenfalle NUMERIC, \n\tunbekannt_schaden_1000_chf NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT aargau_brandversicherung_brandschaden_anzahl_schadensummen_pkey PRIMARY KEY (uid), \n\tCONSTRAINT aargau_brandversicherung_brandschaden_anza_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in aargau_brandversicherung_brandschaden_anzahl_schadensummen and 5 examples in each column for high cardinality columns :\nuid : 4, 27, 18, 23, 29\njahr : 2015, 1989, 2009, 2000, 2012\ntotal_anzahl_schadenfalle : 1565, 681, 1050, 964, 1104\ntotal_schaden_1000_chf : 6214, 15679, 17703, 18247, 14537\nfeuerzeug_rauchzeug_licht_anzahl_schadenfalle : 127, 18, 125, 160, 83\nfeuerzeug_rauchzeug_licht_schaden_1000_chf : 127, 1304, 3884, 1042, 1203\nelektrizitaet_anzahl_schadenfalle : 252, 275, 91, 284, 291\nelektrizitaet_schaden_1000_chf : 1649, 473, 629, 4359, 6017\nvorsatzliche_brandstift_anzahl_schadenfalle : 27, 23, 83, 29, 24\nvorsatzliche_brandstift_schaden_1000_chf : 1708, 1229, 629, 905, 559\nfeuerungsanlagen_anzahl_schadenfalle : 59, 23, 29, 41, 85\nfeuerungsanlagen_schaden_1000_chf : 843, 1560, 473, 2228, 728\nexplosion_anzahl_schadenfalle : 94, 59, 23, 29, 28\nexplosion_schaden_1000_chf : 1640, 329, 498, 810, 681\nuebrige_anzahl_schadenfalle : 359, 1043, 566, 869, 176\nuebrige_schaden_1000_chf : 2455, 5907, 2911, 3191, 3759\nunbekannt_anzahl_schadenfalle : 97, 72, 29, 28, 57\nunbekannt_schaden_1000_chf : 5059, 8295, 6091, 5176, 4312\n*/\n\n/*\nColumn name, Column discription, Example values\ntotal_anzahl_schadenfalle, Total Anzahl Schadenfalle, 796681857\ntotal_schaden_1000_chf, Totale Schadensumme in 1000 CHF, 182472448024074\nfeuerzeug_rauchzeug_licht_anzahl_schadenfalle, None, 122123132\nfeuerzeug_rauchzeug_licht_schaden_1000_chf, None, 209525525078\nelektrizitaet_anzahl_schadenfalle, None, 234246228\nvorsatzliche_brandstift_schaden_1000_chf, None, 508360635374\nvorsatzliche_brandstift_anzahl_schadenfalle, None, 142225\nbrandstift_schaden_1000_chf, None, 2149632470\nfeuerungsanl_anzahl_schadenfalle, Feuerungsanlagen: Anzahl Schadenf\u00e4lle, 676547\nfeuerungsanl_schaden_1000_chf, Feuerungsanlagen: Totale Schadensumme in 1000 CHF, 15601231792\nexplosion_anzahl_schadenfalle, None, 262125\nexplosion_schaden_1000_chf, None, 7821180211\nuebrige_anzahl_schadenfalle, None, 269176342\nuebrige_schaden_1000_chf, None, 16449331734\nunbekannt_anzahl_schadenfalle, None, 512857\nunbekannt_schaden_1000_chf, None, 675118838678\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nIn Prozent, wie hat sich die Zahl der Elektrobr\u00e4nde im Kanton Aargau von 1990 bis 2020 ver\u00e4ndert?\n### SQL query\nSELECT 100.0 * (T1.anzahl_2020 - T1.anzahl_1990) / T1.anzahl_1990 AS prozent_anderung_elektrizitaet_anzahl_schadenfalle_1990_2020\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 1990 THEN T.elektrizitaet_anzahl_schadenfalle ELSE 0 END) AS anzahl_1990,\n        SUM(CASE WHEN T.jahr = 2020 THEN T.elektrizitaet_anzahl_schadenfalle ELSE 0 END) AS anzahl_2020\n    FROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.canton = 'TRUE'\n        AND S.name LIKE '%Aargau%'\n        AND T.jahr IN (1990, 2020)\n) AS T1;\n\n\n### Question\nWie viele Explosionen und Brandstiftungen wurden im Jahr 2000 im Aargau registriert?\n### SQL query\nSELECT T.explosion_anzahl_schadenfalle, T.vorsatzliche_brandstift_anzahl_schadenfalle\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n\n\n### Question\nWie viele Brandstiftungen wurden von 1980 bis 2020 im Kanton Aargau insgesamt gemeldet?\n### SQL query\nSELECT SUM(T.vorsatzliche_brandstift_anzahl_schadenfalle)\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2020;\n\n### Question\nWie hoch waren die j\u00e4hrlichen Kosten in CHF f\u00fcr die durch Elektrizit\u00e4t und Explosionen verursachten Brandsch\u00e4den im Kanton Aargau in den Jahren 2001 bis 2007?\n### SQL query\nSELECT T.jahr, T.elektrizitaet_schaden_1000_chf * 1000 AS elektrizitaet_schaden_chf\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 2001\n    AND T.jahr <= 2007\nORDER BY T.jahr DESC;\n\n\n### Question\nWie viele Brandstiftungen wurden von 1980 bis 2020 im Kanton Aargau insgesamt gemeldet?\n### SQL query\nSELECT SUM(T.vorsatzliche_brandstift_anzahl_schadenfalle)\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2020;\n\n### Question\nIn Prozent, wie hat sich die Zahl der Elektrobr\u00e4nde im Kanton Aargau von 1990 bis 2020 ver\u00e4ndert?\n### SQL query\nSELECT 100.0 * (T1.anzahl_2020 - T1.anzahl_1990) / T1.anzahl_1990 AS prozent_anderung_elektrizitaet_anzahl_schadenfalle_1990_2020\nFROM (\n    SELECT\n        SUM(CASE WHEN T.jahr = 1990 THEN T.elektrizitaet_anzahl_schadenfalle ELSE 0 END) AS anzahl_1990,\n        SUM(CASE WHEN T.jahr = 2020 THEN T.elektrizitaet_anzahl_schadenfalle ELSE 0 END) AS anzahl_2020\n    FROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.canton = 'TRUE'\n        AND S.name LIKE '%Aargau%'\n        AND T.jahr IN (1990, 2020)\n) AS T1;\n\n\n### Question\nWie viele Explosionen und Brandstiftungen wurden im Jahr 2000 im Aargau registriert?\n### SQL query\nSELECT T.explosion_anzahl_schadenfalle, T.vorsatzliche_brandstift_anzahl_schadenfalle\nFROM aargau_brandversicherung_brandschaden_anzahl_schadensummen AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Aargau%'\n    AND T.jahr = 2000;\n\n\n### Question\nWie hoch waren die j\u00e4hrlichen Kosten in CHF f\u00fcr die durch Elektrizit\u00e4t und Explosionen verursachten Brandsch\u00e4den im Kanton Aargau in den Jahren 2001 bis 2007?\n### SQL query\n",
    "process_time": 12.895105921896175,
    "num_tokens": 3197,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 91,
    "question": "Wie setzt sich die erneuerbare Energieproduktion im Kanton Thurgau seit 2018 j\u00e4hrlich zusammen?",
    "query": "SELECT\n    T.jahr,\n    SUM(biogasanlagen_abwasser_gwh),\n    SUM(biogasanlagen_industrie_gwh),\n    SUM(biogasanlagen_landwirtschaft_gwh),\n    SUM(biomasse_holz_gwh),\n    SUM(kehricht_gwh),\n    SUM(photovoltaik_gwh),\n    SUM(wasserkraft_gwh),\n    SUM(wind_gwh),\n    SUM(total_gwh)\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr >= 2018\nGROUP BY T.jahr;\n",
    "db_id": "thurgau_erneuerbare_elektrizitatsproduktion_gemeinde",
    "generated_query": "SELECT T.jahr, \n       SUM(T.wasserkraft_gwh) AS wasserkraft,\n       SUM(T.biomasse_holz_gwh) AS biomasse_holz,\n       SUM(T.biogasanlagen_landwirtschaft_gwh) AS biogas_landwirtschaft,\n       SUM(T.kehricht_gwh) AS kehricht,\n       SUM(T.biogasanlagen_industrie_gwh) AS biogas_industrie,\n       SUM(T.biogasanlagen_abwasser_gwh) AS biogas_abwasser,\n       SUM(T.photovoltaik_gwh) AS photovoltaik,\n       SUM(T.wind_gwh) AS wind,\n       SUM(T.total_gwh) AS total\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr >= 2018\nGROUP BY T.jahr\nORDER BY T.jahr;",
    "meta_data": [
      {
        "question": "Wie hoch ist der Anteil der Gemeinden im Kanton Thurgau, die zwischen 2015 und 2021 einen R\u00fcckgang der Produktion von erneuerbaren Energien zu verzeichnen haben?",
        "query": "SELECT 100 * SUM(CASE WHEN T.total_gwh_2015 > T.total_gwh_2021 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_abnahme\nFROM (\n    SELECT\n        S.name,\n        SUM(CASE WHEN T.jahr = 2015 THEN T.total_gwh ELSE 0 END) AS total_gwh_2015,\n        SUM(CASE WHEN T.jahr = 2021 THEN T.total_gwh ELSE 0 END) AS total_gwh_2021\n    FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2015, 2021)\n    GROUP BY S.name\n) AS T;\n"
      },
      {
        "question": "Zeigen Sie mir die Produktion von Energie aus landwirtschaftlichem Biogas in Fischingen, Kanton Thurgau, im Jahr 2018.",
        "query": "SELECT T.biogasanlagen_landwirtschaft_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018\n    AND S.name IN ('Fischingen', 'Fischingen (TG)');\n"
      },
      {
        "question": "Wie viele MWh an erneuerbarer Energie hat Amriswil im Kanton Thurgau von 2016 bis 2020 insgesamt produziert?",
        "query": "SELECT SUM(T.total_gwh) * 1000 AS total_mwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Amriswil', 'Amriswil (TG)')\n    AND T.jahr >= 2016\n    AND T.jahr <= 2020;\n"
      },
      {
        "question": "Zeigen Sie mir 2 Aargauer Gemeinden, die im Jahr 2019 der wichtigste Produzent von Energie aus Holzbiomasse waren.",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n"
      },
      {
        "question": "Wie hoch ist der Anteil (in Prozent) der Thurgauer Gemeinden, die im Jahr 2017 keine erneuerbare Energie produziert haben?",
        "query": "SELECT 100 * SUM(CASE WHEN T.total_gwh = 0 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_kein_erneurerbare_energie_2017\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2017;\n"
      },
      {
        "question": "Wie hoch war die Produktion von Solarstrom in Roggwil und Langrickenbach TG in den Jahren 2019 und 2020?",
        "query": "SELECT S.name AS gemeinde, T.jahr, T.photovoltaik_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Roggwil', 'Roggwil (TG)', 'Langrickenbach', 'Langrickenbach (TG)')\n    AND T.jahr IN (2019, 2020)\nORDER BY S.name, T.jahr;"
      },
      {
        "question": "Wie viele MWh an erneuerbarer Energie hat Amriswil im Kanton Thurgau von 2016 bis 2020 insgesamt produziert?",
        "query": "SELECT SUM(T.total_gwh) * 1000 AS total_mwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Amriswil', 'Amriswil (TG)')\n    AND T.jahr >= 2016\n    AND T.jahr <= 2020;\n"
      },
      {
        "question": "Wie hoch ist die Gesamtmenge an erneuerbarer Energie aus der Kehrichtverbrennung im Kanton Thurgau im Jahr 2020?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n"
      },
      {
        "question": "Wie hoch ist der Anteil (in Prozent) der Thurgauer Gemeinden, die im Jahr 2017 keine erneuerbare Energie produziert haben?",
        "query": "SELECT 100 * SUM(CASE WHEN T.total_gwh = 0 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_kein_erneurerbare_energie_2017\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2017;\n"
      },
      {
        "question": "Zeigen Sie mir die Produktion von Energie aus landwirtschaftlichem Biogas in Fischingen, Kanton Thurgau, im Jahr 2018.",
        "query": "SELECT T.biogasanlagen_landwirtschaft_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018\n    AND S.name IN ('Fischingen', 'Fischingen (TG)');\n"
      },
      {
        "question": "Wie hoch ist der Anteil (in Prozent) der Thurgauer Gemeinden, die im Jahr 2017 keine erneuerbare Energie produziert haben?",
        "query": "SELECT 100 * SUM(CASE WHEN T.total_gwh = 0 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_kein_erneurerbare_energie_2017\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2017;\n"
      },
      {
        "question": "Wie hoch ist die Gesamtmenge an erneuerbarer Energie aus der Kehrichtverbrennung im Kanton Thurgau im Jahr 2020?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.thurgau_erneuerbare_elektrizitatsproduktion_gemeinde (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\teinwohner NUMERIC, \n\twasserkraft_gwh NUMERIC, \n\tbiomasse_holz_gwh NUMERIC, \n\tbiogasanlagen_landwirtschaft_gwh NUMERIC, \n\tkehricht_gwh NUMERIC, \n\tbiogasanlagen_industrie_gwh NUMERIC, \n\tbiogasanlagen_abwasser_gwh NUMERIC, \n\tphotovoltaik_gwh NUMERIC, \n\twind_gwh NUMERIC, \n\ttotal_gwh NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktion_gemeinde_pkey PRIMARY KEY (uid), \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktio_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in thurgau_erneuerbare_elektrizitatsproduktion_gemeinde and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\neinwohner : 839, 2560, 684, 3828, 1491\nwasserkraft_gwh : 11.333000000000000185, 13.227999999999999758, 0.021000000000000001, 1.782999999999999918, 0.246999999999999997\nbiogasanlagen_landwirtschaft_gwh : 1.245000000000000107, 2.202999999999999847, 1.729000000000000092, 1.465000000000000080, 0.163000000000000006\nbiogasanlagen_abwasser_gwh : 1.2190000000000000835, 0.1189999999999999947, 1.3160000000000000586, 0.0170000000000000012, 0.6750000000000000444\nphotovoltaik_gwh : 3.092999999999999972, 1.064000000000000057, 1.562999999999999945, 0.678000000000000047, 1.451999999999999957\ntotal_gwh : 3.794999999999999929, 1.064000000000000057, 3.232000000000000206, 9.948999999999999844, 6.251000000000000334\nspatialunit_uid : 4431_A.ADM3, 4806_A.ADM3, 4536_A.ADM3, 4446_A.ADM3, 4851_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\neinwohner, Einwohner, 2683,2318,1350\nwasserkraft_gwh, Wasserkraft, GWh, 0,1.234,6.698\nbiomasse_holz_gwh, Biomasse, Holz, GWh, 0,2.266,0.404\nbiogasanlagen_landwirtschaft_gwh, Biogasanlagen, Landwirtschaft, GWh, 0,4.826,0.308\nkehricht_gwh, Kehricht, GWh, 0,49.982734,57.317\nbiogasanlagen_industrie_gwh, Biogasanlagen, Industrie, GWh, 0,0.651573,1.819\nbiogasanlagen_abwasser_gwh, Biogasanlagen, Abwasser, GWh, 0,0.272,1.219\nphotovoltaik_gwh, Solarenergie, GWh, 3.814,1.879,4.268\nwind_gwh, Wind, GWh, 0,0.005,0.006\ntotal_gwh, Total, GWh, 3.814,1.879,9.094\n*/\n\n\n\n### Question\nWie hoch ist der Anteil der Gemeinden im Kanton Thurgau, die zwischen 2015 und 2021 einen R\u00fcckgang der Produktion von erneuerbaren Energien zu verzeichnen haben?\n### SQL query\nSELECT 100 * SUM(CASE WHEN T.total_gwh_2015 > T.total_gwh_2021 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_abnahme\nFROM (\n    SELECT\n        S.name,\n        SUM(CASE WHEN T.jahr = 2015 THEN T.total_gwh ELSE 0 END) AS total_gwh_2015,\n        SUM(CASE WHEN T.jahr = 2021 THEN T.total_gwh ELSE 0 END) AS total_gwh_2021\n    FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2015, 2021)\n    GROUP BY S.name\n) AS T;\n\n\n### Question\nZeigen Sie mir die Produktion von Energie aus landwirtschaftlichem Biogas in Fischingen, Kanton Thurgau, im Jahr 2018.\n### SQL query\nSELECT T.biogasanlagen_landwirtschaft_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018\n    AND S.name IN ('Fischingen', 'Fischingen (TG)');\n\n\n### Question\nWie viele MWh an erneuerbarer Energie hat Amriswil im Kanton Thurgau von 2016 bis 2020 insgesamt produziert?\n### SQL query\nSELECT SUM(T.total_gwh) * 1000 AS total_mwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Amriswil', 'Amriswil (TG)')\n    AND T.jahr >= 2016\n    AND T.jahr <= 2020;\n\n\n### Question\nZeigen Sie mir 2 Aargauer Gemeinden, die im Jahr 2019 der wichtigste Produzent von Energie aus Holzbiomasse waren.\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n\n\n### Question\nWie hoch ist der Anteil (in Prozent) der Thurgauer Gemeinden, die im Jahr 2017 keine erneuerbare Energie produziert haben?\n### SQL query\nSELECT 100 * SUM(CASE WHEN T.total_gwh = 0 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_kein_erneurerbare_energie_2017\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2017;\n\n\n### Question\nWie hoch war die Produktion von Solarstrom in Roggwil und Langrickenbach TG in den Jahren 2019 und 2020?\n### SQL query\nSELECT S.name AS gemeinde, T.jahr, T.photovoltaik_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Roggwil', 'Roggwil (TG)', 'Langrickenbach', 'Langrickenbach (TG)')\n    AND T.jahr IN (2019, 2020)\nORDER BY S.name, T.jahr;\n\n### Question\nWie viele MWh an erneuerbarer Energie hat Amriswil im Kanton Thurgau von 2016 bis 2020 insgesamt produziert?\n### SQL query\nSELECT SUM(T.total_gwh) * 1000 AS total_mwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Amriswil', 'Amriswil (TG)')\n    AND T.jahr >= 2016\n    AND T.jahr <= 2020;\n\n\n### Question\nWie hoch ist die Gesamtmenge an erneuerbarer Energie aus der Kehrichtverbrennung im Kanton Thurgau im Jahr 2020?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n\n\n### Question\nWie hoch ist der Anteil (in Prozent) der Thurgauer Gemeinden, die im Jahr 2017 keine erneuerbare Energie produziert haben?\n### SQL query\nSELECT 100 * SUM(CASE WHEN T.total_gwh = 0 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_kein_erneurerbare_energie_2017\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2017;\n\n\n### Question\nZeigen Sie mir die Produktion von Energie aus landwirtschaftlichem Biogas in Fischingen, Kanton Thurgau, im Jahr 2018.\n### SQL query\nSELECT T.biogasanlagen_landwirtschaft_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018\n    AND S.name IN ('Fischingen', 'Fischingen (TG)');\n\n\n### Question\nWie hoch ist der Anteil (in Prozent) der Thurgauer Gemeinden, die im Jahr 2017 keine erneuerbare Energie produziert haben?\n### SQL query\nSELECT 100 * SUM(CASE WHEN T.total_gwh = 0 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_kein_erneurerbare_energie_2017\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2017;\n\n\n### Question\nWie hoch ist die Gesamtmenge an erneuerbarer Energie aus der Kehrichtverbrennung im Kanton Thurgau im Jahr 2020?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n\n\n### Question\nWie setzt sich die erneuerbare Energieproduktion im Kanton Thurgau seit 2018 j\u00e4hrlich zusammen?\n### SQL query\n",
    "process_time": 13.78746439400129,
    "num_tokens": 3307,
    "hardness": "extra",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 92,
    "question": "Wie viel Prozent der erneuerbaren Energie in Frauenfeld TG wurde im Jahr 2021 durch Solarenergie erzeugt?",
    "query": "SELECT\n    100 * photovoltaik_gwh/total_gwh AS photovoltaik_prozent_frauenfeld_2021\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\n    AND S.name IN ('Frauenfeld', 'Frauenfeld (TG)');\n",
    "db_id": "thurgau_erneuerbare_elektrizitatsproduktion_gemeinde",
    "generated_query": "SELECT\n    100.0 * T.photovoltaik_gwh / T.total_gwh AS prozent_solarenergie\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Frauenfeld'\n    AND T.jahr = 2021;",
    "meta_data": [
      {
        "question": "Welche 3 Thurgauer Gemeinden hatten im Jahr 2019 den h\u00f6chsten Anteil an Wasserkraft an der gesamten erneuerbaren Energieproduktion und wie hoch war dieser?",
        "query": "SELECT\n    S.name AS gemeinde,\n    100.0 * T.wasserkraft_gwh / T.total_gwh AS prozent_wasserkraft\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY prozent_wasserkraft DESC\nLIMIT 3;\n"
      },
      {
        "question": "Welche 3 Thurgauer Gemeinden hatten im Jahr 2019 den h\u00f6chsten Anteil an Wasserkraft an der gesamten erneuerbaren Energieproduktion und wie hoch war dieser?",
        "query": "SELECT\n    S.name AS gemeinde,\n    100.0 * T.wasserkraft_gwh / T.total_gwh AS prozent_wasserkraft\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY prozent_wasserkraft DESC\nLIMIT 3;\n"
      },
      {
        "question": "Wie hoch war die Produktion von Solarstrom in Roggwil und Langrickenbach TG in den Jahren 2019 und 2020?",
        "query": "SELECT S.name AS gemeinde, T.jahr, T.photovoltaik_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Roggwil', 'Roggwil (TG)', 'Langrickenbach', 'Langrickenbach (TG)')\n    AND T.jahr IN (2019, 2020)\nORDER BY S.name, T.jahr;"
      },
      {
        "question": "Wie hoch ist die Gesamtmenge an erneuerbarer Energie aus der Kehrichtverbrennung im Kanton Thurgau im Jahr 2020?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n"
      },
      {
        "question": "Welche 3 Thurgauer Gemeinden hatten im Jahr 2019 den h\u00f6chsten Anteil an Wasserkraft an der gesamten erneuerbaren Energieproduktion und wie hoch war dieser?",
        "query": "SELECT\n    S.name AS gemeinde,\n    100.0 * T.wasserkraft_gwh / T.total_gwh AS prozent_wasserkraft\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY prozent_wasserkraft DESC\nLIMIT 3;\n"
      },
      {
        "question": "Wie hoch ist der Anteil (in Prozent) der Thurgauer Gemeinden, die im Jahr 2017 keine erneuerbare Energie produziert haben?",
        "query": "SELECT 100 * SUM(CASE WHEN T.total_gwh = 0 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_kein_erneurerbare_energie_2017\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2017;\n"
      },
      {
        "question": "Zeigen Sie mir 2 Aargauer Gemeinden, die im Jahr 2019 der wichtigste Produzent von Energie aus Holzbiomasse waren.",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n"
      },
      {
        "question": "Wie hoch ist der Anteil (in Prozent) der Thurgauer Gemeinden, die im Jahr 2017 keine erneuerbare Energie produziert haben?",
        "query": "SELECT 100 * SUM(CASE WHEN T.total_gwh = 0 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_kein_erneurerbare_energie_2017\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2017;\n"
      },
      {
        "question": "Wie hoch ist die Gesamtmenge an erneuerbarer Energie aus der Kehrichtverbrennung im Kanton Thurgau im Jahr 2020?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n"
      },
      {
        "question": "Zeigen Sie mir 2 Aargauer Gemeinden, die im Jahr 2019 der wichtigste Produzent von Energie aus Holzbiomasse waren.",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n"
      },
      {
        "question": "Wie hoch war die Produktion von Solarstrom in Roggwil und Langrickenbach TG in den Jahren 2019 und 2020?",
        "query": "SELECT S.name AS gemeinde, T.jahr, T.photovoltaik_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Roggwil', 'Roggwil (TG)', 'Langrickenbach', 'Langrickenbach (TG)')\n    AND T.jahr IN (2019, 2020)\nORDER BY S.name, T.jahr;"
      },
      {
        "question": "Welche Gemeinde im Kanton Thurgau produziert im Jahr 2020 im Verh\u00e4ltnis zur Einwohnerzahl am meisten erneuerbare Energie?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.total_gwh / T.einwohner DESC\nLIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.thurgau_erneuerbare_elektrizitatsproduktion_gemeinde (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\teinwohner NUMERIC, \n\twasserkraft_gwh NUMERIC, \n\tbiomasse_holz_gwh NUMERIC, \n\tbiogasanlagen_landwirtschaft_gwh NUMERIC, \n\tkehricht_gwh NUMERIC, \n\tbiogasanlagen_industrie_gwh NUMERIC, \n\tbiogasanlagen_abwasser_gwh NUMERIC, \n\tphotovoltaik_gwh NUMERIC, \n\twind_gwh NUMERIC, \n\ttotal_gwh NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktion_gemeinde_pkey PRIMARY KEY (uid), \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktio_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in thurgau_erneuerbare_elektrizitatsproduktion_gemeinde and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\neinwohner : 839, 2560, 684, 3828, 1491\nwasserkraft_gwh : 11.333000000000000185, 13.227999999999999758, 0.021000000000000001, 1.782999999999999918, 0.246999999999999997\nbiogasanlagen_landwirtschaft_gwh : 1.245000000000000107, 2.202999999999999847, 1.729000000000000092, 1.465000000000000080, 0.163000000000000006\nbiogasanlagen_abwasser_gwh : 1.2190000000000000835, 0.1189999999999999947, 1.3160000000000000586, 0.0170000000000000012, 0.6750000000000000444\nphotovoltaik_gwh : 3.092999999999999972, 1.064000000000000057, 1.562999999999999945, 0.678000000000000047, 1.451999999999999957\ntotal_gwh : 3.794999999999999929, 1.064000000000000057, 3.232000000000000206, 9.948999999999999844, 6.251000000000000334\nspatialunit_uid : 4431_A.ADM3, 4806_A.ADM3, 4536_A.ADM3, 4446_A.ADM3, 4851_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\neinwohner, Einwohner, 2683,2318,1350\nwasserkraft_gwh, Wasserkraft, GWh, 0,1.234,6.698\nbiomasse_holz_gwh, Biomasse, Holz, GWh, 0,2.266,0.404\nbiogasanlagen_landwirtschaft_gwh, Biogasanlagen, Landwirtschaft, GWh, 0,4.826,0.308\nkehricht_gwh, Kehricht, GWh, 0,49.982734,57.317\nbiogasanlagen_industrie_gwh, Biogasanlagen, Industrie, GWh, 0,0.651573,1.819\nbiogasanlagen_abwasser_gwh, Biogasanlagen, Abwasser, GWh, 0,0.272,1.219\nphotovoltaik_gwh, Solarenergie, GWh, 3.814,1.879,4.268\nwind_gwh, Wind, GWh, 0,0.005,0.006\ntotal_gwh, Total, GWh, 3.814,1.879,9.094\n*/\n\n\n\n### Question\nWelche 3 Thurgauer Gemeinden hatten im Jahr 2019 den h\u00f6chsten Anteil an Wasserkraft an der gesamten erneuerbaren Energieproduktion und wie hoch war dieser?\n### SQL query\nSELECT\n    S.name AS gemeinde,\n    100.0 * T.wasserkraft_gwh / T.total_gwh AS prozent_wasserkraft\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY prozent_wasserkraft DESC\nLIMIT 3;\n\n\n### Question\nWelche 3 Thurgauer Gemeinden hatten im Jahr 2019 den h\u00f6chsten Anteil an Wasserkraft an der gesamten erneuerbaren Energieproduktion und wie hoch war dieser?\n### SQL query\nSELECT\n    S.name AS gemeinde,\n    100.0 * T.wasserkraft_gwh / T.total_gwh AS prozent_wasserkraft\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY prozent_wasserkraft DESC\nLIMIT 3;\n\n\n### Question\nWie hoch war die Produktion von Solarstrom in Roggwil und Langrickenbach TG in den Jahren 2019 und 2020?\n### SQL query\nSELECT S.name AS gemeinde, T.jahr, T.photovoltaik_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Roggwil', 'Roggwil (TG)', 'Langrickenbach', 'Langrickenbach (TG)')\n    AND T.jahr IN (2019, 2020)\nORDER BY S.name, T.jahr;\n\n### Question\nWie hoch ist die Gesamtmenge an erneuerbarer Energie aus der Kehrichtverbrennung im Kanton Thurgau im Jahr 2020?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n\n\n### Question\nWelche 3 Thurgauer Gemeinden hatten im Jahr 2019 den h\u00f6chsten Anteil an Wasserkraft an der gesamten erneuerbaren Energieproduktion und wie hoch war dieser?\n### SQL query\nSELECT\n    S.name AS gemeinde,\n    100.0 * T.wasserkraft_gwh / T.total_gwh AS prozent_wasserkraft\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY prozent_wasserkraft DESC\nLIMIT 3;\n\n\n### Question\nWie hoch ist der Anteil (in Prozent) der Thurgauer Gemeinden, die im Jahr 2017 keine erneuerbare Energie produziert haben?\n### SQL query\nSELECT 100 * SUM(CASE WHEN T.total_gwh = 0 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_kein_erneurerbare_energie_2017\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2017;\n\n\n### Question\nZeigen Sie mir 2 Aargauer Gemeinden, die im Jahr 2019 der wichtigste Produzent von Energie aus Holzbiomasse waren.\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n\n\n### Question\nWie hoch ist der Anteil (in Prozent) der Thurgauer Gemeinden, die im Jahr 2017 keine erneuerbare Energie produziert haben?\n### SQL query\nSELECT 100 * SUM(CASE WHEN T.total_gwh = 0 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_kein_erneurerbare_energie_2017\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2017;\n\n\n### Question\nWie hoch ist die Gesamtmenge an erneuerbarer Energie aus der Kehrichtverbrennung im Kanton Thurgau im Jahr 2020?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n\n\n### Question\nZeigen Sie mir 2 Aargauer Gemeinden, die im Jahr 2019 der wichtigste Produzent von Energie aus Holzbiomasse waren.\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n\n\n### Question\nWie hoch war die Produktion von Solarstrom in Roggwil und Langrickenbach TG in den Jahren 2019 und 2020?\n### SQL query\nSELECT S.name AS gemeinde, T.jahr, T.photovoltaik_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Roggwil', 'Roggwil (TG)', 'Langrickenbach', 'Langrickenbach (TG)')\n    AND T.jahr IN (2019, 2020)\nORDER BY S.name, T.jahr;\n\n### Question\nWelche Gemeinde im Kanton Thurgau produziert im Jahr 2020 im Verh\u00e4ltnis zur Einwohnerzahl am meisten erneuerbare Energie?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.total_gwh / T.einwohner DESC\nLIMIT 1;\n\n\n### Question\nWie viel Prozent der erneuerbaren Energie in Frauenfeld TG wurde im Jahr 2021 durch Solarenergie erzeugt?\n### SQL query\n",
    "process_time": 5.696702846791595,
    "num_tokens": 3266,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 93,
    "question": "Wie viele Gemeinden im Kanton Thurgau produzierten im Jahr 2019 Energie aus Wind?",
    "query": "SELECT\n    COUNT(*) AS anzahl_gemeinden_wind_2019\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\n    AND T.wind_gwh > 0;\n",
    "db_id": "thurgau_erneuerbare_elektrizitatsproduktion_gemeinde",
    "generated_query": "SELECT COUNT(*) AS anzahl_gemeinden\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\n    AND T.wind_gwh > 0;",
    "meta_data": [
      {
        "question": "Zeigen Sie mir 2 Aargauer Gemeinden, die im Jahr 2019 der wichtigste Produzent von Energie aus Holzbiomasse waren.",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n"
      },
      {
        "question": "Wie hoch ist die Gesamtmenge an erneuerbarer Energie aus der Kehrichtverbrennung im Kanton Thurgau im Jahr 2020?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n"
      },
      {
        "question": "Wie hoch war die Produktion von Solarstrom in Roggwil und Langrickenbach TG in den Jahren 2019 und 2020?",
        "query": "SELECT S.name AS gemeinde, T.jahr, T.photovoltaik_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Roggwil', 'Roggwil (TG)', 'Langrickenbach', 'Langrickenbach (TG)')\n    AND T.jahr IN (2019, 2020)\nORDER BY S.name, T.jahr;"
      },
      {
        "question": "Zeigen Sie mir die Produktion von Energie aus landwirtschaftlichem Biogas in Fischingen, Kanton Thurgau, im Jahr 2018.",
        "query": "SELECT T.biogasanlagen_landwirtschaft_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018\n    AND S.name IN ('Fischingen', 'Fischingen (TG)');\n"
      },
      {
        "question": "Wie hoch ist der Anteil (in Prozent) der Thurgauer Gemeinden, die im Jahr 2017 keine erneuerbare Energie produziert haben?",
        "query": "SELECT 100 * SUM(CASE WHEN T.total_gwh = 0 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_kein_erneurerbare_energie_2017\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2017;\n"
      },
      {
        "question": "Welche 3 Thurgauer Gemeinden hatten im Jahr 2019 den h\u00f6chsten Anteil an Wasserkraft an der gesamten erneuerbaren Energieproduktion und wie hoch war dieser?",
        "query": "SELECT\n    S.name AS gemeinde,\n    100.0 * T.wasserkraft_gwh / T.total_gwh AS prozent_wasserkraft\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY prozent_wasserkraft DESC\nLIMIT 3;\n"
      },
      {
        "question": "Wie viele GWh Energie wurden im Jahr 2015 im Kanton Thurgau aus den einzelnen Biogasanlagentypen produziert?",
        "query": "SELECT\n    SUM(biogasanlagen_abwasser_gwh) AS biogasanlagen_abwasser_gwh_kanton_thurgau,\n    SUM(biogasanlagen_industrie_gwh) AS biogasanlagen_industrie_gwh_kanton_thurgau,\n    SUM(biogasanlagen_landwirtschaft_gwh) AS biogasanlagen_landwirtschaft_gwh_kanton_thurgau\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015;\n"
      },
      {
        "question": "Wie hoch war die Produktion von Solarstrom in Roggwil und Langrickenbach TG in den Jahren 2019 und 2020?",
        "query": "SELECT S.name AS gemeinde, T.jahr, T.photovoltaik_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Roggwil', 'Roggwil (TG)', 'Langrickenbach', 'Langrickenbach (TG)')\n    AND T.jahr IN (2019, 2020)\nORDER BY S.name, T.jahr;"
      },
      {
        "question": "Zeigen Sie mir 2 Aargauer Gemeinden, die im Jahr 2019 der wichtigste Produzent von Energie aus Holzbiomasse waren.",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n"
      },
      {
        "question": "Zeigen Sie mir 2 Aargauer Gemeinden, die im Jahr 2019 der wichtigste Produzent von Energie aus Holzbiomasse waren.",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n"
      },
      {
        "question": "Wie viel erneuerbare Energie wird in den 5 gr\u00f6ssten Thurgauer Gemeinden im Jahr 2021 produziert?",
        "query": "SELECT S.name AS gemeinde, T.total_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nORDER BY T.einwohner DESC\nLIMIT 5;\n"
      },
      {
        "question": "Wie hoch ist der Anteil (in Prozent) der Thurgauer Gemeinden, die im Jahr 2017 keine erneuerbare Energie produziert haben?",
        "query": "SELECT 100 * SUM(CASE WHEN T.total_gwh = 0 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_kein_erneurerbare_energie_2017\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2017;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.thurgau_erneuerbare_elektrizitatsproduktion_gemeinde (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\teinwohner NUMERIC, \n\twasserkraft_gwh NUMERIC, \n\tbiomasse_holz_gwh NUMERIC, \n\tbiogasanlagen_landwirtschaft_gwh NUMERIC, \n\tkehricht_gwh NUMERIC, \n\tbiogasanlagen_industrie_gwh NUMERIC, \n\tbiogasanlagen_abwasser_gwh NUMERIC, \n\tphotovoltaik_gwh NUMERIC, \n\twind_gwh NUMERIC, \n\ttotal_gwh NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktion_gemeinde_pkey PRIMARY KEY (uid), \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktio_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in thurgau_erneuerbare_elektrizitatsproduktion_gemeinde and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\neinwohner : 839, 2560, 684, 3828, 1491\nwasserkraft_gwh : 11.333000000000000185, 13.227999999999999758, 0.021000000000000001, 1.782999999999999918, 0.246999999999999997\nbiogasanlagen_landwirtschaft_gwh : 1.245000000000000107, 2.202999999999999847, 1.729000000000000092, 1.465000000000000080, 0.163000000000000006\nbiogasanlagen_abwasser_gwh : 1.2190000000000000835, 0.1189999999999999947, 1.3160000000000000586, 0.0170000000000000012, 0.6750000000000000444\nphotovoltaik_gwh : 3.092999999999999972, 1.064000000000000057, 1.562999999999999945, 0.678000000000000047, 1.451999999999999957\ntotal_gwh : 3.794999999999999929, 1.064000000000000057, 3.232000000000000206, 9.948999999999999844, 6.251000000000000334\nspatialunit_uid : 4431_A.ADM3, 4806_A.ADM3, 4536_A.ADM3, 4446_A.ADM3, 4851_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\neinwohner, Einwohner, 2683,2318,1350\nwasserkraft_gwh, Wasserkraft, GWh, 0,1.234,6.698\nbiomasse_holz_gwh, Biomasse, Holz, GWh, 0,2.266,0.404\nbiogasanlagen_landwirtschaft_gwh, Biogasanlagen, Landwirtschaft, GWh, 0,4.826,0.308\nkehricht_gwh, Kehricht, GWh, 0,49.982734,57.317\nbiogasanlagen_industrie_gwh, Biogasanlagen, Industrie, GWh, 0,0.651573,1.819\nbiogasanlagen_abwasser_gwh, Biogasanlagen, Abwasser, GWh, 0,0.272,1.219\nphotovoltaik_gwh, Solarenergie, GWh, 3.814,1.879,4.268\nwind_gwh, Wind, GWh, 0,0.005,0.006\ntotal_gwh, Total, GWh, 3.814,1.879,9.094\n*/\n\n\n\n### Question\nZeigen Sie mir 2 Aargauer Gemeinden, die im Jahr 2019 der wichtigste Produzent von Energie aus Holzbiomasse waren.\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n\n\n### Question\nWie hoch ist die Gesamtmenge an erneuerbarer Energie aus der Kehrichtverbrennung im Kanton Thurgau im Jahr 2020?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n\n\n### Question\nWie hoch war die Produktion von Solarstrom in Roggwil und Langrickenbach TG in den Jahren 2019 und 2020?\n### SQL query\nSELECT S.name AS gemeinde, T.jahr, T.photovoltaik_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Roggwil', 'Roggwil (TG)', 'Langrickenbach', 'Langrickenbach (TG)')\n    AND T.jahr IN (2019, 2020)\nORDER BY S.name, T.jahr;\n\n### Question\nZeigen Sie mir die Produktion von Energie aus landwirtschaftlichem Biogas in Fischingen, Kanton Thurgau, im Jahr 2018.\n### SQL query\nSELECT T.biogasanlagen_landwirtschaft_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018\n    AND S.name IN ('Fischingen', 'Fischingen (TG)');\n\n\n### Question\nWie hoch ist der Anteil (in Prozent) der Thurgauer Gemeinden, die im Jahr 2017 keine erneuerbare Energie produziert haben?\n### SQL query\nSELECT 100 * SUM(CASE WHEN T.total_gwh = 0 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_kein_erneurerbare_energie_2017\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2017;\n\n\n### Question\nWelche 3 Thurgauer Gemeinden hatten im Jahr 2019 den h\u00f6chsten Anteil an Wasserkraft an der gesamten erneuerbaren Energieproduktion und wie hoch war dieser?\n### SQL query\nSELECT\n    S.name AS gemeinde,\n    100.0 * T.wasserkraft_gwh / T.total_gwh AS prozent_wasserkraft\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY prozent_wasserkraft DESC\nLIMIT 3;\n\n\n### Question\nWie viele GWh Energie wurden im Jahr 2015 im Kanton Thurgau aus den einzelnen Biogasanlagentypen produziert?\n### SQL query\nSELECT\n    SUM(biogasanlagen_abwasser_gwh) AS biogasanlagen_abwasser_gwh_kanton_thurgau,\n    SUM(biogasanlagen_industrie_gwh) AS biogasanlagen_industrie_gwh_kanton_thurgau,\n    SUM(biogasanlagen_landwirtschaft_gwh) AS biogasanlagen_landwirtschaft_gwh_kanton_thurgau\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015;\n\n\n### Question\nWie hoch war die Produktion von Solarstrom in Roggwil und Langrickenbach TG in den Jahren 2019 und 2020?\n### SQL query\nSELECT S.name AS gemeinde, T.jahr, T.photovoltaik_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Roggwil', 'Roggwil (TG)', 'Langrickenbach', 'Langrickenbach (TG)')\n    AND T.jahr IN (2019, 2020)\nORDER BY S.name, T.jahr;\n\n### Question\nZeigen Sie mir 2 Aargauer Gemeinden, die im Jahr 2019 der wichtigste Produzent von Energie aus Holzbiomasse waren.\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n\n\n### Question\nZeigen Sie mir 2 Aargauer Gemeinden, die im Jahr 2019 der wichtigste Produzent von Energie aus Holzbiomasse waren.\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n\n\n### Question\nWie viel erneuerbare Energie wird in den 5 gr\u00f6ssten Thurgauer Gemeinden im Jahr 2021 produziert?\n### SQL query\nSELECT S.name AS gemeinde, T.total_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nORDER BY T.einwohner DESC\nLIMIT 5;\n\n\n### Question\nWie hoch ist der Anteil (in Prozent) der Thurgauer Gemeinden, die im Jahr 2017 keine erneuerbare Energie produziert haben?\n### SQL query\nSELECT 100 * SUM(CASE WHEN T.total_gwh = 0 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_kein_erneurerbare_energie_2017\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2017;\n\n\n### Question\nWie viele Gemeinden im Kanton Thurgau produzierten im Jahr 2019 Energie aus Wind?\n### SQL query\n",
    "process_time": 8.109615784836933,
    "num_tokens": 3239,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 94,
    "question": "Welche 3 Thurgauer Gemeinden weisen zwischen 2018 und 2021 den gr\u00f6ssten Zuwachs an erneuerbarer Energieproduktion auf? Geben Sie auch den prozentualen Anstieg an.",
    "query": "SELECT\n    S.name AS gemeinde,\n    (\n        100.0 * SUM( CASE WHEN T.jahr = 2021 THEN T.total_gwh ELSE 0 END) /\n        SUM( CASE WHEN T.jahr = 2018 THEN T.total_gwh ELSE 0 END\n    )) AS prozent_anstieg\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2018, 2021)\nGROUP BY S.name\nORDER BY prozent_anstieg DESC\nLIMIT 3;\n",
    "db_id": "thurgau_erneuerbare_elektrizitatsproduktion_gemeinde",
    "generated_query": "SELECT\n    S.name AS gemeinde,\n    (T.total_gwh_2021 - T.total_gwh_2018) AS zuwachs_gwh,\n    100 * ((T.total_gwh_2021 - T.total_gwh_2018) / T.total_gwh_2018) AS prozentualer_zuwachs\nFROM (\n    SELECT\n        S.name,\n        SUM(CASE WHEN T.jahr = 2018 THEN T.total_gwh ELSE 0 END) AS total_gwh_2018,\n        SUM(CASE WHEN T.jahr = 2021 THEN T.total_gwh ELSE 0 END) AS total_gwh_2021\n    FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2018, 2021)\n    GROUP BY S.name\n) AS T\nORDER BY zuwachs_gwh DESC\nLIMIT 3;",
    "meta_data": [
      {
        "question": "Zeigen Sie mir die Produktion von Energie aus landwirtschaftlichem Biogas in Fischingen, Kanton Thurgau, im Jahr 2018.",
        "query": "SELECT T.biogasanlagen_landwirtschaft_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018\n    AND S.name IN ('Fischingen', 'Fischingen (TG)');\n"
      },
      {
        "question": "Wie hoch ist die Gesamtmenge an erneuerbarer Energie aus der Kehrichtverbrennung im Kanton Thurgau im Jahr 2020?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n"
      },
      {
        "question": "Welche war die kleinste Gemeinde (in Einwohnern), die im Jahr 2021 im Kanton Thurgau Energie aus der Kehrichtverbrennung produzierte?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\n    AND T.kehricht_gwh > 0\nORDER BY T.einwohner ASC\nLIMIT 1;\n"
      },
      {
        "question": "Welche war die kleinste Gemeinde (in Einwohnern), die im Jahr 2021 im Kanton Thurgau Energie aus der Kehrichtverbrennung produzierte?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\n    AND T.kehricht_gwh > 0\nORDER BY T.einwohner ASC\nLIMIT 1;\n"
      },
      {
        "question": "Welche war die kleinste Gemeinde (in Einwohnern), die im Jahr 2021 im Kanton Thurgau Energie aus der Kehrichtverbrennung produzierte?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\n    AND T.kehricht_gwh > 0\nORDER BY T.einwohner ASC\nLIMIT 1;\n"
      },
      {
        "question": "Welche Gemeinde im Kanton Thurgau produziert im Jahr 2020 im Verh\u00e4ltnis zur Einwohnerzahl am meisten erneuerbare Energie?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.total_gwh / T.einwohner DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wie hoch ist der Anteil der Gemeinden im Kanton Thurgau, die zwischen 2015 und 2021 einen R\u00fcckgang der Produktion von erneuerbaren Energien zu verzeichnen haben?",
        "query": "SELECT 100 * SUM(CASE WHEN T.total_gwh_2015 > T.total_gwh_2021 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_abnahme\nFROM (\n    SELECT\n        S.name,\n        SUM(CASE WHEN T.jahr = 2015 THEN T.total_gwh ELSE 0 END) AS total_gwh_2015,\n        SUM(CASE WHEN T.jahr = 2021 THEN T.total_gwh ELSE 0 END) AS total_gwh_2021\n    FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2015, 2021)\n    GROUP BY S.name\n) AS T;\n"
      },
      {
        "question": "Wie viel erneuerbare Energie wird in den 5 gr\u00f6ssten Thurgauer Gemeinden im Jahr 2021 produziert?",
        "query": "SELECT S.name AS gemeinde, T.total_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nORDER BY T.einwohner DESC\nLIMIT 5;\n"
      },
      {
        "question": "Wie hoch ist der Anteil (in Prozent) der Thurgauer Gemeinden, die im Jahr 2017 keine erneuerbare Energie produziert haben?",
        "query": "SELECT 100 * SUM(CASE WHEN T.total_gwh = 0 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_kein_erneurerbare_energie_2017\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2017;\n"
      },
      {
        "question": "Wie viele GWh Energie wurden im Jahr 2015 im Kanton Thurgau aus den einzelnen Biogasanlagentypen produziert?",
        "query": "SELECT\n    SUM(biogasanlagen_abwasser_gwh) AS biogasanlagen_abwasser_gwh_kanton_thurgau,\n    SUM(biogasanlagen_industrie_gwh) AS biogasanlagen_industrie_gwh_kanton_thurgau,\n    SUM(biogasanlagen_landwirtschaft_gwh) AS biogasanlagen_landwirtschaft_gwh_kanton_thurgau\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015;\n"
      },
      {
        "question": "Welche Gemeinde im Kanton Thurgau produziert im Jahr 2020 im Verh\u00e4ltnis zur Einwohnerzahl am meisten erneuerbare Energie?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.total_gwh / T.einwohner DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wie hoch ist der Anteil der Gemeinden im Kanton Thurgau, die zwischen 2015 und 2021 einen R\u00fcckgang der Produktion von erneuerbaren Energien zu verzeichnen haben?",
        "query": "SELECT 100 * SUM(CASE WHEN T.total_gwh_2015 > T.total_gwh_2021 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_abnahme\nFROM (\n    SELECT\n        S.name,\n        SUM(CASE WHEN T.jahr = 2015 THEN T.total_gwh ELSE 0 END) AS total_gwh_2015,\n        SUM(CASE WHEN T.jahr = 2021 THEN T.total_gwh ELSE 0 END) AS total_gwh_2021\n    FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2015, 2021)\n    GROUP BY S.name\n) AS T;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.thurgau_erneuerbare_elektrizitatsproduktion_gemeinde (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\teinwohner NUMERIC, \n\twasserkraft_gwh NUMERIC, \n\tbiomasse_holz_gwh NUMERIC, \n\tbiogasanlagen_landwirtschaft_gwh NUMERIC, \n\tkehricht_gwh NUMERIC, \n\tbiogasanlagen_industrie_gwh NUMERIC, \n\tbiogasanlagen_abwasser_gwh NUMERIC, \n\tphotovoltaik_gwh NUMERIC, \n\twind_gwh NUMERIC, \n\ttotal_gwh NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktion_gemeinde_pkey PRIMARY KEY (uid), \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktio_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in thurgau_erneuerbare_elektrizitatsproduktion_gemeinde and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\neinwohner : 839, 2560, 684, 3828, 1491\nwasserkraft_gwh : 11.333000000000000185, 13.227999999999999758, 0.021000000000000001, 1.782999999999999918, 0.246999999999999997\nbiogasanlagen_landwirtschaft_gwh : 1.245000000000000107, 2.202999999999999847, 1.729000000000000092, 1.465000000000000080, 0.163000000000000006\nbiogasanlagen_abwasser_gwh : 1.2190000000000000835, 0.1189999999999999947, 1.3160000000000000586, 0.0170000000000000012, 0.6750000000000000444\nphotovoltaik_gwh : 3.092999999999999972, 1.064000000000000057, 1.562999999999999945, 0.678000000000000047, 1.451999999999999957\ntotal_gwh : 3.794999999999999929, 1.064000000000000057, 3.232000000000000206, 9.948999999999999844, 6.251000000000000334\nspatialunit_uid : 4431_A.ADM3, 4806_A.ADM3, 4536_A.ADM3, 4446_A.ADM3, 4851_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\neinwohner, Einwohner, 2683,2318,1350\nwasserkraft_gwh, Wasserkraft, GWh, 0,1.234,6.698\nbiomasse_holz_gwh, Biomasse, Holz, GWh, 0,2.266,0.404\nbiogasanlagen_landwirtschaft_gwh, Biogasanlagen, Landwirtschaft, GWh, 0,4.826,0.308\nkehricht_gwh, Kehricht, GWh, 0,49.982734,57.317\nbiogasanlagen_industrie_gwh, Biogasanlagen, Industrie, GWh, 0,0.651573,1.819\nbiogasanlagen_abwasser_gwh, Biogasanlagen, Abwasser, GWh, 0,0.272,1.219\nphotovoltaik_gwh, Solarenergie, GWh, 3.814,1.879,4.268\nwind_gwh, Wind, GWh, 0,0.005,0.006\ntotal_gwh, Total, GWh, 3.814,1.879,9.094\n*/\n\n\n\n### Question\nZeigen Sie mir die Produktion von Energie aus landwirtschaftlichem Biogas in Fischingen, Kanton Thurgau, im Jahr 2018.\n### SQL query\nSELECT T.biogasanlagen_landwirtschaft_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018\n    AND S.name IN ('Fischingen', 'Fischingen (TG)');\n\n\n### Question\nWie hoch ist die Gesamtmenge an erneuerbarer Energie aus der Kehrichtverbrennung im Kanton Thurgau im Jahr 2020?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n\n\n### Question\nWelche war die kleinste Gemeinde (in Einwohnern), die im Jahr 2021 im Kanton Thurgau Energie aus der Kehrichtverbrennung produzierte?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\n    AND T.kehricht_gwh > 0\nORDER BY T.einwohner ASC\nLIMIT 1;\n\n\n### Question\nWelche war die kleinste Gemeinde (in Einwohnern), die im Jahr 2021 im Kanton Thurgau Energie aus der Kehrichtverbrennung produzierte?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\n    AND T.kehricht_gwh > 0\nORDER BY T.einwohner ASC\nLIMIT 1;\n\n\n### Question\nWelche war die kleinste Gemeinde (in Einwohnern), die im Jahr 2021 im Kanton Thurgau Energie aus der Kehrichtverbrennung produzierte?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\n    AND T.kehricht_gwh > 0\nORDER BY T.einwohner ASC\nLIMIT 1;\n\n\n### Question\nWelche Gemeinde im Kanton Thurgau produziert im Jahr 2020 im Verh\u00e4ltnis zur Einwohnerzahl am meisten erneuerbare Energie?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.total_gwh / T.einwohner DESC\nLIMIT 1;\n\n\n### Question\nWie hoch ist der Anteil der Gemeinden im Kanton Thurgau, die zwischen 2015 und 2021 einen R\u00fcckgang der Produktion von erneuerbaren Energien zu verzeichnen haben?\n### SQL query\nSELECT 100 * SUM(CASE WHEN T.total_gwh_2015 > T.total_gwh_2021 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_abnahme\nFROM (\n    SELECT\n        S.name,\n        SUM(CASE WHEN T.jahr = 2015 THEN T.total_gwh ELSE 0 END) AS total_gwh_2015,\n        SUM(CASE WHEN T.jahr = 2021 THEN T.total_gwh ELSE 0 END) AS total_gwh_2021\n    FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2015, 2021)\n    GROUP BY S.name\n) AS T;\n\n\n### Question\nWie viel erneuerbare Energie wird in den 5 gr\u00f6ssten Thurgauer Gemeinden im Jahr 2021 produziert?\n### SQL query\nSELECT S.name AS gemeinde, T.total_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nORDER BY T.einwohner DESC\nLIMIT 5;\n\n\n### Question\nWie hoch ist der Anteil (in Prozent) der Thurgauer Gemeinden, die im Jahr 2017 keine erneuerbare Energie produziert haben?\n### SQL query\nSELECT 100 * SUM(CASE WHEN T.total_gwh = 0 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_kein_erneurerbare_energie_2017\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2017;\n\n\n### Question\nWie viele GWh Energie wurden im Jahr 2015 im Kanton Thurgau aus den einzelnen Biogasanlagentypen produziert?\n### SQL query\nSELECT\n    SUM(biogasanlagen_abwasser_gwh) AS biogasanlagen_abwasser_gwh_kanton_thurgau,\n    SUM(biogasanlagen_industrie_gwh) AS biogasanlagen_industrie_gwh_kanton_thurgau,\n    SUM(biogasanlagen_landwirtschaft_gwh) AS biogasanlagen_landwirtschaft_gwh_kanton_thurgau\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015;\n\n\n### Question\nWelche Gemeinde im Kanton Thurgau produziert im Jahr 2020 im Verh\u00e4ltnis zur Einwohnerzahl am meisten erneuerbare Energie?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.total_gwh / T.einwohner DESC\nLIMIT 1;\n\n\n### Question\nWie hoch ist der Anteil der Gemeinden im Kanton Thurgau, die zwischen 2015 und 2021 einen R\u00fcckgang der Produktion von erneuerbaren Energien zu verzeichnen haben?\n### SQL query\nSELECT 100 * SUM(CASE WHEN T.total_gwh_2015 > T.total_gwh_2021 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_abnahme\nFROM (\n    SELECT\n        S.name,\n        SUM(CASE WHEN T.jahr = 2015 THEN T.total_gwh ELSE 0 END) AS total_gwh_2015,\n        SUM(CASE WHEN T.jahr = 2021 THEN T.total_gwh ELSE 0 END) AS total_gwh_2021\n    FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2015, 2021)\n    GROUP BY S.name\n) AS T;\n\n\n### Question\nWelche 3 Thurgauer Gemeinden weisen zwischen 2018 und 2021 den gr\u00f6ssten Zuwachs an erneuerbarer Energieproduktion auf? Geben Sie auch den prozentualen Anstieg an.\n### SQL query\n",
    "process_time": 15.899567098123953,
    "num_tokens": 3456,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 95,
    "question": "Wie viel erneuerbare Energie hat der Kanton Thurgau im Zeitraum 2017-2021 insgesamt produziert?",
    "query": "SELECT SUM(T.total_gwh) AS total_gwh_2017_2021\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nWHERE T.jahr >= 2017\n    AND T.jahr <= 2021;\n",
    "db_id": "thurgau_erneuerbare_elektrizitatsproduktion_gemeinde",
    "generated_query": "SELECT SUM(T.total_gwh) AS total_erneuerbare_energie\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr >= 2017\n    AND T.jahr <= 2021;",
    "meta_data": [
      {
        "question": "Wie viel erneuerbare Energie wird in den 5 gr\u00f6ssten Thurgauer Gemeinden im Jahr 2021 produziert?",
        "query": "SELECT S.name AS gemeinde, T.total_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nORDER BY T.einwohner DESC\nLIMIT 5;\n"
      },
      {
        "question": "Wie viel erneuerbare Energie wird in den 5 gr\u00f6ssten Thurgauer Gemeinden im Jahr 2021 produziert?",
        "query": "SELECT S.name AS gemeinde, T.total_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nORDER BY T.einwohner DESC\nLIMIT 5;\n"
      },
      {
        "question": "Zeigen Sie mir die Produktion von Energie aus landwirtschaftlichem Biogas in Fischingen, Kanton Thurgau, im Jahr 2018.",
        "query": "SELECT T.biogasanlagen_landwirtschaft_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018\n    AND S.name IN ('Fischingen', 'Fischingen (TG)');\n"
      },
      {
        "question": "Wie viele MWh an erneuerbarer Energie hat Amriswil im Kanton Thurgau von 2016 bis 2020 insgesamt produziert?",
        "query": "SELECT SUM(T.total_gwh) * 1000 AS total_mwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Amriswil', 'Amriswil (TG)')\n    AND T.jahr >= 2016\n    AND T.jahr <= 2020;\n"
      },
      {
        "question": "Wie hoch ist der Anteil (in Prozent) der Thurgauer Gemeinden, die im Jahr 2017 keine erneuerbare Energie produziert haben?",
        "query": "SELECT 100 * SUM(CASE WHEN T.total_gwh = 0 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_kein_erneurerbare_energie_2017\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2017;\n"
      },
      {
        "question": "Zeigen Sie mir die Produktion von Energie aus landwirtschaftlichem Biogas in Fischingen, Kanton Thurgau, im Jahr 2018.",
        "query": "SELECT T.biogasanlagen_landwirtschaft_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018\n    AND S.name IN ('Fischingen', 'Fischingen (TG)');\n"
      },
      {
        "question": "Welche Gemeinde im Kanton Thurgau produziert im Jahr 2020 im Verh\u00e4ltnis zur Einwohnerzahl am meisten erneuerbare Energie?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.total_gwh / T.einwohner DESC\nLIMIT 1;\n"
      },
      {
        "question": "Zeigen Sie mir die Produktion von Energie aus landwirtschaftlichem Biogas in Fischingen, Kanton Thurgau, im Jahr 2018.",
        "query": "SELECT T.biogasanlagen_landwirtschaft_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018\n    AND S.name IN ('Fischingen', 'Fischingen (TG)');\n"
      },
      {
        "question": "Wie hoch ist der Anteil (in Prozent) der Thurgauer Gemeinden, die im Jahr 2017 keine erneuerbare Energie produziert haben?",
        "query": "SELECT 100 * SUM(CASE WHEN T.total_gwh = 0 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_kein_erneurerbare_energie_2017\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2017;\n"
      },
      {
        "question": "Wie hoch ist der Anteil (in Prozent) der Thurgauer Gemeinden, die im Jahr 2017 keine erneuerbare Energie produziert haben?",
        "query": "SELECT 100 * SUM(CASE WHEN T.total_gwh = 0 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_kein_erneurerbare_energie_2017\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2017;\n"
      },
      {
        "question": "Wie viele MWh an erneuerbarer Energie hat Amriswil im Kanton Thurgau von 2016 bis 2020 insgesamt produziert?",
        "query": "SELECT SUM(T.total_gwh) * 1000 AS total_mwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Amriswil', 'Amriswil (TG)')\n    AND T.jahr >= 2016\n    AND T.jahr <= 2020;\n"
      },
      {
        "question": "Wie viel erneuerbare Energie wird in den 5 gr\u00f6ssten Thurgauer Gemeinden im Jahr 2021 produziert?",
        "query": "SELECT S.name AS gemeinde, T.total_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nORDER BY T.einwohner DESC\nLIMIT 5;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.thurgau_erneuerbare_elektrizitatsproduktion_gemeinde (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\teinwohner NUMERIC, \n\twasserkraft_gwh NUMERIC, \n\tbiomasse_holz_gwh NUMERIC, \n\tbiogasanlagen_landwirtschaft_gwh NUMERIC, \n\tkehricht_gwh NUMERIC, \n\tbiogasanlagen_industrie_gwh NUMERIC, \n\tbiogasanlagen_abwasser_gwh NUMERIC, \n\tphotovoltaik_gwh NUMERIC, \n\twind_gwh NUMERIC, \n\ttotal_gwh NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktion_gemeinde_pkey PRIMARY KEY (uid), \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktio_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in thurgau_erneuerbare_elektrizitatsproduktion_gemeinde and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\neinwohner : 839, 2560, 684, 3828, 1491\nwasserkraft_gwh : 11.333000000000000185, 13.227999999999999758, 0.021000000000000001, 1.782999999999999918, 0.246999999999999997\nbiogasanlagen_landwirtschaft_gwh : 1.245000000000000107, 2.202999999999999847, 1.729000000000000092, 1.465000000000000080, 0.163000000000000006\nbiogasanlagen_abwasser_gwh : 1.2190000000000000835, 0.1189999999999999947, 1.3160000000000000586, 0.0170000000000000012, 0.6750000000000000444\nphotovoltaik_gwh : 3.092999999999999972, 1.064000000000000057, 1.562999999999999945, 0.678000000000000047, 1.451999999999999957\ntotal_gwh : 3.794999999999999929, 1.064000000000000057, 3.232000000000000206, 9.948999999999999844, 6.251000000000000334\nspatialunit_uid : 4431_A.ADM3, 4806_A.ADM3, 4536_A.ADM3, 4446_A.ADM3, 4851_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\neinwohner, Einwohner, 2683,2318,1350\nwasserkraft_gwh, Wasserkraft, GWh, 0,1.234,6.698\nbiomasse_holz_gwh, Biomasse, Holz, GWh, 0,2.266,0.404\nbiogasanlagen_landwirtschaft_gwh, Biogasanlagen, Landwirtschaft, GWh, 0,4.826,0.308\nkehricht_gwh, Kehricht, GWh, 0,49.982734,57.317\nbiogasanlagen_industrie_gwh, Biogasanlagen, Industrie, GWh, 0,0.651573,1.819\nbiogasanlagen_abwasser_gwh, Biogasanlagen, Abwasser, GWh, 0,0.272,1.219\nphotovoltaik_gwh, Solarenergie, GWh, 3.814,1.879,4.268\nwind_gwh, Wind, GWh, 0,0.005,0.006\ntotal_gwh, Total, GWh, 3.814,1.879,9.094\n*/\n\n\n\n### Question\nWie viel erneuerbare Energie wird in den 5 gr\u00f6ssten Thurgauer Gemeinden im Jahr 2021 produziert?\n### SQL query\nSELECT S.name AS gemeinde, T.total_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nORDER BY T.einwohner DESC\nLIMIT 5;\n\n\n### Question\nWie viel erneuerbare Energie wird in den 5 gr\u00f6ssten Thurgauer Gemeinden im Jahr 2021 produziert?\n### SQL query\nSELECT S.name AS gemeinde, T.total_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nORDER BY T.einwohner DESC\nLIMIT 5;\n\n\n### Question\nZeigen Sie mir die Produktion von Energie aus landwirtschaftlichem Biogas in Fischingen, Kanton Thurgau, im Jahr 2018.\n### SQL query\nSELECT T.biogasanlagen_landwirtschaft_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018\n    AND S.name IN ('Fischingen', 'Fischingen (TG)');\n\n\n### Question\nWie viele MWh an erneuerbarer Energie hat Amriswil im Kanton Thurgau von 2016 bis 2020 insgesamt produziert?\n### SQL query\nSELECT SUM(T.total_gwh) * 1000 AS total_mwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Amriswil', 'Amriswil (TG)')\n    AND T.jahr >= 2016\n    AND T.jahr <= 2020;\n\n\n### Question\nWie hoch ist der Anteil (in Prozent) der Thurgauer Gemeinden, die im Jahr 2017 keine erneuerbare Energie produziert haben?\n### SQL query\nSELECT 100 * SUM(CASE WHEN T.total_gwh = 0 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_kein_erneurerbare_energie_2017\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2017;\n\n\n### Question\nZeigen Sie mir die Produktion von Energie aus landwirtschaftlichem Biogas in Fischingen, Kanton Thurgau, im Jahr 2018.\n### SQL query\nSELECT T.biogasanlagen_landwirtschaft_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018\n    AND S.name IN ('Fischingen', 'Fischingen (TG)');\n\n\n### Question\nWelche Gemeinde im Kanton Thurgau produziert im Jahr 2020 im Verh\u00e4ltnis zur Einwohnerzahl am meisten erneuerbare Energie?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.total_gwh / T.einwohner DESC\nLIMIT 1;\n\n\n### Question\nZeigen Sie mir die Produktion von Energie aus landwirtschaftlichem Biogas in Fischingen, Kanton Thurgau, im Jahr 2018.\n### SQL query\nSELECT T.biogasanlagen_landwirtschaft_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2018\n    AND S.name IN ('Fischingen', 'Fischingen (TG)');\n\n\n### Question\nWie hoch ist der Anteil (in Prozent) der Thurgauer Gemeinden, die im Jahr 2017 keine erneuerbare Energie produziert haben?\n### SQL query\nSELECT 100 * SUM(CASE WHEN T.total_gwh = 0 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_kein_erneurerbare_energie_2017\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2017;\n\n\n### Question\nWie hoch ist der Anteil (in Prozent) der Thurgauer Gemeinden, die im Jahr 2017 keine erneuerbare Energie produziert haben?\n### SQL query\nSELECT 100 * SUM(CASE WHEN T.total_gwh = 0 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_kein_erneurerbare_energie_2017\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2017;\n\n\n### Question\nWie viele MWh an erneuerbarer Energie hat Amriswil im Kanton Thurgau von 2016 bis 2020 insgesamt produziert?\n### SQL query\nSELECT SUM(T.total_gwh) * 1000 AS total_mwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Amriswil', 'Amriswil (TG)')\n    AND T.jahr >= 2016\n    AND T.jahr <= 2020;\n\n\n### Question\nWie viel erneuerbare Energie wird in den 5 gr\u00f6ssten Thurgauer Gemeinden im Jahr 2021 produziert?\n### SQL query\nSELECT S.name AS gemeinde, T.total_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nORDER BY T.einwohner DESC\nLIMIT 5;\n\n\n### Question\nWie viel erneuerbare Energie hat der Kanton Thurgau im Zeitraum 2017-2021 insgesamt produziert?\n### SQL query\n",
    "process_time": 9.180140513926744,
    "num_tokens": 3163,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 96,
    "question": "Zeigen Sie mir die Produktion von Energie aus Sonne und Wind in Berg, TG im Jahr 2018.",
    "query": "SELECT T.photovoltaik_gwh, T.wind_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Berg', 'Berg (TG)')\n    AND T.jahr = 2018;\n",
    "db_id": "thurgau_erneuerbare_elektrizitatsproduktion_gemeinde",
    "generated_query": "SELECT T.photovoltaik_gwh, T.wind_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Berg'\n    AND S.canton = 'TRUE'\n    AND T.jahr = 2018;",
    "meta_data": [
      {
        "question": "Welche war die kleinste Gemeinde (in Einwohnern), die im Jahr 2021 im Kanton Thurgau Energie aus der Kehrichtverbrennung produzierte?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\n    AND T.kehricht_gwh > 0\nORDER BY T.einwohner ASC\nLIMIT 1;\n"
      },
      {
        "question": "Welche Gemeinde im Kanton Thurgau produziert im Jahr 2020 im Verh\u00e4ltnis zur Einwohnerzahl am meisten erneuerbare Energie?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.total_gwh / T.einwohner DESC\nLIMIT 1;\n"
      },
      {
        "question": "Welche Gemeinde im Kanton Thurgau produziert im Jahr 2020 im Verh\u00e4ltnis zur Einwohnerzahl am meisten erneuerbare Energie?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.total_gwh / T.einwohner DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wie hoch ist der Anteil der Gemeinden im Kanton Thurgau, die zwischen 2015 und 2021 einen R\u00fcckgang der Produktion von erneuerbaren Energien zu verzeichnen haben?",
        "query": "SELECT 100 * SUM(CASE WHEN T.total_gwh_2015 > T.total_gwh_2021 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_abnahme\nFROM (\n    SELECT\n        S.name,\n        SUM(CASE WHEN T.jahr = 2015 THEN T.total_gwh ELSE 0 END) AS total_gwh_2015,\n        SUM(CASE WHEN T.jahr = 2021 THEN T.total_gwh ELSE 0 END) AS total_gwh_2021\n    FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2015, 2021)\n    GROUP BY S.name\n) AS T;\n"
      },
      {
        "question": "Wie viel erneuerbare Energie wird in den 5 gr\u00f6ssten Thurgauer Gemeinden im Jahr 2021 produziert?",
        "query": "SELECT S.name AS gemeinde, T.total_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nORDER BY T.einwohner DESC\nLIMIT 5;\n"
      },
      {
        "question": "Wie viele MWh an erneuerbarer Energie hat Amriswil im Kanton Thurgau von 2016 bis 2020 insgesamt produziert?",
        "query": "SELECT SUM(T.total_gwh) * 1000 AS total_mwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Amriswil', 'Amriswil (TG)')\n    AND T.jahr >= 2016\n    AND T.jahr <= 2020;\n"
      },
      {
        "question": "Wie viel erneuerbare Energie wird in den 5 gr\u00f6ssten Thurgauer Gemeinden im Jahr 2021 produziert?",
        "query": "SELECT S.name AS gemeinde, T.total_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nORDER BY T.einwohner DESC\nLIMIT 5;\n"
      },
      {
        "question": "Welche Gemeinde im Kanton Thurgau produziert im Jahr 2020 im Verh\u00e4ltnis zur Einwohnerzahl am meisten erneuerbare Energie?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.total_gwh / T.einwohner DESC\nLIMIT 1;\n"
      },
      {
        "question": "Welche 3 Thurgauer Gemeinden hatten im Jahr 2019 den h\u00f6chsten Anteil an Wasserkraft an der gesamten erneuerbaren Energieproduktion und wie hoch war dieser?",
        "query": "SELECT\n    S.name AS gemeinde,\n    100.0 * T.wasserkraft_gwh / T.total_gwh AS prozent_wasserkraft\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY prozent_wasserkraft DESC\nLIMIT 3;\n"
      },
      {
        "question": "Wie viele GWh Energie wurden im Jahr 2015 im Kanton Thurgau aus den einzelnen Biogasanlagentypen produziert?",
        "query": "SELECT\n    SUM(biogasanlagen_abwasser_gwh) AS biogasanlagen_abwasser_gwh_kanton_thurgau,\n    SUM(biogasanlagen_industrie_gwh) AS biogasanlagen_industrie_gwh_kanton_thurgau,\n    SUM(biogasanlagen_landwirtschaft_gwh) AS biogasanlagen_landwirtschaft_gwh_kanton_thurgau\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015;\n"
      },
      {
        "question": "Welche 3 Thurgauer Gemeinden hatten im Jahr 2019 den h\u00f6chsten Anteil an Wasserkraft an der gesamten erneuerbaren Energieproduktion und wie hoch war dieser?",
        "query": "SELECT\n    S.name AS gemeinde,\n    100.0 * T.wasserkraft_gwh / T.total_gwh AS prozent_wasserkraft\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY prozent_wasserkraft DESC\nLIMIT 3;\n"
      },
      {
        "question": "Wie hoch ist die Gesamtmenge an erneuerbarer Energie aus der Kehrichtverbrennung im Kanton Thurgau im Jahr 2020?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.thurgau_erneuerbare_elektrizitatsproduktion_gemeinde (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\teinwohner NUMERIC, \n\twasserkraft_gwh NUMERIC, \n\tbiomasse_holz_gwh NUMERIC, \n\tbiogasanlagen_landwirtschaft_gwh NUMERIC, \n\tkehricht_gwh NUMERIC, \n\tbiogasanlagen_industrie_gwh NUMERIC, \n\tbiogasanlagen_abwasser_gwh NUMERIC, \n\tphotovoltaik_gwh NUMERIC, \n\twind_gwh NUMERIC, \n\ttotal_gwh NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktion_gemeinde_pkey PRIMARY KEY (uid), \n\tCONSTRAINT thurgau_erneuerbare_elektrizitatsproduktio_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in thurgau_erneuerbare_elektrizitatsproduktion_gemeinde and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\neinwohner : 839, 2560, 684, 3828, 1491\nwasserkraft_gwh : 11.333000000000000185, 13.227999999999999758, 0.021000000000000001, 1.782999999999999918, 0.246999999999999997\nbiogasanlagen_landwirtschaft_gwh : 1.245000000000000107, 2.202999999999999847, 1.729000000000000092, 1.465000000000000080, 0.163000000000000006\nbiogasanlagen_abwasser_gwh : 1.2190000000000000835, 0.1189999999999999947, 1.3160000000000000586, 0.0170000000000000012, 0.6750000000000000444\nphotovoltaik_gwh : 3.092999999999999972, 1.064000000000000057, 1.562999999999999945, 0.678000000000000047, 1.451999999999999957\ntotal_gwh : 3.794999999999999929, 1.064000000000000057, 3.232000000000000206, 9.948999999999999844, 6.251000000000000334\nspatialunit_uid : 4431_A.ADM3, 4806_A.ADM3, 4536_A.ADM3, 4446_A.ADM3, 4851_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\neinwohner, Einwohner, 2683,2318,1350\nwasserkraft_gwh, Wasserkraft, GWh, 0,1.234,6.698\nbiomasse_holz_gwh, Biomasse, Holz, GWh, 0,2.266,0.404\nbiogasanlagen_landwirtschaft_gwh, Biogasanlagen, Landwirtschaft, GWh, 0,4.826,0.308\nkehricht_gwh, Kehricht, GWh, 0,49.982734,57.317\nbiogasanlagen_industrie_gwh, Biogasanlagen, Industrie, GWh, 0,0.651573,1.819\nbiogasanlagen_abwasser_gwh, Biogasanlagen, Abwasser, GWh, 0,0.272,1.219\nphotovoltaik_gwh, Solarenergie, GWh, 3.814,1.879,4.268\nwind_gwh, Wind, GWh, 0,0.005,0.006\ntotal_gwh, Total, GWh, 3.814,1.879,9.094\n*/\n\n\n\n### Question\nWelche war die kleinste Gemeinde (in Einwohnern), die im Jahr 2021 im Kanton Thurgau Energie aus der Kehrichtverbrennung produzierte?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\n    AND T.kehricht_gwh > 0\nORDER BY T.einwohner ASC\nLIMIT 1;\n\n\n### Question\nWelche Gemeinde im Kanton Thurgau produziert im Jahr 2020 im Verh\u00e4ltnis zur Einwohnerzahl am meisten erneuerbare Energie?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.total_gwh / T.einwohner DESC\nLIMIT 1;\n\n\n### Question\nWelche Gemeinde im Kanton Thurgau produziert im Jahr 2020 im Verh\u00e4ltnis zur Einwohnerzahl am meisten erneuerbare Energie?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.total_gwh / T.einwohner DESC\nLIMIT 1;\n\n\n### Question\nWie hoch ist der Anteil der Gemeinden im Kanton Thurgau, die zwischen 2015 und 2021 einen R\u00fcckgang der Produktion von erneuerbaren Energien zu verzeichnen haben?\n### SQL query\nSELECT 100 * SUM(CASE WHEN T.total_gwh_2015 > T.total_gwh_2021 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_abnahme\nFROM (\n    SELECT\n        S.name,\n        SUM(CASE WHEN T.jahr = 2015 THEN T.total_gwh ELSE 0 END) AS total_gwh_2015,\n        SUM(CASE WHEN T.jahr = 2021 THEN T.total_gwh ELSE 0 END) AS total_gwh_2021\n    FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2015, 2021)\n    GROUP BY S.name\n) AS T;\n\n\n### Question\nWie viel erneuerbare Energie wird in den 5 gr\u00f6ssten Thurgauer Gemeinden im Jahr 2021 produziert?\n### SQL query\nSELECT S.name AS gemeinde, T.total_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nORDER BY T.einwohner DESC\nLIMIT 5;\n\n\n### Question\nWie viele MWh an erneuerbarer Energie hat Amriswil im Kanton Thurgau von 2016 bis 2020 insgesamt produziert?\n### SQL query\nSELECT SUM(T.total_gwh) * 1000 AS total_mwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Amriswil', 'Amriswil (TG)')\n    AND T.jahr >= 2016\n    AND T.jahr <= 2020;\n\n\n### Question\nWie viel erneuerbare Energie wird in den 5 gr\u00f6ssten Thurgauer Gemeinden im Jahr 2021 produziert?\n### SQL query\nSELECT S.name AS gemeinde, T.total_gwh\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2021\nORDER BY T.einwohner DESC\nLIMIT 5;\n\n\n### Question\nWelche Gemeinde im Kanton Thurgau produziert im Jahr 2020 im Verh\u00e4ltnis zur Einwohnerzahl am meisten erneuerbare Energie?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.total_gwh / T.einwohner DESC\nLIMIT 1;\n\n\n### Question\nWelche 3 Thurgauer Gemeinden hatten im Jahr 2019 den h\u00f6chsten Anteil an Wasserkraft an der gesamten erneuerbaren Energieproduktion und wie hoch war dieser?\n### SQL query\nSELECT\n    S.name AS gemeinde,\n    100.0 * T.wasserkraft_gwh / T.total_gwh AS prozent_wasserkraft\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY prozent_wasserkraft DESC\nLIMIT 3;\n\n\n### Question\nWie viele GWh Energie wurden im Jahr 2015 im Kanton Thurgau aus den einzelnen Biogasanlagentypen produziert?\n### SQL query\nSELECT\n    SUM(biogasanlagen_abwasser_gwh) AS biogasanlagen_abwasser_gwh_kanton_thurgau,\n    SUM(biogasanlagen_industrie_gwh) AS biogasanlagen_industrie_gwh_kanton_thurgau,\n    SUM(biogasanlagen_landwirtschaft_gwh) AS biogasanlagen_landwirtschaft_gwh_kanton_thurgau\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015;\n\n\n### Question\nWelche 3 Thurgauer Gemeinden hatten im Jahr 2019 den h\u00f6chsten Anteil an Wasserkraft an der gesamten erneuerbaren Energieproduktion und wie hoch war dieser?\n### SQL query\nSELECT\n    S.name AS gemeinde,\n    100.0 * T.wasserkraft_gwh / T.total_gwh AS prozent_wasserkraft\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY prozent_wasserkraft DESC\nLIMIT 3;\n\n\n### Question\nWie hoch ist die Gesamtmenge an erneuerbarer Energie aus der Kehrichtverbrennung im Kanton Thurgau im Jahr 2020?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2019\nORDER BY T.biomasse_holz_gwh DESC\nLIMIT 2;\n\n\n### Question\nZeigen Sie mir die Produktion von Energie aus Sonne und Wind in Berg, TG im Jahr 2018.\n### SQL query\n",
    "process_time": 5.711321559036151,
    "num_tokens": 3356,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 97,
    "question": "In welchem Jahr erreichte die Zahl der Besch\u00e4ftigten im prim\u00e4ren Sektor im Thurgau ihren H\u00f6hepunkt?",
    "query": "SELECT T.jahr\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.sektor = 'Prim\u00e4r'\nGROUP BY T.jahr\nORDER BY SUM(T.beschaftigte_personen) DESC LIMIT 1;\n",
    "db_id": "thurgau_beschaftigte_nach_sektoren_und_gemeinden",
    "generated_query": "SELECT T.jahr, MAX(T.beschaftigte_personen) AS max_besch\u00e4ftigte_personen_sektor_1\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.sektor = 'Prim\u00e4r'\nGROUP BY T.jahr\nORDER BY max_besch\u00e4ftigte_personen_sektor_1 DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Welche Thurgauer Gemeinde hatte im Jahr 2020 die wenigsten Besch\u00e4ftigten?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.beschaftigte_personen) ASC LIMIT 1;\n"
      },
      {
        "question": "In welcher Thurgauer Gemeinde ist die Zahl der Besch\u00e4ftigten zwischen 2015 und 2020 am st\u00e4rksten gewachsen?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2015, 2020)\nGROUP BY S.name\nORDER BY (\n    100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.beschaftigte_personen ELSE 0 END) /\n    SUM(CASE WHEN T.jahr = 2015 THEN T.beschaftigte_personen ELSE 0 END)\n) DESC LIMIT 1;\n"
      },
      {
        "question": "Wie viele Besch\u00e4ftigte des terti\u00e4ren Sektors waren 2011 und 2021 im Kanton Thurgau t\u00e4tig?",
        "query": "SELECT T.jahr, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2011, 2021)\n    AND T.sektor = 'Terti\u00e4r'\nGROUP BY T.jahr;\n"
      },
      {
        "question": "In welcher Thurgauer Gemeinde ist die Zahl der Besch\u00e4ftigten zwischen 2015 und 2020 am st\u00e4rksten gewachsen?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2015, 2020)\nGROUP BY S.name\nORDER BY (\n    100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.beschaftigte_personen ELSE 0 END) /\n    SUM(CASE WHEN T.jahr = 2015 THEN T.beschaftigte_personen ELSE 0 END)\n) DESC LIMIT 1;\n"
      },
      {
        "question": "Wie viele Besch\u00e4ftigte hatte die Stadt Frauenfeld TG im terti\u00e4ren Sektor bisher maximal und wann?",
        "query": "SELECT T.jahr, T.beschaftigte_personen AS beschaftigte_personen_sektor_3\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Frauenfeld', 'Frauenfeld (TG)')\n    AND T.sektor = 'Terti\u00e4r'\nORDER BY T.beschaftigte_personen DESC LIMIT 1;"
      },
      {
        "question": "Wie viele Besch\u00e4ftigte des terti\u00e4ren Sektors waren 2011 und 2021 im Kanton Thurgau t\u00e4tig?",
        "query": "SELECT T.jahr, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2011, 2021)\n    AND T.sektor = 'Terti\u00e4r'\nGROUP BY T.jahr;\n"
      },
      {
        "question": "Welche Thurgauer Gemeinde hatte im Jahr 2020 die wenigsten Besch\u00e4ftigten?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.beschaftigte_personen) ASC LIMIT 1;\n"
      },
      {
        "question": "Welche Thurgauer Gemeinde hatte im Jahr 2020 die wenigsten Besch\u00e4ftigten?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.beschaftigte_personen) ASC LIMIT 1;\n"
      },
      {
        "question": "In welcher Thurgauer Gemeinde ist die Zahl der Besch\u00e4ftigten zwischen 2015 und 2020 am st\u00e4rksten gewachsen?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2015, 2020)\nGROUP BY S.name\nORDER BY (\n    100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.beschaftigte_personen ELSE 0 END) /\n    SUM(CASE WHEN T.jahr = 2015 THEN T.beschaftigte_personen ELSE 0 END)\n) DESC LIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.thurgau_beschaftigte_nach_sektoren_und_gemeinden (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tsektor TEXT, \n\tbeschaftigte_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT thurgau_beschaftigte_nach_sektoren_und_gemeinden_pkey PRIMARY KEY (uid), \n\tCONSTRAINT thurgau_beschaftigte_nach_sektoren_und_gem_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in thurgau_beschaftigte_nach_sektoren_und_gemeinden and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nbeschaftigte_personen : 839, 192, 1001, 115, 136\nspatialunit_uid : 4431_A.ADM3, 4806_A.ADM3, 4536_A.ADM3, 4446_A.ADM3, 4851_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nsektor, Wirtschaftssektor, Terti\u00e4r,Prim\u00e4r,Sekund\u00e4r\nbeschaftigte_personen, Besch\u00e4ftigte Personen, 4871,363,1077\n*/\n\n\n\n### Question\nWelche Thurgauer Gemeinde hatte im Jahr 2020 die wenigsten Besch\u00e4ftigten?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.beschaftigte_personen) ASC LIMIT 1;\n\n\n### Question\nIn welcher Thurgauer Gemeinde ist die Zahl der Besch\u00e4ftigten zwischen 2015 und 2020 am st\u00e4rksten gewachsen?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2015, 2020)\nGROUP BY S.name\nORDER BY (\n    100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.beschaftigte_personen ELSE 0 END) /\n    SUM(CASE WHEN T.jahr = 2015 THEN T.beschaftigte_personen ELSE 0 END)\n) DESC LIMIT 1;\n\n\n### Question\nWie viele Besch\u00e4ftigte des terti\u00e4ren Sektors waren 2011 und 2021 im Kanton Thurgau t\u00e4tig?\n### SQL query\nSELECT T.jahr, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2011, 2021)\n    AND T.sektor = 'Terti\u00e4r'\nGROUP BY T.jahr;\n\n\n### Question\nIn welcher Thurgauer Gemeinde ist die Zahl der Besch\u00e4ftigten zwischen 2015 und 2020 am st\u00e4rksten gewachsen?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2015, 2020)\nGROUP BY S.name\nORDER BY (\n    100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.beschaftigte_personen ELSE 0 END) /\n    SUM(CASE WHEN T.jahr = 2015 THEN T.beschaftigte_personen ELSE 0 END)\n) DESC LIMIT 1;\n\n\n### Question\nWie viele Besch\u00e4ftigte hatte die Stadt Frauenfeld TG im terti\u00e4ren Sektor bisher maximal und wann?\n### SQL query\nSELECT T.jahr, T.beschaftigte_personen AS beschaftigte_personen_sektor_3\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Frauenfeld', 'Frauenfeld (TG)')\n    AND T.sektor = 'Terti\u00e4r'\nORDER BY T.beschaftigte_personen DESC LIMIT 1;\n\n### Question\nWie viele Besch\u00e4ftigte des terti\u00e4ren Sektors waren 2011 und 2021 im Kanton Thurgau t\u00e4tig?\n### SQL query\nSELECT T.jahr, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2011, 2021)\n    AND T.sektor = 'Terti\u00e4r'\nGROUP BY T.jahr;\n\n\n### Question\nWelche Thurgauer Gemeinde hatte im Jahr 2020 die wenigsten Besch\u00e4ftigten?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.beschaftigte_personen) ASC LIMIT 1;\n\n\n### Question\nWelche Thurgauer Gemeinde hatte im Jahr 2020 die wenigsten Besch\u00e4ftigten?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.beschaftigte_personen) ASC LIMIT 1;\n\n\n### Question\nIn welcher Thurgauer Gemeinde ist die Zahl der Besch\u00e4ftigten zwischen 2015 und 2020 am st\u00e4rksten gewachsen?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2015, 2020)\nGROUP BY S.name\nORDER BY (\n    100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.beschaftigte_personen ELSE 0 END) /\n    SUM(CASE WHEN T.jahr = 2015 THEN T.beschaftigte_personen ELSE 0 END)\n) DESC LIMIT 1;\n\n\n### Question\nIn welchem Jahr erreichte die Zahl der Besch\u00e4ftigten im prim\u00e4ren Sektor im Thurgau ihren H\u00f6hepunkt?\n### SQL query\n",
    "process_time": 7.613338144030422,
    "num_tokens": 2218,
    "hardness": "extra",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 98,
    "question": "Wie hoch ist die relative Ver\u00e4nderung der Besch\u00e4ftigten in den einzelnen Wirtschaftssektoren im Thurgau in Prozent zwischen 2011 und 2021?",
    "query": "SELECT\n    AGG.sektor,\n    (\n        100.0 *\n        (AGG.beschaftigte_personen_2021 - AGG.beschaftigte_personen_2011) /\n        AGG.beschaftigte_personen_2011\n    ) AS relative_veranderung_beschaftigte_personen\nFROM (\n    SELECT\n        T.sektor,\n        SUM(CASE WHEN T.jahr = 2021 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_2021,\n        SUM(CASE WHEN T.jahr = 2011 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_2011\n    FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2011, 2021)\n    GROUP BY T.sektor\n) AS AGG;\n",
    "db_id": "thurgau_beschaftigte_nach_sektoren_und_gemeinden",
    "generated_query": "SELECT T.sektor, \n    100.0 * (SUM(CASE WHEN T.jahr = 2021 THEN T.beschaftigte_personen ELSE 0 END) - \n    SUM(CASE WHEN T.jahr = 2011 THEN T.beschaftigte_personen ELSE 0 END)) / \n    SUM(CASE WHEN T.jahr = 2011 THEN T.beschaftigte_personen ELSE 0 END) AS relative_veranderung_prozent\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2011, 2021)\nGROUP BY T.sektor;",
    "meta_data": [
      {
        "question": "In welcher Thurgauer Gemeinde ist die Zahl der Besch\u00e4ftigten zwischen 2015 und 2020 am st\u00e4rksten gewachsen?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2015, 2020)\nGROUP BY S.name\nORDER BY (\n    100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.beschaftigte_personen ELSE 0 END) /\n    SUM(CASE WHEN T.jahr = 2015 THEN T.beschaftigte_personen ELSE 0 END)\n) DESC LIMIT 1;\n"
      },
      {
        "question": "Wie viele Besch\u00e4ftigte hatte die Stadt Frauenfeld TG im terti\u00e4ren Sektor bisher maximal und wann?",
        "query": "SELECT T.jahr, T.beschaftigte_personen AS beschaftigte_personen_sektor_3\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Frauenfeld', 'Frauenfeld (TG)')\n    AND T.sektor = 'Terti\u00e4r'\nORDER BY T.beschaftigte_personen DESC LIMIT 1;"
      },
      {
        "question": "Wie viele Besch\u00e4ftigte des terti\u00e4ren Sektors waren 2011 und 2021 im Kanton Thurgau t\u00e4tig?",
        "query": "SELECT T.jahr, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2011, 2021)\n    AND T.sektor = 'Terti\u00e4r'\nGROUP BY T.jahr;\n"
      },
      {
        "question": "In welcher Thurgauer Gemeinde ist die Zahl der Besch\u00e4ftigten zwischen 2015 und 2020 am st\u00e4rksten gewachsen?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2015, 2020)\nGROUP BY S.name\nORDER BY (\n    100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.beschaftigte_personen ELSE 0 END) /\n    SUM(CASE WHEN T.jahr = 2015 THEN T.beschaftigte_personen ELSE 0 END)\n) DESC LIMIT 1;\n"
      },
      {
        "question": "Wie hoch war die Zahl der Besch\u00e4ftigten pro Wirtschaftszweig im Kanton Thurgau in den Jahren 2017 bis 2020?",
        "query": "SELECT T.jahr, T.sektor, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr >= 2017\n    AND T.jahr <= 2020\nGROUP BY T.sektor, T.jahr;\n"
      },
      {
        "question": "Wie hoch ist der Anteil der Thurgauer Gemeinden, in denen die Zahl der Besch\u00e4ftigten im prim\u00e4ren Sektor zwischen 2013 und 2018 abgenommen hat?",
        "query": "SELECT (\n    100.0 * COUNT(CASE WHEN T.beschaftigte_personen_sektor_1_2018 < T.beschaftigte_personen_sektor_1_2013 THEN 1 END) /\n    COUNT(*)\n) AS prozent_gemeinden_abnahme_sektor_1\nFROM (\n    SELECT\n        S.name AS gemeinde,\n        SUM(CASE WHEN T.jahr = 2013 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1_2013,\n        SUM(CASE WHEN T.jahr = 2018 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1_2018\n    FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2013, 2018)\n        AND T.sektor = 'Prim\u00e4r'\n    GROUP BY S.name\n) AS T;\n"
      },
      {
        "question": "In welcher Thurgauer Gemeinde ist die Zahl der Besch\u00e4ftigten zwischen 2015 und 2020 am st\u00e4rksten gewachsen?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2015, 2020)\nGROUP BY S.name\nORDER BY (\n    100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.beschaftigte_personen ELSE 0 END) /\n    SUM(CASE WHEN T.jahr = 2015 THEN T.beschaftigte_personen ELSE 0 END)\n) DESC LIMIT 1;\n"
      },
      {
        "question": "Wie viele Besch\u00e4ftigte hatte die Stadt Frauenfeld TG im terti\u00e4ren Sektor bisher maximal und wann?",
        "query": "SELECT T.jahr, T.beschaftigte_personen AS beschaftigte_personen_sektor_3\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Frauenfeld', 'Frauenfeld (TG)')\n    AND T.sektor = 'Terti\u00e4r'\nORDER BY T.beschaftigte_personen DESC LIMIT 1;"
      },
      {
        "question": "Wie viele Besch\u00e4ftigte des terti\u00e4ren Sektors waren 2011 und 2021 im Kanton Thurgau t\u00e4tig?",
        "query": "SELECT T.jahr, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2011, 2021)\n    AND T.sektor = 'Terti\u00e4r'\nGROUP BY T.jahr;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.thurgau_beschaftigte_nach_sektoren_und_gemeinden (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tsektor TEXT, \n\tbeschaftigte_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT thurgau_beschaftigte_nach_sektoren_und_gemeinden_pkey PRIMARY KEY (uid), \n\tCONSTRAINT thurgau_beschaftigte_nach_sektoren_und_gem_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in thurgau_beschaftigte_nach_sektoren_und_gemeinden and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nbeschaftigte_personen : 839, 192, 1001, 115, 136\nspatialunit_uid : 4431_A.ADM3, 4806_A.ADM3, 4536_A.ADM3, 4446_A.ADM3, 4851_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nsektor, Wirtschaftssektor, Terti\u00e4r,Prim\u00e4r,Sekund\u00e4r\nbeschaftigte_personen, Besch\u00e4ftigte Personen, 4871,363,1077\n*/\n\n\n\n### Question\nIn welcher Thurgauer Gemeinde ist die Zahl der Besch\u00e4ftigten zwischen 2015 und 2020 am st\u00e4rksten gewachsen?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2015, 2020)\nGROUP BY S.name\nORDER BY (\n    100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.beschaftigte_personen ELSE 0 END) /\n    SUM(CASE WHEN T.jahr = 2015 THEN T.beschaftigte_personen ELSE 0 END)\n) DESC LIMIT 1;\n\n\n### Question\nWie viele Besch\u00e4ftigte hatte die Stadt Frauenfeld TG im terti\u00e4ren Sektor bisher maximal und wann?\n### SQL query\nSELECT T.jahr, T.beschaftigte_personen AS beschaftigte_personen_sektor_3\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Frauenfeld', 'Frauenfeld (TG)')\n    AND T.sektor = 'Terti\u00e4r'\nORDER BY T.beschaftigte_personen DESC LIMIT 1;\n\n### Question\nWie viele Besch\u00e4ftigte des terti\u00e4ren Sektors waren 2011 und 2021 im Kanton Thurgau t\u00e4tig?\n### SQL query\nSELECT T.jahr, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2011, 2021)\n    AND T.sektor = 'Terti\u00e4r'\nGROUP BY T.jahr;\n\n\n### Question\nIn welcher Thurgauer Gemeinde ist die Zahl der Besch\u00e4ftigten zwischen 2015 und 2020 am st\u00e4rksten gewachsen?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2015, 2020)\nGROUP BY S.name\nORDER BY (\n    100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.beschaftigte_personen ELSE 0 END) /\n    SUM(CASE WHEN T.jahr = 2015 THEN T.beschaftigte_personen ELSE 0 END)\n) DESC LIMIT 1;\n\n\n### Question\nWie hoch war die Zahl der Besch\u00e4ftigten pro Wirtschaftszweig im Kanton Thurgau in den Jahren 2017 bis 2020?\n### SQL query\nSELECT T.jahr, T.sektor, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr >= 2017\n    AND T.jahr <= 2020\nGROUP BY T.sektor, T.jahr;\n\n\n### Question\nWie hoch ist der Anteil der Thurgauer Gemeinden, in denen die Zahl der Besch\u00e4ftigten im prim\u00e4ren Sektor zwischen 2013 und 2018 abgenommen hat?\n### SQL query\nSELECT (\n    100.0 * COUNT(CASE WHEN T.beschaftigte_personen_sektor_1_2018 < T.beschaftigte_personen_sektor_1_2013 THEN 1 END) /\n    COUNT(*)\n) AS prozent_gemeinden_abnahme_sektor_1\nFROM (\n    SELECT\n        S.name AS gemeinde,\n        SUM(CASE WHEN T.jahr = 2013 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1_2013,\n        SUM(CASE WHEN T.jahr = 2018 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1_2018\n    FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2013, 2018)\n        AND T.sektor = 'Prim\u00e4r'\n    GROUP BY S.name\n) AS T;\n\n\n### Question\nIn welcher Thurgauer Gemeinde ist die Zahl der Besch\u00e4ftigten zwischen 2015 und 2020 am st\u00e4rksten gewachsen?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2015, 2020)\nGROUP BY S.name\nORDER BY (\n    100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.beschaftigte_personen ELSE 0 END) /\n    SUM(CASE WHEN T.jahr = 2015 THEN T.beschaftigte_personen ELSE 0 END)\n) DESC LIMIT 1;\n\n\n### Question\nWie viele Besch\u00e4ftigte hatte die Stadt Frauenfeld TG im terti\u00e4ren Sektor bisher maximal und wann?\n### SQL query\nSELECT T.jahr, T.beschaftigte_personen AS beschaftigte_personen_sektor_3\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Frauenfeld', 'Frauenfeld (TG)')\n    AND T.sektor = 'Terti\u00e4r'\nORDER BY T.beschaftigte_personen DESC LIMIT 1;\n\n### Question\nWie viele Besch\u00e4ftigte des terti\u00e4ren Sektors waren 2011 und 2021 im Kanton Thurgau t\u00e4tig?\n### SQL query\nSELECT T.jahr, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2011, 2021)\n    AND T.sektor = 'Terti\u00e4r'\nGROUP BY T.jahr;\n\n\n### Question\nWie hoch ist die relative Ver\u00e4nderung der Besch\u00e4ftigten in den einzelnen Wirtschaftssektoren im Thurgau in Prozent zwischen 2011 und 2021?\n### SQL query\n",
    "process_time": 9.502923977095634,
    "num_tokens": 2441,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 99,
    "question": "Wie viele Personen waren 2015 im prim\u00e4ren Sektor in Uttwil TG besch\u00e4ftigt?",
    "query": "SELECT T.beschaftigte_personen\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Uttwil', 'Uttwil (TG)')\n    AND T.jahr = 2015\n    AND T.sektor = 'Prim\u00e4r';\n",
    "db_id": "thurgau_beschaftigte_nach_sektoren_und_gemeinden",
    "generated_query": "SELECT T.beschaftigte_personen\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name = 'Uttwil (TG)'\n    AND T.jahr = 2015\n    AND T.sektor = 'Prim\u00e4r';",
    "meta_data": [
      {
        "question": "Wie viele Besch\u00e4ftigte des terti\u00e4ren Sektors waren 2011 und 2021 im Kanton Thurgau t\u00e4tig?",
        "query": "SELECT T.jahr, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2011, 2021)\n    AND T.sektor = 'Terti\u00e4r'\nGROUP BY T.jahr;\n"
      },
      {
        "question": "Wie hoch ist der Anteil (in %) der Thurgauer Gemeinden, in denen 2016 die Zahl der Besch\u00e4ftigten im prim\u00e4ren Sektor h\u00f6her war als im sekund\u00e4ren Sektor?",
        "query": "SELECT (\n    100.0 * COUNT(CASE WHEN T.beschaftigte_personen_sektor_1 > T.beschaftigte_personen_sektor_2 THEN 1 END) /\n    COUNT(*)\n) AS prozent_gemeinden_hohere_sektor_1\nFROM (\n    SELECT\n        S.name AS gemeinde,\n        SUM(CASE WHEN T.sektor = 'Prim\u00e4r' THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1,\n        SUM(CASE WHEN T.sektor = 'Sekund\u00e4r' THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_2\n    FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2016\n    GROUP BY S.name\n) AS T;\n"
      },
      {
        "question": "Wie viele Besch\u00e4ftigte des terti\u00e4ren Sektors waren 2011 und 2021 im Kanton Thurgau t\u00e4tig?",
        "query": "SELECT T.jahr, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2011, 2021)\n    AND T.sektor = 'Terti\u00e4r'\nGROUP BY T.jahr;\n"
      },
      {
        "question": "Wie viele Personen waren im Jahr 2015 in der Stadt Frauenfeld im Kanton Thurgau im sekund\u00e4ren Sektor besch\u00e4ftigt?",
        "query": "SELECT T.beschaftigte_personen\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Frauenfeld', 'Frauenfeld (TG)')\n    AND T.jahr = 2015\n    AND T.sektor = 'Sekund\u00e4r';\n"
      },
      {
        "question": "Wie hoch ist der Anteil (in %) der Thurgauer Gemeinden, in denen 2016 die Zahl der Besch\u00e4ftigten im prim\u00e4ren Sektor h\u00f6her war als im sekund\u00e4ren Sektor?",
        "query": "SELECT (\n    100.0 * COUNT(CASE WHEN T.beschaftigte_personen_sektor_1 > T.beschaftigte_personen_sektor_2 THEN 1 END) /\n    COUNT(*)\n) AS prozent_gemeinden_hohere_sektor_1\nFROM (\n    SELECT\n        S.name AS gemeinde,\n        SUM(CASE WHEN T.sektor = 'Prim\u00e4r' THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1,\n        SUM(CASE WHEN T.sektor = 'Sekund\u00e4r' THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_2\n    FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2016\n    GROUP BY S.name\n) AS T;\n"
      },
      {
        "question": "In welcher Thurgauer Gemeinde ist die Zahl der Besch\u00e4ftigten zwischen 2015 und 2020 am st\u00e4rksten gewachsen?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2015, 2020)\nGROUP BY S.name\nORDER BY (\n    100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.beschaftigte_personen ELSE 0 END) /\n    SUM(CASE WHEN T.jahr = 2015 THEN T.beschaftigte_personen ELSE 0 END)\n) DESC LIMIT 1;\n"
      },
      {
        "question": "Wie viele Personen waren im Jahr 2015 in der Stadt Frauenfeld im Kanton Thurgau im sekund\u00e4ren Sektor besch\u00e4ftigt?",
        "query": "SELECT T.beschaftigte_personen\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Frauenfeld', 'Frauenfeld (TG)')\n    AND T.jahr = 2015\n    AND T.sektor = 'Sekund\u00e4r';\n"
      },
      {
        "question": "Wie viele Besch\u00e4ftigte hatte die Stadt Frauenfeld TG im terti\u00e4ren Sektor bisher maximal und wann?",
        "query": "SELECT T.jahr, T.beschaftigte_personen AS beschaftigte_personen_sektor_3\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Frauenfeld', 'Frauenfeld (TG)')\n    AND T.sektor = 'Terti\u00e4r'\nORDER BY T.beschaftigte_personen DESC LIMIT 1;"
      },
      {
        "question": "In welcher Thurgauer Gemeinde ist die Zahl der Besch\u00e4ftigten zwischen 2015 und 2020 am st\u00e4rksten gewachsen?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2015, 2020)\nGROUP BY S.name\nORDER BY (\n    100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.beschaftigte_personen ELSE 0 END) /\n    SUM(CASE WHEN T.jahr = 2015 THEN T.beschaftigte_personen ELSE 0 END)\n) DESC LIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.thurgau_beschaftigte_nach_sektoren_und_gemeinden (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tsektor TEXT, \n\tbeschaftigte_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT thurgau_beschaftigte_nach_sektoren_und_gemeinden_pkey PRIMARY KEY (uid), \n\tCONSTRAINT thurgau_beschaftigte_nach_sektoren_und_gem_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in thurgau_beschaftigte_nach_sektoren_und_gemeinden and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nbeschaftigte_personen : 839, 192, 1001, 115, 136\nspatialunit_uid : 4431_A.ADM3, 4806_A.ADM3, 4536_A.ADM3, 4446_A.ADM3, 4851_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nsektor, Wirtschaftssektor, Terti\u00e4r,Prim\u00e4r,Sekund\u00e4r\nbeschaftigte_personen, Besch\u00e4ftigte Personen, 4871,363,1077\n*/\n\n\n\n### Question\nWie viele Besch\u00e4ftigte des terti\u00e4ren Sektors waren 2011 und 2021 im Kanton Thurgau t\u00e4tig?\n### SQL query\nSELECT T.jahr, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2011, 2021)\n    AND T.sektor = 'Terti\u00e4r'\nGROUP BY T.jahr;\n\n\n### Question\nWie hoch ist der Anteil (in %) der Thurgauer Gemeinden, in denen 2016 die Zahl der Besch\u00e4ftigten im prim\u00e4ren Sektor h\u00f6her war als im sekund\u00e4ren Sektor?\n### SQL query\nSELECT (\n    100.0 * COUNT(CASE WHEN T.beschaftigte_personen_sektor_1 > T.beschaftigte_personen_sektor_2 THEN 1 END) /\n    COUNT(*)\n) AS prozent_gemeinden_hohere_sektor_1\nFROM (\n    SELECT\n        S.name AS gemeinde,\n        SUM(CASE WHEN T.sektor = 'Prim\u00e4r' THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1,\n        SUM(CASE WHEN T.sektor = 'Sekund\u00e4r' THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_2\n    FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2016\n    GROUP BY S.name\n) AS T;\n\n\n### Question\nWie viele Besch\u00e4ftigte des terti\u00e4ren Sektors waren 2011 und 2021 im Kanton Thurgau t\u00e4tig?\n### SQL query\nSELECT T.jahr, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2011, 2021)\n    AND T.sektor = 'Terti\u00e4r'\nGROUP BY T.jahr;\n\n\n### Question\nWie viele Personen waren im Jahr 2015 in der Stadt Frauenfeld im Kanton Thurgau im sekund\u00e4ren Sektor besch\u00e4ftigt?\n### SQL query\nSELECT T.beschaftigte_personen\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Frauenfeld', 'Frauenfeld (TG)')\n    AND T.jahr = 2015\n    AND T.sektor = 'Sekund\u00e4r';\n\n\n### Question\nWie hoch ist der Anteil (in %) der Thurgauer Gemeinden, in denen 2016 die Zahl der Besch\u00e4ftigten im prim\u00e4ren Sektor h\u00f6her war als im sekund\u00e4ren Sektor?\n### SQL query\nSELECT (\n    100.0 * COUNT(CASE WHEN T.beschaftigte_personen_sektor_1 > T.beschaftigte_personen_sektor_2 THEN 1 END) /\n    COUNT(*)\n) AS prozent_gemeinden_hohere_sektor_1\nFROM (\n    SELECT\n        S.name AS gemeinde,\n        SUM(CASE WHEN T.sektor = 'Prim\u00e4r' THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1,\n        SUM(CASE WHEN T.sektor = 'Sekund\u00e4r' THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_2\n    FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2016\n    GROUP BY S.name\n) AS T;\n\n\n### Question\nIn welcher Thurgauer Gemeinde ist die Zahl der Besch\u00e4ftigten zwischen 2015 und 2020 am st\u00e4rksten gewachsen?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2015, 2020)\nGROUP BY S.name\nORDER BY (\n    100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.beschaftigte_personen ELSE 0 END) /\n    SUM(CASE WHEN T.jahr = 2015 THEN T.beschaftigte_personen ELSE 0 END)\n) DESC LIMIT 1;\n\n\n### Question\nWie viele Personen waren im Jahr 2015 in der Stadt Frauenfeld im Kanton Thurgau im sekund\u00e4ren Sektor besch\u00e4ftigt?\n### SQL query\nSELECT T.beschaftigte_personen\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Frauenfeld', 'Frauenfeld (TG)')\n    AND T.jahr = 2015\n    AND T.sektor = 'Sekund\u00e4r';\n\n\n### Question\nWie viele Besch\u00e4ftigte hatte die Stadt Frauenfeld TG im terti\u00e4ren Sektor bisher maximal und wann?\n### SQL query\nSELECT T.jahr, T.beschaftigte_personen AS beschaftigte_personen_sektor_3\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Frauenfeld', 'Frauenfeld (TG)')\n    AND T.sektor = 'Terti\u00e4r'\nORDER BY T.beschaftigte_personen DESC LIMIT 1;\n\n### Question\nIn welcher Thurgauer Gemeinde ist die Zahl der Besch\u00e4ftigten zwischen 2015 und 2020 am st\u00e4rksten gewachsen?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2015, 2020)\nGROUP BY S.name\nORDER BY (\n    100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.beschaftigte_personen ELSE 0 END) /\n    SUM(CASE WHEN T.jahr = 2015 THEN T.beschaftigte_personen ELSE 0 END)\n) DESC LIMIT 1;\n\n\n### Question\nWie viele Personen waren 2015 im prim\u00e4ren Sektor in Uttwil TG besch\u00e4ftigt?\n### SQL query\n",
    "process_time": 5.942371184006333,
    "num_tokens": 2499,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 100,
    "question": "Wie viele Besch\u00e4ftigte aus dem ersten Sektor gab es in Arbon und Egnach, Thurgau, in den Jahren 2012 und 2019?",
    "query": "SELECT S.name AS gemeinde, T.jahr, SUM(T.beschaftigte_personen) AS beschaftigte_personen_sektor_1\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Arbon', 'Arbon (TG)', 'Egnach', 'Egnach (TG)')\n    AND T.jahr IN (2012, 2019)\n    AND T.sektor = 'Prim\u00e4r'\nGROUP BY T.jahr, S.name\nORDER BY S.name, T.jahr;\n",
    "db_id": "thurgau_beschaftigte_nach_sektoren_und_gemeinden",
    "generated_query": "SELECT T.jahr, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name IN ('Arbon', 'Egnach')\n    AND S.municipal = 'TRUE'\n    AND T.jahr IN (2012, 2019)\n    AND T.sektor = 'Prim\u00e4r'\nGROUP BY T.jahr;",
    "meta_data": [
      {
        "question": "In welcher Thurgauer Gemeinde ist die Zahl der Besch\u00e4ftigten zwischen 2015 und 2020 am st\u00e4rksten gewachsen?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2015, 2020)\nGROUP BY S.name\nORDER BY (\n    100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.beschaftigte_personen ELSE 0 END) /\n    SUM(CASE WHEN T.jahr = 2015 THEN T.beschaftigte_personen ELSE 0 END)\n) DESC LIMIT 1;\n"
      },
      {
        "question": "Wie hoch ist der Anteil (in %) der Thurgauer Gemeinden, in denen 2016 die Zahl der Besch\u00e4ftigten im prim\u00e4ren Sektor h\u00f6her war als im sekund\u00e4ren Sektor?",
        "query": "SELECT (\n    100.0 * COUNT(CASE WHEN T.beschaftigte_personen_sektor_1 > T.beschaftigte_personen_sektor_2 THEN 1 END) /\n    COUNT(*)\n) AS prozent_gemeinden_hohere_sektor_1\nFROM (\n    SELECT\n        S.name AS gemeinde,\n        SUM(CASE WHEN T.sektor = 'Prim\u00e4r' THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1,\n        SUM(CASE WHEN T.sektor = 'Sekund\u00e4r' THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_2\n    FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2016\n    GROUP BY S.name\n) AS T;\n"
      },
      {
        "question": "Wie viele Besch\u00e4ftigte des terti\u00e4ren Sektors waren 2011 und 2021 im Kanton Thurgau t\u00e4tig?",
        "query": "SELECT T.jahr, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2011, 2021)\n    AND T.sektor = 'Terti\u00e4r'\nGROUP BY T.jahr;\n"
      },
      {
        "question": "Wie hoch ist der Anteil der Thurgauer Gemeinden, in denen die Zahl der Besch\u00e4ftigten im prim\u00e4ren Sektor zwischen 2013 und 2018 abgenommen hat?",
        "query": "SELECT (\n    100.0 * COUNT(CASE WHEN T.beschaftigte_personen_sektor_1_2018 < T.beschaftigte_personen_sektor_1_2013 THEN 1 END) /\n    COUNT(*)\n) AS prozent_gemeinden_abnahme_sektor_1\nFROM (\n    SELECT\n        S.name AS gemeinde,\n        SUM(CASE WHEN T.jahr = 2013 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1_2013,\n        SUM(CASE WHEN T.jahr = 2018 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1_2018\n    FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2013, 2018)\n        AND T.sektor = 'Prim\u00e4r'\n    GROUP BY S.name\n) AS T;\n"
      },
      {
        "question": "Welche Thurgauer Gemeinde hatte im Jahr 2020 die wenigsten Besch\u00e4ftigten?",
        "query": "SELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.beschaftigte_personen) ASC LIMIT 1;\n"
      },
      {
        "question": "Wie hoch ist der Anteil (in %) der Thurgauer Gemeinden, in denen 2016 die Zahl der Besch\u00e4ftigten im prim\u00e4ren Sektor h\u00f6her war als im sekund\u00e4ren Sektor?",
        "query": "SELECT (\n    100.0 * COUNT(CASE WHEN T.beschaftigte_personen_sektor_1 > T.beschaftigte_personen_sektor_2 THEN 1 END) /\n    COUNT(*)\n) AS prozent_gemeinden_hohere_sektor_1\nFROM (\n    SELECT\n        S.name AS gemeinde,\n        SUM(CASE WHEN T.sektor = 'Prim\u00e4r' THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1,\n        SUM(CASE WHEN T.sektor = 'Sekund\u00e4r' THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_2\n    FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2016\n    GROUP BY S.name\n) AS T;\n"
      },
      {
        "question": "Wie hoch ist der Anteil der Thurgauer Gemeinden, in denen die Zahl der Besch\u00e4ftigten im prim\u00e4ren Sektor zwischen 2013 und 2018 abgenommen hat?",
        "query": "SELECT (\n    100.0 * COUNT(CASE WHEN T.beschaftigte_personen_sektor_1_2018 < T.beschaftigte_personen_sektor_1_2013 THEN 1 END) /\n    COUNT(*)\n) AS prozent_gemeinden_abnahme_sektor_1\nFROM (\n    SELECT\n        S.name AS gemeinde,\n        SUM(CASE WHEN T.jahr = 2013 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1_2013,\n        SUM(CASE WHEN T.jahr = 2018 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1_2018\n    FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2013, 2018)\n        AND T.sektor = 'Prim\u00e4r'\n    GROUP BY S.name\n) AS T;\n"
      },
      {
        "question": "Wie hoch ist der Anteil der Thurgauer Gemeinden, in denen die Zahl der Besch\u00e4ftigten im prim\u00e4ren Sektor zwischen 2013 und 2018 abgenommen hat?",
        "query": "SELECT (\n    100.0 * COUNT(CASE WHEN T.beschaftigte_personen_sektor_1_2018 < T.beschaftigte_personen_sektor_1_2013 THEN 1 END) /\n    COUNT(*)\n) AS prozent_gemeinden_abnahme_sektor_1\nFROM (\n    SELECT\n        S.name AS gemeinde,\n        SUM(CASE WHEN T.jahr = 2013 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1_2013,\n        SUM(CASE WHEN T.jahr = 2018 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1_2018\n    FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2013, 2018)\n        AND T.sektor = 'Prim\u00e4r'\n    GROUP BY S.name\n) AS T;\n"
      },
      {
        "question": "Welches sind die f\u00fcnf Thurgauer Gemeinden mit dem h\u00f6chsten Anteil an Besch\u00e4ftigten im sekund\u00e4ren Sektor im Jahr 2020? Geben Sie auch die Anteile in Prozent an.",
        "query": "SELECT\n    S.name AS gemeinde,\n    (\n        100.0 * SUM(CASE WHEN T.sektor = 'Sekund\u00e4r' THEN T.beschaftigte_personen ELSE 0 END) /\n        SUM(T.beschaftigte_personen)\n    ) as prozent_beschaftigte_personen_sektor_2\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY prozent_beschaftigte_personen_sektor_2\nDESC LIMIT 5;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.thurgau_beschaftigte_nach_sektoren_und_gemeinden (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tsektor TEXT, \n\tbeschaftigte_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT thurgau_beschaftigte_nach_sektoren_und_gemeinden_pkey PRIMARY KEY (uid), \n\tCONSTRAINT thurgau_beschaftigte_nach_sektoren_und_gem_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in thurgau_beschaftigte_nach_sektoren_und_gemeinden and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nbeschaftigte_personen : 839, 192, 1001, 115, 136\nspatialunit_uid : 4431_A.ADM3, 4806_A.ADM3, 4536_A.ADM3, 4446_A.ADM3, 4851_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\nsektor, Wirtschaftssektor, Terti\u00e4r,Prim\u00e4r,Sekund\u00e4r\nbeschaftigte_personen, Besch\u00e4ftigte Personen, 4871,363,1077\n*/\n\n\n\n### Question\nIn welcher Thurgauer Gemeinde ist die Zahl der Besch\u00e4ftigten zwischen 2015 und 2020 am st\u00e4rksten gewachsen?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2015, 2020)\nGROUP BY S.name\nORDER BY (\n    100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.beschaftigte_personen ELSE 0 END) /\n    SUM(CASE WHEN T.jahr = 2015 THEN T.beschaftigte_personen ELSE 0 END)\n) DESC LIMIT 1;\n\n\n### Question\nWie hoch ist der Anteil (in %) der Thurgauer Gemeinden, in denen 2016 die Zahl der Besch\u00e4ftigten im prim\u00e4ren Sektor h\u00f6her war als im sekund\u00e4ren Sektor?\n### SQL query\nSELECT (\n    100.0 * COUNT(CASE WHEN T.beschaftigte_personen_sektor_1 > T.beschaftigte_personen_sektor_2 THEN 1 END) /\n    COUNT(*)\n) AS prozent_gemeinden_hohere_sektor_1\nFROM (\n    SELECT\n        S.name AS gemeinde,\n        SUM(CASE WHEN T.sektor = 'Prim\u00e4r' THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1,\n        SUM(CASE WHEN T.sektor = 'Sekund\u00e4r' THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_2\n    FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2016\n    GROUP BY S.name\n) AS T;\n\n\n### Question\nWie viele Besch\u00e4ftigte des terti\u00e4ren Sektors waren 2011 und 2021 im Kanton Thurgau t\u00e4tig?\n### SQL query\nSELECT T.jahr, SUM(T.beschaftigte_personen)\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2011, 2021)\n    AND T.sektor = 'Terti\u00e4r'\nGROUP BY T.jahr;\n\n\n### Question\nWie hoch ist der Anteil der Thurgauer Gemeinden, in denen die Zahl der Besch\u00e4ftigten im prim\u00e4ren Sektor zwischen 2013 und 2018 abgenommen hat?\n### SQL query\nSELECT (\n    100.0 * COUNT(CASE WHEN T.beschaftigte_personen_sektor_1_2018 < T.beschaftigte_personen_sektor_1_2013 THEN 1 END) /\n    COUNT(*)\n) AS prozent_gemeinden_abnahme_sektor_1\nFROM (\n    SELECT\n        S.name AS gemeinde,\n        SUM(CASE WHEN T.jahr = 2013 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1_2013,\n        SUM(CASE WHEN T.jahr = 2018 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1_2018\n    FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2013, 2018)\n        AND T.sektor = 'Prim\u00e4r'\n    GROUP BY S.name\n) AS T;\n\n\n### Question\nWelche Thurgauer Gemeinde hatte im Jahr 2020 die wenigsten Besch\u00e4ftigten?\n### SQL query\nSELECT S.name AS gemeinde\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.beschaftigte_personen) ASC LIMIT 1;\n\n\n### Question\nWie hoch ist der Anteil (in %) der Thurgauer Gemeinden, in denen 2016 die Zahl der Besch\u00e4ftigten im prim\u00e4ren Sektor h\u00f6her war als im sekund\u00e4ren Sektor?\n### SQL query\nSELECT (\n    100.0 * COUNT(CASE WHEN T.beschaftigte_personen_sektor_1 > T.beschaftigte_personen_sektor_2 THEN 1 END) /\n    COUNT(*)\n) AS prozent_gemeinden_hohere_sektor_1\nFROM (\n    SELECT\n        S.name AS gemeinde,\n        SUM(CASE WHEN T.sektor = 'Prim\u00e4r' THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1,\n        SUM(CASE WHEN T.sektor = 'Sekund\u00e4r' THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_2\n    FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2016\n    GROUP BY S.name\n) AS T;\n\n\n### Question\nWie hoch ist der Anteil der Thurgauer Gemeinden, in denen die Zahl der Besch\u00e4ftigten im prim\u00e4ren Sektor zwischen 2013 und 2018 abgenommen hat?\n### SQL query\nSELECT (\n    100.0 * COUNT(CASE WHEN T.beschaftigte_personen_sektor_1_2018 < T.beschaftigte_personen_sektor_1_2013 THEN 1 END) /\n    COUNT(*)\n) AS prozent_gemeinden_abnahme_sektor_1\nFROM (\n    SELECT\n        S.name AS gemeinde,\n        SUM(CASE WHEN T.jahr = 2013 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1_2013,\n        SUM(CASE WHEN T.jahr = 2018 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1_2018\n    FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2013, 2018)\n        AND T.sektor = 'Prim\u00e4r'\n    GROUP BY S.name\n) AS T;\n\n\n### Question\nWie hoch ist der Anteil der Thurgauer Gemeinden, in denen die Zahl der Besch\u00e4ftigten im prim\u00e4ren Sektor zwischen 2013 und 2018 abgenommen hat?\n### SQL query\nSELECT (\n    100.0 * COUNT(CASE WHEN T.beschaftigte_personen_sektor_1_2018 < T.beschaftigte_personen_sektor_1_2013 THEN 1 END) /\n    COUNT(*)\n) AS prozent_gemeinden_abnahme_sektor_1\nFROM (\n    SELECT\n        S.name AS gemeinde,\n        SUM(CASE WHEN T.jahr = 2013 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1_2013,\n        SUM(CASE WHEN T.jahr = 2018 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1_2018\n    FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr IN (2013, 2018)\n        AND T.sektor = 'Prim\u00e4r'\n    GROUP BY S.name\n) AS T;\n\n\n### Question\nWelches sind die f\u00fcnf Thurgauer Gemeinden mit dem h\u00f6chsten Anteil an Besch\u00e4ftigten im sekund\u00e4ren Sektor im Jahr 2020? Geben Sie auch die Anteile in Prozent an.\n### SQL query\nSELECT\n    S.name AS gemeinde,\n    (\n        100.0 * SUM(CASE WHEN T.sektor = 'Sekund\u00e4r' THEN T.beschaftigte_personen ELSE 0 END) /\n        SUM(T.beschaftigte_personen)\n    ) as prozent_beschaftigte_personen_sektor_2\nFROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY prozent_beschaftigte_personen_sektor_2\nDESC LIMIT 5;\n\n\n### Question\nWie viele Besch\u00e4ftigte aus dem ersten Sektor gab es in Arbon und Egnach, Thurgau, in den Jahren 2012 und 2019?\n### SQL query\n",
    "process_time": 7.32191402092576,
    "num_tokens": 2991,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 101,
    "question": "Wie hoch war die monatliche Stickoxidkonzentration (in Teilen pro Milliarde) in der Stadt Z\u00fcrich im Jahr 2019?",
    "query": "SELECT T.monat, T.nox_ppb\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2019\nORDER BY T.monat ASC;\n",
    "db_id": "stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983",
    "generated_query": "SELECT T.monat, T.nox_ppb\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2019\nORDER BY T.monat ASC;",
    "meta_data": [
      {
        "question": "Wie hoch war die CO- und SO2-Konzentration (beide in Mikrogramm/m3) in Z\u00fcrich zwischen Oktober 1999 und Juli 2000?",
        "query": "SELECT T.jahr, T.monat, T.co_mg_m3 * 1000 AS co_ug_m3, T.so2_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND\n    (\n        (T.jahr = 1999 AND T.monat >= 10)\n        OR (T.jahr = 2000 AND T.monat <= 7)\n    )\n    AND T.co_mg_m3 IS NOT NULL\nORDER BY T.jahr ASC, T.monat ASC;\n"
      },
      {
        "question": "Welches war die niedrigste Feinstaubkonzentration (PM2.5), die je in Z\u00fcrich gemessen wurde, und in welchem Jahr war dies?",
        "query": "SELECT T.jahr, T.pm2_5_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pm2_5_ug_m3 IS NOT NULL\nORDER BY T.pm2_5_ug_m3 ASC\nLIMIT 1;\n"
      },
      {
        "question": "Wie hoch war die Schwefeldioxidkonzentration in der Luft in Z\u00fcrich im Jahr 2019? Geben Sie die Konzentration in Milligramm pro Kubikmeter an.",
        "query": "SELECT T.monat, T.so2_ug_m3 / 1000 AS so2_mg_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2019\nORDER BY T.monat ASC;\n"
      },
      {
        "question": "Wie hoch war die CO- und SO2-Konzentration (beide in Mikrogramm/m3) in Z\u00fcrich zwischen Oktober 1999 und Juli 2000?",
        "query": "SELECT T.jahr, T.monat, T.co_mg_m3 * 1000 AS co_ug_m3, T.so2_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND\n    (\n        (T.jahr = 1999 AND T.monat >= 10)\n        OR (T.jahr = 2000 AND T.monat <= 7)\n    )\n    AND T.co_mg_m3 IS NOT NULL\nORDER BY T.jahr ASC, T.monat ASC;\n"
      },
      {
        "question": "Wie hoch war die Schwefeldioxidkonzentration in der Luft in Z\u00fcrich im Jahr 2019? Geben Sie die Konzentration in Milligramm pro Kubikmeter an.",
        "query": "SELECT T.monat, T.so2_ug_m3 / 1000 AS so2_mg_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2019\nORDER BY T.monat ASC;\n"
      },
      {
        "question": "In welchem Monat gibt es in der Stadt Z\u00fcrich generell am wenigsten Partikel in der Luft?",
        "query": "SELECT T.monat, SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) AS monat_avg_pn_1_cm3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pn_1_cm3 IS NOT NULL\nGROUP BY T.monat\nORDER BY SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) ASC\nLIMIT 1;\n"
      },
      {
        "question": "Wie hoch war die Schwefeldioxidkonzentration in der Luft in Z\u00fcrich im Jahr 2019? Geben Sie die Konzentration in Milligramm pro Kubikmeter an.",
        "query": "SELECT T.monat, T.so2_ug_m3 / 1000 AS so2_mg_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2019\nORDER BY T.monat ASC;\n"
      },
      {
        "question": "Zeigen Sie mir die mittlere PM10- und PM2.5-Konzentration in Z\u00fcrich w\u00e4hrend jeder Jahreszeit des Jahres 2018.",
        "query": "SELECT\n    CASE\n        WHEN T.monat IN (12, 1, 2) THEN 'Winter'\n        WHEN T.monat IN (3, 4, 5) THEN 'Fr\u00fchling'\n        WHEN T.monat IN (6, 7, 8) THEN 'Sommer'\n        WHEN T.monat IN (9, 10, 11) THEN 'Herbst'\n    END AS jahreszeit,\n    SUM(T.pm10_ug_m3) / COUNT(T.pm10_ug_m3) AS avg_pm10_ug_m3,\n    SUM(T.pm2_5_ug_m3) / COUNT(T.pm2_5_ug_m3) AS avg_pm2_5_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2018\n    AND T.pm10_ug_m3 IS NOT NULL\n    AND T.pm2_5_ug_m3 IS NOT NULL\nGROUP BY jahreszeit;\n"
      },
      {
        "question": "Wie hoch war die Schwefeldioxidkonzentration in der Luft in Z\u00fcrich im Jahr 2019? Geben Sie die Konzentration in Milligramm pro Kubikmeter an.",
        "query": "SELECT T.monat, T.so2_ug_m3 / 1000 AS so2_mg_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2019\nORDER BY T.monat ASC;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 (\n\tuid SERIAL NOT NULL, \n\tco_mg_m3 NUMERIC, \n\tno2_ug_m3 NUMERIC, \n\tno_ug_m3 NUMERIC, \n\tnox_ppb NUMERIC, \n\tso2_ug_m3 NUMERIC, \n\to3_ug_m3 NUMERIC, \n\tpm10_ug_m3 NUMERIC, \n\tpn_1_cm3 NUMERIC, \n\tpm2_5_ug_m3 NUMERIC, \n\tjahr INTEGER, \n\tmonat NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983_pkey PRIMARY KEY (uid), \n\tCONSTRAINT stadt_zurich_monatlich_luftqualitatsmessun_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nco_mg_m3 : 1.32774193548387087, 0.88400000000000001, 2.63879999999999981, 0.68032258064516127, 2.26774193548387082\nno2_ug_m3 : 40.249032258064517, 69.325000000000003, 58.753928571428574, 75.469999999999999, 41.437586206896555\nno_ug_m3 : 81.2945161290322602, 126.6675000000000040, 125.5083999999999946, 15.8735483870967737, 69.5166666666666657\nnox_ppb : 127.8517857142857110, 35.4219999999999970, 35.1929999999999978, 37.1809677419354827, 162.9167741935483775\nso2_ug_m3 : 15.86225806451612819, 9.97857142857142776, 18.91517241379310477, 25.29035714285714320, 8.18466666666666676\no3_ug_m3 : 7.1503448275862072, 25.9516666666666680, 15.4025806451612901, 63.3323333333333309, 34.2596666666666678\njahr : 1995, 1988, 1989, 1991, 1993\nmonat : 4, 12, 2, 6, 10\n*/\n\n/*\nColumn name, Column discription, Example values\nco_mg_m3, Kohlenmonoxid (CO) in mg/m3, 3.69741935483871,2.3325,2.45451612903226\nno2_ug_m3, Stickstoffdioxid (NO2) in \u00b5g/m3, 38.5848387096774,47.8067857142857,48.0387096774194\nno_ug_m3, Stickstoffmonoxid (NO) in \u00b5g/m3, 162.903870967742,157.969285714286,171.871290322581\nnox_ppb, Stickstoffoxide (NOx) in ppb, 150.781612903226,151.648214285714,162.916774193548\nso2_ug_m3, Schwefeldioxid (SO2) in \u00b5g/m3, 83.6127586206897,100.517142857143,69.5396666666667\no3_ug_m3, Ozon (O3) in \u00b5g/m3, 11.4648148148148,6.99464285714286\npm10_ug_m3, Schwebestaub PM10 (Durchmesser 10\u00b5m oder weniger) in \u00b5g/m3, 33.9512,30.7521428571429\npn_1_cm3, Partikelanzahl pro cm3, 23403.0509090909,12632.1964516129\npm2_5_ug_m3, Schwebestaub PM2.5 (Durchmesser 2,5\u00b5m oder weniger) in \u00b5g/m3, 26.6368181818182,16.9007407407407\nmonat, Monat, 1,2,3\n*/\n\n\n\n### Question\nWie hoch war die CO- und SO2-Konzentration (beide in Mikrogramm/m3) in Z\u00fcrich zwischen Oktober 1999 und Juli 2000?\n### SQL query\nSELECT T.jahr, T.monat, T.co_mg_m3 * 1000 AS co_ug_m3, T.so2_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND\n    (\n        (T.jahr = 1999 AND T.monat >= 10)\n        OR (T.jahr = 2000 AND T.monat <= 7)\n    )\n    AND T.co_mg_m3 IS NOT NULL\nORDER BY T.jahr ASC, T.monat ASC;\n\n\n### Question\nWelches war die niedrigste Feinstaubkonzentration (PM2.5), die je in Z\u00fcrich gemessen wurde, und in welchem Jahr war dies?\n### SQL query\nSELECT T.jahr, T.pm2_5_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pm2_5_ug_m3 IS NOT NULL\nORDER BY T.pm2_5_ug_m3 ASC\nLIMIT 1;\n\n\n### Question\nWie hoch war die Schwefeldioxidkonzentration in der Luft in Z\u00fcrich im Jahr 2019? Geben Sie die Konzentration in Milligramm pro Kubikmeter an.\n### SQL query\nSELECT T.monat, T.so2_ug_m3 / 1000 AS so2_mg_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2019\nORDER BY T.monat ASC;\n\n\n### Question\nWie hoch war die CO- und SO2-Konzentration (beide in Mikrogramm/m3) in Z\u00fcrich zwischen Oktober 1999 und Juli 2000?\n### SQL query\nSELECT T.jahr, T.monat, T.co_mg_m3 * 1000 AS co_ug_m3, T.so2_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND\n    (\n        (T.jahr = 1999 AND T.monat >= 10)\n        OR (T.jahr = 2000 AND T.monat <= 7)\n    )\n    AND T.co_mg_m3 IS NOT NULL\nORDER BY T.jahr ASC, T.monat ASC;\n\n\n### Question\nWie hoch war die Schwefeldioxidkonzentration in der Luft in Z\u00fcrich im Jahr 2019? Geben Sie die Konzentration in Milligramm pro Kubikmeter an.\n### SQL query\nSELECT T.monat, T.so2_ug_m3 / 1000 AS so2_mg_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2019\nORDER BY T.monat ASC;\n\n\n### Question\nIn welchem Monat gibt es in der Stadt Z\u00fcrich generell am wenigsten Partikel in der Luft?\n### SQL query\nSELECT T.monat, SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) AS monat_avg_pn_1_cm3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pn_1_cm3 IS NOT NULL\nGROUP BY T.monat\nORDER BY SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) ASC\nLIMIT 1;\n\n\n### Question\nWie hoch war die Schwefeldioxidkonzentration in der Luft in Z\u00fcrich im Jahr 2019? Geben Sie die Konzentration in Milligramm pro Kubikmeter an.\n### SQL query\nSELECT T.monat, T.so2_ug_m3 / 1000 AS so2_mg_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2019\nORDER BY T.monat ASC;\n\n\n### Question\nZeigen Sie mir die mittlere PM10- und PM2.5-Konzentration in Z\u00fcrich w\u00e4hrend jeder Jahreszeit des Jahres 2018.\n### SQL query\nSELECT\n    CASE\n        WHEN T.monat IN (12, 1, 2) THEN 'Winter'\n        WHEN T.monat IN (3, 4, 5) THEN 'Fr\u00fchling'\n        WHEN T.monat IN (6, 7, 8) THEN 'Sommer'\n        WHEN T.monat IN (9, 10, 11) THEN 'Herbst'\n    END AS jahreszeit,\n    SUM(T.pm10_ug_m3) / COUNT(T.pm10_ug_m3) AS avg_pm10_ug_m3,\n    SUM(T.pm2_5_ug_m3) / COUNT(T.pm2_5_ug_m3) AS avg_pm2_5_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2018\n    AND T.pm10_ug_m3 IS NOT NULL\n    AND T.pm2_5_ug_m3 IS NOT NULL\nGROUP BY jahreszeit;\n\n\n### Question\nWie hoch war die Schwefeldioxidkonzentration in der Luft in Z\u00fcrich im Jahr 2019? Geben Sie die Konzentration in Milligramm pro Kubikmeter an.\n### SQL query\nSELECT T.monat, T.so2_ug_m3 / 1000 AS so2_mg_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2019\nORDER BY T.monat ASC;\n\n\n### Question\nWie hoch war die monatliche Stickoxidkonzentration (in Teilen pro Milliarde) in der Stadt Z\u00fcrich im Jahr 2019?\n### SQL query\n",
    "process_time": 6.31735319388099,
    "num_tokens": 3349,
    "hardness": "hard",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 102,
    "question": "Wie hoch war die durchschnittliche Kohlenmonoxid-Konzentration in der Z\u00fcrcher Luft im Januar und im Juli, bezogen auf den Zeitraum 1990-2000?",
    "query": "SELECT\n    T.monat,\n    SUM(T.co_mg_m3) / COUNT(T.co_mg_m3) AS avg_co_mg_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr >= 1990\n    AND T.jahr <= 2000\n    AND T.co_mg_m3 IS NOT NULL\n    AND T.monat IN (1, 7)\nGROUP BY T.monat;\n",
    "db_id": "stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983",
    "generated_query": "SELECT\n    CASE\n        WHEN T.monat = 1 THEN 'Januar'\n        WHEN T.monat = 7 THEN 'Juli'\n    END AS monat,\n    AVG(T.co_mg_m3) AS avg_co_mg_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr >= 1990\n    AND T.jahr <= 2000\n    AND T.co_mg_m3 IS NOT NULL\nGROUP BY monat;",
    "meta_data": [
      {
        "question": "Wie hoch war die j\u00e4hrliche Durchschnittskonzentration von Stickstoffmonoxid und Stickstoffdioxid in der Stadt Z\u00fcrich in den Jahren 1993, 2003, 2013 und 2023?",
        "query": "SELECT T.jahr, SUM(T.no_ug_m3) / COUNT(T.no_ug_m3) AS jahr_avg_no_ug_m3, SUM(T.no2_ug_m3) / COUNT(T.no2_ug_m3) AS avg_no2_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr IN (1993, 2003, 2013, 2023)\n    AND T.no_ug_m3 IS NOT NULL\nGROUP BY T.jahr;\n"
      },
      {
        "question": "Zeigen Sie mir die Partikelzahl f\u00fcr jeden Monat in Z\u00fcrich, im Durchschnitt aller verf\u00fcgbaren Jahre.",
        "query": "SELECT T.monat, SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) AS avg_pn_1_cm3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pn_1_cm3 IS NOT NULL\nGROUP BY T.monat;\n"
      },
      {
        "question": "In welchem Monat gibt es in der Stadt Z\u00fcrich generell am wenigsten Partikel in der Luft?",
        "query": "SELECT T.monat, SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) AS monat_avg_pn_1_cm3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pn_1_cm3 IS NOT NULL\nGROUP BY T.monat\nORDER BY SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) ASC\nLIMIT 1;\n"
      },
      {
        "question": "Nennen Sie mir die Konzentration von Stickoxiden in der Luft von Z\u00fcrich, in Teilen pro Million (ppm), f\u00fcr den Monat Januar in den Jahren 2017 bis 2021.",
        "query": "SELECT T.jahr, T.nox_ppb / 1000 AS nox_ppm_januar\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.monat = 1\n    AND T.jahr >= 2017\n    AND T.jahr <= 2021\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "In welchem Monat gibt es in der Stadt Z\u00fcrich generell am wenigsten Partikel in der Luft?",
        "query": "SELECT T.monat, SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) AS monat_avg_pn_1_cm3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pn_1_cm3 IS NOT NULL\nGROUP BY T.monat\nORDER BY SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) ASC\nLIMIT 1;\n"
      },
      {
        "question": "In welchem Monat gibt es in der Stadt Z\u00fcrich generell am wenigsten Partikel in der Luft?",
        "query": "SELECT T.monat, SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) AS monat_avg_pn_1_cm3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pn_1_cm3 IS NOT NULL\nGROUP BY T.monat\nORDER BY SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) ASC\nLIMIT 1;\n"
      },
      {
        "question": "Wie hoch ist die relative Ver\u00e4nderung der PM10-Konzentration in Z\u00fcrich von 2017 bis 2023 in Prozent?",
        "query": "SELECT\n    (\n        100.0 * SUM(\n            CASE\n                WHEN T.jahr = 2017 THEN T.pm10_ug_m3\n                WHEN T.jahr = 2023 THEN - T.pm10_ug_m3\n            END\n        ) / SUM(CASE WHEN T.jahr = 2017 THEN T.pm10_ug_m3 END)\n    ) AS pm10_anderung_2017_2023_prozent\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr IN (2017, 2023)\n    AND T.pm10_ug_m3 IS NOT NULL;\n"
      },
      {
        "question": "Nennen Sie mir die Konzentration von Stickoxiden in der Luft von Z\u00fcrich, in Teilen pro Million (ppm), f\u00fcr den Monat Januar in den Jahren 2017 bis 2021.",
        "query": "SELECT T.jahr, T.nox_ppb / 1000 AS nox_ppm_januar\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.monat = 1\n    AND T.jahr >= 2017\n    AND T.jahr <= 2021\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Zeigen Sie mir die mittlere PM10- und PM2.5-Konzentration in Z\u00fcrich w\u00e4hrend jeder Jahreszeit des Jahres 2018.",
        "query": "SELECT\n    CASE\n        WHEN T.monat IN (12, 1, 2) THEN 'Winter'\n        WHEN T.monat IN (3, 4, 5) THEN 'Fr\u00fchling'\n        WHEN T.monat IN (6, 7, 8) THEN 'Sommer'\n        WHEN T.monat IN (9, 10, 11) THEN 'Herbst'\n    END AS jahreszeit,\n    SUM(T.pm10_ug_m3) / COUNT(T.pm10_ug_m3) AS avg_pm10_ug_m3,\n    SUM(T.pm2_5_ug_m3) / COUNT(T.pm2_5_ug_m3) AS avg_pm2_5_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2018\n    AND T.pm10_ug_m3 IS NOT NULL\n    AND T.pm2_5_ug_m3 IS NOT NULL\nGROUP BY jahreszeit;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 (\n\tuid SERIAL NOT NULL, \n\tco_mg_m3 NUMERIC, \n\tno2_ug_m3 NUMERIC, \n\tno_ug_m3 NUMERIC, \n\tnox_ppb NUMERIC, \n\tso2_ug_m3 NUMERIC, \n\to3_ug_m3 NUMERIC, \n\tpm10_ug_m3 NUMERIC, \n\tpn_1_cm3 NUMERIC, \n\tpm2_5_ug_m3 NUMERIC, \n\tjahr INTEGER, \n\tmonat NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983_pkey PRIMARY KEY (uid), \n\tCONSTRAINT stadt_zurich_monatlich_luftqualitatsmessun_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nco_mg_m3 : 1.32774193548387087, 0.88400000000000001, 2.63879999999999981, 0.68032258064516127, 2.26774193548387082\nno2_ug_m3 : 40.249032258064517, 69.325000000000003, 58.753928571428574, 75.469999999999999, 41.437586206896555\nno_ug_m3 : 81.2945161290322602, 126.6675000000000040, 125.5083999999999946, 15.8735483870967737, 69.5166666666666657\nnox_ppb : 127.8517857142857110, 35.4219999999999970, 35.1929999999999978, 37.1809677419354827, 162.9167741935483775\nso2_ug_m3 : 15.86225806451612819, 9.97857142857142776, 18.91517241379310477, 25.29035714285714320, 8.18466666666666676\no3_ug_m3 : 7.1503448275862072, 25.9516666666666680, 15.4025806451612901, 63.3323333333333309, 34.2596666666666678\njahr : 1995, 1988, 1989, 1991, 1993\nmonat : 4, 12, 2, 6, 10\n*/\n\n/*\nColumn name, Column discription, Example values\nco_mg_m3, Kohlenmonoxid (CO) in mg/m3, 3.69741935483871,2.3325,2.45451612903226\nno2_ug_m3, Stickstoffdioxid (NO2) in \u00b5g/m3, 38.5848387096774,47.8067857142857,48.0387096774194\nno_ug_m3, Stickstoffmonoxid (NO) in \u00b5g/m3, 162.903870967742,157.969285714286,171.871290322581\nnox_ppb, Stickstoffoxide (NOx) in ppb, 150.781612903226,151.648214285714,162.916774193548\nso2_ug_m3, Schwefeldioxid (SO2) in \u00b5g/m3, 83.6127586206897,100.517142857143,69.5396666666667\no3_ug_m3, Ozon (O3) in \u00b5g/m3, 11.4648148148148,6.99464285714286\npm10_ug_m3, Schwebestaub PM10 (Durchmesser 10\u00b5m oder weniger) in \u00b5g/m3, 33.9512,30.7521428571429\npn_1_cm3, Partikelanzahl pro cm3, 23403.0509090909,12632.1964516129\npm2_5_ug_m3, Schwebestaub PM2.5 (Durchmesser 2,5\u00b5m oder weniger) in \u00b5g/m3, 26.6368181818182,16.9007407407407\nmonat, Monat, 1,2,3\n*/\n\n\n\n### Question\nWie hoch war die j\u00e4hrliche Durchschnittskonzentration von Stickstoffmonoxid und Stickstoffdioxid in der Stadt Z\u00fcrich in den Jahren 1993, 2003, 2013 und 2023?\n### SQL query\nSELECT T.jahr, SUM(T.no_ug_m3) / COUNT(T.no_ug_m3) AS jahr_avg_no_ug_m3, SUM(T.no2_ug_m3) / COUNT(T.no2_ug_m3) AS avg_no2_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr IN (1993, 2003, 2013, 2023)\n    AND T.no_ug_m3 IS NOT NULL\nGROUP BY T.jahr;\n\n\n### Question\nZeigen Sie mir die Partikelzahl f\u00fcr jeden Monat in Z\u00fcrich, im Durchschnitt aller verf\u00fcgbaren Jahre.\n### SQL query\nSELECT T.monat, SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) AS avg_pn_1_cm3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pn_1_cm3 IS NOT NULL\nGROUP BY T.monat;\n\n\n### Question\nIn welchem Monat gibt es in der Stadt Z\u00fcrich generell am wenigsten Partikel in der Luft?\n### SQL query\nSELECT T.monat, SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) AS monat_avg_pn_1_cm3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pn_1_cm3 IS NOT NULL\nGROUP BY T.monat\nORDER BY SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) ASC\nLIMIT 1;\n\n\n### Question\nNennen Sie mir die Konzentration von Stickoxiden in der Luft von Z\u00fcrich, in Teilen pro Million (ppm), f\u00fcr den Monat Januar in den Jahren 2017 bis 2021.\n### SQL query\nSELECT T.jahr, T.nox_ppb / 1000 AS nox_ppm_januar\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.monat = 1\n    AND T.jahr >= 2017\n    AND T.jahr <= 2021\nORDER BY T.jahr ASC;\n\n\n### Question\nIn welchem Monat gibt es in der Stadt Z\u00fcrich generell am wenigsten Partikel in der Luft?\n### SQL query\nSELECT T.monat, SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) AS monat_avg_pn_1_cm3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pn_1_cm3 IS NOT NULL\nGROUP BY T.monat\nORDER BY SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) ASC\nLIMIT 1;\n\n\n### Question\nIn welchem Monat gibt es in der Stadt Z\u00fcrich generell am wenigsten Partikel in der Luft?\n### SQL query\nSELECT T.monat, SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) AS monat_avg_pn_1_cm3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pn_1_cm3 IS NOT NULL\nGROUP BY T.monat\nORDER BY SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) ASC\nLIMIT 1;\n\n\n### Question\nWie hoch ist die relative Ver\u00e4nderung der PM10-Konzentration in Z\u00fcrich von 2017 bis 2023 in Prozent?\n### SQL query\nSELECT\n    (\n        100.0 * SUM(\n            CASE\n                WHEN T.jahr = 2017 THEN T.pm10_ug_m3\n                WHEN T.jahr = 2023 THEN - T.pm10_ug_m3\n            END\n        ) / SUM(CASE WHEN T.jahr = 2017 THEN T.pm10_ug_m3 END)\n    ) AS pm10_anderung_2017_2023_prozent\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr IN (2017, 2023)\n    AND T.pm10_ug_m3 IS NOT NULL;\n\n\n### Question\nNennen Sie mir die Konzentration von Stickoxiden in der Luft von Z\u00fcrich, in Teilen pro Million (ppm), f\u00fcr den Monat Januar in den Jahren 2017 bis 2021.\n### SQL query\nSELECT T.jahr, T.nox_ppb / 1000 AS nox_ppm_januar\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.monat = 1\n    AND T.jahr >= 2017\n    AND T.jahr <= 2021\nORDER BY T.jahr ASC;\n\n\n### Question\nZeigen Sie mir die mittlere PM10- und PM2.5-Konzentration in Z\u00fcrich w\u00e4hrend jeder Jahreszeit des Jahres 2018.\n### SQL query\nSELECT\n    CASE\n        WHEN T.monat IN (12, 1, 2) THEN 'Winter'\n        WHEN T.monat IN (3, 4, 5) THEN 'Fr\u00fchling'\n        WHEN T.monat IN (6, 7, 8) THEN 'Sommer'\n        WHEN T.monat IN (9, 10, 11) THEN 'Herbst'\n    END AS jahreszeit,\n    SUM(T.pm10_ug_m3) / COUNT(T.pm10_ug_m3) AS avg_pm10_ug_m3,\n    SUM(T.pm2_5_ug_m3) / COUNT(T.pm2_5_ug_m3) AS avg_pm2_5_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2018\n    AND T.pm10_ug_m3 IS NOT NULL\n    AND T.pm2_5_ug_m3 IS NOT NULL\nGROUP BY jahreszeit;\n\n\n### Question\nWie hoch war die durchschnittliche Kohlenmonoxid-Konzentration in der Z\u00fcrcher Luft im Januar und im Juli, bezogen auf den Zeitraum 1990-2000?\n### SQL query\n",
    "process_time": 17.072905704844743,
    "num_tokens": 3467,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 103,
    "question": "Wie viel Ozon war im Jahr 2005 jeden Monat in der Luft der Stadt Z\u00fcrich?",
    "query": "SELECT T.monat, T.o3_ug_m3 AS o3_ug_m3_2005\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2005;\n",
    "db_id": "stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983",
    "generated_query": "SELECT T.monat, T.o3_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2005\nORDER BY T.monat ASC;",
    "meta_data": [
      {
        "question": "Zeigen Sie mir die mittlere PM10- und PM2.5-Konzentration in Z\u00fcrich w\u00e4hrend jeder Jahreszeit des Jahres 2018.",
        "query": "SELECT\n    CASE\n        WHEN T.monat IN (12, 1, 2) THEN 'Winter'\n        WHEN T.monat IN (3, 4, 5) THEN 'Fr\u00fchling'\n        WHEN T.monat IN (6, 7, 8) THEN 'Sommer'\n        WHEN T.monat IN (9, 10, 11) THEN 'Herbst'\n    END AS jahreszeit,\n    SUM(T.pm10_ug_m3) / COUNT(T.pm10_ug_m3) AS avg_pm10_ug_m3,\n    SUM(T.pm2_5_ug_m3) / COUNT(T.pm2_5_ug_m3) AS avg_pm2_5_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2018\n    AND T.pm10_ug_m3 IS NOT NULL\n    AND T.pm2_5_ug_m3 IS NOT NULL\nGROUP BY jahreszeit;\n"
      },
      {
        "question": "Zeigen Sie mir die mittlere PM10- und PM2.5-Konzentration in Z\u00fcrich w\u00e4hrend jeder Jahreszeit des Jahres 2018.",
        "query": "SELECT\n    CASE\n        WHEN T.monat IN (12, 1, 2) THEN 'Winter'\n        WHEN T.monat IN (3, 4, 5) THEN 'Fr\u00fchling'\n        WHEN T.monat IN (6, 7, 8) THEN 'Sommer'\n        WHEN T.monat IN (9, 10, 11) THEN 'Herbst'\n    END AS jahreszeit,\n    SUM(T.pm10_ug_m3) / COUNT(T.pm10_ug_m3) AS avg_pm10_ug_m3,\n    SUM(T.pm2_5_ug_m3) / COUNT(T.pm2_5_ug_m3) AS avg_pm2_5_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2018\n    AND T.pm10_ug_m3 IS NOT NULL\n    AND T.pm2_5_ug_m3 IS NOT NULL\nGROUP BY jahreszeit;\n"
      },
      {
        "question": "Welches war die niedrigste Feinstaubkonzentration (PM2.5), die je in Z\u00fcrich gemessen wurde, und in welchem Jahr war dies?",
        "query": "SELECT T.jahr, T.pm2_5_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pm2_5_ug_m3 IS NOT NULL\nORDER BY T.pm2_5_ug_m3 ASC\nLIMIT 1;\n"
      },
      {
        "question": "Wie hoch war die j\u00e4hrliche Durchschnittskonzentration von Stickstoffmonoxid und Stickstoffdioxid in der Stadt Z\u00fcrich in den Jahren 1993, 2003, 2013 und 2023?",
        "query": "SELECT T.jahr, SUM(T.no_ug_m3) / COUNT(T.no_ug_m3) AS jahr_avg_no_ug_m3, SUM(T.no2_ug_m3) / COUNT(T.no2_ug_m3) AS avg_no2_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr IN (1993, 2003, 2013, 2023)\n    AND T.no_ug_m3 IS NOT NULL\nGROUP BY T.jahr;\n"
      },
      {
        "question": "Wie hoch war die Schwefeldioxidkonzentration in der Luft in Z\u00fcrich im Jahr 2019? Geben Sie die Konzentration in Milligramm pro Kubikmeter an.",
        "query": "SELECT T.monat, T.so2_ug_m3 / 1000 AS so2_mg_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2019\nORDER BY T.monat ASC;\n"
      },
      {
        "question": "Zeigen Sie mir die mittlere PM10- und PM2.5-Konzentration in Z\u00fcrich w\u00e4hrend jeder Jahreszeit des Jahres 2018.",
        "query": "SELECT\n    CASE\n        WHEN T.monat IN (12, 1, 2) THEN 'Winter'\n        WHEN T.monat IN (3, 4, 5) THEN 'Fr\u00fchling'\n        WHEN T.monat IN (6, 7, 8) THEN 'Sommer'\n        WHEN T.monat IN (9, 10, 11) THEN 'Herbst'\n    END AS jahreszeit,\n    SUM(T.pm10_ug_m3) / COUNT(T.pm10_ug_m3) AS avg_pm10_ug_m3,\n    SUM(T.pm2_5_ug_m3) / COUNT(T.pm2_5_ug_m3) AS avg_pm2_5_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2018\n    AND T.pm10_ug_m3 IS NOT NULL\n    AND T.pm2_5_ug_m3 IS NOT NULL\nGROUP BY jahreszeit;\n"
      },
      {
        "question": "Wie hoch ist die relative Ver\u00e4nderung der PM10-Konzentration in Z\u00fcrich von 2017 bis 2023 in Prozent?",
        "query": "SELECT\n    (\n        100.0 * SUM(\n            CASE\n                WHEN T.jahr = 2017 THEN T.pm10_ug_m3\n                WHEN T.jahr = 2023 THEN - T.pm10_ug_m3\n            END\n        ) / SUM(CASE WHEN T.jahr = 2017 THEN T.pm10_ug_m3 END)\n    ) AS pm10_anderung_2017_2023_prozent\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr IN (2017, 2023)\n    AND T.pm10_ug_m3 IS NOT NULL;\n"
      },
      {
        "question": "Nennen Sie mir die Konzentration von Stickoxiden in der Luft von Z\u00fcrich, in Teilen pro Million (ppm), f\u00fcr den Monat Januar in den Jahren 2017 bis 2021.",
        "query": "SELECT T.jahr, T.nox_ppb / 1000 AS nox_ppm_januar\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.monat = 1\n    AND T.jahr >= 2017\n    AND T.jahr <= 2021\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Wie hoch ist die relative Ver\u00e4nderung der PM10-Konzentration in Z\u00fcrich von 2017 bis 2023 in Prozent?",
        "query": "SELECT\n    (\n        100.0 * SUM(\n            CASE\n                WHEN T.jahr = 2017 THEN T.pm10_ug_m3\n                WHEN T.jahr = 2023 THEN - T.pm10_ug_m3\n            END\n        ) / SUM(CASE WHEN T.jahr = 2017 THEN T.pm10_ug_m3 END)\n    ) AS pm10_anderung_2017_2023_prozent\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr IN (2017, 2023)\n    AND T.pm10_ug_m3 IS NOT NULL;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 (\n\tuid SERIAL NOT NULL, \n\tco_mg_m3 NUMERIC, \n\tno2_ug_m3 NUMERIC, \n\tno_ug_m3 NUMERIC, \n\tnox_ppb NUMERIC, \n\tso2_ug_m3 NUMERIC, \n\to3_ug_m3 NUMERIC, \n\tpm10_ug_m3 NUMERIC, \n\tpn_1_cm3 NUMERIC, \n\tpm2_5_ug_m3 NUMERIC, \n\tjahr INTEGER, \n\tmonat NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983_pkey PRIMARY KEY (uid), \n\tCONSTRAINT stadt_zurich_monatlich_luftqualitatsmessun_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nco_mg_m3 : 1.32774193548387087, 0.88400000000000001, 2.63879999999999981, 0.68032258064516127, 2.26774193548387082\nno2_ug_m3 : 40.249032258064517, 69.325000000000003, 58.753928571428574, 75.469999999999999, 41.437586206896555\nno_ug_m3 : 81.2945161290322602, 126.6675000000000040, 125.5083999999999946, 15.8735483870967737, 69.5166666666666657\nnox_ppb : 127.8517857142857110, 35.4219999999999970, 35.1929999999999978, 37.1809677419354827, 162.9167741935483775\nso2_ug_m3 : 15.86225806451612819, 9.97857142857142776, 18.91517241379310477, 25.29035714285714320, 8.18466666666666676\no3_ug_m3 : 7.1503448275862072, 25.9516666666666680, 15.4025806451612901, 63.3323333333333309, 34.2596666666666678\njahr : 1995, 1988, 1989, 1991, 1993\nmonat : 4, 12, 2, 6, 10\n*/\n\n/*\nColumn name, Column discription, Example values\nco_mg_m3, Kohlenmonoxid (CO) in mg/m3, 3.69741935483871,2.3325,2.45451612903226\nno2_ug_m3, Stickstoffdioxid (NO2) in \u00b5g/m3, 38.5848387096774,47.8067857142857,48.0387096774194\nno_ug_m3, Stickstoffmonoxid (NO) in \u00b5g/m3, 162.903870967742,157.969285714286,171.871290322581\nnox_ppb, Stickstoffoxide (NOx) in ppb, 150.781612903226,151.648214285714,162.916774193548\nso2_ug_m3, Schwefeldioxid (SO2) in \u00b5g/m3, 83.6127586206897,100.517142857143,69.5396666666667\no3_ug_m3, Ozon (O3) in \u00b5g/m3, 11.4648148148148,6.99464285714286\npm10_ug_m3, Schwebestaub PM10 (Durchmesser 10\u00b5m oder weniger) in \u00b5g/m3, 33.9512,30.7521428571429\npn_1_cm3, Partikelanzahl pro cm3, 23403.0509090909,12632.1964516129\npm2_5_ug_m3, Schwebestaub PM2.5 (Durchmesser 2,5\u00b5m oder weniger) in \u00b5g/m3, 26.6368181818182,16.9007407407407\nmonat, Monat, 1,2,3\n*/\n\n\n\n### Question\nZeigen Sie mir die mittlere PM10- und PM2.5-Konzentration in Z\u00fcrich w\u00e4hrend jeder Jahreszeit des Jahres 2018.\n### SQL query\nSELECT\n    CASE\n        WHEN T.monat IN (12, 1, 2) THEN 'Winter'\n        WHEN T.monat IN (3, 4, 5) THEN 'Fr\u00fchling'\n        WHEN T.monat IN (6, 7, 8) THEN 'Sommer'\n        WHEN T.monat IN (9, 10, 11) THEN 'Herbst'\n    END AS jahreszeit,\n    SUM(T.pm10_ug_m3) / COUNT(T.pm10_ug_m3) AS avg_pm10_ug_m3,\n    SUM(T.pm2_5_ug_m3) / COUNT(T.pm2_5_ug_m3) AS avg_pm2_5_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2018\n    AND T.pm10_ug_m3 IS NOT NULL\n    AND T.pm2_5_ug_m3 IS NOT NULL\nGROUP BY jahreszeit;\n\n\n### Question\nZeigen Sie mir die mittlere PM10- und PM2.5-Konzentration in Z\u00fcrich w\u00e4hrend jeder Jahreszeit des Jahres 2018.\n### SQL query\nSELECT\n    CASE\n        WHEN T.monat IN (12, 1, 2) THEN 'Winter'\n        WHEN T.monat IN (3, 4, 5) THEN 'Fr\u00fchling'\n        WHEN T.monat IN (6, 7, 8) THEN 'Sommer'\n        WHEN T.monat IN (9, 10, 11) THEN 'Herbst'\n    END AS jahreszeit,\n    SUM(T.pm10_ug_m3) / COUNT(T.pm10_ug_m3) AS avg_pm10_ug_m3,\n    SUM(T.pm2_5_ug_m3) / COUNT(T.pm2_5_ug_m3) AS avg_pm2_5_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2018\n    AND T.pm10_ug_m3 IS NOT NULL\n    AND T.pm2_5_ug_m3 IS NOT NULL\nGROUP BY jahreszeit;\n\n\n### Question\nWelches war die niedrigste Feinstaubkonzentration (PM2.5), die je in Z\u00fcrich gemessen wurde, und in welchem Jahr war dies?\n### SQL query\nSELECT T.jahr, T.pm2_5_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pm2_5_ug_m3 IS NOT NULL\nORDER BY T.pm2_5_ug_m3 ASC\nLIMIT 1;\n\n\n### Question\nWie hoch war die j\u00e4hrliche Durchschnittskonzentration von Stickstoffmonoxid und Stickstoffdioxid in der Stadt Z\u00fcrich in den Jahren 1993, 2003, 2013 und 2023?\n### SQL query\nSELECT T.jahr, SUM(T.no_ug_m3) / COUNT(T.no_ug_m3) AS jahr_avg_no_ug_m3, SUM(T.no2_ug_m3) / COUNT(T.no2_ug_m3) AS avg_no2_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr IN (1993, 2003, 2013, 2023)\n    AND T.no_ug_m3 IS NOT NULL\nGROUP BY T.jahr;\n\n\n### Question\nWie hoch war die Schwefeldioxidkonzentration in der Luft in Z\u00fcrich im Jahr 2019? Geben Sie die Konzentration in Milligramm pro Kubikmeter an.\n### SQL query\nSELECT T.monat, T.so2_ug_m3 / 1000 AS so2_mg_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2019\nORDER BY T.monat ASC;\n\n\n### Question\nZeigen Sie mir die mittlere PM10- und PM2.5-Konzentration in Z\u00fcrich w\u00e4hrend jeder Jahreszeit des Jahres 2018.\n### SQL query\nSELECT\n    CASE\n        WHEN T.monat IN (12, 1, 2) THEN 'Winter'\n        WHEN T.monat IN (3, 4, 5) THEN 'Fr\u00fchling'\n        WHEN T.monat IN (6, 7, 8) THEN 'Sommer'\n        WHEN T.monat IN (9, 10, 11) THEN 'Herbst'\n    END AS jahreszeit,\n    SUM(T.pm10_ug_m3) / COUNT(T.pm10_ug_m3) AS avg_pm10_ug_m3,\n    SUM(T.pm2_5_ug_m3) / COUNT(T.pm2_5_ug_m3) AS avg_pm2_5_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2018\n    AND T.pm10_ug_m3 IS NOT NULL\n    AND T.pm2_5_ug_m3 IS NOT NULL\nGROUP BY jahreszeit;\n\n\n### Question\nWie hoch ist die relative Ver\u00e4nderung der PM10-Konzentration in Z\u00fcrich von 2017 bis 2023 in Prozent?\n### SQL query\nSELECT\n    (\n        100.0 * SUM(\n            CASE\n                WHEN T.jahr = 2017 THEN T.pm10_ug_m3\n                WHEN T.jahr = 2023 THEN - T.pm10_ug_m3\n            END\n        ) / SUM(CASE WHEN T.jahr = 2017 THEN T.pm10_ug_m3 END)\n    ) AS pm10_anderung_2017_2023_prozent\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr IN (2017, 2023)\n    AND T.pm10_ug_m3 IS NOT NULL;\n\n\n### Question\nNennen Sie mir die Konzentration von Stickoxiden in der Luft von Z\u00fcrich, in Teilen pro Million (ppm), f\u00fcr den Monat Januar in den Jahren 2017 bis 2021.\n### SQL query\nSELECT T.jahr, T.nox_ppb / 1000 AS nox_ppm_januar\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.monat = 1\n    AND T.jahr >= 2017\n    AND T.jahr <= 2021\nORDER BY T.jahr ASC;\n\n\n### Question\nWie hoch ist die relative Ver\u00e4nderung der PM10-Konzentration in Z\u00fcrich von 2017 bis 2023 in Prozent?\n### SQL query\nSELECT\n    (\n        100.0 * SUM(\n            CASE\n                WHEN T.jahr = 2017 THEN T.pm10_ug_m3\n                WHEN T.jahr = 2023 THEN - T.pm10_ug_m3\n            END\n        ) / SUM(CASE WHEN T.jahr = 2017 THEN T.pm10_ug_m3 END)\n    ) AS pm10_anderung_2017_2023_prozent\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr IN (2017, 2023)\n    AND T.pm10_ug_m3 IS NOT NULL;\n\n\n### Question\nWie viel Ozon war im Jahr 2005 jeden Monat in der Luft der Stadt Z\u00fcrich?\n### SQL query\n",
    "process_time": 9.39245812711306,
    "num_tokens": 3739,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 104,
    "question": "Wann erreichte die Kohlenmonoxidkonzentration in der Luft in der Stadt Z\u00fcrich ihr Maximum? Geben Sie auch die Konzentration in mg/m3 an.",
    "query": "SELECT T.jahr, T.monat, T.co_mg_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.co_mg_m3 IS NOT NULL\nORDER BY T.co_mg_m3 DESC\nLIMIT 1;\n",
    "db_id": "stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983",
    "generated_query": "SELECT T.jahr, T.monat, T.co_mg_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.co_mg_m3 IS NOT NULL\nORDER BY T.co_mg_m3 DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Zeigen Sie mir die Partikelzahl f\u00fcr jeden Monat in Z\u00fcrich, im Durchschnitt aller verf\u00fcgbaren Jahre.",
        "query": "SELECT T.monat, SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) AS avg_pn_1_cm3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pn_1_cm3 IS NOT NULL\nGROUP BY T.monat;\n"
      },
      {
        "question": "Zeigen Sie mir die mittlere PM10- und PM2.5-Konzentration in Z\u00fcrich w\u00e4hrend jeder Jahreszeit des Jahres 2018.",
        "query": "SELECT\n    CASE\n        WHEN T.monat IN (12, 1, 2) THEN 'Winter'\n        WHEN T.monat IN (3, 4, 5) THEN 'Fr\u00fchling'\n        WHEN T.monat IN (6, 7, 8) THEN 'Sommer'\n        WHEN T.monat IN (9, 10, 11) THEN 'Herbst'\n    END AS jahreszeit,\n    SUM(T.pm10_ug_m3) / COUNT(T.pm10_ug_m3) AS avg_pm10_ug_m3,\n    SUM(T.pm2_5_ug_m3) / COUNT(T.pm2_5_ug_m3) AS avg_pm2_5_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2018\n    AND T.pm10_ug_m3 IS NOT NULL\n    AND T.pm2_5_ug_m3 IS NOT NULL\nGROUP BY jahreszeit;\n"
      },
      {
        "question": "Wie hoch war die Schwefeldioxidkonzentration in der Luft in Z\u00fcrich im Jahr 2019? Geben Sie die Konzentration in Milligramm pro Kubikmeter an.",
        "query": "SELECT T.monat, T.so2_ug_m3 / 1000 AS so2_mg_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2019\nORDER BY T.monat ASC;\n"
      },
      {
        "question": "Zeigen Sie mir die mittlere PM10- und PM2.5-Konzentration in Z\u00fcrich w\u00e4hrend jeder Jahreszeit des Jahres 2018.",
        "query": "SELECT\n    CASE\n        WHEN T.monat IN (12, 1, 2) THEN 'Winter'\n        WHEN T.monat IN (3, 4, 5) THEN 'Fr\u00fchling'\n        WHEN T.monat IN (6, 7, 8) THEN 'Sommer'\n        WHEN T.monat IN (9, 10, 11) THEN 'Herbst'\n    END AS jahreszeit,\n    SUM(T.pm10_ug_m3) / COUNT(T.pm10_ug_m3) AS avg_pm10_ug_m3,\n    SUM(T.pm2_5_ug_m3) / COUNT(T.pm2_5_ug_m3) AS avg_pm2_5_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2018\n    AND T.pm10_ug_m3 IS NOT NULL\n    AND T.pm2_5_ug_m3 IS NOT NULL\nGROUP BY jahreszeit;\n"
      },
      {
        "question": "Wie hoch war die j\u00e4hrliche Durchschnittskonzentration von Stickstoffmonoxid und Stickstoffdioxid in der Stadt Z\u00fcrich in den Jahren 1993, 2003, 2013 und 2023?",
        "query": "SELECT T.jahr, SUM(T.no_ug_m3) / COUNT(T.no_ug_m3) AS jahr_avg_no_ug_m3, SUM(T.no2_ug_m3) / COUNT(T.no2_ug_m3) AS avg_no2_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr IN (1993, 2003, 2013, 2023)\n    AND T.no_ug_m3 IS NOT NULL\nGROUP BY T.jahr;\n"
      },
      {
        "question": "Zeigen Sie mir die mittlere PM10- und PM2.5-Konzentration in Z\u00fcrich w\u00e4hrend jeder Jahreszeit des Jahres 2018.",
        "query": "SELECT\n    CASE\n        WHEN T.monat IN (12, 1, 2) THEN 'Winter'\n        WHEN T.monat IN (3, 4, 5) THEN 'Fr\u00fchling'\n        WHEN T.monat IN (6, 7, 8) THEN 'Sommer'\n        WHEN T.monat IN (9, 10, 11) THEN 'Herbst'\n    END AS jahreszeit,\n    SUM(T.pm10_ug_m3) / COUNT(T.pm10_ug_m3) AS avg_pm10_ug_m3,\n    SUM(T.pm2_5_ug_m3) / COUNT(T.pm2_5_ug_m3) AS avg_pm2_5_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2018\n    AND T.pm10_ug_m3 IS NOT NULL\n    AND T.pm2_5_ug_m3 IS NOT NULL\nGROUP BY jahreszeit;\n"
      },
      {
        "question": "Welches war die niedrigste Feinstaubkonzentration (PM2.5), die je in Z\u00fcrich gemessen wurde, und in welchem Jahr war dies?",
        "query": "SELECT T.jahr, T.pm2_5_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pm2_5_ug_m3 IS NOT NULL\nORDER BY T.pm2_5_ug_m3 ASC\nLIMIT 1;\n"
      },
      {
        "question": "In welchem Monat gibt es in der Stadt Z\u00fcrich generell am wenigsten Partikel in der Luft?",
        "query": "SELECT T.monat, SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) AS monat_avg_pn_1_cm3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pn_1_cm3 IS NOT NULL\nGROUP BY T.monat\nORDER BY SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) ASC\nLIMIT 1;\n"
      },
      {
        "question": "Nennen Sie mir die Konzentration von Stickoxiden in der Luft von Z\u00fcrich, in Teilen pro Million (ppm), f\u00fcr den Monat Januar in den Jahren 2017 bis 2021.",
        "query": "SELECT T.jahr, T.nox_ppb / 1000 AS nox_ppm_januar\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.monat = 1\n    AND T.jahr >= 2017\n    AND T.jahr <= 2021\nORDER BY T.jahr ASC;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 (\n\tuid SERIAL NOT NULL, \n\tco_mg_m3 NUMERIC, \n\tno2_ug_m3 NUMERIC, \n\tno_ug_m3 NUMERIC, \n\tnox_ppb NUMERIC, \n\tso2_ug_m3 NUMERIC, \n\to3_ug_m3 NUMERIC, \n\tpm10_ug_m3 NUMERIC, \n\tpn_1_cm3 NUMERIC, \n\tpm2_5_ug_m3 NUMERIC, \n\tjahr INTEGER, \n\tmonat NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983_pkey PRIMARY KEY (uid), \n\tCONSTRAINT stadt_zurich_monatlich_luftqualitatsmessun_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nco_mg_m3 : 1.32774193548387087, 0.88400000000000001, 2.63879999999999981, 0.68032258064516127, 2.26774193548387082\nno2_ug_m3 : 40.249032258064517, 69.325000000000003, 58.753928571428574, 75.469999999999999, 41.437586206896555\nno_ug_m3 : 81.2945161290322602, 126.6675000000000040, 125.5083999999999946, 15.8735483870967737, 69.5166666666666657\nnox_ppb : 127.8517857142857110, 35.4219999999999970, 35.1929999999999978, 37.1809677419354827, 162.9167741935483775\nso2_ug_m3 : 15.86225806451612819, 9.97857142857142776, 18.91517241379310477, 25.29035714285714320, 8.18466666666666676\no3_ug_m3 : 7.1503448275862072, 25.9516666666666680, 15.4025806451612901, 63.3323333333333309, 34.2596666666666678\njahr : 1995, 1988, 1989, 1991, 1993\nmonat : 4, 12, 2, 6, 10\n*/\n\n/*\nColumn name, Column discription, Example values\nco_mg_m3, Kohlenmonoxid (CO) in mg/m3, 3.69741935483871,2.3325,2.45451612903226\nno2_ug_m3, Stickstoffdioxid (NO2) in \u00b5g/m3, 38.5848387096774,47.8067857142857,48.0387096774194\nno_ug_m3, Stickstoffmonoxid (NO) in \u00b5g/m3, 162.903870967742,157.969285714286,171.871290322581\nnox_ppb, Stickstoffoxide (NOx) in ppb, 150.781612903226,151.648214285714,162.916774193548\nso2_ug_m3, Schwefeldioxid (SO2) in \u00b5g/m3, 83.6127586206897,100.517142857143,69.5396666666667\no3_ug_m3, Ozon (O3) in \u00b5g/m3, 11.4648148148148,6.99464285714286\npm10_ug_m3, Schwebestaub PM10 (Durchmesser 10\u00b5m oder weniger) in \u00b5g/m3, 33.9512,30.7521428571429\npn_1_cm3, Partikelanzahl pro cm3, 23403.0509090909,12632.1964516129\npm2_5_ug_m3, Schwebestaub PM2.5 (Durchmesser 2,5\u00b5m oder weniger) in \u00b5g/m3, 26.6368181818182,16.9007407407407\nmonat, Monat, 1,2,3\n*/\n\n\n\n### Question\nZeigen Sie mir die Partikelzahl f\u00fcr jeden Monat in Z\u00fcrich, im Durchschnitt aller verf\u00fcgbaren Jahre.\n### SQL query\nSELECT T.monat, SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) AS avg_pn_1_cm3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pn_1_cm3 IS NOT NULL\nGROUP BY T.monat;\n\n\n### Question\nZeigen Sie mir die mittlere PM10- und PM2.5-Konzentration in Z\u00fcrich w\u00e4hrend jeder Jahreszeit des Jahres 2018.\n### SQL query\nSELECT\n    CASE\n        WHEN T.monat IN (12, 1, 2) THEN 'Winter'\n        WHEN T.monat IN (3, 4, 5) THEN 'Fr\u00fchling'\n        WHEN T.monat IN (6, 7, 8) THEN 'Sommer'\n        WHEN T.monat IN (9, 10, 11) THEN 'Herbst'\n    END AS jahreszeit,\n    SUM(T.pm10_ug_m3) / COUNT(T.pm10_ug_m3) AS avg_pm10_ug_m3,\n    SUM(T.pm2_5_ug_m3) / COUNT(T.pm2_5_ug_m3) AS avg_pm2_5_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2018\n    AND T.pm10_ug_m3 IS NOT NULL\n    AND T.pm2_5_ug_m3 IS NOT NULL\nGROUP BY jahreszeit;\n\n\n### Question\nWie hoch war die Schwefeldioxidkonzentration in der Luft in Z\u00fcrich im Jahr 2019? Geben Sie die Konzentration in Milligramm pro Kubikmeter an.\n### SQL query\nSELECT T.monat, T.so2_ug_m3 / 1000 AS so2_mg_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2019\nORDER BY T.monat ASC;\n\n\n### Question\nZeigen Sie mir die mittlere PM10- und PM2.5-Konzentration in Z\u00fcrich w\u00e4hrend jeder Jahreszeit des Jahres 2018.\n### SQL query\nSELECT\n    CASE\n        WHEN T.monat IN (12, 1, 2) THEN 'Winter'\n        WHEN T.monat IN (3, 4, 5) THEN 'Fr\u00fchling'\n        WHEN T.monat IN (6, 7, 8) THEN 'Sommer'\n        WHEN T.monat IN (9, 10, 11) THEN 'Herbst'\n    END AS jahreszeit,\n    SUM(T.pm10_ug_m3) / COUNT(T.pm10_ug_m3) AS avg_pm10_ug_m3,\n    SUM(T.pm2_5_ug_m3) / COUNT(T.pm2_5_ug_m3) AS avg_pm2_5_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2018\n    AND T.pm10_ug_m3 IS NOT NULL\n    AND T.pm2_5_ug_m3 IS NOT NULL\nGROUP BY jahreszeit;\n\n\n### Question\nWie hoch war die j\u00e4hrliche Durchschnittskonzentration von Stickstoffmonoxid und Stickstoffdioxid in der Stadt Z\u00fcrich in den Jahren 1993, 2003, 2013 und 2023?\n### SQL query\nSELECT T.jahr, SUM(T.no_ug_m3) / COUNT(T.no_ug_m3) AS jahr_avg_no_ug_m3, SUM(T.no2_ug_m3) / COUNT(T.no2_ug_m3) AS avg_no2_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr IN (1993, 2003, 2013, 2023)\n    AND T.no_ug_m3 IS NOT NULL\nGROUP BY T.jahr;\n\n\n### Question\nZeigen Sie mir die mittlere PM10- und PM2.5-Konzentration in Z\u00fcrich w\u00e4hrend jeder Jahreszeit des Jahres 2018.\n### SQL query\nSELECT\n    CASE\n        WHEN T.monat IN (12, 1, 2) THEN 'Winter'\n        WHEN T.monat IN (3, 4, 5) THEN 'Fr\u00fchling'\n        WHEN T.monat IN (6, 7, 8) THEN 'Sommer'\n        WHEN T.monat IN (9, 10, 11) THEN 'Herbst'\n    END AS jahreszeit,\n    SUM(T.pm10_ug_m3) / COUNT(T.pm10_ug_m3) AS avg_pm10_ug_m3,\n    SUM(T.pm2_5_ug_m3) / COUNT(T.pm2_5_ug_m3) AS avg_pm2_5_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.jahr = 2018\n    AND T.pm10_ug_m3 IS NOT NULL\n    AND T.pm2_5_ug_m3 IS NOT NULL\nGROUP BY jahreszeit;\n\n\n### Question\nWelches war die niedrigste Feinstaubkonzentration (PM2.5), die je in Z\u00fcrich gemessen wurde, und in welchem Jahr war dies?\n### SQL query\nSELECT T.jahr, T.pm2_5_ug_m3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pm2_5_ug_m3 IS NOT NULL\nORDER BY T.pm2_5_ug_m3 ASC\nLIMIT 1;\n\n\n### Question\nIn welchem Monat gibt es in der Stadt Z\u00fcrich generell am wenigsten Partikel in der Luft?\n### SQL query\nSELECT T.monat, SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) AS monat_avg_pn_1_cm3\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.pn_1_cm3 IS NOT NULL\nGROUP BY T.monat\nORDER BY SUM(T.pn_1_cm3) / COUNT(T.pn_1_cm3) ASC\nLIMIT 1;\n\n\n### Question\nNennen Sie mir die Konzentration von Stickoxiden in der Luft von Z\u00fcrich, in Teilen pro Million (ppm), f\u00fcr den Monat Januar in den Jahren 2017 bis 2021.\n### SQL query\nSELECT T.jahr, T.nox_ppb / 1000 AS nox_ppm_januar\nFROM stadt_zurich_monatlich_luftqualitatsmessungen_seit_1983 AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name = 'Z\u00fcrich'\n    AND T.monat = 1\n    AND T.jahr >= 2017\n    AND T.jahr <= 2021\nORDER BY T.jahr ASC;\n\n\n### Question\nWann erreichte die Kohlenmonoxidkonzentration in der Luft in der Stadt Z\u00fcrich ihr Maximum? Geben Sie auch die Konzentration in mg/m3 an.\n### SQL query\n",
    "process_time": 10.649017518851906,
    "num_tokens": 3635,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 105,
    "question": "Zeigen Sie mir den Medianpreis f\u00fcr Wohnbauland im Kanton Z\u00fcrich f\u00fcr jedes Jahr zwischen 2010 und 2020.",
    "query": "SELECT T.jahr, T.median_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 2010\n    AND T.jahr <= 2020;\n",
    "db_id": "zurich_effektive_preise_wohnbauland",
    "generated_query": "SELECT T.jahr, T.median_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr BETWEEN 2010 AND 2020;",
    "meta_data": [
      {
        "question": "Wie ist das Verh\u00e4ltnis zwischen den Preisen f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2020 und 1980?",
        "query": "SELECT\n    (\n        SUM(CASE WHEN T.jahr = 2020 THEN T.durschnitt_preis_chf_pro_m2 END) /\n        SUM(CASE WHEN T.jahr = 1980 THEN T.durschnitt_preis_chf_pro_m2 END)\n    ) AS preis_ratio_2020_1980\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (1980, 2020);\n"
      },
      {
        "question": "Wie hoch war das 50. Perzentil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich in den Jahren 2012 und 2014?",
        "query": "SELECT T.jahr, T.median_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (2012, 2014);\n"
      },
      {
        "question": "Wie hoch war das dritte Quartil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2015?",
        "query": "SELECT T.quantil_75_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr = 2015;\n"
      },
      {
        "question": "Wie hoch war das 50. Perzentil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich in den Jahren 2012 und 2014?",
        "query": "SELECT T.jahr, T.median_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (2012, 2014);\n"
      },
      {
        "question": "Wie hoch war das 50. Perzentil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich in den Jahren 2012 und 2014?",
        "query": "SELECT T.jahr, T.median_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (2012, 2014);\n"
      },
      {
        "question": "Wie viele Verk\u00e4ufe von Wohnbauland gab es im Kanton Z\u00fcrich im Zeitraum 1990-2010 insgesamt?",
        "query": "SELECT SUM(T.faelle) AS faelle_1990_2010\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE\n    S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 1990\n    AND T.jahr <= 2010;\n"
      },
      {
        "question": "Wie hoch war das 50. Perzentil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich in den Jahren 2012 und 2014?",
        "query": "SELECT T.jahr, T.median_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (2012, 2014);\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.zurich_effektive_preise_wohnbauland (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tfaelle NUMERIC, \n\tdurschnitt_preis_chf_pro_m2 NUMERIC, \n\tquantil_25_preis_chf_pro_m2 NUMERIC, \n\tmedian_preis_chf_pro_m2 NUMERIC, \n\tquantil_75_preis_chf_pro_m2 NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT zurich_effektive_preise_wohnbauland_pkey PRIMARY KEY (uid), \n\tCONSTRAINT zurich_effektive_preise_wohnbauland_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in zurich_effektive_preise_wohnbauland and 5 examples in each column for high cardinality columns :\nuid : 4, 27, 18, 23, 29\njahr : 2015, 1988, 1989, 2000, 1991\nfaelle : 1756, 791, 1120, 481, 3980\ndurschnitt_preis_chf_pro_m2 : 171, 617, 226, 1733, 1558\nquantil_25_preis_chf_pro_m2 : 94, 724, 183, 101, 161\nmedian_preis_chf_pro_m2 : 617, 577, 602, 1104, 131\nquantil_75_preis_chf_pro_m2 : 275, 1654, 2150, 866, 680\n*/\n\n/*\nColumn name, Column discription, Example values\nfaelle, Anzahl Transaktionen von unbebautem Wohnbauland, 167715272076\ndurschnitt_preis_chf_pro_m2, Durchschnittspreis in CHF pro Quadratmeter, 169175171\nquantil_25_preis_chf_pro_m2, Unteres Quartil der Preise in CHF pro Quadratmeter, 94100104\nmedian_preis_chf_pro_m2, Median Preis in CHF pro Quadratmeter, 131150137\nquantil_75_preis_chf_pro_m2, Oberes Quartil der Preise in CHF pro Quadratmeter, 180198191\n*/\n\n\n\n### Question\nWie ist das Verh\u00e4ltnis zwischen den Preisen f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2020 und 1980?\n### SQL query\nSELECT\n    (\n        SUM(CASE WHEN T.jahr = 2020 THEN T.durschnitt_preis_chf_pro_m2 END) /\n        SUM(CASE WHEN T.jahr = 1980 THEN T.durschnitt_preis_chf_pro_m2 END)\n    ) AS preis_ratio_2020_1980\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (1980, 2020);\n\n\n### Question\nWie hoch war das 50. Perzentil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich in den Jahren 2012 und 2014?\n### SQL query\nSELECT T.jahr, T.median_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (2012, 2014);\n\n\n### Question\nWie hoch war das dritte Quartil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2015?\n### SQL query\nSELECT T.quantil_75_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr = 2015;\n\n\n### Question\nWie hoch war das 50. Perzentil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich in den Jahren 2012 und 2014?\n### SQL query\nSELECT T.jahr, T.median_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (2012, 2014);\n\n\n### Question\nWie hoch war das 50. Perzentil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich in den Jahren 2012 und 2014?\n### SQL query\nSELECT T.jahr, T.median_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (2012, 2014);\n\n\n### Question\nWie viele Verk\u00e4ufe von Wohnbauland gab es im Kanton Z\u00fcrich im Zeitraum 1990-2010 insgesamt?\n### SQL query\nSELECT SUM(T.faelle) AS faelle_1990_2010\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE\n    S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 1990\n    AND T.jahr <= 2010;\n\n\n### Question\nWie hoch war das 50. Perzentil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich in den Jahren 2012 und 2014?\n### SQL query\nSELECT T.jahr, T.median_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (2012, 2014);\n\n\n### Question\nZeigen Sie mir den Medianpreis f\u00fcr Wohnbauland im Kanton Z\u00fcrich f\u00fcr jedes Jahr zwischen 2010 und 2020.\n### SQL query\n",
    "process_time": 4.285857090959325,
    "num_tokens": 2092,
    "hardness": "hard",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 106,
    "question": "Wann hat der Medianpreis f\u00fcr Wohnbauland im Kanton Z\u00fcrich seinen H\u00f6hepunkt erreicht?",
    "query": "SELECT T.jahr\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\nORDER BY T.median_preis_chf_pro_m2 DESC\nLIMIT 1;\n",
    "db_id": "zurich_effektive_preise_wohnbauland",
    "generated_query": "SELECT T.jahr\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\nORDER BY T.median_preis_chf_pro_m2 DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Wie hoch war das dritte Quartil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2015?",
        "query": "SELECT T.quantil_75_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr = 2015;\n"
      },
      {
        "question": "Wie hoch war das dritte Quartil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2015?",
        "query": "SELECT T.quantil_75_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr = 2015;\n"
      },
      {
        "question": "Wie hoch war der durchschnittliche Quadratmeterpreis f\u00fcr Wohnbauland im Kanton Z\u00fcrich zwischen 1980 und 2000?",
        "query": "SELECT AVG(T.durschnitt_preis_chf_pro_m2) AS durschnitt_preis_chf_pro_m2_1980_2000\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2000;\n"
      },
      {
        "question": "Wie viele Verk\u00e4ufe von Wohnbauland gab es im Kanton Z\u00fcrich im Zeitraum 1990-2010 insgesamt?",
        "query": "SELECT SUM(T.faelle) AS faelle_1990_2010\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE\n    S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 1990\n    AND T.jahr <= 2010;\n"
      },
      {
        "question": "Wie hoch war das 50. Perzentil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich in den Jahren 2012 und 2014?",
        "query": "SELECT T.jahr, T.median_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (2012, 2014);\n"
      },
      {
        "question": "In welchem Jahr war der Interquartilabstand des Quadratmeterpreises f\u00fcr Wohnbauland im Kanton Z\u00fcrich am h\u00f6chsten und wie hoch war er?",
        "query": "SELECT T.jahr, T.quantil_75_preis_chf_pro_m2 - T.quantil_25_preis_chf_pro_m2 AS interquartilabstand_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\nORDER BY interquartilabstand_preis_chf_pro_m2 DESC\nLIMIT 1;\n"
      },
      {
        "question": "In welchem Jahr war der Interquartilabstand des Quadratmeterpreises f\u00fcr Wohnbauland im Kanton Z\u00fcrich am h\u00f6chsten und wie hoch war er?",
        "query": "SELECT T.jahr, T.quantil_75_preis_chf_pro_m2 - T.quantil_25_preis_chf_pro_m2 AS interquartilabstand_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\nORDER BY interquartilabstand_preis_chf_pro_m2 DESC\nLIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.zurich_effektive_preise_wohnbauland (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tfaelle NUMERIC, \n\tdurschnitt_preis_chf_pro_m2 NUMERIC, \n\tquantil_25_preis_chf_pro_m2 NUMERIC, \n\tmedian_preis_chf_pro_m2 NUMERIC, \n\tquantil_75_preis_chf_pro_m2 NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT zurich_effektive_preise_wohnbauland_pkey PRIMARY KEY (uid), \n\tCONSTRAINT zurich_effektive_preise_wohnbauland_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in zurich_effektive_preise_wohnbauland and 5 examples in each column for high cardinality columns :\nuid : 4, 27, 18, 23, 29\njahr : 2015, 1988, 1989, 2000, 1991\nfaelle : 1756, 791, 1120, 481, 3980\ndurschnitt_preis_chf_pro_m2 : 171, 617, 226, 1733, 1558\nquantil_25_preis_chf_pro_m2 : 94, 724, 183, 101, 161\nmedian_preis_chf_pro_m2 : 617, 577, 602, 1104, 131\nquantil_75_preis_chf_pro_m2 : 275, 1654, 2150, 866, 680\n*/\n\n/*\nColumn name, Column discription, Example values\nfaelle, Anzahl Transaktionen von unbebautem Wohnbauland, 167715272076\ndurschnitt_preis_chf_pro_m2, Durchschnittspreis in CHF pro Quadratmeter, 169175171\nquantil_25_preis_chf_pro_m2, Unteres Quartil der Preise in CHF pro Quadratmeter, 94100104\nmedian_preis_chf_pro_m2, Median Preis in CHF pro Quadratmeter, 131150137\nquantil_75_preis_chf_pro_m2, Oberes Quartil der Preise in CHF pro Quadratmeter, 180198191\n*/\n\n\n\n### Question\nWie hoch war das dritte Quartil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2015?\n### SQL query\nSELECT T.quantil_75_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr = 2015;\n\n\n### Question\nWie hoch war das dritte Quartil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2015?\n### SQL query\nSELECT T.quantil_75_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr = 2015;\n\n\n### Question\nWie hoch war der durchschnittliche Quadratmeterpreis f\u00fcr Wohnbauland im Kanton Z\u00fcrich zwischen 1980 und 2000?\n### SQL query\nSELECT AVG(T.durschnitt_preis_chf_pro_m2) AS durschnitt_preis_chf_pro_m2_1980_2000\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2000;\n\n\n### Question\nWie viele Verk\u00e4ufe von Wohnbauland gab es im Kanton Z\u00fcrich im Zeitraum 1990-2010 insgesamt?\n### SQL query\nSELECT SUM(T.faelle) AS faelle_1990_2010\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE\n    S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 1990\n    AND T.jahr <= 2010;\n\n\n### Question\nWie hoch war das 50. Perzentil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich in den Jahren 2012 und 2014?\n### SQL query\nSELECT T.jahr, T.median_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (2012, 2014);\n\n\n### Question\nIn welchem Jahr war der Interquartilabstand des Quadratmeterpreises f\u00fcr Wohnbauland im Kanton Z\u00fcrich am h\u00f6chsten und wie hoch war er?\n### SQL query\nSELECT T.jahr, T.quantil_75_preis_chf_pro_m2 - T.quantil_25_preis_chf_pro_m2 AS interquartilabstand_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\nORDER BY interquartilabstand_preis_chf_pro_m2 DESC\nLIMIT 1;\n\n\n### Question\nIn welchem Jahr war der Interquartilabstand des Quadratmeterpreises f\u00fcr Wohnbauland im Kanton Z\u00fcrich am h\u00f6chsten und wie hoch war er?\n### SQL query\nSELECT T.jahr, T.quantil_75_preis_chf_pro_m2 - T.quantil_25_preis_chf_pro_m2 AS interquartilabstand_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\nORDER BY interquartilabstand_preis_chf_pro_m2 DESC\nLIMIT 1;\n\n\n### Question\nWann hat der Medianpreis f\u00fcr Wohnbauland im Kanton Z\u00fcrich seinen H\u00f6hepunkt erreicht?\n### SQL query\n",
    "process_time": 8.447457364061847,
    "num_tokens": 2123,
    "hardness": "extra",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 107,
    "question": "Wie viele Verk\u00e4ufe von Wohnbauland gab es im Kanton Z\u00fcrich in den Jahren 2015 und 2021?",
    "query": "SELECT T.jahr, T.faelle\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (2015, 2021);\n",
    "db_id": "zurich_effektive_preise_wohnbauland",
    "generated_query": "SELECT SUM(T.faelle) AS faelle_2015_2021\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE\n    S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (2015, 2021);",
    "meta_data": [
      {
        "question": "Wie hoch war das dritte Quartil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2015?",
        "query": "SELECT T.quantil_75_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr = 2015;\n"
      },
      {
        "question": "Wie ist das Verh\u00e4ltnis zwischen den Preisen f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2020 und 1980?",
        "query": "SELECT\n    (\n        SUM(CASE WHEN T.jahr = 2020 THEN T.durschnitt_preis_chf_pro_m2 END) /\n        SUM(CASE WHEN T.jahr = 1980 THEN T.durschnitt_preis_chf_pro_m2 END)\n    ) AS preis_ratio_2020_1980\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (1980, 2020);\n"
      },
      {
        "question": "Wie ist das Verh\u00e4ltnis zwischen den Preisen f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2020 und 1980?",
        "query": "SELECT\n    (\n        SUM(CASE WHEN T.jahr = 2020 THEN T.durschnitt_preis_chf_pro_m2 END) /\n        SUM(CASE WHEN T.jahr = 1980 THEN T.durschnitt_preis_chf_pro_m2 END)\n    ) AS preis_ratio_2020_1980\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (1980, 2020);\n"
      },
      {
        "question": "Wie hoch war der durchschnittliche Quadratmeterpreis f\u00fcr Wohnbauland im Kanton Z\u00fcrich zwischen 1980 und 2000?",
        "query": "SELECT AVG(T.durschnitt_preis_chf_pro_m2) AS durschnitt_preis_chf_pro_m2_1980_2000\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2000;\n"
      },
      {
        "question": "Wie viele Verk\u00e4ufe von Wohnbauland gab es im Kanton Z\u00fcrich im Zeitraum 1990-2010 insgesamt?",
        "query": "SELECT SUM(T.faelle) AS faelle_1990_2010\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE\n    S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 1990\n    AND T.jahr <= 2010;\n"
      },
      {
        "question": "Zeigen Sie mir alle verf\u00fcgbaren statistischen Indikatoren f\u00fcr den Preis von Wohnbauland im Kanton Z\u00fcrich f\u00fcr jedes Jahr zwischen 2017 und 2021.",
        "query": "SELECT\n    T.jahr,\n    T.quantil_25_preis_chf_pro_m2,\n    T.median_preis_chf_pro_m2,\n    T.quantil_75_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 2017\n    AND T.jahr <= 2021;\n"
      },
      {
        "question": "Wie ist das Verh\u00e4ltnis zwischen den Preisen f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2020 und 1980?",
        "query": "SELECT\n    (\n        SUM(CASE WHEN T.jahr = 2020 THEN T.durschnitt_preis_chf_pro_m2 END) /\n        SUM(CASE WHEN T.jahr = 1980 THEN T.durschnitt_preis_chf_pro_m2 END)\n    ) AS preis_ratio_2020_1980\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (1980, 2020);\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.zurich_effektive_preise_wohnbauland (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tfaelle NUMERIC, \n\tdurschnitt_preis_chf_pro_m2 NUMERIC, \n\tquantil_25_preis_chf_pro_m2 NUMERIC, \n\tmedian_preis_chf_pro_m2 NUMERIC, \n\tquantil_75_preis_chf_pro_m2 NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT zurich_effektive_preise_wohnbauland_pkey PRIMARY KEY (uid), \n\tCONSTRAINT zurich_effektive_preise_wohnbauland_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in zurich_effektive_preise_wohnbauland and 5 examples in each column for high cardinality columns :\nuid : 4, 27, 18, 23, 29\njahr : 2015, 1988, 1989, 2000, 1991\nfaelle : 1756, 791, 1120, 481, 3980\ndurschnitt_preis_chf_pro_m2 : 171, 617, 226, 1733, 1558\nquantil_25_preis_chf_pro_m2 : 94, 724, 183, 101, 161\nmedian_preis_chf_pro_m2 : 617, 577, 602, 1104, 131\nquantil_75_preis_chf_pro_m2 : 275, 1654, 2150, 866, 680\n*/\n\n/*\nColumn name, Column discription, Example values\nfaelle, Anzahl Transaktionen von unbebautem Wohnbauland, 167715272076\ndurschnitt_preis_chf_pro_m2, Durchschnittspreis in CHF pro Quadratmeter, 169175171\nquantil_25_preis_chf_pro_m2, Unteres Quartil der Preise in CHF pro Quadratmeter, 94100104\nmedian_preis_chf_pro_m2, Median Preis in CHF pro Quadratmeter, 131150137\nquantil_75_preis_chf_pro_m2, Oberes Quartil der Preise in CHF pro Quadratmeter, 180198191\n*/\n\n\n\n### Question\nWie hoch war das dritte Quartil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2015?\n### SQL query\nSELECT T.quantil_75_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr = 2015;\n\n\n### Question\nWie ist das Verh\u00e4ltnis zwischen den Preisen f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2020 und 1980?\n### SQL query\nSELECT\n    (\n        SUM(CASE WHEN T.jahr = 2020 THEN T.durschnitt_preis_chf_pro_m2 END) /\n        SUM(CASE WHEN T.jahr = 1980 THEN T.durschnitt_preis_chf_pro_m2 END)\n    ) AS preis_ratio_2020_1980\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (1980, 2020);\n\n\n### Question\nWie ist das Verh\u00e4ltnis zwischen den Preisen f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2020 und 1980?\n### SQL query\nSELECT\n    (\n        SUM(CASE WHEN T.jahr = 2020 THEN T.durschnitt_preis_chf_pro_m2 END) /\n        SUM(CASE WHEN T.jahr = 1980 THEN T.durschnitt_preis_chf_pro_m2 END)\n    ) AS preis_ratio_2020_1980\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (1980, 2020);\n\n\n### Question\nWie hoch war der durchschnittliche Quadratmeterpreis f\u00fcr Wohnbauland im Kanton Z\u00fcrich zwischen 1980 und 2000?\n### SQL query\nSELECT AVG(T.durschnitt_preis_chf_pro_m2) AS durschnitt_preis_chf_pro_m2_1980_2000\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2000;\n\n\n### Question\nWie viele Verk\u00e4ufe von Wohnbauland gab es im Kanton Z\u00fcrich im Zeitraum 1990-2010 insgesamt?\n### SQL query\nSELECT SUM(T.faelle) AS faelle_1990_2010\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE\n    S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 1990\n    AND T.jahr <= 2010;\n\n\n### Question\nZeigen Sie mir alle verf\u00fcgbaren statistischen Indikatoren f\u00fcr den Preis von Wohnbauland im Kanton Z\u00fcrich f\u00fcr jedes Jahr zwischen 2017 und 2021.\n### SQL query\nSELECT\n    T.jahr,\n    T.quantil_25_preis_chf_pro_m2,\n    T.median_preis_chf_pro_m2,\n    T.quantil_75_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 2017\n    AND T.jahr <= 2021;\n\n\n### Question\nWie ist das Verh\u00e4ltnis zwischen den Preisen f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2020 und 1980?\n### SQL query\nSELECT\n    (\n        SUM(CASE WHEN T.jahr = 2020 THEN T.durschnitt_preis_chf_pro_m2 END) /\n        SUM(CASE WHEN T.jahr = 1980 THEN T.durschnitt_preis_chf_pro_m2 END)\n    ) AS preis_ratio_2020_1980\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (1980, 2020);\n\n\n### Question\nWie viele Verk\u00e4ufe von Wohnbauland gab es im Kanton Z\u00fcrich in den Jahren 2015 und 2021?\n### SQL query\n",
    "process_time": 8.671039866050705,
    "num_tokens": 2261,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 108,
    "question": "In welchem Jahr ist der durchschnittliche Preis f\u00fcr Wohnbauland im Kanton Z\u00fcrich am st\u00e4rksten gestiegen (in CHF) im Vergleich zum Vorjahr?",
    "query": "SELECT T.jahr\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\nORDER BY T.durschnitt_preis_chf_pro_m2 - LAG(T.durschnitt_preis_chf_pro_m2) OVER (ORDER BY T.jahr) DESC\nLIMIT 1;\n",
    "db_id": "zurich_effektive_preise_wohnbauland",
    "generated_query": "SELECT T.jahr, T.durschnitt_preis_chf_pro_m2 - LAG(T.durschnitt_preis_chf_pro_m2) OVER (ORDER BY T.jahr) AS preis_increase_chf\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\nORDER BY preis_increase_chf DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Wie hoch war der durchschnittliche Quadratmeterpreis f\u00fcr Wohnbauland im Kanton Z\u00fcrich zwischen 1980 und 2000?",
        "query": "SELECT AVG(T.durschnitt_preis_chf_pro_m2) AS durschnitt_preis_chf_pro_m2_1980_2000\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2000;\n"
      },
      {
        "question": "Wie hoch war das dritte Quartil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2015?",
        "query": "SELECT T.quantil_75_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr = 2015;\n"
      },
      {
        "question": "Wie hoch war der durchschnittliche Quadratmeterpreis f\u00fcr Wohnbauland im Kanton Z\u00fcrich zwischen 1980 und 2000?",
        "query": "SELECT AVG(T.durschnitt_preis_chf_pro_m2) AS durschnitt_preis_chf_pro_m2_1980_2000\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2000;\n"
      },
      {
        "question": "Wie hoch war das 50. Perzentil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich in den Jahren 2012 und 2014?",
        "query": "SELECT T.jahr, T.median_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (2012, 2014);\n"
      },
      {
        "question": "In welchem Jahr war der Interquartilabstand des Quadratmeterpreises f\u00fcr Wohnbauland im Kanton Z\u00fcrich am h\u00f6chsten und wie hoch war er?",
        "query": "SELECT T.jahr, T.quantil_75_preis_chf_pro_m2 - T.quantil_25_preis_chf_pro_m2 AS interquartilabstand_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\nORDER BY interquartilabstand_preis_chf_pro_m2 DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wie ist das Verh\u00e4ltnis zwischen den Preisen f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2020 und 1980?",
        "query": "SELECT\n    (\n        SUM(CASE WHEN T.jahr = 2020 THEN T.durschnitt_preis_chf_pro_m2 END) /\n        SUM(CASE WHEN T.jahr = 1980 THEN T.durschnitt_preis_chf_pro_m2 END)\n    ) AS preis_ratio_2020_1980\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (1980, 2020);\n"
      },
      {
        "question": "Wie ist das Verh\u00e4ltnis zwischen den Preisen f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2020 und 1980?",
        "query": "SELECT\n    (\n        SUM(CASE WHEN T.jahr = 2020 THEN T.durschnitt_preis_chf_pro_m2 END) /\n        SUM(CASE WHEN T.jahr = 1980 THEN T.durschnitt_preis_chf_pro_m2 END)\n    ) AS preis_ratio_2020_1980\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (1980, 2020);\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.zurich_effektive_preise_wohnbauland (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tfaelle NUMERIC, \n\tdurschnitt_preis_chf_pro_m2 NUMERIC, \n\tquantil_25_preis_chf_pro_m2 NUMERIC, \n\tmedian_preis_chf_pro_m2 NUMERIC, \n\tquantil_75_preis_chf_pro_m2 NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT zurich_effektive_preise_wohnbauland_pkey PRIMARY KEY (uid), \n\tCONSTRAINT zurich_effektive_preise_wohnbauland_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in zurich_effektive_preise_wohnbauland and 5 examples in each column for high cardinality columns :\nuid : 4, 27, 18, 23, 29\njahr : 2015, 1988, 1989, 2000, 1991\nfaelle : 1756, 791, 1120, 481, 3980\ndurschnitt_preis_chf_pro_m2 : 171, 617, 226, 1733, 1558\nquantil_25_preis_chf_pro_m2 : 94, 724, 183, 101, 161\nmedian_preis_chf_pro_m2 : 617, 577, 602, 1104, 131\nquantil_75_preis_chf_pro_m2 : 275, 1654, 2150, 866, 680\n*/\n\n/*\nColumn name, Column discription, Example values\nfaelle, Anzahl Transaktionen von unbebautem Wohnbauland, 167715272076\ndurschnitt_preis_chf_pro_m2, Durchschnittspreis in CHF pro Quadratmeter, 169175171\nquantil_25_preis_chf_pro_m2, Unteres Quartil der Preise in CHF pro Quadratmeter, 94100104\nmedian_preis_chf_pro_m2, Median Preis in CHF pro Quadratmeter, 131150137\nquantil_75_preis_chf_pro_m2, Oberes Quartil der Preise in CHF pro Quadratmeter, 180198191\n*/\n\n\n\n### Question\nWie hoch war der durchschnittliche Quadratmeterpreis f\u00fcr Wohnbauland im Kanton Z\u00fcrich zwischen 1980 und 2000?\n### SQL query\nSELECT AVG(T.durschnitt_preis_chf_pro_m2) AS durschnitt_preis_chf_pro_m2_1980_2000\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2000;\n\n\n### Question\nWie hoch war das dritte Quartil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2015?\n### SQL query\nSELECT T.quantil_75_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr = 2015;\n\n\n### Question\nWie hoch war der durchschnittliche Quadratmeterpreis f\u00fcr Wohnbauland im Kanton Z\u00fcrich zwischen 1980 und 2000?\n### SQL query\nSELECT AVG(T.durschnitt_preis_chf_pro_m2) AS durschnitt_preis_chf_pro_m2_1980_2000\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr >= 1980\n    AND T.jahr <= 2000;\n\n\n### Question\nWie hoch war das 50. Perzentil der Preise f\u00fcr Wohnbauland im Kanton Z\u00fcrich in den Jahren 2012 und 2014?\n### SQL query\nSELECT T.jahr, T.median_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (2012, 2014);\n\n\n### Question\nIn welchem Jahr war der Interquartilabstand des Quadratmeterpreises f\u00fcr Wohnbauland im Kanton Z\u00fcrich am h\u00f6chsten und wie hoch war er?\n### SQL query\nSELECT T.jahr, T.quantil_75_preis_chf_pro_m2 - T.quantil_25_preis_chf_pro_m2 AS interquartilabstand_preis_chf_pro_m2\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\nORDER BY interquartilabstand_preis_chf_pro_m2 DESC\nLIMIT 1;\n\n\n### Question\nWie ist das Verh\u00e4ltnis zwischen den Preisen f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2020 und 1980?\n### SQL query\nSELECT\n    (\n        SUM(CASE WHEN T.jahr = 2020 THEN T.durschnitt_preis_chf_pro_m2 END) /\n        SUM(CASE WHEN T.jahr = 1980 THEN T.durschnitt_preis_chf_pro_m2 END)\n    ) AS preis_ratio_2020_1980\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (1980, 2020);\n\n\n### Question\nWie ist das Verh\u00e4ltnis zwischen den Preisen f\u00fcr Wohnbauland im Kanton Z\u00fcrich im Jahr 2020 und 1980?\n### SQL query\nSELECT\n    (\n        SUM(CASE WHEN T.jahr = 2020 THEN T.durschnitt_preis_chf_pro_m2 END) /\n        SUM(CASE WHEN T.jahr = 1980 THEN T.durschnitt_preis_chf_pro_m2 END)\n    ) AS preis_ratio_2020_1980\nFROM zurich_effektive_preise_wohnbauland AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND S.name LIKE '%Zurich%'\n    AND T.jahr IN (1980, 2020);\n\n\n### Question\nIn welchem Jahr ist der durchschnittliche Preis f\u00fcr Wohnbauland im Kanton Z\u00fcrich am st\u00e4rksten gestiegen (in CHF) im Vergleich zum Vorjahr?\n### SQL query\n",
    "process_time": 11.842136265942827,
    "num_tokens": 2231,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 109,
    "question": "Wie hoch war das durchschnittliche Reineinkommen in Matth\u00e4us, BS, 2015?",
    "query": "SELECT T.reineinkommen_mittelwert\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2015\n    AND S.name = 'Matth\u00e4us';\n",
    "db_id": "basel_stadt_steuerstatistik_kennzahlen_wohnvierteln",
    "generated_query": "SELECT T.reineinkommen_mittelwert\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Matth\u00e4us'\n    AND T.jahr = 2015;",
    "meta_data": [
      {
        "question": "Wie haben sich das mittlere Nettoeinkommen und das mittlere steuerpflichtige Einkommen (in Prozent) zwischen 2000 und 2020 in Clara, BS, ver\u00e4ndert?",
        "query": "SELECT\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.reineinkommen_mittelwert ELSE - T.reineinkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.reineinkommen_mittelwert END)\n    ) AS reineinkommen_mittelwert_prozent_aenderung_2000_2020,\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.steuerbares_einkommen_mittelwert ELSE - T.steuerbares_einkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.steuerbares_einkommen_mittelwert END)\n    ) AS steuerbares_einkommen_mittelwert_prozent_aenderung_2000_2020\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Clara'\n    AND T.jahr IN (2000, 2020);\n"
      },
      {
        "question": "Zeigen Sie mir den Gini-Koeffizienten des Reinverm\u00f6gens f\u00fcr Bettingen, Iselin und Bruderholz (BS) im Jahr 2012.",
        "query": "SELECT S.name, T.reinvermogen_gini_koeffizient\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2012\n    AND S.name IN ('Bettingen', 'Iselin', 'Bruderholz');\n"
      },
      {
        "question": "Wie hoch war das mittlere Reinverm\u00f6gen in den 5 Wohngebieten von Basel-Stadt mit dem niedrigsten mittleren Reineinkommen im Jahr 2015?",
        "query": "SELECT S.name, T.reinvermogen_mittelwert AS reinvermogen_mittelwert_2015\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nJOIN (\n    SELECT T.spatialunit_uid\n    FROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE T.jahr = 2015\n    ORDER BY T.reineinkommen_mittelwert ASC\n    LIMIT 5\n) AS T2 ON T.spatialunit_uid = T2.spatialunit_uid\nWHERE T.jahr = 2015;\n"
      },
      {
        "question": "Welcher Anteil der Wohnvierteln in Basel-Stadt hatte 2015 ein mittleres Einkommen von \u00fcber 80'000 CHF?",
        "query": "SELECT 100.0 * COUNT(CASE WHEN T.reineinkommen_mittelwert > 75000 THEN 1 END) / COUNT(*) AS anteil_wohnvierteln_ueber_100000_reineinkommen_mittelwert_2015\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2015;\n"
      },
      {
        "question": "Welche Wohnviertel in Basel-Stadt hat das h\u00f6chste Netto-Medianeinkommen im Jahr 2005? Geben Sie auch das Einkommen an.",
        "query": "SELECT S.name, T.reineinkommen_median\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2005\nORDER BY T.reineinkommen_median DESC\nLIMIT 1;\n"
      },
      {
        "question": "Welche Wohnviertel in Basel-Stadt hat das h\u00f6chste Netto-Medianeinkommen im Jahr 2005? Geben Sie auch das Einkommen an.",
        "query": "SELECT S.name, T.reineinkommen_median\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2005\nORDER BY T.reineinkommen_median DESC\nLIMIT 1;\n"
      },
      {
        "question": "Welches waren die 3 Wohnvierteln in Basel-Stadt mit dem h\u00f6chsten durchschnittlichen steuerbaren Verm\u00f6gen im Jahr 2010? Geben Sie auch das Verm\u00f6gen an.",
        "query": "SELECT S.name, T.steuerbares_vermogen_mittelwert\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2010\nORDER BY T.steuerbares_vermogen_mittelwert DESC\nLIMIT 3;\n"
      },
      {
        "question": "Welcher Anteil der Wohnvierteln in Basel-Stadt hatte 2015 ein mittleres Einkommen von \u00fcber 80'000 CHF?",
        "query": "SELECT 100.0 * COUNT(CASE WHEN T.reineinkommen_mittelwert > 75000 THEN 1 END) / COUNT(*) AS anteil_wohnvierteln_ueber_100000_reineinkommen_mittelwert_2015\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2015;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_stadt_steuerstatistik_kennzahlen_wohnvierteln (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanzahl_veranlagungen NUMERIC, \n\treineinkommen_mittelwert NUMERIC, \n\treineinkommen_median NUMERIC, \n\treineinkommen_gini_koeffizient NUMERIC, \n\tsteuerbares_einkommen_mittelwert NUMERIC, \n\tsteuerbares_einkommen_median NUMERIC, \n\tertrag_einkommenssteuer_mittelwert NUMERIC, \n\tertrag_einkommenssteuer_median NUMERIC, \n\treinvermogen_mittelwert NUMERIC, \n\treinvermogen_median NUMERIC, \n\treinvermogen_gini_koeffizient NUMERIC, \n\tsteuerbares_vermogen_mittelwert NUMERIC, \n\tsteuerbares_vermogen_median NUMERIC, \n\tertrag_vermogenssteuer_mittelwert NUMERIC, \n\tertrag_vermogenssteuer_median NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_stadt_steuerstatistik_kennzahlen_wohnvierteln_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_stadt_steuerstatistik_kennzahlen_woh_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_stadt_steuerstatistik_kennzahlen_wohnvierteln and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2015, 2000, 2009, 1991, 1993\nanzahl_veranlagungen : 10196, 3363, 6733, 3291, 5122\nreineinkommen_mittelwert : 49902, 76323, 51446, 48338, 74705\nreineinkommen_median : 47700, 45950, 58400, 38251, 50291\nreineinkommen_gini_koeffizient : 0.60199999999999998, 0.45300000000000001, 0.49700000000000000, 0.43099999999999999, 0.39800000000000002\nsteuerbares_einkommen_mittelwert : 46197, 55027, 83204, 28426, 49033\nsteuerbares_einkommen_median : 35200, 27120, 43000, 36400, 52200\nertrag_einkommenssteuer_mittelwert : 8083, 17822, 9603, 6036, 17343\nertrag_einkommenssteuer_median : 8163, 6875, 5200, 6557, 4506\nreinvermogen_mittelwert : 1482, 145997, 61020, 279127, 115398\nreinvermogen_median : 11977, 1120, 30057, 33263, 18533\nreinvermogen_gini_koeffizient : 0.84399999999999997, 0.93500000000000005, 0.88400000000000001, 0.84199999999999997, 0.83799999999999997\nsteuerbares_vermogen_mittelwert : 838326, 90853, 235973, 36060, 264570\nertrag_vermogenssteuer_mittelwert : 1162, 412, 4632, 4386, 736\nspatialunit_uid : 1201_A.ADM4, 1202_A.ADM4, 1216_A.ADM4, 1204_A.ADM4, 1213_A.ADM4\n*/\n\n/*\nColumn name, Column discription, Example values\nanzahl_veranlagungen, None, 5433,8141,3226\nreineinkommen_mittelwert, None, 47514,63915,53985\nreineinkommen_median, None, 44300,50600,47200\nreineinkommen_gini_koeffizient, None, 0.334,0.424,0.382\nsteuerbares_einkommen_mittelwert, None, 42282,56532,48135\nsteuerbares_einkommen_median, None, 39900,45200,42000\nertrag_einkommenssteuer_mittelwert, None, 6285,9946,7823\nertrag_einkommenssteuer_median, None, 5082,6475,5610\nreinvermogen_mittelwert, None, 32774,149771,89835\nreinvermogen_median, None, 0,17000,18000\nreinvermogen_gini_koeffizient, None, 0.91,0.89,0.919\nsteuerbares_vermogen_mittelwert, None, 30636,137175,84603\nsteuerbares_vermogen_median, None, 0,2128,4321\nertrag_vermogenssteuer_mittelwert, None, 175,961,591\nertrag_vermogenssteuer_median, None, 0,15,1\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWie haben sich das mittlere Nettoeinkommen und das mittlere steuerpflichtige Einkommen (in Prozent) zwischen 2000 und 2020 in Clara, BS, ver\u00e4ndert?\n### SQL query\nSELECT\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.reineinkommen_mittelwert ELSE - T.reineinkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.reineinkommen_mittelwert END)\n    ) AS reineinkommen_mittelwert_prozent_aenderung_2000_2020,\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.steuerbares_einkommen_mittelwert ELSE - T.steuerbares_einkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.steuerbares_einkommen_mittelwert END)\n    ) AS steuerbares_einkommen_mittelwert_prozent_aenderung_2000_2020\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Clara'\n    AND T.jahr IN (2000, 2020);\n\n\n### Question\nZeigen Sie mir den Gini-Koeffizienten des Reinverm\u00f6gens f\u00fcr Bettingen, Iselin und Bruderholz (BS) im Jahr 2012.\n### SQL query\nSELECT S.name, T.reinvermogen_gini_koeffizient\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2012\n    AND S.name IN ('Bettingen', 'Iselin', 'Bruderholz');\n\n\n### Question\nWie hoch war das mittlere Reinverm\u00f6gen in den 5 Wohngebieten von Basel-Stadt mit dem niedrigsten mittleren Reineinkommen im Jahr 2015?\n### SQL query\nSELECT S.name, T.reinvermogen_mittelwert AS reinvermogen_mittelwert_2015\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nJOIN (\n    SELECT T.spatialunit_uid\n    FROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE T.jahr = 2015\n    ORDER BY T.reineinkommen_mittelwert ASC\n    LIMIT 5\n) AS T2 ON T.spatialunit_uid = T2.spatialunit_uid\nWHERE T.jahr = 2015;\n\n\n### Question\nWelcher Anteil der Wohnvierteln in Basel-Stadt hatte 2015 ein mittleres Einkommen von \u00fcber 80'000 CHF?\n### SQL query\nSELECT 100.0 * COUNT(CASE WHEN T.reineinkommen_mittelwert > 75000 THEN 1 END) / COUNT(*) AS anteil_wohnvierteln_ueber_100000_reineinkommen_mittelwert_2015\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2015;\n\n\n### Question\nWelche Wohnviertel in Basel-Stadt hat das h\u00f6chste Netto-Medianeinkommen im Jahr 2005? Geben Sie auch das Einkommen an.\n### SQL query\nSELECT S.name, T.reineinkommen_median\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2005\nORDER BY T.reineinkommen_median DESC\nLIMIT 1;\n\n\n### Question\nWelche Wohnviertel in Basel-Stadt hat das h\u00f6chste Netto-Medianeinkommen im Jahr 2005? Geben Sie auch das Einkommen an.\n### SQL query\nSELECT S.name, T.reineinkommen_median\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2005\nORDER BY T.reineinkommen_median DESC\nLIMIT 1;\n\n\n### Question\nWelches waren die 3 Wohnvierteln in Basel-Stadt mit dem h\u00f6chsten durchschnittlichen steuerbaren Verm\u00f6gen im Jahr 2010? Geben Sie auch das Verm\u00f6gen an.\n### SQL query\nSELECT S.name, T.steuerbares_vermogen_mittelwert\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2010\nORDER BY T.steuerbares_vermogen_mittelwert DESC\nLIMIT 3;\n\n\n### Question\nWelcher Anteil der Wohnvierteln in Basel-Stadt hatte 2015 ein mittleres Einkommen von \u00fcber 80'000 CHF?\n### SQL query\nSELECT 100.0 * COUNT(CASE WHEN T.reineinkommen_mittelwert > 75000 THEN 1 END) / COUNT(*) AS anteil_wohnvierteln_ueber_100000_reineinkommen_mittelwert_2015\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2015;\n\n\n### Question\nWie hoch war das durchschnittliche Reineinkommen in Matth\u00e4us, BS, 2015?\n### SQL query\n",
    "process_time": 4.953203222947195,
    "num_tokens": 3196,
    "hardness": "medium",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 110,
    "question": "In welchem Wohnquartier in Basel-Stadt war die Einkommensungleichheit im Jahr 2020 am gr\u00f6ssten?",
    "query": "SELECT S.name\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.reineinkommen_gini_koeffizient DESC\nLIMIT 1;\n",
    "db_id": "basel_stadt_steuerstatistik_kennzahlen_wohnvierteln",
    "generated_query": "SELECT S.name, T.reineinkommen_gini_koeffizient\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2020\nORDER BY T.reineinkommen_gini_koeffizient DESC\nLIMIT 1;",
    "meta_data": [
      {
        "question": "Zeigen Sie mir den Gini-Koeffizienten des Reinverm\u00f6gens f\u00fcr Bettingen, Iselin und Bruderholz (BS) im Jahr 2012.",
        "query": "SELECT S.name, T.reinvermogen_gini_koeffizient\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2012\n    AND S.name IN ('Bettingen', 'Iselin', 'Bruderholz');\n"
      },
      {
        "question": "Wie haben sich das mittlere Nettoeinkommen und das mittlere steuerpflichtige Einkommen (in Prozent) zwischen 2000 und 2020 in Clara, BS, ver\u00e4ndert?",
        "query": "SELECT\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.reineinkommen_mittelwert ELSE - T.reineinkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.reineinkommen_mittelwert END)\n    ) AS reineinkommen_mittelwert_prozent_aenderung_2000_2020,\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.steuerbares_einkommen_mittelwert ELSE - T.steuerbares_einkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.steuerbares_einkommen_mittelwert END)\n    ) AS steuerbares_einkommen_mittelwert_prozent_aenderung_2000_2020\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Clara'\n    AND T.jahr IN (2000, 2020);\n"
      },
      {
        "question": "Zeigen Sie mir den Gini-Koeffizienten des Reinverm\u00f6gens f\u00fcr Bettingen, Iselin und Bruderholz (BS) im Jahr 2012.",
        "query": "SELECT S.name, T.reinvermogen_gini_koeffizient\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2012\n    AND S.name IN ('Bettingen', 'Iselin', 'Bruderholz');\n"
      },
      {
        "question": "Zeigen Sie mir alle Einkommenssteuerertragsindikatoren \u00fcber Breite, im Kanton Basel-Stadt, \u00fcber den Zeitraum 2015-2020.",
        "query": "SELECT T.jahr, T.ertrag_einkommenssteuer_mittelwert, T.ertrag_einkommenssteuer_median\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Breite'\n    AND T.jahr BETWEEN 2015 AND 2020;\n"
      },
      {
        "question": "Zeigen Sie mir alle Einkommenssteuerertragsindikatoren \u00fcber Breite, im Kanton Basel-Stadt, \u00fcber den Zeitraum 2015-2020.",
        "query": "SELECT T.jahr, T.ertrag_einkommenssteuer_mittelwert, T.ertrag_einkommenssteuer_median\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Breite'\n    AND T.jahr BETWEEN 2015 AND 2020;\n"
      },
      {
        "question": "Wie haben sich das mittlere Nettoeinkommen und das mittlere steuerpflichtige Einkommen (in Prozent) zwischen 2000 und 2020 in Clara, BS, ver\u00e4ndert?",
        "query": "SELECT\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.reineinkommen_mittelwert ELSE - T.reineinkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.reineinkommen_mittelwert END)\n    ) AS reineinkommen_mittelwert_prozent_aenderung_2000_2020,\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.steuerbares_einkommen_mittelwert ELSE - T.steuerbares_einkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.steuerbares_einkommen_mittelwert END)\n    ) AS steuerbares_einkommen_mittelwert_prozent_aenderung_2000_2020\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Clara'\n    AND T.jahr IN (2000, 2020);\n"
      },
      {
        "question": "Wie hoch war das mittlere Reinverm\u00f6gen in den 5 Wohngebieten von Basel-Stadt mit dem niedrigsten mittleren Reineinkommen im Jahr 2015?",
        "query": "SELECT S.name, T.reinvermogen_mittelwert AS reinvermogen_mittelwert_2015\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nJOIN (\n    SELECT T.spatialunit_uid\n    FROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE T.jahr = 2015\n    ORDER BY T.reineinkommen_mittelwert ASC\n    LIMIT 5\n) AS T2 ON T.spatialunit_uid = T2.spatialunit_uid\nWHERE T.jahr = 2015;\n"
      },
      {
        "question": "Welche Wohnviertel in Basel-Stadt hat das h\u00f6chste Netto-Medianeinkommen im Jahr 2005? Geben Sie auch das Einkommen an.",
        "query": "SELECT S.name, T.reineinkommen_median\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2005\nORDER BY T.reineinkommen_median DESC\nLIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_stadt_steuerstatistik_kennzahlen_wohnvierteln (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanzahl_veranlagungen NUMERIC, \n\treineinkommen_mittelwert NUMERIC, \n\treineinkommen_median NUMERIC, \n\treineinkommen_gini_koeffizient NUMERIC, \n\tsteuerbares_einkommen_mittelwert NUMERIC, \n\tsteuerbares_einkommen_median NUMERIC, \n\tertrag_einkommenssteuer_mittelwert NUMERIC, \n\tertrag_einkommenssteuer_median NUMERIC, \n\treinvermogen_mittelwert NUMERIC, \n\treinvermogen_median NUMERIC, \n\treinvermogen_gini_koeffizient NUMERIC, \n\tsteuerbares_vermogen_mittelwert NUMERIC, \n\tsteuerbares_vermogen_median NUMERIC, \n\tertrag_vermogenssteuer_mittelwert NUMERIC, \n\tertrag_vermogenssteuer_median NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_stadt_steuerstatistik_kennzahlen_wohnvierteln_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_stadt_steuerstatistik_kennzahlen_woh_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_stadt_steuerstatistik_kennzahlen_wohnvierteln and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2015, 2000, 2009, 1991, 1993\nanzahl_veranlagungen : 10196, 3363, 6733, 3291, 5122\nreineinkommen_mittelwert : 49902, 76323, 51446, 48338, 74705\nreineinkommen_median : 47700, 45950, 58400, 38251, 50291\nreineinkommen_gini_koeffizient : 0.60199999999999998, 0.45300000000000001, 0.49700000000000000, 0.43099999999999999, 0.39800000000000002\nsteuerbares_einkommen_mittelwert : 46197, 55027, 83204, 28426, 49033\nsteuerbares_einkommen_median : 35200, 27120, 43000, 36400, 52200\nertrag_einkommenssteuer_mittelwert : 8083, 17822, 9603, 6036, 17343\nertrag_einkommenssteuer_median : 8163, 6875, 5200, 6557, 4506\nreinvermogen_mittelwert : 1482, 145997, 61020, 279127, 115398\nreinvermogen_median : 11977, 1120, 30057, 33263, 18533\nreinvermogen_gini_koeffizient : 0.84399999999999997, 0.93500000000000005, 0.88400000000000001, 0.84199999999999997, 0.83799999999999997\nsteuerbares_vermogen_mittelwert : 838326, 90853, 235973, 36060, 264570\nertrag_vermogenssteuer_mittelwert : 1162, 412, 4632, 4386, 736\nspatialunit_uid : 1201_A.ADM4, 1202_A.ADM4, 1216_A.ADM4, 1204_A.ADM4, 1213_A.ADM4\n*/\n\n/*\nColumn name, Column discription, Example values\nanzahl_veranlagungen, None, 5433,8141,3226\nreineinkommen_mittelwert, None, 47514,63915,53985\nreineinkommen_median, None, 44300,50600,47200\nreineinkommen_gini_koeffizient, None, 0.334,0.424,0.382\nsteuerbares_einkommen_mittelwert, None, 42282,56532,48135\nsteuerbares_einkommen_median, None, 39900,45200,42000\nertrag_einkommenssteuer_mittelwert, None, 6285,9946,7823\nertrag_einkommenssteuer_median, None, 5082,6475,5610\nreinvermogen_mittelwert, None, 32774,149771,89835\nreinvermogen_median, None, 0,17000,18000\nreinvermogen_gini_koeffizient, None, 0.91,0.89,0.919\nsteuerbares_vermogen_mittelwert, None, 30636,137175,84603\nsteuerbares_vermogen_median, None, 0,2128,4321\nertrag_vermogenssteuer_mittelwert, None, 175,961,591\nertrag_vermogenssteuer_median, None, 0,15,1\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nZeigen Sie mir den Gini-Koeffizienten des Reinverm\u00f6gens f\u00fcr Bettingen, Iselin und Bruderholz (BS) im Jahr 2012.\n### SQL query\nSELECT S.name, T.reinvermogen_gini_koeffizient\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2012\n    AND S.name IN ('Bettingen', 'Iselin', 'Bruderholz');\n\n\n### Question\nWie haben sich das mittlere Nettoeinkommen und das mittlere steuerpflichtige Einkommen (in Prozent) zwischen 2000 und 2020 in Clara, BS, ver\u00e4ndert?\n### SQL query\nSELECT\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.reineinkommen_mittelwert ELSE - T.reineinkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.reineinkommen_mittelwert END)\n    ) AS reineinkommen_mittelwert_prozent_aenderung_2000_2020,\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.steuerbares_einkommen_mittelwert ELSE - T.steuerbares_einkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.steuerbares_einkommen_mittelwert END)\n    ) AS steuerbares_einkommen_mittelwert_prozent_aenderung_2000_2020\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Clara'\n    AND T.jahr IN (2000, 2020);\n\n\n### Question\nZeigen Sie mir den Gini-Koeffizienten des Reinverm\u00f6gens f\u00fcr Bettingen, Iselin und Bruderholz (BS) im Jahr 2012.\n### SQL query\nSELECT S.name, T.reinvermogen_gini_koeffizient\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2012\n    AND S.name IN ('Bettingen', 'Iselin', 'Bruderholz');\n\n\n### Question\nZeigen Sie mir alle Einkommenssteuerertragsindikatoren \u00fcber Breite, im Kanton Basel-Stadt, \u00fcber den Zeitraum 2015-2020.\n### SQL query\nSELECT T.jahr, T.ertrag_einkommenssteuer_mittelwert, T.ertrag_einkommenssteuer_median\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Breite'\n    AND T.jahr BETWEEN 2015 AND 2020;\n\n\n### Question\nZeigen Sie mir alle Einkommenssteuerertragsindikatoren \u00fcber Breite, im Kanton Basel-Stadt, \u00fcber den Zeitraum 2015-2020.\n### SQL query\nSELECT T.jahr, T.ertrag_einkommenssteuer_mittelwert, T.ertrag_einkommenssteuer_median\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Breite'\n    AND T.jahr BETWEEN 2015 AND 2020;\n\n\n### Question\nWie haben sich das mittlere Nettoeinkommen und das mittlere steuerpflichtige Einkommen (in Prozent) zwischen 2000 und 2020 in Clara, BS, ver\u00e4ndert?\n### SQL query\nSELECT\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.reineinkommen_mittelwert ELSE - T.reineinkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.reineinkommen_mittelwert END)\n    ) AS reineinkommen_mittelwert_prozent_aenderung_2000_2020,\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.steuerbares_einkommen_mittelwert ELSE - T.steuerbares_einkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.steuerbares_einkommen_mittelwert END)\n    ) AS steuerbares_einkommen_mittelwert_prozent_aenderung_2000_2020\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Clara'\n    AND T.jahr IN (2000, 2020);\n\n\n### Question\nWie hoch war das mittlere Reinverm\u00f6gen in den 5 Wohngebieten von Basel-Stadt mit dem niedrigsten mittleren Reineinkommen im Jahr 2015?\n### SQL query\nSELECT S.name, T.reinvermogen_mittelwert AS reinvermogen_mittelwert_2015\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nJOIN (\n    SELECT T.spatialunit_uid\n    FROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE T.jahr = 2015\n    ORDER BY T.reineinkommen_mittelwert ASC\n    LIMIT 5\n) AS T2 ON T.spatialunit_uid = T2.spatialunit_uid\nWHERE T.jahr = 2015;\n\n\n### Question\nWelche Wohnviertel in Basel-Stadt hat das h\u00f6chste Netto-Medianeinkommen im Jahr 2005? Geben Sie auch das Einkommen an.\n### SQL query\nSELECT S.name, T.reineinkommen_median\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2005\nORDER BY T.reineinkommen_median DESC\nLIMIT 1;\n\n\n### Question\nIn welchem Wohnquartier in Basel-Stadt war die Einkommensungleichheit im Jahr 2020 am gr\u00f6ssten?\n### SQL query\n",
    "process_time": 4.418492326978594,
    "num_tokens": 3382,
    "hardness": "extra",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 111,
    "question": "Wie hoch war das durchschnittliche steuerbare Einkommen im Kanton Basel-Stadt im Jahr 2014?",
    "query": "SELECT (SUM(T.anzahl_veranlagungen * T.steuerbares_einkommen_mittelwert)) / SUM(T.anzahl_veranlagungen) AS steuerbares_einkommen_mittelwert_basel_stadt_2014\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2014;\n",
    "db_id": "basel_stadt_steuerstatistik_kennzahlen_wohnvierteln",
    "generated_query": "SELECT AVG(steuerbares_einkommen_mittelwert) AS durchschnittliches_steuerbares_einkommen_2014\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln\nWHERE jahr = 2014;",
    "meta_data": [
      {
        "question": "Zeigen Sie mir alle Einkommenssteuerertragsindikatoren \u00fcber Breite, im Kanton Basel-Stadt, \u00fcber den Zeitraum 2015-2020.",
        "query": "SELECT T.jahr, T.ertrag_einkommenssteuer_mittelwert, T.ertrag_einkommenssteuer_median\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Breite'\n    AND T.jahr BETWEEN 2015 AND 2020;\n"
      },
      {
        "question": "Wie haben sich das mittlere Nettoeinkommen und das mittlere steuerpflichtige Einkommen (in Prozent) zwischen 2000 und 2020 in Clara, BS, ver\u00e4ndert?",
        "query": "SELECT\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.reineinkommen_mittelwert ELSE - T.reineinkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.reineinkommen_mittelwert END)\n    ) AS reineinkommen_mittelwert_prozent_aenderung_2000_2020,\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.steuerbares_einkommen_mittelwert ELSE - T.steuerbares_einkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.steuerbares_einkommen_mittelwert END)\n    ) AS steuerbares_einkommen_mittelwert_prozent_aenderung_2000_2020\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Clara'\n    AND T.jahr IN (2000, 2020);\n"
      },
      {
        "question": "Zeigen Sie mir den Gini-Koeffizienten des Reinverm\u00f6gens f\u00fcr Bettingen, Iselin und Bruderholz (BS) im Jahr 2012.",
        "query": "SELECT S.name, T.reinvermogen_gini_koeffizient\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2012\n    AND S.name IN ('Bettingen', 'Iselin', 'Bruderholz');\n"
      },
      {
        "question": "Zeigen Sie mir alle Einkommenssteuerertragsindikatoren \u00fcber Breite, im Kanton Basel-Stadt, \u00fcber den Zeitraum 2015-2020.",
        "query": "SELECT T.jahr, T.ertrag_einkommenssteuer_mittelwert, T.ertrag_einkommenssteuer_median\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Breite'\n    AND T.jahr BETWEEN 2015 AND 2020;\n"
      },
      {
        "question": "Zeigen Sie mir den Gini-Koeffizienten des Reinverm\u00f6gens f\u00fcr Bettingen, Iselin und Bruderholz (BS) im Jahr 2012.",
        "query": "SELECT S.name, T.reinvermogen_gini_koeffizient\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2012\n    AND S.name IN ('Bettingen', 'Iselin', 'Bruderholz');\n"
      },
      {
        "question": "Welche Wohnviertel in Basel-Stadt hat das h\u00f6chste Netto-Medianeinkommen im Jahr 2005? Geben Sie auch das Einkommen an.",
        "query": "SELECT S.name, T.reineinkommen_median\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2005\nORDER BY T.reineinkommen_median DESC\nLIMIT 1;\n"
      },
      {
        "question": "Zeigen Sie mir alle Einkommenssteuerertragsindikatoren \u00fcber Breite, im Kanton Basel-Stadt, \u00fcber den Zeitraum 2015-2020.",
        "query": "SELECT T.jahr, T.ertrag_einkommenssteuer_mittelwert, T.ertrag_einkommenssteuer_median\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Breite'\n    AND T.jahr BETWEEN 2015 AND 2020;\n"
      },
      {
        "question": "Welcher Anteil der Wohnvierteln in Basel-Stadt hatte 2015 ein mittleres Einkommen von \u00fcber 80'000 CHF?",
        "query": "SELECT 100.0 * COUNT(CASE WHEN T.reineinkommen_mittelwert > 75000 THEN 1 END) / COUNT(*) AS anteil_wohnvierteln_ueber_100000_reineinkommen_mittelwert_2015\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2015;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_stadt_steuerstatistik_kennzahlen_wohnvierteln (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanzahl_veranlagungen NUMERIC, \n\treineinkommen_mittelwert NUMERIC, \n\treineinkommen_median NUMERIC, \n\treineinkommen_gini_koeffizient NUMERIC, \n\tsteuerbares_einkommen_mittelwert NUMERIC, \n\tsteuerbares_einkommen_median NUMERIC, \n\tertrag_einkommenssteuer_mittelwert NUMERIC, \n\tertrag_einkommenssteuer_median NUMERIC, \n\treinvermogen_mittelwert NUMERIC, \n\treinvermogen_median NUMERIC, \n\treinvermogen_gini_koeffizient NUMERIC, \n\tsteuerbares_vermogen_mittelwert NUMERIC, \n\tsteuerbares_vermogen_median NUMERIC, \n\tertrag_vermogenssteuer_mittelwert NUMERIC, \n\tertrag_vermogenssteuer_median NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_stadt_steuerstatistik_kennzahlen_wohnvierteln_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_stadt_steuerstatistik_kennzahlen_woh_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_stadt_steuerstatistik_kennzahlen_wohnvierteln and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2015, 2000, 2009, 1991, 1993\nanzahl_veranlagungen : 10196, 3363, 6733, 3291, 5122\nreineinkommen_mittelwert : 49902, 76323, 51446, 48338, 74705\nreineinkommen_median : 47700, 45950, 58400, 38251, 50291\nreineinkommen_gini_koeffizient : 0.60199999999999998, 0.45300000000000001, 0.49700000000000000, 0.43099999999999999, 0.39800000000000002\nsteuerbares_einkommen_mittelwert : 46197, 55027, 83204, 28426, 49033\nsteuerbares_einkommen_median : 35200, 27120, 43000, 36400, 52200\nertrag_einkommenssteuer_mittelwert : 8083, 17822, 9603, 6036, 17343\nertrag_einkommenssteuer_median : 8163, 6875, 5200, 6557, 4506\nreinvermogen_mittelwert : 1482, 145997, 61020, 279127, 115398\nreinvermogen_median : 11977, 1120, 30057, 33263, 18533\nreinvermogen_gini_koeffizient : 0.84399999999999997, 0.93500000000000005, 0.88400000000000001, 0.84199999999999997, 0.83799999999999997\nsteuerbares_vermogen_mittelwert : 838326, 90853, 235973, 36060, 264570\nertrag_vermogenssteuer_mittelwert : 1162, 412, 4632, 4386, 736\nspatialunit_uid : 1201_A.ADM4, 1202_A.ADM4, 1216_A.ADM4, 1204_A.ADM4, 1213_A.ADM4\n*/\n\n/*\nColumn name, Column discription, Example values\nanzahl_veranlagungen, None, 5433,8141,3226\nreineinkommen_mittelwert, None, 47514,63915,53985\nreineinkommen_median, None, 44300,50600,47200\nreineinkommen_gini_koeffizient, None, 0.334,0.424,0.382\nsteuerbares_einkommen_mittelwert, None, 42282,56532,48135\nsteuerbares_einkommen_median, None, 39900,45200,42000\nertrag_einkommenssteuer_mittelwert, None, 6285,9946,7823\nertrag_einkommenssteuer_median, None, 5082,6475,5610\nreinvermogen_mittelwert, None, 32774,149771,89835\nreinvermogen_median, None, 0,17000,18000\nreinvermogen_gini_koeffizient, None, 0.91,0.89,0.919\nsteuerbares_vermogen_mittelwert, None, 30636,137175,84603\nsteuerbares_vermogen_median, None, 0,2128,4321\nertrag_vermogenssteuer_mittelwert, None, 175,961,591\nertrag_vermogenssteuer_median, None, 0,15,1\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nZeigen Sie mir alle Einkommenssteuerertragsindikatoren \u00fcber Breite, im Kanton Basel-Stadt, \u00fcber den Zeitraum 2015-2020.\n### SQL query\nSELECT T.jahr, T.ertrag_einkommenssteuer_mittelwert, T.ertrag_einkommenssteuer_median\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Breite'\n    AND T.jahr BETWEEN 2015 AND 2020;\n\n\n### Question\nWie haben sich das mittlere Nettoeinkommen und das mittlere steuerpflichtige Einkommen (in Prozent) zwischen 2000 und 2020 in Clara, BS, ver\u00e4ndert?\n### SQL query\nSELECT\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.reineinkommen_mittelwert ELSE - T.reineinkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.reineinkommen_mittelwert END)\n    ) AS reineinkommen_mittelwert_prozent_aenderung_2000_2020,\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.steuerbares_einkommen_mittelwert ELSE - T.steuerbares_einkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.steuerbares_einkommen_mittelwert END)\n    ) AS steuerbares_einkommen_mittelwert_prozent_aenderung_2000_2020\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Clara'\n    AND T.jahr IN (2000, 2020);\n\n\n### Question\nZeigen Sie mir den Gini-Koeffizienten des Reinverm\u00f6gens f\u00fcr Bettingen, Iselin und Bruderholz (BS) im Jahr 2012.\n### SQL query\nSELECT S.name, T.reinvermogen_gini_koeffizient\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2012\n    AND S.name IN ('Bettingen', 'Iselin', 'Bruderholz');\n\n\n### Question\nZeigen Sie mir alle Einkommenssteuerertragsindikatoren \u00fcber Breite, im Kanton Basel-Stadt, \u00fcber den Zeitraum 2015-2020.\n### SQL query\nSELECT T.jahr, T.ertrag_einkommenssteuer_mittelwert, T.ertrag_einkommenssteuer_median\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Breite'\n    AND T.jahr BETWEEN 2015 AND 2020;\n\n\n### Question\nZeigen Sie mir den Gini-Koeffizienten des Reinverm\u00f6gens f\u00fcr Bettingen, Iselin und Bruderholz (BS) im Jahr 2012.\n### SQL query\nSELECT S.name, T.reinvermogen_gini_koeffizient\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2012\n    AND S.name IN ('Bettingen', 'Iselin', 'Bruderholz');\n\n\n### Question\nWelche Wohnviertel in Basel-Stadt hat das h\u00f6chste Netto-Medianeinkommen im Jahr 2005? Geben Sie auch das Einkommen an.\n### SQL query\nSELECT S.name, T.reineinkommen_median\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2005\nORDER BY T.reineinkommen_median DESC\nLIMIT 1;\n\n\n### Question\nZeigen Sie mir alle Einkommenssteuerertragsindikatoren \u00fcber Breite, im Kanton Basel-Stadt, \u00fcber den Zeitraum 2015-2020.\n### SQL query\nSELECT T.jahr, T.ertrag_einkommenssteuer_mittelwert, T.ertrag_einkommenssteuer_median\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Breite'\n    AND T.jahr BETWEEN 2015 AND 2020;\n\n\n### Question\nWelcher Anteil der Wohnvierteln in Basel-Stadt hatte 2015 ein mittleres Einkommen von \u00fcber 80'000 CHF?\n### SQL query\nSELECT 100.0 * COUNT(CASE WHEN T.reineinkommen_mittelwert > 75000 THEN 1 END) / COUNT(*) AS anteil_wohnvierteln_ueber_100000_reineinkommen_mittelwert_2015\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2015;\n\n\n### Question\nWie hoch war das durchschnittliche steuerbare Einkommen im Kanton Basel-Stadt im Jahr 2014?\n### SQL query\n",
    "process_time": 6.3426139038056135,
    "num_tokens": 3142,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 112,
    "question": "Wie stark hat sich das durchschnittliche steuerpflichtige Verm\u00f6gen in Clara (BS) zwischen 1995 und 2015 ver\u00e4ndert? Geben Sie den relativen Unterschied in Prozent an.",
    "query": "SELECT\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2015 THEN T.steuerbares_vermogen_mittelwert ELSE - T.steuerbares_vermogen_mittelwert END) /\n        SUM(T.steuerbares_vermogen_mittelwert)\n     ) AS steuerbares_vermogen_mittelwert_prozent_aenderung_1995_2015\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Clara'\n    AND T.jahr IN (1995, 2015);\n",
    "db_id": "basel_stadt_steuerstatistik_kennzahlen_wohnvierteln",
    "generated_query": "SELECT\n    (\n        100.0 * (T2.steuerbares_vermogen_mittelwert - T1.steuerbares_vermogen_mittelwert) / T1.steuerbares_vermogen_mittelwert\n    ) AS steuerbares_vermogen_mittelwert_prozent_aenderung_1995_2015\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T1\nJOIN basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T2 ON T1.spatialunit_uid = T2.spatialunit_uid\nJOIN spatial_unit AS S ON T1.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Clara'\n    AND T1.jahr = 1995\n    AND T2.jahr = 2015;",
    "meta_data": [
      {
        "question": "Welche Wohnviertel in Basel-Stadt hat das h\u00f6chste Netto-Medianeinkommen im Jahr 2005? Geben Sie auch das Einkommen an.",
        "query": "SELECT S.name, T.reineinkommen_median\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2005\nORDER BY T.reineinkommen_median DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wie haben sich das mittlere Nettoeinkommen und das mittlere steuerpflichtige Einkommen (in Prozent) zwischen 2000 und 2020 in Clara, BS, ver\u00e4ndert?",
        "query": "SELECT\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.reineinkommen_mittelwert ELSE - T.reineinkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.reineinkommen_mittelwert END)\n    ) AS reineinkommen_mittelwert_prozent_aenderung_2000_2020,\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.steuerbares_einkommen_mittelwert ELSE - T.steuerbares_einkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.steuerbares_einkommen_mittelwert END)\n    ) AS steuerbares_einkommen_mittelwert_prozent_aenderung_2000_2020\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Clara'\n    AND T.jahr IN (2000, 2020);\n"
      },
      {
        "question": "Welches waren die 3 Wohnvierteln in Basel-Stadt mit dem h\u00f6chsten durchschnittlichen steuerbaren Verm\u00f6gen im Jahr 2010? Geben Sie auch das Verm\u00f6gen an.",
        "query": "SELECT S.name, T.steuerbares_vermogen_mittelwert\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2010\nORDER BY T.steuerbares_vermogen_mittelwert DESC\nLIMIT 3;\n"
      },
      {
        "question": "Welches waren die 3 Wohnvierteln in Basel-Stadt mit dem h\u00f6chsten durchschnittlichen steuerbaren Verm\u00f6gen im Jahr 2010? Geben Sie auch das Verm\u00f6gen an.",
        "query": "SELECT S.name, T.steuerbares_vermogen_mittelwert\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2010\nORDER BY T.steuerbares_vermogen_mittelwert DESC\nLIMIT 3;\n"
      },
      {
        "question": "Wie haben sich das mittlere Nettoeinkommen und das mittlere steuerpflichtige Einkommen (in Prozent) zwischen 2000 und 2020 in Clara, BS, ver\u00e4ndert?",
        "query": "SELECT\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.reineinkommen_mittelwert ELSE - T.reineinkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.reineinkommen_mittelwert END)\n    ) AS reineinkommen_mittelwert_prozent_aenderung_2000_2020,\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.steuerbares_einkommen_mittelwert ELSE - T.steuerbares_einkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.steuerbares_einkommen_mittelwert END)\n    ) AS steuerbares_einkommen_mittelwert_prozent_aenderung_2000_2020\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Clara'\n    AND T.jahr IN (2000, 2020);\n"
      },
      {
        "question": "Wie haben sich das mittlere Nettoeinkommen und das mittlere steuerpflichtige Einkommen (in Prozent) zwischen 2000 und 2020 in Clara, BS, ver\u00e4ndert?",
        "query": "SELECT\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.reineinkommen_mittelwert ELSE - T.reineinkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.reineinkommen_mittelwert END)\n    ) AS reineinkommen_mittelwert_prozent_aenderung_2000_2020,\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.steuerbares_einkommen_mittelwert ELSE - T.steuerbares_einkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.steuerbares_einkommen_mittelwert END)\n    ) AS steuerbares_einkommen_mittelwert_prozent_aenderung_2000_2020\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Clara'\n    AND T.jahr IN (2000, 2020);\n"
      },
      {
        "question": "Welche Wohnviertel in Basel-Stadt hat das h\u00f6chste Netto-Medianeinkommen im Jahr 2005? Geben Sie auch das Einkommen an.",
        "query": "SELECT S.name, T.reineinkommen_median\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2005\nORDER BY T.reineinkommen_median DESC\nLIMIT 1;\n"
      },
      {
        "question": "Zeigen Sie mir den Gini-Koeffizienten des Reinverm\u00f6gens f\u00fcr Bettingen, Iselin und Bruderholz (BS) im Jahr 2012.",
        "query": "SELECT S.name, T.reinvermogen_gini_koeffizient\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2012\n    AND S.name IN ('Bettingen', 'Iselin', 'Bruderholz');\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_stadt_steuerstatistik_kennzahlen_wohnvierteln (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanzahl_veranlagungen NUMERIC, \n\treineinkommen_mittelwert NUMERIC, \n\treineinkommen_median NUMERIC, \n\treineinkommen_gini_koeffizient NUMERIC, \n\tsteuerbares_einkommen_mittelwert NUMERIC, \n\tsteuerbares_einkommen_median NUMERIC, \n\tertrag_einkommenssteuer_mittelwert NUMERIC, \n\tertrag_einkommenssteuer_median NUMERIC, \n\treinvermogen_mittelwert NUMERIC, \n\treinvermogen_median NUMERIC, \n\treinvermogen_gini_koeffizient NUMERIC, \n\tsteuerbares_vermogen_mittelwert NUMERIC, \n\tsteuerbares_vermogen_median NUMERIC, \n\tertrag_vermogenssteuer_mittelwert NUMERIC, \n\tertrag_vermogenssteuer_median NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_stadt_steuerstatistik_kennzahlen_wohnvierteln_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_stadt_steuerstatistik_kennzahlen_woh_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_stadt_steuerstatistik_kennzahlen_wohnvierteln and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2015, 2000, 2009, 1991, 1993\nanzahl_veranlagungen : 10196, 3363, 6733, 3291, 5122\nreineinkommen_mittelwert : 49902, 76323, 51446, 48338, 74705\nreineinkommen_median : 47700, 45950, 58400, 38251, 50291\nreineinkommen_gini_koeffizient : 0.60199999999999998, 0.45300000000000001, 0.49700000000000000, 0.43099999999999999, 0.39800000000000002\nsteuerbares_einkommen_mittelwert : 46197, 55027, 83204, 28426, 49033\nsteuerbares_einkommen_median : 35200, 27120, 43000, 36400, 52200\nertrag_einkommenssteuer_mittelwert : 8083, 17822, 9603, 6036, 17343\nertrag_einkommenssteuer_median : 8163, 6875, 5200, 6557, 4506\nreinvermogen_mittelwert : 1482, 145997, 61020, 279127, 115398\nreinvermogen_median : 11977, 1120, 30057, 33263, 18533\nreinvermogen_gini_koeffizient : 0.84399999999999997, 0.93500000000000005, 0.88400000000000001, 0.84199999999999997, 0.83799999999999997\nsteuerbares_vermogen_mittelwert : 838326, 90853, 235973, 36060, 264570\nertrag_vermogenssteuer_mittelwert : 1162, 412, 4632, 4386, 736\nspatialunit_uid : 1201_A.ADM4, 1202_A.ADM4, 1216_A.ADM4, 1204_A.ADM4, 1213_A.ADM4\n*/\n\n/*\nColumn name, Column discription, Example values\nanzahl_veranlagungen, None, 5433,8141,3226\nreineinkommen_mittelwert, None, 47514,63915,53985\nreineinkommen_median, None, 44300,50600,47200\nreineinkommen_gini_koeffizient, None, 0.334,0.424,0.382\nsteuerbares_einkommen_mittelwert, None, 42282,56532,48135\nsteuerbares_einkommen_median, None, 39900,45200,42000\nertrag_einkommenssteuer_mittelwert, None, 6285,9946,7823\nertrag_einkommenssteuer_median, None, 5082,6475,5610\nreinvermogen_mittelwert, None, 32774,149771,89835\nreinvermogen_median, None, 0,17000,18000\nreinvermogen_gini_koeffizient, None, 0.91,0.89,0.919\nsteuerbares_vermogen_mittelwert, None, 30636,137175,84603\nsteuerbares_vermogen_median, None, 0,2128,4321\nertrag_vermogenssteuer_mittelwert, None, 175,961,591\nertrag_vermogenssteuer_median, None, 0,15,1\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWelche Wohnviertel in Basel-Stadt hat das h\u00f6chste Netto-Medianeinkommen im Jahr 2005? Geben Sie auch das Einkommen an.\n### SQL query\nSELECT S.name, T.reineinkommen_median\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2005\nORDER BY T.reineinkommen_median DESC\nLIMIT 1;\n\n\n### Question\nWie haben sich das mittlere Nettoeinkommen und das mittlere steuerpflichtige Einkommen (in Prozent) zwischen 2000 und 2020 in Clara, BS, ver\u00e4ndert?\n### SQL query\nSELECT\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.reineinkommen_mittelwert ELSE - T.reineinkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.reineinkommen_mittelwert END)\n    ) AS reineinkommen_mittelwert_prozent_aenderung_2000_2020,\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.steuerbares_einkommen_mittelwert ELSE - T.steuerbares_einkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.steuerbares_einkommen_mittelwert END)\n    ) AS steuerbares_einkommen_mittelwert_prozent_aenderung_2000_2020\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Clara'\n    AND T.jahr IN (2000, 2020);\n\n\n### Question\nWelches waren die 3 Wohnvierteln in Basel-Stadt mit dem h\u00f6chsten durchschnittlichen steuerbaren Verm\u00f6gen im Jahr 2010? Geben Sie auch das Verm\u00f6gen an.\n### SQL query\nSELECT S.name, T.steuerbares_vermogen_mittelwert\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2010\nORDER BY T.steuerbares_vermogen_mittelwert DESC\nLIMIT 3;\n\n\n### Question\nWelches waren die 3 Wohnvierteln in Basel-Stadt mit dem h\u00f6chsten durchschnittlichen steuerbaren Verm\u00f6gen im Jahr 2010? Geben Sie auch das Verm\u00f6gen an.\n### SQL query\nSELECT S.name, T.steuerbares_vermogen_mittelwert\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2010\nORDER BY T.steuerbares_vermogen_mittelwert DESC\nLIMIT 3;\n\n\n### Question\nWie haben sich das mittlere Nettoeinkommen und das mittlere steuerpflichtige Einkommen (in Prozent) zwischen 2000 und 2020 in Clara, BS, ver\u00e4ndert?\n### SQL query\nSELECT\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.reineinkommen_mittelwert ELSE - T.reineinkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.reineinkommen_mittelwert END)\n    ) AS reineinkommen_mittelwert_prozent_aenderung_2000_2020,\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.steuerbares_einkommen_mittelwert ELSE - T.steuerbares_einkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.steuerbares_einkommen_mittelwert END)\n    ) AS steuerbares_einkommen_mittelwert_prozent_aenderung_2000_2020\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Clara'\n    AND T.jahr IN (2000, 2020);\n\n\n### Question\nWie haben sich das mittlere Nettoeinkommen und das mittlere steuerpflichtige Einkommen (in Prozent) zwischen 2000 und 2020 in Clara, BS, ver\u00e4ndert?\n### SQL query\nSELECT\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.reineinkommen_mittelwert ELSE - T.reineinkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.reineinkommen_mittelwert END)\n    ) AS reineinkommen_mittelwert_prozent_aenderung_2000_2020,\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.steuerbares_einkommen_mittelwert ELSE - T.steuerbares_einkommen_mittelwert END) /\n        SUM(CASE WHEN T.jahr = 2000 THEN T.steuerbares_einkommen_mittelwert END)\n    ) AS steuerbares_einkommen_mittelwert_prozent_aenderung_2000_2020\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Clara'\n    AND T.jahr IN (2000, 2020);\n\n\n### Question\nWelche Wohnviertel in Basel-Stadt hat das h\u00f6chste Netto-Medianeinkommen im Jahr 2005? Geben Sie auch das Einkommen an.\n### SQL query\nSELECT S.name, T.reineinkommen_median\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2005\nORDER BY T.reineinkommen_median DESC\nLIMIT 1;\n\n\n### Question\nZeigen Sie mir den Gini-Koeffizienten des Reinverm\u00f6gens f\u00fcr Bettingen, Iselin und Bruderholz (BS) im Jahr 2012.\n### SQL query\nSELECT S.name, T.reinvermogen_gini_koeffizient\nFROM basel_stadt_steuerstatistik_kennzahlen_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2012\n    AND S.name IN ('Bettingen', 'Iselin', 'Bruderholz');\n\n\n### Question\nWie stark hat sich das durchschnittliche steuerpflichtige Verm\u00f6gen in Clara (BS) zwischen 1995 und 2015 ver\u00e4ndert? Geben Sie den relativen Unterschied in Prozent an.\n### SQL query\n",
    "process_time": 20.69289882411249,
    "num_tokens": 3496,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 113,
    "question": "Wie hat sich die Wohnfl\u00e4che pro Einwohner in der Altstadt Grossbasel \u00fcber den Zeitraum 2015 - 2019 entwickelt?",
    "query": "SELECT T.jahr, T.wohnflache_pro_person_m2\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Altstadt Grossbasel'\n    AND T.jahr >= 2015\n    AND T.jahr <= 2019\nORDER BY T.jahr ASC;\n",
    "db_id": "basel_stadt_kennzahlen_zu_den_basler_wohnvierteln",
    "generated_query": "SELECT T.jahr, T.wohnflache_pro_person_m2\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Altstadt Grossbasel'\n    AND T.jahr BETWEEN 2015 AND 2019\nORDER BY T.jahr ASC;",
    "meta_data": [
      {
        "question": "Wie hoch waren der Altersquotient und der Jugendquotient in Gundelingen, BS in den Jahren 2015, 2017 und 2019?",
        "query": "SELECT T.jahr, T.altersquotient_uber_64_jahr, T.jugendquotient_unter_20_jahr\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Gundeldingen'\n    AND T.jahr IN (2015, 2017, 2019);\n"
      },
      {
        "question": "Wie hoch war der Anteil der Personen ohne Religionszugeh\u00f6rigkeit in den Jahren 2015 und 2018 in Bachletten und St. Alban, BS?",
        "query": "SELECT\n    S.name,\n    T.jahr,\n    T.anteil_personen_ohne_religionszugehorigkeit\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2018)\n    AND S.name IN ('St. Alban', 'Bachletten');\n"
      },
      {
        "question": "F\u00fcr welchen Zeitraum liegen besch\u00e4ftigungsbezogene Statistiken \u00fcber die Wohngebiete in Basel-Stadt vor?",
        "query": "SELECT MIN(T.jahr) erste_jahr, MAX(T.jahr) AS letzte_jahr\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE' ;\n"
      },
      {
        "question": "Zeige mir besch\u00e4ftigungsbezogene Statistiken \u00fcber Iselin (BS)",
        "query": "SELECT T.jahr, T.arbeitsplatze_pro_einwohner, T.arbeitslosenquote\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Iselin'\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Wie hat sich der Anteil an Gr\u00fcnfl\u00e4chen (in Prozent) von 2015 bis 2022 in den einzelnen Wohngebieten von Basel-Stadt ver\u00e4ndert?",
        "query": "SELECT\n    S.name,\n    (   100.0 * SUM(CASE WHEN T.jahr = 2022 THEN T.anteil_grunflachen ELSE - T.anteil_grunflachen END) /\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anteil_grunflachen END)\n    ) AS prozent_aenderung_anteil_grunflachen_2018_2022\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2022)\nGROUP BY S.name\nORDER BY prozent_aenderung_anteil_grunflachen_2018_2022 DESC;\n"
      },
      {
        "question": "Wie hat sich der Anteil an Gr\u00fcnfl\u00e4chen (in Prozent) von 2015 bis 2022 in den einzelnen Wohngebieten von Basel-Stadt ver\u00e4ndert?",
        "query": "SELECT\n    S.name,\n    (   100.0 * SUM(CASE WHEN T.jahr = 2022 THEN T.anteil_grunflachen ELSE - T.anteil_grunflachen END) /\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anteil_grunflachen END)\n    ) AS prozent_aenderung_anteil_grunflachen_2018_2022\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2022)\nGROUP BY S.name\nORDER BY prozent_aenderung_anteil_grunflachen_2018_2022 DESC;\n"
      },
      {
        "question": "Welches war das Wohnviertel in Basel-Stadt mit der h\u00f6chsten Arbeitslosenquote im Jahr 2016? Geben Sie auch dessen Arbeitslosenquote an.",
        "query": "SELECT S.name, T.arbeitslosenquote\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2016\nORDER BY T.arbeitslosenquote DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wie hat sich der Anteil an Gr\u00fcnfl\u00e4chen (in Prozent) von 2015 bis 2022 in den einzelnen Wohngebieten von Basel-Stadt ver\u00e4ndert?",
        "query": "SELECT\n    S.name,\n    (   100.0 * SUM(CASE WHEN T.jahr = 2022 THEN T.anteil_grunflachen ELSE - T.anteil_grunflachen END) /\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anteil_grunflachen END)\n    ) AS prozent_aenderung_anteil_grunflachen_2018_2022\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2022)\nGROUP BY S.name\nORDER BY prozent_aenderung_anteil_grunflachen_2018_2022 DESC;\n"
      },
      {
        "question": "Welches war das Wohnviertel in Basel-Stadt mit der h\u00f6chsten Arbeitslosenquote im Jahr 2016? Geben Sie auch dessen Arbeitslosenquote an.",
        "query": "SELECT S.name, T.arbeitslosenquote\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2016\nORDER BY T.arbeitslosenquote DESC\nLIMIT 1;\n"
      },
      {
        "question": "Welches war das Wohnviertel in Basel-Stadt mit der h\u00f6chsten Arbeitslosenquote im Jahr 2016? Geben Sie auch dessen Arbeitslosenquote an.",
        "query": "SELECT S.name, T.arbeitslosenquote\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2016\nORDER BY T.arbeitslosenquote DESC\nLIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_stadt_kennzahlen_zu_den_basler_wohnvierteln (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanteil_sozialhilfeempfanger NUMERIC, \n\tanteil_auslander NUMERIC, \n\tanteil_personen_ohne_religionszugehorigkeit NUMERIC, \n\tanteil_personen_in_einpersonenhaushalten NUMERIC, \n\tgymnasialquote_anteil_progymnasium NUMERIC, \n\taltersquotient_uber_64_jahr NUMERIC, \n\tanteil_sesshafte_10_jahr NUMERIC, \n\tjugendquotient_unter_20_jahr NUMERIC, \n\tbaujahr_der_wohngebaude NUMERIC, \n\tanteil_einfamilienhauser NUMERIC, \n\tanteil_grunflachen NUMERIC, \n\tflache_pro_wohnung_m2 NUMERIC, \n\twohnflache_pro_person_m2 NUMERIC, \n\tvermogenssteuer_pro_veranlagung NUMERIC, \n\teinkommenssteuer_pro_veranlagung NUMERIC, \n\terwerbstatigenquote NUMERIC, \n\tarbeitsplatze_pro_einwohner NUMERIC, \n\tarbeitslosenquote NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_stadt_kennzahlen_zu_den_basler_wohnvierteln_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_stadt_kennzahlen_zu_den_basler_wohnv_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_stadt_kennzahlen_zu_den_basler_wohnvierteln and 5 examples in each column for high cardinality columns :\nuid : 127, 72, 115, 29, 88\nanteil_sozialhilfeempfanger : 0.036462146700000003, 0.044288034699999999, 0.102261986999999999, 0.072136009700000003, 0.061665170800000002\nanteil_auslander : 0.54932771749999998, 0.24181360199999999, 0.46906325609999999, 0.33106291450000003, 0.49516648759999998\nanteil_personen_ohne_religionszugehorigkeit : 0.54197080289999999, 0.56129807690000000, 0.45887239219999998, 0.55467625899999995, 0.45219300849999999\nanteil_personen_in_einpersonenhaushalten : 0.27202621939999999, 0.18741779920000001, 0.22872415250000000, 0.21965800080000000, 0.16285400450000001\ngymnasialquote_anteil_progymnasium : 0.291666666700000021, 0.281600000000000017, 0.256983240200000018, 0.529411764999999979, 0.334710743799999988\naltersquotient_uber_64_jahr : 0.34772462079999999, 0.31847220329999998, 0.48919346339999997, 0.42441860469999998, 0.22081468560000000\nanteil_sesshafte_10_jahr : 0.42835868519999998, 0.34730642649999999, 0.36488687780000001, 0.42011157859999998, 0.34303797470000003\njugendquotient_unter_20_jahr : 0.14900849860000001, 0.26604532939999997, 0.16842431760000001, 0.39893617020000000, 0.37264273920000002\nbaujahr_der_wohngebaude : 1959.7900448218909, 1958.6391875746710, 1938.1238532110090, 1822.1476377952749, 1937.4723502304139\nanteil_einfamilienhauser : 0.063694267515000000, 0.028711484600000000, 0.729742612010999991, 0.029494382000000000, 0.247857613700000007\nanteil_grunflachen : 0.317000000000000004, 0.245999999999999996, 0.597557345699999964, 0.323401986199999991, 0.279203501600000015\nflache_pro_wohnung_m2 : 92.894002211000000, 70.502958579999998, 65.596241610999996, 65.419001867999995, 69.447001989000000\nwohnflache_pro_person_m2 : 45.582391542000003, 36.619708000000003, 50.417294042000002, 45.351959720000004, 50.008398067999998\nvermogenssteuer_pro_veranlagung : 9028.28375670000059, 3296.11330339999995, 3335.30000000000018, 240.50197771000001, 2692.61881979999998\neinkommenssteuer_pro_veranlagung : 6483.8999999999996, 9551.3314957000002, 6584.1510922999996, 22172.4429909999999, 19997.7000000000007\nerwerbstatigenquote : 0.54000060000000005, 0.71170310000000003, 0.78440610000000000, 0.74342713839999996, 0.74026020000000003\narbeitsplatze_pro_einwohner : 0.59697549999999999, 4.47645119999999963, 1.46645230000000004, 0.58034108669999995, 0.29923055279999999\narbeitslosenquote : 0.029764606100000000, 0.051270591900000002, 0.053996192599999999, 0.040157344400000003, 0.055594617700000001\nspatialunit_uid : 1201_A.ADM4, 1202_A.ADM4, 1216_A.ADM4, 1204_A.ADM4, 1213_A.ADM4\n*/\n\n/*\nColumn name, Column discription, Example values\nanteil_sozialhilfeempfanger, None, 0.0384108454,0.0566399639,0.0616651708\nanteil_auslander, None, 0.3403313877,0.3193049757,0.3919011668\nanteil_personen_ohne_religionszugehorigkeit, None, 0.4882319714,0.4715107751,0.4412121852\nanteil_personen_in_einpersonenhaushalten, None, 0.3000205634,0.2883006761,0.2792870645\ngymnasialquote_anteil_progymnasium, None, 0.5740740741,0.2924528302,0.3366336634\naltersquotient_uber_64_jahr, None, 0.3601476015,0.3394025102,0.2155230596\nanteil_sesshafte_10_jahr, None, 0.3055921672,0.3543946745,0.3012512539\njugendquotient_unter_20_jahr, None, 0.2076752768,0.227328973,0.2048743907\nbaujahr_der_wohngebaude, None, 1918.3832335,1939.8939394,1931.8792135\nanteil_einfamilienhauser, None, 0.1984602224,0.1363636364,0.029494382\nanteil_grunflachen, None, 0.2390179539,0.3585967524,0.1742961539\nflache_pro_wohnung_m2, None, 82.343801381,69.810768933,70.418289354\nwohnflache_pro_person_m2, None, 47.311517,39.026379,38.692324\nvermogenssteuer_pro_veranlagung, None, 2378.931266,483.02681775,460.5646986\neinkommenssteuer_pro_veranlagung, None, 10820.800512,7123.8581681,7075.5415415\nerwerbstatigenquote, None, 0.8077279565,0.7324650618,0.7397509203\narbeitsplatze_pro_einwohner, None, 0.9906581653,0.1403727831,0.6350379648\narbeitslosenquote, None, 0.0252819637,0.0466659488,0.0400550591\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWie hoch waren der Altersquotient und der Jugendquotient in Gundelingen, BS in den Jahren 2015, 2017 und 2019?\n### SQL query\nSELECT T.jahr, T.altersquotient_uber_64_jahr, T.jugendquotient_unter_20_jahr\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Gundeldingen'\n    AND T.jahr IN (2015, 2017, 2019);\n\n\n### Question\nWie hoch war der Anteil der Personen ohne Religionszugeh\u00f6rigkeit in den Jahren 2015 und 2018 in Bachletten und St. Alban, BS?\n### SQL query\nSELECT\n    S.name,\n    T.jahr,\n    T.anteil_personen_ohne_religionszugehorigkeit\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2018)\n    AND S.name IN ('St. Alban', 'Bachletten');\n\n\n### Question\nF\u00fcr welchen Zeitraum liegen besch\u00e4ftigungsbezogene Statistiken \u00fcber die Wohngebiete in Basel-Stadt vor?\n### SQL query\nSELECT MIN(T.jahr) erste_jahr, MAX(T.jahr) AS letzte_jahr\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE' ;\n\n\n### Question\nZeige mir besch\u00e4ftigungsbezogene Statistiken \u00fcber Iselin (BS)\n### SQL query\nSELECT T.jahr, T.arbeitsplatze_pro_einwohner, T.arbeitslosenquote\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Iselin'\nORDER BY T.jahr ASC;\n\n\n### Question\nWie hat sich der Anteil an Gr\u00fcnfl\u00e4chen (in Prozent) von 2015 bis 2022 in den einzelnen Wohngebieten von Basel-Stadt ver\u00e4ndert?\n### SQL query\nSELECT\n    S.name,\n    (   100.0 * SUM(CASE WHEN T.jahr = 2022 THEN T.anteil_grunflachen ELSE - T.anteil_grunflachen END) /\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anteil_grunflachen END)\n    ) AS prozent_aenderung_anteil_grunflachen_2018_2022\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2022)\nGROUP BY S.name\nORDER BY prozent_aenderung_anteil_grunflachen_2018_2022 DESC;\n\n\n### Question\nWie hat sich der Anteil an Gr\u00fcnfl\u00e4chen (in Prozent) von 2015 bis 2022 in den einzelnen Wohngebieten von Basel-Stadt ver\u00e4ndert?\n### SQL query\nSELECT\n    S.name,\n    (   100.0 * SUM(CASE WHEN T.jahr = 2022 THEN T.anteil_grunflachen ELSE - T.anteil_grunflachen END) /\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anteil_grunflachen END)\n    ) AS prozent_aenderung_anteil_grunflachen_2018_2022\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2022)\nGROUP BY S.name\nORDER BY prozent_aenderung_anteil_grunflachen_2018_2022 DESC;\n\n\n### Question\nWelches war das Wohnviertel in Basel-Stadt mit der h\u00f6chsten Arbeitslosenquote im Jahr 2016? Geben Sie auch dessen Arbeitslosenquote an.\n### SQL query\nSELECT S.name, T.arbeitslosenquote\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2016\nORDER BY T.arbeitslosenquote DESC\nLIMIT 1;\n\n\n### Question\nWie hat sich der Anteil an Gr\u00fcnfl\u00e4chen (in Prozent) von 2015 bis 2022 in den einzelnen Wohngebieten von Basel-Stadt ver\u00e4ndert?\n### SQL query\nSELECT\n    S.name,\n    (   100.0 * SUM(CASE WHEN T.jahr = 2022 THEN T.anteil_grunflachen ELSE - T.anteil_grunflachen END) /\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anteil_grunflachen END)\n    ) AS prozent_aenderung_anteil_grunflachen_2018_2022\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2022)\nGROUP BY S.name\nORDER BY prozent_aenderung_anteil_grunflachen_2018_2022 DESC;\n\n\n### Question\nWelches war das Wohnviertel in Basel-Stadt mit der h\u00f6chsten Arbeitslosenquote im Jahr 2016? Geben Sie auch dessen Arbeitslosenquote an.\n### SQL query\nSELECT S.name, T.arbeitslosenquote\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2016\nORDER BY T.arbeitslosenquote DESC\nLIMIT 1;\n\n\n### Question\nWelches war das Wohnviertel in Basel-Stadt mit der h\u00f6chsten Arbeitslosenquote im Jahr 2016? Geben Sie auch dessen Arbeitslosenquote an.\n### SQL query\nSELECT S.name, T.arbeitslosenquote\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2016\nORDER BY T.arbeitslosenquote DESC\nLIMIT 1;\n\n\n### Question\nWie hat sich die Wohnfl\u00e4che pro Einwohner in der Altstadt Grossbasel \u00fcber den Zeitraum 2015 - 2019 entwickelt?\n### SQL query\n",
    "process_time": 11.78180345799774,
    "num_tokens": 4416,
    "hardness": "hard",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 114,
    "question": "Wie heissen die 3 Wohngebiete in Basel-Stadt mit der kleinsten Wohnfl\u00e4che pro Einwohner im Jahr 2020?",
    "query": "SELECT S.name\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.wohnflache_pro_person_m2 ASC\nLIMIT 3;\n",
    "db_id": "basel_stadt_kennzahlen_zu_den_basler_wohnvierteln",
    "generated_query": "SELECT S.name, T.wohnflache_pro_person_m2\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2020\nORDER BY T.wohnflache_pro_person_m2 ASC\nLIMIT 3;",
    "meta_data": [
      {
        "question": "Wie hoch ist der Anteil der Sekundarsch\u00fclerinnen und -sch\u00fcler im BruderHolz in Basel-Stadt in den Jahren 2016 und 2020 in den Progymnasialklassen?",
        "query": "SELECT T.jahr, T.gymnasialquote_anteil_progymnasium\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Bruderholz'\n    AND T.jahr IN (2016, 2020);"
      },
      {
        "question": "Wie hat sich der Anteil an Gr\u00fcnfl\u00e4chen (in Prozent) von 2015 bis 2022 in den einzelnen Wohngebieten von Basel-Stadt ver\u00e4ndert?",
        "query": "SELECT\n    S.name,\n    (   100.0 * SUM(CASE WHEN T.jahr = 2022 THEN T.anteil_grunflachen ELSE - T.anteil_grunflachen END) /\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anteil_grunflachen END)\n    ) AS prozent_aenderung_anteil_grunflachen_2018_2022\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2022)\nGROUP BY S.name\nORDER BY prozent_aenderung_anteil_grunflachen_2018_2022 DESC;\n"
      },
      {
        "question": "Zeige mir besch\u00e4ftigungsbezogene Statistiken \u00fcber Iselin (BS)",
        "query": "SELECT T.jahr, T.arbeitsplatze_pro_einwohner, T.arbeitslosenquote\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Iselin'\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Zeige mir besch\u00e4ftigungsbezogene Statistiken \u00fcber Iselin (BS)",
        "query": "SELECT T.jahr, T.arbeitsplatze_pro_einwohner, T.arbeitslosenquote\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Iselin'\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "F\u00fcr welchen Zeitraum liegen besch\u00e4ftigungsbezogene Statistiken \u00fcber die Wohngebiete in Basel-Stadt vor?",
        "query": "SELECT MIN(T.jahr) erste_jahr, MAX(T.jahr) AS letzte_jahr\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE' ;\n"
      },
      {
        "question": "Welches Wohnviertel in Basel-Stadt hatte im Jahr 2023 die durchschnittlich \u00e4ltesten Geb\u00e4ude und welches war das durchschnittliche Baudatum?",
        "query": "SELECT S.name, T.baujahr_der_wohngebaude\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2023\nORDER BY T.baujahr_der_wohngebaude ASC\nLIMIT 1;\n"
      },
      {
        "question": "Wie hoch waren der Altersquotient und der Jugendquotient in Gundelingen, BS in den Jahren 2015, 2017 und 2019?",
        "query": "SELECT T.jahr, T.altersquotient_uber_64_jahr, T.jugendquotient_unter_20_jahr\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Gundeldingen'\n    AND T.jahr IN (2015, 2017, 2019);\n"
      },
      {
        "question": "Welches war das Wohnviertel in Basel-Stadt mit der h\u00f6chsten Arbeitslosenquote im Jahr 2016? Geben Sie auch dessen Arbeitslosenquote an.",
        "query": "SELECT S.name, T.arbeitslosenquote\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2016\nORDER BY T.arbeitslosenquote DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wie hoch war der Anteil der Personen ohne Religionszugeh\u00f6rigkeit in den Jahren 2015 und 2018 in Bachletten und St. Alban, BS?",
        "query": "SELECT\n    S.name,\n    T.jahr,\n    T.anteil_personen_ohne_religionszugehorigkeit\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2018)\n    AND S.name IN ('St. Alban', 'Bachletten');\n"
      },
      {
        "question": "Wie hat sich der Anteil an Gr\u00fcnfl\u00e4chen (in Prozent) von 2015 bis 2022 in den einzelnen Wohngebieten von Basel-Stadt ver\u00e4ndert?",
        "query": "SELECT\n    S.name,\n    (   100.0 * SUM(CASE WHEN T.jahr = 2022 THEN T.anteil_grunflachen ELSE - T.anteil_grunflachen END) /\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anteil_grunflachen END)\n    ) AS prozent_aenderung_anteil_grunflachen_2018_2022\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2022)\nGROUP BY S.name\nORDER BY prozent_aenderung_anteil_grunflachen_2018_2022 DESC;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_stadt_kennzahlen_zu_den_basler_wohnvierteln (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanteil_sozialhilfeempfanger NUMERIC, \n\tanteil_auslander NUMERIC, \n\tanteil_personen_ohne_religionszugehorigkeit NUMERIC, \n\tanteil_personen_in_einpersonenhaushalten NUMERIC, \n\tgymnasialquote_anteil_progymnasium NUMERIC, \n\taltersquotient_uber_64_jahr NUMERIC, \n\tanteil_sesshafte_10_jahr NUMERIC, \n\tjugendquotient_unter_20_jahr NUMERIC, \n\tbaujahr_der_wohngebaude NUMERIC, \n\tanteil_einfamilienhauser NUMERIC, \n\tanteil_grunflachen NUMERIC, \n\tflache_pro_wohnung_m2 NUMERIC, \n\twohnflache_pro_person_m2 NUMERIC, \n\tvermogenssteuer_pro_veranlagung NUMERIC, \n\teinkommenssteuer_pro_veranlagung NUMERIC, \n\terwerbstatigenquote NUMERIC, \n\tarbeitsplatze_pro_einwohner NUMERIC, \n\tarbeitslosenquote NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_stadt_kennzahlen_zu_den_basler_wohnvierteln_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_stadt_kennzahlen_zu_den_basler_wohnv_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_stadt_kennzahlen_zu_den_basler_wohnvierteln and 5 examples in each column for high cardinality columns :\nuid : 127, 72, 115, 29, 88\nanteil_sozialhilfeempfanger : 0.036462146700000003, 0.044288034699999999, 0.102261986999999999, 0.072136009700000003, 0.061665170800000002\nanteil_auslander : 0.54932771749999998, 0.24181360199999999, 0.46906325609999999, 0.33106291450000003, 0.49516648759999998\nanteil_personen_ohne_religionszugehorigkeit : 0.54197080289999999, 0.56129807690000000, 0.45887239219999998, 0.55467625899999995, 0.45219300849999999\nanteil_personen_in_einpersonenhaushalten : 0.27202621939999999, 0.18741779920000001, 0.22872415250000000, 0.21965800080000000, 0.16285400450000001\ngymnasialquote_anteil_progymnasium : 0.291666666700000021, 0.281600000000000017, 0.256983240200000018, 0.529411764999999979, 0.334710743799999988\naltersquotient_uber_64_jahr : 0.34772462079999999, 0.31847220329999998, 0.48919346339999997, 0.42441860469999998, 0.22081468560000000\nanteil_sesshafte_10_jahr : 0.42835868519999998, 0.34730642649999999, 0.36488687780000001, 0.42011157859999998, 0.34303797470000003\njugendquotient_unter_20_jahr : 0.14900849860000001, 0.26604532939999997, 0.16842431760000001, 0.39893617020000000, 0.37264273920000002\nbaujahr_der_wohngebaude : 1959.7900448218909, 1958.6391875746710, 1938.1238532110090, 1822.1476377952749, 1937.4723502304139\nanteil_einfamilienhauser : 0.063694267515000000, 0.028711484600000000, 0.729742612010999991, 0.029494382000000000, 0.247857613700000007\nanteil_grunflachen : 0.317000000000000004, 0.245999999999999996, 0.597557345699999964, 0.323401986199999991, 0.279203501600000015\nflache_pro_wohnung_m2 : 92.894002211000000, 70.502958579999998, 65.596241610999996, 65.419001867999995, 69.447001989000000\nwohnflache_pro_person_m2 : 45.582391542000003, 36.619708000000003, 50.417294042000002, 45.351959720000004, 50.008398067999998\nvermogenssteuer_pro_veranlagung : 9028.28375670000059, 3296.11330339999995, 3335.30000000000018, 240.50197771000001, 2692.61881979999998\neinkommenssteuer_pro_veranlagung : 6483.8999999999996, 9551.3314957000002, 6584.1510922999996, 22172.4429909999999, 19997.7000000000007\nerwerbstatigenquote : 0.54000060000000005, 0.71170310000000003, 0.78440610000000000, 0.74342713839999996, 0.74026020000000003\narbeitsplatze_pro_einwohner : 0.59697549999999999, 4.47645119999999963, 1.46645230000000004, 0.58034108669999995, 0.29923055279999999\narbeitslosenquote : 0.029764606100000000, 0.051270591900000002, 0.053996192599999999, 0.040157344400000003, 0.055594617700000001\nspatialunit_uid : 1201_A.ADM4, 1202_A.ADM4, 1216_A.ADM4, 1204_A.ADM4, 1213_A.ADM4\n*/\n\n/*\nColumn name, Column discription, Example values\nanteil_sozialhilfeempfanger, None, 0.0384108454,0.0566399639,0.0616651708\nanteil_auslander, None, 0.3403313877,0.3193049757,0.3919011668\nanteil_personen_ohne_religionszugehorigkeit, None, 0.4882319714,0.4715107751,0.4412121852\nanteil_personen_in_einpersonenhaushalten, None, 0.3000205634,0.2883006761,0.2792870645\ngymnasialquote_anteil_progymnasium, None, 0.5740740741,0.2924528302,0.3366336634\naltersquotient_uber_64_jahr, None, 0.3601476015,0.3394025102,0.2155230596\nanteil_sesshafte_10_jahr, None, 0.3055921672,0.3543946745,0.3012512539\njugendquotient_unter_20_jahr, None, 0.2076752768,0.227328973,0.2048743907\nbaujahr_der_wohngebaude, None, 1918.3832335,1939.8939394,1931.8792135\nanteil_einfamilienhauser, None, 0.1984602224,0.1363636364,0.029494382\nanteil_grunflachen, None, 0.2390179539,0.3585967524,0.1742961539\nflache_pro_wohnung_m2, None, 82.343801381,69.810768933,70.418289354\nwohnflache_pro_person_m2, None, 47.311517,39.026379,38.692324\nvermogenssteuer_pro_veranlagung, None, 2378.931266,483.02681775,460.5646986\neinkommenssteuer_pro_veranlagung, None, 10820.800512,7123.8581681,7075.5415415\nerwerbstatigenquote, None, 0.8077279565,0.7324650618,0.7397509203\narbeitsplatze_pro_einwohner, None, 0.9906581653,0.1403727831,0.6350379648\narbeitslosenquote, None, 0.0252819637,0.0466659488,0.0400550591\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWie hoch ist der Anteil der Sekundarsch\u00fclerinnen und -sch\u00fcler im BruderHolz in Basel-Stadt in den Jahren 2016 und 2020 in den Progymnasialklassen?\n### SQL query\nSELECT T.jahr, T.gymnasialquote_anteil_progymnasium\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Bruderholz'\n    AND T.jahr IN (2016, 2020);\n\n### Question\nWie hat sich der Anteil an Gr\u00fcnfl\u00e4chen (in Prozent) von 2015 bis 2022 in den einzelnen Wohngebieten von Basel-Stadt ver\u00e4ndert?\n### SQL query\nSELECT\n    S.name,\n    (   100.0 * SUM(CASE WHEN T.jahr = 2022 THEN T.anteil_grunflachen ELSE - T.anteil_grunflachen END) /\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anteil_grunflachen END)\n    ) AS prozent_aenderung_anteil_grunflachen_2018_2022\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2022)\nGROUP BY S.name\nORDER BY prozent_aenderung_anteil_grunflachen_2018_2022 DESC;\n\n\n### Question\nZeige mir besch\u00e4ftigungsbezogene Statistiken \u00fcber Iselin (BS)\n### SQL query\nSELECT T.jahr, T.arbeitsplatze_pro_einwohner, T.arbeitslosenquote\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Iselin'\nORDER BY T.jahr ASC;\n\n\n### Question\nZeige mir besch\u00e4ftigungsbezogene Statistiken \u00fcber Iselin (BS)\n### SQL query\nSELECT T.jahr, T.arbeitsplatze_pro_einwohner, T.arbeitslosenquote\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Iselin'\nORDER BY T.jahr ASC;\n\n\n### Question\nF\u00fcr welchen Zeitraum liegen besch\u00e4ftigungsbezogene Statistiken \u00fcber die Wohngebiete in Basel-Stadt vor?\n### SQL query\nSELECT MIN(T.jahr) erste_jahr, MAX(T.jahr) AS letzte_jahr\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE' ;\n\n\n### Question\nWelches Wohnviertel in Basel-Stadt hatte im Jahr 2023 die durchschnittlich \u00e4ltesten Geb\u00e4ude und welches war das durchschnittliche Baudatum?\n### SQL query\nSELECT S.name, T.baujahr_der_wohngebaude\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2023\nORDER BY T.baujahr_der_wohngebaude ASC\nLIMIT 1;\n\n\n### Question\nWie hoch waren der Altersquotient und der Jugendquotient in Gundelingen, BS in den Jahren 2015, 2017 und 2019?\n### SQL query\nSELECT T.jahr, T.altersquotient_uber_64_jahr, T.jugendquotient_unter_20_jahr\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Gundeldingen'\n    AND T.jahr IN (2015, 2017, 2019);\n\n\n### Question\nWelches war das Wohnviertel in Basel-Stadt mit der h\u00f6chsten Arbeitslosenquote im Jahr 2016? Geben Sie auch dessen Arbeitslosenquote an.\n### SQL query\nSELECT S.name, T.arbeitslosenquote\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2016\nORDER BY T.arbeitslosenquote DESC\nLIMIT 1;\n\n\n### Question\nWie hoch war der Anteil der Personen ohne Religionszugeh\u00f6rigkeit in den Jahren 2015 und 2018 in Bachletten und St. Alban, BS?\n### SQL query\nSELECT\n    S.name,\n    T.jahr,\n    T.anteil_personen_ohne_religionszugehorigkeit\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2018)\n    AND S.name IN ('St. Alban', 'Bachletten');\n\n\n### Question\nWie hat sich der Anteil an Gr\u00fcnfl\u00e4chen (in Prozent) von 2015 bis 2022 in den einzelnen Wohngebieten von Basel-Stadt ver\u00e4ndert?\n### SQL query\nSELECT\n    S.name,\n    (   100.0 * SUM(CASE WHEN T.jahr = 2022 THEN T.anteil_grunflachen ELSE - T.anteil_grunflachen END) /\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anteil_grunflachen END)\n    ) AS prozent_aenderung_anteil_grunflachen_2018_2022\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2022)\nGROUP BY S.name\nORDER BY prozent_aenderung_anteil_grunflachen_2018_2022 DESC;\n\n\n### Question\nWie heissen die 3 Wohngebiete in Basel-Stadt mit der kleinsten Wohnfl\u00e4che pro Einwohner im Jahr 2020?\n### SQL query\n",
    "process_time": 9.768040511058643,
    "num_tokens": 4328,
    "hardness": "extra",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 115,
    "question": "Wie hoch ist die relative Ver\u00e4nderung (in %) des Ausl\u00e4nderanteils zwischen 2018 und 2023 in den einzelnen Wohnvierteln von Basel-Stadt?",
    "query": "SELECT\n    S.name,\n    (   100.0 * SUM(CASE WHEN T.jahr = 2023 THEN T.anteil_auslander ELSE - T.anteil_auslander END) /\n        SUM(CASE WHEN T.jahr = 2018 THEN T.anteil_auslander END)\n    ) AS prozent_aenderung_anteil_auslander_2018_2023\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2018, 2023)\nGROUP BY S.name ;\n",
    "db_id": "basel_stadt_kennzahlen_zu_den_basler_wohnvierteln",
    "generated_query": "SELECT\n    S.name,\n    (   100.0 * SUM(CASE WHEN T.jahr = 2023 THEN T.anteil_auslander ELSE - T.anteil_auslander END) /\n        SUM(CASE WHEN T.jahr = 2018 THEN T.anteil_auslander END)\n    ) AS prozent_aenderung_anteil_auslander_2018_2023\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2018, 2023)\nGROUP BY S.name\nORDER BY prozent_aenderung_anteil_auslander_2018_2023 DESC;",
    "meta_data": [
      {
        "question": "Welche 3 Basler Wohngebiete hatten 2015 den geringsten Anteil an Sozialhilfeempf\u00e4ngern und wie hoch waren die Anteile?",
        "query": "SELECT S.name, T.anteil_sozialhilfeempfanger\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2015\nORDER BY T.anteil_sozialhilfeempfanger ASC\nLIMIT 3;\n"
      },
      {
        "question": "Wie hat sich der Anteil an Gr\u00fcnfl\u00e4chen (in Prozent) von 2015 bis 2022 in den einzelnen Wohngebieten von Basel-Stadt ver\u00e4ndert?",
        "query": "SELECT\n    S.name,\n    (   100.0 * SUM(CASE WHEN T.jahr = 2022 THEN T.anteil_grunflachen ELSE - T.anteil_grunflachen END) /\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anteil_grunflachen END)\n    ) AS prozent_aenderung_anteil_grunflachen_2018_2022\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2022)\nGROUP BY S.name\nORDER BY prozent_aenderung_anteil_grunflachen_2018_2022 DESC;\n"
      },
      {
        "question": "Wie hoch ist der Anteil der Sekundarsch\u00fclerinnen und -sch\u00fcler im BruderHolz in Basel-Stadt in den Jahren 2016 und 2020 in den Progymnasialklassen?",
        "query": "SELECT T.jahr, T.gymnasialquote_anteil_progymnasium\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Bruderholz'\n    AND T.jahr IN (2016, 2020);"
      },
      {
        "question": "Welches war das Wohnviertel in Basel-Stadt mit der h\u00f6chsten Arbeitslosenquote im Jahr 2016? Geben Sie auch dessen Arbeitslosenquote an.",
        "query": "SELECT S.name, T.arbeitslosenquote\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2016\nORDER BY T.arbeitslosenquote DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wie hat sich der Anteil an Gr\u00fcnfl\u00e4chen (in Prozent) von 2015 bis 2022 in den einzelnen Wohngebieten von Basel-Stadt ver\u00e4ndert?",
        "query": "SELECT\n    S.name,\n    (   100.0 * SUM(CASE WHEN T.jahr = 2022 THEN T.anteil_grunflachen ELSE - T.anteil_grunflachen END) /\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anteil_grunflachen END)\n    ) AS prozent_aenderung_anteil_grunflachen_2018_2022\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2022)\nGROUP BY S.name\nORDER BY prozent_aenderung_anteil_grunflachen_2018_2022 DESC;\n"
      },
      {
        "question": "In welchem Jahr war die h\u00f6chste Arbeitslosenquote in Vorst\u00e4dte (BS) zu verzeichnen?",
        "query": "SELECT T.jahr\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Vorst\u00e4dte'\nORDER BY T.arbeitslosenquote ASC\nLIMIT 1;\n"
      },
      {
        "question": "Zeige mir besch\u00e4ftigungsbezogene Statistiken \u00fcber Iselin (BS)",
        "query": "SELECT T.jahr, T.arbeitsplatze_pro_einwohner, T.arbeitslosenquote\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Iselin'\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Zeige mir besch\u00e4ftigungsbezogene Statistiken \u00fcber Iselin (BS)",
        "query": "SELECT T.jahr, T.arbeitsplatze_pro_einwohner, T.arbeitslosenquote\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Iselin'\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Wie hoch war der Anteil der Personen ohne Religionszugeh\u00f6rigkeit in den Jahren 2015 und 2018 in Bachletten und St. Alban, BS?",
        "query": "SELECT\n    S.name,\n    T.jahr,\n    T.anteil_personen_ohne_religionszugehorigkeit\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2018)\n    AND S.name IN ('St. Alban', 'Bachletten');\n"
      },
      {
        "question": "Wie hoch war der Anteil der Personen ohne Religionszugeh\u00f6rigkeit in den Jahren 2015 und 2018 in Bachletten und St. Alban, BS?",
        "query": "SELECT\n    S.name,\n    T.jahr,\n    T.anteil_personen_ohne_religionszugehorigkeit\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2018)\n    AND S.name IN ('St. Alban', 'Bachletten');\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.basel_stadt_kennzahlen_zu_den_basler_wohnvierteln (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tanteil_sozialhilfeempfanger NUMERIC, \n\tanteil_auslander NUMERIC, \n\tanteil_personen_ohne_religionszugehorigkeit NUMERIC, \n\tanteil_personen_in_einpersonenhaushalten NUMERIC, \n\tgymnasialquote_anteil_progymnasium NUMERIC, \n\taltersquotient_uber_64_jahr NUMERIC, \n\tanteil_sesshafte_10_jahr NUMERIC, \n\tjugendquotient_unter_20_jahr NUMERIC, \n\tbaujahr_der_wohngebaude NUMERIC, \n\tanteil_einfamilienhauser NUMERIC, \n\tanteil_grunflachen NUMERIC, \n\tflache_pro_wohnung_m2 NUMERIC, \n\twohnflache_pro_person_m2 NUMERIC, \n\tvermogenssteuer_pro_veranlagung NUMERIC, \n\teinkommenssteuer_pro_veranlagung NUMERIC, \n\terwerbstatigenquote NUMERIC, \n\tarbeitsplatze_pro_einwohner NUMERIC, \n\tarbeitslosenquote NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT basel_stadt_kennzahlen_zu_den_basler_wohnvierteln_pkey PRIMARY KEY (uid), \n\tCONSTRAINT basel_stadt_kennzahlen_zu_den_basler_wohnv_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in basel_stadt_kennzahlen_zu_den_basler_wohnvierteln and 5 examples in each column for high cardinality columns :\nuid : 127, 72, 115, 29, 88\nanteil_sozialhilfeempfanger : 0.036462146700000003, 0.044288034699999999, 0.102261986999999999, 0.072136009700000003, 0.061665170800000002\nanteil_auslander : 0.54932771749999998, 0.24181360199999999, 0.46906325609999999, 0.33106291450000003, 0.49516648759999998\nanteil_personen_ohne_religionszugehorigkeit : 0.54197080289999999, 0.56129807690000000, 0.45887239219999998, 0.55467625899999995, 0.45219300849999999\nanteil_personen_in_einpersonenhaushalten : 0.27202621939999999, 0.18741779920000001, 0.22872415250000000, 0.21965800080000000, 0.16285400450000001\ngymnasialquote_anteil_progymnasium : 0.291666666700000021, 0.281600000000000017, 0.256983240200000018, 0.529411764999999979, 0.334710743799999988\naltersquotient_uber_64_jahr : 0.34772462079999999, 0.31847220329999998, 0.48919346339999997, 0.42441860469999998, 0.22081468560000000\nanteil_sesshafte_10_jahr : 0.42835868519999998, 0.34730642649999999, 0.36488687780000001, 0.42011157859999998, 0.34303797470000003\njugendquotient_unter_20_jahr : 0.14900849860000001, 0.26604532939999997, 0.16842431760000001, 0.39893617020000000, 0.37264273920000002\nbaujahr_der_wohngebaude : 1959.7900448218909, 1958.6391875746710, 1938.1238532110090, 1822.1476377952749, 1937.4723502304139\nanteil_einfamilienhauser : 0.063694267515000000, 0.028711484600000000, 0.729742612010999991, 0.029494382000000000, 0.247857613700000007\nanteil_grunflachen : 0.317000000000000004, 0.245999999999999996, 0.597557345699999964, 0.323401986199999991, 0.279203501600000015\nflache_pro_wohnung_m2 : 92.894002211000000, 70.502958579999998, 65.596241610999996, 65.419001867999995, 69.447001989000000\nwohnflache_pro_person_m2 : 45.582391542000003, 36.619708000000003, 50.417294042000002, 45.351959720000004, 50.008398067999998\nvermogenssteuer_pro_veranlagung : 9028.28375670000059, 3296.11330339999995, 3335.30000000000018, 240.50197771000001, 2692.61881979999998\neinkommenssteuer_pro_veranlagung : 6483.8999999999996, 9551.3314957000002, 6584.1510922999996, 22172.4429909999999, 19997.7000000000007\nerwerbstatigenquote : 0.54000060000000005, 0.71170310000000003, 0.78440610000000000, 0.74342713839999996, 0.74026020000000003\narbeitsplatze_pro_einwohner : 0.59697549999999999, 4.47645119999999963, 1.46645230000000004, 0.58034108669999995, 0.29923055279999999\narbeitslosenquote : 0.029764606100000000, 0.051270591900000002, 0.053996192599999999, 0.040157344400000003, 0.055594617700000001\nspatialunit_uid : 1201_A.ADM4, 1202_A.ADM4, 1216_A.ADM4, 1204_A.ADM4, 1213_A.ADM4\n*/\n\n/*\nColumn name, Column discription, Example values\nanteil_sozialhilfeempfanger, None, 0.0384108454,0.0566399639,0.0616651708\nanteil_auslander, None, 0.3403313877,0.3193049757,0.3919011668\nanteil_personen_ohne_religionszugehorigkeit, None, 0.4882319714,0.4715107751,0.4412121852\nanteil_personen_in_einpersonenhaushalten, None, 0.3000205634,0.2883006761,0.2792870645\ngymnasialquote_anteil_progymnasium, None, 0.5740740741,0.2924528302,0.3366336634\naltersquotient_uber_64_jahr, None, 0.3601476015,0.3394025102,0.2155230596\nanteil_sesshafte_10_jahr, None, 0.3055921672,0.3543946745,0.3012512539\njugendquotient_unter_20_jahr, None, 0.2076752768,0.227328973,0.2048743907\nbaujahr_der_wohngebaude, None, 1918.3832335,1939.8939394,1931.8792135\nanteil_einfamilienhauser, None, 0.1984602224,0.1363636364,0.029494382\nanteil_grunflachen, None, 0.2390179539,0.3585967524,0.1742961539\nflache_pro_wohnung_m2, None, 82.343801381,69.810768933,70.418289354\nwohnflache_pro_person_m2, None, 47.311517,39.026379,38.692324\nvermogenssteuer_pro_veranlagung, None, 2378.931266,483.02681775,460.5646986\neinkommenssteuer_pro_veranlagung, None, 10820.800512,7123.8581681,7075.5415415\nerwerbstatigenquote, None, 0.8077279565,0.7324650618,0.7397509203\narbeitsplatze_pro_einwohner, None, 0.9906581653,0.1403727831,0.6350379648\narbeitslosenquote, None, 0.0252819637,0.0466659488,0.0400550591\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWelche 3 Basler Wohngebiete hatten 2015 den geringsten Anteil an Sozialhilfeempf\u00e4ngern und wie hoch waren die Anteile?\n### SQL query\nSELECT S.name, T.anteil_sozialhilfeempfanger\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2015\nORDER BY T.anteil_sozialhilfeempfanger ASC\nLIMIT 3;\n\n\n### Question\nWie hat sich der Anteil an Gr\u00fcnfl\u00e4chen (in Prozent) von 2015 bis 2022 in den einzelnen Wohngebieten von Basel-Stadt ver\u00e4ndert?\n### SQL query\nSELECT\n    S.name,\n    (   100.0 * SUM(CASE WHEN T.jahr = 2022 THEN T.anteil_grunflachen ELSE - T.anteil_grunflachen END) /\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anteil_grunflachen END)\n    ) AS prozent_aenderung_anteil_grunflachen_2018_2022\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2022)\nGROUP BY S.name\nORDER BY prozent_aenderung_anteil_grunflachen_2018_2022 DESC;\n\n\n### Question\nWie hoch ist der Anteil der Sekundarsch\u00fclerinnen und -sch\u00fcler im BruderHolz in Basel-Stadt in den Jahren 2016 und 2020 in den Progymnasialklassen?\n### SQL query\nSELECT T.jahr, T.gymnasialquote_anteil_progymnasium\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Bruderholz'\n    AND T.jahr IN (2016, 2020);\n\n### Question\nWelches war das Wohnviertel in Basel-Stadt mit der h\u00f6chsten Arbeitslosenquote im Jahr 2016? Geben Sie auch dessen Arbeitslosenquote an.\n### SQL query\nSELECT S.name, T.arbeitslosenquote\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr = 2016\nORDER BY T.arbeitslosenquote DESC\nLIMIT 1;\n\n\n### Question\nWie hat sich der Anteil an Gr\u00fcnfl\u00e4chen (in Prozent) von 2015 bis 2022 in den einzelnen Wohngebieten von Basel-Stadt ver\u00e4ndert?\n### SQL query\nSELECT\n    S.name,\n    (   100.0 * SUM(CASE WHEN T.jahr = 2022 THEN T.anteil_grunflachen ELSE - T.anteil_grunflachen END) /\n        SUM(CASE WHEN T.jahr = 2015 THEN T.anteil_grunflachen END)\n    ) AS prozent_aenderung_anteil_grunflachen_2018_2022\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2022)\nGROUP BY S.name\nORDER BY prozent_aenderung_anteil_grunflachen_2018_2022 DESC;\n\n\n### Question\nIn welchem Jahr war die h\u00f6chste Arbeitslosenquote in Vorst\u00e4dte (BS) zu verzeichnen?\n### SQL query\nSELECT T.jahr\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Vorst\u00e4dte'\nORDER BY T.arbeitslosenquote ASC\nLIMIT 1;\n\n\n### Question\nZeige mir besch\u00e4ftigungsbezogene Statistiken \u00fcber Iselin (BS)\n### SQL query\nSELECT T.jahr, T.arbeitsplatze_pro_einwohner, T.arbeitslosenquote\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Iselin'\nORDER BY T.jahr ASC;\n\n\n### Question\nZeige mir besch\u00e4ftigungsbezogene Statistiken \u00fcber Iselin (BS)\n### SQL query\nSELECT T.jahr, T.arbeitsplatze_pro_einwohner, T.arbeitslosenquote\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND S.name = 'Iselin'\nORDER BY T.jahr ASC;\n\n\n### Question\nWie hoch war der Anteil der Personen ohne Religionszugeh\u00f6rigkeit in den Jahren 2015 und 2018 in Bachletten und St. Alban, BS?\n### SQL query\nSELECT\n    S.name,\n    T.jahr,\n    T.anteil_personen_ohne_religionszugehorigkeit\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2018)\n    AND S.name IN ('St. Alban', 'Bachletten');\n\n\n### Question\nWie hoch war der Anteil der Personen ohne Religionszugeh\u00f6rigkeit in den Jahren 2015 und 2018 in Bachletten und St. Alban, BS?\n### SQL query\nSELECT\n    S.name,\n    T.jahr,\n    T.anteil_personen_ohne_religionszugehorigkeit\nFROM basel_stadt_kennzahlen_zu_den_basler_wohnvierteln AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.residence_area = 'TRUE'\n    AND T.jahr IN (2015, 2018)\n    AND S.name IN ('St. Alban', 'Bachletten');\n\n\n### Question\nWie hoch ist die relative Ver\u00e4nderung (in %) des Ausl\u00e4nderanteils zwischen 2018 und 2023 in den einzelnen Wohnvierteln von Basel-Stadt?\n### SQL query\n",
    "process_time": 10.37680106679909,
    "num_tokens": 4344,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 116,
    "question": "Wie hiessen die 3 bev\u00f6lkerungsreichsten Gemeinden im Kanton Schwyz im Jahr 2015?",
    "query": "SELECT S.name\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) DESC\nLIMIT 3;\n",
    "db_id": "schwyz_standige_wohnbevolkerung_geschlecht_nationalitat",
    "generated_query": "SELECT\n    S.name,\n    SUM(T.anzahl_personen) AS gesamtbevolkerung_2015\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nGROUP BY S.name\nORDER BY gesamtbevolkerung_2015 DESC\nLIMIT 3;",
    "meta_data": [
      {
        "question": "Welches waren die 10 Schwyzer Gemeinden mit dem geringsten Bev\u00f6lkerungswachstum zwischen 2005 und 2022, und wie hoch war ihr prozentuales Wachstum?",
        "query": "SELECT\n    S.name,\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personen ELSE - T.anzahl_personen END) /\n        SUM(CASE WHEN T.jahr = 2005 THEN T.anzahl_personen ELSE 0 END)\n    ) AS prozent_wachstum\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2005, 2022)\nGROUP BY S.name\nORDER BY prozent_wachstum ASC\nLIMIT 10;\n"
      },
      {
        "question": "Welches waren die 10 Schwyzer Gemeinden mit dem geringsten Bev\u00f6lkerungswachstum zwischen 2005 und 2022, und wie hoch war ihr prozentuales Wachstum?",
        "query": "SELECT\n    S.name,\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personen ELSE - T.anzahl_personen END) /\n        SUM(CASE WHEN T.jahr = 2005 THEN T.anzahl_personen ELSE 0 END)\n    ) AS prozent_wachstum\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2005, 2022)\nGROUP BY S.name\nORDER BY prozent_wachstum ASC\nLIMIT 10;\n"
      },
      {
        "question": "Wie hoch ist der Prozentsatz der Gemeinden in Schwyz, die im Jahr 2020 mehr als 10000 Einwohner haben?",
        "query": "SELECT\n    (\n        100.0 * COUNT(CASE WHEN T1.tot_personen > 10000 THEN 1 END) /\n        COUNT(*)\n    )AS prozent_gemeinden_mehr_als_10000_einwohner_2020\nFROM (\n    SELECT SUM(T.anzahl_personen) as tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2020\n    GROUP BY S.name\n) as T1;\n"
      },
      {
        "question": "Wie hoch war die j\u00e4hrliche Wachstumsrate der Bev\u00f6lkerung im Kanton Schwyz in den Jahren 2005-2010?",
        "query": "WITH T1 AS (\n    SELECT\n        T.jahr,\n        SUM(T.anzahl_personen) AS tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr >= 2005\n        AND T.jahr <= 2010\n    GROUP BY T.jahr\n    ORDER BY T.jahr ASC\n)\nSELECT\n    T1.jahr,\n    (\n        100.0 *\n        (T1.tot_personen - LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)) /\n        LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)\n    ) AS tot_personen_vorjahr\nFROM T1;\n"
      },
      {
        "question": "Welche 5 Gemeinden im Kanton Schwyz hatten 2010 das h\u00f6chste Verh\u00e4ltnis zwischen M\u00e4nnern und Frauen? Geben Sie auch das Verh\u00e4ltnis an.",
        "query": "SELECT\n    S.name,\n    (\n        SUM(CASE WHEN T.geschlecht = 'm\u00e4nnlich' THEN T.anzahl_personen ELSE 0 END) /\n        SUM(CASE WHEN T.geschlecht = 'weiblich' THEN T.anzahl_personen ELSE 0 END)\n    ) AS weiblich_mannlich_verhaltnis_2010\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2010\nGROUP BY S.name\nORDER BY weiblich_mannlich_verhaltnis_2010 DESC\nLIMIT 5;\n"
      },
      {
        "question": "Wie hoch war die j\u00e4hrliche Wachstumsrate der Bev\u00f6lkerung im Kanton Schwyz in den Jahren 2005-2010?",
        "query": "WITH T1 AS (\n    SELECT\n        T.jahr,\n        SUM(T.anzahl_personen) AS tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr >= 2005\n        AND T.jahr <= 2010\n    GROUP BY T.jahr\n    ORDER BY T.jahr ASC\n)\nSELECT\n    T1.jahr,\n    (\n        100.0 *\n        (T1.tot_personen - LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)) /\n        LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)\n    ) AS tot_personen_vorjahr\nFROM T1;\n"
      },
      {
        "question": "Zeigen Sie mir f\u00fcr jedes Jahr im Zeitraum 2018 - 2021 die Anzahl der Schweizer Einwohner in Einsiedeln, SZ.",
        "query": "SELECT T.jahr, SUM(T.anzahl_personen) AS anzahl_schweizer_2021_einsiedeln\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr >= 2018\n    AND T.jahr <= 2021\n    AND S.name IN ('Einsiedeln', 'Einsiedeln (SZ)')\n    AND T.nationalitaet = 'Schweiz'\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Welches waren die 10 Schwyzer Gemeinden mit dem geringsten Bev\u00f6lkerungswachstum zwischen 2005 und 2022, und wie hoch war ihr prozentuales Wachstum?",
        "query": "SELECT\n    S.name,\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personen ELSE - T.anzahl_personen END) /\n        SUM(CASE WHEN T.jahr = 2005 THEN T.anzahl_personen ELSE 0 END)\n    ) AS prozent_wachstum\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2005, 2022)\nGROUP BY S.name\nORDER BY prozent_wachstum ASC\nLIMIT 10;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.schwyz_standige_wohnbevolkerung_geschlecht_nationalitat (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tgeschlecht TEXT, \n\tnationalitaet TEXT, \n\tanzahl_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT schwyz_standige_wohnbevolkerung_geschlecht_nationalitat_pkey PRIMARY KEY (uid), \n\tCONSTRAINT schwyz_standige_wohnbevolkerung_geschlecht_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in schwyz_standige_wohnbevolkerung_geschlecht_nationalitat and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nanzahl_personen : 1001, 127, 3563, 3014, 88\nspatialunit_uid : 1374_A.ADM3, 1341_A.ADM3, 1347_A.ADM3, 1372_A.ADM3, 1364_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\ngeschlecht, Geschlecht, m\u00e4nnlich,weiblich\nnationalitaet, Nationalit\u00e4t, Schweiz,Ausland\nanzahl_personen, Anzahl Personen, 3873,964,2926\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWelches waren die 10 Schwyzer Gemeinden mit dem geringsten Bev\u00f6lkerungswachstum zwischen 2005 und 2022, und wie hoch war ihr prozentuales Wachstum?\n### SQL query\nSELECT\n    S.name,\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personen ELSE - T.anzahl_personen END) /\n        SUM(CASE WHEN T.jahr = 2005 THEN T.anzahl_personen ELSE 0 END)\n    ) AS prozent_wachstum\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2005, 2022)\nGROUP BY S.name\nORDER BY prozent_wachstum ASC\nLIMIT 10;\n\n\n### Question\nWelches waren die 10 Schwyzer Gemeinden mit dem geringsten Bev\u00f6lkerungswachstum zwischen 2005 und 2022, und wie hoch war ihr prozentuales Wachstum?\n### SQL query\nSELECT\n    S.name,\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personen ELSE - T.anzahl_personen END) /\n        SUM(CASE WHEN T.jahr = 2005 THEN T.anzahl_personen ELSE 0 END)\n    ) AS prozent_wachstum\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2005, 2022)\nGROUP BY S.name\nORDER BY prozent_wachstum ASC\nLIMIT 10;\n\n\n### Question\nWie hoch ist der Prozentsatz der Gemeinden in Schwyz, die im Jahr 2020 mehr als 10000 Einwohner haben?\n### SQL query\nSELECT\n    (\n        100.0 * COUNT(CASE WHEN T1.tot_personen > 10000 THEN 1 END) /\n        COUNT(*)\n    )AS prozent_gemeinden_mehr_als_10000_einwohner_2020\nFROM (\n    SELECT SUM(T.anzahl_personen) as tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2020\n    GROUP BY S.name\n) as T1;\n\n\n### Question\nWie hoch war die j\u00e4hrliche Wachstumsrate der Bev\u00f6lkerung im Kanton Schwyz in den Jahren 2005-2010?\n### SQL query\nWITH T1 AS (\n    SELECT\n        T.jahr,\n        SUM(T.anzahl_personen) AS tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr >= 2005\n        AND T.jahr <= 2010\n    GROUP BY T.jahr\n    ORDER BY T.jahr ASC\n)\nSELECT\n    T1.jahr,\n    (\n        100.0 *\n        (T1.tot_personen - LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)) /\n        LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)\n    ) AS tot_personen_vorjahr\nFROM T1;\n\n\n### Question\nWelche 5 Gemeinden im Kanton Schwyz hatten 2010 das h\u00f6chste Verh\u00e4ltnis zwischen M\u00e4nnern und Frauen? Geben Sie auch das Verh\u00e4ltnis an.\n### SQL query\nSELECT\n    S.name,\n    (\n        SUM(CASE WHEN T.geschlecht = 'm\u00e4nnlich' THEN T.anzahl_personen ELSE 0 END) /\n        SUM(CASE WHEN T.geschlecht = 'weiblich' THEN T.anzahl_personen ELSE 0 END)\n    ) AS weiblich_mannlich_verhaltnis_2010\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2010\nGROUP BY S.name\nORDER BY weiblich_mannlich_verhaltnis_2010 DESC\nLIMIT 5;\n\n\n### Question\nWie hoch war die j\u00e4hrliche Wachstumsrate der Bev\u00f6lkerung im Kanton Schwyz in den Jahren 2005-2010?\n### SQL query\nWITH T1 AS (\n    SELECT\n        T.jahr,\n        SUM(T.anzahl_personen) AS tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr >= 2005\n        AND T.jahr <= 2010\n    GROUP BY T.jahr\n    ORDER BY T.jahr ASC\n)\nSELECT\n    T1.jahr,\n    (\n        100.0 *\n        (T1.tot_personen - LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)) /\n        LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)\n    ) AS tot_personen_vorjahr\nFROM T1;\n\n\n### Question\nZeigen Sie mir f\u00fcr jedes Jahr im Zeitraum 2018 - 2021 die Anzahl der Schweizer Einwohner in Einsiedeln, SZ.\n### SQL query\nSELECT T.jahr, SUM(T.anzahl_personen) AS anzahl_schweizer_2021_einsiedeln\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr >= 2018\n    AND T.jahr <= 2021\n    AND S.name IN ('Einsiedeln', 'Einsiedeln (SZ)')\n    AND T.nationalitaet = 'Schweiz'\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n\n\n### Question\nWelches waren die 10 Schwyzer Gemeinden mit dem geringsten Bev\u00f6lkerungswachstum zwischen 2005 und 2022, und wie hoch war ihr prozentuales Wachstum?\n### SQL query\nSELECT\n    S.name,\n    (\n        100.0 * SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personen ELSE - T.anzahl_personen END) /\n        SUM(CASE WHEN T.jahr = 2005 THEN T.anzahl_personen ELSE 0 END)\n    ) AS prozent_wachstum\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2005, 2022)\nGROUP BY S.name\nORDER BY prozent_wachstum ASC\nLIMIT 10;\n\n\n### Question\nWie hiessen die 3 bev\u00f6lkerungsreichsten Gemeinden im Kanton Schwyz im Jahr 2015?\n### SQL query\n",
    "process_time": 7.764106924878433,
    "num_tokens": 2641,
    "hardness": "extra",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 117,
    "question": "Wie hoch war der Anteil der M\u00e4nner an der schweizerischen und ausl\u00e4ndischen Wohnbev\u00f6lkerung im Kanton Schwyz in den Jahren 2015 bis 2020?",
    "query": "SELECT\n    T.jahr,\n    (\n        SUM(CASE WHEN T.geschlecht = 'm\u00e4nnlich' AND T.nationalitaet = 'Schweiz' THEN T.anzahl_personen END) /\n        SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen END)\n    ) AS anteil_manner_schweizer,\n    (\n        SUM(CASE WHEN T.geschlecht = 'm\u00e4nnlich' AND T.nationalitaet = 'Ausland' THEN T.anzahl_personen END) /\n        SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen END)\n    ) AS anteil_manner_auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr >= 2015\n    AND T.jahr >= 2020\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n",
    "db_id": "schwyz_standige_wohnbevolkerung_geschlecht_nationalitat",
    "generated_query": "SELECT\n    T.jahr,\n    SUM(CASE WHEN T.geschlecht = 'm\u00e4nnlich' AND T.nationalitaet = 'Schweiz' THEN T.anzahl_personen END) / SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen END) * 100 AS anteil_manner_schweiz,\n    SUM(CASE WHEN T.geschlecht = 'm\u00e4nnlich' AND T.nationalitaet = 'Ausland' THEN T.anzahl_personen END) / SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen END) * 100 AS anteil_manner_ausland\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr >= 2015\n    AND T.jahr <= 2020\nGROUP BY T.jahr\nORDER BY T.jahr ASC;",
    "meta_data": [
      {
        "question": "Zeigen Sie mir die Anzahl der M\u00e4nner und Frauen im Kanton Schwyz in den Jahren 2005, 2010, 2015 und 2020.",
        "query": "SELECT\n    T.jahr,\n    SUM(CASE WHEN T.geschlecht = 'm\u00e4nnlich' THEN T.anzahl_personen END) AS anzahl_manner,\n    SUM(CASE WHEN T.geschlecht = 'weiblich' THEN T.anzahl_personen END) AS anzahl_frauen\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2005, 2010, 2015, 2020)\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Wie hoch war die schweizerische und ausl\u00e4ndische Bev\u00f6lkerung in den 3 kleinsten Schwyzer Gemeinden im Jahr 2020?",
        "query": "SELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS anzahl_schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS anzahl_auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) ASC\nLIMIT 3;\n"
      },
      {
        "question": "Wie hoch war die schweizerische und ausl\u00e4ndische Bev\u00f6lkerung in den 3 kleinsten Schwyzer Gemeinden im Jahr 2020?",
        "query": "SELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS anzahl_schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS anzahl_auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) ASC\nLIMIT 3;\n"
      },
      {
        "question": "Wie hoch ist der Prozentsatz der Gemeinden in Schwyz, die im Jahr 2020 mehr als 10000 Einwohner haben?",
        "query": "SELECT\n    (\n        100.0 * COUNT(CASE WHEN T1.tot_personen > 10000 THEN 1 END) /\n        COUNT(*)\n    )AS prozent_gemeinden_mehr_als_10000_einwohner_2020\nFROM (\n    SELECT SUM(T.anzahl_personen) as tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2020\n    GROUP BY S.name\n) as T1;\n"
      },
      {
        "question": "Wie hoch ist der Prozentsatz der Gemeinden in Schwyz, die im Jahr 2020 mehr als 10000 Einwohner haben?",
        "query": "SELECT\n    (\n        100.0 * COUNT(CASE WHEN T1.tot_personen > 10000 THEN 1 END) /\n        COUNT(*)\n    )AS prozent_gemeinden_mehr_als_10000_einwohner_2020\nFROM (\n    SELECT SUM(T.anzahl_personen) as tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2020\n    GROUP BY S.name\n) as T1;\n"
      },
      {
        "question": "Wie hoch ist der Prozentsatz der Gemeinden in Schwyz, die im Jahr 2020 mehr als 10000 Einwohner haben?",
        "query": "SELECT\n    (\n        100.0 * COUNT(CASE WHEN T1.tot_personen > 10000 THEN 1 END) /\n        COUNT(*)\n    )AS prozent_gemeinden_mehr_als_10000_einwohner_2020\nFROM (\n    SELECT SUM(T.anzahl_personen) as tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2020\n    GROUP BY S.name\n) as T1;\n"
      },
      {
        "question": "Wie hoch war die j\u00e4hrliche Wachstumsrate der Bev\u00f6lkerung im Kanton Schwyz in den Jahren 2005-2010?",
        "query": "WITH T1 AS (\n    SELECT\n        T.jahr,\n        SUM(T.anzahl_personen) AS tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr >= 2005\n        AND T.jahr <= 2010\n    GROUP BY T.jahr\n    ORDER BY T.jahr ASC\n)\nSELECT\n    T1.jahr,\n    (\n        100.0 *\n        (T1.tot_personen - LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)) /\n        LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)\n    ) AS tot_personen_vorjahr\nFROM T1;\n"
      },
      {
        "question": "Wie hoch war die schweizerische und ausl\u00e4ndische Bev\u00f6lkerung in den 3 kleinsten Schwyzer Gemeinden im Jahr 2020?",
        "query": "SELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS anzahl_schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS anzahl_auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) ASC\nLIMIT 3;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.schwyz_standige_wohnbevolkerung_geschlecht_nationalitat (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tgeschlecht TEXT, \n\tnationalitaet TEXT, \n\tanzahl_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT schwyz_standige_wohnbevolkerung_geschlecht_nationalitat_pkey PRIMARY KEY (uid), \n\tCONSTRAINT schwyz_standige_wohnbevolkerung_geschlecht_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in schwyz_standige_wohnbevolkerung_geschlecht_nationalitat and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nanzahl_personen : 1001, 127, 3563, 3014, 88\nspatialunit_uid : 1374_A.ADM3, 1341_A.ADM3, 1347_A.ADM3, 1372_A.ADM3, 1364_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\ngeschlecht, Geschlecht, m\u00e4nnlich,weiblich\nnationalitaet, Nationalit\u00e4t, Schweiz,Ausland\nanzahl_personen, Anzahl Personen, 3873,964,2926\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nZeigen Sie mir die Anzahl der M\u00e4nner und Frauen im Kanton Schwyz in den Jahren 2005, 2010, 2015 und 2020.\n### SQL query\nSELECT\n    T.jahr,\n    SUM(CASE WHEN T.geschlecht = 'm\u00e4nnlich' THEN T.anzahl_personen END) AS anzahl_manner,\n    SUM(CASE WHEN T.geschlecht = 'weiblich' THEN T.anzahl_personen END) AS anzahl_frauen\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2005, 2010, 2015, 2020)\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n\n\n### Question\nWie hoch war die schweizerische und ausl\u00e4ndische Bev\u00f6lkerung in den 3 kleinsten Schwyzer Gemeinden im Jahr 2020?\n### SQL query\nSELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS anzahl_schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS anzahl_auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) ASC\nLIMIT 3;\n\n\n### Question\nWie hoch war die schweizerische und ausl\u00e4ndische Bev\u00f6lkerung in den 3 kleinsten Schwyzer Gemeinden im Jahr 2020?\n### SQL query\nSELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS anzahl_schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS anzahl_auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) ASC\nLIMIT 3;\n\n\n### Question\nWie hoch ist der Prozentsatz der Gemeinden in Schwyz, die im Jahr 2020 mehr als 10000 Einwohner haben?\n### SQL query\nSELECT\n    (\n        100.0 * COUNT(CASE WHEN T1.tot_personen > 10000 THEN 1 END) /\n        COUNT(*)\n    )AS prozent_gemeinden_mehr_als_10000_einwohner_2020\nFROM (\n    SELECT SUM(T.anzahl_personen) as tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2020\n    GROUP BY S.name\n) as T1;\n\n\n### Question\nWie hoch ist der Prozentsatz der Gemeinden in Schwyz, die im Jahr 2020 mehr als 10000 Einwohner haben?\n### SQL query\nSELECT\n    (\n        100.0 * COUNT(CASE WHEN T1.tot_personen > 10000 THEN 1 END) /\n        COUNT(*)\n    )AS prozent_gemeinden_mehr_als_10000_einwohner_2020\nFROM (\n    SELECT SUM(T.anzahl_personen) as tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2020\n    GROUP BY S.name\n) as T1;\n\n\n### Question\nWie hoch ist der Prozentsatz der Gemeinden in Schwyz, die im Jahr 2020 mehr als 10000 Einwohner haben?\n### SQL query\nSELECT\n    (\n        100.0 * COUNT(CASE WHEN T1.tot_personen > 10000 THEN 1 END) /\n        COUNT(*)\n    )AS prozent_gemeinden_mehr_als_10000_einwohner_2020\nFROM (\n    SELECT SUM(T.anzahl_personen) as tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2020\n    GROUP BY S.name\n) as T1;\n\n\n### Question\nWie hoch war die j\u00e4hrliche Wachstumsrate der Bev\u00f6lkerung im Kanton Schwyz in den Jahren 2005-2010?\n### SQL query\nWITH T1 AS (\n    SELECT\n        T.jahr,\n        SUM(T.anzahl_personen) AS tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr >= 2005\n        AND T.jahr <= 2010\n    GROUP BY T.jahr\n    ORDER BY T.jahr ASC\n)\nSELECT\n    T1.jahr,\n    (\n        100.0 *\n        (T1.tot_personen - LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)) /\n        LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)\n    ) AS tot_personen_vorjahr\nFROM T1;\n\n\n### Question\nWie hoch war die schweizerische und ausl\u00e4ndische Bev\u00f6lkerung in den 3 kleinsten Schwyzer Gemeinden im Jahr 2020?\n### SQL query\nSELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS anzahl_schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS anzahl_auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) ASC\nLIMIT 3;\n\n\n### Question\nWie hoch war der Anteil der M\u00e4nner an der schweizerischen und ausl\u00e4ndischen Wohnbev\u00f6lkerung im Kanton Schwyz in den Jahren 2015 bis 2020?\n### SQL query\n",
    "process_time": 12.785785207059234,
    "num_tokens": 2548,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 118,
    "question": "Wie viele Einwohner gab es in Freienbach (SZ) im Zeitraum 2010 - 2020 ?",
    "query": "SELECT T.jahr, SUM(T.anzahl_personen)\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Freienbach', 'Freienbach (SZ)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2020\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n",
    "db_id": "schwyz_standige_wohnbevolkerung_geschlecht_nationalitat",
    "generated_query": "SELECT\n    SUM(T.anzahl_personen) AS anzahl_einwohner_2010_2020\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND S.name IN ('Freienbach', 'Freienbach (SZ)')\n    AND T.jahr >= 2010\n    AND T.jahr <= 2020;",
    "meta_data": [
      {
        "question": "Zeigen Sie mir die Anzahl der M\u00e4nner und Frauen im Kanton Schwyz in den Jahren 2005, 2010, 2015 und 2020.",
        "query": "SELECT\n    T.jahr,\n    SUM(CASE WHEN T.geschlecht = 'm\u00e4nnlich' THEN T.anzahl_personen END) AS anzahl_manner,\n    SUM(CASE WHEN T.geschlecht = 'weiblich' THEN T.anzahl_personen END) AS anzahl_frauen\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2005, 2010, 2015, 2020)\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Wie hoch ist der Prozentsatz der Gemeinden in Schwyz, die im Jahr 2020 mehr als 10000 Einwohner haben?",
        "query": "SELECT\n    (\n        100.0 * COUNT(CASE WHEN T1.tot_personen > 10000 THEN 1 END) /\n        COUNT(*)\n    )AS prozent_gemeinden_mehr_als_10000_einwohner_2020\nFROM (\n    SELECT SUM(T.anzahl_personen) as tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2020\n    GROUP BY S.name\n) as T1;\n"
      },
      {
        "question": "Wie hoch war die schweizerische und ausl\u00e4ndische Bev\u00f6lkerung in den 3 kleinsten Schwyzer Gemeinden im Jahr 2020?",
        "query": "SELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS anzahl_schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS anzahl_auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) ASC\nLIMIT 3;\n"
      },
      {
        "question": "Zeigen Sie mir die Anzahl ausl\u00e4ndischer und schweizerischer Einwohner f\u00fcr die 5 bev\u00f6lkerungsreichsten Gemeinden in Schwyz im Jahr 2015.",
        "query": "SELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) DESC\nLIMIT 5;\n"
      },
      {
        "question": "Wie hoch war die schweizerische und ausl\u00e4ndische Bev\u00f6lkerung in den 3 kleinsten Schwyzer Gemeinden im Jahr 2020?",
        "query": "SELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS anzahl_schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS anzahl_auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) ASC\nLIMIT 3;\n"
      },
      {
        "question": "Wie hoch war die schweizerische und ausl\u00e4ndische Bev\u00f6lkerung in den 3 kleinsten Schwyzer Gemeinden im Jahr 2020?",
        "query": "SELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS anzahl_schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS anzahl_auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) ASC\nLIMIT 3;\n"
      },
      {
        "question": "Zeigen Sie mir die Anzahl ausl\u00e4ndischer und schweizerischer Einwohner f\u00fcr die 5 bev\u00f6lkerungsreichsten Gemeinden in Schwyz im Jahr 2015.",
        "query": "SELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) DESC\nLIMIT 5;\n"
      },
      {
        "question": "Zeigen Sie mir f\u00fcr jedes Jahr im Zeitraum 2018 - 2021 die Anzahl der Schweizer Einwohner in Einsiedeln, SZ.",
        "query": "SELECT T.jahr, SUM(T.anzahl_personen) AS anzahl_schweizer_2021_einsiedeln\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr >= 2018\n    AND T.jahr <= 2021\n    AND S.name IN ('Einsiedeln', 'Einsiedeln (SZ)')\n    AND T.nationalitaet = 'Schweiz'\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.schwyz_standige_wohnbevolkerung_geschlecht_nationalitat (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tgeschlecht TEXT, \n\tnationalitaet TEXT, \n\tanzahl_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT schwyz_standige_wohnbevolkerung_geschlecht_nationalitat_pkey PRIMARY KEY (uid), \n\tCONSTRAINT schwyz_standige_wohnbevolkerung_geschlecht_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in schwyz_standige_wohnbevolkerung_geschlecht_nationalitat and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nanzahl_personen : 1001, 127, 3563, 3014, 88\nspatialunit_uid : 1374_A.ADM3, 1341_A.ADM3, 1347_A.ADM3, 1372_A.ADM3, 1364_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\ngeschlecht, Geschlecht, m\u00e4nnlich,weiblich\nnationalitaet, Nationalit\u00e4t, Schweiz,Ausland\nanzahl_personen, Anzahl Personen, 3873,964,2926\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nZeigen Sie mir die Anzahl der M\u00e4nner und Frauen im Kanton Schwyz in den Jahren 2005, 2010, 2015 und 2020.\n### SQL query\nSELECT\n    T.jahr,\n    SUM(CASE WHEN T.geschlecht = 'm\u00e4nnlich' THEN T.anzahl_personen END) AS anzahl_manner,\n    SUM(CASE WHEN T.geschlecht = 'weiblich' THEN T.anzahl_personen END) AS anzahl_frauen\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2005, 2010, 2015, 2020)\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n\n\n### Question\nWie hoch ist der Prozentsatz der Gemeinden in Schwyz, die im Jahr 2020 mehr als 10000 Einwohner haben?\n### SQL query\nSELECT\n    (\n        100.0 * COUNT(CASE WHEN T1.tot_personen > 10000 THEN 1 END) /\n        COUNT(*)\n    )AS prozent_gemeinden_mehr_als_10000_einwohner_2020\nFROM (\n    SELECT SUM(T.anzahl_personen) as tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2020\n    GROUP BY S.name\n) as T1;\n\n\n### Question\nWie hoch war die schweizerische und ausl\u00e4ndische Bev\u00f6lkerung in den 3 kleinsten Schwyzer Gemeinden im Jahr 2020?\n### SQL query\nSELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS anzahl_schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS anzahl_auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) ASC\nLIMIT 3;\n\n\n### Question\nZeigen Sie mir die Anzahl ausl\u00e4ndischer und schweizerischer Einwohner f\u00fcr die 5 bev\u00f6lkerungsreichsten Gemeinden in Schwyz im Jahr 2015.\n### SQL query\nSELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) DESC\nLIMIT 5;\n\n\n### Question\nWie hoch war die schweizerische und ausl\u00e4ndische Bev\u00f6lkerung in den 3 kleinsten Schwyzer Gemeinden im Jahr 2020?\n### SQL query\nSELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS anzahl_schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS anzahl_auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) ASC\nLIMIT 3;\n\n\n### Question\nWie hoch war die schweizerische und ausl\u00e4ndische Bev\u00f6lkerung in den 3 kleinsten Schwyzer Gemeinden im Jahr 2020?\n### SQL query\nSELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS anzahl_schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS anzahl_auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) ASC\nLIMIT 3;\n\n\n### Question\nZeigen Sie mir die Anzahl ausl\u00e4ndischer und schweizerischer Einwohner f\u00fcr die 5 bev\u00f6lkerungsreichsten Gemeinden in Schwyz im Jahr 2015.\n### SQL query\nSELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) DESC\nLIMIT 5;\n\n\n### Question\nZeigen Sie mir f\u00fcr jedes Jahr im Zeitraum 2018 - 2021 die Anzahl der Schweizer Einwohner in Einsiedeln, SZ.\n### SQL query\nSELECT T.jahr, SUM(T.anzahl_personen) AS anzahl_schweizer_2021_einsiedeln\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr >= 2018\n    AND T.jahr <= 2021\n    AND S.name IN ('Einsiedeln', 'Einsiedeln (SZ)')\n    AND T.nationalitaet = 'Schweiz'\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n\n\n### Question\nWie viele Einwohner gab es in Freienbach (SZ) im Zeitraum 2010 - 2020 ?\n### SQL query\n",
    "process_time": 7.314605365972966,
    "num_tokens": 2502,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 119,
    "question": "Zeigen Sie mir den Anteil der ausl\u00e4ndischen Bev\u00f6lkerung (als Verh\u00e4ltnis) im Kanton Schwyz in jedem Jahr zwischen 2010 und 2020.",
    "query": "SELECT\n    T.jahr,\n    (\n        SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) /\n        SUM(T.anzahl_personen)\n    ) AS anteil_auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr >= 2010\n    AND T.jahr <= 2020\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n",
    "db_id": "schwyz_standige_wohnbevolkerung_geschlecht_nationalitat",
    "generated_query": "WITH T1 AS (\n    SELECT\n        T.jahr,\n        SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS auslander\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr >= 2010\n        AND T.jahr <= 2020\n    GROUP BY T.jahr\n    ORDER BY T.jahr ASC\n), T2 AS (\n    SELECT\n        T1.jahr,\n        T1.auslander,\n        SUM(T2.anzahl_personen) AS gesamt\n    FROM T1\n    JOIN schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T2 ON T1.jahr = T2.jahr\n    JOIN spatial_unit AS S ON T2.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T2.jahr >= 2010\n        AND T2.jahr <= 2020\n    GROUP BY T1.jahr, T1.auslander\n)\nSELECT\n    T2.jahr,\n    (\n        100.0 * T2.auslander / T2.gesamt\n    ) AS auslander_anteil\nFROM T2\nORDER BY T2.jahr ASC;",
    "meta_data": [
      {
        "question": "Wie hoch war die j\u00e4hrliche Wachstumsrate der Bev\u00f6lkerung im Kanton Schwyz in den Jahren 2005-2010?",
        "query": "WITH T1 AS (\n    SELECT\n        T.jahr,\n        SUM(T.anzahl_personen) AS tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr >= 2005\n        AND T.jahr <= 2010\n    GROUP BY T.jahr\n    ORDER BY T.jahr ASC\n)\nSELECT\n    T1.jahr,\n    (\n        100.0 *\n        (T1.tot_personen - LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)) /\n        LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)\n    ) AS tot_personen_vorjahr\nFROM T1;\n"
      },
      {
        "question": "Zeigen Sie mir die Anzahl der M\u00e4nner und Frauen im Kanton Schwyz in den Jahren 2005, 2010, 2015 und 2020.",
        "query": "SELECT\n    T.jahr,\n    SUM(CASE WHEN T.geschlecht = 'm\u00e4nnlich' THEN T.anzahl_personen END) AS anzahl_manner,\n    SUM(CASE WHEN T.geschlecht = 'weiblich' THEN T.anzahl_personen END) AS anzahl_frauen\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2005, 2010, 2015, 2020)\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Wie hoch war die j\u00e4hrliche Wachstumsrate der Bev\u00f6lkerung im Kanton Schwyz in den Jahren 2005-2010?",
        "query": "WITH T1 AS (\n    SELECT\n        T.jahr,\n        SUM(T.anzahl_personen) AS tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr >= 2005\n        AND T.jahr <= 2010\n    GROUP BY T.jahr\n    ORDER BY T.jahr ASC\n)\nSELECT\n    T1.jahr,\n    (\n        100.0 *\n        (T1.tot_personen - LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)) /\n        LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)\n    ) AS tot_personen_vorjahr\nFROM T1;\n"
      },
      {
        "question": "Wie hoch war die schweizerische und ausl\u00e4ndische Bev\u00f6lkerung in den 3 kleinsten Schwyzer Gemeinden im Jahr 2020?",
        "query": "SELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS anzahl_schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS anzahl_auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) ASC\nLIMIT 3;\n"
      },
      {
        "question": "Zeigen Sie mir die Anzahl der M\u00e4nner und Frauen im Kanton Schwyz in den Jahren 2005, 2010, 2015 und 2020.",
        "query": "SELECT\n    T.jahr,\n    SUM(CASE WHEN T.geschlecht = 'm\u00e4nnlich' THEN T.anzahl_personen END) AS anzahl_manner,\n    SUM(CASE WHEN T.geschlecht = 'weiblich' THEN T.anzahl_personen END) AS anzahl_frauen\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2005, 2010, 2015, 2020)\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n"
      },
      {
        "question": "Wie hoch ist der Prozentsatz der Gemeinden in Schwyz, die im Jahr 2020 mehr als 10000 Einwohner haben?",
        "query": "SELECT\n    (\n        100.0 * COUNT(CASE WHEN T1.tot_personen > 10000 THEN 1 END) /\n        COUNT(*)\n    )AS prozent_gemeinden_mehr_als_10000_einwohner_2020\nFROM (\n    SELECT SUM(T.anzahl_personen) as tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2020\n    GROUP BY S.name\n) as T1;\n"
      },
      {
        "question": "Welche 5 Gemeinden im Kanton Schwyz hatten 2010 das h\u00f6chste Verh\u00e4ltnis zwischen M\u00e4nnern und Frauen? Geben Sie auch das Verh\u00e4ltnis an.",
        "query": "SELECT\n    S.name,\n    (\n        SUM(CASE WHEN T.geschlecht = 'm\u00e4nnlich' THEN T.anzahl_personen ELSE 0 END) /\n        SUM(CASE WHEN T.geschlecht = 'weiblich' THEN T.anzahl_personen ELSE 0 END)\n    ) AS weiblich_mannlich_verhaltnis_2010\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2010\nGROUP BY S.name\nORDER BY weiblich_mannlich_verhaltnis_2010 DESC\nLIMIT 5;\n"
      },
      {
        "question": "Zeigen Sie mir die Anzahl ausl\u00e4ndischer und schweizerischer Einwohner f\u00fcr die 5 bev\u00f6lkerungsreichsten Gemeinden in Schwyz im Jahr 2015.",
        "query": "SELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) DESC\nLIMIT 5;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.schwyz_standige_wohnbevolkerung_geschlecht_nationalitat (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tgeschlecht TEXT, \n\tnationalitaet TEXT, \n\tanzahl_personen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT schwyz_standige_wohnbevolkerung_geschlecht_nationalitat_pkey PRIMARY KEY (uid), \n\tCONSTRAINT schwyz_standige_wohnbevolkerung_geschlecht_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in schwyz_standige_wohnbevolkerung_geschlecht_nationalitat and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nanzahl_personen : 1001, 127, 3563, 3014, 88\nspatialunit_uid : 1374_A.ADM3, 1341_A.ADM3, 1347_A.ADM3, 1372_A.ADM3, 1364_A.ADM3\n*/\n\n/*\nColumn name, Column discription, Example values\ngeschlecht, Geschlecht, m\u00e4nnlich,weiblich\nnationalitaet, Nationalit\u00e4t, Schweiz,Ausland\nanzahl_personen, Anzahl Personen, 3873,964,2926\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWie hoch war die j\u00e4hrliche Wachstumsrate der Bev\u00f6lkerung im Kanton Schwyz in den Jahren 2005-2010?\n### SQL query\nWITH T1 AS (\n    SELECT\n        T.jahr,\n        SUM(T.anzahl_personen) AS tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr >= 2005\n        AND T.jahr <= 2010\n    GROUP BY T.jahr\n    ORDER BY T.jahr ASC\n)\nSELECT\n    T1.jahr,\n    (\n        100.0 *\n        (T1.tot_personen - LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)) /\n        LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)\n    ) AS tot_personen_vorjahr\nFROM T1;\n\n\n### Question\nZeigen Sie mir die Anzahl der M\u00e4nner und Frauen im Kanton Schwyz in den Jahren 2005, 2010, 2015 und 2020.\n### SQL query\nSELECT\n    T.jahr,\n    SUM(CASE WHEN T.geschlecht = 'm\u00e4nnlich' THEN T.anzahl_personen END) AS anzahl_manner,\n    SUM(CASE WHEN T.geschlecht = 'weiblich' THEN T.anzahl_personen END) AS anzahl_frauen\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2005, 2010, 2015, 2020)\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n\n\n### Question\nWie hoch war die j\u00e4hrliche Wachstumsrate der Bev\u00f6lkerung im Kanton Schwyz in den Jahren 2005-2010?\n### SQL query\nWITH T1 AS (\n    SELECT\n        T.jahr,\n        SUM(T.anzahl_personen) AS tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr >= 2005\n        AND T.jahr <= 2010\n    GROUP BY T.jahr\n    ORDER BY T.jahr ASC\n)\nSELECT\n    T1.jahr,\n    (\n        100.0 *\n        (T1.tot_personen - LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)) /\n        LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)\n    ) AS tot_personen_vorjahr\nFROM T1;\n\n\n### Question\nWie hoch war die schweizerische und ausl\u00e4ndische Bev\u00f6lkerung in den 3 kleinsten Schwyzer Gemeinden im Jahr 2020?\n### SQL query\nSELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS anzahl_schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS anzahl_auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2020\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) ASC\nLIMIT 3;\n\n\n### Question\nZeigen Sie mir die Anzahl der M\u00e4nner und Frauen im Kanton Schwyz in den Jahren 2005, 2010, 2015 und 2020.\n### SQL query\nSELECT\n    T.jahr,\n    SUM(CASE WHEN T.geschlecht = 'm\u00e4nnlich' THEN T.anzahl_personen END) AS anzahl_manner,\n    SUM(CASE WHEN T.geschlecht = 'weiblich' THEN T.anzahl_personen END) AS anzahl_frauen\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr IN (2005, 2010, 2015, 2020)\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n\n\n### Question\nWie hoch ist der Prozentsatz der Gemeinden in Schwyz, die im Jahr 2020 mehr als 10000 Einwohner haben?\n### SQL query\nSELECT\n    (\n        100.0 * COUNT(CASE WHEN T1.tot_personen > 10000 THEN 1 END) /\n        COUNT(*)\n    )AS prozent_gemeinden_mehr_als_10000_einwohner_2020\nFROM (\n    SELECT SUM(T.anzahl_personen) as tot_personen\n    FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\n    JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\n    WHERE S.municipal = 'TRUE'\n        AND T.jahr = 2020\n    GROUP BY S.name\n) as T1;\n\n\n### Question\nWelche 5 Gemeinden im Kanton Schwyz hatten 2010 das h\u00f6chste Verh\u00e4ltnis zwischen M\u00e4nnern und Frauen? Geben Sie auch das Verh\u00e4ltnis an.\n### SQL query\nSELECT\n    S.name,\n    (\n        SUM(CASE WHEN T.geschlecht = 'm\u00e4nnlich' THEN T.anzahl_personen ELSE 0 END) /\n        SUM(CASE WHEN T.geschlecht = 'weiblich' THEN T.anzahl_personen ELSE 0 END)\n    ) AS weiblich_mannlich_verhaltnis_2010\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2010\nGROUP BY S.name\nORDER BY weiblich_mannlich_verhaltnis_2010 DESC\nLIMIT 5;\n\n\n### Question\nZeigen Sie mir die Anzahl ausl\u00e4ndischer und schweizerischer Einwohner f\u00fcr die 5 bev\u00f6lkerungsreichsten Gemeinden in Schwyz im Jahr 2015.\n### SQL query\nSELECT\n    S.name,\n    SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS schweizer,\n    SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS auslander\nFROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.municipal = 'TRUE'\n    AND T.jahr = 2015\nGROUP BY S.name\nORDER BY SUM(T.anzahl_personen) DESC\nLIMIT 5;\n\n\n### Question\nZeigen Sie mir den Anteil der ausl\u00e4ndischen Bev\u00f6lkerung (als Verh\u00e4ltnis) im Kanton Schwyz in jedem Jahr zwischen 2010 und 2020.\n### SQL query\n",
    "process_time": 19.12269423995167,
    "num_tokens": 2623,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 120,
    "question": "Bei der Umwandlung durch Kernkraftwerke, welche Energietr\u00e4ger sind da mit welchen Mengen durchschnittlich im Spiel?",
    "query": "SELECT\n    energietraeger,\n    AVG(energiemenge_in_tera_joule) as durchschnittliche_umwandlung_kernkraft_in_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%umwandlung%'\nAND LOWER(nutzungs_sektor) LIKE '%kernkraftwerk%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY energietraeger\nORDER BY durchschnittliche_umwandlung_kernkraft_in_tj ASC;\n",
    "db_id": "energiebilanz_schweiz_in_tera_joule",
    "generated_query": "SELECT energietraeger, AVG(energiemenge_in_tera_joule) as durchschnittliche_menge\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%kernkraftwerke%'\nAND energiemenge_in_tera_joule IS NOT NULL\nGROUP BY energietraeger;",
    "meta_data": [
      {
        "question": "Gibt es Energietr\u00e4ger der niemals exportiert wurden?",
        "query": "SELECT energietraeger\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%export%'\nGROUP BY energietraeger\nHAVING SUM(energiemenge_in_tera_joule) IS NULL OR SUM(energiemenge_in_tera_joule) = 0;\n"
      },
      {
        "question": "Gibt es Energietr\u00e4ger der niemals importiert wurden?",
        "query": "SELECT energietraeger\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%import%'\nGROUP BY energietraeger\nHAVING SUM(energiemenge_in_tera_joule) IS NULL OR SUM(energiemenge_in_tera_joule) = 0;\n"
      },
      {
        "question": "Welches waren die f\u00fcnf am meisten importierten Energietraeger 2020 in der Schweiz und wieviel wurde importiert?",
        "query": "SELECT nutzungs_sektor, energietraeger, SUM(energiemenge_in_tera_joule) as tj_import_2020\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(nutzungs_sektor) LIKE '%import%'\nAND energiemenge_in_tera_joule IS NOT NULL\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY tj_import_2020 DESC;\n"
      },
      {
        "question": "Welche nutzungssektoren hatten 2020 mit Erneuerbarer Energie zu tun und wenn ja in welchem Umfang?",
        "query": "SELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as anteil_erneuerbare_energien_2020_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(energietraeger) LIKE '%erneuerbar%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY anteil_erneuerbare_energien_2020_tj DESC;\n"
      },
      {
        "question": "Gibt es Energietr\u00e4ger der niemals exportiert wurden?",
        "query": "SELECT energietraeger\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%export%'\nGROUP BY energietraeger\nHAVING SUM(energiemenge_in_tera_joule) IS NULL OR SUM(energiemenge_in_tera_joule) = 0;\n"
      },
      {
        "question": "Welche nutzungssektoren hatten 2020 mit Erneuerbarer Energie zu tun und wenn ja in welchem Umfang?",
        "query": "SELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as anteil_erneuerbare_energien_2020_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(energietraeger) LIKE '%erneuerbar%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY anteil_erneuerbare_energien_2020_tj DESC;\n"
      },
      {
        "question": "Welches waren die f\u00fcnf am meisten importierten Energietraeger 2020 in der Schweiz und wieviel wurde importiert?",
        "query": "SELECT nutzungs_sektor, energietraeger, SUM(energiemenge_in_tera_joule) as tj_import_2020\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(nutzungs_sektor) LIKE '%import%'\nAND energiemenge_in_tera_joule IS NOT NULL\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY tj_import_2020 DESC;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.energiebilanz_schweiz_in_tera_joule (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tnutzungs_sektor TEXT, \n\tenergietraeger TEXT, \n\tenergiemenge_in_tera_joule NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT energiebilanz_schweiz_in_tera_joule_pkey PRIMARY KEY (uid), \n\tCONSTRAINT energiebilanz_schweiz_in_tera_joule_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in energiebilanz_schweiz_in_tera_joule and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nnutzungs_sektor : Energieumwandlung - Kernkraftwerke, Eigenverbrauch des Energiesektors, Netzverluste, Verbrauch der Speicherungen, Energieumwandlung - Wasserkraftwerke, Endverbrauch - Verkehr, Export\nenergietraeger : M\u00fcll und Industrieabf\u00e4lle, Roh\u00f6l, Gas, Kernbrennstoffe, Holzenergie\nenergiemenge_in_tera_joule : 26280, -2270, 36270, -6780, -7800\n*/\n\n/*\nColumn name, Column discription, Example values\nenergietraeger, Energietr\u00e4ger, Elektrizit\u00e4t,Wasserkraft,Uebrige erneuerbare Energien,M\u00fcll und Industrieabf\u00e4lle\nnutzungs_sektor, Nutzungs Rubrik, Endverbrauch - Haushalte,Endverbrauch - Industrie,Import\nenergiemenge_in_tera_joule, Numeric value in Terajoule, NA,14820,4820\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nGibt es Energietr\u00e4ger der niemals exportiert wurden?\n### SQL query\nSELECT energietraeger\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%export%'\nGROUP BY energietraeger\nHAVING SUM(energiemenge_in_tera_joule) IS NULL OR SUM(energiemenge_in_tera_joule) = 0;\n\n\n### Question\nGibt es Energietr\u00e4ger der niemals importiert wurden?\n### SQL query\nSELECT energietraeger\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%import%'\nGROUP BY energietraeger\nHAVING SUM(energiemenge_in_tera_joule) IS NULL OR SUM(energiemenge_in_tera_joule) = 0;\n\n\n### Question\nWelches waren die f\u00fcnf am meisten importierten Energietraeger 2020 in der Schweiz und wieviel wurde importiert?\n### SQL query\nSELECT nutzungs_sektor, energietraeger, SUM(energiemenge_in_tera_joule) as tj_import_2020\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(nutzungs_sektor) LIKE '%import%'\nAND energiemenge_in_tera_joule IS NOT NULL\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY tj_import_2020 DESC;\n\n\n### Question\nWelche nutzungssektoren hatten 2020 mit Erneuerbarer Energie zu tun und wenn ja in welchem Umfang?\n### SQL query\nSELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as anteil_erneuerbare_energien_2020_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(energietraeger) LIKE '%erneuerbar%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY anteil_erneuerbare_energien_2020_tj DESC;\n\n\n### Question\nGibt es Energietr\u00e4ger der niemals exportiert wurden?\n### SQL query\nSELECT energietraeger\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%export%'\nGROUP BY energietraeger\nHAVING SUM(energiemenge_in_tera_joule) IS NULL OR SUM(energiemenge_in_tera_joule) = 0;\n\n\n### Question\nWelche nutzungssektoren hatten 2020 mit Erneuerbarer Energie zu tun und wenn ja in welchem Umfang?\n### SQL query\nSELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as anteil_erneuerbare_energien_2020_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(energietraeger) LIKE '%erneuerbar%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY anteil_erneuerbare_energien_2020_tj DESC;\n\n\n### Question\nWelches waren die f\u00fcnf am meisten importierten Energietraeger 2020 in der Schweiz und wieviel wurde importiert?\n### SQL query\nSELECT nutzungs_sektor, energietraeger, SUM(energiemenge_in_tera_joule) as tj_import_2020\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(nutzungs_sektor) LIKE '%import%'\nAND energiemenge_in_tera_joule IS NOT NULL\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY tj_import_2020 DESC;\n\n\n### Question\nBei der Umwandlung durch Kernkraftwerke, welche Energietr\u00e4ger sind da mit welchen Mengen durchschnittlich im Spiel?\n### SQL query\n",
    "process_time": 6.162442724918947,
    "num_tokens": 2016,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 121,
    "question": "Welches war der am meisten exportierten Energietraeger 2020 in der Schweiz und wieviel wurde exportiert?",
    "query": "SELECT nutzungs_sektor, energietraeger, SUM(energiemenge_in_tera_joule) as tj_export_2020\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(nutzungs_sektor) LIKE '%export%'\nAND energiemenge_in_tera_joule IS NOT NULL\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY tj_export_2020 DESC;\n",
    "db_id": "energiebilanz_schweiz_in_tera_joule",
    "generated_query": "SELECT nutzungs_sektor, energietraeger, SUM(energiemenge_in_tera_joule) as tj_export_2020\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(nutzungs_sektor) LIKE '%export%'\nAND energiemenge_in_tera_joule IS NOT NULL\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY tj_export_2020 DESC;",
    "meta_data": [
      {
        "question": "Welche Energietr\u00e4ger kamen 2019 bei Energieumwandlung vor und in welchem Umfang? .",
        "query": "SELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as energie_umwandlung_2019_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%umwandlung%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nAND jahr = 2019\nGROUP BY nutzungs_sektor\nORDER BY energie_umwandlung_2019_tj ASC;\n"
      },
      {
        "question": "Welches waren die f\u00fcnf am meisten importierten Energietraeger 2020 in der Schweiz und wieviel wurde importiert?",
        "query": "SELECT nutzungs_sektor, energietraeger, SUM(energiemenge_in_tera_joule) as tj_import_2020\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(nutzungs_sektor) LIKE '%import%'\nAND energiemenge_in_tera_joule IS NOT NULL\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY tj_import_2020 DESC;\n"
      },
      {
        "question": "Hat sich der Import Mix \u00fcber die Jahre ve\u00e4ndert? Welche Energietr\u00e4ger wurde jeweils am meisten importiert? Zeige auch die Importmenge.",
        "query": "WITH RankedImports AS (\n    SELECT\n        energietraeger,\n        jahr,\n        energiemenge_in_tera_joule,\n        RANK() OVER (PARTITION BY jahr ORDER BY energiemenge_in_tera_joule DESC) AS rank\n    FROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%import%'\n      AND energiemenge_in_tera_joule IS NOT NULL\n      AND energiemenge_in_tera_joule != 0\n)\nSELECT\n    energietraeger,\n    jahr,\n    energiemenge_in_tera_joule as max_import\nFROM RankedImports WHERE rank = 1\nORDER BY jahr DESC;\n"
      },
      {
        "question": "Welche Energietr\u00e4ger kamen 2019 bei Energieumwandlung vor und in welchem Umfang? .",
        "query": "SELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as energie_umwandlung_2019_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%umwandlung%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nAND jahr = 2019\nGROUP BY nutzungs_sektor\nORDER BY energie_umwandlung_2019_tj ASC;\n"
      },
      {
        "question": "In 2020 welche Endverbrauchs Sektoren haben Kohle als Energietr\u00e4ger benutzt und in welchem Umfang? .",
        "query": "SELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as energieverbrauch_in_kohle_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(nutzungs_sektor) LIKE '%verbrauch%'\nAND LOWER(energietraeger) LIKE '%kohle%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY nutzungs_sektor\nORDER BY energieverbrauch_in_kohle_tj DESC;\n"
      },
      {
        "question": "Welche nutzungssektoren hatten 2020 mit Erneuerbarer Energie zu tun und wenn ja in welchem Umfang?",
        "query": "SELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as anteil_erneuerbare_energien_2020_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(energietraeger) LIKE '%erneuerbar%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY anteil_erneuerbare_energien_2020_tj DESC;\n"
      },
      {
        "question": "Welche nutzungssektoren hatten 2020 mit Erneuerbarer Energie zu tun und wenn ja in welchem Umfang?",
        "query": "SELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as anteil_erneuerbare_energien_2020_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(energietraeger) LIKE '%erneuerbar%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY anteil_erneuerbare_energien_2020_tj DESC;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.energiebilanz_schweiz_in_tera_joule (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tnutzungs_sektor TEXT, \n\tenergietraeger TEXT, \n\tenergiemenge_in_tera_joule NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT energiebilanz_schweiz_in_tera_joule_pkey PRIMARY KEY (uid), \n\tCONSTRAINT energiebilanz_schweiz_in_tera_joule_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in energiebilanz_schweiz_in_tera_joule and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nnutzungs_sektor : Energieumwandlung - Kernkraftwerke, Eigenverbrauch des Energiesektors, Netzverluste, Verbrauch der Speicherungen, Energieumwandlung - Wasserkraftwerke, Endverbrauch - Verkehr, Export\nenergietraeger : M\u00fcll und Industrieabf\u00e4lle, Roh\u00f6l, Gas, Kernbrennstoffe, Holzenergie\nenergiemenge_in_tera_joule : 26280, -2270, 36270, -6780, -7800\n*/\n\n/*\nColumn name, Column discription, Example values\nenergietraeger, Energietr\u00e4ger, Elektrizit\u00e4t,Wasserkraft,Uebrige erneuerbare Energien,M\u00fcll und Industrieabf\u00e4lle\nnutzungs_sektor, Nutzungs Rubrik, Endverbrauch - Haushalte,Endverbrauch - Industrie,Import\nenergiemenge_in_tera_joule, Numeric value in Terajoule, NA,14820,4820\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWelche Energietr\u00e4ger kamen 2019 bei Energieumwandlung vor und in welchem Umfang? .\n### SQL query\nSELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as energie_umwandlung_2019_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%umwandlung%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nAND jahr = 2019\nGROUP BY nutzungs_sektor\nORDER BY energie_umwandlung_2019_tj ASC;\n\n\n### Question\nWelches waren die f\u00fcnf am meisten importierten Energietraeger 2020 in der Schweiz und wieviel wurde importiert?\n### SQL query\nSELECT nutzungs_sektor, energietraeger, SUM(energiemenge_in_tera_joule) as tj_import_2020\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(nutzungs_sektor) LIKE '%import%'\nAND energiemenge_in_tera_joule IS NOT NULL\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY tj_import_2020 DESC;\n\n\n### Question\nHat sich der Import Mix \u00fcber die Jahre ve\u00e4ndert? Welche Energietr\u00e4ger wurde jeweils am meisten importiert? Zeige auch die Importmenge.\n### SQL query\nWITH RankedImports AS (\n    SELECT\n        energietraeger,\n        jahr,\n        energiemenge_in_tera_joule,\n        RANK() OVER (PARTITION BY jahr ORDER BY energiemenge_in_tera_joule DESC) AS rank\n    FROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%import%'\n      AND energiemenge_in_tera_joule IS NOT NULL\n      AND energiemenge_in_tera_joule != 0\n)\nSELECT\n    energietraeger,\n    jahr,\n    energiemenge_in_tera_joule as max_import\nFROM RankedImports WHERE rank = 1\nORDER BY jahr DESC;\n\n\n### Question\nWelche Energietr\u00e4ger kamen 2019 bei Energieumwandlung vor und in welchem Umfang? .\n### SQL query\nSELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as energie_umwandlung_2019_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%umwandlung%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nAND jahr = 2019\nGROUP BY nutzungs_sektor\nORDER BY energie_umwandlung_2019_tj ASC;\n\n\n### Question\nIn 2020 welche Endverbrauchs Sektoren haben Kohle als Energietr\u00e4ger benutzt und in welchem Umfang? .\n### SQL query\nSELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as energieverbrauch_in_kohle_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(nutzungs_sektor) LIKE '%verbrauch%'\nAND LOWER(energietraeger) LIKE '%kohle%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY nutzungs_sektor\nORDER BY energieverbrauch_in_kohle_tj DESC;\n\n\n### Question\nWelche nutzungssektoren hatten 2020 mit Erneuerbarer Energie zu tun und wenn ja in welchem Umfang?\n### SQL query\nSELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as anteil_erneuerbare_energien_2020_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(energietraeger) LIKE '%erneuerbar%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY anteil_erneuerbare_energien_2020_tj DESC;\n\n\n### Question\nWelche nutzungssektoren hatten 2020 mit Erneuerbarer Energie zu tun und wenn ja in welchem Umfang?\n### SQL query\nSELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as anteil_erneuerbare_energien_2020_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(energietraeger) LIKE '%erneuerbar%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY anteil_erneuerbare_energien_2020_tj DESC;\n\n\n### Question\nWelches war der am meisten exportierten Energietraeger 2020 in der Schweiz und wieviel wurde exportiert?\n### SQL query\n",
    "process_time": 7.046446959022433,
    "num_tokens": 2255,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 122,
    "question": "In 2020 auf welche Energietr\u00e4ger hat sich der Verbrauch von Haushalten gest\u00fctzt? Gib die Energietr\u00e4ger und Energiemengen an.",
    "query": "SELECT energietraeger, SUM(energiemenge_in_tera_joule) as energieverbrauch_in_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(nutzungs_sektor) LIKE '%verbrauch%haushalt%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY energieverbrauch_in_tj DESC;\n",
    "db_id": "energiebilanz_schweiz_in_tera_joule",
    "generated_query": "SELECT energietraeger, SUM(energiemenge_in_tera_joule) as energieverbrauch_haushalte_2020_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(nutzungs_sektor) LIKE '%haushalte%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY energietraeger\nORDER BY energieverbrauch_haushalte_2020_tj DESC;",
    "meta_data": [
      {
        "question": "Welche nutzungssektoren hatten 2020 mit Erneuerbarer Energie zu tun und wenn ja in welchem Umfang?",
        "query": "SELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as anteil_erneuerbare_energien_2020_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(energietraeger) LIKE '%erneuerbar%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY anteil_erneuerbare_energien_2020_tj DESC;\n"
      },
      {
        "question": "Welche Energietr\u00e4ger kamen 2019 bei Energieumwandlung vor und in welchem Umfang? .",
        "query": "SELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as energie_umwandlung_2019_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%umwandlung%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nAND jahr = 2019\nGROUP BY nutzungs_sektor\nORDER BY energie_umwandlung_2019_tj ASC;\n"
      },
      {
        "question": "Hat sich der Import Mix \u00fcber die Jahre ve\u00e4ndert? Welche Energietr\u00e4ger wurde jeweils am meisten importiert? Zeige auch die Importmenge.",
        "query": "WITH RankedImports AS (\n    SELECT\n        energietraeger,\n        jahr,\n        energiemenge_in_tera_joule,\n        RANK() OVER (PARTITION BY jahr ORDER BY energiemenge_in_tera_joule DESC) AS rank\n    FROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%import%'\n      AND energiemenge_in_tera_joule IS NOT NULL\n      AND energiemenge_in_tera_joule != 0\n)\nSELECT\n    energietraeger,\n    jahr,\n    energiemenge_in_tera_joule as max_import\nFROM RankedImports WHERE rank = 1\nORDER BY jahr DESC;\n"
      },
      {
        "question": "Welche nutzungssektoren hatten 2020 mit Erneuerbarer Energie zu tun und wenn ja in welchem Umfang?",
        "query": "SELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as anteil_erneuerbare_energien_2020_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(energietraeger) LIKE '%erneuerbar%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY anteil_erneuerbare_energien_2020_tj DESC;\n"
      },
      {
        "question": "Welche Energietr\u00e4ger kamen 2019 bei Energieumwandlung vor und in welchem Umfang? .",
        "query": "SELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as energie_umwandlung_2019_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%umwandlung%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nAND jahr = 2019\nGROUP BY nutzungs_sektor\nORDER BY energie_umwandlung_2019_tj ASC;\n"
      },
      {
        "question": "In 2020 welche Endverbrauchs Sektoren haben Kohle als Energietr\u00e4ger benutzt und in welchem Umfang? .",
        "query": "SELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as energieverbrauch_in_kohle_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(nutzungs_sektor) LIKE '%verbrauch%'\nAND LOWER(energietraeger) LIKE '%kohle%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY nutzungs_sektor\nORDER BY energieverbrauch_in_kohle_tj DESC;\n"
      },
      {
        "question": "Gibt es Energietr\u00e4ger der niemals exportiert wurden?",
        "query": "SELECT energietraeger\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%export%'\nGROUP BY energietraeger\nHAVING SUM(energiemenge_in_tera_joule) IS NULL OR SUM(energiemenge_in_tera_joule) = 0;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.energiebilanz_schweiz_in_tera_joule (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tnutzungs_sektor TEXT, \n\tenergietraeger TEXT, \n\tenergiemenge_in_tera_joule NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT energiebilanz_schweiz_in_tera_joule_pkey PRIMARY KEY (uid), \n\tCONSTRAINT energiebilanz_schweiz_in_tera_joule_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in energiebilanz_schweiz_in_tera_joule and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nnutzungs_sektor : Energieumwandlung - Kernkraftwerke, Eigenverbrauch des Energiesektors, Netzverluste, Verbrauch der Speicherungen, Energieumwandlung - Wasserkraftwerke, Endverbrauch - Verkehr, Export\nenergietraeger : M\u00fcll und Industrieabf\u00e4lle, Roh\u00f6l, Gas, Kernbrennstoffe, Holzenergie\nenergiemenge_in_tera_joule : 26280, -2270, 36270, -6780, -7800\n*/\n\n/*\nColumn name, Column discription, Example values\nenergietraeger, Energietr\u00e4ger, Elektrizit\u00e4t,Wasserkraft,Uebrige erneuerbare Energien,M\u00fcll und Industrieabf\u00e4lle\nnutzungs_sektor, Nutzungs Rubrik, Endverbrauch - Haushalte,Endverbrauch - Industrie,Import\nenergiemenge_in_tera_joule, Numeric value in Terajoule, NA,14820,4820\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWelche nutzungssektoren hatten 2020 mit Erneuerbarer Energie zu tun und wenn ja in welchem Umfang?\n### SQL query\nSELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as anteil_erneuerbare_energien_2020_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(energietraeger) LIKE '%erneuerbar%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY anteil_erneuerbare_energien_2020_tj DESC;\n\n\n### Question\nWelche Energietr\u00e4ger kamen 2019 bei Energieumwandlung vor und in welchem Umfang? .\n### SQL query\nSELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as energie_umwandlung_2019_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%umwandlung%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nAND jahr = 2019\nGROUP BY nutzungs_sektor\nORDER BY energie_umwandlung_2019_tj ASC;\n\n\n### Question\nHat sich der Import Mix \u00fcber die Jahre ve\u00e4ndert? Welche Energietr\u00e4ger wurde jeweils am meisten importiert? Zeige auch die Importmenge.\n### SQL query\nWITH RankedImports AS (\n    SELECT\n        energietraeger,\n        jahr,\n        energiemenge_in_tera_joule,\n        RANK() OVER (PARTITION BY jahr ORDER BY energiemenge_in_tera_joule DESC) AS rank\n    FROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%import%'\n      AND energiemenge_in_tera_joule IS NOT NULL\n      AND energiemenge_in_tera_joule != 0\n)\nSELECT\n    energietraeger,\n    jahr,\n    energiemenge_in_tera_joule as max_import\nFROM RankedImports WHERE rank = 1\nORDER BY jahr DESC;\n\n\n### Question\nWelche nutzungssektoren hatten 2020 mit Erneuerbarer Energie zu tun und wenn ja in welchem Umfang?\n### SQL query\nSELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as anteil_erneuerbare_energien_2020_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(energietraeger) LIKE '%erneuerbar%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY energietraeger, nutzungs_sektor\nORDER BY anteil_erneuerbare_energien_2020_tj DESC;\n\n\n### Question\nWelche Energietr\u00e4ger kamen 2019 bei Energieumwandlung vor und in welchem Umfang? .\n### SQL query\nSELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as energie_umwandlung_2019_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%umwandlung%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nAND jahr = 2019\nGROUP BY nutzungs_sektor\nORDER BY energie_umwandlung_2019_tj ASC;\n\n\n### Question\nIn 2020 welche Endverbrauchs Sektoren haben Kohle als Energietr\u00e4ger benutzt und in welchem Umfang? .\n### SQL query\nSELECT nutzungs_sektor, SUM(energiemenge_in_tera_joule) as energieverbrauch_in_kohle_tj\nFROM energiebilanz_schweiz_in_tera_joule WHERE jahr = '2020'\nAND LOWER(nutzungs_sektor) LIKE '%verbrauch%'\nAND LOWER(energietraeger) LIKE '%kohle%'\nAND energiemenge_in_tera_joule IS NOT NULL\nAND energiemenge_in_tera_joule != 0\nGROUP BY nutzungs_sektor\nORDER BY energieverbrauch_in_kohle_tj DESC;\n\n\n### Question\nGibt es Energietr\u00e4ger der niemals exportiert wurden?\n### SQL query\nSELECT energietraeger\nFROM energiebilanz_schweiz_in_tera_joule WHERE LOWER(nutzungs_sektor) LIKE '%export%'\nGROUP BY energietraeger\nHAVING SUM(energiemenge_in_tera_joule) IS NULL OR SUM(energiemenge_in_tera_joule) = 0;\n\n\n### Question\nIn 2020 auf welche Energietr\u00e4ger hat sich der Verbrauch von Haushalten gest\u00fctzt? Gib die Energietr\u00e4ger und Energiemengen an.\n### SQL query\n",
    "process_time": 12.598879322875291,
    "num_tokens": 2228,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 123,
    "question": "Welche Rentenarten gibt es in der Schweiz und was sind die durchschnittliche Ausgaben daf\u00fcr pro Jahr?",
    "query": "SELECT rententyp,\n  (AVG(rentensumme_in_tausend_franken) * 1000) as durchschnittliche_ausgaben_pro_jahr_chf\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND geschlecht = 'Geschlecht - Total'\nGROUP BY rententyp\nORDER BY durchschnittliche_ausgaben_pro_jahr_chf DESC;\n",
    "db_id": "ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit",
    "generated_query": "SELECT rententyp, AVG(rentensumme_in_tausend_franken) as durchschnittliche_ausgaben_pro_jahr\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nGROUP BY rententyp;",
    "meta_data": [
      {
        "question": "Wieviel Prozent der Rentenausgaben floss 2015 an Schweizer, die im Ausland leben und wieviel waren ?",
        "query": "SELECT\n  ROUND((SUM(CASE WHEN jahr = 2015\n       AND staatsangehorigkeit_kategorie = 'Schweiz' AND wohnsitzstaat_kategorie = 'Ausland'\n       THEN rentensumme_in_tausend_franken ELSE 0 END) /\n   SUM(CASE WHEN jahr = 2015 AND staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n       AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n       THEN rentensumme_in_tausend_franken ELSE 0 END)) * 100, 2) AS prozent_rentenausgaben_fur_schweizer_im_ausland\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE jahr = 2015\n  AND geschlecht = 'Geschlecht - Total';\n"
      },
      {
        "question": "Wie entwickelten sich die Differenz der durchschnittliche Altersrente und der Anzahl der Renten f\u00fcr Frauen und M\u00e4nnern \u00fcber die Jahre?",
        "query": "SELECT T1.jahr,\n  (T1.renten_mittelwert_in_franken - T2.renten_mittelwert_in_franken) AS differenz_durchschnittliche_altersrente_frauen_maenner,\n  (T1.anzahl_renten - T2.anzahl_renten) AS differenz_anzahl_altersrenten_frauen_maenner\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.jahr = T2.jahr\nWHERE T1.geschlecht = 'Frau'\n  AND T2.geschlecht = 'Mann'\n  AND T1.rententyp = 'Altersrente' AND T2.rententyp = 'Altersrente'\n  AND T1.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T2.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T1.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total';\n"
      },
      {
        "question": "Was war die h\u00e4ufigste Rentenart 2022 in der Schweiz?",
        "query": "SELECT rententyp as haufigste_rentenart_2022_schweiz\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '2022'\nORDER BY anzahl_renten DESC LIMIT 1;\n"
      },
      {
        "question": "Was war die h\u00e4ufigste Rentenart 2022 in der Schweiz?",
        "query": "SELECT rententyp as haufigste_rentenart_2022_schweiz\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '2022'\nORDER BY anzahl_renten DESC LIMIT 1;\n"
      },
      {
        "question": "Welcher Rententyp wird von Ausl\u00e4ndern, die im Ausland leben, am h\u00e4ufigsten bezogen und wieviele Renten sind es?",
        "query": "SELECT rententyp as haufigster_rententy_fur_auslaender_im_ausland,\n  MAX(anzahl_renten) as anzahl_renten_auslaender_im_ausland\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE staatsangehorigkeit_kategorie = 'Ausland'\n  AND wohnsitzstaat_kategorie = 'Ausland'\n  AND geschlecht = 'Geschlecht - Total'\nGROUP BY rententyp\nORDER BY anzahl_renten_auslaender_im_ausland DESC LIMIT 1;\n"
      },
      {
        "question": "Gab es Rentenarten bei der der Anteil der an im Ausland lebenden ausl\u00e4ndischer Staatsangeh\u00f6riger im Jahr 2022 h\u00f6her war als der der Anteil der im Inland lebenden Schweizer Staatsange\u00f6rigen: was waren die Zahlen?",
        "query": "SELECT T1.rententyp,\n  SUM(T1.anzahl_renten) AS anzahl_renten_auslaender_im_ausland_2022,\n  SUM(T2.anzahl_renten) AS anzahl_renten_schweizer_im_inland_2022\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.rententyp = T2.rententyp\nWHERE T1.jahr = 2022 and T2.jahr = 2022\n  AND T1.staatsangehorigkeit_kategorie = 'Ausland' AND T1.wohnsitzstaat_kategorie = 'Ausland'\n  AND T2.staatsangehorigkeit_kategorie = 'Schweiz' AND T2.wohnsitzstaat_kategorie = 'Schweiz'\n  AND T2.geschlecht = 'Geschlecht - Total' AND T1.geschlecht = 'Geschlecht - Total'\n  AND T1.anzahl_renten > T2.anzahl_renten\nGROUP BY T1.rententyp;\n"
      },
      {
        "question": "F\u00fcr welche Rentenarten ist die durchschnittlich Rente zwischen 2001 und 2022 heruntergegangen und wenn ja um wieviele CHF?",
        "query": "SELECT T1.rententyp,\n  (AVG(T2.renten_mittelwert_in_franken) - AVG(T1.renten_mittelwert_in_franken)) as rentenabzug_2022_genueber_2001_CHF\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.rententyp = T2.rententyp\nWHERE T1.jahr = 2001 AND T2.jahr = 2022\n  AND T1.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total' AND T1.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total' AND T2.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.geschlecht = 'Geschlecht - Total' AND T1.geschlecht = 'Geschlecht - Total'\n  AND T2.renten_mittelwert_in_franken > T1.renten_mittelwert_in_franken\nGROUP BY T1.rententyp;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit (\n\tuid SERIAL NOT NULL, \n\trententyp TEXT, \n\twohnsitzstaat_kategorie TEXT, \n\tstaatsangehorigkeit_kategorie TEXT, \n\tgeschlecht TEXT, \n\tjahr INTEGER, \n\tspatialunit_uid VARCHAR, \n\tanzahl_renten NUMERIC, \n\trentensumme_in_tausend_franken NUMERIC, \n\trenten_mittelwert_in_franken NUMERIC, \n\tCONSTRAINT ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit_pkey PRIMARY KEY (uid), \n\tCONSTRAINT ahv_renten_nach_wohnsitz_und_staatsangehoe_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2015, 2009, 2012, 2019, 2017\nanzahl_renten : 1698329, 1367639, 662685, 158408, 122431\nrentensumme_in_tausend_franken : 283847, 248909, 234719, 407414, 1897318\nrenten_mittelwert_in_franken : 481, 1095, 1025, 1146, 1491\n*/\n\n/*\nColumn name, Column discription, Example values\nrententyp, Rentenart, Zusatzrente f\u00fcr Kinder (Mutter),Zusatzrente f\u00fcr Ehepartner,Altersrente\nwohnsitzstaat_kategorie, Wohnsitz Kategorie, Ausland,Schweiz,Wohnsitzstaat - Total\nstaatsangehorigkeit_kategorie, Staatsangeh\u00f6rigkeit Kategorie, Ausland,Schweiz,Staatsangeh\u00f6rigkeit - Total\ngeschlecht, Geschlecht, Frau,Mann,Geschlecht - Total\nanzahl_renten, Anzahl Renten, None\nrentensumme_in_tausend_franken, Rentensumme in Tausend CHF, None\nrenten_mittelwert_in_franken, Renten Mittelwert in CHF, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWieviel Prozent der Rentenausgaben floss 2015 an Schweizer, die im Ausland leben und wieviel waren ?\n### SQL query\nSELECT\n  ROUND((SUM(CASE WHEN jahr = 2015\n       AND staatsangehorigkeit_kategorie = 'Schweiz' AND wohnsitzstaat_kategorie = 'Ausland'\n       THEN rentensumme_in_tausend_franken ELSE 0 END) /\n   SUM(CASE WHEN jahr = 2015 AND staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n       AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n       THEN rentensumme_in_tausend_franken ELSE 0 END)) * 100, 2) AS prozent_rentenausgaben_fur_schweizer_im_ausland\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE jahr = 2015\n  AND geschlecht = 'Geschlecht - Total';\n\n\n### Question\nWie entwickelten sich die Differenz der durchschnittliche Altersrente und der Anzahl der Renten f\u00fcr Frauen und M\u00e4nnern \u00fcber die Jahre?\n### SQL query\nSELECT T1.jahr,\n  (T1.renten_mittelwert_in_franken - T2.renten_mittelwert_in_franken) AS differenz_durchschnittliche_altersrente_frauen_maenner,\n  (T1.anzahl_renten - T2.anzahl_renten) AS differenz_anzahl_altersrenten_frauen_maenner\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.jahr = T2.jahr\nWHERE T1.geschlecht = 'Frau'\n  AND T2.geschlecht = 'Mann'\n  AND T1.rententyp = 'Altersrente' AND T2.rententyp = 'Altersrente'\n  AND T1.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T2.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T1.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total';\n\n\n### Question\nWas war die h\u00e4ufigste Rentenart 2022 in der Schweiz?\n### SQL query\nSELECT rententyp as haufigste_rentenart_2022_schweiz\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '2022'\nORDER BY anzahl_renten DESC LIMIT 1;\n\n\n### Question\nWas war die h\u00e4ufigste Rentenart 2022 in der Schweiz?\n### SQL query\nSELECT rententyp as haufigste_rentenart_2022_schweiz\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '2022'\nORDER BY anzahl_renten DESC LIMIT 1;\n\n\n### Question\nWelcher Rententyp wird von Ausl\u00e4ndern, die im Ausland leben, am h\u00e4ufigsten bezogen und wieviele Renten sind es?\n### SQL query\nSELECT rententyp as haufigster_rententy_fur_auslaender_im_ausland,\n  MAX(anzahl_renten) as anzahl_renten_auslaender_im_ausland\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE staatsangehorigkeit_kategorie = 'Ausland'\n  AND wohnsitzstaat_kategorie = 'Ausland'\n  AND geschlecht = 'Geschlecht - Total'\nGROUP BY rententyp\nORDER BY anzahl_renten_auslaender_im_ausland DESC LIMIT 1;\n\n\n### Question\nGab es Rentenarten bei der der Anteil der an im Ausland lebenden ausl\u00e4ndischer Staatsangeh\u00f6riger im Jahr 2022 h\u00f6her war als der der Anteil der im Inland lebenden Schweizer Staatsange\u00f6rigen: was waren die Zahlen?\n### SQL query\nSELECT T1.rententyp,\n  SUM(T1.anzahl_renten) AS anzahl_renten_auslaender_im_ausland_2022,\n  SUM(T2.anzahl_renten) AS anzahl_renten_schweizer_im_inland_2022\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.rententyp = T2.rententyp\nWHERE T1.jahr = 2022 and T2.jahr = 2022\n  AND T1.staatsangehorigkeit_kategorie = 'Ausland' AND T1.wohnsitzstaat_kategorie = 'Ausland'\n  AND T2.staatsangehorigkeit_kategorie = 'Schweiz' AND T2.wohnsitzstaat_kategorie = 'Schweiz'\n  AND T2.geschlecht = 'Geschlecht - Total' AND T1.geschlecht = 'Geschlecht - Total'\n  AND T1.anzahl_renten > T2.anzahl_renten\nGROUP BY T1.rententyp;\n\n\n### Question\nF\u00fcr welche Rentenarten ist die durchschnittlich Rente zwischen 2001 und 2022 heruntergegangen und wenn ja um wieviele CHF?\n### SQL query\nSELECT T1.rententyp,\n  (AVG(T2.renten_mittelwert_in_franken) - AVG(T1.renten_mittelwert_in_franken)) as rentenabzug_2022_genueber_2001_CHF\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.rententyp = T2.rententyp\nWHERE T1.jahr = 2001 AND T2.jahr = 2022\n  AND T1.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total' AND T1.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total' AND T2.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.geschlecht = 'Geschlecht - Total' AND T1.geschlecht = 'Geschlecht - Total'\n  AND T2.renten_mittelwert_in_franken > T1.renten_mittelwert_in_franken\nGROUP BY T1.rententyp;\n\n\n### Question\nWelche Rentenarten gibt es in der Schweiz und was sind die durchschnittliche Ausgaben daf\u00fcr pro Jahr?\n### SQL query\n",
    "process_time": 10.435472017154098,
    "num_tokens": 2861,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 124,
    "question": "Was waren die Gesamtausgaben f\u00fcr Renten 2022 in Franken, wie verteilten sie sich auf die Rentenarten, auf wieviele Renten jeweils und was kam dabei als durchschnittliche Rente heraus? Ordne das Ergebnis nach Anzahl der Renten.",
    "query": "SELECT rententyp,\n  anzahl_renten AS renten_anzahl_2022,\n  1000 * rentensumme_in_tausend_franken AS rentengesamt_ausgaben_in_CHF,\n  renten_mittelwert_in_franken AS durchschnittliche_rente_in_CHF\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE jahr = 2022\n  AND staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND geschlecht = 'Geschlecht - Total'\n  AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\nORDER BY anzahl_renten DESC;\n",
    "db_id": "ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit",
    "generated_query": "SELECT\n  rententyp,\n  SUM(rentensumme_in_tausend_franken) AS gesamtausgaben_fur_renten_2022,\n  SUM(anzahl_renten) AS anzahl_renten,\n  AVG(renten_mittelwert_in_franken) AS durchschnittliche_rente\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit\nWHERE jahr = 2022\nGROUP BY rententyp\nORDER BY anzahl_renten;",
    "meta_data": [
      {
        "question": "Wieviel Prozent der Rentenausgaben floss 2015 an Schweizer, die im Ausland leben und wieviel waren ?",
        "query": "SELECT\n  ROUND((SUM(CASE WHEN jahr = 2015\n       AND staatsangehorigkeit_kategorie = 'Schweiz' AND wohnsitzstaat_kategorie = 'Ausland'\n       THEN rentensumme_in_tausend_franken ELSE 0 END) /\n   SUM(CASE WHEN jahr = 2015 AND staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n       AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n       THEN rentensumme_in_tausend_franken ELSE 0 END)) * 100, 2) AS prozent_rentenausgaben_fur_schweizer_im_ausland\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE jahr = 2015\n  AND geschlecht = 'Geschlecht - Total';\n"
      },
      {
        "question": "Wie entwickelten sich die Differenz der durchschnittliche Altersrente und der Anzahl der Renten f\u00fcr Frauen und M\u00e4nnern \u00fcber die Jahre?",
        "query": "SELECT T1.jahr,\n  (T1.renten_mittelwert_in_franken - T2.renten_mittelwert_in_franken) AS differenz_durchschnittliche_altersrente_frauen_maenner,\n  (T1.anzahl_renten - T2.anzahl_renten) AS differenz_anzahl_altersrenten_frauen_maenner\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.jahr = T2.jahr\nWHERE T1.geschlecht = 'Frau'\n  AND T2.geschlecht = 'Mann'\n  AND T1.rententyp = 'Altersrente' AND T2.rententyp = 'Altersrente'\n  AND T1.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T2.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T1.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total';\n"
      },
      {
        "question": "Wie entwickelten sich die Differenz der durchschnittliche Altersrente und der Anzahl der Renten f\u00fcr Frauen und M\u00e4nnern \u00fcber die Jahre?",
        "query": "SELECT T1.jahr,\n  (T1.renten_mittelwert_in_franken - T2.renten_mittelwert_in_franken) AS differenz_durchschnittliche_altersrente_frauen_maenner,\n  (T1.anzahl_renten - T2.anzahl_renten) AS differenz_anzahl_altersrenten_frauen_maenner\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.jahr = T2.jahr\nWHERE T1.geschlecht = 'Frau'\n  AND T2.geschlecht = 'Mann'\n  AND T1.rententyp = 'Altersrente' AND T2.rententyp = 'Altersrente'\n  AND T1.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T2.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T1.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total';\n"
      },
      {
        "question": "Wieviel Prozent der Rentenausgaben floss 2015 an Schweizer, die im Ausland leben und wieviel waren ?",
        "query": "SELECT\n  ROUND((SUM(CASE WHEN jahr = 2015\n       AND staatsangehorigkeit_kategorie = 'Schweiz' AND wohnsitzstaat_kategorie = 'Ausland'\n       THEN rentensumme_in_tausend_franken ELSE 0 END) /\n   SUM(CASE WHEN jahr = 2015 AND staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n       AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n       THEN rentensumme_in_tausend_franken ELSE 0 END)) * 100, 2) AS prozent_rentenausgaben_fur_schweizer_im_ausland\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE jahr = 2015\n  AND geschlecht = 'Geschlecht - Total';\n"
      },
      {
        "question": "Wieviel Prozent der Rentenausgaben floss 2015 an Schweizer, die im Ausland leben und wieviel waren ?",
        "query": "SELECT\n  ROUND((SUM(CASE WHEN jahr = 2015\n       AND staatsangehorigkeit_kategorie = 'Schweiz' AND wohnsitzstaat_kategorie = 'Ausland'\n       THEN rentensumme_in_tausend_franken ELSE 0 END) /\n   SUM(CASE WHEN jahr = 2015 AND staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n       AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n       THEN rentensumme_in_tausend_franken ELSE 0 END)) * 100, 2) AS prozent_rentenausgaben_fur_schweizer_im_ausland\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE jahr = 2015\n  AND geschlecht = 'Geschlecht - Total';\n"
      },
      {
        "question": "Wieviel Prozent der Rentenausgaben floss 2015 an Schweizer, die im Ausland leben und wieviel waren ?",
        "query": "SELECT\n  ROUND((SUM(CASE WHEN jahr = 2015\n       AND staatsangehorigkeit_kategorie = 'Schweiz' AND wohnsitzstaat_kategorie = 'Ausland'\n       THEN rentensumme_in_tausend_franken ELSE 0 END) /\n   SUM(CASE WHEN jahr = 2015 AND staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n       AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n       THEN rentensumme_in_tausend_franken ELSE 0 END)) * 100, 2) AS prozent_rentenausgaben_fur_schweizer_im_ausland\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE jahr = 2015\n  AND geschlecht = 'Geschlecht - Total';\n"
      },
      {
        "question": "Wie entwickelten sich die Differenz der durchschnittliche Altersrente und der Anzahl der Renten f\u00fcr Frauen und M\u00e4nnern \u00fcber die Jahre?",
        "query": "SELECT T1.jahr,\n  (T1.renten_mittelwert_in_franken - T2.renten_mittelwert_in_franken) AS differenz_durchschnittliche_altersrente_frauen_maenner,\n  (T1.anzahl_renten - T2.anzahl_renten) AS differenz_anzahl_altersrenten_frauen_maenner\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.jahr = T2.jahr\nWHERE T1.geschlecht = 'Frau'\n  AND T2.geschlecht = 'Mann'\n  AND T1.rententyp = 'Altersrente' AND T2.rententyp = 'Altersrente'\n  AND T1.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T2.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T1.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total';\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit (\n\tuid SERIAL NOT NULL, \n\trententyp TEXT, \n\twohnsitzstaat_kategorie TEXT, \n\tstaatsangehorigkeit_kategorie TEXT, \n\tgeschlecht TEXT, \n\tjahr INTEGER, \n\tspatialunit_uid VARCHAR, \n\tanzahl_renten NUMERIC, \n\trentensumme_in_tausend_franken NUMERIC, \n\trenten_mittelwert_in_franken NUMERIC, \n\tCONSTRAINT ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit_pkey PRIMARY KEY (uid), \n\tCONSTRAINT ahv_renten_nach_wohnsitz_und_staatsangehoe_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2015, 2009, 2012, 2019, 2017\nanzahl_renten : 1698329, 1367639, 662685, 158408, 122431\nrentensumme_in_tausend_franken : 283847, 248909, 234719, 407414, 1897318\nrenten_mittelwert_in_franken : 481, 1095, 1025, 1146, 1491\n*/\n\n/*\nColumn name, Column discription, Example values\nrententyp, Rentenart, Zusatzrente f\u00fcr Kinder (Mutter),Zusatzrente f\u00fcr Ehepartner,Altersrente\nwohnsitzstaat_kategorie, Wohnsitz Kategorie, Ausland,Schweiz,Wohnsitzstaat - Total\nstaatsangehorigkeit_kategorie, Staatsangeh\u00f6rigkeit Kategorie, Ausland,Schweiz,Staatsangeh\u00f6rigkeit - Total\ngeschlecht, Geschlecht, Frau,Mann,Geschlecht - Total\nanzahl_renten, Anzahl Renten, None\nrentensumme_in_tausend_franken, Rentensumme in Tausend CHF, None\nrenten_mittelwert_in_franken, Renten Mittelwert in CHF, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWieviel Prozent der Rentenausgaben floss 2015 an Schweizer, die im Ausland leben und wieviel waren ?\n### SQL query\nSELECT\n  ROUND((SUM(CASE WHEN jahr = 2015\n       AND staatsangehorigkeit_kategorie = 'Schweiz' AND wohnsitzstaat_kategorie = 'Ausland'\n       THEN rentensumme_in_tausend_franken ELSE 0 END) /\n   SUM(CASE WHEN jahr = 2015 AND staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n       AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n       THEN rentensumme_in_tausend_franken ELSE 0 END)) * 100, 2) AS prozent_rentenausgaben_fur_schweizer_im_ausland\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE jahr = 2015\n  AND geschlecht = 'Geschlecht - Total';\n\n\n### Question\nWie entwickelten sich die Differenz der durchschnittliche Altersrente und der Anzahl der Renten f\u00fcr Frauen und M\u00e4nnern \u00fcber die Jahre?\n### SQL query\nSELECT T1.jahr,\n  (T1.renten_mittelwert_in_franken - T2.renten_mittelwert_in_franken) AS differenz_durchschnittliche_altersrente_frauen_maenner,\n  (T1.anzahl_renten - T2.anzahl_renten) AS differenz_anzahl_altersrenten_frauen_maenner\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.jahr = T2.jahr\nWHERE T1.geschlecht = 'Frau'\n  AND T2.geschlecht = 'Mann'\n  AND T1.rententyp = 'Altersrente' AND T2.rententyp = 'Altersrente'\n  AND T1.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T2.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T1.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total';\n\n\n### Question\nWie entwickelten sich die Differenz der durchschnittliche Altersrente und der Anzahl der Renten f\u00fcr Frauen und M\u00e4nnern \u00fcber die Jahre?\n### SQL query\nSELECT T1.jahr,\n  (T1.renten_mittelwert_in_franken - T2.renten_mittelwert_in_franken) AS differenz_durchschnittliche_altersrente_frauen_maenner,\n  (T1.anzahl_renten - T2.anzahl_renten) AS differenz_anzahl_altersrenten_frauen_maenner\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.jahr = T2.jahr\nWHERE T1.geschlecht = 'Frau'\n  AND T2.geschlecht = 'Mann'\n  AND T1.rententyp = 'Altersrente' AND T2.rententyp = 'Altersrente'\n  AND T1.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T2.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T1.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total';\n\n\n### Question\nWieviel Prozent der Rentenausgaben floss 2015 an Schweizer, die im Ausland leben und wieviel waren ?\n### SQL query\nSELECT\n  ROUND((SUM(CASE WHEN jahr = 2015\n       AND staatsangehorigkeit_kategorie = 'Schweiz' AND wohnsitzstaat_kategorie = 'Ausland'\n       THEN rentensumme_in_tausend_franken ELSE 0 END) /\n   SUM(CASE WHEN jahr = 2015 AND staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n       AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n       THEN rentensumme_in_tausend_franken ELSE 0 END)) * 100, 2) AS prozent_rentenausgaben_fur_schweizer_im_ausland\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE jahr = 2015\n  AND geschlecht = 'Geschlecht - Total';\n\n\n### Question\nWieviel Prozent der Rentenausgaben floss 2015 an Schweizer, die im Ausland leben und wieviel waren ?\n### SQL query\nSELECT\n  ROUND((SUM(CASE WHEN jahr = 2015\n       AND staatsangehorigkeit_kategorie = 'Schweiz' AND wohnsitzstaat_kategorie = 'Ausland'\n       THEN rentensumme_in_tausend_franken ELSE 0 END) /\n   SUM(CASE WHEN jahr = 2015 AND staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n       AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n       THEN rentensumme_in_tausend_franken ELSE 0 END)) * 100, 2) AS prozent_rentenausgaben_fur_schweizer_im_ausland\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE jahr = 2015\n  AND geschlecht = 'Geschlecht - Total';\n\n\n### Question\nWieviel Prozent der Rentenausgaben floss 2015 an Schweizer, die im Ausland leben und wieviel waren ?\n### SQL query\nSELECT\n  ROUND((SUM(CASE WHEN jahr = 2015\n       AND staatsangehorigkeit_kategorie = 'Schweiz' AND wohnsitzstaat_kategorie = 'Ausland'\n       THEN rentensumme_in_tausend_franken ELSE 0 END) /\n   SUM(CASE WHEN jahr = 2015 AND staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n       AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n       THEN rentensumme_in_tausend_franken ELSE 0 END)) * 100, 2) AS prozent_rentenausgaben_fur_schweizer_im_ausland\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE jahr = 2015\n  AND geschlecht = 'Geschlecht - Total';\n\n\n### Question\nWie entwickelten sich die Differenz der durchschnittliche Altersrente und der Anzahl der Renten f\u00fcr Frauen und M\u00e4nnern \u00fcber die Jahre?\n### SQL query\nSELECT T1.jahr,\n  (T1.renten_mittelwert_in_franken - T2.renten_mittelwert_in_franken) AS differenz_durchschnittliche_altersrente_frauen_maenner,\n  (T1.anzahl_renten - T2.anzahl_renten) AS differenz_anzahl_altersrenten_frauen_maenner\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.jahr = T2.jahr\nWHERE T1.geschlecht = 'Frau'\n  AND T2.geschlecht = 'Mann'\n  AND T1.rententyp = 'Altersrente' AND T2.rententyp = 'Altersrente'\n  AND T1.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T2.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T1.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total';\n\n\n### Question\nWas waren die Gesamtausgaben f\u00fcr Renten 2022 in Franken, wie verteilten sie sich auf die Rentenarten, auf wieviele Renten jeweils und was kam dabei als durchschnittliche Rente heraus? Ordne das Ergebnis nach Anzahl der Renten.\n### SQL query\n",
    "process_time": 8.6434357278049,
    "num_tokens": 3187,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 125,
    "question": "Wie hoch war der Frauenanteil in prozent bei den Zusatzrenten f\u00fcr Ehepartner?",
    "query": "SELECT\n  ROUND(100 * SUM(CASE WHEN geschlecht = 'Frau'\n       THEN anzahl_renten ELSE 0 END) /\n   SUM(CASE WHEN geschlecht = 'Geschlecht - Total'\n       THEN anzahl_renten ELSE 0 END)\n  , 2) AS prozent_frauenanteil_bei_ehepartner_zusatzrenten\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE rententyp = 'Zusatzrente f\u00fcr Ehepartner'\n  AND staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total' AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total';\n",
    "db_id": "ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit",
    "generated_query": "SELECT (SUM(CASE WHEN geschlecht = 'Frau' THEN anzahl_renten ELSE 0 END) / SUM(anzahl_renten)) * 100 as frauenanteil_prozent\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit\nWHERE rententyp = 'Zusatzrente f\u00fcr Ehepartner'\n  AND staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total';",
    "meta_data": [
      {
        "question": "Gab es Rentenarten bei der der Anteil der an im Ausland lebenden ausl\u00e4ndischer Staatsangeh\u00f6riger im Jahr 2022 h\u00f6her war als der der Anteil der im Inland lebenden Schweizer Staatsange\u00f6rigen: was waren die Zahlen?",
        "query": "SELECT T1.rententyp,\n  SUM(T1.anzahl_renten) AS anzahl_renten_auslaender_im_ausland_2022,\n  SUM(T2.anzahl_renten) AS anzahl_renten_schweizer_im_inland_2022\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.rententyp = T2.rententyp\nWHERE T1.jahr = 2022 and T2.jahr = 2022\n  AND T1.staatsangehorigkeit_kategorie = 'Ausland' AND T1.wohnsitzstaat_kategorie = 'Ausland'\n  AND T2.staatsangehorigkeit_kategorie = 'Schweiz' AND T2.wohnsitzstaat_kategorie = 'Schweiz'\n  AND T2.geschlecht = 'Geschlecht - Total' AND T1.geschlecht = 'Geschlecht - Total'\n  AND T1.anzahl_renten > T2.anzahl_renten\nGROUP BY T1.rententyp;\n"
      },
      {
        "question": "Wie entwickelten sich die Differenz der durchschnittliche Altersrente und der Anzahl der Renten f\u00fcr Frauen und M\u00e4nnern \u00fcber die Jahre?",
        "query": "SELECT T1.jahr,\n  (T1.renten_mittelwert_in_franken - T2.renten_mittelwert_in_franken) AS differenz_durchschnittliche_altersrente_frauen_maenner,\n  (T1.anzahl_renten - T2.anzahl_renten) AS differenz_anzahl_altersrenten_frauen_maenner\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.jahr = T2.jahr\nWHERE T1.geschlecht = 'Frau'\n  AND T2.geschlecht = 'Mann'\n  AND T1.rententyp = 'Altersrente' AND T2.rententyp = 'Altersrente'\n  AND T1.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T2.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T1.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total';\n"
      },
      {
        "question": "Gab es Rentenarten bei der der Anteil der an im Ausland lebenden ausl\u00e4ndischer Staatsangeh\u00f6riger im Jahr 2022 h\u00f6her war als der der Anteil der im Inland lebenden Schweizer Staatsange\u00f6rigen: was waren die Zahlen?",
        "query": "SELECT T1.rententyp,\n  SUM(T1.anzahl_renten) AS anzahl_renten_auslaender_im_ausland_2022,\n  SUM(T2.anzahl_renten) AS anzahl_renten_schweizer_im_inland_2022\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.rententyp = T2.rententyp\nWHERE T1.jahr = 2022 and T2.jahr = 2022\n  AND T1.staatsangehorigkeit_kategorie = 'Ausland' AND T1.wohnsitzstaat_kategorie = 'Ausland'\n  AND T2.staatsangehorigkeit_kategorie = 'Schweiz' AND T2.wohnsitzstaat_kategorie = 'Schweiz'\n  AND T2.geschlecht = 'Geschlecht - Total' AND T1.geschlecht = 'Geschlecht - Total'\n  AND T1.anzahl_renten > T2.anzahl_renten\nGROUP BY T1.rententyp;\n"
      },
      {
        "question": "Gab es Rentenarten bei der der Anteil der an im Ausland lebenden ausl\u00e4ndischer Staatsangeh\u00f6riger im Jahr 2022 h\u00f6her war als der der Anteil der im Inland lebenden Schweizer Staatsange\u00f6rigen: was waren die Zahlen?",
        "query": "SELECT T1.rententyp,\n  SUM(T1.anzahl_renten) AS anzahl_renten_auslaender_im_ausland_2022,\n  SUM(T2.anzahl_renten) AS anzahl_renten_schweizer_im_inland_2022\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.rententyp = T2.rententyp\nWHERE T1.jahr = 2022 and T2.jahr = 2022\n  AND T1.staatsangehorigkeit_kategorie = 'Ausland' AND T1.wohnsitzstaat_kategorie = 'Ausland'\n  AND T2.staatsangehorigkeit_kategorie = 'Schweiz' AND T2.wohnsitzstaat_kategorie = 'Schweiz'\n  AND T2.geschlecht = 'Geschlecht - Total' AND T1.geschlecht = 'Geschlecht - Total'\n  AND T1.anzahl_renten > T2.anzahl_renten\nGROUP BY T1.rententyp;\n"
      },
      {
        "question": "In welchen drei Jahren gab es die h\u00f6chsten Ausgaben f\u00fcr die Zusatzrenten f\u00fcr Waise und wie hoch waren diese in CHF?",
        "query": "SELECT 1000 * SUM(rentensumme_in_tausend_franken) as rentenausgaben_fur_waisenrente_CHF, jahr\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE rententyp LIKE '%Waise%'\n  AND staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND geschlecht = 'Geschlecht - Total'\nGROUP BY jahr\nORDER BY rentenausgaben_fur_waisenrente_CHF DESC\nLIMIT 3;\n"
      },
      {
        "question": "F\u00fcr welche Rentenarten ist die durchschnittlich Rente zwischen 2001 und 2022 heruntergegangen und wenn ja um wieviele CHF?",
        "query": "SELECT T1.rententyp,\n  (AVG(T2.renten_mittelwert_in_franken) - AVG(T1.renten_mittelwert_in_franken)) as rentenabzug_2022_genueber_2001_CHF\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.rententyp = T2.rententyp\nWHERE T1.jahr = 2001 AND T2.jahr = 2022\n  AND T1.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total' AND T1.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total' AND T2.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.geschlecht = 'Geschlecht - Total' AND T1.geschlecht = 'Geschlecht - Total'\n  AND T2.renten_mittelwert_in_franken > T1.renten_mittelwert_in_franken\nGROUP BY T1.rententyp;\n"
      },
      {
        "question": "In welchen drei Jahren gab es die h\u00f6chsten Ausgaben f\u00fcr die Zusatzrenten f\u00fcr Waise und wie hoch waren diese in CHF?",
        "query": "SELECT 1000 * SUM(rentensumme_in_tausend_franken) as rentenausgaben_fur_waisenrente_CHF, jahr\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE rententyp LIKE '%Waise%'\n  AND staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND geschlecht = 'Geschlecht - Total'\nGROUP BY jahr\nORDER BY rentenausgaben_fur_waisenrente_CHF DESC\nLIMIT 3;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit (\n\tuid SERIAL NOT NULL, \n\trententyp TEXT, \n\twohnsitzstaat_kategorie TEXT, \n\tstaatsangehorigkeit_kategorie TEXT, \n\tgeschlecht TEXT, \n\tjahr INTEGER, \n\tspatialunit_uid VARCHAR, \n\tanzahl_renten NUMERIC, \n\trentensumme_in_tausend_franken NUMERIC, \n\trenten_mittelwert_in_franken NUMERIC, \n\tCONSTRAINT ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit_pkey PRIMARY KEY (uid), \n\tCONSTRAINT ahv_renten_nach_wohnsitz_und_staatsangehoe_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2015, 2009, 2012, 2019, 2017\nanzahl_renten : 1698329, 1367639, 662685, 158408, 122431\nrentensumme_in_tausend_franken : 283847, 248909, 234719, 407414, 1897318\nrenten_mittelwert_in_franken : 481, 1095, 1025, 1146, 1491\n*/\n\n/*\nColumn name, Column discription, Example values\nrententyp, Rentenart, Zusatzrente f\u00fcr Kinder (Mutter),Zusatzrente f\u00fcr Ehepartner,Altersrente\nwohnsitzstaat_kategorie, Wohnsitz Kategorie, Ausland,Schweiz,Wohnsitzstaat - Total\nstaatsangehorigkeit_kategorie, Staatsangeh\u00f6rigkeit Kategorie, Ausland,Schweiz,Staatsangeh\u00f6rigkeit - Total\ngeschlecht, Geschlecht, Frau,Mann,Geschlecht - Total\nanzahl_renten, Anzahl Renten, None\nrentensumme_in_tausend_franken, Rentensumme in Tausend CHF, None\nrenten_mittelwert_in_franken, Renten Mittelwert in CHF, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nGab es Rentenarten bei der der Anteil der an im Ausland lebenden ausl\u00e4ndischer Staatsangeh\u00f6riger im Jahr 2022 h\u00f6her war als der der Anteil der im Inland lebenden Schweizer Staatsange\u00f6rigen: was waren die Zahlen?\n### SQL query\nSELECT T1.rententyp,\n  SUM(T1.anzahl_renten) AS anzahl_renten_auslaender_im_ausland_2022,\n  SUM(T2.anzahl_renten) AS anzahl_renten_schweizer_im_inland_2022\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.rententyp = T2.rententyp\nWHERE T1.jahr = 2022 and T2.jahr = 2022\n  AND T1.staatsangehorigkeit_kategorie = 'Ausland' AND T1.wohnsitzstaat_kategorie = 'Ausland'\n  AND T2.staatsangehorigkeit_kategorie = 'Schweiz' AND T2.wohnsitzstaat_kategorie = 'Schweiz'\n  AND T2.geschlecht = 'Geschlecht - Total' AND T1.geschlecht = 'Geschlecht - Total'\n  AND T1.anzahl_renten > T2.anzahl_renten\nGROUP BY T1.rententyp;\n\n\n### Question\nWie entwickelten sich die Differenz der durchschnittliche Altersrente und der Anzahl der Renten f\u00fcr Frauen und M\u00e4nnern \u00fcber die Jahre?\n### SQL query\nSELECT T1.jahr,\n  (T1.renten_mittelwert_in_franken - T2.renten_mittelwert_in_franken) AS differenz_durchschnittliche_altersrente_frauen_maenner,\n  (T1.anzahl_renten - T2.anzahl_renten) AS differenz_anzahl_altersrenten_frauen_maenner\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.jahr = T2.jahr\nWHERE T1.geschlecht = 'Frau'\n  AND T2.geschlecht = 'Mann'\n  AND T1.rententyp = 'Altersrente' AND T2.rententyp = 'Altersrente'\n  AND T1.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T2.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND T1.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total';\n\n\n### Question\nGab es Rentenarten bei der der Anteil der an im Ausland lebenden ausl\u00e4ndischer Staatsangeh\u00f6riger im Jahr 2022 h\u00f6her war als der der Anteil der im Inland lebenden Schweizer Staatsange\u00f6rigen: was waren die Zahlen?\n### SQL query\nSELECT T1.rententyp,\n  SUM(T1.anzahl_renten) AS anzahl_renten_auslaender_im_ausland_2022,\n  SUM(T2.anzahl_renten) AS anzahl_renten_schweizer_im_inland_2022\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.rententyp = T2.rententyp\nWHERE T1.jahr = 2022 and T2.jahr = 2022\n  AND T1.staatsangehorigkeit_kategorie = 'Ausland' AND T1.wohnsitzstaat_kategorie = 'Ausland'\n  AND T2.staatsangehorigkeit_kategorie = 'Schweiz' AND T2.wohnsitzstaat_kategorie = 'Schweiz'\n  AND T2.geschlecht = 'Geschlecht - Total' AND T1.geschlecht = 'Geschlecht - Total'\n  AND T1.anzahl_renten > T2.anzahl_renten\nGROUP BY T1.rententyp;\n\n\n### Question\nGab es Rentenarten bei der der Anteil der an im Ausland lebenden ausl\u00e4ndischer Staatsangeh\u00f6riger im Jahr 2022 h\u00f6her war als der der Anteil der im Inland lebenden Schweizer Staatsange\u00f6rigen: was waren die Zahlen?\n### SQL query\nSELECT T1.rententyp,\n  SUM(T1.anzahl_renten) AS anzahl_renten_auslaender_im_ausland_2022,\n  SUM(T2.anzahl_renten) AS anzahl_renten_schweizer_im_inland_2022\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.rententyp = T2.rententyp\nWHERE T1.jahr = 2022 and T2.jahr = 2022\n  AND T1.staatsangehorigkeit_kategorie = 'Ausland' AND T1.wohnsitzstaat_kategorie = 'Ausland'\n  AND T2.staatsangehorigkeit_kategorie = 'Schweiz' AND T2.wohnsitzstaat_kategorie = 'Schweiz'\n  AND T2.geschlecht = 'Geschlecht - Total' AND T1.geschlecht = 'Geschlecht - Total'\n  AND T1.anzahl_renten > T2.anzahl_renten\nGROUP BY T1.rententyp;\n\n\n### Question\nIn welchen drei Jahren gab es die h\u00f6chsten Ausgaben f\u00fcr die Zusatzrenten f\u00fcr Waise und wie hoch waren diese in CHF?\n### SQL query\nSELECT 1000 * SUM(rentensumme_in_tausend_franken) as rentenausgaben_fur_waisenrente_CHF, jahr\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE rententyp LIKE '%Waise%'\n  AND staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND geschlecht = 'Geschlecht - Total'\nGROUP BY jahr\nORDER BY rentenausgaben_fur_waisenrente_CHF DESC\nLIMIT 3;\n\n\n### Question\nF\u00fcr welche Rentenarten ist die durchschnittlich Rente zwischen 2001 und 2022 heruntergegangen und wenn ja um wieviele CHF?\n### SQL query\nSELECT T1.rententyp,\n  (AVG(T2.renten_mittelwert_in_franken) - AVG(T1.renten_mittelwert_in_franken)) as rentenabzug_2022_genueber_2001_CHF\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T1\nJOIN ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit AS T2 ON T1.rententyp = T2.rententyp\nWHERE T1.jahr = 2001 AND T2.jahr = 2022\n  AND T1.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total' AND T1.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total' AND T2.wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND T2.geschlecht = 'Geschlecht - Total' AND T1.geschlecht = 'Geschlecht - Total'\n  AND T2.renten_mittelwert_in_franken > T1.renten_mittelwert_in_franken\nGROUP BY T1.rententyp;\n\n\n### Question\nIn welchen drei Jahren gab es die h\u00f6chsten Ausgaben f\u00fcr die Zusatzrenten f\u00fcr Waise und wie hoch waren diese in CHF?\n### SQL query\nSELECT 1000 * SUM(rentensumme_in_tausend_franken) as rentenausgaben_fur_waisenrente_CHF, jahr\nFROM ahv_renten_nach_wohnsitz_und_staatsangehoerigkeit WHERE rententyp LIKE '%Waise%'\n  AND staatsangehorigkeit_kategorie = 'Staatsangeh\u00f6rigkeit - Total'\n  AND wohnsitzstaat_kategorie = 'Wohnsitzstaat - Total'\n  AND geschlecht = 'Geschlecht - Total'\nGROUP BY jahr\nORDER BY rentenausgaben_fur_waisenrente_CHF DESC\nLIMIT 3;\n\n\n### Question\nWie hoch war der Frauenanteil in prozent bei den Zusatzrenten f\u00fcr Ehepartner?\n### SQL query\n",
    "process_time": 7.703423556871712,
    "num_tokens": 3255,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 126,
    "question": "Welches waren die Themen der Volksabstimmungen in 2022?",
    "query": "SELECT DISTINCT(T.thema)\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.jahr = '2022' AND anzahl_abstimmungsvorlagen != 0;\n",
    "db_id": "abstimmungsvorlagen_seit_1971",
    "generated_query": "SELECT DISTINCT thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = 2022;",
    "meta_data": [
      {
        "question": "Wieviele Abstimmungsvorlagen gab es seit dem Jahr 1971?",
        "query": "SELECT COUNT(*) as anzahl_abstimmungsvorlagen\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE';\n"
      },
      {
        "question": "Wieviele Volksabstimmungen wurden 1995 in der Schweiz durchgef\u00fchrt?",
        "query": "SELECT SUM(T.anzahl_abstimmungsvorlagen) AS gesamt_anzahl_abstimmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '1995' \nGROUP BY T.jahr;\n"
      },
      {
        "question": "Welches Thema hatte die meisten Volksabstimmungen in den Jahren 1990 bis 2000?",
        "query": "SELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 1;\n"
      },
      {
        "question": "Was war die 5 dominantesten Themen bei den Volksabstimmungen \u00fcber die Jahre in der Schweiz?",
        "query": "SELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 5;\n"
      },
      {
        "question": "Wann gab es die erste Volksabstimmungen ueber Sozialpolitik?",
        "query": "SELECT MIN(jahr) as erstes_jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sozialpolitik%';\n"
      },
      {
        "question": "Welches Thema hatte die meisten Volksabstimmungen in den Jahren 1990 bis 2000?",
        "query": "SELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 1;\n"
      },
      {
        "question": "In wievielen Jahren gab es Volksabstimmungen zum Thema Aussenpolitik?",
        "query": "SELECT COUNT(jahr) as anzahl_jahre_aussenpolitik\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Aussenpolitik%';\n"
      },
      {
        "question": "In wievielen Jahren gab es Volksabstimmungen zum Thema Aussenpolitik?",
        "query": "SELECT COUNT(jahr) as anzahl_jahre_aussenpolitik\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Aussenpolitik%';\n"
      },
      {
        "question": "In welchem Jahr gab es die meisten Volksabstimmungen zum Thema Religion in der Schweiz?",
        "query": "SELECT T.thema, T.jahr, T.anzahl_abstimmungsvorlagen\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.thema LIKE '%Religion%' AND anzahl_abstimmungsvorlagen != 0\nORDER BY anzahl_abstimmungsvorlagen DESC\nLIMIT 1;\n"
      },
      {
        "question": "In welchem Jahren war die Wirtschaft ein Thema in Volksabstimmungen?",
        "query": "SELECT T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.thema LIKE '%Wirtschaft%' AND anzahl_abstimmungsvorlagen != 0\nORDER BY jahr DESC;\n"
      },
      {
        "question": "Wieviele Volksabstimmungen wurden 1995 in der Schweiz durchgef\u00fchrt?",
        "query": "SELECT SUM(T.anzahl_abstimmungsvorlagen) AS gesamt_anzahl_abstimmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '1995' \nGROUP BY T.jahr;\n"
      },
      {
        "question": "In welchem Jahr gab es die meisten Volksabstimmungen zum Thema Religion in der Schweiz?",
        "query": "SELECT T.thema, T.jahr, T.anzahl_abstimmungsvorlagen\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.thema LIKE '%Religion%' AND anzahl_abstimmungsvorlagen != 0\nORDER BY anzahl_abstimmungsvorlagen DESC\nLIMIT 1;\n"
      },
      {
        "question": "In welchen Jahren war Sicherheit ein Thema bei Volksabstimmungen?",
        "query": "SELECT jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sicherheit%'\nORDER BY jahr DESC;\n"
      },
      {
        "question": "Welches Thema hatte die meisten Volksabstimmungen in den Jahren 1990 bis 2000?",
        "query": "SELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.abstimmungsvorlagen_seit_1971 (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tthema TEXT, \n\tanzahl_abstimmungsvorlagen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_pkey PRIMARY KEY (uid), \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in abstimmungsvorlagen_seit_1971 and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2014, 2011, 2013, 2015, 2008\nthema : Sicherheitspolitik, Sozialpolitik, Kultur, Religion, Medien, Umwelt und Lebensraum, Staatsordnung\n*/\n\n/*\nColumn name, Column discription, Example values\nthema, Thema, Aussenpolitik,\u00d6ffentliche Finanzen,Umwelt und Lebensraum\nanzahl_abstimmungsvorlagen, Anzahl Abstimmungsvorlagen, 3\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWieviele Abstimmungsvorlagen gab es seit dem Jahr 1971?\n### SQL query\nSELECT COUNT(*) as anzahl_abstimmungsvorlagen\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE';\n\n\n### Question\nWieviele Volksabstimmungen wurden 1995 in der Schweiz durchgef\u00fchrt?\n### SQL query\nSELECT SUM(T.anzahl_abstimmungsvorlagen) AS gesamt_anzahl_abstimmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '1995' \nGROUP BY T.jahr;\n\n\n### Question\nWelches Thema hatte die meisten Volksabstimmungen in den Jahren 1990 bis 2000?\n### SQL query\nSELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 1;\n\n\n### Question\nWas war die 5 dominantesten Themen bei den Volksabstimmungen \u00fcber die Jahre in der Schweiz?\n### SQL query\nSELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 5;\n\n\n### Question\nWann gab es die erste Volksabstimmungen ueber Sozialpolitik?\n### SQL query\nSELECT MIN(jahr) as erstes_jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sozialpolitik%';\n\n\n### Question\nWelches Thema hatte die meisten Volksabstimmungen in den Jahren 1990 bis 2000?\n### SQL query\nSELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 1;\n\n\n### Question\nIn wievielen Jahren gab es Volksabstimmungen zum Thema Aussenpolitik?\n### SQL query\nSELECT COUNT(jahr) as anzahl_jahre_aussenpolitik\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Aussenpolitik%';\n\n\n### Question\nIn wievielen Jahren gab es Volksabstimmungen zum Thema Aussenpolitik?\n### SQL query\nSELECT COUNT(jahr) as anzahl_jahre_aussenpolitik\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Aussenpolitik%';\n\n\n### Question\nIn welchem Jahr gab es die meisten Volksabstimmungen zum Thema Religion in der Schweiz?\n### SQL query\nSELECT T.thema, T.jahr, T.anzahl_abstimmungsvorlagen\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.thema LIKE '%Religion%' AND anzahl_abstimmungsvorlagen != 0\nORDER BY anzahl_abstimmungsvorlagen DESC\nLIMIT 1;\n\n\n### Question\nIn welchem Jahren war die Wirtschaft ein Thema in Volksabstimmungen?\n### SQL query\nSELECT T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.thema LIKE '%Wirtschaft%' AND anzahl_abstimmungsvorlagen != 0\nORDER BY jahr DESC;\n\n\n### Question\nWieviele Volksabstimmungen wurden 1995 in der Schweiz durchgef\u00fchrt?\n### SQL query\nSELECT SUM(T.anzahl_abstimmungsvorlagen) AS gesamt_anzahl_abstimmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '1995' \nGROUP BY T.jahr;\n\n\n### Question\nIn welchem Jahr gab es die meisten Volksabstimmungen zum Thema Religion in der Schweiz?\n### SQL query\nSELECT T.thema, T.jahr, T.anzahl_abstimmungsvorlagen\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.thema LIKE '%Religion%' AND anzahl_abstimmungsvorlagen != 0\nORDER BY anzahl_abstimmungsvorlagen DESC\nLIMIT 1;\n\n\n### Question\nIn welchen Jahren war Sicherheit ein Thema bei Volksabstimmungen?\n### SQL query\nSELECT jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sicherheit%'\nORDER BY jahr DESC;\n\n\n### Question\nWelches Thema hatte die meisten Volksabstimmungen in den Jahren 1990 bis 2000?\n### SQL query\nSELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 1;\n\n\n### Question\nWelches waren die Themen der Volksabstimmungen in 2022?\n### SQL query\n",
    "process_time": 4.633789279032499,
    "num_tokens": 2608,
    "hardness": "medium",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 127,
    "question": "In welchem Jahren gab es die Volksabstimmungen zum Thema Energie in der Schweiz?",
    "query": "SELECT T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.thema LIKE '%Energie%' AND anzahl_abstimmungsvorlagen != 0\nORDER BY jahr DESC;\n",
    "db_id": "abstimmungsvorlagen_seit_1971",
    "generated_query": "SELECT T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.thema LIKE '%Energie%' AND anzahl_abstimmungsvorlagen != 0\nORDER BY jahr DESC;",
    "meta_data": [
      {
        "question": "Welches 3 Themen hatten die wenigsten Volksabstimmungen in der Schweiz?",
        "query": "SELECT T.thema, SUM(T.anzahl_abstimmungsvorlagen) as abstimmungsvorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.thema\nORDER BY abstimmungsvorlagen_pro_thema ASC LIMIT 3;\n"
      },
      {
        "question": "In welchem Jahren war die Wirtschaft ein Thema in Volksabstimmungen?",
        "query": "SELECT T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.thema LIKE '%Wirtschaft%' AND anzahl_abstimmungsvorlagen != 0\nORDER BY jahr DESC;\n"
      },
      {
        "question": "In welchen Jahren war Sicherheit ein Thema bei Volksabstimmungen?",
        "query": "SELECT jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sicherheit%'\nORDER BY jahr DESC;\n"
      },
      {
        "question": "In welchem Jahr gab es die meisten Volksabstimmungen zum Thema Religion in der Schweiz?",
        "query": "SELECT T.thema, T.jahr, T.anzahl_abstimmungsvorlagen\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.thema LIKE '%Religion%' AND anzahl_abstimmungsvorlagen != 0\nORDER BY anzahl_abstimmungsvorlagen DESC\nLIMIT 1;\n"
      },
      {
        "question": "Welches 3 Themen hatten die wenigsten Volksabstimmungen in der Schweiz?",
        "query": "SELECT T.thema, SUM(T.anzahl_abstimmungsvorlagen) as abstimmungsvorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.thema\nORDER BY abstimmungsvorlagen_pro_thema ASC LIMIT 3;\n"
      },
      {
        "question": "Wieviele Abstimmung gab es insgesamt zu Bildungsthemen?",
        "query": "SELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n"
      },
      {
        "question": "Wieviele Abstimmung gab es insgesamt zu Bildungsthemen?",
        "query": "SELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n"
      },
      {
        "question": "Welches Thema hatte die meisten Volksabstimmungen in den Jahren 1990 bis 2000?",
        "query": "SELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wieviele Abstimmung gab es insgesamt zu Bildungsthemen?",
        "query": "SELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n"
      },
      {
        "question": "Wann gab es die erste Volksabstimmungen ueber Sozialpolitik?",
        "query": "SELECT MIN(jahr) as erstes_jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sozialpolitik%';\n"
      },
      {
        "question": "Welches Thema hatte die meisten Volksabstimmungen in den Jahren 1990 bis 2000?",
        "query": "SELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 1;\n"
      },
      {
        "question": "Was war die Anzahl von Volksabstimmungen der Schweiz pro Jahr in den letzten 10 Jahren?",
        "query": "SELECT SUM(T.anzahl_abstimmungsvorlagen) as durchschnittliche_anzahl_abstimmmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.jahr\nORDER BY T.jahr DESC LIMIT 10;\n"
      },
      {
        "question": "Welches Thema hatte die meisten Volksabstimmungen in den Jahren 1990 bis 2000?",
        "query": "SELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 1;\n"
      },
      {
        "question": "Welches 3 Themen hatten die wenigsten Volksabstimmungen in der Schweiz?",
        "query": "SELECT T.thema, SUM(T.anzahl_abstimmungsvorlagen) as abstimmungsvorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.thema\nORDER BY abstimmungsvorlagen_pro_thema ASC LIMIT 3;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.abstimmungsvorlagen_seit_1971 (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tthema TEXT, \n\tanzahl_abstimmungsvorlagen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_pkey PRIMARY KEY (uid), \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in abstimmungsvorlagen_seit_1971 and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2014, 2011, 2013, 2015, 2008\nthema : Sicherheitspolitik, Sozialpolitik, Kultur, Religion, Medien, Umwelt und Lebensraum, Staatsordnung\n*/\n\n/*\nColumn name, Column discription, Example values\nthema, Thema, Aussenpolitik,\u00d6ffentliche Finanzen,Umwelt und Lebensraum\nanzahl_abstimmungsvorlagen, Anzahl Abstimmungsvorlagen, 3\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWelches 3 Themen hatten die wenigsten Volksabstimmungen in der Schweiz?\n### SQL query\nSELECT T.thema, SUM(T.anzahl_abstimmungsvorlagen) as abstimmungsvorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.thema\nORDER BY abstimmungsvorlagen_pro_thema ASC LIMIT 3;\n\n\n### Question\nIn welchem Jahren war die Wirtschaft ein Thema in Volksabstimmungen?\n### SQL query\nSELECT T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.thema LIKE '%Wirtschaft%' AND anzahl_abstimmungsvorlagen != 0\nORDER BY jahr DESC;\n\n\n### Question\nIn welchen Jahren war Sicherheit ein Thema bei Volksabstimmungen?\n### SQL query\nSELECT jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sicherheit%'\nORDER BY jahr DESC;\n\n\n### Question\nIn welchem Jahr gab es die meisten Volksabstimmungen zum Thema Religion in der Schweiz?\n### SQL query\nSELECT T.thema, T.jahr, T.anzahl_abstimmungsvorlagen\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.thema LIKE '%Religion%' AND anzahl_abstimmungsvorlagen != 0\nORDER BY anzahl_abstimmungsvorlagen DESC\nLIMIT 1;\n\n\n### Question\nWelches 3 Themen hatten die wenigsten Volksabstimmungen in der Schweiz?\n### SQL query\nSELECT T.thema, SUM(T.anzahl_abstimmungsvorlagen) as abstimmungsvorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.thema\nORDER BY abstimmungsvorlagen_pro_thema ASC LIMIT 3;\n\n\n### Question\nWieviele Abstimmung gab es insgesamt zu Bildungsthemen?\n### SQL query\nSELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n\n\n### Question\nWieviele Abstimmung gab es insgesamt zu Bildungsthemen?\n### SQL query\nSELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n\n\n### Question\nWelches Thema hatte die meisten Volksabstimmungen in den Jahren 1990 bis 2000?\n### SQL query\nSELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 1;\n\n\n### Question\nWieviele Abstimmung gab es insgesamt zu Bildungsthemen?\n### SQL query\nSELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n\n\n### Question\nWann gab es die erste Volksabstimmungen ueber Sozialpolitik?\n### SQL query\nSELECT MIN(jahr) as erstes_jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sozialpolitik%';\n\n\n### Question\nWelches Thema hatte die meisten Volksabstimmungen in den Jahren 1990 bis 2000?\n### SQL query\nSELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 1;\n\n\n### Question\nWas war die Anzahl von Volksabstimmungen der Schweiz pro Jahr in den letzten 10 Jahren?\n### SQL query\nSELECT SUM(T.anzahl_abstimmungsvorlagen) as durchschnittliche_anzahl_abstimmmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.jahr\nORDER BY T.jahr DESC LIMIT 10;\n\n\n### Question\nWelches Thema hatte die meisten Volksabstimmungen in den Jahren 1990 bis 2000?\n### SQL query\nSELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 1;\n\n\n### Question\nWelches 3 Themen hatten die wenigsten Volksabstimmungen in der Schweiz?\n### SQL query\nSELECT T.thema, SUM(T.anzahl_abstimmungsvorlagen) as abstimmungsvorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.thema\nORDER BY abstimmungsvorlagen_pro_thema ASC LIMIT 3;\n\n\n### Question\nIn welchem Jahren gab es die Volksabstimmungen zum Thema Energie in der Schweiz?\n### SQL query\n",
    "process_time": 8.437929201871157,
    "num_tokens": 2594,
    "hardness": "extra",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 128,
    "question": "Welches Thema hatte die wenigsten Volksabstimmungen in den Jahren 1990 bis 2000?",
    "query": "SELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE' AND anzahl_abstimmungsvorlagen != 0\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema ASC\nLIMIT 1;\n",
    "db_id": "abstimmungsvorlagen_seit_1971",
    "generated_query": "SELECT T.thema, SUM(T.anzahl_abstimmungsvorlagen) as abstimmungsvorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr >= 1990 AND T.jahr <= 2000\nGROUP BY T.thema\nORDER BY abstimmungsvorlagen_pro_thema ASC LIMIT 1;",
    "meta_data": [
      {
        "question": "Welches 3 Themen hatten die wenigsten Volksabstimmungen in der Schweiz?",
        "query": "SELECT T.thema, SUM(T.anzahl_abstimmungsvorlagen) as abstimmungsvorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.thema\nORDER BY abstimmungsvorlagen_pro_thema ASC LIMIT 3;\n"
      },
      {
        "question": "Welches 3 Themen hatten die wenigsten Volksabstimmungen in der Schweiz?",
        "query": "SELECT T.thema, SUM(T.anzahl_abstimmungsvorlagen) as abstimmungsvorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.thema\nORDER BY abstimmungsvorlagen_pro_thema ASC LIMIT 3;\n"
      },
      {
        "question": "Welches Jahr hatte die meisten Volksabstimmungen in der Schweiz?",
        "query": "SELECT T.jahr, SUM(T.anzahl_abstimmungsvorlagen) AS anzahl_abstimmungsvorlagen_pro_jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.jahr\nORDER BY anzahl_abstimmungsvorlagen_pro_jahr LIMIT 1;\n"
      },
      {
        "question": "Welches Jahr hatte die meisten Volksabstimmungen in der Schweiz?",
        "query": "SELECT T.jahr, SUM(T.anzahl_abstimmungsvorlagen) AS anzahl_abstimmungsvorlagen_pro_jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.jahr\nORDER BY anzahl_abstimmungsvorlagen_pro_jahr LIMIT 1;\n"
      },
      {
        "question": "In welchen Jahren war Sicherheit ein Thema bei Volksabstimmungen?",
        "query": "SELECT jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sicherheit%'\nORDER BY jahr DESC;\n"
      },
      {
        "question": "In welchem Jahr gab es die gr\u00f6sste Diversit\u00e4t von Themen bei Volksabstimmungen?",
        "query": "SELECT COUNT(DISTINCT(thema)) as anzahl_themen_pro_jahr, jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE anzahl_abstimmungsvorlagen <> 0\nGROUP BY T.jahr\nORDER BY anzahl_themen_pro_jahr DESC LIMIT 1;\n"
      },
      {
        "question": "Was war die 5 dominantesten Themen bei den Volksabstimmungen \u00fcber die Jahre in der Schweiz?",
        "query": "SELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 5;\n"
      },
      {
        "question": "Wieviele Volksabstimmungen wurden 1995 in der Schweiz durchgef\u00fchrt?",
        "query": "SELECT SUM(T.anzahl_abstimmungsvorlagen) AS gesamt_anzahl_abstimmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '1995' \nGROUP BY T.jahr;\n"
      },
      {
        "question": "Wieviele Volksabstimmungen wurden 1995 in der Schweiz durchgef\u00fchrt?",
        "query": "SELECT SUM(T.anzahl_abstimmungsvorlagen) AS gesamt_anzahl_abstimmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '1995' \nGROUP BY T.jahr;\n"
      },
      {
        "question": "Wieviele Abstimmung gab es insgesamt zu Bildungsthemen?",
        "query": "SELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n"
      },
      {
        "question": "Wieviele Volksabstimmungen wurden 1995 in der Schweiz durchgef\u00fchrt?",
        "query": "SELECT SUM(T.anzahl_abstimmungsvorlagen) AS gesamt_anzahl_abstimmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '1995' \nGROUP BY T.jahr;\n"
      },
      {
        "question": "Wann gab es die erste Volksabstimmungen ueber Sozialpolitik?",
        "query": "SELECT MIN(jahr) as erstes_jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sozialpolitik%';\n"
      },
      {
        "question": "Wieviele Abstimmung gab es insgesamt zu Bildungsthemen?",
        "query": "SELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n"
      },
      {
        "question": "In wievielen Jahren gab es Volksabstimmungen zum Thema Aussenpolitik?",
        "query": "SELECT COUNT(jahr) as anzahl_jahre_aussenpolitik\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Aussenpolitik%';\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.abstimmungsvorlagen_seit_1971 (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tthema TEXT, \n\tanzahl_abstimmungsvorlagen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_pkey PRIMARY KEY (uid), \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in abstimmungsvorlagen_seit_1971 and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2014, 2011, 2013, 2015, 2008\nthema : Sicherheitspolitik, Sozialpolitik, Kultur, Religion, Medien, Umwelt und Lebensraum, Staatsordnung\n*/\n\n/*\nColumn name, Column discription, Example values\nthema, Thema, Aussenpolitik,\u00d6ffentliche Finanzen,Umwelt und Lebensraum\nanzahl_abstimmungsvorlagen, Anzahl Abstimmungsvorlagen, 3\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWelches 3 Themen hatten die wenigsten Volksabstimmungen in der Schweiz?\n### SQL query\nSELECT T.thema, SUM(T.anzahl_abstimmungsvorlagen) as abstimmungsvorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.thema\nORDER BY abstimmungsvorlagen_pro_thema ASC LIMIT 3;\n\n\n### Question\nWelches 3 Themen hatten die wenigsten Volksabstimmungen in der Schweiz?\n### SQL query\nSELECT T.thema, SUM(T.anzahl_abstimmungsvorlagen) as abstimmungsvorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.thema\nORDER BY abstimmungsvorlagen_pro_thema ASC LIMIT 3;\n\n\n### Question\nWelches Jahr hatte die meisten Volksabstimmungen in der Schweiz?\n### SQL query\nSELECT T.jahr, SUM(T.anzahl_abstimmungsvorlagen) AS anzahl_abstimmungsvorlagen_pro_jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.jahr\nORDER BY anzahl_abstimmungsvorlagen_pro_jahr LIMIT 1;\n\n\n### Question\nWelches Jahr hatte die meisten Volksabstimmungen in der Schweiz?\n### SQL query\nSELECT T.jahr, SUM(T.anzahl_abstimmungsvorlagen) AS anzahl_abstimmungsvorlagen_pro_jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.jahr\nORDER BY anzahl_abstimmungsvorlagen_pro_jahr LIMIT 1;\n\n\n### Question\nIn welchen Jahren war Sicherheit ein Thema bei Volksabstimmungen?\n### SQL query\nSELECT jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sicherheit%'\nORDER BY jahr DESC;\n\n\n### Question\nIn welchem Jahr gab es die gr\u00f6sste Diversit\u00e4t von Themen bei Volksabstimmungen?\n### SQL query\nSELECT COUNT(DISTINCT(thema)) as anzahl_themen_pro_jahr, jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE anzahl_abstimmungsvorlagen <> 0\nGROUP BY T.jahr\nORDER BY anzahl_themen_pro_jahr DESC LIMIT 1;\n\n\n### Question\nWas war die 5 dominantesten Themen bei den Volksabstimmungen \u00fcber die Jahre in der Schweiz?\n### SQL query\nSELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 5;\n\n\n### Question\nWieviele Volksabstimmungen wurden 1995 in der Schweiz durchgef\u00fchrt?\n### SQL query\nSELECT SUM(T.anzahl_abstimmungsvorlagen) AS gesamt_anzahl_abstimmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '1995' \nGROUP BY T.jahr;\n\n\n### Question\nWieviele Volksabstimmungen wurden 1995 in der Schweiz durchgef\u00fchrt?\n### SQL query\nSELECT SUM(T.anzahl_abstimmungsvorlagen) AS gesamt_anzahl_abstimmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '1995' \nGROUP BY T.jahr;\n\n\n### Question\nWieviele Abstimmung gab es insgesamt zu Bildungsthemen?\n### SQL query\nSELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n\n\n### Question\nWieviele Volksabstimmungen wurden 1995 in der Schweiz durchgef\u00fchrt?\n### SQL query\nSELECT SUM(T.anzahl_abstimmungsvorlagen) AS gesamt_anzahl_abstimmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '1995' \nGROUP BY T.jahr;\n\n\n### Question\nWann gab es die erste Volksabstimmungen ueber Sozialpolitik?\n### SQL query\nSELECT MIN(jahr) as erstes_jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sozialpolitik%';\n\n\n### Question\nWieviele Abstimmung gab es insgesamt zu Bildungsthemen?\n### SQL query\nSELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n\n\n### Question\nIn wievielen Jahren gab es Volksabstimmungen zum Thema Aussenpolitik?\n### SQL query\nSELECT COUNT(jahr) as anzahl_jahre_aussenpolitik\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Aussenpolitik%';\n\n\n### Question\nWelches Thema hatte die wenigsten Volksabstimmungen in den Jahren 1990 bis 2000?\n### SQL query\n",
    "process_time": 7.185045293066651,
    "num_tokens": 2550,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 129,
    "question": "Wann gab es die letzte Volksabstimmungen zum Thema Forschung?",
    "query": "SELECT MAX(jahr) as jahr_letzte_abstimmung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Forschung%';\n",
    "db_id": "abstimmungsvorlagen_seit_1971",
    "generated_query": "SELECT MAX(jahr) as letztes_jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Forschung%';",
    "meta_data": [
      {
        "question": "Wieviele Abstimmungsvorlagen gab es seit dem Jahr 1971?",
        "query": "SELECT COUNT(*) as anzahl_abstimmungsvorlagen\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE';\n"
      },
      {
        "question": "In welchem Jahr gab es die meisten Volksabstimmungen zum Thema Religion in der Schweiz?",
        "query": "SELECT T.thema, T.jahr, T.anzahl_abstimmungsvorlagen\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.thema LIKE '%Religion%' AND anzahl_abstimmungsvorlagen != 0\nORDER BY anzahl_abstimmungsvorlagen DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wann gab es die erste Volksabstimmungen ueber Sozialpolitik?",
        "query": "SELECT MIN(jahr) as erstes_jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sozialpolitik%';\n"
      },
      {
        "question": "Wieviele Volksabstimmungen wurden 1995 in der Schweiz durchgef\u00fchrt?",
        "query": "SELECT SUM(T.anzahl_abstimmungsvorlagen) AS gesamt_anzahl_abstimmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '1995' \nGROUP BY T.jahr;\n"
      },
      {
        "question": "Welches 3 Themen hatten die wenigsten Volksabstimmungen in der Schweiz?",
        "query": "SELECT T.thema, SUM(T.anzahl_abstimmungsvorlagen) as abstimmungsvorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.thema\nORDER BY abstimmungsvorlagen_pro_thema ASC LIMIT 3;\n"
      },
      {
        "question": "Welches Jahr hatte die meisten Volksabstimmungen in der Schweiz?",
        "query": "SELECT T.jahr, SUM(T.anzahl_abstimmungsvorlagen) AS anzahl_abstimmungsvorlagen_pro_jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.jahr\nORDER BY anzahl_abstimmungsvorlagen_pro_jahr LIMIT 1;\n"
      },
      {
        "question": "Wieviele Abstimmung gab es insgesamt zu Bildungsthemen?",
        "query": "SELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n"
      },
      {
        "question": "Wann gab es die erste Volksabstimmungen ueber Sozialpolitik?",
        "query": "SELECT MIN(jahr) as erstes_jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sozialpolitik%';\n"
      },
      {
        "question": "Wieviele Abstimmung gab es insgesamt zu Bildungsthemen?",
        "query": "SELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n"
      },
      {
        "question": "Welches Jahr hatte die meisten Volksabstimmungen in der Schweiz?",
        "query": "SELECT T.jahr, SUM(T.anzahl_abstimmungsvorlagen) AS anzahl_abstimmungsvorlagen_pro_jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.jahr\nORDER BY anzahl_abstimmungsvorlagen_pro_jahr LIMIT 1;\n"
      },
      {
        "question": "In welchem Jahr gab es die gr\u00f6sste Diversit\u00e4t von Themen bei Volksabstimmungen?",
        "query": "SELECT COUNT(DISTINCT(thema)) as anzahl_themen_pro_jahr, jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE anzahl_abstimmungsvorlagen <> 0\nGROUP BY T.jahr\nORDER BY anzahl_themen_pro_jahr DESC LIMIT 1;\n"
      },
      {
        "question": "Welches 3 Themen hatten die wenigsten Volksabstimmungen in der Schweiz?",
        "query": "SELECT T.thema, SUM(T.anzahl_abstimmungsvorlagen) as abstimmungsvorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.thema\nORDER BY abstimmungsvorlagen_pro_thema ASC LIMIT 3;\n"
      },
      {
        "question": "Welches Thema hatte die meisten Volksabstimmungen in den Jahren 1990 bis 2000?",
        "query": "SELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 1;\n"
      },
      {
        "question": "Was war die 5 dominantesten Themen bei den Volksabstimmungen \u00fcber die Jahre in der Schweiz?",
        "query": "SELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 5;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.abstimmungsvorlagen_seit_1971 (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tthema TEXT, \n\tanzahl_abstimmungsvorlagen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_pkey PRIMARY KEY (uid), \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in abstimmungsvorlagen_seit_1971 and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2014, 2011, 2013, 2015, 2008\nthema : Sicherheitspolitik, Sozialpolitik, Kultur, Religion, Medien, Umwelt und Lebensraum, Staatsordnung\n*/\n\n/*\nColumn name, Column discription, Example values\nthema, Thema, Aussenpolitik,\u00d6ffentliche Finanzen,Umwelt und Lebensraum\nanzahl_abstimmungsvorlagen, Anzahl Abstimmungsvorlagen, 3\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWieviele Abstimmungsvorlagen gab es seit dem Jahr 1971?\n### SQL query\nSELECT COUNT(*) as anzahl_abstimmungsvorlagen\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE';\n\n\n### Question\nIn welchem Jahr gab es die meisten Volksabstimmungen zum Thema Religion in der Schweiz?\n### SQL query\nSELECT T.thema, T.jahr, T.anzahl_abstimmungsvorlagen\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.thema LIKE '%Religion%' AND anzahl_abstimmungsvorlagen != 0\nORDER BY anzahl_abstimmungsvorlagen DESC\nLIMIT 1;\n\n\n### Question\nWann gab es die erste Volksabstimmungen ueber Sozialpolitik?\n### SQL query\nSELECT MIN(jahr) as erstes_jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sozialpolitik%';\n\n\n### Question\nWieviele Volksabstimmungen wurden 1995 in der Schweiz durchgef\u00fchrt?\n### SQL query\nSELECT SUM(T.anzahl_abstimmungsvorlagen) AS gesamt_anzahl_abstimmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '1995' \nGROUP BY T.jahr;\n\n\n### Question\nWelches 3 Themen hatten die wenigsten Volksabstimmungen in der Schweiz?\n### SQL query\nSELECT T.thema, SUM(T.anzahl_abstimmungsvorlagen) as abstimmungsvorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.thema\nORDER BY abstimmungsvorlagen_pro_thema ASC LIMIT 3;\n\n\n### Question\nWelches Jahr hatte die meisten Volksabstimmungen in der Schweiz?\n### SQL query\nSELECT T.jahr, SUM(T.anzahl_abstimmungsvorlagen) AS anzahl_abstimmungsvorlagen_pro_jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.jahr\nORDER BY anzahl_abstimmungsvorlagen_pro_jahr LIMIT 1;\n\n\n### Question\nWieviele Abstimmung gab es insgesamt zu Bildungsthemen?\n### SQL query\nSELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n\n\n### Question\nWann gab es die erste Volksabstimmungen ueber Sozialpolitik?\n### SQL query\nSELECT MIN(jahr) as erstes_jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sozialpolitik%';\n\n\n### Question\nWieviele Abstimmung gab es insgesamt zu Bildungsthemen?\n### SQL query\nSELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n\n\n### Question\nWelches Jahr hatte die meisten Volksabstimmungen in der Schweiz?\n### SQL query\nSELECT T.jahr, SUM(T.anzahl_abstimmungsvorlagen) AS anzahl_abstimmungsvorlagen_pro_jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.jahr\nORDER BY anzahl_abstimmungsvorlagen_pro_jahr LIMIT 1;\n\n\n### Question\nIn welchem Jahr gab es die gr\u00f6sste Diversit\u00e4t von Themen bei Volksabstimmungen?\n### SQL query\nSELECT COUNT(DISTINCT(thema)) as anzahl_themen_pro_jahr, jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE anzahl_abstimmungsvorlagen <> 0\nGROUP BY T.jahr\nORDER BY anzahl_themen_pro_jahr DESC LIMIT 1;\n\n\n### Question\nWelches 3 Themen hatten die wenigsten Volksabstimmungen in der Schweiz?\n### SQL query\nSELECT T.thema, SUM(T.anzahl_abstimmungsvorlagen) as abstimmungsvorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.thema\nORDER BY abstimmungsvorlagen_pro_thema ASC LIMIT 3;\n\n\n### Question\nWelches Thema hatte die meisten Volksabstimmungen in den Jahren 1990 bis 2000?\n### SQL query\nSELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr BETWEEN 1990 AND 2000\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 1;\n\n\n### Question\nWas war die 5 dominantesten Themen bei den Volksabstimmungen \u00fcber die Jahre in der Schweiz?\n### SQL query\nSELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 5;\n\n\n### Question\nWann gab es die letzte Volksabstimmungen zum Thema Forschung?\n### SQL query\n",
    "process_time": 10.30740064708516,
    "num_tokens": 2554,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 130,
    "question": "Wieviele Abstimmungsvorlagen gab es im Jahr 2000?",
    "query": "SELECT COUNT(*) as anzahl_abstimmungsvorlagen_im_jahr_2000\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE' AND T.jahr = 2000;\n",
    "db_id": "abstimmungsvorlagen_seit_1971",
    "generated_query": "SELECT COUNT(*) as anzahl_abstimmungsvorlagen\nFROM abstimmungsvorlagen_seit_1971\nWHERE jahr = 2000;",
    "meta_data": [
      {
        "question": "In welchem Jahr gab es die gr\u00f6sste Diversit\u00e4t von Themen bei Volksabstimmungen?",
        "query": "SELECT COUNT(DISTINCT(thema)) as anzahl_themen_pro_jahr, jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE anzahl_abstimmungsvorlagen <> 0\nGROUP BY T.jahr\nORDER BY anzahl_themen_pro_jahr DESC LIMIT 1;\n"
      },
      {
        "question": "Was war die 5 dominantesten Themen bei den Volksabstimmungen \u00fcber die Jahre in der Schweiz?",
        "query": "SELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 5;\n"
      },
      {
        "question": "Wann gab es die erste Volksabstimmungen ueber Sozialpolitik?",
        "query": "SELECT MIN(jahr) as erstes_jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sozialpolitik%';\n"
      },
      {
        "question": "In welchem Jahr gab es die gr\u00f6sste Diversit\u00e4t von Themen bei Volksabstimmungen?",
        "query": "SELECT COUNT(DISTINCT(thema)) as anzahl_themen_pro_jahr, jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE anzahl_abstimmungsvorlagen <> 0\nGROUP BY T.jahr\nORDER BY anzahl_themen_pro_jahr DESC LIMIT 1;\n"
      },
      {
        "question": "Was war die Anzahl von Volksabstimmungen der Schweiz pro Jahr in den letzten 10 Jahren?",
        "query": "SELECT SUM(T.anzahl_abstimmungsvorlagen) as durchschnittliche_anzahl_abstimmmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.jahr\nORDER BY T.jahr DESC LIMIT 10;\n"
      },
      {
        "question": "In welchem Jahr gab es die meisten Volksabstimmungen zum Thema Religion in der Schweiz?",
        "query": "SELECT T.thema, T.jahr, T.anzahl_abstimmungsvorlagen\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.thema LIKE '%Religion%' AND anzahl_abstimmungsvorlagen != 0\nORDER BY anzahl_abstimmungsvorlagen DESC\nLIMIT 1;\n"
      },
      {
        "question": "Wieviele Abstimmung gab es insgesamt zu Bildungsthemen?",
        "query": "SELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n"
      },
      {
        "question": "In welchem Jahr gab es die gr\u00f6sste Diversit\u00e4t von Themen bei Volksabstimmungen?",
        "query": "SELECT COUNT(DISTINCT(thema)) as anzahl_themen_pro_jahr, jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE anzahl_abstimmungsvorlagen <> 0\nGROUP BY T.jahr\nORDER BY anzahl_themen_pro_jahr DESC LIMIT 1;\n"
      },
      {
        "question": "Wieviele Abstimmung gab es insgesamt zu Bildungsthemen?",
        "query": "SELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n"
      },
      {
        "question": "Welches 3 Themen hatten die wenigsten Volksabstimmungen in der Schweiz?",
        "query": "SELECT T.thema, SUM(T.anzahl_abstimmungsvorlagen) as abstimmungsvorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.thema\nORDER BY abstimmungsvorlagen_pro_thema ASC LIMIT 3;\n"
      },
      {
        "question": "In welchen Jahren war Sicherheit ein Thema bei Volksabstimmungen?",
        "query": "SELECT jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sicherheit%'\nORDER BY jahr DESC;\n"
      },
      {
        "question": "In welchen Jahren war Sicherheit ein Thema bei Volksabstimmungen?",
        "query": "SELECT jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sicherheit%'\nORDER BY jahr DESC;\n"
      },
      {
        "question": "In welchem Jahr gab es die gr\u00f6sste Diversit\u00e4t von Themen bei Volksabstimmungen?",
        "query": "SELECT COUNT(DISTINCT(thema)) as anzahl_themen_pro_jahr, jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE anzahl_abstimmungsvorlagen <> 0\nGROUP BY T.jahr\nORDER BY anzahl_themen_pro_jahr DESC LIMIT 1;\n"
      },
      {
        "question": "Was war die 5 dominantesten Themen bei den Volksabstimmungen \u00fcber die Jahre in der Schweiz?",
        "query": "SELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 5;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.abstimmungsvorlagen_seit_1971 (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tthema TEXT, \n\tanzahl_abstimmungsvorlagen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_pkey PRIMARY KEY (uid), \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in abstimmungsvorlagen_seit_1971 and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2014, 2011, 2013, 2015, 2008\nthema : Sicherheitspolitik, Sozialpolitik, Kultur, Religion, Medien, Umwelt und Lebensraum, Staatsordnung\n*/\n\n/*\nColumn name, Column discription, Example values\nthema, Thema, Aussenpolitik,\u00d6ffentliche Finanzen,Umwelt und Lebensraum\nanzahl_abstimmungsvorlagen, Anzahl Abstimmungsvorlagen, 3\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nIn welchem Jahr gab es die gr\u00f6sste Diversit\u00e4t von Themen bei Volksabstimmungen?\n### SQL query\nSELECT COUNT(DISTINCT(thema)) as anzahl_themen_pro_jahr, jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE anzahl_abstimmungsvorlagen <> 0\nGROUP BY T.jahr\nORDER BY anzahl_themen_pro_jahr DESC LIMIT 1;\n\n\n### Question\nWas war die 5 dominantesten Themen bei den Volksabstimmungen \u00fcber die Jahre in der Schweiz?\n### SQL query\nSELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 5;\n\n\n### Question\nWann gab es die erste Volksabstimmungen ueber Sozialpolitik?\n### SQL query\nSELECT MIN(jahr) as erstes_jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sozialpolitik%';\n\n\n### Question\nIn welchem Jahr gab es die gr\u00f6sste Diversit\u00e4t von Themen bei Volksabstimmungen?\n### SQL query\nSELECT COUNT(DISTINCT(thema)) as anzahl_themen_pro_jahr, jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE anzahl_abstimmungsvorlagen <> 0\nGROUP BY T.jahr\nORDER BY anzahl_themen_pro_jahr DESC LIMIT 1;\n\n\n### Question\nWas war die Anzahl von Volksabstimmungen der Schweiz pro Jahr in den letzten 10 Jahren?\n### SQL query\nSELECT SUM(T.anzahl_abstimmungsvorlagen) as durchschnittliche_anzahl_abstimmmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.jahr\nORDER BY T.jahr DESC LIMIT 10;\n\n\n### Question\nIn welchem Jahr gab es die meisten Volksabstimmungen zum Thema Religion in der Schweiz?\n### SQL query\nSELECT T.thema, T.jahr, T.anzahl_abstimmungsvorlagen\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.thema LIKE '%Religion%' AND anzahl_abstimmungsvorlagen != 0\nORDER BY anzahl_abstimmungsvorlagen DESC\nLIMIT 1;\n\n\n### Question\nWieviele Abstimmung gab es insgesamt zu Bildungsthemen?\n### SQL query\nSELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n\n\n### Question\nIn welchem Jahr gab es die gr\u00f6sste Diversit\u00e4t von Themen bei Volksabstimmungen?\n### SQL query\nSELECT COUNT(DISTINCT(thema)) as anzahl_themen_pro_jahr, jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE anzahl_abstimmungsvorlagen <> 0\nGROUP BY T.jahr\nORDER BY anzahl_themen_pro_jahr DESC LIMIT 1;\n\n\n### Question\nWieviele Abstimmung gab es insgesamt zu Bildungsthemen?\n### SQL query\nSELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n\n\n### Question\nWelches 3 Themen hatten die wenigsten Volksabstimmungen in der Schweiz?\n### SQL query\nSELECT T.thema, SUM(T.anzahl_abstimmungsvorlagen) as abstimmungsvorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.thema\nORDER BY abstimmungsvorlagen_pro_thema ASC LIMIT 3;\n\n\n### Question\nIn welchen Jahren war Sicherheit ein Thema bei Volksabstimmungen?\n### SQL query\nSELECT jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sicherheit%'\nORDER BY jahr DESC;\n\n\n### Question\nIn welchen Jahren war Sicherheit ein Thema bei Volksabstimmungen?\n### SQL query\nSELECT jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sicherheit%'\nORDER BY jahr DESC;\n\n\n### Question\nIn welchem Jahr gab es die gr\u00f6sste Diversit\u00e4t von Themen bei Volksabstimmungen?\n### SQL query\nSELECT COUNT(DISTINCT(thema)) as anzahl_themen_pro_jahr, jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE anzahl_abstimmungsvorlagen <> 0\nGROUP BY T.jahr\nORDER BY anzahl_themen_pro_jahr DESC LIMIT 1;\n\n\n### Question\nWas war die 5 dominantesten Themen bei den Volksabstimmungen \u00fcber die Jahre in der Schweiz?\n### SQL query\nSELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 5;\n\n\n### Question\nWieviele Abstimmungsvorlagen gab es im Jahr 2000?\n### SQL query\n",
    "process_time": 4.893312742002308,
    "num_tokens": 2564,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 131,
    "question": "Wieviele Volksabstimmungen gab es vor dem Jahr 2000 zum Thema Energie?",
    "query": "SELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_energie\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Energie%'\nAND jahr < 2000;\n",
    "db_id": "abstimmungsvorlagen_seit_1971",
    "generated_query": "SELECT COUNT(jahr) as anzahl_jahre_energie\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Energie%'\nAND jahr < 2000;",
    "meta_data": [
      {
        "question": "Welches 3 Themen hatten die wenigsten Volksabstimmungen in der Schweiz?",
        "query": "SELECT T.thema, SUM(T.anzahl_abstimmungsvorlagen) as abstimmungsvorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.thema\nORDER BY abstimmungsvorlagen_pro_thema ASC LIMIT 3;\n"
      },
      {
        "question": "Was war die Anzahl von Volksabstimmungen der Schweiz pro Jahr in den letzten 10 Jahren?",
        "query": "SELECT SUM(T.anzahl_abstimmungsvorlagen) as durchschnittliche_anzahl_abstimmmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.jahr\nORDER BY T.jahr DESC LIMIT 10;\n"
      },
      {
        "question": "In welchen Jahren war Sicherheit ein Thema bei Volksabstimmungen?",
        "query": "SELECT jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sicherheit%'\nORDER BY jahr DESC;\n"
      },
      {
        "question": "Wieviele Abstimmung gab es insgesamt zu Bildungsthemen?",
        "query": "SELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n"
      },
      {
        "question": "Wieviele Abstimmung gab es insgesamt zu Bildungsthemen?",
        "query": "SELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n"
      },
      {
        "question": "Wieviele Volksabstimmungen wurden 1995 in der Schweiz durchgef\u00fchrt?",
        "query": "SELECT SUM(T.anzahl_abstimmungsvorlagen) AS gesamt_anzahl_abstimmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '1995' \nGROUP BY T.jahr;\n"
      },
      {
        "question": "Was war die 5 dominantesten Themen bei den Volksabstimmungen \u00fcber die Jahre in der Schweiz?",
        "query": "SELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 5;\n"
      },
      {
        "question": "In welchem Jahren war die Wirtschaft ein Thema in Volksabstimmungen?",
        "query": "SELECT T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.thema LIKE '%Wirtschaft%' AND anzahl_abstimmungsvorlagen != 0\nORDER BY jahr DESC;\n"
      },
      {
        "question": "In wievielen Jahren gab es Volksabstimmungen zum Thema Aussenpolitik?",
        "query": "SELECT COUNT(jahr) as anzahl_jahre_aussenpolitik\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Aussenpolitik%';\n"
      },
      {
        "question": "Was war die Anzahl von Volksabstimmungen der Schweiz pro Jahr in den letzten 10 Jahren?",
        "query": "SELECT SUM(T.anzahl_abstimmungsvorlagen) as durchschnittliche_anzahl_abstimmmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.jahr\nORDER BY T.jahr DESC LIMIT 10;\n"
      },
      {
        "question": "Wieviele Volksabstimmungen wurden 1995 in der Schweiz durchgef\u00fchrt?",
        "query": "SELECT SUM(T.anzahl_abstimmungsvorlagen) AS gesamt_anzahl_abstimmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '1995' \nGROUP BY T.jahr;\n"
      },
      {
        "question": "Wieviele Abstimmung gab es insgesamt zu Bildungsthemen?",
        "query": "SELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n"
      },
      {
        "question": "Wieviele Abstimmung gab es insgesamt zu Bildungsthemen?",
        "query": "SELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n"
      },
      {
        "question": "Was war die 5 dominantesten Themen bei den Volksabstimmungen \u00fcber die Jahre in der Schweiz?",
        "query": "SELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 5;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.abstimmungsvorlagen_seit_1971 (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tthema TEXT, \n\tanzahl_abstimmungsvorlagen NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_pkey PRIMARY KEY (uid), \n\tCONSTRAINT abstimmungsvorlagen_seit_1971_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in abstimmungsvorlagen_seit_1971 and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2014, 2011, 2013, 2015, 2008\nthema : Sicherheitspolitik, Sozialpolitik, Kultur, Religion, Medien, Umwelt und Lebensraum, Staatsordnung\n*/\n\n/*\nColumn name, Column discription, Example values\nthema, Thema, Aussenpolitik,\u00d6ffentliche Finanzen,Umwelt und Lebensraum\nanzahl_abstimmungsvorlagen, Anzahl Abstimmungsvorlagen, 3\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWelches 3 Themen hatten die wenigsten Volksabstimmungen in der Schweiz?\n### SQL query\nSELECT T.thema, SUM(T.anzahl_abstimmungsvorlagen) as abstimmungsvorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.thema\nORDER BY abstimmungsvorlagen_pro_thema ASC LIMIT 3;\n\n\n### Question\nWas war die Anzahl von Volksabstimmungen der Schweiz pro Jahr in den letzten 10 Jahren?\n### SQL query\nSELECT SUM(T.anzahl_abstimmungsvorlagen) as durchschnittliche_anzahl_abstimmmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.jahr\nORDER BY T.jahr DESC LIMIT 10;\n\n\n### Question\nIn welchen Jahren war Sicherheit ein Thema bei Volksabstimmungen?\n### SQL query\nSELECT jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Sicherheit%'\nORDER BY jahr DESC;\n\n\n### Question\nWieviele Abstimmung gab es insgesamt zu Bildungsthemen?\n### SQL query\nSELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n\n\n### Question\nWieviele Abstimmung gab es insgesamt zu Bildungsthemen?\n### SQL query\nSELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n\n\n### Question\nWieviele Volksabstimmungen wurden 1995 in der Schweiz durchgef\u00fchrt?\n### SQL query\nSELECT SUM(T.anzahl_abstimmungsvorlagen) AS gesamt_anzahl_abstimmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '1995' \nGROUP BY T.jahr;\n\n\n### Question\nWas war die 5 dominantesten Themen bei den Volksabstimmungen \u00fcber die Jahre in der Schweiz?\n### SQL query\nSELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 5;\n\n\n### Question\nIn welchem Jahren war die Wirtschaft ein Thema in Volksabstimmungen?\n### SQL query\nSELECT T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.thema LIKE '%Wirtschaft%' AND anzahl_abstimmungsvorlagen != 0\nORDER BY jahr DESC;\n\n\n### Question\nIn wievielen Jahren gab es Volksabstimmungen zum Thema Aussenpolitik?\n### SQL query\nSELECT COUNT(jahr) as anzahl_jahre_aussenpolitik\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Aussenpolitik%';\n\n\n### Question\nWas war die Anzahl von Volksabstimmungen der Schweiz pro Jahr in den letzten 10 Jahren?\n### SQL query\nSELECT SUM(T.anzahl_abstimmungsvorlagen) as durchschnittliche_anzahl_abstimmmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nGROUP BY T.jahr\nORDER BY T.jahr DESC LIMIT 10;\n\n\n### Question\nWieviele Volksabstimmungen wurden 1995 in der Schweiz durchgef\u00fchrt?\n### SQL query\nSELECT SUM(T.anzahl_abstimmungsvorlagen) AS gesamt_anzahl_abstimmungen, T.jahr\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND jahr = '1995' \nGROUP BY T.jahr;\n\n\n### Question\nWieviele Abstimmung gab es insgesamt zu Bildungsthemen?\n### SQL query\nSELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n\n\n### Question\nWieviele Abstimmung gab es insgesamt zu Bildungsthemen?\n### SQL query\nSELECT SUM(anzahl_abstimmungsvorlagen) as anzahl_abstimmungen_bildung\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND anzahl_abstimmungsvorlagen != 0 AND T.thema LIKE '%Bildung%';\n\n\n### Question\nWas war die 5 dominantesten Themen bei den Volksabstimmungen \u00fcber die Jahre in der Schweiz?\n### SQL query\nSELECT thema, SUM(anzahl_abstimmungsvorlagen) as vorlagen_pro_thema\nFROM abstimmungsvorlagen_seit_1971 as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nGROUP BY thema\nORDER BY vorlagen_pro_thema DESC\nLIMIT 5;\n\n\n### Question\nWieviele Volksabstimmungen gab es vor dem Jahr 2000 zum Thema Energie?\n### SQL query\n",
    "process_time": 5.617067376850173,
    "num_tokens": 2560,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 132,
    "question": "Wie hat sich das Verh\u00e0ltnis Stellen zu Vollzeit\u00e0quivalenten bei den Schweizer \u00c4rzten \u00fcber die Jahre ver\u00e4ndert?",
    "query": "SELECT T.jahr,\n  AVG(T.anzahl_beschaeftigte) / AVG(T.anzahl_vollzeitaquivalente) AS stellenanzahl_pro_vollzeit_aequivalent\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND LOWER(T.rechtsform) LIKE '%total%'\nGROUP BY T.jahr\nORDER BY T.jahr ASC;\n",
    "db_id": "arztpraxen_ambulante_zentren",
    "generated_query": "SELECT jahr,\n  SUM(anzahl_beschaeftigte) AS anzahl_stellen,\n  SUM(anzahl_vollzeitaquivalente) AS anzahl_vollzeitaquivalente\nFROM arztpraxen_ambulante_zentren\nWHERE LOWER(geschlecht) LIKE '%total%'\n  AND LOWER(rechtsform) LIKE '%total%'\nGROUP BY jahr\nORDER BY jahr;",
    "meta_data": [
      {
        "question": "Wieviele \u00c4rzte arbeiteten 2019 im Kanton Z\u00fcrich und wie verteilen sie sich auf Altersklassen?",
        "query": "SELECT SUM(T.anzahl_beschaeftigte) AS anzahl_aerzte_kanton_zurich, T.altersgruppe\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Z\u00fcrich%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2019\nGROUP BY S.name_de, T.altersgruppe\nORDER BY anzahl_aerzte_kanton_zurich DESC;\n"
      },
      {
        "question": "In welchen f\u00fcnf Kantonen hatte es 2021 den gr\u00f6ssten Prozentsatz an \u00c4rzten in Einzelpraxen, wie gross war der Prozentsatz jeweils?",
        "query": "SELECT S.name_de AS kanton,\n  ROUND(100 * SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%total%' THEN anzahl_beschaeftigte ELSE 0 END), 0), 2) as prozent_aerzte_in_einzelpraxen_2021\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY prozent_aerzte_in_einzelpraxen_2021 DESC LIMIT 5;\n"
      },
      {
        "question": "Welcher Kanton hatte 2021 die wenigsten weiblichen \u00c4rzte und wieviele waren es?",
        "query": "SELECT S.name_de AS kanton,\n  SUM(T.anzahl_beschaeftigte) AS anzahl_aerztinnen\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND T.geschlecht = 'Frauen'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY anzahl_aerztinnen ASC LIMIT 1;\n"
      },
      {
        "question": "In welchen f\u00fcnf Kantonen hatte es 2021 den gr\u00f6ssten Prozentsatz an \u00c4rzten in Einzelpraxen, wie gross war der Prozentsatz jeweils?",
        "query": "SELECT S.name_de AS kanton,\n  ROUND(100 * SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%total%' THEN anzahl_beschaeftigte ELSE 0 END), 0), 2) as prozent_aerzte_in_einzelpraxen_2021\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY prozent_aerzte_in_einzelpraxen_2021 DESC LIMIT 5;\n"
      },
      {
        "question": "Wieviel Personen arbeiteten 2021 im Durchschnitt auf einem Vollzeitaquivalent pro Rechtsform? Berechne das Ergebnis getrennt nach Geschlecht",
        "query": "SELECT\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'Frauen' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'Frauen' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS einzelpraxen_aerztinnen_pro_vollzeitequivalent,\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'Frauen' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%andere%' AND T.geschlecht = 'Frauen' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS andere_rechtsformen_aerztinnen_pro_vollzeitequivalent,\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS einzelpraxen_aerzte_pro_vollzeitequivalent,\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%andere%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS andere_rechtsformen_aerzte_pro_vollzeitequivalent\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND T.jahr = 2021;\n"
      },
      {
        "question": "Welcher Kanton hatte 2021 die wenigsten weiblichen \u00c4rzte und wieviele waren es?",
        "query": "SELECT S.name_de AS kanton,\n  SUM(T.anzahl_beschaeftigte) AS anzahl_aerztinnen\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND T.geschlecht = 'Frauen'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY anzahl_aerztinnen ASC LIMIT 1;\n"
      },
      {
        "question": "In welchen f\u00fcnf Kantonen hatte es 2021 den gr\u00f6ssten Prozentsatz an \u00c4rzten in Einzelpraxen, wie gross war der Prozentsatz jeweils?",
        "query": "SELECT S.name_de AS kanton,\n  ROUND(100 * SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%total%' THEN anzahl_beschaeftigte ELSE 0 END), 0), 2) as prozent_aerzte_in_einzelpraxen_2021\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY prozent_aerzte_in_einzelpraxen_2021 DESC LIMIT 5;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.arztpraxen_ambulante_zentren (\n\tuid SERIAL NOT NULL, \n\trechtsform TEXT, \n\tgeschlecht TEXT, \n\taltersgruppe TEXT, \n\tjahr INTEGER, \n\tanzahl_beschaeftigte NUMERIC, \n\tanzahl_vollzeitaquivalente NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT arztpraxen_ambulante_zentren_pkey PRIMARY KEY (uid), \n\tCONSTRAINT arztpraxen_ambulante_zentren_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in arztpraxen_ambulante_zentren and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nanzahl_beschaeftigte : 4963.7100000000000364, 597.6900000000000546, 5027.2299999999995634, 851.4400000000000546, 5206.5600000000004002\nanzahl_vollzeitaquivalente : 413.37000000000000455, 1740.65000000000009095, 5943.63000000000010914, 1755.78999999999996362, 2266.46000000000003638\n*/\n\n/*\nColumn name, Column discription, Example values\nrechtsform, Rechtsform der Praxis, Rechtsform - Total,Einzelunternehmen,Andere Rechtsform\ngeschlecht, Geschlecht, Geschlecht - Total,Mann,Frau\naltersgruppe, Altersklasse, Altersklasse - Total,Unter 45 Jahre,45-54 Jahre\nanzahl_beschaeftigte, Anzahl Besch\u00e4ftigte, None\nanzahl_vollzeitaquivalente, Anzahl Vollzeit\u00e4quivalente, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWieviele \u00c4rzte arbeiteten 2019 im Kanton Z\u00fcrich und wie verteilen sie sich auf Altersklassen?\n### SQL query\nSELECT SUM(T.anzahl_beschaeftigte) AS anzahl_aerzte_kanton_zurich, T.altersgruppe\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Z\u00fcrich%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2019\nGROUP BY S.name_de, T.altersgruppe\nORDER BY anzahl_aerzte_kanton_zurich DESC;\n\n\n### Question\nIn welchen f\u00fcnf Kantonen hatte es 2021 den gr\u00f6ssten Prozentsatz an \u00c4rzten in Einzelpraxen, wie gross war der Prozentsatz jeweils?\n### SQL query\nSELECT S.name_de AS kanton,\n  ROUND(100 * SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%total%' THEN anzahl_beschaeftigte ELSE 0 END), 0), 2) as prozent_aerzte_in_einzelpraxen_2021\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY prozent_aerzte_in_einzelpraxen_2021 DESC LIMIT 5;\n\n\n### Question\nWelcher Kanton hatte 2021 die wenigsten weiblichen \u00c4rzte und wieviele waren es?\n### SQL query\nSELECT S.name_de AS kanton,\n  SUM(T.anzahl_beschaeftigte) AS anzahl_aerztinnen\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND T.geschlecht = 'Frauen'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY anzahl_aerztinnen ASC LIMIT 1;\n\n\n### Question\nIn welchen f\u00fcnf Kantonen hatte es 2021 den gr\u00f6ssten Prozentsatz an \u00c4rzten in Einzelpraxen, wie gross war der Prozentsatz jeweils?\n### SQL query\nSELECT S.name_de AS kanton,\n  ROUND(100 * SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%total%' THEN anzahl_beschaeftigte ELSE 0 END), 0), 2) as prozent_aerzte_in_einzelpraxen_2021\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY prozent_aerzte_in_einzelpraxen_2021 DESC LIMIT 5;\n\n\n### Question\nWieviel Personen arbeiteten 2021 im Durchschnitt auf einem Vollzeitaquivalent pro Rechtsform? Berechne das Ergebnis getrennt nach Geschlecht\n### SQL query\nSELECT\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'Frauen' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'Frauen' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS einzelpraxen_aerztinnen_pro_vollzeitequivalent,\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'Frauen' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%andere%' AND T.geschlecht = 'Frauen' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS andere_rechtsformen_aerztinnen_pro_vollzeitequivalent,\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS einzelpraxen_aerzte_pro_vollzeitequivalent,\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%andere%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS andere_rechtsformen_aerzte_pro_vollzeitequivalent\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND T.jahr = 2021;\n\n\n### Question\nWelcher Kanton hatte 2021 die wenigsten weiblichen \u00c4rzte und wieviele waren es?\n### SQL query\nSELECT S.name_de AS kanton,\n  SUM(T.anzahl_beschaeftigte) AS anzahl_aerztinnen\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND T.geschlecht = 'Frauen'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY anzahl_aerztinnen ASC LIMIT 1;\n\n\n### Question\nIn welchen f\u00fcnf Kantonen hatte es 2021 den gr\u00f6ssten Prozentsatz an \u00c4rzten in Einzelpraxen, wie gross war der Prozentsatz jeweils?\n### SQL query\nSELECT S.name_de AS kanton,\n  ROUND(100 * SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%total%' THEN anzahl_beschaeftigte ELSE 0 END), 0), 2) as prozent_aerzte_in_einzelpraxen_2021\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY prozent_aerzte_in_einzelpraxen_2021 DESC LIMIT 5;\n\n\n### Question\nWie hat sich das Verh\u00e0ltnis Stellen zu Vollzeit\u00e0quivalenten bei den Schweizer \u00c4rzten \u00fcber die Jahre ver\u00e4ndert?\n### SQL query\n",
    "process_time": 6.519628013018519,
    "num_tokens": 2927,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 133,
    "question": "Welche Rechtsform hatte einen Zuwachs an \u00c4rzten zwischen 2017 und 2021 und wie gross war der Zuwachs?",
    "query": "SELECT T.rechtsform,\n  (SUM(CASE WHEN jahr = 2021 THEN T.anzahl_beschaeftigte ELSE 0 END) -\n   SUM(CASE WHEN jahr = 2017 THEN T.anzahl_beschaeftigte ELSE 0 END)) as zuwachs_aerzte_2017_bis_2021\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\n  AND LOWER(T.rechtsform) NOT LIKE '%total%'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND T.jahr IN (2017, 2021)\nGROUP BY T.rechtsform;\n",
    "db_id": "arztpraxen_ambulante_zentren",
    "generated_query": "SELECT T.rechtsform AS rechtsform,\n  SUM(T.anzahl_beschaeftigte) AS zuwachs_aerzte\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND T.jahr >= 2017 AND T.jahr <= 2021\nGROUP BY T.rechtsform\nHAVING SUM(T.anzahl_beschaeftigte) > 0\nORDER BY zuwachs_aerzte DESC;",
    "meta_data": [
      {
        "question": "Wieviel Personen arbeiteten 2021 im Durchschnitt auf einem Vollzeitaquivalent pro Rechtsform? Berechne das Ergebnis getrennt nach Geschlecht",
        "query": "SELECT\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'Frauen' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'Frauen' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS einzelpraxen_aerztinnen_pro_vollzeitequivalent,\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'Frauen' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%andere%' AND T.geschlecht = 'Frauen' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS andere_rechtsformen_aerztinnen_pro_vollzeitequivalent,\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS einzelpraxen_aerzte_pro_vollzeitequivalent,\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%andere%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS andere_rechtsformen_aerzte_pro_vollzeitequivalent\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND T.jahr = 2021;\n"
      },
      {
        "question": "Wieviel Prozent der \u00c4rtze \u00fcber 65 bevorzugten 2021 Einzelpraxen gegen\u00fcber anderen Rechtsformen?",
        "query": "SELECT\n  ROUND(100 * SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%total%' THEN T.anzahl_beschaeftigte ELSE 0 END), 0), 2) as prozentsatz_aerzte_ueber_65_in_einzelpraxen\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.altersgruppe LIKE '%65%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND T.jahr = 2021;\n"
      },
      {
        "question": "Wieviele Besch\u00e4ftigte waren in Artpraxen, die als Einzelunternehmen im Kanton Bern registriert sind, in 2019 t\u00e4tig?",
        "query": "SELECT SUM(anzahl_beschaeftigte) as beschaeftigte_in_einzel_praxen_in_bern_2019\nFROM arztpraxen_ambulante_zentren as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Bern%' AND S.canton = 'TRUE'\nAND T.rechtsform LIKE '%Einzel%' AND T.jahr = 2019;\n"
      },
      {
        "question": "Wieviele Besch\u00e4ftigte waren in Artpraxen, die als Einzelunternehmen im Kanton Bern registriert sind, in 2019 t\u00e4tig?",
        "query": "SELECT SUM(anzahl_beschaeftigte) as beschaeftigte_in_einzel_praxen_in_bern_2019\nFROM arztpraxen_ambulante_zentren as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Bern%' AND S.canton = 'TRUE'\nAND T.rechtsform LIKE '%Einzel%' AND T.jahr = 2019;\n"
      },
      {
        "question": "Wieviel Personen arbeiteten 2021 im Durchschnitt auf einem Vollzeitaquivalent pro Rechtsform? Berechne das Ergebnis getrennt nach Geschlecht",
        "query": "SELECT\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'Frauen' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'Frauen' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS einzelpraxen_aerztinnen_pro_vollzeitequivalent,\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'Frauen' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%andere%' AND T.geschlecht = 'Frauen' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS andere_rechtsformen_aerztinnen_pro_vollzeitequivalent,\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS einzelpraxen_aerzte_pro_vollzeitequivalent,\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%andere%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS andere_rechtsformen_aerzte_pro_vollzeitequivalent\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND T.jahr = 2021;\n"
      },
      {
        "question": "In welchen f\u00fcnf Kantonen hatte es 2021 den gr\u00f6ssten Prozentsatz an \u00c4rzten in Einzelpraxen, wie gross war der Prozentsatz jeweils?",
        "query": "SELECT S.name_de AS kanton,\n  ROUND(100 * SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%total%' THEN anzahl_beschaeftigte ELSE 0 END), 0), 2) as prozent_aerzte_in_einzelpraxen_2021\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY prozent_aerzte_in_einzelpraxen_2021 DESC LIMIT 5;\n"
      },
      {
        "question": "Welcher Kanton hatte 2021 die wenigsten weiblichen \u00c4rzte und wieviele waren es?",
        "query": "SELECT S.name_de AS kanton,\n  SUM(T.anzahl_beschaeftigte) AS anzahl_aerztinnen\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND T.geschlecht = 'Frauen'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY anzahl_aerztinnen ASC LIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.arztpraxen_ambulante_zentren (\n\tuid SERIAL NOT NULL, \n\trechtsform TEXT, \n\tgeschlecht TEXT, \n\taltersgruppe TEXT, \n\tjahr INTEGER, \n\tanzahl_beschaeftigte NUMERIC, \n\tanzahl_vollzeitaquivalente NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT arztpraxen_ambulante_zentren_pkey PRIMARY KEY (uid), \n\tCONSTRAINT arztpraxen_ambulante_zentren_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in arztpraxen_ambulante_zentren and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nanzahl_beschaeftigte : 4963.7100000000000364, 597.6900000000000546, 5027.2299999999995634, 851.4400000000000546, 5206.5600000000004002\nanzahl_vollzeitaquivalente : 413.37000000000000455, 1740.65000000000009095, 5943.63000000000010914, 1755.78999999999996362, 2266.46000000000003638\n*/\n\n/*\nColumn name, Column discription, Example values\nrechtsform, Rechtsform der Praxis, Rechtsform - Total,Einzelunternehmen,Andere Rechtsform\ngeschlecht, Geschlecht, Geschlecht - Total,Mann,Frau\naltersgruppe, Altersklasse, Altersklasse - Total,Unter 45 Jahre,45-54 Jahre\nanzahl_beschaeftigte, Anzahl Besch\u00e4ftigte, None\nanzahl_vollzeitaquivalente, Anzahl Vollzeit\u00e4quivalente, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWieviel Personen arbeiteten 2021 im Durchschnitt auf einem Vollzeitaquivalent pro Rechtsform? Berechne das Ergebnis getrennt nach Geschlecht\n### SQL query\nSELECT\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'Frauen' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'Frauen' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS einzelpraxen_aerztinnen_pro_vollzeitequivalent,\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'Frauen' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%andere%' AND T.geschlecht = 'Frauen' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS andere_rechtsformen_aerztinnen_pro_vollzeitequivalent,\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS einzelpraxen_aerzte_pro_vollzeitequivalent,\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%andere%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS andere_rechtsformen_aerzte_pro_vollzeitequivalent\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND T.jahr = 2021;\n\n\n### Question\nWieviel Prozent der \u00c4rtze \u00fcber 65 bevorzugten 2021 Einzelpraxen gegen\u00fcber anderen Rechtsformen?\n### SQL query\nSELECT\n  ROUND(100 * SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%total%' THEN T.anzahl_beschaeftigte ELSE 0 END), 0), 2) as prozentsatz_aerzte_ueber_65_in_einzelpraxen\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.altersgruppe LIKE '%65%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND T.jahr = 2021;\n\n\n### Question\nWieviele Besch\u00e4ftigte waren in Artpraxen, die als Einzelunternehmen im Kanton Bern registriert sind, in 2019 t\u00e4tig?\n### SQL query\nSELECT SUM(anzahl_beschaeftigte) as beschaeftigte_in_einzel_praxen_in_bern_2019\nFROM arztpraxen_ambulante_zentren as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Bern%' AND S.canton = 'TRUE'\nAND T.rechtsform LIKE '%Einzel%' AND T.jahr = 2019;\n\n\n### Question\nWieviele Besch\u00e4ftigte waren in Artpraxen, die als Einzelunternehmen im Kanton Bern registriert sind, in 2019 t\u00e4tig?\n### SQL query\nSELECT SUM(anzahl_beschaeftigte) as beschaeftigte_in_einzel_praxen_in_bern_2019\nFROM arztpraxen_ambulante_zentren as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Bern%' AND S.canton = 'TRUE'\nAND T.rechtsform LIKE '%Einzel%' AND T.jahr = 2019;\n\n\n### Question\nWieviel Personen arbeiteten 2021 im Durchschnitt auf einem Vollzeitaquivalent pro Rechtsform? Berechne das Ergebnis getrennt nach Geschlecht\n### SQL query\nSELECT\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'Frauen' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'Frauen' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS einzelpraxen_aerztinnen_pro_vollzeitequivalent,\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'Frauen' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%andere%' AND T.geschlecht = 'Frauen' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS andere_rechtsformen_aerztinnen_pro_vollzeitequivalent,\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS einzelpraxen_aerzte_pro_vollzeitequivalent,\n  SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n      NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%andere%' AND T.geschlecht = 'M\u00e4nner' THEN T.anzahl_vollzeitaquivalente ELSE 0 END), 0)\n      AS andere_rechtsformen_aerzte_pro_vollzeitequivalent\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND T.jahr = 2021;\n\n\n### Question\nIn welchen f\u00fcnf Kantonen hatte es 2021 den gr\u00f6ssten Prozentsatz an \u00c4rzten in Einzelpraxen, wie gross war der Prozentsatz jeweils?\n### SQL query\nSELECT S.name_de AS kanton,\n  ROUND(100 * SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%total%' THEN anzahl_beschaeftigte ELSE 0 END), 0), 2) as prozent_aerzte_in_einzelpraxen_2021\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY prozent_aerzte_in_einzelpraxen_2021 DESC LIMIT 5;\n\n\n### Question\nWelcher Kanton hatte 2021 die wenigsten weiblichen \u00c4rzte und wieviele waren es?\n### SQL query\nSELECT S.name_de AS kanton,\n  SUM(T.anzahl_beschaeftigte) AS anzahl_aerztinnen\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND T.geschlecht = 'Frauen'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY anzahl_aerztinnen ASC LIMIT 1;\n\n\n### Question\nWelche Rechtsform hatte einen Zuwachs an \u00c4rzten zwischen 2017 und 2021 und wie gross war der Zuwachs?\n### SQL query\n",
    "process_time": 14.251034470042214,
    "num_tokens": 3112,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 134,
    "question": "Welche drei Kanton hatten 2021 prozentual die meisten jungen \u00c4rzte und \u00c4rztinnen und wieviel Prozent waren es jeweils?",
    "query": "SELECT S.name_de AS kanton,\n  ROUND(100 * SUM(CASE WHEN LOWER(T.altersgruppe) LIKE '%unter%' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.altersgruppe) LIKE '%total%' THEN T.anzahl_beschaeftigte ELSE 0 END), 0), 2)\n        AS prozent_junge_arzte_und_arztinnen\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY prozent_junge_arzte_und_arztinnen DESC LIMIT 3;\n",
    "db_id": "arztpraxen_ambulante_zentren",
    "generated_query": "SELECT S.name_de AS kanton,\n  ROUND(100 * SUM(CASE WHEN LOWER(T.altersgruppe) LIKE '%unter 45%' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.altersgruppe) LIKE '%total%' THEN T.anzahl_beschaeftigte ELSE 0 END), 0), 2)\n        AS prozent_junge_aerzte\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY prozent_junge_aerzte DESC LIMIT 3;",
    "meta_data": [
      {
        "question": "Wieviel Prozent der \u00c4rtze \u00fcber 65 bevorzugten 2021 Einzelpraxen gegen\u00fcber anderen Rechtsformen?",
        "query": "SELECT\n  ROUND(100 * SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%total%' THEN T.anzahl_beschaeftigte ELSE 0 END), 0), 2) as prozentsatz_aerzte_ueber_65_in_einzelpraxen\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.altersgruppe LIKE '%65%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND T.jahr = 2021;\n"
      },
      {
        "question": "Wieviele Besch\u00e4ftigte waren in Artpraxen, die als Einzelunternehmen im Kanton Bern registriert sind, in 2019 t\u00e4tig?",
        "query": "SELECT SUM(anzahl_beschaeftigte) as beschaeftigte_in_einzel_praxen_in_bern_2019\nFROM arztpraxen_ambulante_zentren as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Bern%' AND S.canton = 'TRUE'\nAND T.rechtsform LIKE '%Einzel%' AND T.jahr = 2019;\n"
      },
      {
        "question": "Welcher Kanton hatte 2021 die wenigsten weiblichen \u00c4rzte und wieviele waren es?",
        "query": "SELECT S.name_de AS kanton,\n  SUM(T.anzahl_beschaeftigte) AS anzahl_aerztinnen\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND T.geschlecht = 'Frauen'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY anzahl_aerztinnen ASC LIMIT 1;\n"
      },
      {
        "question": "Wieviele \u00c4rzte arbeiteten 2019 im Kanton Z\u00fcrich und wie verteilen sie sich auf Altersklassen?",
        "query": "SELECT SUM(T.anzahl_beschaeftigte) AS anzahl_aerzte_kanton_zurich, T.altersgruppe\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Z\u00fcrich%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2019\nGROUP BY S.name_de, T.altersgruppe\nORDER BY anzahl_aerzte_kanton_zurich DESC;\n"
      },
      {
        "question": "Welcher Kanton hatte 2017 den gr\u00f6ssten Anteil weiblicher \u00c4rzte in Prozent?",
        "query": "SELECT S.name_de AS kanton,\n  ROUND(100 * SUM(CASE WHEN T.geschlecht = 'Frauen' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.geschlecht) LIKE '%total%' THEN T.anzahl_beschaeftigte ELSE 0 END), 0), 2)\n        AS prozent_weibliche_arzte\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY prozent_weibliche_arzte DESC LIMIT 3;\n"
      },
      {
        "question": "Wieviele \u00c4rzte arbeiteten 2019 im Kanton Z\u00fcrich und wie verteilen sie sich auf Altersklassen?",
        "query": "SELECT SUM(T.anzahl_beschaeftigte) AS anzahl_aerzte_kanton_zurich, T.altersgruppe\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Z\u00fcrich%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2019\nGROUP BY S.name_de, T.altersgruppe\nORDER BY anzahl_aerzte_kanton_zurich DESC;\n"
      },
      {
        "question": "Wieviele Besch\u00e4ftigte waren in Artpraxen, die als Einzelunternehmen im Kanton Bern registriert sind, in 2019 t\u00e4tig?",
        "query": "SELECT SUM(anzahl_beschaeftigte) as beschaeftigte_in_einzel_praxen_in_bern_2019\nFROM arztpraxen_ambulante_zentren as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Bern%' AND S.canton = 'TRUE'\nAND T.rechtsform LIKE '%Einzel%' AND T.jahr = 2019;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.arztpraxen_ambulante_zentren (\n\tuid SERIAL NOT NULL, \n\trechtsform TEXT, \n\tgeschlecht TEXT, \n\taltersgruppe TEXT, \n\tjahr INTEGER, \n\tanzahl_beschaeftigte NUMERIC, \n\tanzahl_vollzeitaquivalente NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT arztpraxen_ambulante_zentren_pkey PRIMARY KEY (uid), \n\tCONSTRAINT arztpraxen_ambulante_zentren_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in arztpraxen_ambulante_zentren and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nanzahl_beschaeftigte : 4963.7100000000000364, 597.6900000000000546, 5027.2299999999995634, 851.4400000000000546, 5206.5600000000004002\nanzahl_vollzeitaquivalente : 413.37000000000000455, 1740.65000000000009095, 5943.63000000000010914, 1755.78999999999996362, 2266.46000000000003638\n*/\n\n/*\nColumn name, Column discription, Example values\nrechtsform, Rechtsform der Praxis, Rechtsform - Total,Einzelunternehmen,Andere Rechtsform\ngeschlecht, Geschlecht, Geschlecht - Total,Mann,Frau\naltersgruppe, Altersklasse, Altersklasse - Total,Unter 45 Jahre,45-54 Jahre\nanzahl_beschaeftigte, Anzahl Besch\u00e4ftigte, None\nanzahl_vollzeitaquivalente, Anzahl Vollzeit\u00e4quivalente, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWieviel Prozent der \u00c4rtze \u00fcber 65 bevorzugten 2021 Einzelpraxen gegen\u00fcber anderen Rechtsformen?\n### SQL query\nSELECT\n  ROUND(100 * SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%einzel%' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.rechtsform) LIKE '%total%' THEN T.anzahl_beschaeftigte ELSE 0 END), 0), 2) as prozentsatz_aerzte_ueber_65_in_einzelpraxen\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.country = 'TRUE'\n  AND T.altersgruppe LIKE '%65%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND T.jahr = 2021;\n\n\n### Question\nWieviele Besch\u00e4ftigte waren in Artpraxen, die als Einzelunternehmen im Kanton Bern registriert sind, in 2019 t\u00e4tig?\n### SQL query\nSELECT SUM(anzahl_beschaeftigte) as beschaeftigte_in_einzel_praxen_in_bern_2019\nFROM arztpraxen_ambulante_zentren as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Bern%' AND S.canton = 'TRUE'\nAND T.rechtsform LIKE '%Einzel%' AND T.jahr = 2019;\n\n\n### Question\nWelcher Kanton hatte 2021 die wenigsten weiblichen \u00c4rzte und wieviele waren es?\n### SQL query\nSELECT S.name_de AS kanton,\n  SUM(T.anzahl_beschaeftigte) AS anzahl_aerztinnen\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND T.geschlecht = 'Frauen'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY anzahl_aerztinnen ASC LIMIT 1;\n\n\n### Question\nWieviele \u00c4rzte arbeiteten 2019 im Kanton Z\u00fcrich und wie verteilen sie sich auf Altersklassen?\n### SQL query\nSELECT SUM(T.anzahl_beschaeftigte) AS anzahl_aerzte_kanton_zurich, T.altersgruppe\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Z\u00fcrich%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2019\nGROUP BY S.name_de, T.altersgruppe\nORDER BY anzahl_aerzte_kanton_zurich DESC;\n\n\n### Question\nWelcher Kanton hatte 2017 den gr\u00f6ssten Anteil weiblicher \u00c4rzte in Prozent?\n### SQL query\nSELECT S.name_de AS kanton,\n  ROUND(100 * SUM(CASE WHEN T.geschlecht = 'Frauen' THEN T.anzahl_beschaeftigte ELSE 0 END) /\n        NULLIF(SUM(CASE WHEN LOWER(T.geschlecht) LIKE '%total%' THEN T.anzahl_beschaeftigte ELSE 0 END), 0), 2)\n        AS prozent_weibliche_arzte\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND LOWER(T.altersgruppe) LIKE '%total%'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2021\nGROUP BY S.name_de\nORDER BY prozent_weibliche_arzte DESC LIMIT 3;\n\n\n### Question\nWieviele \u00c4rzte arbeiteten 2019 im Kanton Z\u00fcrich und wie verteilen sie sich auf Altersklassen?\n### SQL query\nSELECT SUM(T.anzahl_beschaeftigte) AS anzahl_aerzte_kanton_zurich, T.altersgruppe\nFROM arztpraxen_ambulante_zentren AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Z\u00fcrich%'\n  AND LOWER(T.geschlecht) LIKE '%total%'\n  AND LOWER(T.rechtsform) LIKE '%total%'\n  AND T.jahr = 2019\nGROUP BY S.name_de, T.altersgruppe\nORDER BY anzahl_aerzte_kanton_zurich DESC;\n\n\n### Question\nWieviele Besch\u00e4ftigte waren in Artpraxen, die als Einzelunternehmen im Kanton Bern registriert sind, in 2019 t\u00e4tig?\n### SQL query\nSELECT SUM(anzahl_beschaeftigte) as beschaeftigte_in_einzel_praxen_in_bern_2019\nFROM arztpraxen_ambulante_zentren as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Bern%' AND S.canton = 'TRUE'\nAND T.rechtsform LIKE '%Einzel%' AND T.jahr = 2019;\n\n\n### Question\nWelche drei Kanton hatten 2021 prozentual die meisten jungen \u00c4rzte und \u00c4rztinnen und wieviel Prozent waren es jeweils?\n### SQL query\n",
    "process_time": 11.198482451029122,
    "num_tokens": 2340,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 135,
    "question": "In welchen Kantonen stand die Partei SVP 2019 nicht zur Wahl?",
    "query": "SELECT S.name_de AS kanton_ohne_svp_2019\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.partei = 'SVP'\n  AND T.jahr = 2019\n  AND T.parteistarke_in_prozent IS NULL;\n",
    "db_id": "nationalratswahlen",
    "generated_query": "SELECT S.name_de as kanton\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.partei = 'SVP' AND T.jahr = 2019\nAND NOT EXISTS (\n  SELECT *\n  FROM nationalratswahlen as T2\n  WHERE T2.spatialunit_uid = T.spatialunit_uid\n    AND T2.partei = 'SVP' AND T2.jahr = 2019\n)\nAND S.canton = 'TRUE';",
    "meta_data": [
      {
        "question": "In welchem Jahr hatte die FDP das schw\u00e0chste Ergebnis in Prozent im Kanton Appenzell Ausserrhoden? Und wie schwach war es?",
        "query": "SELECT T.jahr, T.parteistarke_in_prozent AS partei_staerke_fdp_appenzell_ausserhoden\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Appenzell Ausserrhoden'\nAND T.partei = 'FDP'\nAND T.parteistarke_in_prozent IS NOT NULL\nORDER BY parteistarke_in_prozent ASC LIMIT 1;\n"
      },
      {
        "question": "In wievielen Kantonen waren die Parteien 2019 jeweils aktiv und bei welcher Parteist\u00e4rke schweizweit?",
        "query": "SELECT T.partei,\n  COUNT(CASE WHEN T.parteistarke_in_prozent IS NOT NULL AND S.canton = 'TRUE' THEN 1 ELSE NULL END) AS anzahl_kantone_wo_partei_aktiv_ist,\n  MAX(CASE WHEN S.country = 'TRUE' THEN T.parteistarke_in_prozent ELSE NULL END) AS parteistarke_schweiz\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2019\n  AND S.canton = 'TRUE' OR S.country = 'TRUE'\nGROUP BY T.partei\nORDER BY anzahl_kantone_wo_partei_aktiv_ist DESC;\n"
      },
      {
        "question": "Welche Parteien standen 2019 im Kanton Glarus zur Wahl und welche prozentuale St\u00e4rke hatten sie?",
        "query": "SELECT T.partei, T.parteistarke_in_prozent\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.parteistarke_in_prozent IS NOT NULL\n  AND T.jahr = 2019\n  AND S.canton = 'TRUE' AND S.name_de LIKE '%Glarus%';\n"
      },
      {
        "question": "Welche Partei hatte 2019 am meisten W\u00e0hler (inklusive fiktive W\u00e4hler) in der Schweiz?",
        "query": "SELECT T.partei AS staerkeste_partei_2019,\n  T.anzahl_fiktive_wahlende\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.partei != '\u00dcbrige'\nAND T.anzahl_fiktive_wahlende IS NOT NULL AND T.jahr = 2019\nORDER BY anzahl_fiktive_wahlende DESC LIMIT 1;\n"
      },
      {
        "question": "Welche Parteien standen 2019 im Kanton Glarus zur Wahl und welche prozentuale St\u00e4rke hatten sie?",
        "query": "SELECT T.partei, T.parteistarke_in_prozent\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.parteistarke_in_prozent IS NOT NULL\n  AND T.jahr = 2019\n  AND S.canton = 'TRUE' AND S.name_de LIKE '%Glarus%';\n"
      },
      {
        "question": "Wann, in welchen Kantonen und welche Partei hatten das beste Ergebnis und wie hoch war es jeweils prozentual? Liste die 5 h\u00f6chsten Ergenisse auf.",
        "query": "SELECT S.name_de as kanton, T.parteistarke_in_prozent, T.jahr, T.partei\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nAND T.parteistarke_in_prozent IS NOT NULL\nORDER BY T.parteistarke_in_prozent DESC LIMIT 5;\n"
      },
      {
        "question": "Welche Partei hatte 2019 am meisten W\u00e0hler (inklusive fiktive W\u00e4hler) in der Schweiz?",
        "query": "SELECT T.partei AS staerkeste_partei_2019,\n  T.anzahl_fiktive_wahlende\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.partei != '\u00dcbrige'\nAND T.anzahl_fiktive_wahlende IS NOT NULL AND T.jahr = 2019\nORDER BY anzahl_fiktive_wahlende DESC LIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.nationalratswahlen (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tpartei TEXT, \n\tanzahl_parteistimmen NUMERIC, \n\tanzahl_fiktive_wahlende NUMERIC, \n\tparteistarke_in_prozent NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT nationalratswahlen_pkey PRIMARY KEY (uid), \n\tCONSTRAINT nationalratswahlen_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in nationalratswahlen and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\npartei : EDU, LdU, EVP, CVP, Sep.\nanzahl_fiktive_wahlende : 34801, 4893, 366313, 132279, 457317\nparteistarke_in_prozent : 0.130000000000000004, 1.889999999999999902, 1.189999999999999947, 5.379999999999999893, 11.650000000000000355\n*/\n\n/*\nColumn name, Column discription, Example values\npartei, Partei, FDP,CVP,SP,Sep.,\u00dcbrige\nanzahl_parteistimmen, Anzahl Parteistimmen, None\nanzahl_fiktive_wahlende, Anzahl fiktive W\u00e4hlende, None\nparteistarke_in_prozent, Parteist\u00e4rke in Prozent, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nIn welchem Jahr hatte die FDP das schw\u00e0chste Ergebnis in Prozent im Kanton Appenzell Ausserrhoden? Und wie schwach war es?\n### SQL query\nSELECT T.jahr, T.parteistarke_in_prozent AS partei_staerke_fdp_appenzell_ausserhoden\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Appenzell Ausserrhoden'\nAND T.partei = 'FDP'\nAND T.parteistarke_in_prozent IS NOT NULL\nORDER BY parteistarke_in_prozent ASC LIMIT 1;\n\n\n### Question\nIn wievielen Kantonen waren die Parteien 2019 jeweils aktiv und bei welcher Parteist\u00e4rke schweizweit?\n### SQL query\nSELECT T.partei,\n  COUNT(CASE WHEN T.parteistarke_in_prozent IS NOT NULL AND S.canton = 'TRUE' THEN 1 ELSE NULL END) AS anzahl_kantone_wo_partei_aktiv_ist,\n  MAX(CASE WHEN S.country = 'TRUE' THEN T.parteistarke_in_prozent ELSE NULL END) AS parteistarke_schweiz\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2019\n  AND S.canton = 'TRUE' OR S.country = 'TRUE'\nGROUP BY T.partei\nORDER BY anzahl_kantone_wo_partei_aktiv_ist DESC;\n\n\n### Question\nWelche Parteien standen 2019 im Kanton Glarus zur Wahl und welche prozentuale St\u00e4rke hatten sie?\n### SQL query\nSELECT T.partei, T.parteistarke_in_prozent\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.parteistarke_in_prozent IS NOT NULL\n  AND T.jahr = 2019\n  AND S.canton = 'TRUE' AND S.name_de LIKE '%Glarus%';\n\n\n### Question\nWelche Partei hatte 2019 am meisten W\u00e0hler (inklusive fiktive W\u00e4hler) in der Schweiz?\n### SQL query\nSELECT T.partei AS staerkeste_partei_2019,\n  T.anzahl_fiktive_wahlende\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.partei != '\u00dcbrige'\nAND T.anzahl_fiktive_wahlende IS NOT NULL AND T.jahr = 2019\nORDER BY anzahl_fiktive_wahlende DESC LIMIT 1;\n\n\n### Question\nWelche Parteien standen 2019 im Kanton Glarus zur Wahl und welche prozentuale St\u00e4rke hatten sie?\n### SQL query\nSELECT T.partei, T.parteistarke_in_prozent\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.parteistarke_in_prozent IS NOT NULL\n  AND T.jahr = 2019\n  AND S.canton = 'TRUE' AND S.name_de LIKE '%Glarus%';\n\n\n### Question\nWann, in welchen Kantonen und welche Partei hatten das beste Ergebnis und wie hoch war es jeweils prozentual? Liste die 5 h\u00f6chsten Ergenisse auf.\n### SQL query\nSELECT S.name_de as kanton, T.parteistarke_in_prozent, T.jahr, T.partei\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nAND T.parteistarke_in_prozent IS NOT NULL\nORDER BY T.parteistarke_in_prozent DESC LIMIT 5;\n\n\n### Question\nWelche Partei hatte 2019 am meisten W\u00e0hler (inklusive fiktive W\u00e4hler) in der Schweiz?\n### SQL query\nSELECT T.partei AS staerkeste_partei_2019,\n  T.anzahl_fiktive_wahlende\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.partei != '\u00dcbrige'\nAND T.anzahl_fiktive_wahlende IS NOT NULL AND T.jahr = 2019\nORDER BY anzahl_fiktive_wahlende DESC LIMIT 1;\n\n\n### Question\nIn welchen Kantonen stand die Partei SVP 2019 nicht zur Wahl?\n### SQL query\n",
    "process_time": 11.162076231092215,
    "num_tokens": 2036,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 136,
    "question": "Welche Partei war 2019 prozentual am st\u00e0rksten in der Schweiz und wie stark war sie?",
    "query": "SELECT T.partei AS staerkste_partei_2019, T.parteistarke_in_prozent\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.parteistarke_in_prozent IS NOT NULL AND T.jahr = 2019\nORDER BY T.parteistarke_in_prozent DESC LIMIT 1;\n",
    "db_id": "nationalratswahlen",
    "generated_query": "SELECT T.partei AS staerkste_partei_2019,\n  T.parteistarke_in_prozent\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.partei != '\u00dcbrige'\nAND T.parteistarke_in_prozent IS NOT NULL AND T.jahr = 2019\nORDER BY parteistarke_in_prozent DESC LIMIT 1;",
    "meta_data": [
      {
        "question": "Welche Partei hatte 2019 am meisten W\u00e0hler (inklusive fiktive W\u00e4hler) in der Schweiz?",
        "query": "SELECT T.partei AS staerkeste_partei_2019,\n  T.anzahl_fiktive_wahlende\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.partei != '\u00dcbrige'\nAND T.anzahl_fiktive_wahlende IS NOT NULL AND T.jahr = 2019\nORDER BY anzahl_fiktive_wahlende DESC LIMIT 1;\n"
      },
      {
        "question": "In welchem Kanton war die FDP 2019 prozentual am st\u00e0rksten und wie stark war sie dort?",
        "query": "SELECT S.name_de as kanton, T.parteistarke_in_prozent AS parteistaerke_fdp_2019\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND partei = 'FDP'\nAND T.parteistarke_in_prozent IS NOT NULL AND T.jahr = 2019\nORDER BY parteistaerke_fdp_2019 DESC LIMIT 1;\n"
      },
      {
        "question": "In wievielen Kantonen waren die Parteien 2019 jeweils aktiv und bei welcher Parteist\u00e4rke schweizweit?",
        "query": "SELECT T.partei,\n  COUNT(CASE WHEN T.parteistarke_in_prozent IS NOT NULL AND S.canton = 'TRUE' THEN 1 ELSE NULL END) AS anzahl_kantone_wo_partei_aktiv_ist,\n  MAX(CASE WHEN S.country = 'TRUE' THEN T.parteistarke_in_prozent ELSE NULL END) AS parteistarke_schweiz\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2019\n  AND S.canton = 'TRUE' OR S.country = 'TRUE'\nGROUP BY T.partei\nORDER BY anzahl_kantone_wo_partei_aktiv_ist DESC;\n"
      },
      {
        "question": "Wann, in welchen Kantonen und welche Partei hatten das beste Ergebnis und wie hoch war es jeweils prozentual? Liste die 5 h\u00f6chsten Ergenisse auf.",
        "query": "SELECT S.name_de as kanton, T.parteistarke_in_prozent, T.jahr, T.partei\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nAND T.parteistarke_in_prozent IS NOT NULL\nORDER BY T.parteistarke_in_prozent DESC LIMIT 5;\n"
      },
      {
        "question": "In wievielen Kantonen waren die Parteien 2019 jeweils aktiv und bei welcher Parteist\u00e4rke schweizweit?",
        "query": "SELECT T.partei,\n  COUNT(CASE WHEN T.parteistarke_in_prozent IS NOT NULL AND S.canton = 'TRUE' THEN 1 ELSE NULL END) AS anzahl_kantone_wo_partei_aktiv_ist,\n  MAX(CASE WHEN S.country = 'TRUE' THEN T.parteistarke_in_prozent ELSE NULL END) AS parteistarke_schweiz\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2019\n  AND S.canton = 'TRUE' OR S.country = 'TRUE'\nGROUP BY T.partei\nORDER BY anzahl_kantone_wo_partei_aktiv_ist DESC;\n"
      },
      {
        "question": "Wann, in welchen Kantonen und welche Partei hatten das beste Ergebnis und wie hoch war es jeweils prozentual? Liste die 5 h\u00f6chsten Ergenisse auf.",
        "query": "SELECT S.name_de as kanton, T.parteistarke_in_prozent, T.jahr, T.partei\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nAND T.parteistarke_in_prozent IS NOT NULL\nORDER BY T.parteistarke_in_prozent DESC LIMIT 5;\n"
      },
      {
        "question": "Welche Partei hatte 2019 am meisten W\u00e0hler (inklusive fiktive W\u00e4hler) in der Schweiz?",
        "query": "SELECT T.partei AS staerkeste_partei_2019,\n  T.anzahl_fiktive_wahlende\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.partei != '\u00dcbrige'\nAND T.anzahl_fiktive_wahlende IS NOT NULL AND T.jahr = 2019\nORDER BY anzahl_fiktive_wahlende DESC LIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.nationalratswahlen (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tpartei TEXT, \n\tanzahl_parteistimmen NUMERIC, \n\tanzahl_fiktive_wahlende NUMERIC, \n\tparteistarke_in_prozent NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT nationalratswahlen_pkey PRIMARY KEY (uid), \n\tCONSTRAINT nationalratswahlen_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in nationalratswahlen and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\npartei : EDU, LdU, EVP, CVP, Sep.\nanzahl_fiktive_wahlende : 34801, 4893, 366313, 132279, 457317\nparteistarke_in_prozent : 0.130000000000000004, 1.889999999999999902, 1.189999999999999947, 5.379999999999999893, 11.650000000000000355\n*/\n\n/*\nColumn name, Column discription, Example values\npartei, Partei, FDP,CVP,SP,Sep.,\u00dcbrige\nanzahl_parteistimmen, Anzahl Parteistimmen, None\nanzahl_fiktive_wahlende, Anzahl fiktive W\u00e4hlende, None\nparteistarke_in_prozent, Parteist\u00e4rke in Prozent, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWelche Partei hatte 2019 am meisten W\u00e0hler (inklusive fiktive W\u00e4hler) in der Schweiz?\n### SQL query\nSELECT T.partei AS staerkeste_partei_2019,\n  T.anzahl_fiktive_wahlende\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.partei != '\u00dcbrige'\nAND T.anzahl_fiktive_wahlende IS NOT NULL AND T.jahr = 2019\nORDER BY anzahl_fiktive_wahlende DESC LIMIT 1;\n\n\n### Question\nIn welchem Kanton war die FDP 2019 prozentual am st\u00e0rksten und wie stark war sie dort?\n### SQL query\nSELECT S.name_de as kanton, T.parteistarke_in_prozent AS parteistaerke_fdp_2019\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND partei = 'FDP'\nAND T.parteistarke_in_prozent IS NOT NULL AND T.jahr = 2019\nORDER BY parteistaerke_fdp_2019 DESC LIMIT 1;\n\n\n### Question\nIn wievielen Kantonen waren die Parteien 2019 jeweils aktiv und bei welcher Parteist\u00e4rke schweizweit?\n### SQL query\nSELECT T.partei,\n  COUNT(CASE WHEN T.parteistarke_in_prozent IS NOT NULL AND S.canton = 'TRUE' THEN 1 ELSE NULL END) AS anzahl_kantone_wo_partei_aktiv_ist,\n  MAX(CASE WHEN S.country = 'TRUE' THEN T.parteistarke_in_prozent ELSE NULL END) AS parteistarke_schweiz\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2019\n  AND S.canton = 'TRUE' OR S.country = 'TRUE'\nGROUP BY T.partei\nORDER BY anzahl_kantone_wo_partei_aktiv_ist DESC;\n\n\n### Question\nWann, in welchen Kantonen und welche Partei hatten das beste Ergebnis und wie hoch war es jeweils prozentual? Liste die 5 h\u00f6chsten Ergenisse auf.\n### SQL query\nSELECT S.name_de as kanton, T.parteistarke_in_prozent, T.jahr, T.partei\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nAND T.parteistarke_in_prozent IS NOT NULL\nORDER BY T.parteistarke_in_prozent DESC LIMIT 5;\n\n\n### Question\nIn wievielen Kantonen waren die Parteien 2019 jeweils aktiv und bei welcher Parteist\u00e4rke schweizweit?\n### SQL query\nSELECT T.partei,\n  COUNT(CASE WHEN T.parteistarke_in_prozent IS NOT NULL AND S.canton = 'TRUE' THEN 1 ELSE NULL END) AS anzahl_kantone_wo_partei_aktiv_ist,\n  MAX(CASE WHEN S.country = 'TRUE' THEN T.parteistarke_in_prozent ELSE NULL END) AS parteistarke_schweiz\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2019\n  AND S.canton = 'TRUE' OR S.country = 'TRUE'\nGROUP BY T.partei\nORDER BY anzahl_kantone_wo_partei_aktiv_ist DESC;\n\n\n### Question\nWann, in welchen Kantonen und welche Partei hatten das beste Ergebnis und wie hoch war es jeweils prozentual? Liste die 5 h\u00f6chsten Ergenisse auf.\n### SQL query\nSELECT S.name_de as kanton, T.parteistarke_in_prozent, T.jahr, T.partei\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nAND T.parteistarke_in_prozent IS NOT NULL\nORDER BY T.parteistarke_in_prozent DESC LIMIT 5;\n\n\n### Question\nWelche Partei hatte 2019 am meisten W\u00e0hler (inklusive fiktive W\u00e4hler) in der Schweiz?\n### SQL query\nSELECT T.partei AS staerkeste_partei_2019,\n  T.anzahl_fiktive_wahlende\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.partei != '\u00dcbrige'\nAND T.anzahl_fiktive_wahlende IS NOT NULL AND T.jahr = 2019\nORDER BY anzahl_fiktive_wahlende DESC LIMIT 1;\n\n\n### Question\nWelche Partei war 2019 prozentual am st\u00e0rksten in der Schweiz und wie stark war sie?\n### SQL query\n",
    "process_time": 7.747733386000618,
    "num_tokens": 2124,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 137,
    "question": "Wann und in welchen Kantonen stand die Partei LEGA zur Wahl und welche Parteist\u00e4rke hatte sie?",
    "query": "SELECT S.name_de AS kanton, T.jahr, T.parteistarke_in_prozent AS parteienstaerke_Lega\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n  AND T.partei = 'Lega'\n  AND T.parteistarke_in_prozent IS NOT NULL\nGROUP BY kanton, T.jahr, T.partei, T.parteistarke_in_prozent\nORDER BY jahr ASC;\n",
    "db_id": "nationalratswahlen",
    "generated_query": "SELECT T.jahr, S.name_de AS kanton, T.parteistarke_in_prozent, T.partei\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.partei = 'LEGA'\nAND T.parteistarke_in_prozent IS NOT NULL\nORDER BY T.jahr, S.name_de;",
    "meta_data": [
      {
        "question": "In welchem Jahr hatte die FDP das schw\u00e0chste Ergebnis in Prozent im Kanton Appenzell Ausserrhoden? Und wie schwach war es?",
        "query": "SELECT T.jahr, T.parteistarke_in_prozent AS partei_staerke_fdp_appenzell_ausserhoden\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Appenzell Ausserrhoden'\nAND T.partei = 'FDP'\nAND T.parteistarke_in_prozent IS NOT NULL\nORDER BY parteistarke_in_prozent ASC LIMIT 1;\n"
      },
      {
        "question": "In welchem Jahr hatte die FDP das schw\u00e0chste Ergebnis in Prozent im Kanton Appenzell Ausserrhoden? Und wie schwach war es?",
        "query": "SELECT T.jahr, T.parteistarke_in_prozent AS partei_staerke_fdp_appenzell_ausserhoden\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Appenzell Ausserrhoden'\nAND T.partei = 'FDP'\nAND T.parteistarke_in_prozent IS NOT NULL\nORDER BY parteistarke_in_prozent ASC LIMIT 1;\n"
      },
      {
        "question": "Welche Partei hatte 2019 am meisten W\u00e0hler (inklusive fiktive W\u00e4hler) in der Schweiz?",
        "query": "SELECT T.partei AS staerkeste_partei_2019,\n  T.anzahl_fiktive_wahlende\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.partei != '\u00dcbrige'\nAND T.anzahl_fiktive_wahlende IS NOT NULL AND T.jahr = 2019\nORDER BY anzahl_fiktive_wahlende DESC LIMIT 1;\n"
      },
      {
        "question": "In welchem Jahr hatte die FDP das schw\u00e0chste Ergebnis in Prozent im Kanton Appenzell Ausserrhoden? Und wie schwach war es?",
        "query": "SELECT T.jahr, T.parteistarke_in_prozent AS partei_staerke_fdp_appenzell_ausserhoden\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Appenzell Ausserrhoden'\nAND T.partei = 'FDP'\nAND T.parteistarke_in_prozent IS NOT NULL\nORDER BY parteistarke_in_prozent ASC LIMIT 1;\n"
      },
      {
        "question": "In wievielen Kantonen waren die Parteien 2019 jeweils aktiv und bei welcher Parteist\u00e4rke schweizweit?",
        "query": "SELECT T.partei,\n  COUNT(CASE WHEN T.parteistarke_in_prozent IS NOT NULL AND S.canton = 'TRUE' THEN 1 ELSE NULL END) AS anzahl_kantone_wo_partei_aktiv_ist,\n  MAX(CASE WHEN S.country = 'TRUE' THEN T.parteistarke_in_prozent ELSE NULL END) AS parteistarke_schweiz\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2019\n  AND S.canton = 'TRUE' OR S.country = 'TRUE'\nGROUP BY T.partei\nORDER BY anzahl_kantone_wo_partei_aktiv_ist DESC;\n"
      },
      {
        "question": "Wann, in welchen Kantonen und welche Partei hatten das beste Ergebnis und wie hoch war es jeweils prozentual? Liste die 5 h\u00f6chsten Ergenisse auf.",
        "query": "SELECT S.name_de as kanton, T.parteistarke_in_prozent, T.jahr, T.partei\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nAND T.parteistarke_in_prozent IS NOT NULL\nORDER BY T.parteistarke_in_prozent DESC LIMIT 5;\n"
      },
      {
        "question": "Welche Partei hatte 2019 am meisten W\u00e0hler (inklusive fiktive W\u00e4hler) in der Schweiz?",
        "query": "SELECT T.partei AS staerkeste_partei_2019,\n  T.anzahl_fiktive_wahlende\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.partei != '\u00dcbrige'\nAND T.anzahl_fiktive_wahlende IS NOT NULL AND T.jahr = 2019\nORDER BY anzahl_fiktive_wahlende DESC LIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.nationalratswahlen (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tpartei TEXT, \n\tanzahl_parteistimmen NUMERIC, \n\tanzahl_fiktive_wahlende NUMERIC, \n\tparteistarke_in_prozent NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT nationalratswahlen_pkey PRIMARY KEY (uid), \n\tCONSTRAINT nationalratswahlen_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in nationalratswahlen and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\npartei : EDU, LdU, EVP, CVP, Sep.\nanzahl_fiktive_wahlende : 34801, 4893, 366313, 132279, 457317\nparteistarke_in_prozent : 0.130000000000000004, 1.889999999999999902, 1.189999999999999947, 5.379999999999999893, 11.650000000000000355\n*/\n\n/*\nColumn name, Column discription, Example values\npartei, Partei, FDP,CVP,SP,Sep.,\u00dcbrige\nanzahl_parteistimmen, Anzahl Parteistimmen, None\nanzahl_fiktive_wahlende, Anzahl fiktive W\u00e4hlende, None\nparteistarke_in_prozent, Parteist\u00e4rke in Prozent, None\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nIn welchem Jahr hatte die FDP das schw\u00e0chste Ergebnis in Prozent im Kanton Appenzell Ausserrhoden? Und wie schwach war es?\n### SQL query\nSELECT T.jahr, T.parteistarke_in_prozent AS partei_staerke_fdp_appenzell_ausserhoden\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Appenzell Ausserrhoden'\nAND T.partei = 'FDP'\nAND T.parteistarke_in_prozent IS NOT NULL\nORDER BY parteistarke_in_prozent ASC LIMIT 1;\n\n\n### Question\nIn welchem Jahr hatte die FDP das schw\u00e0chste Ergebnis in Prozent im Kanton Appenzell Ausserrhoden? Und wie schwach war es?\n### SQL query\nSELECT T.jahr, T.parteistarke_in_prozent AS partei_staerke_fdp_appenzell_ausserhoden\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Appenzell Ausserrhoden'\nAND T.partei = 'FDP'\nAND T.parteistarke_in_prozent IS NOT NULL\nORDER BY parteistarke_in_prozent ASC LIMIT 1;\n\n\n### Question\nWelche Partei hatte 2019 am meisten W\u00e0hler (inklusive fiktive W\u00e4hler) in der Schweiz?\n### SQL query\nSELECT T.partei AS staerkeste_partei_2019,\n  T.anzahl_fiktive_wahlende\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.partei != '\u00dcbrige'\nAND T.anzahl_fiktive_wahlende IS NOT NULL AND T.jahr = 2019\nORDER BY anzahl_fiktive_wahlende DESC LIMIT 1;\n\n\n### Question\nIn welchem Jahr hatte die FDP das schw\u00e0chste Ergebnis in Prozent im Kanton Appenzell Ausserrhoden? Und wie schwach war es?\n### SQL query\nSELECT T.jahr, T.parteistarke_in_prozent AS partei_staerke_fdp_appenzell_ausserhoden\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE' AND S.name_de LIKE '%Appenzell Ausserrhoden'\nAND T.partei = 'FDP'\nAND T.parteistarke_in_prozent IS NOT NULL\nORDER BY parteistarke_in_prozent ASC LIMIT 1;\n\n\n### Question\nIn wievielen Kantonen waren die Parteien 2019 jeweils aktiv und bei welcher Parteist\u00e4rke schweizweit?\n### SQL query\nSELECT T.partei,\n  COUNT(CASE WHEN T.parteistarke_in_prozent IS NOT NULL AND S.canton = 'TRUE' THEN 1 ELSE NULL END) AS anzahl_kantone_wo_partei_aktiv_ist,\n  MAX(CASE WHEN S.country = 'TRUE' THEN T.parteistarke_in_prozent ELSE NULL END) AS parteistarke_schweiz\nFROM nationalratswahlen AS T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE T.jahr = 2019\n  AND S.canton = 'TRUE' OR S.country = 'TRUE'\nGROUP BY T.partei\nORDER BY anzahl_kantone_wo_partei_aktiv_ist DESC;\n\n\n### Question\nWann, in welchen Kantonen und welche Partei hatten das beste Ergebnis und wie hoch war es jeweils prozentual? Liste die 5 h\u00f6chsten Ergenisse auf.\n### SQL query\nSELECT S.name_de as kanton, T.parteistarke_in_prozent, T.jahr, T.partei\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\nAND T.parteistarke_in_prozent IS NOT NULL\nORDER BY T.parteistarke_in_prozent DESC LIMIT 5;\n\n\n### Question\nWelche Partei hatte 2019 am meisten W\u00e0hler (inklusive fiktive W\u00e4hler) in der Schweiz?\n### SQL query\nSELECT T.partei AS staerkeste_partei_2019,\n  T.anzahl_fiktive_wahlende\nFROM nationalratswahlen as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de = 'Schweiz' AND S.country = 'TRUE'\nAND T.partei != '\u00dcbrige'\nAND T.anzahl_fiktive_wahlende IS NOT NULL AND T.jahr = 2019\nORDER BY anzahl_fiktive_wahlende DESC LIMIT 1;\n\n\n### Question\nWann und in welchen Kantonen stand die Partei LEGA zur Wahl und welche Parteist\u00e4rke hatte sie?\n### SQL query\n",
    "process_time": 6.071733301971108,
    "num_tokens": 2118,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 138,
    "question": "Welches sind die verschiedenen Stromverbrauchskategorien in der Schweiz?",
    "query": "SELECT DISTINCT verbrauchskategorie, verbrauchskategorie_beschreibung\nFROM median_strompreis_per_kanton ORDER BY verbrauchskategorie;\n",
    "db_id": "median_strompreis_per_kanton",
    "generated_query": "SELECT DISTINCT(verbrauchskategorie)\nFROM median_strompreis_per_kanton;",
    "meta_data": [
      {
        "question": "Wie hoch waren die Preise f\u00fcr das g\u00fcnstigste verf\u00fcgbare Stromprodukt f\u00fcr alle Unternehmenskategorien im Kanton Genf im Jahr 2012?",
        "query": "SELECT T.verbrauchskategorie, MIN(T.mittlerer_preis_rappen_pro_kwh)\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Genf%'\n    AND S.canton = 'TRUE'\n    AND T.jahr = 2012\n    AND T.verbrauchskategorie LIKE '%C_%'\nGROUP BY T.verbrauchskategorie, T.jahr, T.mittlerer_preis_rappen_pro_kwh\nORDER BY T.mittlerer_preis_rappen_pro_kwh ASC;\n"
      },
      {
        "question": "In welchen Kantonen liegen die Strompreise f\u00fcr die Kategorie der Grossverbraucher im Jahr 2022 unter 13 Rappen pro Kilowattstunde?",
        "query": "SELECT DISTINCT(S.name)\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr = 2022\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr = (SELECT MAX(verbrauchskategorie_grosse_kwh_pro_jahr) FROM median_strompreis_per_kanton)\n    AND T.mittlerer_preis_rappen_pro_kwh < 13;\n"
      },
      {
        "question": "Wie viel zahle ich in CHF f\u00fcr 1000 kWh bei einer 2-Zimmer-Wohnung im Kanton Bern im Jahr 2017?",
        "query": "SELECT T.verbrauchskategorie, T.verbrauchskategorie_beschreibung,\nT.energieprodukt,\nT.mittlerer_preis_rappen_pro_kwh * 1000 / 100 as preis_franken_fur_1000_kwh_bern_2017_2_zimmerwohnung\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Bern%'\n    AND S.canton = 'TRUE'\n    AND T.jahr = 2017\n    AND T.verbrauchskategorie_beschreibung LIKE '%2 - Zimmerwohnung%'\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr >= 1000;\n"
      },
      {
        "question": "In welchen Kantonen liegen die Strompreise f\u00fcr die Kategorie der Grossverbraucher im Jahr 2022 unter 13 Rappen pro Kilowattstunde?",
        "query": "SELECT DISTINCT(S.name)\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr = 2022\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr = (SELECT MAX(verbrauchskategorie_grosse_kwh_pro_jahr) FROM median_strompreis_per_kanton)\n    AND T.mittlerer_preis_rappen_pro_kwh < 13;\n"
      },
      {
        "question": "Welches ist der Kanton mit dem h\u00f6chsten Preis f\u00fcr 1000 kWh im Jahr 2021 f\u00fcr das Standardstromprodukt der Kategorie C3?",
        "query": "SELECT S.name_de as kanton, T.jahr, T.verbrauchskategorie, T.energieprodukt\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr = 2021\n    AND T.energieprodukt = 'Standardprodukt'\n    AND T.verbrauchskategorie = 'C3'\nGROUP BY S.name_de, T.jahr, T.verbrauchskategorie, T.energieprodukt, T.mittlerer_preis_rappen_pro_kwh\nORDER BY T.mittlerer_preis_rappen_pro_kwh DESC LIMIT 1;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.median_strompreis_per_kanton (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tverbrauchskategorie TEXT, \n\tverbrauchskategorie_grosse_kwh_pro_jahr NUMERIC, \n\tverbrauchskategorie_beschreibung TEXT, \n\tenergieprodukt TEXT, \n\tmittlerer_preis_rappen_pro_kwh NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT median_strompreis_per_kanton_pkey PRIMARY KEY (uid), \n\tCONSTRAINT median_strompreis_per_kanton_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in median_strompreis_per_kanton and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nmittlerer_preis_rappen_pro_kwh : 17.5637909999999984, 23.5168900000000001, 26.1568889999999996, 25.3709200000000017, 18.5677909999999997\nspatialunit_uid : 25_A.ADM1, 22_A.ADM1, 2_A.ADM1, 23_A.ADM1, 5_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\nverbrauchskategorie, Verbrauchskategorie, C5,H4,H2\nverbrauchskategorie_beschreibung, Verbrauchskategorie Beschreibung, 4'500 kWh/Jahr: 5-Zimmerwohnung mit Elektroherd und Tumbler (ohne Elektroboiler),7'500 kWh/Jahr: 5-Zimmer-Einfamilienhaus mit Elektroherd' Elektroboiler und Tumbler\nverbrauchskategorie_grosse_kwh_pro_jahr, Verbrauchskategorie Gr\u00f6sse (kwh/jahr), 500000,4500,2500\nenergieprodukt, Energieprodukt, G\u00fcnstigstes Produkt,Standardprodukt\nmittlerer_preis_rappen_pro_kw_hr, Mittlerer Preis in Rappen pro kwh, 17.95067,18.49410,17.25452\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWie hoch waren die Preise f\u00fcr das g\u00fcnstigste verf\u00fcgbare Stromprodukt f\u00fcr alle Unternehmenskategorien im Kanton Genf im Jahr 2012?\n### SQL query\nSELECT T.verbrauchskategorie, MIN(T.mittlerer_preis_rappen_pro_kwh)\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Genf%'\n    AND S.canton = 'TRUE'\n    AND T.jahr = 2012\n    AND T.verbrauchskategorie LIKE '%C_%'\nGROUP BY T.verbrauchskategorie, T.jahr, T.mittlerer_preis_rappen_pro_kwh\nORDER BY T.mittlerer_preis_rappen_pro_kwh ASC;\n\n\n### Question\nIn welchen Kantonen liegen die Strompreise f\u00fcr die Kategorie der Grossverbraucher im Jahr 2022 unter 13 Rappen pro Kilowattstunde?\n### SQL query\nSELECT DISTINCT(S.name)\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr = 2022\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr = (SELECT MAX(verbrauchskategorie_grosse_kwh_pro_jahr) FROM median_strompreis_per_kanton)\n    AND T.mittlerer_preis_rappen_pro_kwh < 13;\n\n\n### Question\nWie viel zahle ich in CHF f\u00fcr 1000 kWh bei einer 2-Zimmer-Wohnung im Kanton Bern im Jahr 2017?\n### SQL query\nSELECT T.verbrauchskategorie, T.verbrauchskategorie_beschreibung,\nT.energieprodukt,\nT.mittlerer_preis_rappen_pro_kwh * 1000 / 100 as preis_franken_fur_1000_kwh_bern_2017_2_zimmerwohnung\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Bern%'\n    AND S.canton = 'TRUE'\n    AND T.jahr = 2017\n    AND T.verbrauchskategorie_beschreibung LIKE '%2 - Zimmerwohnung%'\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr >= 1000;\n\n\n### Question\nIn welchen Kantonen liegen die Strompreise f\u00fcr die Kategorie der Grossverbraucher im Jahr 2022 unter 13 Rappen pro Kilowattstunde?\n### SQL query\nSELECT DISTINCT(S.name)\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr = 2022\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr = (SELECT MAX(verbrauchskategorie_grosse_kwh_pro_jahr) FROM median_strompreis_per_kanton)\n    AND T.mittlerer_preis_rappen_pro_kwh < 13;\n\n\n### Question\nWelches ist der Kanton mit dem h\u00f6chsten Preis f\u00fcr 1000 kWh im Jahr 2021 f\u00fcr das Standardstromprodukt der Kategorie C3?\n### SQL query\nSELECT S.name_de as kanton, T.jahr, T.verbrauchskategorie, T.energieprodukt\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr = 2021\n    AND T.energieprodukt = 'Standardprodukt'\n    AND T.verbrauchskategorie = 'C3'\nGROUP BY S.name_de, T.jahr, T.verbrauchskategorie, T.energieprodukt, T.mittlerer_preis_rappen_pro_kwh\nORDER BY T.mittlerer_preis_rappen_pro_kwh DESC LIMIT 1;\n\n\n### Question\nWelches sind die verschiedenen Stromverbrauchskategorien in der Schweiz?\n### SQL query\n",
    "process_time": 3.0033558951690793,
    "num_tokens": 2046,
    "hardness": "medium",
    "scores": [
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 139,
    "question": "Wie haben sich die Standardstrompreise f\u00fcr kleine Unternehmen im Kanton Neuenburg zwischen 2017 und 2023 entwickelt?",
    "query": "SELECT T.jahr, T.energieprodukt, T.verbrauchskategorie, T.mittlerer_preis_rappen_pro_kwh\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Neuenburg%'\n    AND S.canton = 'TRUE'\n    AND T.jahr >= 2017\n    AND T.jahr <= 2023\n    AND T.energieprodukt = 'Standardprodukt'\n    AND T.verbrauchskategorie_beschreibung LIKE '%Kleinbetrieb%'\nORDER BY T.jahr;\n",
    "db_id": "median_strompreis_per_kanton",
    "generated_query": "SELECT T.jahr, T.mittlerer_preis_rappen_pro_kwh\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Neuenburg%'\n    AND S.canton = 'TRUE'\n    AND T.verbrauchskategorie = 'C5'\n    AND T.jahr BETWEEN 2017 AND 2023\n    AND T.energieprodukt = 'Standardprodukt'\nORDER BY T.jahr;",
    "meta_data": [
      {
        "question": "Wie viel zahle ich in CHF f\u00fcr 1000 kWh bei einer 2-Zimmer-Wohnung im Kanton Bern im Jahr 2017?",
        "query": "SELECT T.verbrauchskategorie, T.verbrauchskategorie_beschreibung,\nT.energieprodukt,\nT.mittlerer_preis_rappen_pro_kwh * 1000 / 100 as preis_franken_fur_1000_kwh_bern_2017_2_zimmerwohnung\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Bern%'\n    AND S.canton = 'TRUE'\n    AND T.jahr = 2017\n    AND T.verbrauchskategorie_beschreibung LIKE '%2 - Zimmerwohnung%'\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr >= 1000;\n"
      },
      {
        "question": "In welchen Kantonen liegen die Strompreise f\u00fcr die Kategorie der Grossverbraucher im Jahr 2022 unter 13 Rappen pro Kilowattstunde?",
        "query": "SELECT DISTINCT(S.name)\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr = 2022\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr = (SELECT MAX(verbrauchskategorie_grosse_kwh_pro_jahr) FROM median_strompreis_per_kanton)\n    AND T.mittlerer_preis_rappen_pro_kwh < 13;\n"
      },
      {
        "question": "Welcher Kanton kann nach den neuesten Informationen den g\u00fcnstigsten Strom f\u00fcr die Kategorie H3 anbieten?",
        "query": "SELECT S.name\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr=(SELECT MAX(jahr) FROM median_strompreis_per_kanton)\n    AND T.verbrauchskategorie = 'H3'\nGROUP BY T.jahr, S.name, T.mittlerer_preis_rappen_pro_kwh\nORDER BY T.mittlerer_preis_rappen_pro_kwh ASC LIMIT 1;\n"
      },
      {
        "question": "Welches ist der Kanton mit dem h\u00f6chsten Preis f\u00fcr 1000 kWh im Jahr 2021 f\u00fcr das Standardstromprodukt der Kategorie C3?",
        "query": "SELECT S.name_de as kanton, T.jahr, T.verbrauchskategorie, T.energieprodukt\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr = 2021\n    AND T.energieprodukt = 'Standardprodukt'\n    AND T.verbrauchskategorie = 'C3'\nGROUP BY S.name_de, T.jahr, T.verbrauchskategorie, T.energieprodukt, T.mittlerer_preis_rappen_pro_kwh\nORDER BY T.mittlerer_preis_rappen_pro_kwh DESC LIMIT 1;\n"
      },
      {
        "question": "In welchen Kantonen liegen die Strompreise f\u00fcr die Kategorie der Grossverbraucher im Jahr 2022 unter 13 Rappen pro Kilowattstunde?",
        "query": "SELECT DISTINCT(S.name)\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr = 2022\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr = (SELECT MAX(verbrauchskategorie_grosse_kwh_pro_jahr) FROM median_strompreis_per_kanton)\n    AND T.mittlerer_preis_rappen_pro_kwh < 13;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.median_strompreis_per_kanton (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tverbrauchskategorie TEXT, \n\tverbrauchskategorie_grosse_kwh_pro_jahr NUMERIC, \n\tverbrauchskategorie_beschreibung TEXT, \n\tenergieprodukt TEXT, \n\tmittlerer_preis_rappen_pro_kwh NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT median_strompreis_per_kanton_pkey PRIMARY KEY (uid), \n\tCONSTRAINT median_strompreis_per_kanton_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in median_strompreis_per_kanton and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nmittlerer_preis_rappen_pro_kwh : 17.5637909999999984, 23.5168900000000001, 26.1568889999999996, 25.3709200000000017, 18.5677909999999997\nspatialunit_uid : 25_A.ADM1, 22_A.ADM1, 2_A.ADM1, 23_A.ADM1, 5_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\nverbrauchskategorie, Verbrauchskategorie, C5,H4,H2\nverbrauchskategorie_beschreibung, Verbrauchskategorie Beschreibung, 4'500 kWh/Jahr: 5-Zimmerwohnung mit Elektroherd und Tumbler (ohne Elektroboiler),7'500 kWh/Jahr: 5-Zimmer-Einfamilienhaus mit Elektroherd' Elektroboiler und Tumbler\nverbrauchskategorie_grosse_kwh_pro_jahr, Verbrauchskategorie Gr\u00f6sse (kwh/jahr), 500000,4500,2500\nenergieprodukt, Energieprodukt, G\u00fcnstigstes Produkt,Standardprodukt\nmittlerer_preis_rappen_pro_kw_hr, Mittlerer Preis in Rappen pro kwh, 17.95067,18.49410,17.25452\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWie viel zahle ich in CHF f\u00fcr 1000 kWh bei einer 2-Zimmer-Wohnung im Kanton Bern im Jahr 2017?\n### SQL query\nSELECT T.verbrauchskategorie, T.verbrauchskategorie_beschreibung,\nT.energieprodukt,\nT.mittlerer_preis_rappen_pro_kwh * 1000 / 100 as preis_franken_fur_1000_kwh_bern_2017_2_zimmerwohnung\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Bern%'\n    AND S.canton = 'TRUE'\n    AND T.jahr = 2017\n    AND T.verbrauchskategorie_beschreibung LIKE '%2 - Zimmerwohnung%'\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr >= 1000;\n\n\n### Question\nIn welchen Kantonen liegen die Strompreise f\u00fcr die Kategorie der Grossverbraucher im Jahr 2022 unter 13 Rappen pro Kilowattstunde?\n### SQL query\nSELECT DISTINCT(S.name)\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr = 2022\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr = (SELECT MAX(verbrauchskategorie_grosse_kwh_pro_jahr) FROM median_strompreis_per_kanton)\n    AND T.mittlerer_preis_rappen_pro_kwh < 13;\n\n\n### Question\nWelcher Kanton kann nach den neuesten Informationen den g\u00fcnstigsten Strom f\u00fcr die Kategorie H3 anbieten?\n### SQL query\nSELECT S.name\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr=(SELECT MAX(jahr) FROM median_strompreis_per_kanton)\n    AND T.verbrauchskategorie = 'H3'\nGROUP BY T.jahr, S.name, T.mittlerer_preis_rappen_pro_kwh\nORDER BY T.mittlerer_preis_rappen_pro_kwh ASC LIMIT 1;\n\n\n### Question\nWelches ist der Kanton mit dem h\u00f6chsten Preis f\u00fcr 1000 kWh im Jahr 2021 f\u00fcr das Standardstromprodukt der Kategorie C3?\n### SQL query\nSELECT S.name_de as kanton, T.jahr, T.verbrauchskategorie, T.energieprodukt\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr = 2021\n    AND T.energieprodukt = 'Standardprodukt'\n    AND T.verbrauchskategorie = 'C3'\nGROUP BY S.name_de, T.jahr, T.verbrauchskategorie, T.energieprodukt, T.mittlerer_preis_rappen_pro_kwh\nORDER BY T.mittlerer_preis_rappen_pro_kwh DESC LIMIT 1;\n\n\n### Question\nIn welchen Kantonen liegen die Strompreise f\u00fcr die Kategorie der Grossverbraucher im Jahr 2022 unter 13 Rappen pro Kilowattstunde?\n### SQL query\nSELECT DISTINCT(S.name)\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr = 2022\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr = (SELECT MAX(verbrauchskategorie_grosse_kwh_pro_jahr) FROM median_strompreis_per_kanton)\n    AND T.mittlerer_preis_rappen_pro_kwh < 13;\n\n\n### Question\nWie haben sich die Standardstrompreise f\u00fcr kleine Unternehmen im Kanton Neuenburg zwischen 2017 und 2023 entwickelt?\n### SQL query\n",
    "process_time": 11.411169186001644,
    "num_tokens": 2028,
    "hardness": "extra",
    "scores": [
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 140,
    "question": "Wie viel zahle ich in CHF f\u00fcr 1000 kWh bei einer 2-Zimmer-Wohnung im Kanton Bern im Jahr 2017?",
    "query": "SELECT T.verbrauchskategorie, T.verbrauchskategorie_beschreibung,\nT.energieprodukt,\nT.mittlerer_preis_rappen_pro_kwh * 1000 / 100 as preis_franken_fur_1000_kwh_bern_2017_2_zimmerwohnung\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Bern%'\n    AND S.canton = 'TRUE'\n    AND T.jahr = 2017\n    AND T.verbrauchskategorie_beschreibung LIKE '%2 - Zimmerwohnung%'\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr >= 1000;\n",
    "db_id": "median_strompreis_per_kanton",
    "generated_query": "SELECT T.verbrauchskategorie, T.verbrauchskategorie_beschreibung,\nT.energieprodukt,\nT.mittlerer_preis_rappen_pro_kwh * 1000 / 100 as preis_franken_fur_1000_kwh_bern_2017_2_zimmerwohnung\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Bern%'\n    AND S.canton = 'TRUE'\n    AND T.jahr = 2017\n    AND T.verbrauchskategorie_beschreibung LIKE '%2 - Zimmerwohnung%'\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr >= 1000;",
    "meta_data": [
      {
        "question": "Welcher Kanton kann nach den neuesten Informationen den g\u00fcnstigsten Strom f\u00fcr die Kategorie H3 anbieten?",
        "query": "SELECT S.name\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr=(SELECT MAX(jahr) FROM median_strompreis_per_kanton)\n    AND T.verbrauchskategorie = 'H3'\nGROUP BY T.jahr, S.name, T.mittlerer_preis_rappen_pro_kwh\nORDER BY T.mittlerer_preis_rappen_pro_kwh ASC LIMIT 1;\n"
      },
      {
        "question": "Wie viel zahle ich in CHF f\u00fcr 1000 kWh bei einer 2-Zimmer-Wohnung im Kanton Bern im Jahr 2017?",
        "query": "SELECT T.verbrauchskategorie, T.verbrauchskategorie_beschreibung,\nT.energieprodukt,\nT.mittlerer_preis_rappen_pro_kwh * 1000 / 100 as preis_franken_fur_1000_kwh_bern_2017_2_zimmerwohnung\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Bern%'\n    AND S.canton = 'TRUE'\n    AND T.jahr = 2017\n    AND T.verbrauchskategorie_beschreibung LIKE '%2 - Zimmerwohnung%'\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr >= 1000;\n"
      },
      {
        "question": "Wie hoch waren die Preise f\u00fcr das g\u00fcnstigste verf\u00fcgbare Stromprodukt f\u00fcr alle Unternehmenskategorien im Kanton Genf im Jahr 2012?",
        "query": "SELECT T.verbrauchskategorie, MIN(T.mittlerer_preis_rappen_pro_kwh)\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Genf%'\n    AND S.canton = 'TRUE'\n    AND T.jahr = 2012\n    AND T.verbrauchskategorie LIKE '%C_%'\nGROUP BY T.verbrauchskategorie, T.jahr, T.mittlerer_preis_rappen_pro_kwh\nORDER BY T.mittlerer_preis_rappen_pro_kwh ASC;\n"
      },
      {
        "question": "Wie viel zahle ich in CHF f\u00fcr 1000 kWh bei einer 2-Zimmer-Wohnung im Kanton Bern im Jahr 2017?",
        "query": "SELECT T.verbrauchskategorie, T.verbrauchskategorie_beschreibung,\nT.energieprodukt,\nT.mittlerer_preis_rappen_pro_kwh * 1000 / 100 as preis_franken_fur_1000_kwh_bern_2017_2_zimmerwohnung\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Bern%'\n    AND S.canton = 'TRUE'\n    AND T.jahr = 2017\n    AND T.verbrauchskategorie_beschreibung LIKE '%2 - Zimmerwohnung%'\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr >= 1000;\n"
      },
      {
        "question": "In welchen Kantonen liegen die Strompreise f\u00fcr die Kategorie der Grossverbraucher im Jahr 2022 unter 13 Rappen pro Kilowattstunde?",
        "query": "SELECT DISTINCT(S.name)\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr = 2022\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr = (SELECT MAX(verbrauchskategorie_grosse_kwh_pro_jahr) FROM median_strompreis_per_kanton)\n    AND T.mittlerer_preis_rappen_pro_kwh < 13;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.median_strompreis_per_kanton (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\tverbrauchskategorie TEXT, \n\tverbrauchskategorie_grosse_kwh_pro_jahr NUMERIC, \n\tverbrauchskategorie_beschreibung TEXT, \n\tenergieprodukt TEXT, \n\tmittlerer_preis_rappen_pro_kwh NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT median_strompreis_per_kanton_pkey PRIMARY KEY (uid), \n\tCONSTRAINT median_strompreis_per_kanton_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.spatial_unit (spatialunit_uid)\n)\n/*\nColumns in median_strompreis_per_kanton and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\nmittlerer_preis_rappen_pro_kwh : 17.5637909999999984, 23.5168900000000001, 26.1568889999999996, 25.3709200000000017, 18.5677909999999997\nspatialunit_uid : 25_A.ADM1, 22_A.ADM1, 2_A.ADM1, 23_A.ADM1, 5_A.ADM1\n*/\n\n/*\nColumn name, Column discription, Example values\nverbrauchskategorie, Verbrauchskategorie, C5,H4,H2\nverbrauchskategorie_beschreibung, Verbrauchskategorie Beschreibung, 4'500 kWh/Jahr: 5-Zimmerwohnung mit Elektroherd und Tumbler (ohne Elektroboiler),7'500 kWh/Jahr: 5-Zimmer-Einfamilienhaus mit Elektroherd' Elektroboiler und Tumbler\nverbrauchskategorie_grosse_kwh_pro_jahr, Verbrauchskategorie Gr\u00f6sse (kwh/jahr), 500000,4500,2500\nenergieprodukt, Energieprodukt, G\u00fcnstigstes Produkt,Standardprodukt\nmittlerer_preis_rappen_pro_kw_hr, Mittlerer Preis in Rappen pro kwh, 17.95067,18.49410,17.25452\n*/\n\n\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\n### Question\nWelcher Kanton kann nach den neuesten Informationen den g\u00fcnstigsten Strom f\u00fcr die Kategorie H3 anbieten?\n### SQL query\nSELECT S.name\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr=(SELECT MAX(jahr) FROM median_strompreis_per_kanton)\n    AND T.verbrauchskategorie = 'H3'\nGROUP BY T.jahr, S.name, T.mittlerer_preis_rappen_pro_kwh\nORDER BY T.mittlerer_preis_rappen_pro_kwh ASC LIMIT 1;\n\n\n### Question\nWie viel zahle ich in CHF f\u00fcr 1000 kWh bei einer 2-Zimmer-Wohnung im Kanton Bern im Jahr 2017?\n### SQL query\nSELECT T.verbrauchskategorie, T.verbrauchskategorie_beschreibung,\nT.energieprodukt,\nT.mittlerer_preis_rappen_pro_kwh * 1000 / 100 as preis_franken_fur_1000_kwh_bern_2017_2_zimmerwohnung\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Bern%'\n    AND S.canton = 'TRUE'\n    AND T.jahr = 2017\n    AND T.verbrauchskategorie_beschreibung LIKE '%2 - Zimmerwohnung%'\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr >= 1000;\n\n\n### Question\nWie hoch waren die Preise f\u00fcr das g\u00fcnstigste verf\u00fcgbare Stromprodukt f\u00fcr alle Unternehmenskategorien im Kanton Genf im Jahr 2012?\n### SQL query\nSELECT T.verbrauchskategorie, MIN(T.mittlerer_preis_rappen_pro_kwh)\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Genf%'\n    AND S.canton = 'TRUE'\n    AND T.jahr = 2012\n    AND T.verbrauchskategorie LIKE '%C_%'\nGROUP BY T.verbrauchskategorie, T.jahr, T.mittlerer_preis_rappen_pro_kwh\nORDER BY T.mittlerer_preis_rappen_pro_kwh ASC;\n\n\n### Question\nWie viel zahle ich in CHF f\u00fcr 1000 kWh bei einer 2-Zimmer-Wohnung im Kanton Bern im Jahr 2017?\n### SQL query\nSELECT T.verbrauchskategorie, T.verbrauchskategorie_beschreibung,\nT.energieprodukt,\nT.mittlerer_preis_rappen_pro_kwh * 1000 / 100 as preis_franken_fur_1000_kwh_bern_2017_2_zimmerwohnung\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.name_de LIKE '%Bern%'\n    AND S.canton = 'TRUE'\n    AND T.jahr = 2017\n    AND T.verbrauchskategorie_beschreibung LIKE '%2 - Zimmerwohnung%'\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr >= 1000;\n\n\n### Question\nIn welchen Kantonen liegen die Strompreise f\u00fcr die Kategorie der Grossverbraucher im Jahr 2022 unter 13 Rappen pro Kilowattstunde?\n### SQL query\nSELECT DISTINCT(S.name)\nFROM median_strompreis_per_kanton as T\nJOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid\nWHERE S.canton = 'TRUE'\n    AND T.jahr = 2022\n    AND T.verbrauchskategorie_grosse_kwh_pro_jahr = (SELECT MAX(verbrauchskategorie_grosse_kwh_pro_jahr) FROM median_strompreis_per_kanton)\n    AND T.mittlerer_preis_rappen_pro_kwh < 13;\n\n\n### Question\nWie viel zahle ich in CHF f\u00fcr 1000 kWh bei einer 2-Zimmer-Wohnung im Kanton Bern im Jahr 2017?\n### SQL query\n",
    "process_time": 15.69183497899212,
    "num_tokens": 2064,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 141,
    "question": "Wie hoch ist der Anteil des Schweizer Budgets, der 2010 und 2020 f\u00fcr die Gesundheit ausgegeben wird?",
    "query": "SELECT jahr, SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_gesundheitswesen\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE aufgabenbereich_cofog_grobgliederung = 'Gesundheitswesen'\n    AND institutioneller_sektor = 'Staat'\n    AND jahr <= 2020\n    AND jahr >= 2010\nGROUP BY jahr\nORDER BY jahr ASC;\n",
    "db_id": "staatsausgaben_nach_aufgabenbereichen_cofog",
    "generated_query": "SELECT jahr, SUM(ausgaben_in_mio_chf) as gesundheitsausgaben_in_mio_chf, \n    SUM(ausgaben_in_mio_chf) / (SELECT SUM(ausgaben_in_mio_chf) FROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE jahr = 2010 OR jahr = 2020) * 100 as anteil_am_budget\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE aufgabenbereich_cofog_grobgliederung = 'Gesundheit'\n    AND (jahr = 2010 OR jahr = 2020)\nGROUP BY jahr;",
    "meta_data": [
      {
        "question": "Wie viel hat jeder institutionelle Sektor im Jahr 2018 f\u00fcr den Umweltschutz ausgegeben?",
        "query": "SELECT SUM(ausgaben_in_mio_chf) as ausgaben_in_mio_chf, institutioneller_sektor\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE jahr = 2018 AND aufgabenbereich_cofog_grobgliederung = 'Umweltschutz'\nGROUP BY institutioneller_sektor\nORDER BY SUM(ausgaben_in_mio_chf) ASC;\n"
      },
      {
        "question": "Wie verteilen sich die kantonalen Bildungsausgaben im Jahr 2010?",
        "query": "SELECT aufgabenbereich_cofog_feingliederung, ausgaben_in_mio_chf as kantonale_ausgaben_in_mio_chf_jahr_2010\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE aufgabenbereich_cofog_grobgliederung = 'Bildungswesen'\n    AND jahr = 2020\n    AND institutioneller_sektor = 'Kantone'\nORDER BY ausgaben_in_mio_chf DESC;\n"
      },
      {
        "question": "Wie viel hat jeder institutionelle Sektor im Jahr 2018 f\u00fcr den Umweltschutz ausgegeben?",
        "query": "SELECT SUM(ausgaben_in_mio_chf) as ausgaben_in_mio_chf, institutioneller_sektor\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE jahr = 2018 AND aufgabenbereich_cofog_grobgliederung = 'Umweltschutz'\nGROUP BY institutioneller_sektor\nORDER BY SUM(ausgaben_in_mio_chf) ASC;\n"
      },
      {
        "question": "Wie hoch waren die religionsbezogenen Ausgaben der Kantone im Jahr ihres H\u00f6chststandes?",
        "query": "SELECT t1.jahr, t1.aufgabenbereich_cofog_feingliederung, t1.ausgaben_in_mio_chf\nFROM staatsausgaben_nach_aufgabenbereichen_cofog AS t1\nINNER JOIN (\n    SELECT jahr, SUM(ausgaben_in_mio_chf) AS tot_spending\n    FROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%religion%'\n      AND institutioneller_sektor = 'Kantone'\n    GROUP BY jahr\n    ORDER BY tot_spending DESC LIMIT 1\n) t2 ON t1.jahr = t2.jahr\nWHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%religion%'\n  AND t1.institutioneller_sektor = 'Kantone';\n"
      },
      {
        "question": "Wie viel hat jeder institutionelle Sektor im Jahr 2018 f\u00fcr den Umweltschutz ausgegeben?",
        "query": "SELECT SUM(ausgaben_in_mio_chf) as ausgaben_in_mio_chf, institutioneller_sektor\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE jahr = 2018 AND aufgabenbereich_cofog_grobgliederung = 'Umweltschutz'\nGROUP BY institutioneller_sektor\nORDER BY SUM(ausgaben_in_mio_chf) ASC;\n"
      },
      {
        "question": "Wie hoch waren die Mittel f\u00fcr die Polizei im Vergleich zu denen f\u00fcr die Feuerwehr im Jahr 2020?",
        "query": "SELECT ausgaben_in_mio_chf, aufgabenbereich_cofog_feingliederung\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE (\n    LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%polizei%'\n    OR LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%feuerwehr%'\n)\n    AND jahr = 2020\n    AND institutioneller_sektor = 'Staat';\n"
      },
      {
        "question": "Wie verteilen sich die kantonalen Bildungsausgaben im Jahr 2010?",
        "query": "SELECT aufgabenbereich_cofog_feingliederung, ausgaben_in_mio_chf as kantonale_ausgaben_in_mio_chf_jahr_2010\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE aufgabenbereich_cofog_grobgliederung = 'Bildungswesen'\n    AND jahr = 2020\n    AND institutioneller_sektor = 'Kantone'\nORDER BY ausgaben_in_mio_chf DESC;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.staatsausgaben_nach_aufgabenbereichen_cofog (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\taufgabenbereich_cofog_feingliederung TEXT, \n\taufgabenbereich_cofog_grobgliederung TEXT, \n\tinstitutioneller_sektor TEXT, \n\tausgaben_in_mio_chf NUMERIC, \n\tprozent_der_gesamtausgaben NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT staatsausgaben_nach_aufgabenbereichen_cofog_pkey PRIMARY KEY (uid), \n\tCONSTRAINT staatsausgaben_nach_aufgabenbereichen_cofo_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in staatsausgaben_nach_aufgabenbereichen_cofog and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2015, 2000, 2009, 2012, 2019\nausgaben_in_mio_chf : 2961, 2474, 9734, 5062, 3828\nprozent_der_gesamtausgaben : 0.20000000000000001, 6.00000000000000000, 3.29999999999999982, 4.00000000000000000, 3.10000000000000009\n*/\n\n/*\nColumn name, Column discription, Example values\naufgabenbereich_cofog_feingliederung, Aufgabenbereich des Staates (COFOG Feingliederung), Alter,Wasserversorgung,Polizei\naufgabenbereich_cofog_grobgliederung, Aufgabenbereich des Staates (COFOG Grobgliederung), Umweltschutz,Bildungswesen,Freizeitgestaltung, Sport, Kultur und Religion\ninstitutioneller_sektor, institutioneller Sektor, Staat,Kantone,Bund,Gemeinden,\u00d6ffentliche Sozialversicherungen\nausgaben_in_mio_chf, Ausgaben in Millionen CHF, None\nprozent_der_gesamtausgaben, Prozent der Gesamtaugaben, None\n*/\n\n\n\n### Question\nWie viel hat jeder institutionelle Sektor im Jahr 2018 f\u00fcr den Umweltschutz ausgegeben?\n### SQL query\nSELECT SUM(ausgaben_in_mio_chf) as ausgaben_in_mio_chf, institutioneller_sektor\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE jahr = 2018 AND aufgabenbereich_cofog_grobgliederung = 'Umweltschutz'\nGROUP BY institutioneller_sektor\nORDER BY SUM(ausgaben_in_mio_chf) ASC;\n\n\n### Question\nWie verteilen sich die kantonalen Bildungsausgaben im Jahr 2010?\n### SQL query\nSELECT aufgabenbereich_cofog_feingliederung, ausgaben_in_mio_chf as kantonale_ausgaben_in_mio_chf_jahr_2010\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE aufgabenbereich_cofog_grobgliederung = 'Bildungswesen'\n    AND jahr = 2020\n    AND institutioneller_sektor = 'Kantone'\nORDER BY ausgaben_in_mio_chf DESC;\n\n\n### Question\nWie viel hat jeder institutionelle Sektor im Jahr 2018 f\u00fcr den Umweltschutz ausgegeben?\n### SQL query\nSELECT SUM(ausgaben_in_mio_chf) as ausgaben_in_mio_chf, institutioneller_sektor\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE jahr = 2018 AND aufgabenbereich_cofog_grobgliederung = 'Umweltschutz'\nGROUP BY institutioneller_sektor\nORDER BY SUM(ausgaben_in_mio_chf) ASC;\n\n\n### Question\nWie hoch waren die religionsbezogenen Ausgaben der Kantone im Jahr ihres H\u00f6chststandes?\n### SQL query\nSELECT t1.jahr, t1.aufgabenbereich_cofog_feingliederung, t1.ausgaben_in_mio_chf\nFROM staatsausgaben_nach_aufgabenbereichen_cofog AS t1\nINNER JOIN (\n    SELECT jahr, SUM(ausgaben_in_mio_chf) AS tot_spending\n    FROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%religion%'\n      AND institutioneller_sektor = 'Kantone'\n    GROUP BY jahr\n    ORDER BY tot_spending DESC LIMIT 1\n) t2 ON t1.jahr = t2.jahr\nWHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%religion%'\n  AND t1.institutioneller_sektor = 'Kantone';\n\n\n### Question\nWie viel hat jeder institutionelle Sektor im Jahr 2018 f\u00fcr den Umweltschutz ausgegeben?\n### SQL query\nSELECT SUM(ausgaben_in_mio_chf) as ausgaben_in_mio_chf, institutioneller_sektor\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE jahr = 2018 AND aufgabenbereich_cofog_grobgliederung = 'Umweltschutz'\nGROUP BY institutioneller_sektor\nORDER BY SUM(ausgaben_in_mio_chf) ASC;\n\n\n### Question\nWie hoch waren die Mittel f\u00fcr die Polizei im Vergleich zu denen f\u00fcr die Feuerwehr im Jahr 2020?\n### SQL query\nSELECT ausgaben_in_mio_chf, aufgabenbereich_cofog_feingliederung\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE (\n    LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%polizei%'\n    OR LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%feuerwehr%'\n)\n    AND jahr = 2020\n    AND institutioneller_sektor = 'Staat';\n\n\n### Question\nWie verteilen sich die kantonalen Bildungsausgaben im Jahr 2010?\n### SQL query\nSELECT aufgabenbereich_cofog_feingliederung, ausgaben_in_mio_chf as kantonale_ausgaben_in_mio_chf_jahr_2010\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE aufgabenbereich_cofog_grobgliederung = 'Bildungswesen'\n    AND jahr = 2020\n    AND institutioneller_sektor = 'Kantone'\nORDER BY ausgaben_in_mio_chf DESC;\n\n\n### Question\nWie hoch ist der Anteil des Schweizer Budgets, der 2010 und 2020 f\u00fcr die Gesundheit ausgegeben wird?\n### SQL query\n",
    "process_time": 10.272526127053425,
    "num_tokens": 2174,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 142,
    "question": "Welches waren die 3 gr\u00f6ssten Ausgabenquellen des Bundes im Jahr 2021 und wie hoch waren diese?",
    "query": "SELECT SUM(ausgaben_in_mio_chf) as ausgaben_in_mio_chf,\n  aufgabenbereich_cofog_feingliederung as ausgaben_bereich_mit_den_hoechsten_ausgaben_2020\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE institutioneller_sektor = 'Bund' AND jahr = 2020\nGROUP BY aufgabenbereich_cofog_feingliederung\nORDER BY SUM(ausgaben_in_mio_chf) DESC LIMIT 3;\n",
    "db_id": "staatsausgaben_nach_aufgabenbereichen_cofog",
    "generated_query": "SELECT aufgabenbereich_cofog_grobgliederung as ausgaben_quelle, SUM(ausgaben_in_mio_chf) as ausgaben_in_mio_chf\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE institutioneller_sektor = 'Bund' AND jahr = 2021\nGROUP BY aufgabenbereich_cofog_grobgliederung\nORDER BY ausgaben_in_mio_chf DESC LIMIT 3;",
    "meta_data": [
      {
        "question": "Wie viel Prozent des Staat Budgets gab im Jahr 2021 fur Bildung aus?",
        "query": "SELECT SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_bildung\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE institutioneller_sektor = 'Staat'\n    AND jahr = 2021\n    AND aufgabenbereich_cofog_grobgliederung = 'Bildungswesen';\n"
      },
      {
        "question": "Welche Teilung hatte im Jahr 2020 die h\u00f6chsten Staatsausgaben?",
        "query": "SELECT aufgabenbereich_cofog_grobgliederung as ausgaben_bereich_mit_den_hoechsten_ausgaben_2020\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE institutioneller_sektor = 'Staat' AND jahr = 2020\nGROUP BY aufgabenbereich_cofog_grobgliederung\nORDER BY SUM(ausgaben_in_mio_chf) DESC LIMIT 1;\n"
      },
      {
        "question": "Wie hoch war der Anteil des Gemeinde Budgets, der seit 2011 f\u00fcr Kommunikation bereitgestellt wurde?",
        "query": "SELECT jahr, SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_kommunikation_in_landgemeinden\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%kommunikation%'\n    AND institutioneller_sektor = 'Gemeinden'\n    AND jahr >= 2011\nGROUP BY jahr\nORDER BY jahr ASC;\n"
      },
      {
        "question": "Wie hoch waren die religionsbezogenen Ausgaben der Kantone im Jahr ihres H\u00f6chststandes?",
        "query": "SELECT t1.jahr, t1.aufgabenbereich_cofog_feingliederung, t1.ausgaben_in_mio_chf\nFROM staatsausgaben_nach_aufgabenbereichen_cofog AS t1\nINNER JOIN (\n    SELECT jahr, SUM(ausgaben_in_mio_chf) AS tot_spending\n    FROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%religion%'\n      AND institutioneller_sektor = 'Kantone'\n    GROUP BY jahr\n    ORDER BY tot_spending DESC LIMIT 1\n) t2 ON t1.jahr = t2.jahr\nWHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%religion%'\n  AND t1.institutioneller_sektor = 'Kantone';\n"
      },
      {
        "question": "Wie hoch war der Anteil des Gemeinde Budgets, der seit 2011 f\u00fcr Kommunikation bereitgestellt wurde?",
        "query": "SELECT jahr, SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_kommunikation_in_landgemeinden\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%kommunikation%'\n    AND institutioneller_sektor = 'Gemeinden'\n    AND jahr >= 2011\nGROUP BY jahr\nORDER BY jahr ASC;\n"
      },
      {
        "question": "Wie hoch waren die Mittel f\u00fcr die Polizei im Vergleich zu denen f\u00fcr die Feuerwehr im Jahr 2020?",
        "query": "SELECT ausgaben_in_mio_chf, aufgabenbereich_cofog_feingliederung\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE (\n    LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%polizei%'\n    OR LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%feuerwehr%'\n)\n    AND jahr = 2020\n    AND institutioneller_sektor = 'Staat';\n"
      },
      {
        "question": "Wie hoch war der Anteil des Gemeinde Budgets, der seit 2011 f\u00fcr Kommunikation bereitgestellt wurde?",
        "query": "SELECT jahr, SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_kommunikation_in_landgemeinden\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%kommunikation%'\n    AND institutioneller_sektor = 'Gemeinden'\n    AND jahr >= 2011\nGROUP BY jahr\nORDER BY jahr ASC;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.staatsausgaben_nach_aufgabenbereichen_cofog (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\taufgabenbereich_cofog_feingliederung TEXT, \n\taufgabenbereich_cofog_grobgliederung TEXT, \n\tinstitutioneller_sektor TEXT, \n\tausgaben_in_mio_chf NUMERIC, \n\tprozent_der_gesamtausgaben NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT staatsausgaben_nach_aufgabenbereichen_cofog_pkey PRIMARY KEY (uid), \n\tCONSTRAINT staatsausgaben_nach_aufgabenbereichen_cofo_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in staatsausgaben_nach_aufgabenbereichen_cofog and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2015, 2000, 2009, 2012, 2019\nausgaben_in_mio_chf : 2961, 2474, 9734, 5062, 3828\nprozent_der_gesamtausgaben : 0.20000000000000001, 6.00000000000000000, 3.29999999999999982, 4.00000000000000000, 3.10000000000000009\n*/\n\n/*\nColumn name, Column discription, Example values\naufgabenbereich_cofog_feingliederung, Aufgabenbereich des Staates (COFOG Feingliederung), Alter,Wasserversorgung,Polizei\naufgabenbereich_cofog_grobgliederung, Aufgabenbereich des Staates (COFOG Grobgliederung), Umweltschutz,Bildungswesen,Freizeitgestaltung, Sport, Kultur und Religion\ninstitutioneller_sektor, institutioneller Sektor, Staat,Kantone,Bund,Gemeinden,\u00d6ffentliche Sozialversicherungen\nausgaben_in_mio_chf, Ausgaben in Millionen CHF, None\nprozent_der_gesamtausgaben, Prozent der Gesamtaugaben, None\n*/\n\n\n\n### Question\nWie viel Prozent des Staat Budgets gab im Jahr 2021 fur Bildung aus?\n### SQL query\nSELECT SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_bildung\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE institutioneller_sektor = 'Staat'\n    AND jahr = 2021\n    AND aufgabenbereich_cofog_grobgliederung = 'Bildungswesen';\n\n\n### Question\nWelche Teilung hatte im Jahr 2020 die h\u00f6chsten Staatsausgaben?\n### SQL query\nSELECT aufgabenbereich_cofog_grobgliederung as ausgaben_bereich_mit_den_hoechsten_ausgaben_2020\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE institutioneller_sektor = 'Staat' AND jahr = 2020\nGROUP BY aufgabenbereich_cofog_grobgliederung\nORDER BY SUM(ausgaben_in_mio_chf) DESC LIMIT 1;\n\n\n### Question\nWie hoch war der Anteil des Gemeinde Budgets, der seit 2011 f\u00fcr Kommunikation bereitgestellt wurde?\n### SQL query\nSELECT jahr, SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_kommunikation_in_landgemeinden\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%kommunikation%'\n    AND institutioneller_sektor = 'Gemeinden'\n    AND jahr >= 2011\nGROUP BY jahr\nORDER BY jahr ASC;\n\n\n### Question\nWie hoch waren die religionsbezogenen Ausgaben der Kantone im Jahr ihres H\u00f6chststandes?\n### SQL query\nSELECT t1.jahr, t1.aufgabenbereich_cofog_feingliederung, t1.ausgaben_in_mio_chf\nFROM staatsausgaben_nach_aufgabenbereichen_cofog AS t1\nINNER JOIN (\n    SELECT jahr, SUM(ausgaben_in_mio_chf) AS tot_spending\n    FROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%religion%'\n      AND institutioneller_sektor = 'Kantone'\n    GROUP BY jahr\n    ORDER BY tot_spending DESC LIMIT 1\n) t2 ON t1.jahr = t2.jahr\nWHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%religion%'\n  AND t1.institutioneller_sektor = 'Kantone';\n\n\n### Question\nWie hoch war der Anteil des Gemeinde Budgets, der seit 2011 f\u00fcr Kommunikation bereitgestellt wurde?\n### SQL query\nSELECT jahr, SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_kommunikation_in_landgemeinden\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%kommunikation%'\n    AND institutioneller_sektor = 'Gemeinden'\n    AND jahr >= 2011\nGROUP BY jahr\nORDER BY jahr ASC;\n\n\n### Question\nWie hoch waren die Mittel f\u00fcr die Polizei im Vergleich zu denen f\u00fcr die Feuerwehr im Jahr 2020?\n### SQL query\nSELECT ausgaben_in_mio_chf, aufgabenbereich_cofog_feingliederung\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE (\n    LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%polizei%'\n    OR LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%feuerwehr%'\n)\n    AND jahr = 2020\n    AND institutioneller_sektor = 'Staat';\n\n\n### Question\nWie hoch war der Anteil des Gemeinde Budgets, der seit 2011 f\u00fcr Kommunikation bereitgestellt wurde?\n### SQL query\nSELECT jahr, SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_kommunikation_in_landgemeinden\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%kommunikation%'\n    AND institutioneller_sektor = 'Gemeinden'\n    AND jahr >= 2011\nGROUP BY jahr\nORDER BY jahr ASC;\n\n\n### Question\nWelches waren die 3 gr\u00f6ssten Ausgabenquellen des Bundes im Jahr 2021 und wie hoch waren diese?\n### SQL query\n",
    "process_time": 6.509553488111123,
    "num_tokens": 2198,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  },
  {
    "i": 143,
    "question": "Welcher Anteil des Schweizer Budgets wird jedes Jahr in Sicherheit investiert?",
    "query": "SELECT jahr, SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_sicherheit\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%sicherheit%'\n    AND institutioneller_sektor = 'Staat'\nGROUP BY jahr\nORDER BY jahr ASC;\n",
    "db_id": "staatsausgaben_nach_aufgabenbereichen_cofog",
    "generated_query": "SELECT jahr, SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_sicherheit\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%sicherheit%'\n    AND institutioneller_sektor = 'Staat'\nGROUP BY jahr\nORDER BY jahr ASC;",
    "meta_data": [
      {
        "question": "Wie hoch war der Anteil des Gemeinde Budgets, der seit 2011 f\u00fcr Kommunikation bereitgestellt wurde?",
        "query": "SELECT jahr, SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_kommunikation_in_landgemeinden\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%kommunikation%'\n    AND institutioneller_sektor = 'Gemeinden'\n    AND jahr >= 2011\nGROUP BY jahr\nORDER BY jahr ASC;\n"
      },
      {
        "question": "Wie hoch waren die religionsbezogenen Ausgaben der Kantone im Jahr ihres H\u00f6chststandes?",
        "query": "SELECT t1.jahr, t1.aufgabenbereich_cofog_feingliederung, t1.ausgaben_in_mio_chf\nFROM staatsausgaben_nach_aufgabenbereichen_cofog AS t1\nINNER JOIN (\n    SELECT jahr, SUM(ausgaben_in_mio_chf) AS tot_spending\n    FROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%religion%'\n      AND institutioneller_sektor = 'Kantone'\n    GROUP BY jahr\n    ORDER BY tot_spending DESC LIMIT 1\n) t2 ON t1.jahr = t2.jahr\nWHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%religion%'\n  AND t1.institutioneller_sektor = 'Kantone';\n"
      },
      {
        "question": "Welche Teilung hatte im Jahr 2020 die h\u00f6chsten Staatsausgaben?",
        "query": "SELECT aufgabenbereich_cofog_grobgliederung as ausgaben_bereich_mit_den_hoechsten_ausgaben_2020\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE institutioneller_sektor = 'Staat' AND jahr = 2020\nGROUP BY aufgabenbereich_cofog_grobgliederung\nORDER BY SUM(ausgaben_in_mio_chf) DESC LIMIT 1;\n"
      },
      {
        "question": "Wie viel hat jeder institutionelle Sektor im Jahr 2018 f\u00fcr den Umweltschutz ausgegeben?",
        "query": "SELECT SUM(ausgaben_in_mio_chf) as ausgaben_in_mio_chf, institutioneller_sektor\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE jahr = 2018 AND aufgabenbereich_cofog_grobgliederung = 'Umweltschutz'\nGROUP BY institutioneller_sektor\nORDER BY SUM(ausgaben_in_mio_chf) ASC;\n"
      },
      {
        "question": "Wie hoch war der Anteil des Gemeinde Budgets, der seit 2011 f\u00fcr Kommunikation bereitgestellt wurde?",
        "query": "SELECT jahr, SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_kommunikation_in_landgemeinden\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%kommunikation%'\n    AND institutioneller_sektor = 'Gemeinden'\n    AND jahr >= 2011\nGROUP BY jahr\nORDER BY jahr ASC;\n"
      },
      {
        "question": "Wie viel Prozent des Staat Budgets gab im Jahr 2021 fur Bildung aus?",
        "query": "SELECT SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_bildung\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE institutioneller_sektor = 'Staat'\n    AND jahr = 2021\n    AND aufgabenbereich_cofog_grobgliederung = 'Bildungswesen';\n"
      },
      {
        "question": "Wie hoch war der Anteil des Gemeinde Budgets, der seit 2011 f\u00fcr Kommunikation bereitgestellt wurde?",
        "query": "SELECT jahr, SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_kommunikation_in_landgemeinden\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%kommunikation%'\n    AND institutioneller_sektor = 'Gemeinden'\n    AND jahr >= 2011\nGROUP BY jahr\nORDER BY jahr ASC;\n"
      }
    ],
    "prompt": "You are an helpful AI assistant who writes SQL query for a given question. Given the database described by the database schema below, write a SQL query that answers the question.\nDo not explain the SQL query.\nReturn just the query, so it can be run verbatim from your response.\n### Database Schema\n\nCREATE TABLE experiment.spatial_unit (\n\tspatialunit_uid VARCHAR(30) NOT NULL, \n\tspatialunit_current_id INTEGER NOT NULL, \n\tspatialunit_ontology VARCHAR(30) NOT NULL, \n\tname VARCHAR(100) NOT NULL, \n\tname_de VARCHAR(100), \n\tname_fr VARCHAR(100), \n\tname_it VARCHAR(100), \n\tcountry BOOLEAN DEFAULT false NOT NULL, \n\tcanton BOOLEAN DEFAULT false NOT NULL, \n\tdistrict BOOLEAN DEFAULT false NOT NULL, \n\tmunicipal BOOLEAN DEFAULT false NOT NULL, \n\tresidence_area BOOLEAN DEFAULT false NOT NULL, \n\tneighborhood BOOLEAN DEFAULT false NOT NULL, \n\tregion BOOLEAN DEFAULT false NOT NULL, \n\tzone BOOLEAN, \n\tspatialunit_hist_id INTEGER, \n\tcanton_hist_id INTEGER, \n\tdistrict_hist_id INTEGER, \n\tvalid_from DATE, \n\tvalid_until DATE, \n\tCONSTRAINT spatial_unit_pkey PRIMARY KEY (spatialunit_uid)\n)\n/*\nColumns in spatial_unit and 5 examples in each column for high cardinality columns :\nspatialunit_uid : 249_A.ADM3, 133_A.ADM5, 662_A.ADM3, 4065_A.ADM3, 5100_A.ADM3\nspatialunit_current_id : 5106, 5242, 2150, 1608, 5557\nname : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_de : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_fr : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nname_it : Gonten, Ossingen, W\u00fcnnewil-Flamatt, Saint-Prex, Romainm\u00f4tier-Envy\nspatialunit_hist_id : 10121, 15028, 13245, 16057, 14740\ncanton_hist_id : 18, 23, 24, 17, 11\ndistrict_hist_id : 10121, 10276, 10187, 10032, 10316\nvalid_from : 1948-01-01, 2004-01-01, 2014-01-01, 2003-01-01, 2018-01-01\nvalid_until : 2012-12-31, 2004-04-03, 1989-12-31, 2013-04-13, 1997-12-31\n*/\n\n\n\n\nCREATE TABLE experiment.staatsausgaben_nach_aufgabenbereichen_cofog (\n\tuid SERIAL NOT NULL, \n\tjahr INTEGER, \n\taufgabenbereich_cofog_feingliederung TEXT, \n\taufgabenbereich_cofog_grobgliederung TEXT, \n\tinstitutioneller_sektor TEXT, \n\tausgaben_in_mio_chf NUMERIC, \n\tprozent_der_gesamtausgaben NUMERIC, \n\tspatialunit_uid VARCHAR, \n\tCONSTRAINT staatsausgaben_nach_aufgabenbereichen_cofog_pkey PRIMARY KEY (uid), \n\tCONSTRAINT staatsausgaben_nach_aufgabenbereichen_cofo_spatialunit_uid_fkey FOREIGN KEY(spatialunit_uid) REFERENCES experiment.raeumliche_einheit (raeumliche_einheit_uid)\n)\n/*\nColumns in staatsausgaben_nach_aufgabenbereichen_cofog and 5 examples in each column for high cardinality columns :\nuid : 127, 192, 72, 115, 29\njahr : 2015, 2000, 2009, 2012, 2019\nausgaben_in_mio_chf : 2961, 2474, 9734, 5062, 3828\nprozent_der_gesamtausgaben : 0.20000000000000001, 6.00000000000000000, 3.29999999999999982, 4.00000000000000000, 3.10000000000000009\n*/\n\n/*\nColumn name, Column discription, Example values\naufgabenbereich_cofog_feingliederung, Aufgabenbereich des Staates (COFOG Feingliederung), Alter,Wasserversorgung,Polizei\naufgabenbereich_cofog_grobgliederung, Aufgabenbereich des Staates (COFOG Grobgliederung), Umweltschutz,Bildungswesen,Freizeitgestaltung, Sport, Kultur und Religion\ninstitutioneller_sektor, institutioneller Sektor, Staat,Kantone,Bund,Gemeinden,\u00d6ffentliche Sozialversicherungen\nausgaben_in_mio_chf, Ausgaben in Millionen CHF, None\nprozent_der_gesamtausgaben, Prozent der Gesamtaugaben, None\n*/\n\n\n\n### Question\nWie hoch war der Anteil des Gemeinde Budgets, der seit 2011 f\u00fcr Kommunikation bereitgestellt wurde?\n### SQL query\nSELECT jahr, SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_kommunikation_in_landgemeinden\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%kommunikation%'\n    AND institutioneller_sektor = 'Gemeinden'\n    AND jahr >= 2011\nGROUP BY jahr\nORDER BY jahr ASC;\n\n\n### Question\nWie hoch waren die religionsbezogenen Ausgaben der Kantone im Jahr ihres H\u00f6chststandes?\n### SQL query\nSELECT t1.jahr, t1.aufgabenbereich_cofog_feingliederung, t1.ausgaben_in_mio_chf\nFROM staatsausgaben_nach_aufgabenbereichen_cofog AS t1\nINNER JOIN (\n    SELECT jahr, SUM(ausgaben_in_mio_chf) AS tot_spending\n    FROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%religion%'\n      AND institutioneller_sektor = 'Kantone'\n    GROUP BY jahr\n    ORDER BY tot_spending DESC LIMIT 1\n) t2 ON t1.jahr = t2.jahr\nWHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%religion%'\n  AND t1.institutioneller_sektor = 'Kantone';\n\n\n### Question\nWelche Teilung hatte im Jahr 2020 die h\u00f6chsten Staatsausgaben?\n### SQL query\nSELECT aufgabenbereich_cofog_grobgliederung as ausgaben_bereich_mit_den_hoechsten_ausgaben_2020\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE institutioneller_sektor = 'Staat' AND jahr = 2020\nGROUP BY aufgabenbereich_cofog_grobgliederung\nORDER BY SUM(ausgaben_in_mio_chf) DESC LIMIT 1;\n\n\n### Question\nWie viel hat jeder institutionelle Sektor im Jahr 2018 f\u00fcr den Umweltschutz ausgegeben?\n### SQL query\nSELECT SUM(ausgaben_in_mio_chf) as ausgaben_in_mio_chf, institutioneller_sektor\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE jahr = 2018 AND aufgabenbereich_cofog_grobgliederung = 'Umweltschutz'\nGROUP BY institutioneller_sektor\nORDER BY SUM(ausgaben_in_mio_chf) ASC;\n\n\n### Question\nWie hoch war der Anteil des Gemeinde Budgets, der seit 2011 f\u00fcr Kommunikation bereitgestellt wurde?\n### SQL query\nSELECT jahr, SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_kommunikation_in_landgemeinden\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%kommunikation%'\n    AND institutioneller_sektor = 'Gemeinden'\n    AND jahr >= 2011\nGROUP BY jahr\nORDER BY jahr ASC;\n\n\n### Question\nWie viel Prozent des Staat Budgets gab im Jahr 2021 fur Bildung aus?\n### SQL query\nSELECT SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_bildung\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE institutioneller_sektor = 'Staat'\n    AND jahr = 2021\n    AND aufgabenbereich_cofog_grobgliederung = 'Bildungswesen';\n\n\n### Question\nWie hoch war der Anteil des Gemeinde Budgets, der seit 2011 f\u00fcr Kommunikation bereitgestellt wurde?\n### SQL query\nSELECT jahr, SUM(prozent_der_gesamtausgaben) as prozent_der_gesamtausgaben_fur_kommunikation_in_landgemeinden\nFROM staatsausgaben_nach_aufgabenbereichen_cofog WHERE LOWER(aufgabenbereich_cofog_feingliederung) LIKE '%kommunikation%'\n    AND institutioneller_sektor = 'Gemeinden'\n    AND jahr >= 2011\nGROUP BY jahr\nORDER BY jahr ASC;\n\n\n### Question\nWelcher Anteil des Schweizer Budgets wird jedes Jahr in Sicherheit investiert?\n### SQL query\n",
    "process_time": 9.244360730051994,
    "num_tokens": 2170,
    "hardness": "unknown",
    "scores": [
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    "lang": "de"
  }
]